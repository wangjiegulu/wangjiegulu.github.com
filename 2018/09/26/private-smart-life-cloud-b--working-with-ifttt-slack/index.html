<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#ffffff">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#ffffff">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#ffffff">


    <meta name="description" content="构建自己的 Smart Life 私有云（二）-&amp;gt; 连通 IFTTT &amp;amp; Slack上一篇我们破解了涂鸦的插座，搭建了自己的 web 服务，暴露了一个接口来控制插座的开关。这篇我们配合 IFTTT、Slack 来控制插座：  说 “OK Google” 唤醒 Google Assistant，然后说 “帮我打开卧室的电源”，最后插座被打开。 创建 Slack 机器人 Angelia，">
<meta name="keywords" content="java,kotlin,Smart Life,Internet of Things,IoT,tuya,plug,IFTTT,Google Assistant,Slack,J2EE">
<meta property="og:type" content="article">
<meta property="og:title" content="构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack">
<meta property="og:url" content="https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/index.html">
<meta property="og:site_name" content="Wang Jie&#39;s Blog|Software Engineer|Android|Java|Kotlin ❤|github|Huginn|Geek|code|developer|programer">
<meta property="og:description" content="构建自己的 Smart Life 私有云（二）-&amp;gt; 连通 IFTTT &amp;amp; Slack上一篇我们破解了涂鸦的插座，搭建了自己的 web 服务，暴露了一个接口来控制插座的开关。这篇我们配合 IFTTT、Slack 来控制插座：  说 “OK Google” 唤醒 Google Assistant，然后说 “帮我打开卧室的电源”，最后插座被打开。 创建 Slack 机器人 Angelia，">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46124165-111e3080-c255-11e8-88ba-7be984c00cf3.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46124413-981fd880-c256-11e8-8cbb-572346f29fd7.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46124447-df0dce00-c256-11e8-959b-64a6fcd1bc84.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46124676-1335be80-c258-11e8-89fa-b299badb545a.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46125203-abcd3e00-c25a-11e8-805f-d9f17bd235bc.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46125314-21d1a500-c25b-11e8-83d1-89fbd8a596d1.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46125989-09af5500-c25e-11e8-864b-18e3b6145aca.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46126106-8d694180-c25e-11e8-84ae-ed01feda481d.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46126279-3748ce00-c25f-11e8-997d-b47d8a1ea6ce.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46126650-abd03c80-c260-11e8-8cf1-c9446bfa4f83.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46126688-d8845400-c260-11e8-894c-b5d3e0df143b.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46126863-5c3e4080-c261-11e8-8e3d-1f199e647201.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46129424-39178f00-c269-11e8-803f-861c952e37bf.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46129520-8eec3700-c269-11e8-851f-4998f8d793f6.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46129603-c824a700-c269-11e8-9f2a-267b03bc17aa.jpg">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46126962-a7f0ea00-c261-11e8-808a-6ccc8a63c049.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46127140-5dbc3880-c262-11e8-97fe-75fcb05fc7df.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/5423194/46127236-a70c8800-c262-11e8-83a2-cdcfd8ebe10c.png">
<meta property="og:updated_time" content="2018-11-12T06:48:09.102Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack">
<meta name="twitter:description" content="构建自己的 Smart Life 私有云（二）-&amp;gt; 连通 IFTTT &amp;amp; Slack上一篇我们破解了涂鸦的插座，搭建了自己的 web 服务，暴露了一个接口来控制插座的开关。这篇我们配合 IFTTT、Slack 来控制插座：  说 “OK Google” 唤醒 Google Assistant，然后说 “帮我打开卧室的电源”，最后插座被打开。 创建 Slack 机器人 Angelia，">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/5423194/46124165-111e3080-c255-11e8-88ba-7be984c00cf3.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3">
    
      <div id="header-post-nav">
  <span id="nav">
      <ul>
         
          <li><b><a href="/">Home</a></b></li>
         
          <li><b><a href="/archives/">Writing</a></b></li>
         
          <li><b><a href="/tags/">Tags</a></b></li>
         
          <li><b><a href="/about/">About</a></b></li>
         
          <li><b><a href="/feed.xml">RSS</a></b></li>
        
      </ul>
  </span>
</div>

<div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/feed.xml">RSS</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2018/09/26/private-smart-life-cloud-a--hack-tuya-smart-plug/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&text=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&title=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&is_video=false&description=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack&body=Check out this article: https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&title=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&title=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&title=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&title=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&name=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#构建自己的-Smart-Life-私有云（二）-gt-连通-IFTTT-amp-Slack"><span class="toc-number">1.</span> <span class="toc-text">构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建自己私人的-Slack-Workspace"><span class="toc-number">1.1.</span> <span class="toc-text">创建自己私人的 Slack Workspace</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建-Slack-App"><span class="toc-number">1.2.</span> <span class="toc-text">创建 Slack App</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#设置-Bot-信息"><span class="toc-number">1.2.1.</span> <span class="toc-text">设置 Bot 信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置-Events-API"><span class="toc-number">1.2.2.</span> <span class="toc-text">设置 Events API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#处理事件"><span class="toc-number">1.2.3.</span> <span class="toc-text">处理事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#集成-Google-Assistant-和-IFTTT"><span class="toc-number">1.3.</span> <span class="toc-text">集成 Google Assistant 和 IFTTT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#吐槽下涂鸦的-Google-Assistant"><span class="toc-number">1.3.1.</span> <span class="toc-text">吐槽下涂鸦的 Google Assistant</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用-Slack-的-Slash-Command-控制"><span class="toc-number">1.4.</span> <span class="toc-text">使用 Slack 的 Slash Command 控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其它场景"><span class="toc-number">1.5.</span> <span class="toc-text">其它场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#章尾"><span class="toc-number">1.6.</span> <span class="toc-text">章尾</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack
    </h1>



    <div class="meta"  style="margin-top:12px;">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name" style="margin-left: 12px">Wang Jie</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-09-26T08:45:09.437Z" itemprop="datePublished">2018-09-26</time>
    </div>

<br/>
      
    <div class="article-tag">
        <i class="fas fa-tag" style="margin-top: 20px"></i>
        <a class="tag-link" href="/tags/Google-Assistant/">Google Assistant</a>, <a class="tag-link" href="/tags/IFTTT/">IFTTT</a>, <a class="tag-link" href="/tags/Internet-of-Things/">Internet of Things</a>, <a class="tag-link" href="/tags/IoT/">IoT</a>, <a class="tag-link" href="/tags/J2EE/">J2EE</a>, <a class="tag-link" href="/tags/Slack/">Slack</a>, <a class="tag-link" href="/tags/Smart-Life/">Smart Life</a>, <a class="tag-link" href="/tags/java/">java</a>, <a class="tag-link" href="/tags/kotlin/">kotlin</a>, <a class="tag-link" href="/tags/plug/">plug</a>, <a class="tag-link" href="/tags/tuya/">tuya</a>
    </div>


    </div>
  </header>
  

  
  <div class="content" itemprop="articleBody">
    
    
      <!-- <img class="header-img" src="https://images.unsplash.com/photo-1524635962361-d7f8ae9c79b1?ixlib=rb-0.3.5&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;s=410a4f67702893daff2ddaa4336d5924&amp;auto=format&amp;fit=crop&amp;w=2250&amp;q=80" /> -->
      

        <img src="https://images.unsplash.com/photo-1524635962361-d7f8ae9c79b1?ixlib=rb-0.3.5&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;s=410a4f67702893daff2ddaa4336d5924&amp;auto=format&amp;fit=crop&amp;w=2250&amp;q=80" style="border-radius: 3px;"/>
        
      
      
    

    <h1 id="构建自己的-Smart-Life-私有云（二）-gt-连通-IFTTT-amp-Slack"><a href="#构建自己的-Smart-Life-私有云（二）-gt-连通-IFTTT-amp-Slack" class="headerlink" title="构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"></a>构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack</h1><p><a href="https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-a--hack-tuya-smart-plug/">上一篇</a>我们破解了涂鸦的插座，搭建了自己的 web 服务，暴露了一个接口来控制插座的开关。这篇我们配合 IFTTT、Slack 来控制插座：</p>
<ol>
<li>说 “OK Google” 唤醒 Google Assistant，然后说 “帮我打开卧室的电源”，最后插座被打开。</li>
<li>创建 Slack 机器人 <code>Angelia</code>，对它发消息“帮我打开卧室的电源”，然后插座打开， <code>Angelia</code> 回复说 “好的，已经打开”。</li>
<li>通过 Slack 机器人 <code>Angelia</code>，发送 Slash Commands，打开关闭插座。</li>
</ol>
<h2 id="创建自己私人的-Slack-Workspace"><a href="#创建自己私人的-Slack-Workspace" class="headerlink" title="创建自己私人的 Slack Workspace"></a>创建自己私人的 Slack Workspace</h2><p>打开 Slack，根据提示创建自己的 Slack Workspace: <a href="https://slack.com/create" target="_blank" rel="noopener">https://slack.com/create</a></p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46124165-111e3080-c255-11e8-88ba-7be984c00cf3.png" width="500px"><br></div>

<p>比如我的 Workspace 为 <a href="https://wangjie.slack.com" target="_blank" rel="noopener">https://wangjie.slack.com</a>。</p>
<h2 id="创建-Slack-App"><a href="#创建-Slack-App" class="headerlink" title="创建 Slack App"></a>创建 Slack App</h2><p>创建完毕登录之后，默认应该有 <code>#general</code>、<code>#random</code> 等 channel，但暂时不用这两个 channel。</p>
<p>接下来，我们来创建一个 App。</p>
<p>打开 <a href="https://api.slack.com/" target="_blank" rel="noopener">https://api.slack.com/</a>，点击 <code>Start Building</code></p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46124413-981fd880-c256-11e8-8cbb-572346f29fd7.png" width="600px"><br></div>

<p>输入 App 名称和你要添加到的 workspace。</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46124447-df0dce00-c256-11e8-959b-64a6fcd1bc84.png" width="600px"><br></div>

<h3 id="设置-Bot-信息"><a href="#设置-Bot-信息" class="headerlink" title="设置 Bot 信息"></a>设置 Bot 信息</h3><p>创建完毕之后，我们需要设置这个 app 的机器人相关信息，打开 <a href="https://api.slack.com/apps" target="_blank" rel="noopener">app 设置页面</a>，选择 <code>Bot Users</code>：</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46124676-1335be80-c258-11e8-89fa-b299badb545a.png" width="700px"><br></div>

<p>设置机器人的名称（Display name 和 Default name）。勾选 <code>Always Show My Bot as Online</code>，点击 <code>Save Changes</code>。</p>
<h3 id="设置-Events-API"><a href="#设置-Events-API" class="headerlink" title="设置 Events API"></a>设置 Events API</h3><p><a href="https://api.slack.com/bot-users#app-mentions-response" target="_blank" rel="noopener">Event API</a> 可以在各种时间发生的时候触发调用，比如 消息发送的时候、channels 改变的时候等等。</p>
<p>我们先回到我们的 web 服务，打开上一章创建的 <code>AngeliaController</code>，新增一个处理 Event 的 api：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/say/at"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">say</span><span class="params">(<span class="meta">@RequestBody</span> request: <span class="type">BotEventRequestVo</span>)</span></span>: JSONObject &#123;</span><br><span class="line">    logger.info(<span class="string">"[slack event request]request -&gt; \n<span class="variable">$request</span>"</span>)</span><br><span class="line">    <span class="keyword">return</span> JsonResult.success(</span><br><span class="line">                    <span class="string">"token"</span> to request.token,</span><br><span class="line">                    <span class="string">"challenge"</span> to request.challenge,</span><br><span class="line">                    <span class="string">"message"</span> to message</span><br><span class="line">            )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">BotEventRequestVo</span></span>(</span><br><span class="line">        <span class="keyword">val</span> challenge: String?,</span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> token: String?,</span><br><span class="line">        <span class="keyword">val</span> team_id: String?,</span><br><span class="line">        <span class="keyword">val</span> api_app_id: String?,</span><br><span class="line">        <span class="keyword">val</span> event: BotEventVo?,</span><br><span class="line">        <span class="keyword">val</span> type: String?,</span><br><span class="line">        <span class="keyword">val</span> event_id: String?,</span><br><span class="line">        <span class="keyword">val</span> event_time: String?,</span><br><span class="line">        <span class="keyword">val</span> authed_users: List&lt;String&gt;?</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">BotEventVo</span></span>(</span><br><span class="line">        <span class="keyword">val</span> type: String?,</span><br><span class="line">        <span class="keyword">val</span> user: String?,</span><br><span class="line">        <span class="keyword">val</span> text: String?,</span><br><span class="line">        <span class="keyword">val</span> client_msg_id: String?,</span><br><span class="line">        <span class="keyword">val</span> ts: String?,</span><br><span class="line">        <span class="keyword">val</span> channel: String?,</span><br><span class="line">        <span class="keyword">val</span> event_ts: String?,</span><br><span class="line">        <span class="keyword">val</span> channel_type: String?</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>构建，部署到服务器。</p>
<p>打开 Slack App 设置页面的 <code>Event Subscriptions</code>：</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46125203-abcd3e00-c25a-11e8-805f-d9f17bd235bc.png" width="700px"><br></div>

<p>在 <code>Request URL</code> 中填写刚刚在我们 web 服务上创建的接口 <code>http://[server ip]:xxx/angelia/say/at</code>，并且点击验证。</p>
<blockquote>
<p>注意：这里认证的依据是，你的接口 Response 需要返回请求中的 <code>challenge</code> 数据就算认证成功。</p>
</blockquote>
<p>然后在 <code>Subscribe to Bot Events</code> 中添加订阅的事件，需要增加的是 <a href="https://api.slack.com/events/message.im" target="_blank" rel="noopener">message.im</a></p>
<blockquote>
<p><code>message.im</code>表示当你跟 bot 的私聊中产生消息的时候（有可能是你发送消息给 Bot，也有可能是 Bot 发消息给你），事件就会触发。</p>
</blockquote>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46125314-21d1a500-c25b-11e8-83d1-89fbd8a596d1.png" width="600px"><br></div>

<p>点击保存。</p>
<p>这时，当你在 Slack 中发送消息给机器人的时候，你的 web 服务端就能收到请求了。</p>
<h3 id="处理事件"><a href="#处理事件" class="headerlink" title="处理事件"></a>处理事件</h3><p>你的 web 服务器收到请求之后，需要对此进行处理，所以你需要去解析发的消息中的信息，然后打开/关闭对应设备（插座）的开关。完善之前的 <code>say</code> 接口：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">lateinit</span> <span class="keyword">var</span> tuyaClientService: TuyaClientService</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">lateinit</span> <span class="keyword">var</span> angeliaSlackProperties: AngeliaSlackProperties</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Angelia 机器人 对话入口</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/say/at"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">say</span><span class="params">(<span class="meta">@RequestBody</span> request: <span class="type">BotEventRequestVo</span>)</span></span>: JSONObject &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="keyword">val</span> text = request.event?.text</span><br><span class="line">       <span class="keyword">val</span> eventType = request.event?.type</span><br><span class="line">       <span class="keyword">if</span> (eventType == <span class="string">"message"</span> <span class="comment">// 直接对话</span></span><br><span class="line">            ||</span><br><span class="line">            request.event.user != angeliaSlackProperties.angelia_id <span class="comment">// angelia自己发的忽略掉</span></span><br><span class="line">       ) &#123;</span><br><span class="line">          <span class="keyword">val</span> message = angeliaBotService.parseTuyaClient(text)</span><br><span class="line">                          ?: <span class="string">"Sorry, I can not understand."</span></span><br><span class="line"></span><br><span class="line">          angeliaSlackService.postMessage(JSONObject().apply &#123;</span><br><span class="line">              <span class="keyword">this</span>[<span class="string">"text"</span>] = <span class="string">"<span class="variable">$message</span>"</span></span><br><span class="line">              <span class="keyword">this</span>[<span class="string">"channel"</span>] = request.event.channel</span><br><span class="line">              <span class="keyword">this</span>[<span class="string">"as_user"</span>] = <span class="literal">true</span></span><br><span class="line">          &#125;)</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> JsonResult.success(</span><br><span class="line">               <span class="string">"token"</span> to request.token,</span><br><span class="line">               <span class="string">"challenge"</span> to request.challenge,</span><br><span class="line">               <span class="string">"message"</span> to <span class="string">"Request eventId(<span class="subst">$&#123;request.event_id&#125;</span>) done."</span></span><br><span class="line">       )</span><br><span class="line">   &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">       angeliaSlackService.postMessage(JSONObject().apply &#123;</span><br><span class="line">           <span class="keyword">this</span>[<span class="string">"text"</span>] = <span class="string">"Sorry! Something is wrong: <span class="subst">$&#123;e.message&#125;</span>"</span></span><br><span class="line">           <span class="keyword">this</span>[<span class="string">"channel"</span>] = request.event?.channel</span><br><span class="line">           <span class="keyword">this</span>[<span class="string">"as_user"</span>] = <span class="literal">true</span></span><br><span class="line">       &#125;)</span><br><span class="line">       <span class="keyword">return</span> JsonResult.error(e.message)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码的逻辑很简单：</p>
<ul>
<li>首先，eventType是直接对话的（与机器人 bot 私聊），并且是我发给机器人的（机器人发给我的消息不用处理）才会去处理</li>
<li>然后通过 <code>angeliaBotService.parseTuyaClient()</code> 方法进行文本解析和处理</li>
<li>如果解析不出来，则返回 null，message 就是 “Sorry, I can not understand.”</li>
<li>最后返回 Response（带上 message），这里的 message 就是 Bot 发送给我的数据。</li>
</ul>
<p>这里需要做一些 Slack 的配置 slack.properties：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># token for bot</span><br><span class="line">angelia.slack.bot_token=Bearer xoxb-2923xxxxxxxxxxxxxxxxxxxx</span><br><span class="line"></span><br><span class="line"># slack api</span><br><span class="line">angelia.slack.api_base_url=https://slack.com/api</span><br><span class="line">angelia.slack.api_chat_post_message=/chat.postMessage</span><br><span class="line"></span><br><span class="line">angelia.slack.angelia_id=UCWxxxxxx</span><br></pre></td></tr></table></figure>
<p><code>angelia.slack.bot_token</code>：是 Bot 发送消息到 Slack 的token，这个 token 可以在 app 设置页面的 <code>OAuth &amp; Permissions</code> 中拿到</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46125989-09af5500-c25e-11e8-864b-18e3b6145aca.png" width="600px"><br></div>

<blockquote>
<p>注意：是下面的那个 <code>Bot User OAuth Access Token</code>，并且添加到配置文件的时候需要加上 <code>Bearer</code>（注意后面有个空格）</p>
</blockquote>
<p><code>angelia.slack.api_base_url</code> 和 <code>angelia.slack.api_chat_post_message</code> 是发送消息的 url，不用改动。</p>
<p><code>angelia.slack.angelia_id</code> 表示机器人的id，可以通过在 slack 左侧选中机器人右键复制链接，path 最后部分就是 id</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126106-8d694180-c25e-11e8-84ae-ed01feda481d.png" width="250px"><br></div>

<p>最后，你就能在 slack 中打开与机器人聊天框，发送“关闭插座a”来控制插座：</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126279-3748ce00-c25f-11e8-997d-b47d8a1ea6ce.jpg" width="300px"><br></div>

<h2 id="集成-Google-Assistant-和-IFTTT"><a href="#集成-Google-Assistant-和-IFTTT" class="headerlink" title="集成 Google Assistant 和 IFTTT"></a>集成 Google Assistant 和 IFTTT</h2><blockquote>
<p>首先确保你的手机装有 Google Assistant（Google Home 先不讨论。。。是的，我没买- -）。</p>
</blockquote>
<p>首先我们需要在 web 服务器端再创建如下一个接口：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 插座控制接口</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/control/plug"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">controlPlug</span><span class="params">(<span class="meta">@RequestBody</span> request: <span class="type">PlugRequestVo</span>)</span></span>: JSONObject &#123;</span><br><span class="line">   <span class="keyword">val</span> dev = tuyaClientProperties.findDev(request.alias)</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (<span class="literal">null</span> == dev) &#123;</span><br><span class="line">           JsonResult.error(<span class="string">"Device named <span class="subst">$&#123;request.alias&#125;</span> is not found"</span>)</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           tuyaClientService.controlPlug(dev.devId, request.turnOn)</span><br><span class="line">           JsonResult.success()</span><br><span class="line">       &#125;</span><br><span class="line">   &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">       JsonResult.error(e.message)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">PlugRequestVo</span></span>(</span><br><span class="line">     <span class="keyword">val</span> alias: String,</span><br><span class="line">     <span class="keyword">val</span> turnOn: <span class="built_in">Boolean</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>构建部署到服务器。</p>
<p>然后打开IFTTT、注册（如果还没有账户）登录，创建 Applet</p>
<p><strong>This</strong>：选择 Google Assistant：</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126650-abd03c80-c260-11e8-8cf1-c9446bfa4f83.jpg" width="300px"><br></div>

<p><strong>That</strong>：选择 Webhook：</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126688-d8845400-c260-11e8-894c-b5d3e0df143b.jpg" width="300px"><br></div>

<blockquote>
<p>注意：POST 请求，在 body 中填写如上 json 数据。<br>关闭的 Applet 也是类似，把 body 中的 turnOn 改成 false 就可以了</p>
</blockquote>
<p>最后，你就可以通过 “OK, Google” 唤醒 Google Assistant，然后说”Turn on plug a”来打开插座了。</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126863-5c3e4080-c261-11e8-8e3d-1f199e647201.jpg" width="300px"><br></div>

<h3 id="吐槽下涂鸦的-Google-Assistant"><a href="#吐槽下涂鸦的-Google-Assistant" class="headerlink" title="吐槽下涂鸦的 Google Assistant"></a>吐槽下涂鸦的 Google Assistant</h3><p>本来想直接使用 Google Assistant 的 Smart Life 的，但是一直没成功，很多人也在反映这个事情，不过貌似没什么效果（看下面这个评分，估计反映一直是被无视的- -）：</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46129424-39178f00-c269-11e8-803f-861c952e37bf.jpg" width="300px"><br></div>

<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46129520-8eec3700-c269-11e8-851f-4998f8d793f6.jpg" width="300px"><br>    <img src="https://user-images.githubusercontent.com/5423194/46129603-c824a700-c269-11e8-9f2a-267b03bc17aa.jpg" width="300px"><br></div>




<h2 id="使用-Slack-的-Slash-Command-控制"><a href="#使用-Slack-的-Slash-Command-控制" class="headerlink" title="使用 Slack 的 Slash Command 控制"></a>使用 Slack 的 Slash Command 控制</h2><p>在 web 服务中再新增两个接口用于 Slash Command：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 插座控制接口，For Slack command line(slash commands)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/plug/turnon"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">plugTurnOnForCommand</span><span class="params">(<span class="meta">@RequestBody</span> body: <span class="type">String</span>)</span></span>: JSONObject &#123;</span><br><span class="line">   <span class="keyword">return</span> JsonResult.success(<span class="string">"text"</span> to plugControlForCommand(body, <span class="literal">true</span>))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* For Slack command line(slash commands)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/plug/turnoff"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">plugTurnOffForCommand</span><span class="params">(<span class="meta">@RequestBody</span> body: <span class="type">String</span>)</span></span>: JSONObject &#123;</span><br><span class="line">   <span class="keyword">return</span> JsonResult.success(<span class="string">"text"</span> to plugControlForCommand(body, <span class="literal">false</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* For Slack command line(slash commands) control</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">plugControlForCommand</span><span class="params">(body: <span class="type">String</span>, turnOn: <span class="type">Boolean</span>)</span></span>: String &#123;</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> body.split(<span class="string">"&amp;"</span>).map &#123;</span><br><span class="line">           <span class="keyword">val</span> pair = it.split(<span class="string">"="</span>)</span><br><span class="line">           Pair(pair[<span class="number">0</span>], URLDecoder.decode(pair[<span class="number">1</span>], <span class="string">"UTF-8"</span>))</span><br><span class="line">       &#125;.firstOrNull &#123;</span><br><span class="line">           it.first == <span class="string">"text"</span></span><br><span class="line">       &#125;?.let &#123;</span><br><span class="line">           <span class="keyword">val</span> dev = tuyaClientProperties.findContainsDev(it.second)</span><br><span class="line">           <span class="keyword">if</span> (<span class="literal">null</span> == dev) &#123;</span><br><span class="line">               <span class="string">"Sorry for failed command, Device named <span class="subst">$&#123;it.second&#125;</span> is not found."</span></span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               tuyaClientService.controlPlug(dev.devId, turnOn)</span><br><span class="line">               <span class="string">"<span class="subst">$&#123;if (turnOn) "Turn On" else "Turn Off"&#125;</span> Done(<span class="subst">$&#123;it.second&#125;</span>)."</span></span><br><span class="line">           &#125;</span><br><span class="line">       &#125; ?: <span class="string">"Sorry for failed command, Device name required."</span></span><br><span class="line">   &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"Sorry for failed command, <span class="subst">$&#123;e.message&#125;</span>."</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打开 App 设置页面的 <code>Slash Commands</code>，</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126962-a7f0ea00-c261-11e8-808a-6ccc8a63c049.png" width="600px"><br></div>

<p>点击 <code>Create New Command</code>，</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46127140-5dbc3880-c262-11e8-97fe-75fcb05fc7df.png" width="500px"><br></div>

<p>然后在聊天的输入框中就可以通过”/“显示 command 提示，选择命令，后面跟上你要执行该命令的设备别名就行了。</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46127236-a70c8800-c262-11e8-83a2-cdcfd8ebe10c.png" width="500px"><br></div>

<h2 id="其它场景"><a href="#其它场景" class="headerlink" title="其它场景"></a>其它场景</h2><p>还有其它很多场景可以实现。比如：</p>
<ul>
<li>结合 IFTTT，当离开家门100m远的时候，自动触发 webhook，让你的私有云帮你把电源、智能们关闭。</li>
<li>实时检测你的位置和家门，如果你不在家，自动调用 Google Calendar 确定你的日程安排，如果又没有外出的安排，则通过 Slack 发送 Interactive messages 到你手机上提醒，提供按钮一键锁门。</li>
<li>小细节，晚上手机充电的时候，可以设定手机一旦充满，关闭电源，又如果手机电源掉电过快，低于90%的电量，重新自动开启电源，确保你早上起床的时候手机电量肯定在某个值之上。</li>
<li>等等等等，太多的智能场景可以去实现。</li>
</ul>
<h2 id="章尾"><a href="#章尾" class="headerlink" title="章尾"></a>章尾</h2><p>现在越来越多的厂商制作着各种各样的智能设备，但是又在自己的一亩三分地固步自封。做个插座，提供一个 app 控制下开关、定个时、做个 schedule 就是所谓的智能了，你买了我的设备就必须要用我的软硬件产品。那些需要用户花心思去考虑什么时候我该怎么的设备不是冰冷的，没有生命的么？智能是人类赋予了设备生命，掌握了“思考”的能力，现在的生活如此多元化，再牛的公司也不可能覆盖你的所有生活领域，如果买了这样的智能设备但自此被囚困在这里，我想，这才是我非智能生活的开始吧。</p>


    <br/>
    <hr>

    
    <div class="post-copyright" style="margin-top: 20px;">
        <strong>来源博客：</strong><a href="https://blog.wangjiegulu.com">Wang Jie's Blog</a><br/>
         <strong>本文链接：</strong><a href="https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/">https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/</a><br/>
         <strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处。
    </div>
    

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/feed.xml">RSS</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#构建自己的-Smart-Life-私有云（二）-gt-连通-IFTTT-amp-Slack"><span class="toc-number">1.</span> <span class="toc-text">构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建自己私人的-Slack-Workspace"><span class="toc-number">1.1.</span> <span class="toc-text">创建自己私人的 Slack Workspace</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建-Slack-App"><span class="toc-number">1.2.</span> <span class="toc-text">创建 Slack App</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#设置-Bot-信息"><span class="toc-number">1.2.1.</span> <span class="toc-text">设置 Bot 信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置-Events-API"><span class="toc-number">1.2.2.</span> <span class="toc-text">设置 Events API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#处理事件"><span class="toc-number">1.2.3.</span> <span class="toc-text">处理事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#集成-Google-Assistant-和-IFTTT"><span class="toc-number">1.3.</span> <span class="toc-text">集成 Google Assistant 和 IFTTT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#吐槽下涂鸦的-Google-Assistant"><span class="toc-number">1.3.1.</span> <span class="toc-text">吐槽下涂鸦的 Google Assistant</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用-Slack-的-Slash-Command-控制"><span class="toc-number">1.4.</span> <span class="toc-text">使用 Slack 的 Slash Command 控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其它场景"><span class="toc-number">1.5.</span> <span class="toc-text">其它场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#章尾"><span class="toc-number">1.6.</span> <span class="toc-text">章尾</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&text=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&title=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&is_video=false&description=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack&body=Check out this article: https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&title=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&title=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&title=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&title=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/&name=构建自己的 Smart Life 私有云（二）-&gt; 连通 IFTTT &amp; Slack&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Wang Jie
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/feed.xml">RSS</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-111189680-2', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'blog-wangjiegulu-com';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


