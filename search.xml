<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[Huginn æ•°æ®è‡ªåŠ¨å¤‡ä»½åˆ° Google Drive]]></title>
      <url>/2019/05/31/huginn_automatic_backup/</url>
      <content type="html"><![CDATA[<h1 id="Huginn-æ•°æ®è‡ªåŠ¨å¤‡ä»½åˆ°-Google-Drive"><a href="#Huginn-æ•°æ®è‡ªåŠ¨å¤‡ä»½åˆ°-Google-Drive" class="headerlink" title="Huginn æ•°æ®è‡ªåŠ¨å¤‡ä»½åˆ° Google Drive"></a>Huginn æ•°æ®è‡ªåŠ¨å¤‡ä»½åˆ° Google Drive</h1><p>ä¹‹å‰æœ‰å†™è¿‡ä¸€ç¯‡è®² <a href="https://blog.wangjiegulu.com/2018/11/24/huginn_deployment_with_docker_and_data_migration/">ã€ŠHuginn çš„ Docker éƒ¨ç½²åŠæ•°æ®è¿ç§»ã€‹</a>ï¼Œä½†æ˜¯æ–‡ä¸­çš„æ•°æ®å¤‡ä»½è‡ªå·± SSH åˆ°æœåŠ¡å™¨æ‰‹åŠ¨è¿›è¡Œå¤‡ä»½ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚é‚£å¦‚æœèƒ½å®ç°è‡ªåŠ¨å®æ—¶å¸®æˆ‘å¤‡ä»½åˆ°äº‘ç«¯ï¼Œé‚£å†ä¹Ÿä¸ç”¨æ‹…å¿ƒæ•°æ®ä¸¢å¤±é—®é¢˜äº†ã€‚</p>
<p>é‚£æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼š</p>
<ul>
<li>æ€ä¹ˆå¤‡ä»½æ•°æ®ï¼Ÿ</li>
<li>æ•°æ®å¤‡ä»½åˆ°å“ªé‡Œï¼Ÿ</li>
<li>æ€ä¹ˆå®ç°è‡ªåŠ¨è§¦å‘ï¼Ÿ</li>
</ul>
<p><strong>æ€ä¹ˆå¤‡ä»½æ•°æ®ï¼Ÿ</strong></p>
<p>è¿™ä¸ªä¹‹å‰åœ¨ <a href="https://blog.wangjiegulu.com/2018/11/24/huginn_deployment_with_docker_and_data_migration/">ã€ŠHuginn çš„ Docker éƒ¨ç½²åŠæ•°æ®è¿ç§»ã€‹</a> ä¸­æœ‰è®²åˆ°ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚</p>
<p><strong>æ•°æ®å¤‡ä»½åˆ°å“ªé‡Œï¼Ÿ</strong></p>
<p>å› ä¸ºä¸€ç›´ç”¨çš„ Google Driveï¼Œæ‰€ä»¥ä¼˜å…ˆè€ƒè™‘ï¼Œè€Œä¸”ä¹Ÿæ˜¯æœ€ä¼˜è§£ï¼š</p>
<ul>
<li>å®¹é‡æ¯”è¾ƒå¤§</li>
<li>æ”¯æŒ Restful APIï¼Œé‚£å¯ä»¥é€šè¿‡è„šæœ¬å»è¿›è¡Œä¸Šä¼ æ–‡ä»¶äº†</li>
<li>æœ‰ç‰ˆæœ¬ç®¡ç†ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ åªè¦æ‰“åŒ…ç„¶åä¸Šä¼ æ•°æ®ï¼Œä¸‹æ¬¡å¤‡ä»½åªéœ€æ›¿æ¢æ‰ï¼ŒGoogle ä¼šè¿›è¡Œ diffï¼Œå¯ä»¥åœ¨å ç”¨æœ€å°çš„å®¹é‡çš„å‰æä¸‹ä¿å­˜æ›´å¤šçš„ç‰ˆæœ¬ï¼›é»˜è®¤ä¼šä¿ç•™ 100 ä¸ªç‰ˆæœ¬ï¼Œè¶³å¤Ÿå¤šäº†ï¼Œè¶…è¿‡çš„ä¼šè‡ªåŠ¨åˆ é™¤ï¼Œæ‰€ä»¥å¤‡ä»½çš„ç‰ˆæœ¬ä¹Ÿä¸ä¼šæ— é™åˆ¶åœ°å¢åŠ ã€‚</li>
</ul>
<blockquote>
<p>å…¶å®ƒçš„æ¯”å¦‚ï¼šDropBoxï¼ŒBox ç­‰ä¹Ÿå¯ä»¥ã€‚</p>
</blockquote>
<p><strong>æ€ä¹ˆå®ç°è‡ªåŠ¨è§¦å‘ï¼Ÿ</strong></p>
<p>æˆ‘çš„ huginn æ˜¯éƒ¨ç½²åœ¨ linuxï¼Œå¯ä»¥ä½¿ç”¨ <code>crontab</code> æ¥å®šæ—¶è§¦å‘å¤‡ä»½æ“ä½œã€‚</p>
<h2 id="1-å¤‡ä»½æ•°æ®"><a href="#1-å¤‡ä»½æ•°æ®" class="headerlink" title="1. å¤‡ä»½æ•°æ®"></a>1. å¤‡ä»½æ•°æ®</h2><p>æ•°æ®çš„å¤‡ä»½è¿˜æ˜¯é€šè¿‡ mysql çš„ <code>mysqldump</code> å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line">sudo docker exec huginn bash -c "mysqldump --single-transaction --opt -u [æ•°æ®åº“ç”¨æˆ·å] -ppassword [æ•°æ®åº“å¯†ç ] &gt; /app/huginn_backupfile_tmp.sql"</span><br><span class="line"></span><br><span class="line">docker cp huginn:/app/huginn_backupfile_tmp.sql .</span><br><span class="line"></span><br><span class="line">sudo docker exec huginn bash -c "rm /app/huginn_backupfile_tmp.sql"</span><br><span class="line"></span><br><span class="line">mv huginn_backupfile_tmp.sql huginn_backupfile.sql</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œä»¥ä¸Šå‘½ä»¤ï¼Œä½ å¯ä»¥çœ‹åˆ°åœ¨ç›®å½•ä¸‹å‡ºç°äº† <code>huginn_backupfile.sql</code> å¤‡ä»½æ–‡ä»¶ã€‚</p>
<p>æ¥ä¸‹å»å°±æ˜¯æ€ä¹ˆæŠŠè¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ° Google Drive äº†ã€‚</p>
<h2 id="2-ä¸Šä¼ åˆ°-Google-Drive"><a href="#2-ä¸Šä¼ åˆ°-Google-Drive" class="headerlink" title="2. ä¸Šä¼ åˆ° Google Drive"></a>2. ä¸Šä¼ åˆ° Google Drive</h2><p>å…ˆçœ‹ <a href="https://developers.google.com/drive/api/v3/manage-uploads" target="_blank" rel="noopener">Google Drive API</a>ï¼Œé˜…è¯»æ–‡æ¡£å¯çŸ¥ï¼Œè¦ä¸Šä¼ æ–‡ä»¶éœ€è¦ä¸€ä¸‹ä¸¤æ­¥ï¼š</p>
<ul>
<li>è°ƒç”¨ <code>POST https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable</code> æˆ–è€… <code>PUT https://www.googleapis.com/upload/drive/v3/files/[FILE_ID]?uploadType=resumable</code> ä¸¤ä¸ªæ¥å£æ¥è¯·æ±‚å¢åŠ ä¸€ä¸ªæ–‡ä»¶æˆ–è€…æ›´æ–°æŸä¸€ä¸ªæ–‡ä»¶ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œåªæ˜¯è¯·æ±‚ï¼Œå¹¶ä¸æ˜¯çœŸæ­£ä¸Šä¼ æ•°æ®ï¼‰ã€‚</li>
<li>ä¸Šä¸ªæ¥å£è°ƒç”¨æˆåŠŸä¹‹åï¼ŒResponse ä¸­ä¼šè¿”å›ä¸€ä¸ª <code>Location</code> çš„ <code>header</code>ï¼Œå®ƒæŒ‡å®šäº†æ–­ç‚¹ç»­ä¼ çš„ session URLï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨è¿™ä¸ª URL æ¥è¿›è¡ŒçœŸæ­£çš„ä¸Šä¼ æ“ä½œäº†ã€‚</li>
</ul>
<h3 id="OAuth2-è®¤è¯"><a href="#OAuth2-è®¤è¯" class="headerlink" title="OAuth2 è®¤è¯"></a>OAuth2 è®¤è¯</h3><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¾—åˆ°è®¤è¯ï¼ˆè¯·æ±‚ header ä¸­çš„ <code>access_token</code>ï¼‰ï¼Œè¿™æ ·æ‰èƒ½ Google æ‰èƒ½çŸ¥é“æ˜¯è°åœ¨ä¸Šä¼ æ–‡ä»¶ï¼Œæ˜¯ä¸æ˜¯åˆæ³•çš„ã€‚</p>
<p>å› ä¸º Google æ˜¯ä½¿ç”¨ OAuth2 è¿›è¡Œè®¤è¯çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹åœ¨è®¤è¯æ—¶ï¼Œéœ€è¦è·³å‡ºä¸€ä¸ªç•Œé¢è®©ç”¨æˆ·ï¼ˆå¦‚æœæœªç™»å½•åˆ™ç™»å½•ï¼‰ç‚¹å‡»æˆæƒä¹‹åï¼Œæ‰èƒ½è¿›è¡Œæˆæƒã€‚ä½†æ˜¯è¿™æ ·çš„è¯ï¼Œè‡ªåŠ¨åŒ–çš„æµç¨‹å°±è¢«ä¸­æ–­äº†ã€‚</p>
<p>é‚£æ€ä¹ˆæ ·æ‰èƒ½åœ¨ä¸è·³å‡ºç•Œé¢æˆæƒçš„æƒ…å†µä¸‹è¿›è¡Œæˆæƒå‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨ <a href="https://developers.google.com/oauthplayground/" target="_blank" rel="noopener">oauthplayground</a></p>
<h4 id="åˆ›å»ºå‡­æ®"><a href="#åˆ›å»ºå‡­æ®" class="headerlink" title="åˆ›å»ºå‡­æ®"></a>åˆ›å»ºå‡­æ®</h4><p>æ‰“å¼€ <a href="https://console.developers.google.com" target="_blank" rel="noopener">console</a> ä¸­ç‚¹å‡»åˆ›å»ºå‡­æ®ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/58694368-694d9980-83c5-11e9-9ed2-6984df687679.png" width="600px"><br></div>

<p>åº”ç”¨ç±»å‹é€‰æ‹© <code>Web åº”ç”¨</code>ï¼Œåç§°éšæ„ï¼Œåˆ›å»ºå®Œæ¯•ä¹‹åï¼Œå¤åˆ¶ <code>client id</code> å’Œ <code>client secret</code>ã€‚</p>
<h4 id="ä½¿ç”¨-OAuth-Playground"><a href="#ä½¿ç”¨-OAuth-Playground" class="headerlink" title="ä½¿ç”¨ OAuth Playground"></a>ä½¿ç”¨ OAuth Playground</h4><p>æ‰“å¼€ <a href="https://developers.google.com/oauthplayground/" target="_blank" rel="noopener">oauthplayground</a>ï¼Œç‚¹å‡»å³ä¸Šè§’çš„è®¾ç½®æŒ‰é’®ï¼Œå¦‚ä¸‹ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/58694633-12948f80-83c6-11e9-9cd6-b35589b41362.png" width="400px"><br></div>

<p>å‹¾é€‰ <code>Use your own OAuth credentials</code>ï¼Œä½¿ç”¨è‡ªå·±çš„ OAuth è¯ä¹¦ï¼Œç„¶åå¡«å†™ä¸Šä¸€æ­¥åˆ›å»ºçš„ <code>Client ID</code> å’Œ <code>Client Secret</code>ã€‚</p>
<p>å·¦è¾¹å¦‚ä¸‹å‹¾é€‰ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/58693610-bdf01500-83c3-11e9-80c3-8b25ed37ac30.png" width="400px"><br></div>

<p>ç‚¹å‡» <code>Authorize API</code> ä¹‹åï¼Œå¤åˆ¶ <code>Refresh token</code>ï¼ˆæ³¨æ„æ˜¯ <code>refresh token</code>ï¼Œä¸æ˜¯ <code>access token</code>ï¼‰ã€‚</p>
<p>æ‹¿åˆ° refresh token ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ refresh token é€šè¿‡ä»¥ä¸‹æ¥å£æ¥ç½®æ¢ä¸€ä¸ª <code>access token</code>ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">REFRESH_RESPONSE=`curl --silent \</span><br><span class="line">	https://www.googleapis.com/oauth2/v4/token \</span><br><span class="line">	--data-raw "client_secret=[ä½ çš„client secret]&amp;grant_type=refresh_token&amp;refresh_token=[ä½ çš„refresh token]&amp;client_id=[ä½ çš„client id]"`</span><br><span class="line"></span><br><span class="line">echo "refresh response: $REFRESH_RESPONSE"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> è·å– token</span><br><span class="line">ACCESS_TOKEN=`grep -o "\"access_token\"\s*:\s*\".*\"" &lt;&lt;&lt;"$REFRESH_RESPONSE" | sed -n -e 's/"//gp' | awk -F': ' '&#123;print $2&#125;'`</span><br><span class="line">echo "Token: $ACCESS_TOKEN"</span><br></pre></td></tr></table></figure>
<p>è‡³æ­¤å°±æ‹¿åˆ°äº†éœ€è¦çš„ <code>access token</code>ã€‚</p>
<h4 id="æ‰§è¡Œä¸Šä¼ "><a href="#æ‰§è¡Œä¸Šä¼ " class="headerlink" title="æ‰§è¡Œä¸Šä¼ "></a>æ‰§è¡Œä¸Šä¼ </h4><p>æ ¹æ® <a href="https://developers.google.com/drive/api/v3/manage-uploads" target="_blank" rel="noopener">Google Drive API æ–‡æ¡£</a>ï¼Œä¸Šä¼ æ–‡ä»¶æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<h5 id="åˆ›å»ºæ–‡ä»¶"><a href="#åˆ›å»ºæ–‡ä»¶" class="headerlink" title="åˆ›å»ºæ–‡ä»¶"></a>åˆ›å»ºæ–‡ä»¶</h5><blockquote>
<p>æ¥å£ï¼š<code>POST https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable</code></p>
</blockquote>
<p>å½“ç¬¬ä¸€æ¬¡å¤‡ä»½æ—¶ï¼ŒGoogle Drive ä¸Šæ˜¯éœ€è¦è°ƒç”¨è¿™ä¸ªæ¥å£åˆ›å»ºçš„ã€‚</p>
<p>è¿™ä¸ªæ¥å£ä¸­ï¼Œæ¥å£ä¸­éœ€è¦ä¼ å…¥ <code>parents.id</code> å‚æ•°ï¼Œè¡¨ç¤ºæˆ‘ä¸Šä¼ çš„å¤‡ä»½æ–‡ä»¶åº”è¯¥ä¸Šä¼ åˆ°å“ªä¸ªç›®å½•ä¸­ã€‚ä½ å¯ä»¥åœ¨ Google Drive çš„ä»»ä½•ä½ç½®åˆ›å»ºç›®å½•ï¼Œé€šè¿‡ <code>url</code> æ¥è·å–è¯¥ç›®å½•çš„ idï¼Œå¦‚ä¸‹ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/58695525-3bb61f80-83c8-11e9-855b-a0fff7737548.png" width="600px"><br></div>

<p>URL æ¶‚é»‘çš„ Path segment å°±æ˜¯ folder çš„ idã€‚</p>
<h5 id="ä¿®æ”¹æ–‡ä»¶"><a href="#ä¿®æ”¹æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶"></a>ä¿®æ”¹æ–‡ä»¶</h5><blockquote>
<p>æ¥å£ï¼š<code>PUT https://www.googleapis.com/upload/drive/v3/files/[FILE_ID]?uploadType=resumable</code></p>
</blockquote>
<p>ç¬¬äºŒæ¬¡å¤‡ä»½å¼€å§‹ä¹‹åï¼Œæˆ‘ä»¬å°±ç”¨è¿™ä¸ªæ–¹æ³•æ¥ä¸æ–­åœ°ä¿®æ”¹ä¸Šä¸€æ¬¡çš„å¤‡ä»½æ–‡ä»¶ã€‚</p>
<p>å› ä¸ºæ˜¯éœ€è¦ä¿®æ”¹æ–‡ä»¶ï¼Œæ‰€ä»¥è¿™ä¸ªæ¥å£ä¸­é™¤äº†çˆ¶ç›®å½•çš„ id ä¹‹å¤–è¿˜éœ€è¦é€šè¿‡ <code>fileId</code> url å‚æ•° æ¥æŒ‡å®šä½ è¦ä¿®æ”¹çš„æŸä¸ªæ–‡ä»¶ï¼Œåªè¦æ‰§è¡Œç¬¬ä¸€ä¸ªå¤‡ä»½ä¹‹åï¼Œä½ å°±å¯ä»¥åœ¨ Google Drive ä¸­æ‹¿åˆ°å¯¹åº”ä¸Šä¼ çš„å¤‡ä»½æ•°æ®çš„ idï¼Œå¦‚ä¸‹é€‰ä¸­æ–‡ä»¶åå³é”®ï¼Œç‚¹å‡»è·å–å…±äº«é“¾æ¥ï¼Œä½ å°±å¤åˆ¶äº†è¯¥æ–‡ä»¶çš„å…±äº«åœ°å€ï¼Œæ ¼å¼ç±»ä¼¼ï¼š <code>https://drive.google.com/open?id=1-a68Gyxxxxxxxxxx4OgxMNufpB</code>ï¼Œæœ€åçš„ id å°±æ˜¯è¯¥æ–‡ä»¶çš„ id äº†ï¼Œä½ å¯ä»¥æ‹¿åˆ° id ä¹‹åæŠŠåˆ†äº«å…³é—­ã€‚</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/58696063-5b017c80-83c9-11e9-8f8b-bb6e0e0cb539.png" width="400px"><br></div>

<h4 id="å®Œæ•´çš„ä¸Šä¼ è„šæœ¬"><a href="#å®Œæ•´çš„ä¸Šä¼ è„šæœ¬" class="headerlink" title="å®Œæ•´çš„ä¸Šä¼ è„šæœ¬"></a>å®Œæ•´çš„ä¸Šä¼ è„šæœ¬</h4><p><strong>huginn-backup.sh</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line">sudo docker exec huginn bash -c "mysqldump --single-transaction --opt -u [æ•°æ®åº“ç”¨æˆ·å] -ppassword [æ•°æ®åº“å¯†ç ] &gt; /app/huginn_backupfile_tmp.sql"</span><br><span class="line"></span><br><span class="line">docker cp huginn:/app/huginn_backupfile_tmp.sql .</span><br><span class="line"></span><br><span class="line">sudo docker exec huginn bash -c "rm /app/huginn_backupfile_tmp.sql"</span><br><span class="line"></span><br><span class="line">mv huginn_backupfile_tmp.sql huginn_backupfile.sql</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> upload</span><br><span class="line">CURRENT_PATH=`pwd`</span><br><span class="line">cd ../drive_script</span><br><span class="line">./upload.sh $CURRENT_PATH/$NEW_BACKUP_FILE_NAME [ç›®å½• id] [æ–‡ä»¶ id]</span><br></pre></td></tr></table></figure>
<p><strong>upload.sh</strong>ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>###</span><br><span class="line"><span class="meta">#</span>### x.sh [FILE] [FOLDER_ID] [FILE_ID]</span><br><span class="line"><span class="meta">#</span>###</span><br><span class="line"></span><br><span class="line">// client sercret, client id, refresh token ç­‰æ•°æ®ä¿å­˜åœ¨äº†åŒç›®å½•çš„æ–‡ä»¶ä¸­</span><br><span class="line">CLIENT_SERCRET=`cat CLIENT_SERCRET`</span><br><span class="line">REFRESH_TOKEN=`cat REFRESH_TOKEN`</span><br><span class="line">CLIENT_ID=`cat CLIENT_ID`</span><br><span class="line"></span><br><span class="line">REFRESH_RESPONSE=`curl --silent \</span><br><span class="line">	https://www.googleapis.com/oauth2/v4/token \</span><br><span class="line">	--data-raw "client_secret=$CLIENT_SERCRET&amp;grant_type=refresh_token&amp;refresh_token=$REFRESH_TOKEN&amp;client_id=$CLIENT_ID"`</span><br><span class="line"></span><br><span class="line">echo "refresh response: $REFRESH_RESPONSE"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> è·å– token</span><br><span class="line">ACCESS_TOKEN=`grep -o "\"access_token\"\s*:\s*\".*\"" &lt;&lt;&lt;"$REFRESH_RESPONSE" | sed -n -e 's/"//gp' | awk -F': ' '&#123;print $2&#125;'`</span><br><span class="line">echo "Token: $ACCESS_TOKEN"</span><br><span class="line"></span><br><span class="line">FILE="$1"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> FOLDER_ID="1nd6K7J7IYcuCbqQ4laX_1uFkP39h3Akz"</span><br><span class="line">FOLDER_ID="$2"</span><br><span class="line">FILE_ID="$3"</span><br><span class="line"><span class="meta">#</span>ACCESS_TOKEN="$3"</span><br><span class="line">MIME_TYPE=`file --brief --mime-type "$FILE"`</span><br><span class="line">SLUG=`basename "$FILE"`</span><br><span class="line"><span class="meta">#</span>FILE_SIZE=`stat -c%s "$FILE"`</span><br><span class="line">FILE_SIZE=`wc -c &lt; $FILE | awk '&#123;print $1&#125;'`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">postData="&#123;\"mimeType\": \"$MIME_TYPE\",\"title\": \"$SLUG\",\"parents\": [&#123;\"id\": \"$FOLDER_ID\"&#125;]&#125;"</span><br><span class="line">    postDataSize=$(echo $postData | wc -c)</span><br><span class="line"></span><br><span class="line">echo "FILE_ID: $FILE_ID"</span><br><span class="line"></span><br><span class="line">echo "Generating upload link for file $FILE ..."</span><br><span class="line"></span><br><span class="line">if [ "$FILE_ID" = "" ]</span><br><span class="line">then</span><br><span class="line">	uploadlink=`curl --silent \</span><br><span class="line">                -X POST \</span><br><span class="line">                -H "Host: www.googleapis.com" \</span><br><span class="line">                -H "Authorization: Bearer $&#123;ACCESS_TOKEN&#125;" \</span><br><span class="line">                -H "Content-Type: application/json; charset=UTF-8" \</span><br><span class="line">                -H "X-Upload-Content-Type: $MIME_TYPE" \</span><br><span class="line">                -H "X-Upload-Content-Length: $FILE_SIZE" \</span><br><span class="line">                -d "$postData" \</span><br><span class="line">                "https://www.googleapis.com/upload/drive/v2/files?uploadType=resumable" \</span><br><span class="line">                -v -# \</span><br><span class="line">                --dump-header - | sed -ne s/"Location: "//p | tr -d '\r\n'`</span><br><span class="line">else</span><br><span class="line">	echo "FILE_ID not empty: $&#123;FILE_ID&#125;"</span><br><span class="line">	uploadlink=`curl --silent \</span><br><span class="line">                -X PUT \</span><br><span class="line">                -H "Host: www.googleapis.com" \</span><br><span class="line">                -H "Authorization: Bearer $&#123;ACCESS_TOKEN&#125;" \</span><br><span class="line">                -H "Content-Type: application/json; charset=UTF-8" \</span><br><span class="line">                -H "X-Upload-Content-Type: $MIME_TYPE" \</span><br><span class="line">                -H "X-Upload-Content-Length: $FILE_SIZE" \</span><br><span class="line">                -d "$postData" \</span><br><span class="line">                "https://www.googleapis.com/upload/drive/v2/files/$&#123;FILE_ID&#125;?uploadType=resumable" \</span><br><span class="line">                -v -# \</span><br><span class="line">                --dump-header - | sed -ne s/"Location: "//p | tr -d '\r\n'`</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo "uploadlink: $uploadlink"</span><br><span class="line"></span><br><span class="line">echo "Uploading file $FILE to google drive..."</span><br><span class="line">curl \</span><br><span class="line">    -X PUT \</span><br><span class="line">    -H "Authorization: Bearer $&#123;ACCESS_TOKEN&#125;" \</span><br><span class="line">    -H "Content-Type: $MIME_TYPE" \</span><br><span class="line">    -H "Content-Length: $FILE_SIZE" \</span><br><span class="line">    -H "Slug: $SLUG" \</span><br><span class="line">    --data-binary "@$FILE" \</span><br><span class="line">    --output ./output \</span><br><span class="line">    "$uploadlink" \</span><br><span class="line">    $curl_args \</span><br><span class="line">    -v -#</span><br></pre></td></tr></table></figure>
<h2 id="3-è®¾ç½®è‡ªåŠ¨è°ƒåº¦"><a href="#3-è®¾ç½®è‡ªåŠ¨è°ƒåº¦" class="headerlink" title="3. è®¾ç½®è‡ªåŠ¨è°ƒåº¦"></a>3. è®¾ç½®è‡ªåŠ¨è°ƒåº¦</h2><p>ä¸Šä¼ è„šæœ¬æå®šäº†ï¼Œæœ€åéœ€è¦é€šè¿‡ <code>crontab</code> æ¥è®¾ç½®è‡ªåŠ¨è°ƒåº¦ä»»åŠ¡ã€‚</p>
<p>æ‰§è¡Œ <code>crontab -e</code>ï¼Œå¦‚ä¸‹ç¼–è¾‘ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> huginn backup 23:30 every day</span><br><span class="line">30 23 * * * cd ~/backup/huginn &amp;&amp; /bin/sh huginn-backup.sh &gt;&gt; ~/backup/huginn/cron-huginn.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ¯å¤©æ™šä¸Š11ç‚¹30åˆ†æ‰§è¡Œå¤‡ä»½</p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> huginn </category>
            
            <category> backup </category>
            
            <category> Google Drive </category>
            
        </categories>
        
        
        <tags>
            
            <tag> automate </tag>
            
            <tag> huginn </tag>
            
            <tag> backup </tag>
            
            <tag> Google Drive </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Jenkins æ·»åŠ  MacOS èŠ‚ç‚¹]]></title>
      <url>/2019/04/02/jenkins-add-macos-node/</url>
      <content type="html"><![CDATA[<h1 id="Jenkins-æ·»åŠ -MacOS-èŠ‚ç‚¹"><a href="#Jenkins-æ·»åŠ -MacOS-èŠ‚ç‚¹" class="headerlink" title="Jenkins æ·»åŠ  MacOS èŠ‚ç‚¹"></a>Jenkins æ·»åŠ  MacOS èŠ‚ç‚¹</h1><blockquote>
<p><code>Master</code> ä¸º Linuxï¼Œä½†æ˜¯éœ€è¦æ”¯æŒ iOS çš„æ„å»ºï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ  <code>MacOS</code> çš„ <code>Slave</code>ã€‚</p>
</blockquote>
<h2 id="å¼€å¯-Slave-çš„-SSH-è¿œç¨‹ç™»å½•"><a href="#å¼€å¯-Slave-çš„-SSH-è¿œç¨‹ç™»å½•" class="headerlink" title="å¼€å¯ Slave çš„ SSH è¿œç¨‹ç™»å½•"></a>å¼€å¯ Slave çš„ SSH è¿œç¨‹ç™»å½•</h2><p>åœ¨ MacOS çš„ <code>è®¾ç½®</code> -&gt; <code>å…±äº«</code> ä¸­å¦‚ä¸‹è®¾ç½®ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/55370715-0018e980-552e-11e9-997c-7b55b17b785d.png" width="600px"><br></div>

<h2 id="é…ç½®æƒé™"><a href="#é…ç½®æƒé™" class="headerlink" title="é…ç½®æƒé™"></a>é…ç½®æƒé™</h2><p>åœ¨ <code>Master</code> ä¸Šå¤åˆ¶ sshï¼ˆ<code>~/.ssh/id_rsa</code>ï¼‰ çš„ <code>private key</code>ã€‚</p>
<p>å¢åŠ åˆ° jenkins çš„ <code>Credentials</code> ä¸­ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/55369900-11142b80-552b-11e9-9e06-3373884b84c0.png" width="800px"><br></div>

<p>é€‰æ‹© <code>SSH Username with private key</code>ï¼Œ<code>Private Key</code> å‹¾é€‰ <code>Enter directly</code>ï¼ŒæŠŠ <code>Master</code> çš„ <code>private key</code> å¤åˆ¶è¿›å»ã€‚</p>
<p>å¤åˆ¶ <code>Master</code> sshï¼ˆ<code>~/.ssh/id_rsa.pub</code>ï¼‰çš„ <code>public key</code></p>
<p>åœ¨ <code>Slave(MacOS)</code> ä¸­æ–°å»º <code>~/.ssh/authorized_keys</code>ï¼ŒæŠŠ <code>Master</code> çš„ <code>public key</code> å¤åˆ¶è¿›å»ã€‚</p>
<h2 id="åœ¨-Jenkins-ä¸Šå¢åŠ -Node"><a href="#åœ¨-Jenkins-ä¸Šå¢åŠ -Node" class="headerlink" title="åœ¨ Jenkins ä¸Šå¢åŠ  Node"></a>åœ¨ Jenkins ä¸Šå¢åŠ  Node</h2><div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/55370117-0017ea00-552c-11e9-8e83-94075d37092e.png" width="800px"><br></div>

<p>å¦‚ä¸Šï¼š</p>
<p><code>Node Name</code> éšæ„ã€‚</p>
<p>é€‰æ‹© <code>Permanent Agent</code>ã€‚</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/55370326-b4197500-552c-11e9-8ba1-d617b9eff459.png" width="800px"><br></div>

<ul>
<li><code>Name</code>ã€<code>Description</code> éšæ„ã€‚</li>
<li><code># of executors</code>ï¼šè¡¨ç¤ºæ„å»ºå¹¶å‘æ•°ï¼Œå…·ä½“è§† Slave çš„ç¡¬ä»¶é…ç½®å†³å®šã€‚</li>
<li><code>Remote root directory</code>ï¼šSlave çš„ workspace</li>
<li><code>Labels</code>ï¼šå¯ç”¨äºåœ¨ Job ä¸­é€šè¿‡è¯¥ Label æ¥æŒ‡å®šè¿è¡Œåœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šã€‚</li>
<li><code>Launch method</code>ï¼šé€‰æ‹© <code>Launch agent agents via SSH</code>ã€‚<ul>
<li><code>Host</code>ï¼šSlave çš„ host</li>
<li><code>Credentials</code>ï¼šé€‰æ‹©åˆšåˆšåˆ›å»ºçš„ Credentialã€‚</li>
</ul>
</li>
<li><code>Node Node Properties</code>ï¼šå¦‚æœéœ€è¦é…ç½®è¯¥ Slave çš„ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥åœ¨è¿™é‡Œé…ç½®ã€‚</li>
</ul>
<h2 id="å¯åŠ¨èŠ‚ç‚¹"><a href="#å¯åŠ¨èŠ‚ç‚¹" class="headerlink" title="å¯åŠ¨èŠ‚ç‚¹"></a>å¯åŠ¨èŠ‚ç‚¹</h2><p>ä¿å­˜å®Œæ¯•åï¼Œç‚¹å‡» <code>Launch</code> æˆåŠŸåå¦‚ä¸‹ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/55370854-91885b80-552e-11e9-94a7-88af5907f341.png" width="800px"><br></div>]]></content>
      
        <categories>
            
            <category> jenkins </category>
            
            <category> CI </category>
            
            <category> æŒç»­é›†æˆ </category>
            
            <category> Continuous Integration </category>
            
            <category> iOS </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CI </tag>
            
            <tag> jenkins </tag>
            
            <tag> iOS </tag>
            
            <tag> æŒç»­é›†æˆ </tag>
            
            <tag> Continuous Integration </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ğŸ§¾ Scrum æ£€æŸ¥æ¸…å•]]></title>
      <url>/2019/03/04/scrum_checklist/</url>
      <content type="html"><![CDATA[<h1 id="Scrum-æ£€æŸ¥æ¸…å•"><a href="#Scrum-æ£€æŸ¥æ¸…å•" class="headerlink" title="Scrum æ£€æŸ¥æ¸…å•"></a>Scrum æ£€æŸ¥æ¸…å•</h1><blockquote>
<p><strong>PO</strong> = Product Owner</p>
<p><strong>SM</strong> = Scrum Master</p>
<p><strong>PBL</strong> = Product Backlog</p>
<p><strong>DoD</strong> = Definition of Done</p>
</blockquote>
<h2 id="åŸºæœ¬æ¡ç›®ï¼š"><a href="#åŸºæœ¬æ¡ç›®ï¼š" class="headerlink" title="åŸºæœ¬æ¡ç›®ï¼š"></a>åŸºæœ¬æ¡ç›®ï¼š</h2><blockquote>
<p>å¦‚æœä½ åšåˆ°äº†è¿™äº›ï¼Œå°±å¯ä»¥å¿½ç•¥æ£€æŸ¥æ¸…å•çš„å…¶ä»–éƒ¨åˆ†ï¼Œä½ çš„è¿‡ç¨‹è¿˜ä¸é”™</p>
</blockquote>
<ul>
<li>æ¯ä¸ªè¿­ä»£ï¼ˆ4 å‘¨ä»¥å†…ï¼‰äº¤ä»˜<strong>æµ‹è¯•è¿‡ä¸”å¯å·¥ä½œçš„è½¯ä»¶</strong></li>
<li>äº¤ä»˜<strong>ä¸šåŠ¡æœ€éœ€è¦</strong>çš„å†…å®¹</li>
<li><strong>æŒç»­åœ°æ”¹è¿›</strong>è¿‡ç¨‹</li>
</ul>
<h2 id="Scrum-æ ¸å¿ƒï¼š"><a href="#Scrum-æ ¸å¿ƒï¼š" class="headerlink" title="Scrum æ ¸å¿ƒï¼š"></a>Scrum æ ¸å¿ƒï¼š</h2><blockquote>
<p>è¿™äº›æ˜¯ Scrum çš„ä¸»è¦å…ƒç´ ã€‚æ²¡æœ‰å®ƒä»¬ï¼Œä½ å°±ä¸èƒ½ç§°ä¹‹ä¸º Scrum</p>
</blockquote>
<ul>
<li>æ˜ç¡®<strong>äº§å“è´Ÿè´£äººï¼ˆPOï¼‰</strong><ul>
<li><strong>PO æœ‰æƒ</strong>è¿›è¡Œä¼˜å…ˆçº§æ’åº</li>
<li><strong>PO æœ‰çŸ¥è¯†</strong>è¿›è¡Œä¼˜å…ˆçº§æ’åº</li>
<li>PO ç›´æ¥<strong>ä¸å›¢é˜Ÿæ¥è§¦</strong></li>
<li>PO ç›´æ¥<strong>ä¸åˆ©ç›Šç›¸å…³è€…æ¥è§¦</strong></li>
<li>å½“ PO æ˜¯ä¸€ä¸ªå›¢é˜Ÿæ—¶ï¼ŒPO ä»¬<strong>ç»Ÿä¸€å£å¾„</strong></li>
</ul>
</li>
<li>å›¢é˜Ÿæ‹¥æœ‰ä¸€ä¸ª<strong>è¿­ä»£å¾…åŠäº‹é¡¹åˆ—è¡¨ï¼ˆsprint backlogï¼‰</strong><ul>
<li>é«˜åº¦<strong>å¯è§†åŒ–</strong></li>
<li>æ¯æ—¥<strong>æ›´æ–°</strong></li>
<li>å®Œå…¨åœ°ç”±<strong>å›¢é˜Ÿ</strong>æ‹¥æœ‰</li>
</ul>
</li>
<li>ä¸¾è¡Œ<strong>æ¯æ—¥ç«™ä¼š</strong>ï¼ˆdaily scrumï¼‰<ul>
<li>å›¢é˜Ÿå…¨å‘˜å‚åŠ </li>
<li>æš´éœ²å‡ºé—®é¢˜å’Œéšœç¢</li>
</ul>
</li>
<li>æ¯ä¸ªè¿­ä»£åä¸¾è¡Œ<strong>æ¼”ç¤ºï¼ˆdemoï¼‰</strong><ul>
<li>å±•ç¤º<strong>æµ‹è¯•è¿‡ä¸”å¯å·¥ä½œçš„è½¯ä»¶</strong></li>
<li>æ”¶åˆ°æ¥è‡ªåˆ©ç›Šç›¸å…³è€…å’Œ PO çš„<strong>åé¦ˆ</strong></li>
</ul>
</li>
<li>å…·æœ‰<strong>å®Œæˆçš„å®šä¹‰ï¼ˆDoDï¼‰</strong><ul>
<li>DoD åœ¨æ¯ä¸ªè¿­ä»£å†…éƒ½æ˜¯<strong>åˆ‡å®å¯è¡Œçš„</strong></li>
<li>å›¢é˜Ÿ<strong>å°Šé‡ DoD</strong></li>
</ul>
</li>
<li>æ¯ä¸ªè¿­ä»£ç»“æŸä¹‹åéƒ½ä¸¾è¡Œ<strong>å›é¡¾ï¼ˆretrospectiveï¼‰</strong><ul>
<li>äº§å“å…·ä½“çš„æ”¹è¿›<strong>ææ¡ˆ</strong></li>
<li>ä¸€äº›ææ¡ˆçœŸæ­£å¾—åˆ°<strong>å®ç°</strong></li>
<li><strong>å›¢é˜Ÿå…¨å‘˜å’Œ PO</strong> å‚åŠ </li>
</ul>
</li>
<li>PO æ‹¥æœ‰ä¸€ä¸ª<strong>äº§å“å¾…åŠäº‹é¡¹åˆ—è¡¨</strong><ul>
<li>é«˜ä¼˜å…ˆçº§å¾…åŠäº‹é¡¹æ˜¯æŒ‰ä¸šåŠ¡ä»·å€¼<strong>æ’åºè¿‡çš„</strong></li>
<li>é«˜ä¼˜å…ˆçº§å¾…åŠäº‹é¡¹æ˜¯<strong>ä¼°ç®—è¿‡çš„</strong></li>
<li>ç”±<strong>å›¢é˜Ÿè¿›è¡Œä¼°ç®—</strong></li>
<li>é«˜ä¼˜å…ˆçº§å¾…åŠäº‹é¡¹<strong>ç²’åº¦è¶³å¤Ÿç»†ï¼Œå¯ä»¥æ”¾å…¥ä¸€ä¸ªè¿­ä»£å†…</strong></li>
<li>PO ç†è§£æ‰€æœ‰å¾…åŠäº‹é¡¹çš„<strong>ç›®çš„</strong></li>
</ul>
</li>
<li>ä¸¾è¡Œ<strong>è¿­ä»£è®¡åˆ’ä¼šè®®ï¼ˆsprint planning meetingsï¼‰</strong><ul>
<li><strong>PO å‚åŠ </strong></li>
<li>PO å±•ç¤º<strong>æœ€æ–°çš„äº§å“å¾…åŠäº‹é¡¹åˆ—è¡¨</strong></li>
<li><strong>å›¢é˜Ÿå…¨å‘˜</strong>å‚åŠ </li>
<li>äº§å‡º<strong>è¿­ä»£è®¡åˆ’</strong>ï¼ˆsprint planï¼‰</li>
<li>å›¢é˜Ÿå…¨å‘˜ç›¸ä¿¡è®¡åˆ’æ˜¯<strong>åˆ‡å®å¯è¡Œçš„</strong></li>
<li><strong>PO å¯¹å¾…åŠäº‹é¡¹çš„ä¼˜å…ˆçº§æ»¡æ„</strong></li>
</ul>
</li>
<li>åŸºäºæ—¶é—´ç›’çš„<strong>è¿­ä»£</strong><ul>
<li>è¿­ä»£é•¿åº¦<strong>å°äºç­‰äº 4 å‘¨</strong></li>
<li>æ€»æ˜¯<strong>æŒ‰æ—¶ç»“æŸ</strong></li>
<li>å›¢é˜Ÿ<strong>ä¸è¢«å¤–éƒ¨æ‰“æ‰°æˆ–æ§åˆ¶</strong></li>
<li>å›¢é˜Ÿé€šå¸¸èƒ½å¤Ÿ<strong>äº¤ä»˜ä»–ä»¬æ‰¿è¯ºçš„å†…å®¹</strong></li>
</ul>
</li>
<li>å›¢é˜Ÿæˆå‘˜<strong>ååœ¨ä¸€èµ·</strong><ul>
<li>æ¯ä¸ªå›¢é˜Ÿ<strong>æœ€å¤š 9 äºº</strong></li>
</ul>
</li>
</ul>
<h2 id="Scrum-æ£€æŸ¥æ¸…å•ï¼š"><a href="#Scrum-æ£€æŸ¥æ¸…å•ï¼š" class="headerlink" title="Scrum æ£€æŸ¥æ¸…å•ï¼š"></a>Scrum æ£€æŸ¥æ¸…å•ï¼š</h2><blockquote>
<p>æ¨èä½†ä¸æ˜¯å¿…é¡»çš„ï¼Œå¤§å¤šæ•°é€šå¸¸æ˜¯éœ€è¦çš„ï¼Œä½†ä¸æ˜¯æ‰€æœ‰ï¼Œå¯ä»¥å°è¯•</p>
</blockquote>
<ul>
<li>å›¢é˜Ÿå…·å¤‡å¾…åŠäº‹é¡¹çš„<strong>æ‰€æœ‰æŠ€èƒ½</strong></li>
<li>å›¢é˜Ÿæˆå‘˜<strong>ä¸ä¼šå±€é™äºç‰¹å®šçš„è§’è‰²</strong></li>
<li><strong>æ³¨å®šå¤±è´¥</strong>çš„è¿­ä»£è¶æ—©ç»“æŸ</li>
<li>PO çš„<strong>äº§å“æ„¿æ™¯</strong>ä½“ç°åœ¨äº§å“å¾…åŠäº‹é¡¹åˆ—è¡¨ä¸­</li>
<li>äº§å“å¾…åŠäº‹é¡¹åˆ—è¡¨å’Œäº§å“æ„¿æ™¯<strong>é«˜åº¦å¯è§†åŒ–</strong></li>
<li><strong>å›¢é˜Ÿå…¨å‘˜å‚ä¸ä¼°ç®—</strong></li>
<li>å›¢é˜Ÿä¼°ç®—æ—¶ <strong>PO åœ¨åœº</strong></li>
<li>ç”¨<strong>ç›¸å¯¹å¤§å°</strong>ï¼ˆæ•…äº‹ç‚¹ï¼‰è€Œä¸æ˜¯æ—¶é—´æ¥ä¼°ç®—</li>
<li>å›¢é˜Ÿéƒ½çŸ¥é“æœ€ç´§è¿«çš„<strong>1-3 æ¡éšœç¢</strong><ul>
<li><strong>SM å…·å¤‡åº”å¯¹ç­–ç•¥</strong>å»è§£å†³ç´§è¿«çš„éšœç¢</li>
<li><strong>SM ä¸“æ³¨äº</strong>ç§»é™¤éšœç¢</li>
<li>å½“å›¢é˜Ÿä¸èƒ½è§£å†³æ—¶æäº¤ç»™<strong>ç®¡ç†å±‚</strong></li>
</ul>
</li>
<li>å›¢é˜Ÿå…·æœ‰ä¸€ä¸ª <strong>Scrum Masterï¼ˆSMï¼‰</strong><ul>
<li>SM <strong>ä¸å›¢é˜Ÿååœ¨ä¸€èµ·</strong></li>
</ul>
</li>
<li>å½“å‰è¿­ä»£å†…çš„å¾…åŠäº‹é¡¹<strong>æ‹†åˆ†æˆä»»åŠ¡ï¼ˆtaskï¼‰</strong><ul>
<li>è¿­ä»£çš„ä»»åŠ¡æ˜¯<strong>ä¼°ç®—è¿‡çš„</strong></li>
<li><strong>æ¯æ—¥é‡æ–°ä¼°ç®—</strong>è¿›è¡Œä¸­çš„ä»»åŠ¡</li>
</ul>
</li>
<li>åº¦é‡<strong>é€Ÿç‡ï¼ˆvelocityï¼‰</strong><ul>
<li>è¿­ä»£è®¡åˆ’å†…çš„æ‰€æœ‰å¾…åŠäº‹é¡¹éƒ½æœ‰<strong>ä¼°ç®—å€¼</strong></li>
<li>PO åˆ©ç”¨é€Ÿç‡æ¥åš<strong>å‘å¸ƒè®¡åˆ’ï¼ˆrelease planningï¼‰</strong></li>
<li>é€Ÿç‡ä»…ç»Ÿè®¡<strong>å®Œæˆ</strong>çš„å¾…åŠäº‹é¡¹</li>
</ul>
</li>
<li>å›¢é˜Ÿæ‹¥æœ‰ä¸€ä¸ª<strong>è¿­ä»£ç‡ƒå°½å›¾</strong><ul>
<li>é«˜åº¦<strong>å¯è§†åŒ–</strong></li>
<li>æ¯æ—¥<strong>æ›´æ–°</strong></li>
</ul>
</li>
<li><strong>æ¯æ—¥ç«™ä¼šï¼ˆdaily scrumï¼‰</strong>æ¯å¤©ä¸¾è¡Œï¼Œå›ºå®šåœ°ç‚¹å’Œæ—¶é—´<ul>
<li><strong>PO æ¯å‘¨è‡³å°‘å‚åŠ å‡ æ¬¡</strong></li>
<li>æœ€é•¿ <strong>15åˆ†é’Ÿ</strong></li>
<li>æ¯ä¸ªå›¢é˜Ÿæˆå‘˜éƒ½<strong>çŸ¥é“å…¶ä»–äººåœ¨åšä»€ä¹ˆ</strong></li>
</ul>
</li>
</ul>
<h2 id="æ‰©å¤§è§„æ¨¡"><a href="#æ‰©å¤§è§„æ¨¡" class="headerlink" title="æ‰©å¤§è§„æ¨¡"></a>æ‰©å¤§è§„æ¨¡</h2><blockquote>
<p>ä»»ä½•æ‰©å¤§ scrum è§„æ¨¡çš„åŠªåŠ›éƒ½è¦å…·å¤‡çš„æœ€åŸºæœ¬æ¡ä»¶ï¼š</p>
</blockquote>
<ul>
<li>å­˜åœ¨ä¸€ä¸ª<strong>é¦–å¸­äº§å“è´Ÿè´£äººï¼ˆchief POï¼‰</strong></li>
<li>äº’ç›¸ä¾èµ–çš„å›¢é˜Ÿä¸¾è¡Œ <strong>Scrum of Scrumns</strong></li>
<li>äº’ç›¸ä¾èµ–çš„å›¢é˜Ÿ <strong>æ¯ä¸ªè¿­ä»£å†…è¿›è¡Œé›†æˆ</strong></li>
</ul>
<h2 id="ç§¯æä¿¡å·"><a href="#ç§¯æä¿¡å·" class="headerlink" title="ç§¯æä¿¡å·"></a>ç§¯æä¿¡å·</h2><blockquote>
<p>è‰¯å¥½çš„ Scrum å®æ–½çš„ä¸»è¦ä¿¡å·</p>
</blockquote>
<ul>
<li><strong>å¿«ä¹ï¼</strong>çƒ­æƒ…é¥±æ»¡</li>
<li><strong>å¾ˆå°‘åŠ ç­</strong>ä¸”è‡ªæ„¿å‘ç”Ÿ</li>
<li>å¯¹è¿‡ç¨‹è¿›è¡Œè®¨è®ºã€æ‰¹è¯„å’Œ<strong>å°è¯•</strong></li>
</ul>
]]></content>
      
        <categories>
            
            <category> æ•æ·å¼€å‘ </category>
            
            <category> é¡¹ç›®ç®¡ç† </category>
            
            <category> scrum </category>
            
        </categories>
        
        
        <tags>
            
            <tag> scrum </tag>
            
            <tag> æ•æ·å¼€å‘ </tag>
            
            <tag> å¼€å‘è¿‡ç¨‹ </tag>
            
            <tag> é¡¹ç›®ç®¡ç† </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åˆ¶ä½œä¸€ä¸ª SSR Docker é•œåƒ ğŸš€]]></title>
      <url>/2018/11/27/ssr_docker_image/</url>
      <content type="html"><![CDATA[<h1 id="åˆ¶ä½œä¸€ä¸ª-SSR-Docker-é•œåƒ"><a href="#åˆ¶ä½œä¸€ä¸ª-SSR-Docker-é•œåƒ" class="headerlink" title="åˆ¶ä½œä¸€ä¸ª SSR Docker é•œåƒ"></a>åˆ¶ä½œä¸€ä¸ª SSR Docker é•œåƒ</h1><p>åŸºäº <a href="https://github.com/teddysun/shadowsocks_install" target="_blank" rel="noopener">ç§‹æ°´é€¸å†°</a> å‘å¸ƒçš„ <a href="https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocksR.sh" target="_blank" rel="noopener">ä¸€é”®å®‰è£…è„šæœ¬</a> å†™çš„ <code>Dockerfile</code>ã€‚</p>
<p>å› ä¸ºå¹³æ—¶ä¼šåœ¨å¤šä¸ª vps ä¸Šéƒ½éƒ¨ç½²ä¸€å¥—ï¼Œæœ‰æ—¶å€™è¿˜ç»å¸¸æ¢ vpsï¼Œä½†æ˜¯åˆæ¯”è¾ƒæ‡’ï¼Œä¸æƒ³æ¯æ¬¡éƒ½å¾—é‡æ–°åˆ›å»ºè‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥ç´¢æ€§æŠŠé…ç½®æ–‡ä»¶ç›´æ¥æ”¾åœ¨é•œåƒé‡Œé¢ã€‚</p>
<blockquote>
<p>æœ¬æ–‡çš„é•œåƒæ–‡ä»¶å·²ç»ä¸Šä¼ åˆ° <a href="https://github.com/wangjiegulu/ssr_dockerfile" target="_blank" rel="noopener">Github</a>ï¼š<br><a href="https://github.com/wangjiegulu/ssr_dockerfile" target="_blank" rel="noopener">https://github.com/wangjiegulu/ssr_dockerfile</a><br>å¤§å®¶ clone ä¸‹æ¥ä¹‹åå¯ä»¥çœå»ç¼–å†™ Dockerfile æ–‡ä»¶æ­¥éª¤ï¼Œç›´æ¥è¿›å…¥åˆ° <a href="#build_image">æ„å»ºé•œåƒ</a> æ­¥éª¤ã€‚</p>
</blockquote>
<h2 id="ç¼–å†™-Dockerfile-æ–‡ä»¶"><a href="#ç¼–å†™-Dockerfile-æ–‡ä»¶" class="headerlink" title="ç¼–å†™ Dockerfile æ–‡ä»¶"></a>ç¼–å†™ Dockerfile æ–‡ä»¶</h2><p>ä»¥ä¸‹æ˜¯æœ€ç»ˆçš„ Dockerfile æ–‡ä»¶ï¼Œåé¢æˆ‘ä»¬å†åˆ†æé‡Œé¢çš„é‡è¦çš„ä¸€äº›æ­¥éª¤ï¼š</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Dockerfile for ShadowsocksR</span></span><br><span class="line"><span class="comment"># https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocksR.sh</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> debian:stretch</span><br><span class="line"></span><br><span class="line"><span class="keyword">LABEL</span> maintainer="Wang Jie &lt;tiantian.china.2@gmail.com&gt;"</span><br><span class="line"></span><br><span class="line"># prepare</span><br><span class="line">RUN apt-get update \</span><br><span class="line">  &amp;&amp; apt-get install -y procps \</span><br><span class="line">  &amp;&amp; apt-get install -y wget \</span><br><span class="line">  &amp;&amp; rm -rf /var/lib/apt/lists/* \</span><br><span class="line">  &amp;&amp; export PATH=$PATH:/usr/local/bin:/usr/bin:/bin:/sbin:/usr/local/games:/usr/games</span><br><span class="line"></span><br><span class="line"># install ssr</span><br><span class="line">RUN cd /usr/local \</span><br><span class="line">  &amp;&amp; mkdir ssr \</span><br><span class="line">  &amp;&amp; cd ssr \</span><br><span class="line">  &amp;&amp; wget --no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocksR.sh \</span><br><span class="line">  &amp;&amp; chmod +x shadowsocksR.sh \</span><br><span class="line">  &amp;&amp; \n | ./shadowsocksR.sh 2&gt;&amp;1 | tee shadowsocksR.log \</span><br><span class="line">  &amp;&amp; \n; exit 0</span><br><span class="line"></span><br><span class="line"># ssr configuration</span><br><span class="line">COPY shadowsocks.json /etc/</span><br><span class="line"></span><br><span class="line"># ssr script</span><br><span class="line">RUN cd /usr/local/ssr \</span><br><span class="line">  # fake log</span><br><span class="line">  &amp;&amp; touch fake_log.log \</span><br><span class="line">  # start.sh</span><br><span class="line">  &amp;&amp; touch start.sh \</span><br><span class="line">  &amp;&amp; echo 'python /usr/local/shadowsocks/server.py -c /etc/shadowsocks.json -d start &amp;&amp; tail -f /usr/local/ssr/fake_log.log' &gt; start.sh \</span><br><span class="line">  &amp;&amp; chmod 775 start.sh \</span><br><span class="line">  # stop.sh</span><br><span class="line">  &amp;&amp; touch stop.sh \</span><br><span class="line">  &amp;&amp; echo 'python /usr/local/shadowsocks/server.py -c /etc/shadowsocks.json -d stop' &gt; stop.sh \</span><br><span class="line">  &amp;&amp; chmod 775 stop.sh \</span><br><span class="line">  # restart.sh</span><br><span class="line">  &amp;&amp; touch restart.sh \</span><br><span class="line">  &amp;&amp; echo './stop.sh &amp;&amp; ./start.sh' &gt; restart.sh \</span><br><span class="line">  &amp;&amp; chmod 775 restart.sh</span><br><span class="line"></span><br><span class="line">ENTRYPOINT ["sh", "/usr/local/ssr/start.sh"]</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®ä»¥ä¸Šæ–‡ä»¶å¯çŸ¥ï¼š</p>
<ul>
<li>é¦–å…ˆæˆ‘ä»¬è¿™ä¸ª ssr é•œåƒæ˜¯åœ¨ linxus <code>debian stretch</code> è¿™ä¸ªç‰ˆæœ¬çš„åŸºç¡€ä¸Šåˆ¶ä½œçš„ã€‚</li>
<li>ç¬¬ä¸€ä¸ª <code>RUN</code> æ˜¯åšä¸€äº›æ„å»ºä¹‹å‰çš„å‡†å¤‡å·¥ä½œï¼š<ul>
<li>å®‰è£… <code>wget</code>ï¼Œä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ä¹‹åä» github ä¸‹è½½ <a href="https://github.com/teddysun/shadowsocks_install" target="_blank" rel="noopener">ç§‹æ°´é€¸å†°</a> å‘å¸ƒçš„ <a href="https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocksR.sh" target="_blank" rel="noopener">ä¸€é”®å®‰è£…è„šæœ¬</a> ã€‚</li>
<li>é…ç½®ç¯å¢ƒå˜é‡ã€‚</li>
</ul>
</li>
<li>ç¬¬äºŒä¸ª <code>RUN</code> æ˜¯ç”¨æ¥å®‰è£… ssrï¼Œå…ˆä¸‹è½½ <code>https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocksR.sh</code>ï¼Œç„¶åå†æ‰§è¡Œ <code>./shadowsocksR.sh 2&gt;&amp;1 | tee shadowsocksR.log</code>ï¼Œè¿™é‡Œå› ä¸ºè¿™ä¸ªè„šæœ¬æ˜¯äº¤äº’å¼çš„ï¼Œå®‰è£…è¿‡ç¨‹ä¸­ä¼šè®©ä½ é€‰æ‹©æ¯”å¦‚ç«¯å£å·ï¼ŒåŠ å¯†åè®®ç­‰ç­‰ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›ä¸€èµ·éƒ½æŒ‰ç…§é»˜è®¤çš„å®‰è£…ï¼Œæœ€åå†ç”¨æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶å»è¦†ç›–é»˜è®¤çš„æ¥è¾¾åˆ°è‡ªåŠ¨éƒ¨ç½²çš„ç›®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å‘½ä»¤å‰é¢åŠ ä¸Š <code>\n</code>ï¼Œä¸€å¾‹é€šè¿‡å›è½¦é»˜è®¤è·³è¿‡ã€‚</li>
<li><code>COPY</code> æ“ä½œæ˜¯åœ¨å®‰è£…å®Œæˆä¹‹åï¼ŒæŠŠå½“å‰ç›®å½•çš„ <code>shadowsocks.json</code> æ‹·è´åˆ°å®¹å™¨çš„ <code>/etc/</code> ç›®å½•ã€‚æ‰€ä»¥å¤§å®¶åœ¨ä½¿ç”¨è¿™ä¸ª Dockerfile æ„å»ºä¹‹å‰è¦åœ¨åŒç›®å½•ä¸‹é…ç½®å¥½è‡ªå·±çš„ <code>shadowsocks.json</code>ã€‚</li>
<li>æœ€åä¸€ä¸ª <code>RUN</code> æ˜¯ç”¨æ¥åˆ›å»ºä¸€äº›å‘½ä»¤è„šæœ¬ï¼Œæ¯”å¦‚ å¯åŠ¨ ssr çš„ <code>start.sh</code>ï¼Œåœæ­¢ ssr çš„ <code>stop.sh</code>ï¼Œé‡å¯ ssr çš„ <code>restart.sh</code>ï¼›é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜ä¼šåˆ›å»ºä¸€ä¸ª <code>fake_log.log</code> æ–‡ä»¶ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œå½“ä½ å¯åŠ¨è¿™ä¸ªå®¹å™¨ï¼Œå¹¶æ‰§è¡Œ <code>start.sh</code> ä¹‹åï¼Œä¸€æ—¦æ‰§è¡ŒæˆåŠŸï¼Œå®¹å™¨å°±è¢«è‡ªåŠ¨å…³é—­äº†ï¼Œè¿™ä¸ªæ˜¯ç”± docker æœºåˆ¶å†³å®šï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å¯åŠ¨ä¹‹åå† <code>tail -f fake_log.log</code>ï¼Œæ¥ç¡®ä¿ å®¹å™¨ä¸ä¼šè¢«å…³é—­ã€‚</li>
<li>æœ€åçš„ <code>ENTRYPOINT</code> è¡¨ç¤ºä»è¿™ä¸ªé•œåƒå¯åŠ¨ä¸€ä¸ªå®¹å™¨ä¹‹åï¼Œè‡ªåŠ¨æ‰§è¡Œçš„å‘½ä»¤ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨æŠŠ ssr çš„æœåŠ¡å¼€å¯ï¼Œæ‰€ä»¥éœ€è¦åšè¿™ä¸ªé…ç½®ã€‚</li>
</ul>
<p><span id="build_image"></span></p>
<h2 id="æ„å»ºé•œåƒ"><a href="#æ„å»ºé•œåƒ" class="headerlink" title="æ„å»ºé•œåƒ"></a>æ„å»ºé•œåƒ</h2><p>åœ¨ <code>Dockerfile</code> çš„åŒä¸€ç›®å½•åˆ›å»ºä½ è‡ªå·±çš„ <code>shadowsocks.json</code> æ–‡ä»¶ï¼Œç„¶åæ„å»ºç”Ÿæˆé•œåƒï¼Œç„¶åä¸Šä¼ åˆ°ä½ è‡ªå·±çš„ <a href="https://hub.docker.com/" target="_blank" rel="noopener">Docker Hub</a>ã€‚ä¹‹ååœ¨ä»»ä½•ä¸»æœºä¸Šéƒ¨ç½²ï¼Œpull ä¸‹ä½ è‡ªå·±çš„é•œåƒï¼Œrun å³å¯ï¼Œçœå»æ¯æ¬¡è¦ä¿®æ”¹ä½ çš„é…ç½®çš„æ­¥éª¤ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šä½ åˆ›å»ºçš„è¿™ä¸ªé•œåƒä¸­æ˜¯åŒ…å«äº†è‡ªå·±çš„é…ç½®æ–‡ä»¶ä¿¡æ¯çš„ï¼Œæ‰€ä»¥æœ€å¥½æ˜¯ <code>private</code>ã€‚</p>
</blockquote>
<h3 id="æ„å»ºæ­¥éª¤"><a href="#æ„å»ºæ­¥éª¤" class="headerlink" title="æ„å»ºæ­¥éª¤"></a>æ„å»ºæ­¥éª¤</h3><ul>
<li>åœ¨ <a href="https://hub.docker.com/" target="_blank" rel="noopener">Docker Hub</a> ï¼ˆæ²¡æœ‰å°±å…ˆæ³¨å†Œï¼‰åˆ›å»ºä½ çš„ respository ï¼ˆæœ€å¥½ privateï¼‰ï¼Œå¦‚ <code>ssr</code>ï¼Œå‡è®¾ä½ çš„ docker hub ç”¨æˆ·åä¸º <code>zhangsan</code>ã€‚</li>
<li>Clone æœ¬é¡¹ç›®</li>
<li><p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>shadowsocks.json</code>ï¼Œç¼–å†™ç±»ä¼¼å¦‚ä¸‹çš„ ssr é…ç½®ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">"server"</span>:<span class="string">"0.0.0.0"</span>,</span><br><span class="line">   <span class="attr">"server_ipv6"</span>:<span class="string">"[::]"</span>,</span><br><span class="line">   <span class="attr">"local_address"</span>:<span class="string">"127.0.0.1"</span>,</span><br><span class="line">   <span class="attr">"local_port"</span>:<span class="number">1080</span>,</span><br><span class="line">   <span class="attr">"port_password"</span>:&#123;</span><br><span class="line">       <span class="attr">"9000"</span>:<span class="string">"xxxxxx"</span>,</span><br><span class="line">       <span class="attr">"9001"</span>:&#123;<span class="attr">"password"</span>:<span class="string">"xxxxxx"</span>, <span class="attr">"protocol"</span>:<span class="string">"auth_chain_a"</span>, <span class="attr">"obfs"</span>:<span class="string">"tls1.2_ticket_auth"</span>, <span class="attr">"obfs_param"</span>:<span class="string">""</span>&#125;,</span><br><span class="line">       <span class="attr">"9002"</span>:&#123;<span class="attr">"password"</span>:<span class="string">"xxxxxx"</span>, <span class="attr">"protocol"</span>:<span class="string">"auth_chain_a"</span>, <span class="attr">"obfs"</span>:<span class="string">"tls1.2_ticket_auth"</span>, <span class="attr">"obfs_param"</span>:<span class="string">""</span>&#125;</span><br><span class="line">       // ...</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">"timeout"</span>:<span class="number">120</span>,</span><br><span class="line">   <span class="attr">"method"</span>:<span class="string">"chacha20"</span>,</span><br><span class="line">   <span class="attr">"protocol"</span>:<span class="string">"origin"</span>,</span><br><span class="line">   <span class="attr">"protocol_param"</span>:<span class="string">""</span>,</span><br><span class="line">   <span class="attr">"obfs"</span>:<span class="string">"plain"</span>,</span><br><span class="line">   <span class="attr">"obfs_param"</span>:<span class="string">""</span>,</span><br><span class="line">   <span class="attr">"redirect"</span>:<span class="string">""</span>,</span><br><span class="line">   <span class="attr">"dns_ipv6"</span>:<span class="literal">false</span>,</span><br><span class="line">   <span class="attr">"fast_open"</span>:<span class="literal">false</span>,</span><br><span class="line">   <span class="attr">"workers"</span>:<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>åˆ›å»º docker é•œåƒï¼šcd åˆ°æœ¬é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œè¿è¡Œå‘½ä»¤ <code>docker build --no-cache -t zhangsan/ssr:0.1 .</code>ã€‚åˆ›å»ºæˆåŠŸä¹‹åè¿è¡Œ <code>docker images</code> ç¡®è®¤ä¸‹ã€‚</li>
<li>æŠŠä½ æœ¬åœ°ç”Ÿæˆçš„é•œåƒ push åˆ°ä½ çš„ä»“åº“ï¼š<ul>
<li>è¿è¡Œ <code>docker login</code>ï¼Œç¡®è®¤ä½ æ˜¯ç™»å½•çŠ¶æ€ï¼Œæœªç™»å½•åˆ™ç™»å½• <code>Docker Hub</code>ã€‚</li>
<li>æ‰§è¡Œ <code>docker push zhangsan/ssr:0.1</code>ã€‚</li>
<li>æˆåŠŸä¹‹ååˆ°ä½ çš„ <code>Docker Hub</code> æŸ¥çœ‹è¯¥ respository çš„ tag æ˜¯å¦æœ‰ <code>0.1</code> çš„ç‰ˆæœ¬å­˜åœ¨äº†ã€‚</li>
</ul>
</li>
</ul>
<h3 id="ä½¿ç”¨æ­¥éª¤"><a href="#ä½¿ç”¨æ­¥éª¤" class="headerlink" title="ä½¿ç”¨æ­¥éª¤"></a>ä½¿ç”¨æ­¥éª¤</h3><ul>
<li>ç™»å½•ä½ çš„ vpsï¼Œå®‰è£… dockerï¼Œæ‰§è¡Œ <code>docker login</code> ç™»å½•ã€‚</li>
<li>è¿è¡Œ <code>docker pull zhangsan/ssr:0.1</code> å‘½ä»¤æŠŠåˆšåˆšä½ åˆ›å»ºçš„é•œåƒ pull ä¸‹æ¥ã€‚</li>
<li>å†è¿è¡Œé•œåƒï¼š<code>docker run -itd --name ssr -p 9000:9000 -p 9001:9001 -p 9002:9002 zhangsan/ssr:0.1</code></li>
<li>å®¹å™¨ï¼ˆå®¹å™¨çš„åå­—ä¸º <code>ssr</code>ï¼‰å¯åŠ¨ä¹‹åï¼Œ<code>ssr server</code> ä¼šè‡ªåŠ¨è·‘èµ·æ¥ã€‚</li>
<li>æ ¹æ®ä½  vps çš„ç³»ç»Ÿï¼ŒæŠŠ <code>docker run ssr</code> ä½œä¸ºå¼€æœºè‡ªå¯ã€‚</li>
</ul>
]]></content>
      
        <categories>
            
            <category> automate </category>
            
            <category> docker </category>
            
            <category> ssr </category>
            
        </categories>
        
        
        <tags>
            
            <tag> automate </tag>
            
            <tag> huginn </tag>
            
            <tag> ssr </tag>
            
            <tag> shadowsocks </tag>
            
            <tag> shadowsocksr </tag>
            
            <tag> docker </tag>
            
            <tag> docker hub </tag>
            
            <tag> mysql </tag>
            
            <tag> migration </tag>
            
            <tag> ss </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Huginn çš„ Docker éƒ¨ç½²åŠæ•°æ®è¿ç§»]]></title>
      <url>/2018/11/24/huginn_deployment_with_docker_and_data_migration/</url>
      <content type="html"><![CDATA[<h1 id="Huginn-çš„-Docker-éƒ¨ç½²åŠæ•°æ®è¿ç§»"><a href="#Huginn-çš„-Docker-éƒ¨ç½²åŠæ•°æ®è¿ç§»" class="headerlink" title="Huginn çš„ Docker éƒ¨ç½²åŠæ•°æ®è¿ç§»"></a>Huginn çš„ Docker éƒ¨ç½²åŠæ•°æ®è¿ç§»</h1><p>å‰ä¸¤å¤©å› ä¸ºè¦æ¢ vpsï¼Œå…¶ä¸­ä¹‹å‰éƒ¨ç½²çš„ Huginn éœ€è¦è¿ç§»åˆ°æ–°çš„ vpsã€‚ä¹‹å‰ä¹Ÿæœ‰æœ‹å‹é—®è¿‡å…³äº huginn çš„æ•°æ®å¤‡ä»½å’Œè¿ç§»çš„é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« å°±è®²ä¸‹æ•´ä¸ªæµç¨‹ã€‚</p>
<p>åœ¨ vps ä¸Šå®‰è£… huginnï¼Œæˆ‘ä¹‹å‰çš„åšå®¢- <a href="https://blog.wangjiegulu.com/2018/04/02/build_the_environment_for_huginn/">ã€ŠHuginnåŠç¯å¢ƒæ­å»ºã€‹</a> æœ‰è®²åˆ°è¿‡ Huginn çš„éƒ¨ç½²è¿‡ç¨‹ï¼Œè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œè¦å®‰è£…çš„ä¸œè¥¿ä¹Ÿæ¯”è¾ƒå¤šï¼Œåšè¿ç§»çš„æ—¶å€™è¦é‡æ–°éƒ¨ç½²ä¸€éï¼Œä¹Ÿæ¯”è¾ƒå®¹æ˜“å‡ºé”™ã€‚è€Œ Huginn æœ‰æä¾› docker é•œåƒï¼Œæ‰€ä»¥è¿™æ¬¡æˆ‘ä»¬é€šè¿‡ docker æ¥æ­å»º Huginn ç¯å¢ƒã€‚</p>
<h2 id="å®‰è£…-docker"><a href="#å®‰è£…-docker" class="headerlink" title="å®‰è£… docker"></a>å®‰è£… docker</h2><p>æˆ‘ç”¨çš„ vps æ˜¯ Debianï¼ŒæŒ‰ç…§å®˜æ–¹æ–‡æ¡£å®‰è£… dockerï¼Œå…·ä½“æµç¨‹è§è¿™é‡Œï¼š<a href="https://docs.docker.com/install/linux/docker-ce/debian/" target="_blank" rel="noopener">https://docs.docker.com/install/linux/docker-ce/debian/</a>ã€‚</p>
<blockquote>
<p>å®‰è£…è¿‡ç¨‹ä¸å†èµ˜è¿°</p>
</blockquote>
<h2 id="æ‹‰å–-huginn-é•œåƒ"><a href="#æ‹‰å–-huginn-é•œåƒ" class="headerlink" title="æ‹‰å– huginn é•œåƒ"></a>æ‹‰å– huginn é•œåƒ</h2><p>é¦–å…ˆç™»å½•åˆ° vpsã€‚</p>
<p>æ‰§è¡Œ <code>docker search huginn</code> æ¥æœç´¢æ‰€æœ‰å…¬å¼€çš„ huginn é•œåƒï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/48963645-f99fc180-efd1-11e8-8806-357110a96ea8.png" width="800px"><br></div>

<p>ä¸Šé¢é«˜äº®çš„å°±æ˜¯æˆ‘ä»¬è¦ä½¿ç”¨çš„é•œåƒï¼Œæ‹‰å–ä¸‹æ¥ï¼ˆé»˜è®¤æ‹‰å– lastest ï¼‰ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull huginn/huginn</span><br></pre></td></tr></table></figure>
<h2 id="è¿è¡Œ-huginn"><a href="#è¿è¡Œ-huginn" class="headerlink" title="è¿è¡Œ huginn"></a>è¿è¡Œ huginn</h2><p>æ‹‰å–å®Œ huginn ä¹‹åï¼Œæˆ‘ä»¬å…¶ä½™çš„ç¯å¢ƒé…ç½®ï¼ˆæ¯”å¦‚ mysql å®‰è£…ç­‰ç­‰ï¼‰éƒ½ä¸éœ€è¦å†é…ç½®äº†ï¼Œé•œåƒé‡Œé¢éƒ½æœ‰äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯ç›´æ¥è¿è¡Œ huginnï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name huginn -p 3000:3000 huginn/huginn</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-itd</code>ï¼šåŒ…æ‹¬å¦‚ä¸‹ 3 ä¸ªå‘½ä»¤ï¼š<ul>
<li><code>-t</code>ï¼šåœ¨æ–°å®¹å™¨å†…æŒ‡å®šä¸€ä¸ªä¼ªç»ˆç«¯æˆ–ç»ˆç«¯ã€‚</li>
<li><code>-i</code>ï¼šå…è®¸ä½ å¯¹å®¹å™¨å†…çš„æ ‡å‡†è¾“å…¥ (STDIN) è¿›è¡Œäº¤äº’ã€‚</li>
<li><code>-d</code>ï¼šä»¥æ–°çš„è¿›ç¨‹åœ¨åå°è¿è¡Œ</li>
</ul>
</li>
<li><code>--name</code>ï¼šç»™è¿™ä¸ªå®¹å™¨å–ä¸ªåˆ«åå« <code>huginn</code></li>
<li><code>-p</code>ï¼šå®¹å™¨å†…éƒ¨çš„ 3000 ç«¯å£æ˜ å°„åˆ°æˆ‘ä»¬ vps ä¸»æœºçš„ 3000 ç«¯å£ä¸Š</li>
</ul>
<p>æ‰§è¡Œ <code>docker ps</code> æ¥æŸ¥çœ‹ huginn æ˜¯å¦æœ‰çœŸæ­£è¿è¡Œï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/48963720-a3cc1900-efd3-11e8-97f7-8c473a4298c3.png" width="800px"><br></div>

<p>æµè§ˆå™¨è®¿é—® <code>&lt;vps:ip&gt;:3000</code>ï¼Œåº”è¯¥å°±èƒ½çœ‹åˆ° huginn é¡µé¢äº†ã€‚ä½†æ˜¯è¿™ä¸ªæ—¶å€™å› ä¸ºæ•°æ®è¿˜æ²¡æœ‰è¿ç§»ï¼Œå½“å‰çš„ huginn æ•°æ®åº“æ˜¯ç©ºçš„ã€‚</p>
<h2 id="æ•°æ®å¤‡ä»½"><a href="#æ•°æ®å¤‡ä»½" class="headerlink" title="æ•°æ®å¤‡ä»½"></a>æ•°æ®å¤‡ä»½</h2><p>å…³äº huginn çš„å¤‡ä»½ï¼Œ<a href="https://github.com/huginn/huginn/wiki/Backing-up-huginn" target="_blank" rel="noopener">å®˜æ–¹ wiki é‡Œé¢ç»™å‡ºçš„æ–¹æ¡ˆ</a> æ˜¯é€šè¿‡ <code>backup gem</code> æ¥è¿›è¡Œå¤‡ä»½ï¼Œhuginn ä½œè€… ç»™å‡ºäº† <a href="https://github.com/huginn/huginn/blob/master/doc/deployment/backup/example_backup.rb" target="_blank" rel="noopener">å¤‡ä»½çš„è„šæœ¬</a>ï¼Œå…·ä½“ <code>backup</code> çš„æ–‡æ¡£å‚è€ƒè§ï¼š<a href="http://backup.github.io/backup/v4/" target="_blank" rel="noopener">http://backup.github.io/backup/v4/</a>ã€‚ä½†æ˜¯æˆ‘è¿™æ¬¡åšæ•°æ®è¿ç§»çš„è¯ï¼Œæ˜¯ç›´æ¥é€šè¿‡ <code>mysqldump</code> æ¥å¯¼å‡ºæ•°æ®åº“ã€‚</p>
<p>ç™»å½•åˆ° <code>æ—§çš„ vps</code>ï¼Œç„¶åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ¥å¤‡ä»½ mysql æ•°æ®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump --single-transaction --opt -u huginn -ppassword huginn_production &gt; huginn_backupfile.sql</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šä»¥ä¸Šå‘½ä»¤çš„å‚æ•°éœ€è¦æ›¿æ¢ï¼š</p>
<ul>
<li>huginnï¼šmysql ç”¨æˆ·å</li>
<li>passwordï¼šmysql å¯†ç </li>
<li>huginn_productionï¼šæ•°æ®åº“å</li>
</ul>
</blockquote>
<p>æ‰§è¡Œå®Œæˆä¹‹åï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªåä¸º <code>huginn_backupfile.sql</code> æ–‡ä»¶ï¼Œé‡Œé¢å°±æ˜¯ä½  huginn çš„æ‰€æœ‰æ•°æ®äº†ï¼ŒåŒ…æ‹¬ <code>ç”¨æˆ·ä¿¡æ¯</code>ï¼Œ<code>scenarios</code>ï¼Œ<code>agent</code>ï¼Œ<code>events</code>ï¼Œ<code>user_credentials</code>ï¼Œ<code>Services</code> ç­‰ç­‰ã€‚</p>
<h2 id="æ¢å¤æ•°æ®"><a href="#æ¢å¤æ•°æ®" class="headerlink" title="æ¢å¤æ•°æ®"></a>æ¢å¤æ•°æ®</h2><p>å¤‡ä»½å®Œä¹‹åï¼Œå°±è¦æ¢å¤æ•°æ®ï¼Œè¦æ¢å¤æ•°æ®ï¼Œå¾—å…ˆæŠŠæ•°æ®æ‹·è´åˆ° huginn å®¹å™¨é‡Œé¢ã€‚</p>
<p>é¦–å…ˆé€šè¿‡ä¸€ä¸‹å‘½ä»¤æŠŠæ–‡ä»¶ä» <code>æ—§çš„ vps</code> æ‹·è´åˆ° <code>æ–°çš„ vps</code> <strong>ä¸»æœº</strong>ä¸Šï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp huginn_backupfile.sql root@&lt;æ–° vps ip&gt;:/home/wangjie/huginn_backupfile.sql</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ–‡ä»¶æ˜¯åœ¨ä½ çš„ <code>æ–°çš„ vps</code> çš„<strong>ä¸»æœº</strong>ä¸Šï¼Œä½ è¿˜éœ€è¦æŠŠå®ƒæ‹·è´åˆ°åˆšåˆšæˆ‘ä»¬æ–°å»ºçš„ huginn å®¹å™¨ä¸­ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp /home/wangjie/huginn_backupfile.sql huginn: /app/wjhuginn/huginn_backupfile.sql</span><br></pre></td></tr></table></figure>
<p>åœ¨ <code>æ–°çš„ vps</code> ä¸­å¯¹æ–°éƒ¨ç½²çš„ <code>huginn</code> è¿›è¡Œ restore æ•°æ®ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -ppassword huginn_production &lt; huginn_backupfile.sql</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œhuginn é•œåƒä¸­çš„ï¼š</p>
<ul>
<li>æ•°æ®åº“åï¼šhuginn_production</li>
<li>ç”¨æˆ·ï¼šroot</li>
<li>å¯†ç ï¼špassword</li>
</ul>
</blockquote>
<p>é™¤äº†ä»¥ä¸Šæ•°æ®ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ restore çš„æ˜¯ huginn ä¸­çš„ <code>.env</code> æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†æˆ‘ä»¬çš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼ˆæ¯”å¦‚ï¼Œemailï¼Œç¬¬ä¸‰æ–¹ service key ç­‰ç­‰ï¼‰ï¼Œç”¨åŒæ ·çš„æ–¹æ³•æŠŠ <code>æ—§çš„ vps</code> ä¸­çš„ <code>.env</code> æ‹·è´åˆ° <code>æ–°çš„ vps</code>ï¼Œç„¶åè¦†ç›–æ‰å³å¯ã€‚</p>
<h2 id="å…¶å®ƒé…ç½®"><a href="#å…¶å®ƒé…ç½®" class="headerlink" title="å…¶å®ƒé…ç½®"></a>å…¶å®ƒé…ç½®</h2><h3 id="ä¿®æ”¹-DNS-Host-Record"><a href="#ä¿®æ”¹-DNS-Host-Record" class="headerlink" title="ä¿®æ”¹ DNS Host Record"></a>ä¿®æ”¹ DNS Host Record</h3><p>æŠŠä½ çš„ ip åœ°å€æ”¹æˆæ–°çš„ vps çš„ ipã€‚</p>
<h3 id="é…ç½®-nginx-åå‘ä»£ç†ï¼š"><a href="#é…ç½®-nginx-åå‘ä»£ç†ï¼š" class="headerlink" title="é…ç½® nginx åå‘ä»£ç†ï¼š"></a>é…ç½® nginx åå‘ä»£ç†ï¼š</h3><p>å¦‚ä¸‹é…ç½®ï¼Œè¯¦æƒ…å¯å‚è€ƒ <a href="https://github.com/huginn/huginn/wiki/Nginx-reverse-proxy-configuration" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    # Make it available from the Internet</span><br><span class="line">    allow all;</span><br><span class="line"></span><br><span class="line">    listen 80;</span><br><span class="line"></span><br><span class="line">    # server names for this server.</span><br><span class="line">    # any requests that come in that match any these names will use the proxy.</span><br><span class="line">    server_name huginn.server.com;</span><br><span class="line">    access_log /var/log/nginx/huginn.server.com-access.log;</span><br><span class="line">    error_log /var/log/nginx/huginn.server.com-error.log;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:3000;</span><br><span class="line">        proxy_set_header Host $host;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    listen 443 ssl;</span><br><span class="line"></span><br><span class="line">    # Setup SSL certificate with Let&apos;s Encript (https://letsencrypt.org/)</span><br><span class="line">    ssl_certificate /etc/letsencrypt/live/huginn.server.com/fullchain.pem;</span><br><span class="line">    ssl_certificate_key /etc/letsencrypt/live/huginn.server.com/privkey.pem;</span><br><span class="line">    include /etc/letsencrypt/options-ssl-nginx.conf;</span><br><span class="line">    ssl_trusted_certificate /etc/letsencrypt/live/huginn.server.com/chain.pem;</span><br><span class="line">    ssl_stapling on;</span><br><span class="line">    ssl_stapling_verify on;</span><br><span class="line"></span><br><span class="line">    if ($scheme != &quot;https&quot;) &#123;</span><br><span class="line">        return 301 https://$host$request_uri;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> automate </category>
            
            <category> docker </category>
            
        </categories>
        
        
        <tags>
            
            <tag> automate </tag>
            
            <tag> huginn </tag>
            
            <tag> docker </tag>
            
            <tag> docker hub </tag>
            
            <tag> mysql </tag>
            
            <tag> migration </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Huginn å®ç°è‡ªåŠ¨é€šè¿‡ Telegram æ¨é€è±†ç“£é«˜åˆ†ç”µå½±]]></title>
      <url>/2018/11/16/douban_high_movie_huginn_telegram/</url>
      <content type="html"><![CDATA[<h1 id="Huginn-å®ç°è‡ªåŠ¨é€šè¿‡-telegram-æ¨é€è±†ç“£é«˜åˆ†ç”µå½±"><a href="#Huginn-å®ç°è‡ªåŠ¨é€šè¿‡-telegram-æ¨é€è±†ç“£é«˜åˆ†ç”µå½±" class="headerlink" title="Huginn å®ç°è‡ªåŠ¨é€šè¿‡ telegram æ¨é€è±†ç“£é«˜åˆ†ç”µå½±"></a>Huginn å®ç°è‡ªåŠ¨é€šè¿‡ telegram æ¨é€è±†ç“£é«˜åˆ†ç”µå½±</h1><p>ä¹‹å‰åšå®¢<a href="https://blog.wangjiegulu.com/2018/04/03/huginn_douban_high_score_movies_and_slack/">ã€ŠHuginn å®ç°è‡ªåŠ¨é€šè¿‡ slack æ¨é€è±†ç“£é«˜åˆ†ç”µå½±ã€‹</a>æœ‰è®²åˆ°è¿‡é€šè¿‡ Huginn æ¥å®ç°è‡ªåŠ¨è·å–è±†ç“£æ­£åœ¨ä¸Šæ˜ ä¸­çš„é«˜åˆ†ï¼ˆè®¾å®šåˆ†æ•°è¶…è¿‡7.8åˆ†ï¼‰ç”µå½±ï¼Œå¹¶ä¸”è‡ªåŠ¨é€šè¿‡ Slack é€šçŸ¥ç»™æˆ‘ã€‚é‚£ä¹ˆæ€æ ·é€šè¿‡ Telegram æ¥è¿›è¡Œæ¨é€å‘¢ï¼Ÿ</p>
<h2 id="åˆ›å»º-Telegram-Bot"><a href="#åˆ›å»º-Telegram-Bot" class="headerlink" title="åˆ›å»º Telegram Bot"></a>åˆ›å»º Telegram Bot</h2><p>å…¶å®è·Ÿ Slack ä¸€æ ·ï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª telegram botï¼Œç„¶åé€šè¿‡ telegram bot æ¥è¿›è¡Œé€šçŸ¥ã€‚</p>
<p>å…·ä½“æˆ‘ä»¬å¯ä»¥å‚è€ƒ telegram çš„å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://core.telegram.org/bots#6-botfather" target="_blank" rel="noopener">https://core.telegram.org/bots#6-botfather</a></p>
<p>è¿™é‡Œåˆ›å»º Bot çš„æ–¹å¼è·Ÿ Slack æœ‰æ‰€ä¸åŒï¼Œéœ€è¦é€šè¿‡è·Ÿ <code>BotFather</code> è¿›è¡Œå¯¹è¯æ¥åˆ›å»ºï¼Œæ‰“å¼€ telegram å®¢æˆ·ç«¯ï¼Œæœç´¢ <code>BotFather</code>è¿›å…¥å¯¹è¯æ¡†ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/48595853-74912880-e991-11e8-915c-7b2fbd82ccf0.png" width="400px"><br></div>

<p>ç»™ <code>BotFather</code> å‘é€ä¸€ä¸ªåˆ›å»º Bot çš„å‘½ä»¤ <code>/newbot</code>ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/48595984-f08b7080-e991-11e8-8989-5a65de625a0c.png" width="700px"><br></div>

<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œé€šè¿‡å‘é€ <code>/newbot</code> å‘½ä»¤ï¼ˆæ¶ˆæ¯ï¼‰åï¼Œ<code>BotFather</code> ä¼šå›å¤è®©ä½ è¿›è¡Œè®¾ç½® <code>bot</code> çš„ <code>name</code> å’Œ <code>user_name</code>ï¼Œå…¶ä¸­ <code>username</code> å¿…é¡»è¦æ˜¯ <code>bot</code> ç»“å°¾ï¼Œæˆ‘è¿™é‡Œ <code>name</code> å’Œ <code>username</code> éƒ½è®¾ç½®ä¸º <code>angelia_bot</code>ã€‚</p>
<p>æœ€å <code>BotFather</code> ä¼šå›å¤åˆ›å»ºæˆåŠŸï¼Œå¹¶ä¸”è¿”å›ä½ åˆ›å»ºçš„æœºå™¨äººçš„ <code>access token</code>ï¼Œæœ‰äº†<code>access token</code>æˆ‘ä»¬å°±èƒ½ç»™ group æˆ–è€… channel å‘é€æ¶ˆæ¯äº†ã€‚</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/48596207-fa61a380-e992-11e8-9cd5-0320c69303ea.png" width="700px"><br></div>

<h2 id="åˆ›å»ºæ¥æ”¶æ¶ˆæ¯çš„é¢‘é“Channel"><a href="#åˆ›å»ºæ¥æ”¶æ¶ˆæ¯çš„é¢‘é“Channel" class="headerlink" title="åˆ›å»ºæ¥æ”¶æ¶ˆæ¯çš„é¢‘é“Channel"></a>åˆ›å»ºæ¥æ”¶æ¶ˆæ¯çš„é¢‘é“Channel</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç”¨æ¥æ¥æ”¶æ¶ˆæ¯çš„ <code>Channel</code>ï¼ˆå½“ç„¶ï¼Œä½ ç”¨ <code>Group</code> ä¹Ÿå¯ä»¥ï¼Œå¦‚æœç”¨ <code>Group</code> çš„è¯ï¼Œå¾ˆå¤šäººåŠ è¿›æ¥èŠå¤©å‘æ¶ˆæ¯ä¼šæ¯”è¾ƒä¹±ï¼Œ<code>Channel</code>çš„è¯ï¼Œåˆ«äººè®¢é˜…ä¹‹åå°±åªèƒ½æ¥å—æŸ¥çœ‹æ¶ˆæ¯ï¼Œæ¯”è¾ƒç¬¦åˆæˆ‘ä»¬ç°åœ¨çš„åœºæ™¯ï¼‰ã€‚</p>
<p>åˆ›å»ºå®Œä¹‹åï¼Œé€šè¿‡è®¿é—® &lt;<a href="https://api.telegram.org/bot" target="_blank" rel="noopener">https://api.telegram.org/bot</a><bot-access-token\>/getUpdates&gt;ï¼Œæ‰¾åˆ°åˆšåˆšåˆ›å»ºçš„ <code>channel</code>ï¼Œæ‹¿åˆ°è¿™ä¸ª <code>channel</code> çš„idï¼ˆåº”è¯¥æ˜¯è´Ÿæ•°çš„idï¼‰ã€‚</bot-access-token\></p>
<blockquote>
<p>æŠŠä¸Šé¢çš„ url ä¸­çš„ <code>&lt;bot-access-token&gt;</code> æ›¿æ¢æˆåˆšåˆšåˆ›å»º <code>bot</code> æ‹¿åˆ°çš„ <code>access token</code></p>
</blockquote>
<p>æŠŠåˆšåˆšæˆ‘ä»¬åˆ›å»ºçš„ <code>bot</code> æ·»åŠ åˆ°æˆ‘ä»¬åˆ›å»ºçš„ <code>channel</code> ä¸­ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/48596921-0733c680-e996-11e8-9190-2533727bf27d.png" width="400px"><br></div>


<h2 id="åˆ›å»ºå‘é€-telegram-æ¶ˆæ¯çš„-agent"><a href="#åˆ›å»ºå‘é€-telegram-æ¶ˆæ¯çš„-agent" class="headerlink" title="åˆ›å»ºå‘é€ telegram æ¶ˆæ¯çš„ agent"></a>åˆ›å»ºå‘é€ telegram æ¶ˆæ¯çš„ agent</h2><p>ä¹‹å‰çš„æµç¨‹è·Ÿ<a href="https://blog.wangjiegulu.com/2018/04/03/huginn_douban_high_score_movies_and_slack/">ã€ŠHuginnå®ç°è‡ªåŠ¨é€šè¿‡slackæ¨é€è±†ç“£é«˜åˆ†ç”µå½±ã€‹</a>ä¸­çš„ä¸€æ ·ï¼Œåªæ˜¯æœ€åéœ€è¦åˆ›å»ºä¸€ä¸ªå‘é€åˆ° telegram çš„ agentã€‚</p>
<p>å¦‚ä¸‹ï¼šåˆ›å»ºä¸€ä¸ª <code>PostAgent</code>ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"post_url"</span>: <span class="string">"&#123;% credential telegram_base_url %&#125;bot&#123;% credential telegram_bot_token %&#125;/sendPhoto"</span>,</span><br><span class="line">  <span class="attr">"expected_receive_period_in_days"</span>: <span class="string">"1"</span>,</span><br><span class="line">  <span class="attr">"content_type"</span>: <span class="string">"json"</span>,</span><br><span class="line">  <span class="attr">"method"</span>: <span class="string">"post"</span>,</span><br><span class="line">  <span class="attr">"payload"</span>: &#123;</span><br><span class="line">    <span class="attr">"chat_id"</span>: <span class="string">"&#123;% credential telegram_movie_channel_id %&#125;"</span>,</span><br><span class="line">    <span class="attr">"photo"</span>: <span class="string">"&#123;&#123;image_url&#125;&#125;"</span>,</span><br><span class="line">    <span class="attr">"parse_mode"</span>: <span class="string">"Markdown"</span>,</span><br><span class="line">    <span class="attr">"caption"</span>: <span class="string">"*Title*: [&lt;&lt;&#123;&#123;title&#125;&#125;&gt;&gt;](&#123;&#123;detail_url&#125;&#125;) \n*Score*: &#123;&#123;score&#125;&#125;\n*Star*: &#123;&#123;star&#125;&#125;\n*Release*: &#123;&#123;release&#125;&#125;\n*Region*: &#123;&#123;region&#125;&#125;\n*Actors*: &#123;&#123;actors&#125;&#125;\n*Director*: &#123;&#123;director&#125;&#125;"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"headers"</span>: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"emit_events"</span>: <span class="string">"false"</span>,</span><br><span class="line">  <span class="attr">"no_merge"</span>: <span class="string">"false"</span>,</span><br><span class="line">  <span class="attr">"output_mode"</span>: <span class="string">"clean"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¯å½“æ£€æµ‹åˆ°è±†ç“£ä¸Šæœ‰æ–°çš„ä¸Šæ˜ ä¸­çš„ç”µå½±è¶…è¿‡7.8åˆ†ï¼Œåˆšåˆšåˆ›å»ºçš„ Channel ä¸­å³å¯æŸ¥çœ‹åˆ° <code>Bot</code> çš„é€šçŸ¥ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/48597282-0308a880-e998-11e8-8df0-7f8ac6857608.png" width="600px"><br></div>

<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>å¦‚æœä½ æ‡’å¾—ä¸Šé¢çš„å„ç§é…ç½®ï¼Œokï¼ŒåŠ å…¥ä¸‹é¢è¿™ä¸ª channelï¼Œä½ å°±èƒ½æ”¶åˆ°é€šçŸ¥å•¦ï¼š</p>
<blockquote>
<p><a href="https://t.me/angelia_movies" target="_blank" rel="noopener">https://t.me/angelia_movies</a></p>
</blockquote>
]]></content>
      
        <categories>
            
            <category> huginn </category>
            
            <category> automate </category>
            
            <category> telegram </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ifttt </tag>
            
            <tag> automate </tag>
            
            <tag> huginn </tag>
            
            <tag> integromat </tag>
            
            <tag> zapier </tag>
            
            <tag> geek </tag>
            
            <tag> douban </tag>
            
            <tag> movies </tag>
            
            <tag> telegram </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component WorkManager  é«˜çº§ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/10/20/android_architecture_components_workermanager_advanced/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-WorkManager-é«˜çº§ï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-WorkManager-é«˜çº§ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component WorkManager é«˜çº§ï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component WorkManager é«˜çº§ï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/architecture/workmanager/advanced</a></p>
</blockquote>
<p>é€šè¿‡ WorkManager å¯ä»¥è½»æ¾åœ°è®¾ç½®å’Œå®‰æ’å¤æ‚çš„ä»»åŠ¡è¯·æ±‚ã€‚ä½ å¯ä»¥åœ¨ä»¥ä¸‹åœºæ™¯ä½¿ç”¨è¿™äº› APIsï¼š</p>
<ul>
<li>é€šè¿‡æŒ‡å®šé¡ºåºå»æ‰§è¡Œ tasks çš„ <a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced#chained" target="_blank" rel="noopener">é“¾åºåˆ—</a>ã€‚</li>
<li>å”¯ä¸€çš„ <a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced#unique" target="_blank" rel="noopener">å‘½ååºåˆ—</a>ï¼Œä»¥åŠåœ¨åº”ç”¨å¯åŠ¨ä¸¤ä¸ªåŒååºåˆ—æ—¶å‘ç”Ÿçš„æƒ…å†µçš„è§„åˆ™ã€‚</li>
<li>Tasks çš„ <a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced#params" target="_blank" rel="noopener">è¾“å…¥è¾“å‡ºå€¼</a>ï¼ŒåŒ…æ‹¬æ¯ä¸ª task çš„è¾“å‡ºä½œä¸ºå‚æ•°è¾“å…¥åˆ°ä¸‹ä¸€ä¸ª tasks ä¸­çš„é“¾ tasksã€‚</li>
</ul>
<h2 id="é“¾-tasks"><a href="#é“¾-tasks" class="headerlink" title="é“¾ tasks"></a>é“¾ tasks</h2><p>ä½ çš„ app å¯èƒ½éœ€è¦ä»¥ä¸€ä¸ªç‰¹å®šçš„é¡ºåºæ¥æ‰§è¡Œå¤šä¸ª tasksã€‚<a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> å…è®¸ä½ åˆ›å»ºä¸€ä¸ªå·¥ä½œåºåˆ—å¹¶å¯¹å®ƒè¿›è¡Œæ’é˜Ÿï¼Œè¯¥åºåˆ—æŒ‡å®šå¤šä¸ª tasks ä»¥åŠå®ƒåº”è¯¥æŒ‰ä»€ä¹ˆé¡ºåºè¿è¡Œã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ çš„ app æœ‰ä¸‰ä¸ª <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a> å¯¹è±¡ï¼š<code>workA</code>ï¼Œ<code>workB</code>ï¼Œ<code>workC</code>ã€‚ä»»åŠ¡å¿…é¡»è¦æŒ‰ç…§è¿™ä¸ªé¡ºåºæ‰§è¡Œã€‚ä¸ºäº†æ’é˜Ÿå®ƒä»¬ï¼Œè¦é€šè¿‡ <a href="https://developer.android.com/reference/androidx/work/WorkManager#beginWith(java.util.List%3Candroidx.work.OneTimeWorkRequest%3E" target="_blank" rel="noopener"><code>WorkManager.beginWith()</code></a>) æ–¹æ³•åˆ›å»ºä¸€ä¸ªåºåˆ—ï¼Œä¼ å…¥ç¬¬ä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a> å¯¹è±¡ï¼›è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/WorkContinuation.html" target="_blank" rel="noopener"><code>WorkContinuation</code></a> å¯¹è±¡ï¼Œå®ƒå®šä¹‰äº† tasks çš„åºåˆ—ã€‚ç„¶åä½¿ç”¨ <a href="https://developer.android.com/reference/androidx/work/WorkContinuation#then" target="_blank" rel="noopener"><code>WorkContinuation.then()</code></a> æŒ‰ç…§é¡ºåºå¢åŠ å…¶å®ƒçš„ <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a> å¯¹è±¡ï¼Œæœ€åï¼Œä½¿ç”¨ <a href="https://developer.android.com/reference/androidx/work/WorkContinuation#enqueue" target="_blank" rel="noopener"><code>WorkContinuation.enqueue()</code></a> æ¥æ’é˜Ÿæ•´ä¸ªåºåˆ—ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">WorkManager.getInstance()</span><br><span class="line">    .beginWith(workA)</span><br><span class="line">        <span class="comment">// Note: WorkManager.beginWith() returns a</span></span><br><span class="line">        <span class="comment">// WorkContinuation object; the following calls are</span></span><br><span class="line">        <span class="comment">// to WorkContinuation methods</span></span><br><span class="line">    .then(workB)    <span class="comment">// FYI, then() returns a new WorkContinuation instance</span></span><br><span class="line">    .then(workC)</span><br><span class="line">    .enqueue()</span><br></pre></td></tr></table></figure>
<p><a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> ä¼šæŒ‰ç…§è¯·æ±‚çš„é¡ºåºä»¥åŠæ¯ä¸ª task æŒ‡å®šçš„çº¦æŸæ¥è¿è¡Œ tasksã€‚å¦‚æœ ä»»ä½• task è¿”å›äº† <a href="https://developer.android.com/reference/androidx/work/Worker.Result#FAILURE" target="_blank" rel="noopener"><code>Worker.Result.FAILURE</code></a>ï¼Œåˆ™æ•´ä¸ªåºåˆ—ç»“æŸã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ä¼ å…¥å¤šä¸ª <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a> å¯¹è±¡åˆ° <a href="https://developer.android.com/reference/androidx/work/WorkManager#beginWith(java.util.List%3Candroidx.work.OneTimeWorkRequest%3E" target="_blank" rel="noopener"><code>beginWith()</code></a>) å’Œ <a href="https://developer.android.com/reference/androidx/work/WorkContinuation#then" target="_blank" rel="noopener"><code>.then()</code></a> è°ƒç”¨ã€‚å¦‚æœä½ ä¼ å…¥å‡ ä¸ª <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a> åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•è°ƒç”¨ï¼Œ<a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> ä¼šåœ¨è¿è¡Œå…¶ä½™ tasks ä¹‹å‰è¿è¡Œè¿™äº› tasksï¼ˆå¹¶è¡Œï¼‰ã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">WorkManager.getInstance()</span><br><span class="line">    <span class="comment">// é¦–å…ˆï¼Œè¿è¡Œæ‰€æœ‰ A tasks (å¹¶è¡Œ):</span></span><br><span class="line">    .beginWith(workA1, workA2, workA3)</span><br><span class="line">    <span class="comment">// ...å½“æ‰€æœ‰çš„ A tasks ç»“æŸ, è¿è¡Œå•ä¸ª B task:</span></span><br><span class="line">    .then(workB)</span><br><span class="line">    <span class="comment">// ...ç„¶åè¿è¡Œ C tasks (ä»¥ä»»ä½•é¡ºåº):</span></span><br><span class="line">    .then(workC1, workC2)</span><br><span class="line">    .enqueue()</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥é€šè¿‡ <a href="https://developer.android.com/reference/androidx/work/WorkContinuation#combine" target="_blank" rel="noopener"><code>WorkContinuation.combine()</code></a> æ–¹æ³•è¿æ¥å¤šä¸ªé“¾æ¥åˆ›å»ºæ›´å¤æ‚çš„åºåˆ—ã€‚æ¯”å¦‚ï¼Œå‡è®¾ä½ æƒ³è¦è¿è¡Œåƒä»¥ä¸‹çš„åºåˆ—ï¼š</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/49058154-c3667a00-f23d-11e8-97a0-ca92352ce1ac.png" width="400px/"><br></div>

<p>è¦è®¾ç½®è¿™ä¸ªåºåˆ—ï¼Œåˆ›å»ºä¸¤ä¸ªç‹¬ç«‹çš„é“¾ï¼Œç„¶åæŠŠå®ƒä»¬é“¾æ¥åœ¨ä¸€èµ·å½¢æˆç¬¬ä¸‰ä¸ªï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> chain1 = WorkManager.getInstance()</span><br><span class="line">    .beginWith(workA)</span><br><span class="line">    .then(workB)</span><br><span class="line"><span class="keyword">val</span> chain2 = WorkManager.getInstance()</span><br><span class="line">    .beginWith(workC)</span><br><span class="line">    .then(workD)</span><br><span class="line"><span class="keyword">val</span> chain3 = WorkContinuation</span><br><span class="line">    .combine(chain1, chain2)</span><br><span class="line">    .then(workE)</span><br><span class="line">chain3.enqueue()</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> åœ¨ <code>workB</code> ä¹‹å‰è¿è¡Œ <code>workA</code>ã€‚è¿è¡Œ <code>workD</code> ä¹‹å‰è¿è¡Œ <code>workC</code>ã€‚åœ¨ <code>workB</code> å’Œ <code>workD</code> éƒ½å®Œæˆä¹‹åï¼Œ<a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> è¿è¡Œ <code>workE</code>ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šå½“ <a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener">WorkManager</a> æŒ‰ç…§é¡ºåºè¿è¡Œæ²¡ä¸ªå­é“¾ï¼Œä¸èƒ½ä¿è¯ <strong>é“¾1</strong> ä¸­çš„ä»»åŠ¡ä¸ <strong>é“¾2</strong> ä¸­çš„ä»»åŠ¡å¯èƒ½é‡å ã€‚æ¯”å¦‚ï¼Œ<strong>workB</strong> å¯èƒ½åœ¨ <strong>workC</strong> ä¹‹å‰æˆ–è€…ä¹‹åè¿è¡Œï¼Œæˆ–è€…åŒæ—¶è¿è¡Œã€‚åªèƒ½ä¿è¯æ¯ä¸ªå­é“¾ä¸­çš„ task å°†æŒ‰é¡ºåºè¿è¡Œï¼›å°±æ˜¯ï¼Œ<strong>workB</strong> ä¸ä¼šè¿è¡Œç›´åˆ° <strong>workA</strong> å®Œæˆã€‚</p>
</blockquote>
<p><a href="https://developer.android.com/reference/androidx/work/WorkContinuation.html" target="_blank" rel="noopener"><code>WorkContinuation</code></a> æœ‰è®¸å¤šå˜ç§æ¥æä¾›ä¸ºç‰¹å®šæƒ…å†µæä¾›å¿«æ·ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ<a href="https://developer.android.com/reference/androidx/work/WorkContinuation#combine(androidx.work.OneTimeWorkRequest,%20java.util.List%3Candroidx.work.WorkContinuation%3E" target="_blank" rel="noopener"><code>WorkContinuation.combine(OneTimeWorkRequest, WorkContinuationâ€¦)</code></a>) æ–¹æ³•æ˜¯æŒ‡ç¤º <a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> å®Œæˆæ‰€æœ‰æŒ‡å®šçš„ <a href="https://developer.android.com/reference/androidx/work/WorkContinuation.html" target="_blank" rel="noopener"><code>WorkContinuation</code></a> é“¾ï¼Œç„¶åå®ŒæˆæŒ‡å®šçš„ <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a>ã€‚è¯¦è¯·å¯å‚é˜… <a href="https://developer.android.com/reference/androidx/work/WorkContinuation.html" target="_blank" rel="noopener">WorkContinuation</a>ã€‚</p>
<h2 id="å”¯ä¸€å·¥ä½œåºåˆ—"><a href="#å”¯ä¸€å·¥ä½œåºåˆ—" class="headerlink" title="å”¯ä¸€å·¥ä½œåºåˆ—"></a>å”¯ä¸€å·¥ä½œåºåˆ—</h2><p>ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ <a href="https://developer.android.com/reference/androidx/work/WorkManager#beginUniqueWork(java.lang.String,%20androidx.work.ExistingWorkPolicy,%20androidx.work.OneTimeWorkRequest..." target="_blank" rel="noopener"><code>beginUniqueWork()</code></a>) è€Œä¸æ˜¯ <a href="https://developer.android.com/reference/androidx/work/WorkManager#beginWith(java.util.List%3Candroidx.work.OneTimeWorkRequest%3E" target="_blank" rel="noopener"><code>beginWith()</code></a>) å¼€å§‹ä¸€ä¸ªåºåˆ—æ¥åˆ›å»ºä¸€ä¸ª <em>å”¯ä¸€çš„å·¥ä½œåºåˆ—</em>ã€‚æ¯ä¸€ä¸ªå”¯ä¸€å·¥ä½œåºåˆ—éƒ½æœ‰ä¸€ä¸ªåå­—ï¼›<a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªåºåˆ—å…·æœ‰è¯¥åå­—ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªæ–°çš„å”¯ä¸€å·¥ä½œåºåˆ—æ—¶ï¼Œä½ è¦æŒ‡å®šå¦‚æœå·²ç»æœ‰ä¸€ä¸ªç›¸åŒåå­—å¹¶ä¸”æœªå®Œæˆçš„åºåˆ—æ—¶ <a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> åº”è¯¥æ€ä¹ˆåšï¼š</p>
<ul>
<li>å–æ¶ˆå·²ç»å­˜åœ¨çš„åºåˆ—å¹¶ç”¨æ–°çš„ <a href="https://developer.android.com/reference/androidx/work/ExistingWorkPolicy#replace" target="_blank" rel="noopener">æ›¿æ¢</a> å®ƒ</li>
<li><a href="https://developer.android.com/reference/androidx/work/ExistingWorkPolicy#keep" target="_blank" rel="noopener">ä¿ç•™</a> å­˜åœ¨çš„åºåˆ—å¹¶å¿½ç•¥æ‰ä½ æ–°çš„è¯·æ±‚ã€‚</li>
<li><a href="https://developer.android.com/reference/androidx/work/ExistingWorkPolicy#append" target="_blank" rel="noopener">è¿½åŠ </a> ä½ æ–°çš„åºåˆ—åˆ°ä½ å­˜åœ¨çš„åºåˆ—ä¸Šï¼Œåœ¨å­˜åœ¨çš„åºåˆ—çš„æœ€åä¸€ä¸ª task æ‰§è¡Œå®Œä¹‹åæ‰§è¡Œæ–°çš„åºåˆ—çš„ç¬¬ä¸€ä¸ª taskã€‚</li>
</ul>
<p>å”¯ä¸€å·¥ä½œåºåˆ—åœ¨ä½ æœ‰ä¸€ä¸ª task ä¸è¯¥æ’é˜Ÿå¤šæ¬¡çš„æ—¶å€™å¾ˆæœ‰ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ çš„ app éœ€è¦åŒæ­¥æ•°æ®åˆ°ç½‘ç»œï¼Œä½ å¯èƒ½å¯¹åä¸º â€œsyncâ€ çš„åºåˆ—è¿›è¡Œæ’é˜Ÿï¼Œç„¶åæŒ‡å®šå¦‚æœå·²ç»æœ‰è¿™ä¸ªåå­—çš„åºåˆ—å­˜åœ¨ï¼Œåˆ™ä½ æ–°çš„ task åº”è¯¥è¢«å¿½ç•¥ã€‚å”¯ä¸€å·¥ä½œåºåˆ—åœ¨ä½ éœ€è¦å»é€æ¸å»ºç«‹ä¸€ä¸ªé•¿é•¿çš„ä»»åŠ¡é“¾æ—¶ä¹Ÿå¾ˆæœ‰ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªå›¾ç‰‡ç¼–è¾‘ app å¯èƒ½ä¼šè®©ç”¨æˆ·æ’¤é”€ä¸€ä¸ªå¾ˆé•¿çš„åŠ¨ä½œé“¾ã€‚è¿™äº›æ¯ä¸ªæ’¤é”€çš„æ“ä½œéƒ½å¯èƒ½ä¼šéœ€è¦èŠ±è´¹ä¸€äº›æ—¶é—´ï¼Œä½†æ˜¯å®ƒä»¬éœ€è¦ä»¥ä¸€ä¸ªæ­£ç¡®çš„é¡ºåºè¢«æ‰§è¡Œã€‚åœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼Œapp åº”è¯¥åˆ›å»ºä¸€ä¸ª â€œundoâ€ é“¾ï¼Œå¹¶ä¸”å¦‚æœéœ€è¦åˆ™è¿½åŠ æ¯ä¸ªæ’¤é”€æ“ä½œã€‚</p>
<h2 id="è¾“å…¥å’Œè¾“å‡ºå€¼"><a href="#è¾“å…¥å’Œè¾“å‡ºå€¼" class="headerlink" title="è¾“å…¥å’Œè¾“å‡ºå€¼"></a>è¾“å…¥å’Œè¾“å‡ºå€¼</h2><p>ä¸ºäº†æ›´å¤§çš„çµæ´»æ€§ï¼Œä½ å¯ä»¥ä¼ å…¥å‚æ•°åˆ°ä½ çš„ tasks å¹¶è®© task è¿”å›å€¼ã€‚è¾“å…¥è¾“å‡ºå€¼æ˜¯é”®å€¼å¯¹ã€‚è¦ä¼ å…¥å€¼åˆ°ä¸€ä¸ª taskï¼Œåˆ™éœ€è¦åœ¨ä½ åˆ›å»º <a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a> å¯¹è±¡ä¹‹å‰è°ƒç”¨ <a href="https://developer.android.com/reference/androidx/work/WorkRequest.Builder#setinputdata" target="_blank" rel="noopener"><code>WorkRequest.Builder.setInputData()</code></a> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/Data.html" target="_blank" rel="noopener"><code>Data</code></a> å¯¹è±¡ï¼Œä½ å¯ä»¥é€šè¿‡ <a href="https://developer.android.com/reference/androidx/work/Data.Builder.html" target="_blank" rel="noopener"><code>Data.Builder</code></a> æ¥åˆ›å»ºå®ƒã€‚<a href="https://developer.android.com/reference/androidx/work/Worker.html" target="_blank" rel="noopener"><code>Worker</code></a> ç±»å¯ä»¥é€šè¿‡ <a href="https://developer.android.com/reference/androidx/work/Worker#getinputdata" target="_blank" rel="noopener"><code>Worker.getInputData()</code></a> æ¥è®¿é—®è¿™äº›å‚æ•°ã€‚è¦è¾“å‡ºä¸€ä¸ªè¿”å›å€¼ï¼Œtask è¦è°ƒç”¨ <a href="https://developer.android.com/reference/androidx/work/Worker#setoutputdata" target="_blank" rel="noopener"><code>Worker.setOutputData()</code></a>ï¼Œå®ƒæ¥å—ä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/Data.html" target="_blank" rel="noopener"><code>Data</code></a> å¯¹è±¡ã€‚ä½ å¯ä»¥é€šè¿‡è§‚å¯Ÿ task çš„ <code>LiveData&lt;WorkStatus&gt;</code> æ¥å¾—åˆ°è¾“å‡ºã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/Worker.html" target="_blank" rel="noopener"><code>Worker</code></a> ç±»æ¥æ‰§è¡Œè€—æ—¶çš„è®¡ç®—ã€‚ä»¥ä¸‹ä»£ç å±•ç¤ºäº† <a href="https://developer.android.com/reference/androidx/work/Worker.html" target="_blank" rel="noopener"><code>Worker</code></a> ç±»åº”è¯¥æ˜¯æ€ä¹ˆæ ·çš„ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Define the parameter keys:</span></span><br><span class="line">const <span class="keyword">val</span> KEY_X_ARG = <span class="string">"X"</span></span><br><span class="line">const <span class="keyword">val</span> KEY_Y_ARG = <span class="string">"Y"</span></span><br><span class="line">const <span class="keyword">val</span> KEY_Z_ARG = <span class="string">"Z"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...and the result key:</span></span><br><span class="line">const <span class="keyword">val</span> KEY_RESULT = <span class="string">"result"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Define the Worker class:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MathWorker</span></span>(context : Context, params : WorkerParameters)</span><br><span class="line">    : Worker(context, params)  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">doWork</span><span class="params">()</span></span>: Result &#123;</span><br><span class="line">        <span class="keyword">val</span> x = inputData.getInt(KEY_X_ARG, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">val</span> y = inputData.getInt(KEY_Y_ARG, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">val</span> z = inputData.getInt(KEY_Z_ARG, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ...do the math...</span></span><br><span class="line">        <span class="keyword">val</span> result = myCrazyMathFunction(x, y, z);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//...set the output, and we're done!</span></span><br><span class="line">        <span class="keyword">val</span> output: Data = mapOf(KEY_RESULT to result).toWorkData()</span><br><span class="line">        setOutputData(output)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.SUCCESS</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¦åˆ›å»ºä¸€ä¸ª worker å¹¶ä¼ å…¥å‚æ•°ï¼Œä½ åº”è¯¥å¦‚ä¸‹ç¼–å†™ä»£ç ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> myData: Data = mapOf(<span class="string">"KEY_X_ARG"</span> to <span class="number">42</span>,</span><br><span class="line">                       <span class="string">"KEY_Y_ARG"</span> to <span class="number">421</span>,</span><br><span class="line">                       <span class="string">"KEY_Z_ARG"</span> to <span class="number">8675309</span>)</span><br><span class="line">                     .toWorkData()</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...then create and enqueue a OneTimeWorkRequest that uses those arguments</span></span><br><span class="line"><span class="keyword">val</span> mathWork = OneTimeWorkRequestBuilder&lt;MathWorker&gt;()</span><br><span class="line">        .setInputData(myData)</span><br><span class="line">        .build()</span><br><span class="line">WorkManager.getInstance().enqueue(mathWork)</span><br></pre></td></tr></table></figure>
<p>è¿”å›å€¼ä¼šåœ¨ task çš„ <a href="https://developer.android.com/reference/androidx/work/WorkStatus.html" target="_blank" rel="noopener"><code>WorkStatus</code></a> ä¸­å¯ç”¨ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">WorkManager.getInstance().getStatusById(mathWork.id)</span><br><span class="line">        .observe(<span class="keyword">this</span>, Observer &#123; status -&gt;</span><br><span class="line">            <span class="keyword">if</span> (status != <span class="literal">null</span> &amp;&amp; status.state.isFinished) &#123;</span><br><span class="line">                <span class="keyword">val</span> myResult = status.outputData.getInt(KEY_RESULT,</span><br><span class="line">                      myDefaultValue)</span><br><span class="line">                <span class="comment">// ... do something with the result ...</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ é“¾æ¥äº† tasksï¼Œä¸€ä¸ª task çš„è¾“å‡ºå¯ä½œä¸ºé“¾ä¸­ä¸‹ä¸€ä¸ª task çš„è¾“å…¥ã€‚å¦‚æœå®ƒæ˜¯ä¸€ä¸ªç®€å•é“¾ï¼Œä½¿ç”¨å•ä¸ªçš„ <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a> é“¾æ¥å¦ä¸€ä¸ªå•ä¸ª <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a>ï¼Œç¬¬ä¸€ä¸ª tasker é€šè¿‡è°ƒç”¨ <a href="https://developer.android.com/reference/androidx/work/Worker.html#setOutputData(androidx.work.Data" target="_blank" rel="noopener"><code>setOutputData()</code></a>) è¿”å›ç»“æœï¼Œç„¶åä¸‹ä¸€ä¸ª task é€šè¿‡è°ƒç”¨ <a href="https://developer.android.com/reference/androidx/work/Worker.html#getinputdata" target="_blank" rel="noopener"><code>getInputData()</code></a> è·å–ç»“æœã€‚å¦‚æœé“¾æ›´å¤æ‚ â€”â€” æ¯”å¦‚ï¼Œå› ä¸ºå‡ ä¸ª task éƒ½å‘é€è¾“å…¥åˆ°ä¸€ä¸ªå•ä¸ªçš„åç»­ä»»åŠ¡ â€”â€” ä½ å¯ä»¥åœ¨ <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.Builder.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest.Builder</code></a> å®šä¹‰ä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/InputMerger.html" target="_blank" rel="noopener"><code>InputMerger</code></a> æ¥æŒ‡å®šå¦‚æœå¤šä¸ª tasks è¿”å›ä¸€ä¸ªç›¸åŒ key çš„è¾“å‡ºæ—¶åº”è¯¥æ€ä¹ˆå¤„ç†ã€‚</p>
<h2 id="é¢å¤–çš„èµ„æº"><a href="#é¢å¤–çš„èµ„æº" class="headerlink" title="é¢å¤–çš„èµ„æº"></a>é¢å¤–çš„èµ„æº</h2><p><code>WorkManager</code> æ˜¯ä¸€ä¸ª <a href="https://developer.android.com/jetpack/" target="_blank" rel="noopener">Android Jetpack</a> architecture componentã€‚å¯å‚é˜…ä½¿ç”¨åˆ°å®ƒçš„ <a href="https://github.com/googlesamples/android-sunflower" target="_blank" rel="noopener">Sunflower</a> demo appã€‚</p>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
            <tag> WorkManager </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component WorkManager åŸºç¡€ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/10/20/android_architecture_components_workermanager_basics/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-WorkManager-åŸºç¡€ï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-WorkManager-åŸºç¡€ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component WorkManager åŸºç¡€ï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component WorkManager åŸºç¡€ï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/architecture/workmanager/basics/" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/architecture/workmanager/basics/</a></p>
</blockquote>
<p>ä½¿ç”¨ WorkManagerï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°è®¾ç½®ä»»åŠ¡ï¼Œå¹¶å°†å®ƒç§»äº¤ç»™ç³»ç»Ÿå¹¶åœ¨ä½ æŒ‡å®šçš„æ¡ä»¶ä¸‹è¿è¡Œã€‚</p>
<p>æœ¬æ–‡è¿°ä»‹ç»äº† WorkManager æœ€åŸºæœ¬çš„åŠŸèƒ½ã€‚ä½ å¯ä»¥å­¦ä¹ åˆ°å¦‚ä½•å»è®¾ç½®ä¸€ä¸ª taskï¼ŒæŒ‡å®šåœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹è¿è¡Œï¼Œå¹¶äº¤ç»™ç³»ç»Ÿå¤„ç†ã€‚ä½ ä¹Ÿå¯ä»¥å¦‚ä½•å»è®¾ç½®ä¸€ä¸ªé‡å¤çš„ jobsã€‚</p>
<p>æ›´å¤šå…³äº WorkManager é«˜çº§åŠŸèƒ½çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ job é“¾çš„è¾“å…¥è¾“å‡ºå€¼ï¼Œå‚é˜… <a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced.html" target="_blank" rel="noopener">WorkManager é«˜çº§åŠŸèƒ½</a>ã€‚è¿˜æœ‰æ›´å¤šå¯ç”¨çš„åŠŸèƒ½ï¼›å®Œæ•´ä¿¡æ¯è§ <a href="https://developer.android.com/reference/androidx/work/package-summary" target="_blank" rel="noopener">WorkManager å‚è€ƒæ–‡æ¡£</a>ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šè¦å¯¼å…¥ WorkManager åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼Œè§ <a href="https://developer.android.com/topic/libraries/architecture/adding-components.html#workmanager" target="_blank" rel="noopener">åœ¨ä½ çš„é¡¹ç›®ä¸­å¢åŠ  Components</a>ã€‚</p>
</blockquote>
<h2 id="ç±»å’Œæ¦‚å¿µ"><a href="#ç±»å’Œæ¦‚å¿µ" class="headerlink" title="ç±»å’Œæ¦‚å¿µ"></a>ç±»å’Œæ¦‚å¿µ</h2><p>WorkManager API ä½¿ç”¨äº†å‡ ä¸ªä¸é€šçš„ç±»ã€‚åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œä½ è¦ç¼–å†™å…¶ä¸­ä¸€äº› API ç±»çš„å­ç±»ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æœ€é‡è¦çš„ WorkManager ç±»ï¼š</p>
<ul>
<li><a href="https://developer.android.com/reference/androidx/work/Worker.html" target="_blank" rel="noopener"><code>Worker</code></a>ï¼šæŒ‡å®šä½ éœ€è¦æ‰§è¡Œçš„ taskã€‚WorkManager APIs åŒ…å«äº†ä¸€ä¸ªæŠ½è±¡çš„ <a href="https://developer.android.com/reference/androidx/work/Worker.html" target="_blank" rel="noopener"><code>Worker</code></a> ç±»ã€‚ä½ è¦ç»§æ‰¿è¿™ä¸ªç±»å¹¶åœ¨è¿™é‡Œæ‰§è¡Œå·¥ä½œã€‚</li>
<li><a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a>ï¼šè¡¨ç¤ºä¸€ä¸ªå•ä¸ª taskã€‚æœ€ä½é™åº¦ï¼Œä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a> å¯¹è±¡æŒ‡å®šå“ªä¸ª <a href="https://developer.android.com/reference/androidx/work/Worker.html" target="_blank" rel="noopener"><code>Worker</code></a> ç±»åº”è¯¥æ‰§è¡Œ taskã€‚ä½†æ˜¯ä½ ä¹Ÿå¯ä»¥åœ¨ <a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a> å¯¹è±¡ä¸­å¢åŠ ç»†èŠ‚ï¼ŒæŒ‡å®šä»»åŠ¡åº”è¯¥åœ¨å“ªç§æƒ…å†µä¸‹è¿è¡Œçš„äº‹é¡¹ã€‚æ¯ä¸ª <a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a> æœ‰ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆçš„å”¯ä¸€ IDï¼›ä½ å¯ä»¥ä½¿ç”¨ ID æ¥åšä¸€äº›æ¯”å¦‚å–æ¶ˆæ’é˜Ÿä¸­çš„ task æˆ–è€…è·å– task çš„çŠ¶æ€ç­‰æ“ä½œã€‚<a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼›åœ¨ä½ çš„ä»£ç ä¸­ï¼Œä½ å°†ä½¿ç”¨å®ƒçš„ç›´æ¥å­ç±»ä¹‹ä¸€ï¼Œ<a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a> æˆ–è€… <a href="https://developer.android.com/reference/androidx/work/PeriodicWorkRequest.html" target="_blank" rel="noopener"><code>PeriodicWorkRequest</code></a>ã€‚<ul>
<li><a href="https://developer.android.com/reference/androidx/work/WorkRequest.Builder.html" target="_blank" rel="noopener"><code>WorkRequest.Builder</code></a>ï¼šä¸€ä¸ªå¸®åŠ©ç±»ï¼Œç”¨äºåˆ›å»º <a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a> å¯¹è±¡ã€‚åŒæ ·ï¼Œä½ å°†ä½¿ç”¨å®ƒçš„å­ç±»ä¹‹ä¸€ï¼Œ<a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.Builder.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest.Builder</code></a> æˆ–è€… <a href="https://developer.android.com/reference/androidx/work/PeriodicWorkRequest.Builder.html" target="_blank" rel="noopener"><code>PeriodicWorkRequest.Builder</code></a>ã€‚</li>
<li><a href="https://developer.android.com/reference/androidx/work/Constraints.html" target="_blank" rel="noopener"><code>Constraints</code></a>ï¼šæŒ‡å®šä½•æ—¶è¿è¡Œ taskï¼ˆæ¯”å¦‚ï¼Œâ€œåªåœ¨è¿æ¥åˆ°ç½‘ç»œæ—¶â€ï¼‰ çš„çº¦æŸã€‚ä½ ä½¿ç”¨ <a href="https://developer.android.com/reference/androidx/work/Constraints.Builder.html" target="_blank" rel="noopener"><code>Constraints.Builder</code></a> æ¥åˆ›å»º <a href="https://developer.android.com/reference/androidx/work/Constraints.html" target="_blank" rel="noopener"><code>Constraints</code></a>ï¼Œå¹¶ä¸”ä¼ é€’ <a href="https://developer.android.com/reference/androidx/work/Constraints.html" target="_blank" rel="noopener"><code>Constraints</code></a> åˆ° <a href="https://developer.android.com/reference/androidx/work/WorkRequest.Builder.html" target="_blank" rel="noopener"><code>WorkRequest.Builder</code></a> æ¥åˆ›å»º <a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a></li>
</ul>
</li>
<li><a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a>ï¼šæ’é˜Ÿå’Œç®¡ç† work è¯·æ±‚ã€‚ä½ æŠŠ <a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a> å¯¹è±¡ä¼ å…¥åˆ° <a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> å°† task æ’é˜Ÿã€‚<a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> å¯ä»¥åœ¨ä¸€ä¸ªåˆ†æ•£ç³»ç»Ÿèµ„æºçš„è´Ÿè½½åŒæ—¶åˆéµå®ˆæŒ‡å®šçº¦æŸçš„çš„æ–¹å¼è°ƒåº¦ taskã€‚</li>
<li><a href="https://developer.android.com/reference/androidx/work/WorkInfo.html" target="_blank" rel="noopener"><code>WorkInfo</code></a>ï¼šåŒ…å«äº†å…³äºæŸä¸ªç‰¹å®š task çš„ä¿¡æ¯ã€‚<a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> ä¸ºæ¯ä¸ª <a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a> å¯¹è±¡æä¾›äº†ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a>ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> æŒæœ‰ä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/WorkInfo.html" target="_blank" rel="noopener"><code>WorkInfo</code></a> å¯¹è±¡ï¼›é€šè¿‡è§‚å¯Ÿè¿™ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a>ï¼Œä½ å¯ä»¥ç¡®å®šä»»åŠ¡çš„å½“å‰çŠ¶æ€ï¼Œå¹¶åœ¨ä»»åŠ¡å®Œæˆåè·å–ä»»ä½•è¿”å›çš„å€¼ã€‚</li>
</ul>
<h2 id="å…¸å‹çš„å·¥ä½œæµç¨‹"><a href="#å…¸å‹çš„å·¥ä½œæµç¨‹" class="headerlink" title="å…¸å‹çš„å·¥ä½œæµç¨‹"></a>å…¸å‹çš„å·¥ä½œæµç¨‹</h2><p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªå›¾ç‰‡åº“çš„ appï¼Œå¹¶ä¸”è¿™ä¸ª app éœ€è¦å®šæœŸå»å‹ç¼©å­˜å‚¨çš„å›¾ç‰‡ã€‚ä½ å¸Œæœ›ä½¿ç”¨ WorkManager APIs æ¥è°ƒåº¦å›¾ç‰‡å‹ç¼©ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¹¶ä¸ç‰¹åˆ«å…³å¿ƒå›¾ç‰‡ä½•æ—¶ä¼šè¢«å‹ç¼©ï¼›ä½ æƒ³è®¾ç½®ä»»åŠ¡ï¼Œç„¶åå°±å¿˜æ‰å®ƒã€‚</p>
<p>é¦–å…ˆï¼Œä½ åº”è¯¥å»å®šä¹‰ä½ çš„ <a href="https://developer.android.com/reference/androidx/work/Worker.html" target="_blank" rel="noopener"><code>Work</code></a> ç±»ï¼Œç„¶åå¤å†™å®ƒçš„ <a href="https://developer.android.com/reference/androidx/work/Worker.html#doWork(" target="_blank" rel="noopener"><code>doWork()</code></a>) æ–¹æ³•ã€‚ä½ çš„ Worker ç±»æŒ‡å®šå¦‚ä½•å»æ‰§è¡Œè¿™ä¸ªæ“ä½œï¼Œä½†æ²¡æœ‰ä»»ä½•æœ‰å…³ task åº”è¯¥åœ¨ä½•æ—¶è¿è¡Œçš„ä¿¡æ¯ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CompressWorker</span></span>(context : Context, params : WorkerParameters)</span><br><span class="line">    : Worker(context, params) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">doWork</span><span class="params">()</span></span>: Result &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Do the work here--in this case, compress the stored images.</span></span><br><span class="line">        <span class="comment">// In this example no parameters are passed; the task is</span></span><br><span class="line">        <span class="comment">// assumed to be "compress the whole library."</span></span><br><span class="line">        myCompress()</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Indicate success or failure with your return value:</span></span><br><span class="line">        <span class="keyword">return</span> Result.SUCCESS</span><br><span class="line"></span><br><span class="line">        <span class="comment">// (Returning RETRY tells WorkManager to try this task again</span></span><br><span class="line">        <span class="comment">// later; FAILURE says not to try again.)</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åä½ åŸºäº <a href="https://developer.android.com/reference/androidx/work/Worker.html" target="_blank" rel="noopener"><code>Worker</code></a> å»åˆ›å»ºä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a> å¯¹è±¡ï¼Œç„¶åä½¿ç”¨ <a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> å°†å…¶æ’é˜Ÿï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> compressionWork = OneTimeWorkRequestBuilder&lt;CompressWorker&gt;().build()</span><br><span class="line">WorkManager.getInstance().enqueue(compressionWork)</span><br></pre></td></tr></table></figure>
<p><a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener">WorkManager</a> é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ—¶é—´å»è¿è¡Œè¿™ä¸ª task æ¥å¹³è¡¡è¯¸å¦‚ç³»ç»Ÿè´Ÿè½½ï¼Œè®¾å¤‡æ˜¯å¦æ’å…¥ç­‰è€ƒè™‘å› ç´ ã€‚åœ¨å¤§å¤šæƒ…å†µä¸‹ï¼Œå¦‚æœä½ ä¸æŒ‡å®šä»»ä½•çº¦æŸï¼Œ<a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> ä¼šç«‹å³è¿è¡Œä½ çš„ä»»åŠ¡ã€‚å¦‚æœä½ éœ€è¦å»æ£€æŸ¥ task çš„çŠ¶æ€ï¼Œä½ å¯ä»¥é€šè¿‡è·å–é€‚å½“çš„ <code>LiveData&lt;WorkInfo&gt;</code> çš„å¥æŸ„æ¥è·å–ä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/WorkInfo.html" target="_blank" rel="noopener"><code>WorkInfo</code></a>ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ æƒ³è¦å»æ£€æŸ¥ task æ˜¯å¦å·²ç»å®Œæˆäº†ï¼Œä½ åº”è¯¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">WorkManager.getInstance().getWorkInfoByIdLiveData(compressionWork.id)</span><br><span class="line">                .observe(lifecycleOwner, Observer &#123; workInfo -&gt;</span><br><span class="line">                    <span class="comment">// Do something with the status</span></span><br><span class="line">                    <span class="keyword">if</span> (workInfo != <span class="literal">null</span> &amp;&amp; workInfo.state.isFinished) &#123;</span><br><span class="line">                        <span class="comment">// ...</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br></pre></td></tr></table></figure>
<p>æ›´å¤šå…³äºä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> çš„è¯¦æƒ…ï¼Œè§ <a href="https://developer.android.com/topic/libraries/architecture/livedata" target="_blank" rel="noopener">LiveData æ¦‚è¦</a>ã€‚</p>
<h2 id="Task-æ¡ä»¶"><a href="#Task-æ¡ä»¶" class="headerlink" title="Task æ¡ä»¶"></a>Task æ¡ä»¶</h2><p>å¦‚æœä½ æƒ³è¦ï¼Œä½ å¯ä»¥å»æŒ‡å®š task åœ¨ä½•æ—¶åº”è¯¥è¿è¡Œçš„çº¦æŸã€‚ä¸¾ä¾‹ï¼Œä½ å¯èƒ½æƒ³è¦å»æŒ‡å®š task åº”è¯¥åªè¿è¡Œåœ¨è®¾å¤‡é—²ç½®ï¼Œå¹¶ä¸”ç”µæºè¿æ¥æ—¶ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.Builder.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest.Builder</code></a> å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ª builder æ¥åˆ›å»ºä¸€ä¸ªçœŸæ­£çš„ <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a>ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create a Constraints object that defines when the task should run</span></span><br><span class="line"><span class="keyword">val</span> myConstraints = Constraints.Builder()</span><br><span class="line">        .setRequiresDeviceIdle(<span class="literal">true</span>)</span><br><span class="line">        .setRequiresCharging(<span class="literal">true</span>)</span><br><span class="line">        <span class="comment">// Many other constraints are available, see the</span></span><br><span class="line">        <span class="comment">// Constraints.Builder reference</span></span><br><span class="line">        .build()</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...then create a OneTimeWorkRequest that uses those constraints</span></span><br><span class="line"><span class="keyword">val</span> compressionWork = OneTimeWorkRequestBuilder&lt;CompressWorker&gt;()</span><br><span class="line">        .setConstraints(myConstraints)</span><br><span class="line">        .build()</span><br></pre></td></tr></table></figure>
<p>ç„¶åæŠŠæ–°çš„ <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a> å¯¹è±¡ä¼ é€’åˆ° <a href="https://developer.android.com/reference/androidx/work/WorkManager#enqueue(java.util.List%3C?%20extends%20androidx.work.WorkRequest%3E" target="_blank" rel="noopener"><code>WorkManager.enqueue()</code></a>)ï¼Œåƒä¹‹å‰æ‰€è¯´çš„ï¼Œ<a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> ä¼šåœ¨æ‰¾è¿è¡Œä»»åŠ¡æ—¶é—´æ—¶ä¼šè€ƒè™‘ä½ çš„çº¦æŸæ¡ä»¶ã€‚</p>
<h2 id="å–æ¶ˆä¸€ä¸ª-Task"><a href="#å–æ¶ˆä¸€ä¸ª-Task" class="headerlink" title="å–æ¶ˆä¸€ä¸ª Task"></a>å–æ¶ˆä¸€ä¸ª Task</h2><p>åœ¨ä½ æŠŠä¸€ä¸ª task åŠ å…¥åˆ°é˜Ÿåˆ—åï¼Œä½ å¯ä»¥å»å–æ¶ˆå®ƒã€‚è¦å–æ¶ˆè¿™ä¸ª taskï¼Œä½ éœ€è¦ä¸€ä¸ªå®ƒçš„ work IDï¼Œè¿™å¯ä»¥åœ¨ä» <a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a> å¯¹è±¡ã€‚ä¸¾ä¾‹ï¼Œä¸‹é¢çš„ä»£ç å–æ¶ˆäº†ä¸Šé¢ä¸€èŠ‚ä¸­çš„ <code>compressionWork</code> è¯·æ±‚ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> compressionWorkId:UUID = compressionWork.getId()</span><br><span class="line">WorkManager.getInstance().cancelWorkById(compressionWorkId)</span><br></pre></td></tr></table></figure>
<p><a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> ä¼šå°½æœ€å¤§åŠªåŠ›å»å–æ¶ˆè¿™ä¸ª taskï¼Œä½†è¿™æœ¬è´¨ä¸Šæ˜¯ä¸ç¡®å®šçš„ â€“ å½“ä½ è¯•å›¾å–æ¶ˆä»»åŠ¡æ—¶ï¼Œä»»åŠ¡å¯èƒ½å·²ç»è¿è¡Œä¸­æˆ–å·²ç»å®Œæˆã€‚<a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> ä¹Ÿæä¾›æ–¹æ³•å»å–æ¶ˆåœ¨ <a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced.html#unique" target="_blank" rel="noopener">å”¯ä¸€å·¥ä½œåºåˆ—</a> ä¸­çš„æ‰€æœ‰ taskï¼Œæˆ–è€…æ‰€æœ‰æ‹¥æœ‰ä¸€ä¸ªæŒ‡å®š tag çš„æ‰€æœ‰ tasksï¼Œä¹Ÿæ˜¯åœ¨å°½æœ€å¤§åŠªåŠ›çš„åŸºç¡€ä¸Šçš„ã€‚</p>
<h2 id="Tagged-Work"><a href="#Tagged-Work" class="headerlink" title="Tagged Work"></a>Tagged Work</h2><p>ä½ å¯ä»¥é€šè¿‡ç»™ä»»ä½• <a href="https://developer.android.com/reference/androidx/work/WorkRequest.html" target="_blank" rel="noopener"><code>WorkRequest</code></a> å¯¹è±¡åˆ†é…ä¸€ä¸ªå­—ç¬¦ä¸²çš„ tag æ¥ä¸ºä½ çš„ tasks åœ¨é€»è¾‘ä¸Šè¿›è¡Œåˆ†ç»„ã€‚è¦è®¾ç½®ä¸€ä¸ª tagï¼Œè°ƒç”¨ <a href="https://developer.android.com/reference/androidx/work/WorkRequest.Builder#addtag" target="_blank" rel="noopener"><code>WorkRequest.Builder.addTag()</code></a>ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> cacheCleanupTask =</span><br><span class="line">        OneTimeWorkRequestBuilder&lt;MyCacheCleanupWorker&gt;()</span><br><span class="line">    .setConstraints(myConstraints)</span><br><span class="line">    .addTag(<span class="string">"cleanup"</span>)</span><br><span class="line">    .build()</span><br></pre></td></tr></table></figure>
<p><a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> ç±»æä¾›äº†å‡ ä¸ªå·¥å…·æ–¹æ³•æ¥è®©ä½ é€šè¿‡æŒ‡å®šçš„ tag æ¥æ“ä½œæ‰€æœ‰çš„ tasksã€‚æ¯”å¦‚ï¼Œ<a href="https://developer.android.com/reference/androidx/work/WorkManager#cancelallworkbytag" target="_blank" rel="noopener"><code>WorkManager.cancelAllWorkByTag()</code></a> é€šè¿‡æŒ‡å®š tag æ¥å–æ¶ˆæ‰€æœ‰ tasksï¼Œ<a href="https://developer.android.com/reference/androidx/work/WorkManager#getworkinfosbytaglivedata" target="_blank" rel="noopener"><code>WorkManager.getWorkInfosByTagLiveData()</code></a> è¿”å›ä¸€ä¸ªæ‰€æœ‰è¿™ä¸ª tag çš„ tasks çš„ <a href="https://developer.android.com/reference/androidx/work/WorkInfo.html" target="_blank" rel="noopener"><code>WorkInfo</code></a> åˆ—è¡¨ã€‚</p>
<h2 id="é‡å¤-tasks"><a href="#é‡å¤-tasks" class="headerlink" title="é‡å¤ tasks"></a>é‡å¤ tasks</h2><p>ä½ å¯èƒ½æœ‰ä¸€ä¸ª task éœ€è¦å»é‡å¤åœ°æ‰§è¡Œã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå›¾ç‰‡ç®¡ç† app å¯èƒ½ä¸ä¼šåªå‹ç¼©å›¾ç‰‡ä¸€æ¬¡ã€‚æ›´å¯èƒ½çš„æ˜¯ï¼Œå®ƒä¼šç»å¸¸å»æ£€æŸ¥å…±äº«çš„ç…§ç‰‡ï¼Œçœ‹æ˜¯å¦æœ‰æ–°çš„æˆ–è€…ä¿®æ”¹è¿‡çš„ç…§ç‰‡éœ€è¦è¢«å‹ç¼©ã€‚è¿™ä¸ªé‡å¤çš„ task å¯ä»¥åœ¨å®ƒæ‰¾åˆ°æ–°çš„å›¾ç‰‡æ—¶å‹ç¼©å›¾ç‰‡ï¼Œæˆ–è€…ï¼Œå½“å®ƒå‘ç°éœ€è¦å‹ç¼©çš„å›¾åƒæ—¶ï¼Œå®ƒå¯èƒ½ä¼šè§¦å‘æ–°çš„ â€œå‹ç¼©æ­¤å›¾åƒâ€ ä»»åŠ¡ã€‚</p>
<p>è¦åˆ›å»ºä¸€ä¸ªé‡å¤çš„ taskï¼Œä½¿ç”¨ <a href="https://developer.android.com/reference/androidx/work/PeriodicWorkRequest.Builder.html" target="_blank" rel="noopener"><code>PeriodicWorkRequest.Builder</code></a> ç±»æ¥åˆ›å»ºä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/PeriodicWorkRequest.html" target="_blank" rel="noopener"><code>PeriodicWorkRequest</code></a> å¯¹è±¡ï¼Œç„¶åè·Ÿ <a href="https://developer.android.com/reference/androidx/work/OneTimeWorkRequest.html" target="_blank" rel="noopener"><code>OneTimeWorkRequest</code></a> åŒæ ·çš„æ–¹å¼å»æ’é˜Ÿ <a href="https://developer.android.com/reference/androidx/work/PeriodicWorkRequest.html" target="_blank" rel="noopener"><code>PeriodicWorkRequest</code></a>ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code>PhotoCheckWorker</code> ç±»æ¥è¯†åˆ«å›¾ç‰‡æ˜¯å¦éœ€è¦è¢«å‹ç¼©ã€‚å¦‚æœä½ æƒ³è¦æ¯ 12 å°æ—¶ä¸€æ¬¡è¿è¡Œè¿™ä¸ªæ¸…å• taskï¼Œä½ åº”è¯¥å¦‚ä¸‹åˆ›å»ºä¸€ä¸ª <a href="https://developer.android.com/reference/androidx/work/PeriodicWorkRequest.html" target="_blank" rel="noopener"><code>PeriodicWorkRequest</code></a> å¯¹è±¡ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> photoCheckBuilder =</span><br><span class="line">        PeriodicWorkRequestBuilder&lt;PhotoCheckWorker&gt;(<span class="number">12</span>, TimeUnit.HOURS)</span><br><span class="line"><span class="comment">// ...if you want, you can apply constraints to the builder here...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Create the actual work object:</span></span><br><span class="line"><span class="keyword">val</span> photoCheckWork = photoCheckBuilder.build()</span><br><span class="line"><span class="comment">// Then enqueue the recurring task:</span></span><br><span class="line">WorkManager.getInstance().enqueue(photoCheckWork)</span><br></pre></td></tr></table></figure>
<p><a href="https://developer.android.com/reference/androidx/work/WorkManager.html" target="_blank" rel="noopener"><code>WorkManager</code></a> å°è¯•åœ¨ä½ è¯·æ±‚çš„æ—¶é—´é—´éš”å»è¿è¡Œä½ çš„ taskï¼Œå—ä½ è®¾ç½®çš„é™åˆ¶å’Œå…¶ä»–è¦æ±‚çš„çº¦æŸã€‚</p>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
            <tag> WorkManager </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component WorkManager æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/10/20/android_architecture_components_workermanager_overview/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-WorkManager-æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-WorkManager-æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component WorkManager æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component WorkManager æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/architecture/workmanager/" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/architecture/workmanager/</a></p>
</blockquote>
<p>WorkManager API å¯ä»¥è®©æŒ‡å®šå¯å»¶è¿Ÿçš„å¼‚æ­¥ä»»åŠ¡ä»¥åŠè¿™äº›ä»»åŠ¡åº”åœ¨ä½•æ—¶è¿è¡Œå˜å¾—ç®€å•ã€‚è¿™äº› API è®©ä½ åˆ›å»ºä¸€ä¸ª taskï¼Œå¹¶äº¤ç»™ WorkManager å¤„ç†æ¥ç«‹å³æˆ–åœ¨é€‚å½“çš„æ—¶é—´è¿è¡Œã€‚</p>
<p>WorkManager ä¼šåŸºäºè®¾å¤‡ API çš„çº§åˆ«å’Œ app çŠ¶æ€ç­‰å› ç´ æ¥é€‰æ‹©é€‚å½“çš„æ–¹å¼è¿è¡Œä½ çš„ taskã€‚åœ¨ app è¿è¡Œæ—¶ï¼Œå¦‚æœ WorkManager æ‰§è¡Œä½  tasks çš„å…¶ä¸­ä¸€ä¸ªï¼ŒWorkManager å¯ä»¥åœ¨ä½  app è¿›ç¨‹ä¸­çš„ä¸€ä¸ªæ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œä½ çš„ taskã€‚å¦‚æœ app æ²¡æœ‰åœ¨è¿è¡Œä¸­ï¼ŒWorkManager ä¼šé€‰æ‹©åˆé€‚çš„æ–¹å¼æ¥è°ƒåº¦ä¸€ä¸ªåå°ä»»åŠ¡ â€” å–å†³äºè®¾å¤‡ API çº§åˆ«å’ŒåŒ…å«çš„ä¾èµ–ï¼ŒWorkManager å¯èƒ½ä¼šä½¿ç”¨ <a href="https://developer.android.com/reference/android/app/job/JobScheduler.html" target="_blank" rel="noopener"><code>JobScheduler</code></a>ï¼Œ<a href="https://github.com/firebase/firebase-jobdispatcher-android#user-content-firebase-jobdispatcher-" target="_blank" rel="noopener"><code>Firebase JobDispatcher</code></a>ï¼Œæˆ–è€… <a href="https://developer.android.com/reference/android/app/AlarmManager.html" target="_blank" rel="noopener"><code>AlarmManager</code></a>ã€‚ä½ ä¸éœ€è¦ç¼–å†™è®¾å¤‡é€»è¾‘æ¥ç¡®å®šè®¾å¤‡å…·æœ‰å“ªäº›åŠŸèƒ½ï¼Œå¹¶é€‰æ‹©é€‚å½“çš„ apiã€‚è€Œæ˜¯ä½ ä»…ä»…æŠŠ task äº¤ç»™ WorkManager å¹¶è®©å®ƒè‡ªå·±é€‰æ‹©æœ€å¥½çš„æ–¹å¼ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šå·¥ä½œç®¡ç†å™¨é€‚ç”¨äºéœ€è¦ä¿è¯å³ä½¿åº”ç”¨é€€å‡ºç³»ç»Ÿä¹Ÿæœ‰è¿è¡Œçš„ä»»åŠ¡ï¼Œæ¯”å¦‚ä¸Šä¼  app æ•°æ®åˆ°æœåŠ¡å™¨ã€‚å®ƒä¸é€‚ç”¨äºåœ¨åº”ç”¨è¿›ç¨‹é”€æ¯æ—¶è¦å®‰å…¨ç»ˆæ­¢çš„è¿›ç¨‹å†…åå°å·¥ä½œã€‚å¯¹äºè¿™ç§åœºæ™¯ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ <a href="https://developer.android.com/training/multiple-threads/create-threadpool#ThreadPool" target="_blank" rel="noopener">ThreadPools</a>ã€‚</p>
</blockquote>
<h2 id="ä¸»é¢˜"><a href="#ä¸»é¢˜" class="headerlink" title="ä¸»é¢˜"></a>ä¸»é¢˜</h2><ul>
<li><p><a href="https://developer.android.com/topic/libraries/architecture/workmanager/basics.html" target="_blank" rel="noopener"><strong>WorkManager åŸºç¡€</strong></a></p>
<ul>
<li>ä½¿ç”¨å·¥ä½œç®¡ç†å™¨è®¡åˆ’åœ¨ä½ é€‰æ‹©çš„åœºæ™¯ä¸‹è¿è¡Œçš„å•ä¸ªä»»åŠ¡ï¼Œæˆ–ä»¥æŒ‡å®šé—´éš”è¿è¡Œçš„å®šæœŸä»»åŠ¡ã€‚</li>
</ul>
</li>
<li><p><a href="https://developer.android.com/topic/libraries/architecture/workmanager/advanced.html" target="_blank" rel="noopener"><strong>WorkManager é«˜çº§åŠŸèƒ½</strong></a></p>
<ul>
<li>è®¾ç½®é“¾æ¥çš„ä»»åŠ¡åºåˆ—ï¼Œè®¾ç½®è¾“å…¥è¾“å‡ºå€¼çš„ä»»åŠ¡ï¼Œå¹¶è®¾ç½®å‘½åçš„ï¼Œå”¯ä¸€çš„å·¥ä½œåºåˆ—ã€‚</li>
</ul>
</li>
</ul>
<h2 id="é¢å¤–èµ„æº"><a href="#é¢å¤–èµ„æº" class="headerlink" title="é¢å¤–èµ„æº"></a>é¢å¤–èµ„æº</h2><p><code>WorkManager</code> åœ¨ <a href="https://github.com/googlesamples/android-sunflower" target="_blank" rel="noopener">Sunflower</a> demo app ä¸­è¢«ä½¿ç”¨ã€‚</p>
<p>ä¹Ÿå¯ä»¥å‚é˜… Architecture Components <a href="https://github.com/googlesamples/android-architecture-components/tree/master/WorkManagerSample" target="_blank" rel="noopener">WorkManager sample</a>ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
            <tag> WorkManager </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æ„å»ºè‡ªå·±çš„ Smart Life ç§æœ‰äº‘ï¼ˆäºŒï¼‰-> è¿é€š IFTTT & Slack]]></title>
      <url>/2018/09/26/private-smart-life-cloud-b--working-with-ifttt-slack/</url>
      <content type="html"><![CDATA[<h1 id="æ„å»ºè‡ªå·±çš„-Smart-Life-ç§æœ‰äº‘ï¼ˆäºŒï¼‰-gt-è¿é€š-IFTTT-amp-Slack"><a href="#æ„å»ºè‡ªå·±çš„-Smart-Life-ç§æœ‰äº‘ï¼ˆäºŒï¼‰-gt-è¿é€š-IFTTT-amp-Slack" class="headerlink" title="æ„å»ºè‡ªå·±çš„ Smart Life ç§æœ‰äº‘ï¼ˆäºŒï¼‰-&gt; è¿é€š IFTTT &amp; Slack"></a>æ„å»ºè‡ªå·±çš„ Smart Life ç§æœ‰äº‘ï¼ˆäºŒï¼‰-&gt; è¿é€š IFTTT &amp; Slack</h1><p><a href="https://blog.wangjiegulu.com/2018/09/26/private-smart-life-cloud-a--hack-tuya-smart-plug/">ä¸Šä¸€ç¯‡</a>æˆ‘ä»¬ç ´è§£äº†æ¶‚é¸¦çš„æ’åº§ï¼Œæ­å»ºäº†è‡ªå·±çš„ web æœåŠ¡ï¼Œæš´éœ²äº†ä¸€ä¸ªæ¥å£æ¥æ§åˆ¶æ’åº§çš„å¼€å…³ã€‚è¿™ç¯‡æˆ‘ä»¬é…åˆ IFTTTã€Slack æ¥æ§åˆ¶æ’åº§ï¼š</p>
<ol>
<li>è¯´ â€œOK Googleâ€ å”¤é†’ Google Assistantï¼Œç„¶åè¯´ â€œå¸®æˆ‘æ‰“å¼€å§å®¤çš„ç”µæºâ€ï¼Œæœ€åæ’åº§è¢«æ‰“å¼€ã€‚</li>
<li>åˆ›å»º Slack æœºå™¨äºº <code>Angelia</code>ï¼Œå¯¹å®ƒå‘æ¶ˆæ¯â€œå¸®æˆ‘æ‰“å¼€å§å®¤çš„ç”µæºâ€ï¼Œç„¶åæ’åº§æ‰“å¼€ï¼Œ <code>Angelia</code> å›å¤è¯´ â€œå¥½çš„ï¼Œå·²ç»æ‰“å¼€â€ã€‚</li>
<li>é€šè¿‡ Slack æœºå™¨äºº <code>Angelia</code>ï¼Œå‘é€ Slash Commandsï¼Œæ‰“å¼€å…³é—­æ’åº§ã€‚</li>
</ol>
<h2 id="åˆ›å»ºè‡ªå·±ç§äººçš„-Slack-Workspace"><a href="#åˆ›å»ºè‡ªå·±ç§äººçš„-Slack-Workspace" class="headerlink" title="åˆ›å»ºè‡ªå·±ç§äººçš„ Slack Workspace"></a>åˆ›å»ºè‡ªå·±ç§äººçš„ Slack Workspace</h2><p>æ‰“å¼€ Slackï¼Œæ ¹æ®æç¤ºåˆ›å»ºè‡ªå·±çš„ Slack Workspace: <a href="https://slack.com/create" target="_blank" rel="noopener">https://slack.com/create</a></p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46124165-111e3080-c255-11e8-88ba-7be984c00cf3.png" width="500px"><br></div>

<p>æ¯”å¦‚æˆ‘çš„ Workspace ä¸º <a href="https://wangjie.slack.com" target="_blank" rel="noopener">https://wangjie.slack.com</a>ã€‚</p>
<h2 id="åˆ›å»º-Slack-App"><a href="#åˆ›å»º-Slack-App" class="headerlink" title="åˆ›å»º Slack App"></a>åˆ›å»º Slack App</h2><p>åˆ›å»ºå®Œæ¯•ç™»å½•ä¹‹åï¼Œé»˜è®¤åº”è¯¥æœ‰ <code>#general</code>ã€<code>#random</code> ç­‰ channelï¼Œä½†æš‚æ—¶ä¸ç”¨è¿™ä¸¤ä¸ª channelã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª Appã€‚</p>
<p>æ‰“å¼€ <a href="https://api.slack.com/" target="_blank" rel="noopener">https://api.slack.com/</a>ï¼Œç‚¹å‡» <code>Start Building</code></p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46124413-981fd880-c256-11e8-8cbb-572346f29fd7.png" width="600px"><br></div>

<p>è¾“å…¥ App åç§°å’Œä½ è¦æ·»åŠ åˆ°çš„ workspaceã€‚</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46124447-df0dce00-c256-11e8-959b-64a6fcd1bc84.png" width="600px"><br></div>

<h3 id="è®¾ç½®-Bot-ä¿¡æ¯"><a href="#è®¾ç½®-Bot-ä¿¡æ¯" class="headerlink" title="è®¾ç½® Bot ä¿¡æ¯"></a>è®¾ç½® Bot ä¿¡æ¯</h3><p>åˆ›å»ºå®Œæ¯•ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®è¿™ä¸ª app çš„æœºå™¨äººç›¸å…³ä¿¡æ¯ï¼Œæ‰“å¼€ <a href="https://api.slack.com/apps" target="_blank" rel="noopener">app è®¾ç½®é¡µé¢</a>ï¼Œé€‰æ‹© <code>Bot Users</code>ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46124676-1335be80-c258-11e8-89fa-b299badb545a.png" width="700px"><br></div>

<p>è®¾ç½®æœºå™¨äººçš„åç§°ï¼ˆDisplay name å’Œ Default nameï¼‰ã€‚å‹¾é€‰ <code>Always Show My Bot as Online</code>ï¼Œç‚¹å‡» <code>Save Changes</code>ã€‚</p>
<h3 id="è®¾ç½®-Events-API"><a href="#è®¾ç½®-Events-API" class="headerlink" title="è®¾ç½® Events API"></a>è®¾ç½® Events API</h3><p><a href="https://api.slack.com/bot-users#app-mentions-response" target="_blank" rel="noopener">Event API</a> å¯ä»¥åœ¨å„ç§æ—¶é—´å‘ç”Ÿçš„æ—¶å€™è§¦å‘è°ƒç”¨ï¼Œæ¯”å¦‚ æ¶ˆæ¯å‘é€çš„æ—¶å€™ã€channels æ”¹å˜çš„æ—¶å€™ç­‰ç­‰ã€‚</p>
<p>æˆ‘ä»¬å…ˆå›åˆ°æˆ‘ä»¬çš„ web æœåŠ¡ï¼Œæ‰“å¼€ä¸Šä¸€ç« åˆ›å»ºçš„ <code>AngeliaController</code>ï¼Œæ–°å¢ä¸€ä¸ªå¤„ç† Event çš„ apiï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/say/at"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">say</span><span class="params">(<span class="meta">@RequestBody</span> request: <span class="type">BotEventRequestVo</span>)</span></span>: JSONObject &#123;</span><br><span class="line">    logger.info(<span class="string">"[slack event request]request -&gt; \n<span class="variable">$request</span>"</span>)</span><br><span class="line">    <span class="keyword">return</span> JsonResult.success(</span><br><span class="line">                    <span class="string">"token"</span> to request.token,</span><br><span class="line">                    <span class="string">"challenge"</span> to request.challenge,</span><br><span class="line">                    <span class="string">"message"</span> to message</span><br><span class="line">            )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">BotEventRequestVo</span></span>(</span><br><span class="line">        <span class="keyword">val</span> challenge: String?,</span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> token: String?,</span><br><span class="line">        <span class="keyword">val</span> team_id: String?,</span><br><span class="line">        <span class="keyword">val</span> api_app_id: String?,</span><br><span class="line">        <span class="keyword">val</span> event: BotEventVo?,</span><br><span class="line">        <span class="keyword">val</span> type: String?,</span><br><span class="line">        <span class="keyword">val</span> event_id: String?,</span><br><span class="line">        <span class="keyword">val</span> event_time: String?,</span><br><span class="line">        <span class="keyword">val</span> authed_users: List&lt;String&gt;?</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">BotEventVo</span></span>(</span><br><span class="line">        <span class="keyword">val</span> type: String?,</span><br><span class="line">        <span class="keyword">val</span> user: String?,</span><br><span class="line">        <span class="keyword">val</span> text: String?,</span><br><span class="line">        <span class="keyword">val</span> client_msg_id: String?,</span><br><span class="line">        <span class="keyword">val</span> ts: String?,</span><br><span class="line">        <span class="keyword">val</span> channel: String?,</span><br><span class="line">        <span class="keyword">val</span> event_ts: String?,</span><br><span class="line">        <span class="keyword">val</span> channel_type: String?</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>æ„å»ºï¼Œéƒ¨ç½²åˆ°æœåŠ¡å™¨ã€‚</p>
<p>æ‰“å¼€ Slack App è®¾ç½®é¡µé¢çš„ <code>Event Subscriptions</code>ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46125203-abcd3e00-c25a-11e8-805f-d9f17bd235bc.png" width="700px"><br></div>

<p>åœ¨ <code>Request URL</code> ä¸­å¡«å†™åˆšåˆšåœ¨æˆ‘ä»¬ web æœåŠ¡ä¸Šåˆ›å»ºçš„æ¥å£ <code>http://[server ip]:xxx/angelia/say/at</code>ï¼Œå¹¶ä¸”ç‚¹å‡»éªŒè¯ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šè¿™é‡Œè®¤è¯çš„ä¾æ®æ˜¯ï¼Œä½ çš„æ¥å£ Response éœ€è¦è¿”å›è¯·æ±‚ä¸­çš„ <code>challenge</code> æ•°æ®å°±ç®—è®¤è¯æˆåŠŸã€‚</p>
</blockquote>
<p>ç„¶ååœ¨ <code>Subscribe to Bot Events</code> ä¸­æ·»åŠ è®¢é˜…çš„äº‹ä»¶ï¼Œéœ€è¦å¢åŠ çš„æ˜¯ <a href="https://api.slack.com/events/message.im" target="_blank" rel="noopener">message.im</a></p>
<blockquote>
<p><code>message.im</code>è¡¨ç¤ºå½“ä½ è·Ÿ bot çš„ç§èŠä¸­äº§ç”Ÿæ¶ˆæ¯çš„æ—¶å€™ï¼ˆæœ‰å¯èƒ½æ˜¯ä½ å‘é€æ¶ˆæ¯ç»™ Botï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ Bot å‘æ¶ˆæ¯ç»™ä½ ï¼‰ï¼Œäº‹ä»¶å°±ä¼šè§¦å‘ã€‚</p>
</blockquote>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46125314-21d1a500-c25b-11e8-83d1-89fbd8a596d1.png" width="600px"><br></div>

<p>ç‚¹å‡»ä¿å­˜ã€‚</p>
<p>è¿™æ—¶ï¼Œå½“ä½ åœ¨ Slack ä¸­å‘é€æ¶ˆæ¯ç»™æœºå™¨äººçš„æ—¶å€™ï¼Œä½ çš„ web æœåŠ¡ç«¯å°±èƒ½æ”¶åˆ°è¯·æ±‚äº†ã€‚</p>
<h3 id="å¤„ç†äº‹ä»¶"><a href="#å¤„ç†äº‹ä»¶" class="headerlink" title="å¤„ç†äº‹ä»¶"></a>å¤„ç†äº‹ä»¶</h3><p>ä½ çš„ web æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œéœ€è¦å¯¹æ­¤è¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥ä½ éœ€è¦å»è§£æå‘çš„æ¶ˆæ¯ä¸­çš„ä¿¡æ¯ï¼Œç„¶åæ‰“å¼€/å…³é—­å¯¹åº”è®¾å¤‡ï¼ˆæ’åº§ï¼‰çš„å¼€å…³ã€‚å®Œå–„ä¹‹å‰çš„ <code>say</code> æ¥å£ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">lateinit</span> <span class="keyword">var</span> tuyaClientService: TuyaClientService</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">lateinit</span> <span class="keyword">var</span> angeliaSlackProperties: AngeliaSlackProperties</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Angelia æœºå™¨äºº å¯¹è¯å…¥å£</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/say/at"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">say</span><span class="params">(<span class="meta">@RequestBody</span> request: <span class="type">BotEventRequestVo</span>)</span></span>: JSONObject &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="keyword">val</span> text = request.event?.text</span><br><span class="line">       <span class="keyword">val</span> eventType = request.event?.type</span><br><span class="line">       <span class="keyword">if</span> (eventType == <span class="string">"message"</span> <span class="comment">// ç›´æ¥å¯¹è¯</span></span><br><span class="line">            ||</span><br><span class="line">            request.event.user != angeliaSlackProperties.angelia_id <span class="comment">// angeliaè‡ªå·±å‘çš„å¿½ç•¥æ‰</span></span><br><span class="line">       ) &#123;</span><br><span class="line">          <span class="keyword">val</span> message = angeliaBotService.parseTuyaClient(text)</span><br><span class="line">                          ?: <span class="string">"Sorry, I can not understand."</span></span><br><span class="line"></span><br><span class="line">          angeliaSlackService.postMessage(JSONObject().apply &#123;</span><br><span class="line">              <span class="keyword">this</span>[<span class="string">"text"</span>] = <span class="string">"<span class="variable">$message</span>"</span></span><br><span class="line">              <span class="keyword">this</span>[<span class="string">"channel"</span>] = request.event.channel</span><br><span class="line">              <span class="keyword">this</span>[<span class="string">"as_user"</span>] = <span class="literal">true</span></span><br><span class="line">          &#125;)</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> JsonResult.success(</span><br><span class="line">               <span class="string">"token"</span> to request.token,</span><br><span class="line">               <span class="string">"challenge"</span> to request.challenge,</span><br><span class="line">               <span class="string">"message"</span> to <span class="string">"Request eventId(<span class="subst">$&#123;request.event_id&#125;</span>) done."</span></span><br><span class="line">       )</span><br><span class="line">   &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">       angeliaSlackService.postMessage(JSONObject().apply &#123;</span><br><span class="line">           <span class="keyword">this</span>[<span class="string">"text"</span>] = <span class="string">"Sorry! Something is wrong: <span class="subst">$&#123;e.message&#125;</span>"</span></span><br><span class="line">           <span class="keyword">this</span>[<span class="string">"channel"</span>] = request.event?.channel</span><br><span class="line">           <span class="keyword">this</span>[<span class="string">"as_user"</span>] = <span class="literal">true</span></span><br><span class="line">       &#125;)</span><br><span class="line">       <span class="keyword">return</span> JsonResult.error(e.message)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„é€»è¾‘å¾ˆç®€å•ï¼š</p>
<ul>
<li>é¦–å…ˆï¼ŒeventTypeæ˜¯ç›´æ¥å¯¹è¯çš„ï¼ˆä¸æœºå™¨äºº bot ç§èŠï¼‰ï¼Œå¹¶ä¸”æ˜¯æˆ‘å‘ç»™æœºå™¨äººçš„ï¼ˆæœºå™¨äººå‘ç»™æˆ‘çš„æ¶ˆæ¯ä¸ç”¨å¤„ç†ï¼‰æ‰ä¼šå»å¤„ç†</li>
<li>ç„¶åé€šè¿‡ <code>angeliaBotService.parseTuyaClient()</code> æ–¹æ³•è¿›è¡Œæ–‡æœ¬è§£æå’Œå¤„ç†</li>
<li>å¦‚æœè§£æä¸å‡ºæ¥ï¼Œåˆ™è¿”å› nullï¼Œmessage å°±æ˜¯ â€œSorry, I can not understand.â€</li>
<li>æœ€åè¿”å› Responseï¼ˆå¸¦ä¸Š messageï¼‰ï¼Œè¿™é‡Œçš„ message å°±æ˜¯ Bot å‘é€ç»™æˆ‘çš„æ•°æ®ã€‚</li>
</ul>
<p>è¿™é‡Œéœ€è¦åšä¸€äº› Slack çš„é…ç½® slack.propertiesï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># token for bot</span><br><span class="line">angelia.slack.bot_token=Bearer xoxb-2923xxxxxxxxxxxxxxxxxxxx</span><br><span class="line"></span><br><span class="line"># slack api</span><br><span class="line">angelia.slack.api_base_url=https://slack.com/api</span><br><span class="line">angelia.slack.api_chat_post_message=/chat.postMessage</span><br><span class="line"></span><br><span class="line">angelia.slack.angelia_id=UCWxxxxxx</span><br></pre></td></tr></table></figure>
<p><code>angelia.slack.bot_token</code>ï¼šæ˜¯ Bot å‘é€æ¶ˆæ¯åˆ° Slack çš„tokenï¼Œè¿™ä¸ª token å¯ä»¥åœ¨ app è®¾ç½®é¡µé¢çš„ <code>OAuth &amp; Permissions</code> ä¸­æ‹¿åˆ°</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46125989-09af5500-c25e-11e8-864b-18e3b6145aca.png" width="600px"><br></div>

<blockquote>
<p>æ³¨æ„ï¼šæ˜¯ä¸‹é¢çš„é‚£ä¸ª <code>Bot User OAuth Access Token</code>ï¼Œå¹¶ä¸”æ·»åŠ åˆ°é…ç½®æ–‡ä»¶çš„æ—¶å€™éœ€è¦åŠ ä¸Š <code>Bearer</code>ï¼ˆæ³¨æ„åé¢æœ‰ä¸ªç©ºæ ¼ï¼‰</p>
</blockquote>
<p><code>angelia.slack.api_base_url</code> å’Œ <code>angelia.slack.api_chat_post_message</code> æ˜¯å‘é€æ¶ˆæ¯çš„ urlï¼Œä¸ç”¨æ”¹åŠ¨ã€‚</p>
<p><code>angelia.slack.angelia_id</code> è¡¨ç¤ºæœºå™¨äººçš„idï¼Œå¯ä»¥é€šè¿‡åœ¨ slack å·¦ä¾§é€‰ä¸­æœºå™¨äººå³é”®å¤åˆ¶é“¾æ¥ï¼Œpath æœ€åéƒ¨åˆ†å°±æ˜¯ id</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126106-8d694180-c25e-11e8-84ae-ed01feda481d.png" width="250px"><br></div>

<p>æœ€åï¼Œä½ å°±èƒ½åœ¨ slack ä¸­æ‰“å¼€ä¸æœºå™¨äººèŠå¤©æ¡†ï¼Œå‘é€â€œå…³é—­æ’åº§aâ€æ¥æ§åˆ¶æ’åº§ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126279-3748ce00-c25f-11e8-997d-b47d8a1ea6ce.jpg" width="300px"><br></div>

<h2 id="é›†æˆ-Google-Assistant-å’Œ-IFTTT"><a href="#é›†æˆ-Google-Assistant-å’Œ-IFTTT" class="headerlink" title="é›†æˆ Google Assistant å’Œ IFTTT"></a>é›†æˆ Google Assistant å’Œ IFTTT</h2><blockquote>
<p>é¦–å…ˆç¡®ä¿ä½ çš„æ‰‹æœºè£…æœ‰ Google Assistantï¼ˆGoogle Home å…ˆä¸è®¨è®ºã€‚ã€‚ã€‚æ˜¯çš„ï¼Œæˆ‘æ²¡ä¹°- -ï¼‰ã€‚</p>
</blockquote>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨ web æœåŠ¡å™¨ç«¯å†åˆ›å»ºå¦‚ä¸‹ä¸€ä¸ªæ¥å£ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ’åº§æ§åˆ¶æ¥å£</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/control/plug"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">controlPlug</span><span class="params">(<span class="meta">@RequestBody</span> request: <span class="type">PlugRequestVo</span>)</span></span>: JSONObject &#123;</span><br><span class="line">   <span class="keyword">val</span> dev = tuyaClientProperties.findDev(request.alias)</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (<span class="literal">null</span> == dev) &#123;</span><br><span class="line">           JsonResult.error(<span class="string">"Device named <span class="subst">$&#123;request.alias&#125;</span> is not found"</span>)</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           tuyaClientService.controlPlug(dev.devId, request.turnOn)</span><br><span class="line">           JsonResult.success()</span><br><span class="line">       &#125;</span><br><span class="line">   &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">       JsonResult.error(e.message)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">PlugRequestVo</span></span>(</span><br><span class="line">     <span class="keyword">val</span> alias: String,</span><br><span class="line">     <span class="keyword">val</span> turnOn: <span class="built_in">Boolean</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>æ„å»ºéƒ¨ç½²åˆ°æœåŠ¡å™¨ã€‚</p>
<p>ç„¶åæ‰“å¼€IFTTTã€æ³¨å†Œï¼ˆå¦‚æœè¿˜æ²¡æœ‰è´¦æˆ·ï¼‰ç™»å½•ï¼Œåˆ›å»º Applet</p>
<p><strong>This</strong>ï¼šé€‰æ‹© Google Assistantï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126650-abd03c80-c260-11e8-8cf1-c9446bfa4f83.jpg" width="300px"><br></div>

<p><strong>That</strong>ï¼šé€‰æ‹© Webhookï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126688-d8845400-c260-11e8-894c-b5d3e0df143b.jpg" width="300px"><br></div>

<blockquote>
<p>æ³¨æ„ï¼šPOST è¯·æ±‚ï¼Œåœ¨ body ä¸­å¡«å†™å¦‚ä¸Š json æ•°æ®ã€‚<br>å…³é—­çš„ Applet ä¹Ÿæ˜¯ç±»ä¼¼ï¼ŒæŠŠ body ä¸­çš„ turnOn æ”¹æˆ false å°±å¯ä»¥äº†</p>
</blockquote>
<p>æœ€åï¼Œä½ å°±å¯ä»¥é€šè¿‡ â€œOK, Googleâ€ å”¤é†’ Google Assistantï¼Œç„¶åè¯´â€Turn on plug aâ€æ¥æ‰“å¼€æ’åº§äº†ã€‚</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126863-5c3e4080-c261-11e8-8e3d-1f199e647201.jpg" width="300px"><br></div>

<h3 id="åæ§½ä¸‹æ¶‚é¸¦çš„-Google-Assistant"><a href="#åæ§½ä¸‹æ¶‚é¸¦çš„-Google-Assistant" class="headerlink" title="åæ§½ä¸‹æ¶‚é¸¦çš„ Google Assistant"></a>åæ§½ä¸‹æ¶‚é¸¦çš„ Google Assistant</h3><p>æœ¬æ¥æƒ³ç›´æ¥ä½¿ç”¨ Google Assistant çš„ Smart Life çš„ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æˆåŠŸï¼Œå¾ˆå¤šäººä¹Ÿåœ¨åæ˜ è¿™ä¸ªäº‹æƒ…ï¼Œä¸è¿‡è²Œä¼¼æ²¡ä»€ä¹ˆæ•ˆæœï¼ˆçœ‹ä¸‹é¢è¿™ä¸ªè¯„åˆ†ï¼Œä¼°è®¡åæ˜ ä¸€ç›´æ˜¯è¢«æ— è§†çš„- -ï¼‰ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46129424-39178f00-c269-11e8-803f-861c952e37bf.jpg" width="300px"><br></div>

<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46129520-8eec3700-c269-11e8-851f-4998f8d793f6.jpg" width="300px"><br>    <img src="https://user-images.githubusercontent.com/5423194/46129603-c824a700-c269-11e8-9f2a-267b03bc17aa.jpg" width="300px"><br></div>




<h2 id="ä½¿ç”¨-Slack-çš„-Slash-Command-æ§åˆ¶"><a href="#ä½¿ç”¨-Slack-çš„-Slash-Command-æ§åˆ¶" class="headerlink" title="ä½¿ç”¨ Slack çš„ Slash Command æ§åˆ¶"></a>ä½¿ç”¨ Slack çš„ Slash Command æ§åˆ¶</h2><p>åœ¨ web æœåŠ¡ä¸­å†æ–°å¢ä¸¤ä¸ªæ¥å£ç”¨äº Slash Commandï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ’åº§æ§åˆ¶æ¥å£ï¼ŒFor Slack command line(slash commands)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/plug/turnon"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">plugTurnOnForCommand</span><span class="params">(<span class="meta">@RequestBody</span> body: <span class="type">String</span>)</span></span>: JSONObject &#123;</span><br><span class="line">   <span class="keyword">return</span> JsonResult.success(<span class="string">"text"</span> to plugControlForCommand(body, <span class="literal">true</span>))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* For Slack command line(slash commands)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/plug/turnoff"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">plugTurnOffForCommand</span><span class="params">(<span class="meta">@RequestBody</span> body: <span class="type">String</span>)</span></span>: JSONObject &#123;</span><br><span class="line">   <span class="keyword">return</span> JsonResult.success(<span class="string">"text"</span> to plugControlForCommand(body, <span class="literal">false</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* For Slack command line(slash commands) control</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">plugControlForCommand</span><span class="params">(body: <span class="type">String</span>, turnOn: <span class="type">Boolean</span>)</span></span>: String &#123;</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> body.split(<span class="string">"&amp;"</span>).map &#123;</span><br><span class="line">           <span class="keyword">val</span> pair = it.split(<span class="string">"="</span>)</span><br><span class="line">           Pair(pair[<span class="number">0</span>], URLDecoder.decode(pair[<span class="number">1</span>], <span class="string">"UTF-8"</span>))</span><br><span class="line">       &#125;.firstOrNull &#123;</span><br><span class="line">           it.first == <span class="string">"text"</span></span><br><span class="line">       &#125;?.let &#123;</span><br><span class="line">           <span class="keyword">val</span> dev = tuyaClientProperties.findContainsDev(it.second)</span><br><span class="line">           <span class="keyword">if</span> (<span class="literal">null</span> == dev) &#123;</span><br><span class="line">               <span class="string">"Sorry for failed command, Device named <span class="subst">$&#123;it.second&#125;</span> is not found."</span></span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               tuyaClientService.controlPlug(dev.devId, turnOn)</span><br><span class="line">               <span class="string">"<span class="subst">$&#123;if (turnOn) "Turn On" else "Turn Off"&#125;</span> Done(<span class="subst">$&#123;it.second&#125;</span>)."</span></span><br><span class="line">           &#125;</span><br><span class="line">       &#125; ?: <span class="string">"Sorry for failed command, Device name required."</span></span><br><span class="line">   &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"Sorry for failed command, <span class="subst">$&#123;e.message&#125;</span>."</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€ App è®¾ç½®é¡µé¢çš„ <code>Slash Commands</code>ï¼Œ</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46126962-a7f0ea00-c261-11e8-808a-6ccc8a63c049.png" width="600px"><br></div>

<p>ç‚¹å‡» <code>Create New Command</code>ï¼Œ</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46127140-5dbc3880-c262-11e8-97fe-75fcb05fc7df.png" width="500px"><br></div>

<p>ç„¶ååœ¨èŠå¤©çš„è¾“å…¥æ¡†ä¸­å°±å¯ä»¥é€šè¿‡â€/â€œæ˜¾ç¤º command æç¤ºï¼Œé€‰æ‹©å‘½ä»¤ï¼Œåé¢è·Ÿä¸Šä½ è¦æ‰§è¡Œè¯¥å‘½ä»¤çš„è®¾å¤‡åˆ«åå°±è¡Œäº†ã€‚</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46127236-a70c8800-c262-11e8-83a2-cdcfd8ebe10c.png" width="500px"><br></div>

<h2 id="å…¶å®ƒåœºæ™¯"><a href="#å…¶å®ƒåœºæ™¯" class="headerlink" title="å…¶å®ƒåœºæ™¯"></a>å…¶å®ƒåœºæ™¯</h2><p>è¿˜æœ‰å…¶å®ƒå¾ˆå¤šåœºæ™¯å¯ä»¥å®ç°ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>ç»“åˆ IFTTTï¼Œå½“ç¦»å¼€å®¶é—¨100mè¿œçš„æ—¶å€™ï¼Œè‡ªåŠ¨è§¦å‘ webhookï¼Œè®©ä½ çš„ç§æœ‰äº‘å¸®ä½ æŠŠç”µæºã€æ™ºèƒ½ä»¬å…³é—­ã€‚</li>
<li>å®æ—¶æ£€æµ‹ä½ çš„ä½ç½®å’Œå®¶é—¨ï¼Œå¦‚æœä½ ä¸åœ¨å®¶ï¼Œè‡ªåŠ¨è°ƒç”¨ Google Calendar ç¡®å®šä½ çš„æ—¥ç¨‹å®‰æ’ï¼Œå¦‚æœåˆæ²¡æœ‰å¤–å‡ºçš„å®‰æ’ï¼Œåˆ™é€šè¿‡ Slack å‘é€ Interactive messages åˆ°ä½ æ‰‹æœºä¸Šæé†’ï¼Œæä¾›æŒ‰é’®ä¸€é”®é”é—¨ã€‚</li>
<li>å°ç»†èŠ‚ï¼Œæ™šä¸Šæ‰‹æœºå……ç”µçš„æ—¶å€™ï¼Œå¯ä»¥è®¾å®šæ‰‹æœºä¸€æ—¦å……æ»¡ï¼Œå…³é—­ç”µæºï¼Œåˆå¦‚æœæ‰‹æœºç”µæºæ‰ç”µè¿‡å¿«ï¼Œä½äº90%çš„ç”µé‡ï¼Œé‡æ–°è‡ªåŠ¨å¼€å¯ç”µæºï¼Œç¡®ä¿ä½ æ—©ä¸Šèµ·åºŠçš„æ—¶å€™æ‰‹æœºç”µé‡è‚¯å®šåœ¨æŸä¸ªå€¼ä¹‹ä¸Šã€‚</li>
<li>ç­‰ç­‰ç­‰ç­‰ï¼Œå¤ªå¤šçš„æ™ºèƒ½åœºæ™¯å¯ä»¥å»å®ç°ã€‚</li>
</ul>
<h2 id="ç« å°¾"><a href="#ç« å°¾" class="headerlink" title="ç« å°¾"></a>ç« å°¾</h2><p>ç°åœ¨è¶Šæ¥è¶Šå¤šçš„å‚å•†åˆ¶ä½œç€å„ç§å„æ ·çš„æ™ºèƒ½è®¾å¤‡ï¼Œä½†æ˜¯åˆåœ¨è‡ªå·±çš„ä¸€äº©ä¸‰åˆ†åœ°å›ºæ­¥è‡ªå°ã€‚åšä¸ªæ’åº§ï¼Œæä¾›ä¸€ä¸ª app æ§åˆ¶ä¸‹å¼€å…³ã€å®šä¸ªæ—¶ã€åšä¸ª schedule å°±æ˜¯æ‰€è°“çš„æ™ºèƒ½äº†ï¼Œä½ ä¹°äº†æˆ‘çš„è®¾å¤‡å°±å¿…é¡»è¦ç”¨æˆ‘çš„è½¯ç¡¬ä»¶äº§å“ã€‚é‚£äº›éœ€è¦ç”¨æˆ·èŠ±å¿ƒæ€å»è€ƒè™‘ä»€ä¹ˆæ—¶å€™æˆ‘è¯¥æ€ä¹ˆçš„è®¾å¤‡ä¸æ˜¯å†°å†·çš„ï¼Œæ²¡æœ‰ç”Ÿå‘½çš„ä¹ˆï¼Ÿæ™ºèƒ½æ˜¯äººç±»èµ‹äºˆäº†è®¾å¤‡ç”Ÿå‘½ï¼ŒæŒæ¡äº†â€œæ€è€ƒâ€çš„èƒ½åŠ›ï¼Œç°åœ¨çš„ç”Ÿæ´»å¦‚æ­¤å¤šå…ƒåŒ–ï¼Œå†ç‰›çš„å…¬å¸ä¹Ÿä¸å¯èƒ½è¦†ç›–ä½ çš„æ‰€æœ‰ç”Ÿæ´»é¢†åŸŸï¼Œå¦‚æœä¹°äº†è¿™æ ·çš„æ™ºèƒ½è®¾å¤‡ä½†è‡ªæ­¤è¢«å›šå›°åœ¨è¿™é‡Œï¼Œæˆ‘æƒ³ï¼Œè¿™æ‰æ˜¯æˆ‘éæ™ºèƒ½ç”Ÿæ´»çš„å¼€å§‹å§ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Smart Life </category>
            
            <category> IoT </category>
            
        </categories>
        
        
        <tags>
            
            <tag> kotlin </tag>
            
            <tag> java </tag>
            
            <tag> Smart Life </tag>
            
            <tag> Internet of Things </tag>
            
            <tag> IoT </tag>
            
            <tag> tuya </tag>
            
            <tag> plug </tag>
            
            <tag> IFTTT </tag>
            
            <tag> Google Assistant </tag>
            
            <tag> Slack </tag>
            
            <tag> J2EE </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æ„å»ºè‡ªå·±çš„ Smart Life ç§æœ‰äº‘ï¼ˆä¸€ï¼‰-> ç ´è§£æ¶‚é¸¦æ™ºèƒ½æ’åº§]]></title>
      <url>/2018/09/26/private-smart-life-cloud-a--hack-tuya-smart-plug/</url>
      <content type="html"><![CDATA[<h1 id="æ„å»ºè‡ªå·±çš„-Smart-Life-ç§æœ‰äº‘ï¼ˆä¸€ï¼‰-gt-ç ´è§£æ¶‚é¸¦æ™ºèƒ½æ’åº§"><a href="#æ„å»ºè‡ªå·±çš„-Smart-Life-ç§æœ‰äº‘ï¼ˆä¸€ï¼‰-gt-ç ´è§£æ¶‚é¸¦æ™ºèƒ½æ’åº§" class="headerlink" title="æ„å»ºè‡ªå·±çš„ Smart Life ç§æœ‰äº‘ï¼ˆä¸€ï¼‰-&gt; ç ´è§£æ¶‚é¸¦æ™ºèƒ½æ’åº§"></a>æ„å»ºè‡ªå·±çš„ Smart Life ç§æœ‰äº‘ï¼ˆä¸€ï¼‰-&gt; ç ´è§£æ¶‚é¸¦æ™ºèƒ½æ’åº§</h1><p>æœ¬ç³»åˆ—æ–‡ç« çš„ç›®æ ‡æ˜¯é€šè¿‡è‡ªå·±æ­å»ºçš„<code>ç§æœ‰äº‘</code>ã€<code>IFTTT</code>ã€<code>Slack</code>ã€<code>Google Assistant</code>ã€<code>æ¶‚é¸¦æ™ºèƒ½</code>ã€<code>å›¾çµæœºå™¨äºº</code>ç­‰ç­‰ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œæ„å»ºè‡ªå·±çš„â€œæ™ºèƒ½ç”Ÿæ´»â€åŸºæœ¬çš„æ¡†æ¶ã€‚</p>
<p>å‰æ®µæ—¶é—´æˆ‘åœ¨äº¬ä¸œä¸Šè´­ä¹°äº†ä¸€ä¸ª<a href="https://item.jd.com/29882207900.html" target="_blank" rel="noopener">æ¶‚é¸¦æ™ºèƒ½çš„æ’åº§</a>ã€‚æ¶‚é¸¦æ™ºèƒ½æ˜¯ä¸€ä¸ªæŠŠäº§å“æ™ºèƒ½åŒ–çš„ä¸€ä¸ªå¹³å°ï¼Œä»è½¯ä»¶å’Œç¡¬ä»¶å’Œäº‘ç«¯ä¸Šé¢æä¾›ç»™å‚å•†ä¸€ä¸ªä¸€ç«™å¼äººå·¥æ™ºèƒ½ç‰©è”ç½‘çš„è§£å†³æ–¹æ¡ˆï¼ˆ<em>ç¡®å®ä¸æ˜¯æ¶‚é¸¦æ™ºèƒ½çš„å¹¿å‘Š- -.</em>ï¼‰ã€‚æ‰€ä»¥ä¸¥æ ¼æ¥è¯´åº”è¯¥æ˜¯â€œé¹Šèµ·â€åŸºäºæ¶‚é¸¦è§£å†³æ–¹æ¡ˆæ‰€å¼€å‘å‡ºæ¥çš„ä¸€ä¸ªäº§å“ï¼ŒåŸºäºæ¶‚é¸¦æä¾›çš„ä¸€åˆ‡è§„èŒƒï¼Œæ‰€æœ‰è½¯ç¡¬äº‘ç«¯çš„å¼€å‘è§„èŒƒéƒ½å¯ä»¥åœ¨å®˜ç½‘æ— æƒé™é™åˆ¶åœ°æŸ¥çœ‹åˆ°ï¼ˆ<a href="https://docs.tuya.com/cn/" target="_blank" rel="noopener">https://docs.tuya.com/cn/</a>ï¼‰</p>
<h2 id="åˆè¯•æ’åº§"><a href="#åˆè¯•æ’åº§" class="headerlink" title="åˆè¯•æ’åº§"></a>åˆè¯•æ’åº§</h2><p>æˆ‘é¦–å…ˆä¸‹è½½äº†æ¶‚é¸¦çš„å®˜æ–¹appï¼š<a href="https://play.google.com/store/apps/details?id=com.tuya.smartlife&amp;hl=en_US" target="_blank" rel="noopener">Smart Life</a>ï¼Œæ³¨å†Œç™»å½•ã€æ™ºèƒ½é…å¯¹æ’åº§ï¼Œé€šè¿‡æ‰‹æœºæ§åˆ¶æ’åº§å¼€å…³ï¼Œä¸€åˆ‡é¡ºåˆ©ï¼Œè¿˜æ”¯æŒè®¾ç½®å®šæ—¶å¼€å…³å’Œ Scheduleï¼Œè€Œä¸”æ‰‹æœºæ§åˆ¶åˆ°æ’åº§çš„ååº”ååˆ†çµæ•ï¼ˆçœ‹æ ·å­åº”è¯¥ä½¿ç”¨äº†é•¿é“¾æ¥ï¼‰ã€‚</p>
<h2 id="ç ´è§£æ’åº§"><a href="#ç ´è§£æ’åº§" class="headerlink" title="ç ´è§£æ’åº§"></a>ç ´è§£æ’åº§</h2><p>å½“ç„¶ä½¿ç”¨å®˜æ–¹ app æ˜¾ç„¶æ˜¯æ— æ³•æ»¡è¶³æˆ‘ä»¬éœ€æ±‚ï¼Œæ‰€ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œå‘ç°æ–‡æ¡£ä¸­çš„ <a href="https://docs.tuya.com/cn/cloudapi/appAPI/tuya.m.device.dp.publish_1.0.html" target="_blank" rel="noopener">tuya.m.device.dp.publish</a> æ¥å£æ­£å¥½å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p>
<p>é€šè¿‡<a href="https://docs.tuya.com/cn/cloudapi/app_access.html" target="_blank" rel="noopener">æ¥å…¥æŒ‡å—</a>ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æ¥å…¥æ–¹å¼æä¾›äº†ä¸¤ç§ï¼š</p>
<ol>
<li>MQTTï¼Œæœç„¶æœ‰ä½¿ç”¨é•¿é“¾æ¥ï¼ˆappç«¯é»˜è®¤ç”¨çš„åº”è¯¥å°±æ˜¯é•¿é“¾æ¥äº†ï¼‰</li>
<li>httpsï¼Œè¿™ä¸ªç›®å‰æ¯”è¾ƒé€‚åˆæˆ‘ä»¬ï¼Œæš‚æ—¶ä¸ç®¡å»¶è¿Ÿæ€ä¹ˆæ ·ï¼Œå…ˆé€‰æ‹©ç”¨ https æ¥éªŒè¯æ§åˆ¶çš„å¯è¡Œæ€§</li>
</ol>
<p>ä¸‹é¢æœ‰åˆ—å‡ºé€šç”¨çš„å‚æ•°ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>å‚æ•°ç±»å‹</th>
<th>æ˜¯å¦å¿…é¡»</th>
<th>æ˜¯å¦ç­¾å</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
<td>String</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>APIåç§°</td>
</tr>
<tr>
<td>v</td>
<td>String</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>APIæ¥å£ç‰ˆæœ¬</td>
</tr>
<tr>
<td>sid</td>
<td>String</td>
<td>å¦</td>
<td>æ˜¯</td>
<td>ç”¨æˆ·ç™»å½•æˆæƒæˆåŠŸåï¼ŒATOPé¢å‘ç»™åº”ç”¨çš„ç”¨æˆ·session</td>
</tr>
<tr>
<td>time</td>
<td>String</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>æ—¶é—´æˆ³ï¼Œæ ¼å¼ä¸ºæ•°å­—ï¼Œå¤§å°åˆ°ç§’éæ¯«ç§’ï¼Œæ—¶åŒºä¸ºæ ‡å‡†æ—¶åŒºï¼Œä¾‹å¦‚ï¼š1458010495ã€‚APIæœåŠ¡ç«¯å…è®¸å®¢æˆ·ç«¯è¯·æ±‚æœ€å¤§æ—¶é—´è¯¯å·®ä¸º540åˆ†é’Ÿã€‚</td>
</tr>
<tr>
<td>sign</td>
<td>String</td>
<td>æ˜¯</td>
<td>å¦</td>
<td>APIè¾“å…¥å‚æ•°ç­¾åç»“æœï¼Œç­¾åç®—æ³•å‚ç…§ä¸‹é¢çš„ä»‹ç»</td>
</tr>
<tr>
<td>clientId</td>
<td>String</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>ç”¨æˆ·çš„APPID(æ³¨å„å¹³å°ä¸ä¸€æ ·å¦‚:iosã€androidã€äº‘äº‘å¯¹æ¥çš„idéƒ½ä¸ä¸€æ ·)</td>
</tr>
<tr>
<td>lang</td>
<td>String</td>
<td>å¦</td>
<td>æ˜¯</td>
<td>APPçš„è¯­è¨€ï¼Œå¦‚â€enâ€ï¼Œâ€œzh_cnâ€,é”™è¯¯ä¿¡æ¯æ ¹æ®è¯­è¨€è‡ªåŠ¨ç¿»è¯‘</td>
</tr>
<tr>
<td>ttid</td>
<td>String</td>
<td>å¦</td>
<td>æ˜¯</td>
<td>APPæ¸ é“æˆ–äº‘ç«¯æ¸ é“,å¦‚å…¬å¸å,ç”¨äºæ•°æ®åˆ†æè·Ÿè¸ª</td>
</tr>
<tr>
<td>os</td>
<td>String</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>æ‰‹æœºæ“ä½œç³»ç»Ÿï¼Œå¦‚â€Androidâ€ï¼Œâ€œiosâ€,äº‘ç«¯å¯ä»¥å†™linuxæˆ–å†™å…¬å¸å</td>
</tr>
</tbody>
</table>
<p>ä¸Šè¿°æˆ‘ä»¬æ— æ³•æ‹¿åˆ°çš„æ˜¯å“ªäº›å‘¢ï¼Ÿ</p>
<ul>
<li>sidï¼šç™»å½•åè‡ªç„¶å°±èƒ½æ‹¿åˆ°äº†</li>
<li>signï¼šæ‰€æœ‰å‚æ•°éƒ½æœ‰äº†ï¼Œé‚£signè‡ªç„¶èƒ½ç®—å‡ºæ¥ï¼ˆæ–‡æ¡£ä¸‹é¢æœ‰signç®—æ³•ï¼‰</li>
<li>clientIdï¼šè¿™ç©æ„å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œç›¸å½“äºä¸€ä¸ªapiKey</li>
<li>ttidï¼šè¿™ä¸ªéå¿…é¡»ï¼Œæš‚æ—¶å¯ä»¥ä¸ç®¡</li>
</ul>
<p>æ‰€ä»¥åªè¦æ‹¿åˆ° clientIdï¼Œæˆ‘ä»¬å°±èƒ½</p>
<ul>
<li>é€šè¿‡ <a href="https://docs.tuya.com/cn/cloudapi/appAPI/userAPI/tuya.m.user.mobile.token.get_1.0.html" target="_blank" rel="noopener">tuya.m.user.email.token.get</a> æ¥å£æ‹¿åˆ°ç™»å½•ç”¨çš„ token</li>
<li>é€šè¿‡ <a href="tuya.m.user.mobile.passwd.login">tuya.m.user.mobile.passwd.login</a> æ¥å£ç™»å½•</li>
<li>ç„¶åé€šè¿‡ <a href="https://docs.tuya.com/cn/cloudapi/appAPI/tuya.m.device.dp.publish_1.0.html" target="_blank" rel="noopener">tuya.m.device.dp.publish</a> æ¥å£ä¸‹å‘æŒ‡ä»¤</li>
</ul>
<p>é‚£æ€ä¹ˆå»æ‹¿åˆ° clientId å‘¢ï¼Ÿåç¼–è¯‘è¯•è¯•ï¼ˆå¤§å®¶åº”è¯¥éƒ½çŸ¥é“æ€ä¹ˆåšï¼‰ï¼Œclass.dex æœ‰ç‚¹å¤šï¼Œæœ€åæ‹¿åˆ°äº† </p>
<ul>
<li>client_idï¼š<code>8qp5cfk*******3mpmc3</code>ï¼ˆè¿™ä¸ªæ‰“ç äº†ï¼‰</li>
<li>app_secretï¼š<code>g75ktcvsae8**********e95j738tawg</code>ï¼ˆåŒæ ·æ‰“ç ï¼‰</li>
</ul>
<h3 id="æ‹¿åˆ°ç™»å½•-token"><a href="#æ‹¿åˆ°ç™»å½•-token" class="headerlink" title="æ‹¿åˆ°ç™»å½• token"></a>æ‹¿åˆ°ç™»å½• token</h3><p>æ‰“å¼€ <code>Postman</code>ï¼Œ<a href="https://docs.tuya.com/cn/cloudapi/appAPI/userAPI/tuya.m.user.mobile.token.get_1.0.html" target="_blank" rel="noopener">æŒ‰ç…§æ–‡æ¡£</a> POST <code>countryCode</code> å’Œ <code>mobile</code> å¯ä»¥å¾—åˆ° tokenï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"api"</span>:<span class="string">"tuya.m.user.mobile.token.get"</span>,</span><br><span class="line">    <span class="attr">"result"</span>:&#123;</span><br><span class="line">        <span class="attr">"exponent"</span>:<span class="string">"3"</span>,</span><br><span class="line">        <span class="attr">"pExponent"</span>:<span class="string">"..."</span>,</span><br><span class="line">        <span class="attr">"publicKey"</span>:<span class="string">"..."</span>,</span><br><span class="line">        <span class="attr">"token"</span>:<span class="string">"..."</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"status"</span>:<span class="string">"ok"</span>,</span><br><span class="line">    <span class="attr">"success"</span>:<span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="é€šè¿‡-token-è¿›è¡Œç™»å½•"><a href="#é€šè¿‡-token-è¿›è¡Œç™»å½•" class="headerlink" title="é€šè¿‡ token è¿›è¡Œç™»å½•"></a>é€šè¿‡ token è¿›è¡Œç™»å½•</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"countryCode"</span>:<span class="string">"86"</span>,</span><br><span class="line">    <span class="attr">"mobile"</span>:<span class="string">"11745678923"</span>,</span><br><span class="line">    <span class="attr">"passwd"</span>:<span class="string">"æ ¹æ®è·å–tokenæ¥å£è¿”å›çš„å…¬é’¥å¯¹ md5(æ˜æ–‡å¯†ç ) è¿›è¡ŒrsaåŠ å¯†"</span>,</span><br><span class="line">    <span class="attr">"token"</span>:<span class="string">"126bb7570dcae343980b0607e6b35084"</span>,</span><br><span class="line">    <span class="attr">"ifencrypt"</span>:<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®<a href="https://docs.tuya.com/cn/cloudapi/appAPI/userAPI/tuya.m.user.mobile.passwd.login_1.0.html" target="_blank" rel="noopener">ç™»å½•æ¥å£çš„æ–‡æ¡£</a>ï¼Œå¯†ç éœ€è¦ä½¿ç”¨ gettoken æ¥å£è¿”å›çš„å…¬é’¥å¯¹ md5ä¹‹åçš„å¯†ç è¿›è¡Œ rsa åŠ å¯†ï¼Œapk åç¼–è¯‘ä¹‹åä»£ç å¯ä»¥å®Œå…¨çœ‹åˆ°ï¼Œç›´æ¥æ‹·è´å³å¯</p>
<p>ç™»å½•å®Œä¹‹åï¼Œå°±å¯ä»¥æ‹¿åˆ°å…·ä½“çš„ sid ï¼ˆsessionIdï¼‰äº†ï¼Œæœ‰äº† sessionIdï¼Œå°±å¯ä»¥å»å¯¹æ’åº§è¿›è¡Œä¸‹å‘æŒ‡ä»¤ã€‚</p>
<h3 id="æ’åº§ä¸‹å‘æŒ‡ä»¤"><a href="#æ’åº§ä¸‹å‘æŒ‡ä»¤" class="headerlink" title="æ’åº§ä¸‹å‘æŒ‡ä»¤"></a>æ’åº§ä¸‹å‘æŒ‡ä»¤</h3><p>åŒæ ·<a href="https://docs.tuya.com/cn/cloudapi/appAPI/tuya.m.device.dp.publish_1.0.html" target="_blank" rel="noopener">æ ¹æ®ä¸‹å‘æŒ‡ä»¤æ¥å£æ–‡æ¡£</a>ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"devId"</span>: <span class="string">"002yt001sf000000sfV3"</span>,</span><br><span class="line">    <span class="attr">"dps"</span>: &#123;</span><br><span class="line">       <span class="attr">"1"</span>:<span class="number">1</span>,</span><br><span class="line">       <span class="attr">"2"</span>:<span class="number">5</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒPOST çš„æ•°æ®é™¤äº† sidï¼Œè¿˜éœ€è¦ devId å’Œ dps</p>
<p>dps å¯ä»¥å‚è€ƒè¿™é‡Œçš„æ–‡æ¡£ï¼š<a href="https://fchelp.cloud.alipay.com/queryArticleContent.htm?tntInstId=WRNQWLCN&amp;articleId=89429815&amp;helpCode=SCE_00000019" target="_blank" rel="noopener">https://fchelp.cloud.alipay.com/queryArticleContent.htm?tntInstId=WRNQWLCN&amp;articleId=89429815&amp;helpCode=SCE_00000019</a></p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/46066359-0dcc6b80-c1a7-11e8-8d29-5391b7f7f87a.png"><br></div>

<p>æˆ‘ä»¬è¦æ§åˆ¶æ’åº§å¼€å…³çš„è¯ï¼Œé‚£å°±ä½¿ç”¨ <code>{&quot;1&quot;: true}</code> / <code>{&quot;1&quot;: false}</code> å³å¯</p>
<p>é‚£ devId å‘¢ï¼Ÿå®ƒä»£è¡¨æˆ‘æ·»åŠ è®¾å¤‡ idï¼Œé‚£æˆ‘æ€ä¹ˆçŸ¥é“æˆ‘åˆšç»™åœ¨ Smart Life ä¸Šæ·»åŠ çš„æ’åº§ id å‘¢ï¼ŸæŠ“åŒ…è¯•è¯•ï¼ˆå¤§å®¶åº”è¯¥éƒ½çŸ¥é“ï¼‰ï¼Œé€šè¿‡æŠ“åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“æ‹¿åˆ°æ‰€æœ‰ä½ ç»‘å®šçš„ devIdã€‚</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ http æ¥æ§åˆ¶æ’åº§çš„å¼€å…³äº†ã€‚</p>
<h2 id="æ­å»ºè‡ªå·±çš„ç§æœ‰äº‘é¡¹ç›®"><a href="#æ­å»ºè‡ªå·±çš„ç§æœ‰äº‘é¡¹ç›®" class="headerlink" title="æ­å»ºè‡ªå·±çš„ç§æœ‰äº‘é¡¹ç›®"></a>æ­å»ºè‡ªå·±çš„ç§æœ‰äº‘é¡¹ç›®</h2><blockquote>
<p>æˆ‘ä¸ºè‡ªå·±çš„é¡¹ç›®å–åä¸º <code>Angelia</code>ï¼Œå®‰é©åˆ©äºšï¼Œå¤å¸Œè…Šç¥è¯äººç‰©ä¹‹ä¸€ï¼Œä¸ºâ€œæ¶ˆæ¯å¥³ç¥â€ã€‚</p>
</blockquote>
<p>æ­å»º web é¡¹ç›®ï¼Œæ–°å»º <code>AngeliaController</code>ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(<span class="meta-string">"/angelia"</span>)</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AngeliaController</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¢åŠ  Tuya çš„é…ç½®æ–‡ä»¶ï¼štuyaclient.properties</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">tuya.client.client_id=xxxxxx</span><br><span class="line">tuya.client.app_secret=xxxxxx</span><br><span class="line">tuya.client.ttid=xxxxxx</span><br><span class="line">tuya.client.v=1.0</span><br><span class="line">tuya.client.base_url=https://a1.tuyacn.com/api.json</span><br><span class="line"></span><br><span class="line"># smart life app ç™»å½•æ‰‹æœºå·</span><br><span class="line">tuya.client.user_mobile=18511111111</span><br><span class="line">tuya.client.user_country_code=86</span><br><span class="line">tuya.client.user_rsa_encrypted_passwd=xxx</span><br><span class="line"></span><br><span class="line"># è®¾å¤‡ä¿¡æ¯</span><br><span class="line">tuya.client.lang=en</span><br><span class="line">tuya.client.os=Android</span><br><span class="line">tuya.client.os_system=9</span><br><span class="line">tuya.client.time_zone_id=Asia/Shanghai</span><br><span class="line">tuya.client.platform=Pixel</span><br><span class="line">tuya.client.sdk_version=2.6.4</span><br><span class="line">tuya.client.app_version=3.4.3</span><br><span class="line">tuya.client.app_rn_version=5.6</span><br><span class="line"># è®¾å¤‡ idï¼Œæ¨¡æ‹Ÿæ‰‹æœºçš„ deviceId</span><br><span class="line">tuya.client.device_id=e507510a0288accd7******</span><br><span class="line">tuya.client.imei=xxxxxx</span><br><span class="line">tuya.client.imsi=xxxxxx</span><br><span class="line"></span><br><span class="line"># æ™ºèƒ½è®¾å¤‡ï¼Œå¯ä»¥å¤šä¸ªï¼šåˆ«å|id|dpid,åˆ«å|id|dpid,åˆ«å|id|dpid</span><br><span class="line"># dpid: 1. å¼€å…³ï¼›4.rgbï¼›5. æ¡£ä½ï¼›6. æ¸©åº¦ï¼›15. çº¢å¤–æ•°æ®</span><br><span class="line">tuya.client.dev_ids=[\</span><br><span class="line">  &#123;\</span><br><span class="line">    &quot;aliasList&quot;: [&quot;plug a&quot;, &quot;plug 1&quot;, &quot;æ’åº§a&quot;, &quot;æ´—æ‰‹é—´æ€»ç”µæº&quot;],\</span><br><span class="line">    &quot;devId&quot;: &quot;111222333&quot;,\</span><br><span class="line">    &quot;dpId&quot;: &quot;1&quot;\</span><br><span class="line">  &#125;,\</span><br><span class="line">  &#123;\</span><br><span class="line">    &quot;aliasList&quot;: [&quot;plug b&quot;, &quot;plug 2&quot;, &quot;æ’åº§b&quot;, &quot;å§å®¤æ€»ç”µæº&quot;],\</span><br><span class="line">    &quot;devId&quot;: &quot;12341234&quot;,\</span><br><span class="line">    &quot;dpId&quot;: &quot;1&quot;\</span><br><span class="line">  &#125;,\</span><br><span class="line">  // ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šï¼Œé™¤äº†åˆšåˆšçš„é‚£äº›å¿…è¦çš„å‚æ•°ä¹‹ç±»ï¼Œåœ¨è¿™ä¸ªé…ç½®æ–‡ä»¶é‡Œé¢è¿˜å¢åŠ äº†å¯¹æ‰€æœ‰è®¾å¤‡çš„é…ç½®ï¼Œæ¯ä¸ªè®¾å¤‡å¯¹åº”å®ƒçš„ dpIdï¼ŒdevIdï¼Œè¿˜æœ‰åˆ«åï¼ˆæ§åˆ¶çš„æ—¶å€™ä¸å¯èƒ½ç›´æ¥è¯´ â€œdevId ä¸º a1d2f32a1d2f32 çš„æ’åº§å…³æ‰â€ï¼Œè€Œæ˜¯è¯´ â€œå…³æ‰æ’åº§1â€ / â€œå…³æ‰æ´—æ‰‹é—´æ€»ç”µæºâ€ç­‰ç­‰ï¼‰ï¼Œæ¯ä¸ªè®¾å¤‡åˆ«åå¯ä»¥æœ‰å¤šä¸ªã€‚</p>
<p>å¥½äº†ï¼Œå›åˆ° <code>AngeliaController</code>ï¼Œæ–°å¢ä¸€ä¸ªæ¥å£ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ’åº§æ§åˆ¶æ¥å£</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">lateinit</span> <span class="keyword">var</span> tuyaClientService: TuyaClientService</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">lateinit</span> <span class="keyword">var</span> tuyaClientProperties: TuyaClientProperties</span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping(<span class="meta-string">"/control/plug"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">controlPlug</span><span class="params">(<span class="meta">@RequestBody</span> request: <span class="type">PlugRequestVo</span>)</span></span>: JSONObject &#123;</span><br><span class="line">   <span class="keyword">val</span> dev = tuyaClientProperties.findDev(request.alias)</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (<span class="literal">null</span> == dev) &#123;</span><br><span class="line">           JsonResult.error(<span class="string">"Device named <span class="subst">$&#123;request.alias&#125;</span> is not found"</span>)</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           tuyaClientService.controlPlug(dev.devId, request.turnOn)</span><br><span class="line">           JsonResult.success()</span><br><span class="line">       &#125;</span><br><span class="line">   &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">       JsonResult.error(e.message)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">PlugRequestVo</span></span>(</span><br><span class="line">     <span class="keyword">val</span> alias: String,</span><br><span class="line">     <span class="keyword">val</span> turnOn: <span class="built_in">Boolean</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šï¼Œè¯¥æ¥å£æ¥æ”¶åˆ«åï¼ˆaliasï¼‰å’Œå¼€é—­çŠ¶æ€ï¼ˆturnOnï¼‰ä¸¤ä¸ªå…¥å‚ã€‚é¦–å…ˆï¼Œé€šè¿‡è¯·æ±‚çš„åˆ«åå» properties æŸ¥æ‰¾è®¾å¤‡ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™é€šè¿‡ <code>tuyaClientService</code> çš„ <code>controlPlug</code> æ–¹æ³•æ¥ä¸‹å‘æŒ‡ä»¤ï¼Œ<code>controlPlug</code> çš„å®ç°å°±æ˜¯åˆšåˆšä¸Šé¢è¯´çš„ <code>è·å–ç™»å½•æ¥å£-ç™»å½•-ä¸‹å‘æŒ‡ä»¤</code>å‡ æ­¥ã€‚</p>
<p>æ„å»ºã€éƒ¨ç½²ï¼Œé€šè¿‡ Postman è®¿é—® <code>http://localhost:xxxxx/angelia/control/plug</code>, body è®¾ç½®ä¸º <code>{&quot;alias&quot;: &quot;å§å®¤æ€»ç”µæº&quot;, &quot;turnOn&quot;: true}</code>ï¼Œæ’åº§å³å¯æ‰“å¼€ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Smart Life </category>
            
            <category> IoT </category>
            
        </categories>
        
        
        <tags>
            
            <tag> kotlin </tag>
            
            <tag> java </tag>
            
            <tag> Smart Life </tag>
            
            <tag> Internet of Things </tag>
            
            <tag> IoT </tag>
            
            <tag> tuya </tag>
            
            <tag> plug </tag>
            
            <tag> IFTTT </tag>
            
            <tag> Google Assistant </tag>
            
            <tag> Slack </tag>
            
            <tag> J2EE </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç†è§£ CI å’Œ CD ä¹‹é—´çš„åŒºåˆ«ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/09/10/understanding-the-difference-between-ci-and-cd/</url>
      <content type="html"><![CDATA[<h1 id="ç†è§£-CI-å’Œ-CD-ä¹‹é—´çš„åŒºåˆ«"><a href="#ç†è§£-CI-å’Œ-CD-ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="ç†è§£ CI å’Œ CD ä¹‹é—´çš„åŒºåˆ«"></a>ç†è§£ CI å’Œ CD ä¹‹é—´çš„åŒºåˆ«</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://thenewstack.io/understanding-the-difference-between-ci-and-cd/?utm_source=wanqu.co&amp;utm_campaign=Wanqu+Daily&amp;utm_medium=website" target="_blank" rel="noopener">https://thenewstack.io/understanding-the-difference-between-ci-and-cd/?utm_source=wanqu.co&amp;utm_campaign=Wanqu+Daily&amp;utm_medium=website</a></p>
</blockquote>
<p>æœ‰å¾ˆå¤šå…³äºæŒç»­é›†æˆï¼ˆCIï¼‰å’ŒæŒç»­äº¤ä»˜ï¼ˆCDï¼‰çš„èµ„æ–™ã€‚å¾ˆå¤šæ–‡ç« ç”¨æŠ€æœ¯æœ¯è¯­æ¥è¿›è¡Œè§£é‡Šï¼Œä»¥åŠå®ƒä»¬æ€ä¹ˆå¸®åŠ©ä½ çš„ç»„ç»‡ã€‚å¯æƒœçš„æ˜¯ï¼Œåœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œè¿™äº›æ–¹æ³•é€šå¸¸ä¸ç‰¹å®šå·¥å…·ã€ç”šè‡³ä¾›åº”å•†ç›¸å…³è”ã€‚åœ¨å…¬å¸é£Ÿå ‚é‡Œéå¸¸å¸¸è§çš„è°ˆè¯å¯èƒ½æ˜¯ï¼š</p>
<ol>
<li>ä½ åœ¨ä½ ä»¬å›¢é˜Ÿé‡Œé¢ä½¿ç”¨æŒç»­é›†æˆå—ï¼Ÿ</li>
<li>å½“ç„¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ X å·¥å…·</li>
</ol>
<p><em>è®©æˆ‘æ¥å‘Šè¯‰ä½ ä¸€äº›ç§˜å¯†</em>ã€‚æŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜éƒ½æ˜¯å¼€å‘æ–¹æ³•ã€‚å®ƒä»¬æ²¡æœ‰é“¾æ¥åˆ°ç‰¹å®šçš„å·¥å…·æˆ–è€…ä¾›åº”å•†ã€‚å°½ç®¡æœ‰DOï¼ˆæ¯”å¦‚<a href="https://codefresh.io/" target="_blank" rel="noopener">Codefresh</a>ï¼‰è¿™æ ·çš„å·¥å…·å’Œè§£å†³æ–¹æ³•åœ¨è¿™ä¸¤æ–¹é¢å¸®åŠ©ä½ ï¼Œå®é™…ä¸Šï¼Œä¸€ä¸ªå…¬å¸å¯ä»¥åªä½¿ç”¨ Bash è„šæœ¬å’Œ Perl one-linersï¼ˆä¸æ˜¯çœŸçš„ä½¿ç”¨ï¼Œä½†æ˜¯æœ‰å¯èƒ½çš„ï¼‰æ¥ç»ƒä¹  CI / CDã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸ä¼šé™·å…¥ä½¿ç”¨å·¥å…·å’ŒæŠ€æœ¯æœ¯è¯­æ¥è§£é‡Š CI / DI çš„é™·é˜±ï¼Œæˆ‘ä»¬å°†ç”¨æœ€é‡è¦çš„ä¸œè¥¿æ¥è§£é‡Šï¼šäººï¼</p>
<h2 id="å…³äºäººçš„æ•…äº‹-â€”-è½¯ä»¶é›†æˆçš„é»‘æš—æ—¶ä»£"><a href="#å…³äºäººçš„æ•…äº‹-â€”-è½¯ä»¶é›†æˆçš„é»‘æš—æ—¶ä»£" class="headerlink" title="å…³äºäººçš„æ•…äº‹ â€” è½¯ä»¶é›†æˆçš„é»‘æš—æ—¶ä»£"></a>å…³äºäººçš„æ•…äº‹ â€” è½¯ä»¶é›†æˆçš„é»‘æš—æ—¶ä»£</h2><p>Alice, Bob, Charlie, David, å’Œ Elizabethï¼Œä»–ä»¬éƒ½åœ¨ <code>SoftwareCo</code> å…¬å¸ã€‚å¼€å‘ <code>SuperBigProject</code> åº”ç”¨ã€‚Alice, Bob, å’Œ Charlie æ˜¯å¼€å‘è€…ã€‚David æ˜¯ä¸€ä¸ªæµ‹è¯•å·¥ç¨‹å¸ˆã€‚Elizabeth æ˜¯å›¢é˜Ÿçš„é¡¹ç›®ç»ç†ã€‚</p>
<p>å¼€å‘åº”ç”¨çš„ä¼ ç»Ÿæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p>Alice, Bob, å’Œ Charlie åœ¨å®ƒä»¬å„è‡ªçš„å·¥ä½œåŒºï¼Œå·¥ä½œåœ¨3ä¸ªä¸åŒçš„ featureã€‚æ¯ä¸ªå¼€å‘äººå‘˜éƒ½ä»¥å„è‡ªçš„æ–¹æ³•ç¼–å†™å’Œæµ‹è¯•ä»£ç ã€‚ä»–ä»¬ä½¿ç”¨ä¸€ä¸ªé•¿å‘¨æœŸçš„ feature åˆ†æ”¯ï¼Œåœ¨å®ƒä»¬åˆå¹¶è¿›ç”Ÿäº§ä¹‹å‰å¯èƒ½å­˜åœ¨å‡ å‘¨æˆ–è€…ç”šè‡³å‡ ä¸ªæœˆã€‚</p>
<div style="text-align: center;"><br>    <image src="https://cdn.thenewstack.io/media/2018/08/8b059cb3-codefresh1.png" width="600px"><br></image></div>

<p>åœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼ŒElizabethï¼ˆPMï¼‰å¬é›†æ•´ä¸ªå›¢é˜Ÿï¼Œå¹¶å®£å¸ƒï¼šâ€œå„ä½ï¼Œæˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä¸ª Releaseâ€ã€‚</p>
<p>æ­¤æ—¶ï¼ŒAlice, Bob, å’Œ Charlie äº‰å…ˆæååœ°é›†æˆæ‰€æœ‰3ä¸ª feature åˆ†æ”¯åˆ°åŒä¸€ä¸ªåˆ†æ”¯ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸ç´§å¼ çš„æ—¶åˆ»ï¼Œå› ä¸ºè¿™äº›åˆ†æ”¯ä¹‹å‰å¹¶æ²¡æœ‰åˆå¹¶ä¸€èµ·è¿›è¡Œæµ‹è¯•è¿‡ã€‚ç”±äºé”™è¯¯çš„å‡è®¾æˆ–è€…ç¯å¢ƒåŸå› ï¼Œä¼šå‡ºç°å¾ˆå¤šbugå’Œé—®é¢˜ï¼ˆè¯·è®°ä½ï¼Œç›®å‰ä¸ºæ­¢ï¼Œæ‰€æœ‰ feature ä»…ä»…åœ¨å„è‡ªçš„å·¥ä½œç«™ä¸­è¿›è¡Œè¿‡æµ‹è¯•ï¼Œå½¼æ­¤æ˜¯éš”ç¦»çš„ï¼‰ã€‚</p>
<p>ä¸€æ—¦è¿™ä¸ªé«˜åº¦ç´§å¼ çš„æ—¶æœŸç»“æŸäº†ï¼Œåˆå¹¶çš„ç»“æœå°†ä¼ é€’ç»™å°†æ‰§è¡Œé¢å¤–çš„æ‰‹åŠ¨å’Œè‡ªåŠ¨æµ‹è¯•çš„ Davidï¼Œæ­¤æœŸé—´ä¹Ÿå¾ˆè€—æ—¶, å› ä¸ºä»–æ˜¯å¯ä»¥æ ¹æ®å‘ç°çš„å†³å®šæ€§ bug çš„æ•°é‡æ¥æ‰¹å‡†æˆ–é˜»æ­¢å‘å¸ƒçš„äººã€‚å½“ä»–æµ‹è¯•æ—¶, æ‰€æœ‰çš„ç›®å…‰éƒ½è½åœ¨äº†å¤§å«èº«ä¸Š, å› ä¸ºä»–çš„æµ‹è¯•å¯ä»¥æš´éœ²å‡ºä¸¥é‡çš„é—®é¢˜, ä¼šå¯¼è‡´ Release çš„ delayã€‚</p>
<p>æœ€åï¼Œæµ‹è¯•ç»“æŸäº†ï¼ŒElizabeth é«˜å…´åœ°å®£å¸ƒï¼Œè¯¥ç‰ˆæœ¬å·²ç»æ‰“åŒ…å¥½ï¼Œå¹¶è¿å¾€å®¢æˆ·ã€‚</p>
<p>é‚£ä¹ˆï¼Œäººä»¬é¢å¯¹è¿™ä¸ªè™šæ„çš„ï¼ˆåˆéå¸¸ç°å®ï¼‰çš„æ•…äº‹æ˜¯ä»€ä¹ˆæ„Ÿå—å‘¢ï¼Ÿ</p>
<ol>
<li>Alice, Bob, å’Œ Charlieï¼ˆå¼€å‘ï¼‰éƒ½ä¸é«˜å…´ï¼Œå› ä¸ºä»–ä»¬æ€»æ˜¯åœ¨å‘å¸ƒå³å°†å‘ç”Ÿä¹‹å‰äº†è§£é›†æˆé—®é¢˜ã€‚é›†æˆæœŸæ„Ÿè§‰å°±åƒäº¤ç«, åŒä¸€æ—¶åˆ»å‡ºç°å¾ˆå¤šé—®é¢˜ã€‚</li>
<li>Davidï¼ˆæµ‹è¯•ï¼‰ä¹Ÿä¸é«˜å…´ï¼Œå› ä¸ºä»–çš„å·¥ä½œå®åœ¨ä¸å¹³è¡¡ã€‚å½“ä»–åœ¨ç­‰å¾…å¼€å‘åœ¨ feature å®Œæˆå®ƒä»¬çš„å·¥ä½œçš„æ—¶å€™æ˜¯å’Œå¹³æ—¶æœŸã€‚ç„¶ååœ¨æµ‹è¯•é˜¶æ®µä»–é™·äºæµ‹è¯•å·¥ä½œä¸­ï¼Œéœ€è¦å¤„ç†æ„æƒ³ä¸åˆ°çš„æµ‹è¯•åœºæ™¯ï¼Œå¹¶ä¸”æ¯ä¸ªäººéƒ½ç«™åœ¨ä»–çš„è‚©æ—ä¸Šçœ‹ä»–ã€‚</li>
<li>Elizabethï¼ˆç®¡ç†äººå‘˜ï¼‰ä¹Ÿä¸é«˜å…´ã€‚é›†æˆé˜¶æ®µæ˜¯é¡¹ç›®çš„å…³é”®è·¯å¾„ã€‚è¿™æ˜¯ä¸€ä¸ªç´§å¼ çš„æ—¶æœŸ, ä»»ä½•æ„æƒ³ä¸åˆ°çš„é—®é¢˜,éƒ½ä¼šé˜»ç¢æ¨åŠ¨äº§å“çš„è¿›ä¸€æ­¥äº¤ä»˜ã€‚Elizabeth ä¸€ç›´æ¢¦æƒ³è½¯ä»¶å‘å¸ƒæ²¡æœ‰ä»»ä½•æ„å¤–æƒ…å†µ, ä½†è¿™åœ¨ç°å®ä¸­ä»æ¥ä¸ä¼šå‘ç”Ÿã€‚é¡¹ç›®æ—¶é—´çº¿ä¸­çš„é›†æˆé˜¶æ®µæ€»å˜æˆä¸€ä¸ªçŒœè°œæ¸¸æˆã€‚</li>
</ol>
<p>å›¢é˜Ÿçš„æ¯ä¸ªäººéƒ½ä¸é«˜å…´ï¼ˆé¡ºä¾¿ä¸€æï¼Œå¦‚æœä½ çš„å…¬å¸ä»ç„¶åœ¨è¿™æ ·å¼€å‘è½¯ä»¶ï¼Œè¯·å°è¯•äº†è§£è¿™ç§å¼€å‘å·¥ä½œæµå¯¹å›¢é˜Ÿçš„å£«æ°”é€ æˆçš„æŸå®³ï¼‰ã€‚</p>
<p>è¿™é‡Œçš„ä¸»è¦é—®é¢˜æ˜¯<strong>å•ä¸€</strong>çš„â€œé›†æˆâ€é˜¶æ®µå‘ç”Ÿåœ¨æ¯ä¸ªäº§å“å‘å¸ƒã€‚è¿™æ˜¯å·¥ä½œæµçš„éš¾ç‚¹ï¼Œå®ƒé˜»ç¢äº†å›¢é˜Ÿè¿›è¡Œæ— å‹åŠ›å‘å¸ƒè¿‡ç¨‹ã€‚</p>
<h2 id="åœ¨é›†æˆä¸­å¢åŠ â€œæŒç»­â€"><a href="#åœ¨é›†æˆä¸­å¢åŠ â€œæŒç»­â€" class="headerlink" title="åœ¨é›†æˆä¸­å¢åŠ â€œæŒç»­â€"></a>åœ¨é›†æˆä¸­å¢åŠ â€œæŒç»­â€</h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»çŸ¥é“äº†ä»€ä¹ˆæ˜¯â€œé›†æˆâ€ï¼Œå¾ˆå®¹æ˜“ç†è§£â€œæŒç»­é›†æˆâ€çš„éœ€è¦ä¹‹å¤„ã€‚ä¿—è¯è¯´ï¼Œâ€œ<a href="https://martinfowler.com/bliki/FrequencyReducesDifficulty.html" target="_blank" rel="noopener">å¦‚æœæŸäº‹æ˜¯ç—›è‹¦çš„ï¼Œé‚£å°±å¤šåšå®ƒ</a>â€ã€‚æŒç»­é›†æˆå®è´¨ä¸Šæ˜¯é€šè¿‡é«˜é¢‘ç‡çš„é‡å¤é›†æˆæ­¥éª¤å‡è½»å®ƒçš„ç—›è‹¦ã€‚æœ€æ˜¾è€Œæ˜“è§çš„æ–¹æ³•å°±æ˜¯åœ¨æ¯æ¬¡ feature åˆå¹¶åè¿›è¡Œé›†æˆï¼ˆè€Œä¸æ˜¯åœ¨å®£å¸ƒæ­£å¼ release ä¹‹å‰ç­‰å¾…ï¼‰ã€‚</p>
<div style="text-align: center;"><br>    <image src="https://cdn.thenewstack.io/media/2018/08/cdc82f2b-codefresh2.png" width="600px"><br></image></div>

<p>å½“ä¸€ä¸ªå›¢é˜Ÿå®è·µæŒç»­é›†æˆâ€¦</p>
<ol>
<li>æ‰€æœ‰ feature åˆ†æ”¯éƒ½ç›´æ¥åˆå¹¶åˆ°ä¸»åˆ†æ”¯ï¼ˆä¸»çº¿ï¼‰ä¸­ã€‚</li>
<li>å¼€å‘äººå‘˜ä¸æ˜¯å­¤ç«‹å·¥ä½œçš„ã€‚æ‰€æœ‰ feature éƒ½æ˜¯ä»ä¸»çº¿å¼€å§‹å¼€å‘çš„ã€‚</li>
<li>å¦‚æœä¸»çº¿æ˜¯å¥åº·çš„ï¼Œè€Œä¸æ˜¯åœ¨å®ƒå•ç‹¬çš„å·¥ä½œç«™ä¸Šå·¥ä½œï¼Œåˆ™ä¸€é¡¹ feature è¢«è§†ä¸ºå·²å®Œæˆã€‚</li>
<li>æµ‹è¯•åœ¨ feature çº§åˆ«å’Œä¸»çº¿çº§åˆ«éƒ½ä¼šè¢«è§¦å‘ã€‚</li>
</ol>
<p>è¿™äº›æ˜¯æŒç»­é›†æˆçš„è¦ç‚¹ï¼å½“ç„¶ï¼Œè¿˜æœ‰æ›´å¤šçš„ç»†èŠ‚ï¼ˆå®é™…ä¸Šå…³äºè¿™ä¸ªä¸»é¢˜æœ‰ä¸€æœ¬<a href="https://martinfowler.com/books/duvall.html" target="_blank" rel="noopener">å®Œæ•´çš„ä¹¦ç±</a>ï¼‰ã€‚ä½†æ˜¯é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œæ‰€æœ‰åˆå¹¶å’Œæµ‹è¯•å¹¶ä¸æ˜¯åœ¨ä¸€ä¸ªå•ä¸€çš„æœ‰å‹åŠ›çš„é›†æˆæ—¶åˆ»ï¼Œé›†æˆä¸€ç›´åœ¨è¿ç»­çš„æ—¶åˆ»å‘ç”Ÿã€‚</p>
<p>æŒç»­é›†æˆæ˜¯å¼€å‘è½¯ä»¶çš„ä¸€ç§æ›´å¥½çš„æ–¹æ³•ï¼ˆç›¸æ¯”äºâ€œç®€å•â€é›†æˆï¼‰ï¼Œå› ä¸ºå®ƒï¼š</p>
<ol>
<li>å‡å°‘åœ¨åˆå¹¶ feature æ—¶å‡ºç°çš„æ„å¤–æ¬¡æ•°ã€‚</li>
<li>è§£å†³â€œåœ¨æˆ‘çš„æœºå­ä¸Šæ²¡é—®é¢˜â€çš„é—®é¢˜</li>
<li>å°†æµ‹è¯•å‘¨æœŸåˆ‡ç‰‡åˆ°æ¯ä¸ª feature é€æ¸åˆå¹¶åˆ°ä¸»çº¿ä¸­çš„é˜¶æ®µï¼ˆè€Œä¸æ˜¯ä¸€æ¬¡æ€§çš„ï¼‰ã€‚</li>
</ol>
<p>å…¶ç»“æœå°±æ˜¯ï¼Œä¸€ä¸ªä½¿ç”¨ CI çš„å›¢é˜Ÿä¸æ˜¯ç”Ÿæ´»åœ¨è¿‡å±±è½¦ä¸Š (åœ¨å¼€å‘æ—¶æœŸå¾ˆå¹³é™ï¼Œä¼´éšç€çš„æ˜¯æœ‰å‹åŠ›çš„ release)ï¼Œè€Œæ˜¯å¯ä»¥åœ¨å¦‚ä½•æ¥è¿‘å®Œæˆé¡¹ç›®çš„æ¸è¿›æ–¹å¼ä¸­å¾—åˆ°æ›´å¥½çš„å¯è§æ€§ã€‚</p>
<p>åˆ©ç”¨ CI å·¥ä½œæ˜¯ç°ä»£è½¯ä»¶å¼€å‘çš„æ”¯æŸ±ä¹‹ä¸€ã€‚è¿™ä¸€ç‚¹ä¸Šï¼Œè¯¥æŠ€æœ¯è¢«éå¸¸å¥½çš„è®°å½•å’ŒçŸ¥æ™“ã€‚å¦‚æœç°åœ¨ä½ ä»¬çš„è½¯ä»¶é¡¹ç›®ä¸­è¿˜æ²¡æœ‰å®è·µ CIï¼Œä½ çš„ç»„ç»‡æ²¡æœ‰ä»»ä½•å€Ÿå£ä¸å»å®è·µå®ƒã€‚</p>
<h2 id="è½¯ä»¶äº¤ä»˜çš„é»‘æš—æ—¶ä»£"><a href="#è½¯ä»¶äº¤ä»˜çš„é»‘æš—æ—¶ä»£" class="headerlink" title="è½¯ä»¶äº¤ä»˜çš„é»‘æš—æ—¶ä»£"></a>è½¯ä»¶äº¤ä»˜çš„é»‘æš—æ—¶ä»£</h2><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº† â€œé›†æˆâ€ çš„å†å²ï¼Œä»¥åŠæŒç»­é›†æˆçš„å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒå¸¦åˆ°ä¸€ä¸ªä¸‹ä¸€çº§ï¼ŒæŒç»­äº¤ä»˜ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å›åˆ°åŸæ¥çš„æ•…äº‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç±»ä¼¼æ¨¡å¼çš„å‘å¸ƒæ–¹å¼æ­£åœ¨å‘ç”Ÿï¼š</p>
<div style="text-align: center;"><br>    <image src="https://cdn.thenewstack.io/media/2018/08/8d8eb43f-codefresh3.png" width="600px"><br></image></div>

<p>æ‰§è¡Œ Release å‘å¸ƒå®è´¨ä¸Šæ˜¯ä¸€ä¸ªâ€œå¤§çˆ†ç‚¸â€äº‹ä»¶ã€‚åœ¨è½¯ä»¶è¢«è®¤ä¸ºå·²ç»æµ‹è¯•è¿‡ï¼Œæœ‰äººä¼šè´Ÿè´£åŒ…è£…å’Œéƒ¨ç½²çš„è¿‡ç¨‹ã€‚éƒ¨ç½²è½¯ä»¶åˆ°ç”Ÿäº§ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸æœ‰å‹åŠ›çš„é˜¶æ®µï¼Œä¼ ç»Ÿæ¥è¯´ä¼šæ¶‰åŠåˆ°å¾ˆå¤šæ‰‹åŠ¨çš„æ­¥éª¤ï¼ˆå’Œ checklistsï¼‰ã€‚éƒ¨ç½²å¯èƒ½æ˜¯å¾ˆå°‘æ¬¡çš„ï¼ˆæœ‰çš„å…¬å¸æ¯å…­ä¸ªæœˆæ‰ä¼šéƒ¨ç½²ä¸€æ¬¡ï¼‰ã€‚åœ¨æç«¯æƒ…å†µä¸‹ï¼Œéƒ¨ç½²å¯èƒ½åªå‘ç”Ÿä¸€æ¬¡ï¼ˆç€‘å¸ƒæµè®¾è®¡æ–¹æ³•ï¼‰ã€‚</p>
<p>åªæœ‰åˆ° deadline æ—¶æ‰äº¤ä»˜è½¯ä»¶ï¼Œè¿™ä¼šå‡ºç°ä¸ä¸é¢‘ç¹é›†æˆä¸€æ ·çš„æŒ‘æˆ˜ï¼š</p>
<ol>
<li>é€šå¸¸å‘ç°ç”Ÿäº§ç¯å¢ƒä¸éœ€è¦åœ¨æœ€åä¸€åˆ»è¿›è¡Œé¢å¤–é…ç½®çš„æµ‹è¯•ç¯å¢ƒä¸åŒã€‚</li>
<li>åœ¨æµ‹è¯•ç¯å¢ƒä¸­å·¥ä½œæ­£å¸¸çš„åŠŸèƒ½åœ¨ç”Ÿäº§ä¸­è¢«å‘ç°é—®é¢˜ã€‚</li>
<li>åœ¨å‘å¸ƒæ—¶è¿˜æ²¡æœ‰å‡†å¤‡å°±ç»ªçš„åŠŸèƒ½ï¼Œæˆ–è€…æ ¹æœ¬å°±ä¸ä¼šäº¤ä»˜ç»™å®¢æˆ·ï¼Œæˆ–è€…ä»–ä»¬è¿›ä¸€æ­¥æ¨è¿Ÿå‘å¸ƒæ—¥æœŸã€‚</li>
<li>å‘å¸ƒå¯¼è‡´å¼€å‘äººå‘˜ï¼ˆæƒ³è¦å‘å¸ƒæ–°åŠŸèƒ½ï¼‰å’Œè¿è¥ï¼ˆæƒ³è¦ç¨³å®šï¼Œä¸æƒ³ä¸€æ¬¡éƒ¨ç½²å¤ªå¤šçš„æ–°åŠŸèƒ½ï¼‰ä¹‹é—´çš„å…³ç³»å˜å¾—ç´§å¼ ã€‚</li>
</ol>
<p>ä½ åº”è¯¥èƒ½ç†è§£è¿™é‡Œçš„æ¨¡å¼ã€‚å¦‚æœæˆ‘ä»¬é€šè¿‡æ›´é¢‘ç¹åœ°æ¥ç¼“è§£â€œé›†æˆâ€é˜¶æ®µçš„ç—›è‹¦ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ºâ€œäº¤ä»˜â€é˜¶æ®µåšåŒæ ·çš„äº‹æƒ…ã€‚</p>
<h2 id="åœ¨äº¤ä»˜ä¸­å¢åŠ â€œæŒç»­â€"><a href="#åœ¨äº¤ä»˜ä¸­å¢åŠ â€œæŒç»­â€" class="headerlink" title="åœ¨äº¤ä»˜ä¸­å¢åŠ â€œæŒç»­â€"></a>åœ¨äº¤ä»˜ä¸­å¢åŠ â€œæŒç»­â€</h2><p>æŒç»­äº¤ä»˜æ˜¯å°½å¯èƒ½é¢‘ç¹åœ°ç»„è£…å’Œå‡†å¤‡è½¯ä»¶ï¼ˆå°±åƒå®ƒä¼šè¢«å‘å¸ƒåˆ°ç”Ÿäº§é‚£æ ·ï¼‰çš„å®è·µã€‚æœ€æç«¯çš„äº¤ä»˜æ–¹å¼æ˜¯åœ¨æ¯ä¸ª feature åˆå¹¶ä¹‹åã€‚</p>
<div style="text-align: center;"><br>    <image src="https://cdn.thenewstack.io/media/2018/08/3219a4ee-codefresh4.png" width="600px"><br></image></div>

<p>å› æ­¤ï¼ŒCDï¼Œè®© CI èµ°å¾—æ›´è¿œä¸€æ­¥ã€‚åœ¨æ¯ä¸ª feature åˆå¹¶åˆ°ä¸»çº¿ä¸­ï¼Œè½¯ä»¶ä¸ä»…è¦æµ‹è¯•æ­£ç¡®æ€§ï¼Œè€Œä¸”ä¹Ÿè¦åŒ…è£…å’Œéƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒï¼ˆæ¯”è¾ƒç†æƒ³åœ°ç¬¦åˆç”Ÿäº§ç¯å¢ƒï¼‰ã€‚æ‰€æœ‰è¿™ä¸€åˆ‡éƒ½æ˜¯ä»¥å®Œå…¨è‡ªåŠ¨åŒ–çš„æ–¹å¼ã€‚æ³¨æ„ï¼Œä¸Šå›¾ä¸­ç¼ºå°‘çš„è‰å›¾ (è¡¨ç¤ºæ‰‹åŠ¨æ­¥éª¤)ã€‚</p>
<p>è¿˜è¦æ³¨æ„ï¼Œæ¯ä¸ª feature éƒ½æ˜¯æ¨é€åˆ°ç”Ÿäº§çš„æ½œåœ¨<strong>å€™é€‰è€…</strong>ã€‚ä¸æ˜¯æ‰€æœ‰å€™é€‰äººéƒ½ä¼šè¢«å‘é€åˆ°ç”Ÿäº§ã€‚æ ¹æ®ç»„ç»‡ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§çš„å†³å®šéœ€è¦äººå·¥å¹²é¢„ï¼Œäººç±»åªå†³å®šä¸€ä¸ª release æ˜¯å¦åº”è¯¥å‘é€åˆ°ç”Ÿäº§ï¼ˆä½†ä¸ä¼šå‡†å¤‡è¿™ä¸ª release æœ¬èº«ï¼‰ã€‚è¿™ä¸ª release åœ¨æµ‹è¯•ç¯å¢ƒå·²ç»è¢«æ‰“åŒ…ï¼Œæµ‹è¯•å’Œéƒ¨ç½²ã€‚</p>
<p>æŒç»­äº¤ä»˜æ¯”æŒç»­é›†æˆæ›´éš¾é‡‡ç”¨ã€‚å…¶åŸå› æ˜¯å› ä¸ºæ¯ä¸ªå‘å¸ƒå€™é€‰è€…éƒ½æœ‰å¯èƒ½è¾¾åˆ°ç”Ÿäº§ï¼Œå› æ­¤éœ€è¦è‡ªåŠ¨åŒ–æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼š</p>
<ol>
<li>æ„å»ºåº”è¯¥æ˜¯å¯é‡å¤æ€§å’Œç¡®å®šæ€§çš„ã€‚</li>
<li>æ‰€æœ‰ release æ­¥éª¤åº”è¯¥éƒ½æ˜¯è‡ªåŠ¨åŒ–çš„ï¼ˆå®ƒæ¯”å¬èµ·æ¥æ›´éš¾ï¼‰ã€‚</li>
<li>æ‰€æœ‰çš„é…ç½®å’Œå…³è”çš„æ–‡ä»¶éƒ½åº”è¯¥å­˜åœ¨äºä»£ç æ§åˆ¶ä¸­ (è€Œä¸ä»…ä»…æ˜¯æºä»£ç )ã€‚</li>
<li>æ¯ä¸ª feature / release éƒ½åº”è¯¥åœ¨å®ƒçš„æµ‹è¯•ç¯å¢ƒä¸­è¢«æµ‹è¯•è¿‡ï¼ˆä»¥åŠ¨æ€æ–¹å¼åˆ›å»ºå’Œé”€æ¯çš„ç†æƒ³æ–¹æ³•ï¼‰ã€‚</li>
<li>æ‰€æœ‰æµ‹è¯•å¥—ä»¶éƒ½åº”è‡ªåŠ¨åŒ–ä¸”ç›¸å¯¹å¿«é€Ÿï¼ˆå®ƒä¹Ÿæ˜¯æ¯”å¬èµ·æ¥æ›´éš¾ï¼‰ã€‚</li>
</ol>
<p>è™½ç„¶äº‘å½“ç„¶å¯ä»¥å¸®åŠ©æ»¡è¶³æ‰€æœ‰è¿™äº›è¦æ±‚ï¼Œä½†åœ¨è½¯ä»¶å›¢é˜Ÿ (å¼€å‘äººå‘˜å’Œè¿è¥éƒ¨é—¨) ä¸­éœ€è¦ä¸€å®šç¨‹åº¦çš„çºªå¾‹ï¼Œä»¥ä¾¿çœŸæ­£æ‹¥æŠ±æŒç»­äº¤ä»˜ã€‚</p>
<p>ä¸€æ—¦ CD è½åœ°ï¼Œå‘å¸ƒä¼šå˜å¾—å¾®ä¸è¶³é“ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥æŒ‰ä¸ªæŒ‰é’®å°±èƒ½æ‰§è¡Œã€‚æ¯ä¸ªäººï¼ˆä¸ä»…ä»…æ˜¯é¡¹ç›®ç»ç†ï¼‰éƒ½å…·æœ‰ release candidate <em>ï¼ˆè¯‘è€…ï¼šrelease å€™é€‰ç‰ˆæœ¬ï¼Œä»¥ä¸‹å¯¹æ­¤æœ¯è¯­ä¸åšç¿»è¯‘ï¼‰</em>çš„å¯è§æ€§ã€‚å½“å‰çš„ release candidate å¯èƒ½æ²¡æœ‰æ‰€æœ‰è¯·æ±‚çš„åŠŸèƒ½ï¼Œæˆ–è€…è¯´å®ƒå¯èƒ½æ— æ³•æ»¡è¶³æ‰€æœ‰çš„è¦æ±‚ï¼Œä½†æ˜¯è¿™å¯¹äºå‘å¸ƒè¿‡ç¨‹æ¥è¯´å¹¶ä¸é‡è¦ã€‚é‡è¦çš„å…¶å®æ˜¯è¿™ä¸ª release æ˜¯å®Œæ•´æµ‹è¯•å’Œæ‰“åŒ…çš„ï¼Œå‡†å¤‡å°±ç»ªå‘é€åˆ°ç”Ÿäº§ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚ä»»ä½•é¡¹ç›®çš„ç›¸å…³äººå‘˜å¯ä»¥ç»™å‡ºç»¿ç¯å¹¶ç«‹å³æŠŠ release éƒ¨ç½²åˆ°ç”Ÿäº§ã€‚</p>
<p>å¦‚æœä½ ä½¿ç”¨ CDï¼Œåˆ™è½¯ä»¶çš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥æ¦‚æ‹¬æˆå¦‚ä¸‹ï¼š</p>
<div style="text-align: center;"><br>    <image src="https://cdn.thenewstack.io/media/2018/08/077b76c5-codefresh5.png" width="600px"><br></image></div>

<p>æ¯ä¸ª release candidate éƒ½æ˜¯é¢„å…ˆé¢„å¤‡å¥½çš„ã€‚ä¸€ä¸ªäººå†³å®šæ˜¯å¦ä¸€ä¸ª release candidate ç‰ˆæœ¬æ˜¯å¦æ¨é€åˆ°ç”Ÿäº§ã€‚æ²¡æœ‰æ¨é€åˆ°ç”Ÿäº§çš„ Release Candidate ä»ç„¶ä¼šä½œä¸ºä¸€ä¸ª artifact å‚¨å­˜èµ·æ¥ï¼Œå¦‚æœå°†æ¥æœ‰éœ€è¦å¯ä»¥è¿›è¡Œå¬å›ã€‚</p>
<p>å°±åƒæŒç»­é›†æˆä¸€æ ·ï¼Œå¦‚æœä½ æƒ³çŸ¥é“æ›´å¤šçš„ç»†èŠ‚ï¼Œè¿™é‡Œæœ‰<a href="https://martinfowler.com/books/continuousDelivery.html" target="_blank" rel="noopener">æ•´æœ¬å›´ç»•æŒç»­äº¤ä»˜çš„ä¹¦ç±</a>ã€‚</p>
<h2 id="é¢å¤–å¥–åŠ±ï¼šæŒç»­éƒ¨ç½²"><a href="#é¢å¤–å¥–åŠ±ï¼šæŒç»­éƒ¨ç½²" class="headerlink" title="é¢å¤–å¥–åŠ±ï¼šæŒç»­éƒ¨ç½²"></a>é¢å¤–å¥–åŠ±ï¼šæŒç»­éƒ¨ç½²</h2><p>CD ä¸­çš„ â€œDâ€ ä¹Ÿå¯ä»¥è¡¨ç¤ºéƒ¨ç½²ï¼ˆDeploymentï¼‰ã€‚è¿™ç§å¼€å‘æ–¹æ³•å»ºç«‹åœ¨æŒç»­äº¤ä»˜ä¸Š, åŸºæœ¬ä¸Šå®Œå…¨æ¶ˆé™¤äº†æ‰€æœ‰äººç±»å¹²é¢„ã€‚ä»»ä½•è¢«å‘ç°å‡†å¤‡å°±ç»ªçš„ release candidate ï¼ˆå¹¶ä¸”é€šè¿‡æ‰€æœ‰è´¨é‡æµ‹è¯•ï¼‰éƒ½ä¼š<em>ç«‹å³</em>æ¨é€åˆ°ç”Ÿäº§ã€‚</p>
<div style="text-align: center;"><br>    <image src="https://cdn.thenewstack.io/media/2018/08/cd81028d-codefresh6.png" width="600px"><br></image></div>

<p>ä¸å¯å¦è®¤çš„æ˜¯ï¼Œåªæœ‰æå°‘æ•°çš„å…¬å¸å¯ä»¥è¿™æ ·åšã€‚æ²¡æœ‰äººç±»å¹²é¢„ç›´æ¥æ¨é€åˆ°ç”Ÿäº§åº”è¯¥ä¸èƒ½æ‰ä»¥è½»å¿ƒã€‚åœ¨æ’°å†™è¿™ç¯‡æ–‡ç« æ—¶ï¼Œè®¸å¤šå…¬å¸ç”šè‡³éƒ½æ²¡æœ‰å®è·µæŒç»­äº¤ä»˜ï¼Œæ›´åˆ«è¯´éƒ¨ç½²äº†ã€‚ç°åœ¨åº”è¯¥æ¸…æ¥šçš„æ˜¯ï¼Œæ¯ç§å¼€å‘æ–¹æ³•éƒ½éœ€è¦å»ºç«‹åœ¨ä¹‹å‰é‚£äº›åŸºç¡€ä¹‹ä¸Šã€‚</p>
<div style="text-align: center;"><br>    <image src="https://cdn.thenewstack.io/media/2018/08/9b53d1f0-codefresh7.png" width="600px"><br></image></div>

<p>åœ¨å‘ä¸Šç§»åŠ¨ä¹‹å‰ï¼ˆè¯‘è€…ï¼šæŒ‰ä¸Šå›¾å‘ä¸Šç§»åŠ¨ï¼‰ï¼Œä½ çš„ç»„ç»‡åº”è¯¥ç¡®ä¿æ¯ä¸ªåŸºç¡€éƒ½æ˜¯çœŸæ­£ç¨³å›ºçš„ã€‚åœ¨ Codefreshï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¾ˆå¤šå…¬å¸è¯•å›¾è¿›å…¥äº‘æ—¶ä»£ï¼Œåœ¨ä»–ä»¬æ²¡æœ‰çœŸæ­£çš„ç†è§£ CI/CD ç®¡é“æ—¶è¯•å›¾ç¡¬å¡è¿›ç°æœ‰çš„åšæ³•ï¼ˆä¸ºæ•°æ®ä¸­å¿ƒè¿›è¡Œä¼˜åŒ–ï¼‰ï¼Œå¹¶ä¸”å…¶ä¸­ä¸€äº›åšæ³•ç°åœ¨å·²ç»è¿‡æ—¶ã€‚å°è¯•é‡‡ç”¨æŒç»­éƒ¨ç½²è€Œä¸å®Œå…¨æ‹¥æŠ±æŒç»­äº¤ä»˜æ˜¯ä¸€åœºå¤±è´¥çš„æˆ˜å½¹ã€‚</p>
<p>å¦ä¸€ç§æ–¹æ³•æ˜¯æŸ¥çœ‹è¿™äº›æ–¹æ³•æ¶µç›–çš„å†…å®¹ä»¥åŠ CD éœ€è¦ CI çš„æ–¹å¼,ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<div style="text-align: center;"><br>    <image src="https://cdn.thenewstack.io/media/2018/08/f600b7cb-codefresh8.png" width="600px"><br></image></div>

<p>è¯·ç¡®ä¿ä»¥æ­£ç¡®çš„é¡ºåºå¤„ç†æ¯ä¸ªå¼€å‘æ¨¡å¼ã€‚é’ˆå¯¹æŒç»­äº¤ä»˜æ˜¯ä¸€ä¸ªæ›´ç°å®çš„ç›®æ ‡ï¼Œå¯é€‰çš„å·¥å…·ä¹Ÿå¾ˆä¸°å¯Œã€‚</p>
]]></content>
      
        <categories>
            
            <category> ci </category>
            
            <category> cd </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CI </tag>
            
            <tag> æŒç»­é›†æˆ </tag>
            
            <tag> Continuous Integration </tag>
            
            <tag> CD </tag>
            
            <tag> Continuous Delivery </tag>
            
            <tag> æŒç»­äº¤ä»˜ </tag>
            
            <tag> Continuous Deployment </tag>
            
            <tag> æŒç»­éƒ¨ç½² </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android POJO è½¬æ¢å™¨ â€”> RapidOOO]]></title>
      <url>/2018/04/16/rapidooo-android-pojo-converter/</url>
      <content type="html"><![CDATA[<h1 id="RapidOOO"><a href="#RapidOOO" class="headerlink" title="RapidOOO"></a>RapidOOO</h1><p>Android POJO è½¬æ¢å™¨:æ ¹æ® POJO ç±»ç¼–è¯‘æ—¶è‡ªåŠ¨ç”Ÿæˆæ”¯æŒæ‰©å±•äº’ç›¸ç»‘å®šçš„é¢†åŸŸå¯¹è±¡ã€‚</p>
<p><a href="https://github.com/wangjiegulu/RapidOOO/blob/master/README_zh.md" target="_blank" rel="noopener">English Version</a></p>
<p><strong>Github:</strong> <a href="https://github.com/wangjiegulu/RapidOOO" target="_blank" rel="noopener">https://github.com/wangjiegulu/RapidOOO</a></p>
<h2 id="ä¸ºä»€ä¹ˆä½¿ç”¨-RapidOOOï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨-RapidOOOï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨ RapidOOOï¼Ÿ"></a>ä¸ºä»€ä¹ˆä½¿ç”¨ RapidOOOï¼Ÿ</h2><p>æˆ‘ä»¬åœ¨é¢†åŸŸé©±åŠ¨è®¾è®¡ä¸­ç»å¸¸ä¼šåœ¨ä¸åŒå±‚çº§ä¹‹é—´ä¼ é€’æ•°æ®ï¼Œä¾‹å¦‚ <code>VO</code>, <code>PO</code>, <code>DO</code>, <code>DTO</code>, <code>BO</code>ç­‰ã€‚Android çš„å¼€å‘ä¸­ä¹Ÿç»å¸¸ä¼šé‡åˆ°è¿™äº›æƒ…å†µï¼Œæ¯”å¦‚åœ¨ <a href="https://github.com/android10/Android-CleanArchitecture" target="_blank" rel="noopener">Android-CleanArchitecture</a> çš„ <a href="https://github.com/android10/Android-CleanArchitecture/blob/master/presentation/src/main/java/com/fernandocejas/android10/sample/presentation/mapper/UserModelDataMapper.java#L42" target="_blank" rel="noopener">UserModelDataMapper::transform</a>, <a href="https://github.com/android10/Android-CleanArchitecture/blob/master/data/src/main/java/com/fernandocejas/android10/sample/data/entity/mapper/UserEntityDataMapper.java#L42" target="_blank" rel="noopener">UserEntityDataMapper::transform</a> ç­‰ã€‚æ‰‹å·¥åœ°è¿›è¡Œæ‹·è´è½¬æ¢çš„è¿‡ç¨‹ä¸ä½†ç¹çï¼Œè€Œä¸”é”™è¯¯çš„é£é™©æ¯”è¾ƒå¤§ï¼Œåœ¨æ–°å¢ã€åˆ é™¤å­—æ®µæ—¶ä¹Ÿå¢åŠ äº†ç»´æŠ¤çš„æˆæœ¬ã€‚<a href="http://dozer.sourceforge.net/documentation/about.html" target="_blank" rel="noopener">Dozer</a> å¯ä»¥å¾ˆå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯åœ¨ Android ä¸Šå¯èƒ½å°±ä¸å¤ªé€‚ç”¨äº†ã€‚</p>
<p><strong>RapidOOO å¯ä»¥åšåˆ°:</strong></p>
<ol>
<li>åœ¨ç¼–è¯‘æ—¶é’ˆå¯¹æŒ‡å®šçš„åˆå§‹ POJOï¼Œå¯ä»¥è‡ªåŠ¨ç”Ÿæˆ Java ç±»ï¼ˆæ¯”å¦‚ <code>UserVO</code>, <code>UserBO</code> ç­‰ï¼‰ï¼Œéåå°„ã€‚</li>
<li>å¯ä»¥åœ¨ç”Ÿæˆçš„ POJO ç±»ä¸­å¢åŠ é…ç½®ï¼Œæ·»åŠ æ–°çš„å­—æ®µï¼ˆæ¯”å¦‚é€šè¿‡ User ä¸­çš„ <code>gender</code> åœ¨ç”Ÿæˆçš„ POJOï¼ˆUserVOï¼‰ ä¸­æ‰©å±•å‡ºä¸€ä¸ª <code>genderDesc</code> å­—æ®µï¼Œå¹¶ä¸”ä¸åŸæ¥çš„ <code>gender</code> ç±»å…±å­˜å¹¶è¿›è¡ŒåŒå‘ç»‘å®šï¼‰</li>
<li>å­—æ®µè¿›è¡Œè½¬æ¢æ—¶å¯ä»¥é€šè¿‡æŒ‡å®š <code>conversionMethodName</code>, <code>inverseConversionMethodName</code> ç­‰æ–¹æ³•æ¥è¿›è¡Œç‰¹æ®Šçš„è½¬æ¢ï¼Œç±»ä¼¼ <code>Databinding</code> ä¸­çš„ <code>@BindingMethod</code>ã€‚</li>
<li>é“¾å¼çš„ POJO ç”Ÿæˆï¼Œå¦‚ä» <code>User</code> ç”Ÿæˆ <code>UserDO</code>, ä» <code>UserDO</code> ç”Ÿæˆ <code>UserBO</code>, ä» <code>UserBO</code> ç”Ÿæˆ <code>UserVO</code>â€¦</li>
<li>ç”Ÿæˆç±»ä¸­è‡ªåŠ¨ç”Ÿæˆè½¬æ¢æ–¹æ³• <code>UserBo.create(User user)</code>, <code>userBo.toUser()</code>ã€‚</li>
<li>æ”¯æŒ POJO <code>ç»§æ‰¿</code>.</li>
<li>æ”¯æŒå¯¹è±¡æ± ï¼ˆæ¯”å¦‚ <code>android.support.v4.util.Pools</code>ï¼‰ã€‚</li>
</ol>
<h2 id="æ€ä¹ˆä½¿ç”¨ï¼Ÿ"><a href="#æ€ä¹ˆä½¿ç”¨ï¼Ÿ" class="headerlink" title="æ€ä¹ˆä½¿ç”¨ï¼Ÿ"></a>æ€ä¹ˆä½¿ç”¨ï¼Ÿ</h2><p>Gradle <a href="http://search.maven.org/#search%7Cga%7C1%7Crapidooo" target="_blank" rel="noopener">Check Newest Version</a></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">"com.github.wangjiegulu:rapidooo-api:x.x.x"</span></span><br><span class="line">annotationProcessor <span class="string">"com.github.wangjiegulu:rapidooo-compiler:x.x.x"</span></span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹é€šè¿‡ä¸¤ä¸ªä¾‹å­æ¥è¯´æ˜:</p>
<p><strong>User POJO:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String nickname;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line">    <span class="comment">// getter setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Pet POJO:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long petId;</span><br><span class="line">    <span class="keyword">private</span> String petName;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isCat;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> delete;</span><br><span class="line">    <span class="keyword">private</span> Boolean isDog;</span><br><span class="line">    <span class="keyword">private</span> Boolean clear;</span><br><span class="line">    <span class="keyword">private</span> User owner;</span><br><span class="line">    <span class="comment">// getter  settter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="POJO-è½¬æ¢ä¸º-BO"><a href="#POJO-è½¬æ¢ä¸º-BO" class="headerlink" title="POJO è½¬æ¢ä¸º BO"></a>POJO è½¬æ¢ä¸º BO</h3><p>åˆ›å»º <code>BOGenerator</code> ç±»ï¼Œé…ç½®ä»¥ä¸‹æ³¨è§£:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOOs</span>(suffix = BOGenerator.BO_SUFFIX, ooos = &#123;</span><br><span class="line">        <span class="meta">@OOO</span>(id = <span class="string">"user_bo_id"</span>, from = User.class, suffix = BOGenerator.BO_SUFFIX_USER),</span><br><span class="line">        <span class="meta">@OOO</span>(from = Pet.class, conversion = &#123;</span><br><span class="line">                <span class="meta">@OOOConversion</span>(</span><br><span class="line">                        fieldName = <span class="string">"owner"</span>,</span><br><span class="line">                        targetTypeId = <span class="string">"user_bo_id"</span>,</span><br><span class="line">                        targetFieldName = <span class="string">"ownerUser"</span>,</span><br><span class="line">                        replace = <span class="keyword">true</span></span><br><span class="line">                )</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BOGenerator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String BO_SUFFIX = <span class="string">"BO"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String BO_SUFFIX_USER = <span class="string">"_BO"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä½¿ç”¨ <code>@OOOs</code> æ³¨è§£æ¥è¿›è¡Œè½¬æ¢çš„é…ç½®ï¼Œé€šè¿‡ <code>@OOO</code> æ³¨è§£æ¥æ˜¾ç¤ºåœ°æŒ‡å®šéœ€è¦è½¬æ¢æˆå“ªäº›ç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOO</span>(id = <span class="string">"user_bo_id"</span>, from = User.class, suffix = BOGenerator.BO_SUFFIX_USER)</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šè¡¨ç¤ºä¸€ä¸ªç±»çš„è½¬æ¢:</p>
<ul>
<li><strong>id:</strong>è¡¨ç¤ºæœ¬åœ°è½¬æ¢çš„ idï¼Œå¯ä»¥ä¸ºä»»æ„å­—ç¬¦ä¸²ï¼ˆéœ€å”¯ä¸€ï¼‰ï¼Œé»˜è®¤ä¸è®¾ç½® idã€‚</li>
<li><strong>from:</strong>è¡¨ç¤ºè½¬æ¢æºï¼Œä» <code>User</code> è½¬æ¢ï¼Œå¿…å¡«ã€‚</li>
<li><strong>suffix:</strong>è¡¨ç¤ºç”Ÿæˆçš„ POJO ç±»çš„åå­—åç¼€ï¼Œè¿™é‡Œæ˜¯ <code>_BO</code>ï¼Œæ‰€ä»¥ç”Ÿæˆçš„ç±»åä¸º <code>User_BO</code>ï¼Œé»˜è®¤ä½¿ç”¨ <code>@OOOs</code> ä¸­çš„ <code>suffix</code>ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOO</span>(from = Pet.class, conversion = &#123;</span><br><span class="line">      <span class="meta">@OOOConversion</span>(</span><br><span class="line">              fieldName = <span class="string">"owner"</span>,</span><br><span class="line">              targetTypeId = <span class="string">"user_bo_id"</span>,</span><br><span class="line">              targetFieldName = <span class="string">"ownerUser"</span>,</span><br><span class="line">              replace = <span class="keyword">true</span></span><br><span class="line">      )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä¹Ÿè¡¨ç¤ºä¸€ä¸ªç±»çš„è½¬æ¢ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ <code>@OOOConversion</code> æ¥æ–°å¢ä¸€ä¸ªå­—æ®µ:</p>
<ul>
<li><strong>fieldName:</strong>æŒ‡å®šæ–°çš„å­—æ®µæ˜¯ä»è½¬æ¢æº POJO çš„å“ªä¸ªå­—æ®µæ´¾ç”Ÿå‡ºæ¥çš„</li>
<li><strong>targetTypeId:</strong>ç”¨æ¥æŒ‡å®šæ–°çš„å­—æ®µçš„ç±»å‹idï¼Œéœ€è¦ä¸å…¶å®ƒçš„ <code>@OOO</code> æŒ‡å®šçš„ <code>id</code> ä¸€è‡´ï¼›ä¹Ÿå¯ä»¥é€šè¿‡ <code>targetType</code> æ¥æŒ‡å®š Class ç±»å‹ã€‚</li>
<li><strong>targetFieldName:</strong>æŒ‡å®šæ–°å­—æ®µçš„åå­—ï¼Œå¯ä»¥ä»»æ„ã€‚</li>
<li><strong>replace:</strong>æ–°çš„å­—æ®µæ˜¯å¦æ›¿æ¢åŸæ¥çš„å­—æ®µï¼ˆ<strong>fieldName</strong>ï¼‰ï¼Œå¦‚æœ falseï¼Œåˆ™å…±å­˜ã€‚</li>
</ul>
<p>ç„¶åç¼–è¯‘å°†ä¼šè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹ä»£ç :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User_BO</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Long userId;</span><br><span class="line">  <span class="keyword">private</span> String username;</span><br><span class="line">  <span class="keyword">private</span> String nickname;</span><br><span class="line">  <span class="keyword">private</span> Integer age;</span><br><span class="line">  <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getter setter</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> User_BO <span class="title">create</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">    User_BO user_BO = <span class="keyword">new</span> User_BO();</span><br><span class="line">    user_BO.userId = user.getUserId();</span><br><span class="line">    user_BO.username = user.getUsername();</span><br><span class="line">    user_BO.nickname = user.getNickname();</span><br><span class="line">    user_BO.age = user.getAge();</span><br><span class="line">    user_BO.gender = user.getGender();</span><br><span class="line">    <span class="keyword">return</span> user_BO;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> User <span class="title">toUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setUserId(userId);</span><br><span class="line">    user.setUsername(username);</span><br><span class="line">    user.setNickname(nickname);</span><br><span class="line">    user.setAge(age);</span><br><span class="line">    user.setGender(gender);</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PetBO</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Long petId;</span><br><span class="line">  <span class="keyword">private</span> String petName;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">boolean</span> isCat;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">boolean</span> delete;</span><br><span class="line">  <span class="keyword">private</span> Boolean isDog;</span><br><span class="line">  <span class="keyword">private</span> Boolean clear;</span><br><span class="line">  <span class="keyword">private</span> User_BO ownerUser;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getter setter</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> PetBO <span class="title">create</span><span class="params">(Pet pet)</span> </span>&#123;</span><br><span class="line">    PetBO petBO = <span class="keyword">new</span> PetBO();</span><br><span class="line">    petBO.petId = pet.getPetId();</span><br><span class="line">    petBO.petName = pet.getPetName();</span><br><span class="line">    petBO.isCat = pet.isCat();</span><br><span class="line">    petBO.delete = pet.isDelete();</span><br><span class="line">    petBO.isDog = pet.getDog();</span><br><span class="line">    petBO.clear = pet.getClear();</span><br><span class="line">    petBO.ownerUser = User_BO.create(pet.getOwner());</span><br><span class="line">    <span class="keyword">return</span> petBO;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Pet <span class="title">toPet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Pet pet = <span class="keyword">new</span> Pet();</span><br><span class="line">    pet.setPetId(petId);</span><br><span class="line">    pet.setPetName(petName);</span><br><span class="line">    pet.setCat(isCat);</span><br><span class="line">    pet.setDelete(delete);</span><br><span class="line">    pet.setDog(isDog);</span><br><span class="line">    pet.setClear(clear);</span><br><span class="line">    pet.setOwner(ownerUser.toUser());</span><br><span class="line">    <span class="keyword">return</span> pet;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="BO-è½¬æ¢ä¸º-VO"><a href="#BO-è½¬æ¢ä¸º-VO" class="headerlink" title="BO è½¬æ¢ä¸º VO"></a>BO è½¬æ¢ä¸º VO</h3><p>å¦‚ä¸‹æ–°å»º <code>VOGenerator</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOOs</span>(suffix = VOGenerator.VO_SUFFIX, fromSuffix = BOGenerator.BO_SUFFIX, ooosPackages = &#123;</span><br><span class="line">        VOGenerator.PACKAGE_BO</span><br><span class="line">&#125;, ooos = &#123;</span><br><span class="line">        <span class="meta">@OOO</span>(id = <span class="string">"user_vo_id"</span>, from = User_BO.class),</span><br><span class="line">        <span class="meta">@OOO</span>(from = User_BO.class<span class="comment">/*, suffix = VOGenerator.VO_SUFFIX_USER*/</span>,</span><br><span class="line">                fromSuffix = BOGenerator.BO_SUFFIX_USER,</span><br><span class="line">                conversion = &#123;</span><br><span class="line">                        <span class="meta">@OOOConversion</span>(</span><br><span class="line">                                fieldName = <span class="string">"gender"</span>,</span><br><span class="line">                                targetFieldName = <span class="string">"genderDesc"</span>,</span><br><span class="line">                                targetType = String.class,</span><br><span class="line">                                conversionMethodName = <span class="string">"conversionGender"</span>,</span><br><span class="line">                                inverseConversionMethodName = <span class="string">"inverseConversionGender"</span>,</span><br><span class="line">                                replace = <span class="keyword">false</span></span><br><span class="line">                        ),</span><br><span class="line">                        <span class="meta">@OOOConversion</span>(</span><br><span class="line">                                fieldName = <span class="string">"age"</span>,</span><br><span class="line">                                targetFieldName = <span class="string">"ageDes"</span>,</span><br><span class="line">                                targetType = String.class,</span><br><span class="line">                                conversionMethodName = <span class="string">"conversionAge"</span>,</span><br><span class="line">                                conversionMethodClass = AgeConversion.class,</span><br><span class="line">                                replace = <span class="keyword">true</span></span><br><span class="line">                        )</span><br><span class="line">                &#125;</span><br><span class="line">        ),</span><br><span class="line">        <span class="meta">@OOO</span>(from = PetBO.class,</span><br><span class="line">                conversion = &#123;</span><br><span class="line">                        <span class="meta">@OOOConversion</span>(</span><br><span class="line">                                fieldName = <span class="string">"ownerUser"</span>,</span><br><span class="line">                                targetFieldName = <span class="string">"ownerUser"</span>,</span><br><span class="line">                                targetTypeId = <span class="string">"user_vo_id"</span>,</span><br><span class="line">                                replace = <span class="keyword">true</span></span><br><span class="line">                        )</span><br><span class="line">                &#125;</span><br><span class="line">        )</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VOGenerator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String VO_SUFFIX = <span class="string">"VO"</span>;</span><br><span class="line">    <span class="comment">//    public static final String VO_SUFFIX_USER = "_VO";</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String PACKAGE_BO = <span class="string">"com.wangjiegulu.rapidooo.depmodule.bll.xbo"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">conversionGender</span><span class="params">(Integer gender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == gender) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"unknown"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">switch</span> (gender) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"female"</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"male"</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"unknown"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title">inverseConversionGender</span><span class="params">(String genderDesc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (genderDesc) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"male"</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"female"</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜æ˜¯é€šè¿‡ <code>@OOOs</code> æ³¨è§£æ¥æŒ‡å®šè¦ç”Ÿæˆçš„ç±»ï¼Œä½†è¿™é‡Œä½¿ç”¨äº† <code>ooosPackages</code> æ¥æŒ‡å®šå“ªäº›åŒ…ä¸‹é¢çš„ç±»éœ€è¦è¿›è¡Œè½¬æ¢ã€‚</p>
<p>è½¬æ¢æºä¸ºä¸Šé¢ç”Ÿæˆçš„:<code>User_BO</code> å’Œ <code>PetBO</code>ï¼Œç”Ÿæˆçš„ç±»åä¸º <code>UserVO</code> å’Œ <code>PetVO</code>ã€‚</p>
<p>åœ¨ <code>UserVO</code> ä¸­æ‰©å±•äº†ä¸¤ä¸ªå­—æ®µ:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOOConversion</span>(</span><br><span class="line">       fieldName = <span class="string">"gender"</span>,</span><br><span class="line">       targetFieldName = <span class="string">"genderDesc"</span>,</span><br><span class="line">       targetType = String.class,</span><br><span class="line">       conversionMethodName = <span class="string">"conversionGender"</span>,</span><br><span class="line">       inverseConversionMethodName = <span class="string">"inverseConversionGender"</span>,</span><br><span class="line">       replace = <span class="keyword">false</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>ä»è½¬æ¢æºçš„ <code>gender</code> å­—æ®µæ‰©å±•å‡º <code>genderDesc</code> ï¼ˆç”¨äºåœ¨ View ä¸Šè¿›è¡Œå±•ç¤ºï¼‰ï¼Œç±»å‹ä¸º <code>String</code> ï¼Œå¹¶ä¸” <code>replace = false</code>ï¼ˆ<code>gender</code> ä¸ <code>genderDesc</code> å…±å­˜ï¼‰:</p>
<ul>
<li><strong>conversionMethodName:</strong>æŒ‡å®šè½¬æ¢æ–¹æ³•ï¼Œä» <code>gender</code> è½¬æ¢ä¸º <code>genderDesc</code>ã€‚é»˜è®¤ä¸ºä¸è®¾ç½®ã€‚</li>
<li><strong>inverseConversionMethodName:</strong>æŒ‡å®šé€†è½¬æ¢æ–¹æ³•ï¼Œä» <code>genderDesc</code> è½¬æ¢ä¸º <code>gender</code>ã€‚é»˜è®¤ä¸ºä¸è®¾ç½®ã€‚</li>
</ul>
<blockquote>
<p><strong>æ³¨æ„:</strong><code>conversionMethodName</code> å’Œ <code>inverseConversionMethodName</code> æ–¹æ³•æŒ‡å®šæ–¹æ³•åå­—æ—¶ï¼Œæ–¹æ³•ç­¾åå¿…é¡»æ»¡è¶³ä»¥ä¸‹å…¶ä¸€:</p>
<ul>
<li><code>public static [è½¬æ¢ç›®æ ‡ç±»å‹] conversionXxx([è½¬æ¢æºå­—æ®µç±»å‹] param)</code></li>
<li><code>public static [è½¬æ¢ç›®æ ‡ç±»å‹] conversionXxx([è½¬æ¢æº class ç±»å‹] param1, [è½¬æ¢æºå­—æ®µç±»å‹] param2)</code><br>å¦‚ä¸Šé¢ <code>gender</code> å’Œ <code>genderDesc</code> çš„è½¬æ¢:</li>
<li><code>public static String conversionGender(UserVO userVO, Integer gender)</code></li>
<li><code>public static Integer inverseConversionGender(String genderDesc)</code></li>
</ul>
</blockquote>
<p>é€šè¿‡è®¾ç½®ä»¥ä¸Šä¸¤ä¸ªæ–¹æ³•ï¼Œ<code>gender</code> å’Œ <code>genderDesc</code> ä¸¤ä¸ªå­—æ®µä¼šå®ç°äº’ç›¸ç»‘å®šï¼Œæ”¹å˜å…¶ä¸­ä¸€ä¸ªå­—æ®µï¼Œå¦ä¸€ä¸ªå­—æ®µä¹Ÿä¼šè‡ªåŠ¨å‘ç”Ÿæ”¹å˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOOConversion</span>(</span><br><span class="line">       fieldName = <span class="string">"age"</span>,</span><br><span class="line">       targetFieldName = <span class="string">"ageDes"</span>,</span><br><span class="line">       targetType = String.class,</span><br><span class="line">       conversionMethodName = <span class="string">"conversionAge"</span>,</span><br><span class="line">       conversionMethodClass = AgeConversion.class,</span><br><span class="line">       replace = <span class="keyword">true</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><code>UserVO</code> ä¸­è¿˜ä»è½¬æ¢æºçš„ <code>age</code> æ‰©å±•äº†ä¸€ä¸ª <code>ageDesc</code> å±æ€§ï¼ˆæ›¿æ¢æ‰ <code>age</code> å­—æ®µï¼Œä¸å…±å­˜ï¼‰ï¼Œå¹¶æŒ‡å®šäº† <code>conversionMethodName</code>ï¼Œä½†æ˜¯è½¬æ¢æ–¹æ³•å¹¶ä¸åœ¨ <code>VOGenerator</code> ç±»ä¸­ï¼Œè€Œæ˜¯åœ¨ <code>AgeConversion</code> ç±»ä¸­ï¼Œæ‰€ä»¥éœ€è¦æ˜¾ç¤ºåœ°è¿›è¡ŒæŒ‡å®š <code>conversionMethodClass</code>ã€‚</p>
<ul>
<li><strong>conversionMethodClass:</strong>è½¬æ¢æ–¹æ³•æ‰€åœ¨çš„ Classï¼Œé»˜è®¤ä¸è®¾ç½®åˆ™è¡¨ç¤ºåœ¨å½“å‰çš„ <code>Generator</code> ç±»ä¸­ã€‚</li>
</ul>
<p>å¦å¤– <code>PetVO</code> æ‰©å±•äº†ä¸€ä¸ª <code>ownerUser</code>ã€‚</p>
<p>æœ€åç¼–è¯‘ç”Ÿæˆçš„ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserVO</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Long userId;</span><br><span class="line">  <span class="keyword">private</span> String username;</span><br><span class="line">  <span class="keyword">private</span> String nickname;</span><br><span class="line">  <span class="keyword">private</span> String ageDes;</span><br><span class="line">  <span class="keyword">private</span> Integer gender;</span><br><span class="line">  <span class="keyword">private</span> String genderDesc;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getter setter</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGender</span><span class="params">(Integer gender)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.gender = gender;</span><br><span class="line">    <span class="keyword">this</span>.genderDesc = VOGenerator.conversionGender(gender);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGenderDesc</span><span class="params">(String genderDesc)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.genderDesc = genderDesc;</span><br><span class="line">    <span class="keyword">this</span>.gender = VOGenerator.inverseConversionGender(genderDesc);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UserVO <span class="title">create</span><span class="params">(User_BO user_BO)</span> </span>&#123;</span><br><span class="line">    UserVO userVO = <span class="keyword">new</span> UserVO();</span><br><span class="line">    userVO.userId = user_BO.getUserId();</span><br><span class="line">    userVO.username = user_BO.getUsername();</span><br><span class="line">    userVO.nickname = user_BO.getNickname();</span><br><span class="line">    userVO.ageDes = AgeConversion.conversionAge(user_BO.getAge());</span><br><span class="line">    userVO.gender = user_BO.getGender();</span><br><span class="line">    userVO.genderDesc = VOGenerator.conversionGender(user_BO.getGender());</span><br><span class="line">    <span class="keyword">return</span> userVO;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> User_BO <span class="title">toUser_BO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User_BO user_BO = <span class="keyword">new</span> User_BO();</span><br><span class="line">    user_BO.setUserId(userId);</span><br><span class="line">    user_BO.setUsername(username);</span><br><span class="line">    user_BO.setNickname(nickname);</span><br><span class="line">    <span class="comment">// Loss field:age, recommend to use `inverseConversionMethodName`.</span></span><br><span class="line">    user_BO.setGender(gender);</span><br><span class="line">    <span class="keyword">return</span> user_BO;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>æ³¨æ„:</strong>ä»¥ä¸Š <code>User_BO</code>ï¼Œç”±äº <code>age</code> å±æ€§æ˜¯ <code>replace</code>ï¼Œå¹¶ä¸”åªè®¾ç½®äº† <code>conversionMethodName</code>ï¼Œå¹¶æ²¡æœ‰è®¾ç½® <code>inverseConversionMethodName</code>ï¼Œæ‰€ä»¥åœ¨ <code>toUser_BO()</code> æ–¹æ³•è¿›è¡Œé€†è½¬æ¢æ—¶ä¼šä¸¢å¤± <code>age</code> å±æ€§ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨ <code>inverseConversionMethodName</code>ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PetVO</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> Long petId;</span><br><span class="line">  <span class="keyword">private</span> String petName;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">boolean</span> isCat;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">boolean</span> delete;</span><br><span class="line">  <span class="keyword">private</span> Boolean isDog;</span><br><span class="line">  <span class="keyword">private</span> Boolean clear;</span><br><span class="line">  <span class="keyword">private</span> UserVO ownerUser;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getter setter</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> PetVO <span class="title">create</span><span class="params">(PetBO petBO)</span> </span>&#123;</span><br><span class="line">    PetVO petVO = <span class="keyword">new</span> PetVO();</span><br><span class="line">    petVO.petId = petBO.getPetId();</span><br><span class="line">    petVO.petName = petBO.getPetName();</span><br><span class="line">    petVO.isCat = petBO.isCat();</span><br><span class="line">    petVO.delete = petBO.isDelete();</span><br><span class="line">    petVO.isDog = petBO.getDog();</span><br><span class="line">    petVO.clear = petBO.getClear();</span><br><span class="line">    petVO.ownerUser = UserVO.create(petBO.getOwnerUser());</span><br><span class="line">    <span class="keyword">return</span> petVO;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> PetBO <span class="title">toPetBO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    PetBO petBO = <span class="keyword">new</span> PetBO();</span><br><span class="line">    petBO.setPetId(petId);</span><br><span class="line">    petBO.setPetName(petName);</span><br><span class="line">    petBO.setCat(isCat);</span><br><span class="line">    petBO.setDelete(delete);</span><br><span class="line">    petBO.setDog(isDog);</span><br><span class="line">    petBO.setClear(clear);</span><br><span class="line">    petBO.setOwnerUser(ownerUser.toUser_BO());</span><br><span class="line">    <span class="keyword">return</span> petBO;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¯¹è±¡æ± çš„ä½¿ç”¨"><a href="#å¯¹è±¡æ± çš„ä½¿ç”¨" class="headerlink" title="å¯¹è±¡æ± çš„ä½¿ç”¨"></a>å¯¹è±¡æ± çš„ä½¿ç”¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"BO"</span>, ooos = &#123;</span><br><span class="line">        <span class="meta">@OOO</span>(from = Pet.class, pool = <span class="meta">@OOOPool</span>(</span><br><span class="line">            acquireMethod = <span class="string">"acquirePetBO"</span>, </span><br><span class="line">            releaseMethod = <span class="string">"releasePetBO"</span></span><br><span class="line">        ))</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectPoolBOGenerator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Pools.Pool&lt;PetBO&gt; petBOPool = <span class="keyword">new</span> Pools.SimplePool&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> PetBO <span class="title">acquirePetBO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PetBO petBO = petBOPool.acquire();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span> == petBO ? <span class="keyword">new</span> PetBO() : petBO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">releasePetBO</span><span class="params">(PetBO petBO)</span> </span>&#123;</span><br><span class="line">        petBOPool.release(petBO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šä»£ç ï¼Œé€šè¿‡æ·»åŠ  <code>@OOOPool</code> æ³¨è§£ï¼Œå¹¶æŒ‡å®š <code>acquireMethod</code> å’Œ <code>releaseMethod</code> ä¸¤ä¸ªæ–¹æ³•æ¥åˆ›å»ºå’Œå›æ”¶ç›¸åº”çš„å¯¹è±¡å³å¯ï¼ˆè¿™é‡Œä½¿ç”¨äº† Android Support åŒ…ä¸­çš„ <code>Pools.SimplePool</code> æ¥å®ç°å¯¹è±¡æ± ï¼‰ã€‚</p>
<h1 id="License"><a href="#License" class="headerlink" title="License"></a>License</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Copyright 2018 Wang Jie</span><br><span class="line"></span><br><span class="line">Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="line">you may not use this file except in compliance with the License.</span><br><span class="line">You may obtain a copy of the License at</span><br><span class="line"></span><br><span class="line">  http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line"></span><br><span class="line">Unless required by applicable law or agreed to in writing, software</span><br><span class="line">distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="line">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line">See the License for the specific language governing permissions and</span><br><span class="line">limitations under the License.</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> android </category>
            
            <category> pojo converter </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> annotations </tag>
            
            <tag> javabean </tag>
            
            <tag> pojo </tag>
            
            <tag> domain-driven-design </tag>
            
            <tag> apt </tag>
            
            <tag> javapoet </tag>
            
            <tag> annotation processor </tag>
            
            <tag> pojo converter </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component ViewModelï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_viewmodel/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-ViewModelï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-ViewModelï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component ViewModelï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component ViewModelï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/architecture/viewmodel" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/architecture/viewmodel</a></p>
</blockquote>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> è¢«è®¾è®¡ä¸ºä»¥ç”Ÿå‘½å‘¨æœŸæ„è¯†çš„æ–¹å¼å­˜å‚¨å’Œç®¡ç† UI ç›¸å…³çš„æ•°æ®çš„ç±»ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ç±»å…è®¸æ•°æ®åœ¨å±å¹•æ—‹è½¬ä¹‹åä¿å­˜ä¸‹æ¥ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šè¦å¯¼å…¥ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener">ViewModel</a> åˆ°ä½ çš„ Android é¡¹ç›®ä¸­ï¼Œè¯·æŸ¥é˜… <a href="https://developer.android.com/topic/libraries/architecture/adding-components.html#lifecycle" target="_blank" rel="noopener">æ·»åŠ  components åˆ°ä½ çš„é¡¹ç›®ä¸­</a>ã€‚</p>
</blockquote>
<p>Android Framework ä¼šç®¡ç† UI Controllers çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ¯”å¦‚ activities å’Œ fragmentã€‚Framework å¯èƒ½ä¼šå†³å®šå»é”€æ¯æˆ–é‡å»ºä¸€ä¸ª UI Controller æ¥å“åº”æŸäº›å®Œå…¨è¶…å‡ºä½ æ§åˆ¶èŒƒå›´çš„ç”¨æˆ·æ“ä½œæˆ–è®¾å¤‡äº‹ä»¶ã€‚</p>
<p>å¦‚æœç³»ç»Ÿé”€æ¯æˆ–è€…é‡å»ºä¸€ä¸ª UI Controllerï¼Œä½ å­˜å‚¨åœ¨å…¶ä¸­çš„ä»»ä½•ç¬æ€ UI ç›¸å…³æ•°æ®éƒ½å°†ä¸¢å¤±ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½ çš„åº”ç”¨å¯èƒ½ä¼šåœ¨å…¶ä¸­ä¸€ä¸ª activity ä¸­åŒ…å«ç”¨æˆ·åˆ—è¡¨ã€‚å½“ activity å› ä¸ºé…ç½®æ”¹å˜è€Œé‡å»ºæ—¶ï¼Œæ–°çš„ activity ä¼šå»é‡æ–°æ‹‰å–ç”¨æˆ·åˆ—è¡¨æ•°æ®ã€‚å¯¹äºç®€å•çš„æ•°æ®ï¼Œactivity å¯ä»¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState(android.os.Bundle" target="_blank" rel="noopener"><code>onSaveInstanceState()</code></a>) æ–¹æ³•å¹¶åœ¨ <a href="https://developer.android.com/reference/android/app/Activity.html#onCreate(android.os.Bundle" target="_blank" rel="noopener"><code>onCreate</code></a>) æ–¹æ³•ä¸­ä» bundle ä¸­è¿˜åŸæ•°æ®ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•åªé€‚ç”¨äºå¯ä»¥åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å°‘é‡çš„æ•°æ®ï¼Œè€Œä¸æ˜¯æ½œåœ¨çš„å¤§é‡æ•°æ®ï¼Œå¦‚ç”¨æˆ·åˆ—è¡¨æˆ– bitmapsã€‚</p>
<p>å¦ä¸€ä¸ªé—®é¢˜ï¼ŒUI Controllers é¢‘ç¹åœ°å»è¿›è¡Œå¼‚æ­¥è°ƒç”¨ï¼Œå®ƒå¯èƒ½ä¼šéœ€è¦ä¸€æ®µæ—¶é—´ä¹‹åæ‰è¿”å›ã€‚UI Controller éœ€è¦ç®¡ç†è¿™äº›è°ƒç”¨å¹¶ç¡®ä¿ç³»ç»Ÿä¼šåœ¨é”€æ¯ä¹‹åä¸ºé¿å…æ½œåœ¨çš„å†…å­˜æ³„æ¼è€ŒæŠŠå®ƒä»¬æ¸…ç†æ‰ã€‚è¿™ç§ç®¡ç†éœ€è¦å¤§é‡çš„ç»´æŠ¤ï¼Œå¹¶ä¸”åœ¨ä¸ºé…ç½®æ›´æ”¹é‡å»ºå¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œè¿™æ˜¯å¯¹èµ„æºçš„æµªè´¹ï¼Œå› ä¸ºå¯¹è±¡å¯èƒ½ä¸å¾—ä¸é‡æ–°æ‰§è¡Œå®ƒå·²ç»æ‰§è¡Œè¿‡çš„è°ƒç”¨ã€‚</p>
<p>UI Controllersï¼Œæ¯”å¦‚ activities å’Œ fragments ä¸»è¦è´Ÿè´£ UI æ•°æ®çš„æ˜¾ç¤ºï¼Œå¯¹ç”¨æˆ·è¡Œä¸ºä½œå‡ºååº”ï¼Œæˆ–è€…å¤„ç†ä¸æ“ä½œç³»ç»Ÿçš„é€šä¿¡ï¼Œæ¯”å¦‚æƒé™è¯·æ±‚ã€‚è¦æ±‚ UI Controllers ä¹Ÿè´Ÿè´£ä»æ•°æ®åº“æˆ–ç½‘ç»œåŠ è½½æ•°æ®ä¼šè®©ç±»å˜å¾—è‡ƒè‚¿ã€‚å°†è¿‡å¤šçš„è´£ä»»åˆ†é…ç»™ UI Controller å¯èƒ½ä¼šå¯¼è‡´å•ä¸ªç±»å°è¯•å•ç‹¬å¤„ç† app çš„æ‰€æœ‰å·¥ä½œï¼Œè€Œä¸æ˜¯å°†å·¥ä½œå§”æ´¾ç»™å…¶ä»–ç±»ã€‚ä»¥è¿™ç§æ–¹å¼ä¸º UI Controller åˆ†é…è¿‡å¤šçš„è´£ä»»ä¹Ÿä¼šä½¿æµ‹è¯•å˜å¾—æ›´åŠ å›°éš¾ã€‚</p>
<p>å°† view æ•°æ®æ‰€æœ‰æƒä» UI Controller é€»è¾‘å‰¥ç¦»æ—¶æ›´å®¹æ˜“ï¼Œæ›´é«˜æ•ˆçš„ã€‚</p>
<h2 id="å®ç°ä¸€ä¸ª-ViewModel"><a href="#å®ç°ä¸€ä¸ª-ViewModel" class="headerlink" title="å®ç°ä¸€ä¸ª ViewModel"></a>å®ç°ä¸€ä¸ª ViewModel</h2><p>å¯¹äº UI Controllerï¼ŒArchitecture Components æä¾›äº†ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å¸®åŠ©ç±»ï¼Œè®©å®ƒè´Ÿè´£ä¸º UI å‡†å¤‡æ•°æ®ã€‚åœ¨é…ç½®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å¯¹è±¡ä¼šè‡ªåŠ¨ä¿ç•™ï¼Œæ‰€ä»¥å®ƒä»¬æŒæœ‰çš„æ•°æ®ä¼šç«‹åˆ»å¯¹äºä¸‹ä¸€ä¸ª activity æˆ–è€… fragment å®ä¾‹å˜å¾—å¯ç”¨ã€‚ä¸¾ä¾‹ï¼Œå¦‚æœä½ éœ€è¦åœ¨ä½ çš„ app ä¸­æ˜¾ç¤ºä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ï¼Œç¡®ä¿ä½ ç»™ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> åˆ†é…è·å–å’ŒæŒæœ‰ç”¨æˆ·åˆ—è¡¨æ•°æ®çš„èŒè´£ï¼Œè€Œä¸æ˜¯ç»™ activity æˆ–è€… fragmentï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyViewModel</span> : <span class="type">ViewModel</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> users: MutableLiveData&lt;List&lt;User&gt;&gt;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getUsers</span><span class="params">()</span></span>: LiveData&lt;List&lt;User&gt;&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (!::users.isInitialized) &#123;</span><br><span class="line">            users = MutableLiveData()</span><br><span class="line">            loadUsers()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> users</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">loadUsers</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// Do an asynchronous operation to fetch users.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥ä» activity ä¸­å¦‚ä¸‹æ–¹å¼è¿›è¡Œè®¿é—®ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="comment">// Create a ViewModel the first time the system calls an activity's onCreate() method.</span></span><br><span class="line">        <span class="comment">// Re-created activities receive the same MyViewModel instance created by the first activity.</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> model = ViewModelProviders.of(<span class="keyword">this</span>).<span class="keyword">get</span>(MyViewModel::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line">        model.getUsers().observe(<span class="keyword">this</span>, Observer&lt;List&lt;User&gt;&gt;&#123; users -&gt;</span><br><span class="line">            <span class="comment">// update UI</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœ activity è¢«é‡å»ºï¼Œå®ƒä¼šæ”¶åˆ°åŒä¸€ä¸ª <code>MyViewModel</code> å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ª activity åˆ›å»ºçš„é‚£ä¸ªã€‚å½“æ‰€æœ‰æ‹¥æœ‰è€… activity ç»“æŸå®Œæˆï¼Œframework ä¼šè°ƒç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å¯¹è±¡çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html#onCleared(" target="_blank" rel="noopener"><code>onCleared()</code></a>) æ–¹æ³•ï¼Œä»¥ä¾¿äºå®ƒå¯ä»¥æ¸…ç†èµ„æºã€‚</p>
<blockquote>
<p>è­¦å‘Šï¼š<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener">ViewModel</a> ä¸€å®šä¸èƒ½å¼•ç”¨ viewï¼Œ<a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener">Lifecycle</a>ï¼Œæˆ–è€…ä»»ä½•å¯èƒ½ä¼šæŒæœ‰ activity context çš„å¼•ç”¨çš„ç±»ã€‚</p>
</blockquote>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å¯¹è±¡è¢«è®¾è®¡ä¸ºæ¯”ç”Ÿå‘½å‘¨æœŸæ¯” viewsï¼Œ<a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener"><code>LifecycleOwners</code></a> é•¿ã€‚è¿™ä¸ªè®¾è®¡ä¹Ÿæ„å‘³ç€ä½ å¯ä»¥æ›´å®¹æ˜“å†™è¦†ç›– <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> çš„æµ‹è¯•ï¼Œå› ä¸ºä½ ä¸éœ€è¦çŸ¥é“ view å’Œ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> å¯¹è±¡ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å¯¹è±¡å¯ä»¥åŒ…å« <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleObserver.html" target="_blank" rel="noopener"><code>LifecycleObservers</code></a>ï¼Œæ¯”å¦‚ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡ã€‚ä½†æ˜¯ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å¯¹è±¡ä¸€å®šä¸èƒ½è§‚å¯Ÿç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„ observables çš„æ”¹å˜ï¼Œæ¯”å¦‚ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡ã€‚å¦‚æœ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a>éœ€è¦ <a href="https://developer.android.com/reference/android/app/Application.html" target="_blank" rel="noopener"><code>Application</code></a>ï¼Œæ¯”å¦‚éœ€è¦è·å–ç³»ç»ŸæœåŠ¡ï¼Œå®ƒå¯ä»¥ç»§æ‰¿ <a href="https://developer.android.com/reference/android/arch/lifecycle/AndroidViewModel.html" target="_blank" rel="noopener"><code>AndroidViewModel</code></a> ç±»ï¼Œå®ƒæœ‰ä¸€ä¸ªæ¥æ”¶ <a href="https://developer.android.com/reference/android/app/Application.html" target="_blank" rel="noopener"><code>Application</code></a> çš„æ„é€ æ–¹æ³•ï¼Œå› ä¸º <a href="https://developer.android.com/reference/android/app/Application.html" target="_blank" rel="noopener"><code>Application</code></a> ç±»ç»§æ‰¿ <a href="https://developer.android.com/reference/android/content/Context.html" target="_blank" rel="noopener"><code>Context</code></a>ã€‚</p>
<h2 id="ViewModel-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#ViewModel-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ViewModel çš„ç”Ÿå‘½å‘¨æœŸ"></a>ViewModel çš„ç”Ÿå‘½å‘¨æœŸ</h2><p>å½“è·å– <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> æ—¶ï¼Œ<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å¯¹è±¡çš„ä½œç”¨åŸŸæ˜¯è¢«ä¼ å…¥ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModelProvider.html" target="_blank" rel="noopener"><code>ViewModelProvider</code></a>çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a>ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ä¼šç•™åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ° <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> çš„èŒƒå›´æ˜¯æ°¸ä¹…æ¶ˆå¤±ä¸ºæ­¢ï¼šå¯¹äº activityï¼Œå½“å®ƒ finish çš„æƒ…å†µä¸‹ï¼Œå¯¹äº fragmentï¼Œå½“å®ƒ detached çš„æƒ…å†µä¸‹ã€‚</p>
<p>ç¤ºå›¾ 1 å±•ç¤ºäº†ä¸€ä¸ª activity å„ç§ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ï¼Œå½“å®ƒç»å†äº†ä¸€ä¸ªæ—‹è½¬ï¼Œå† finishã€‚æ’å›¾ä¹Ÿå±•ç¤ºäº† <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> çš„æ•´ä¸ªå‘¨æœŸï¼Œåœ¨å…³è”çš„ activity ç”Ÿå‘½å‘¨æœŸçš„æ—è¾¹ã€‚æ­¤ç‰¹å®šå…³ç³»å›¾è¯´æ˜äº† activity çš„çŠ¶æ€ã€‚åŒæ ·çš„åŸºæœ¬çŠ¶æ€ä¹Ÿé€‚ç”¨äº fragment çš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/48878990-e6132000-ee44-11e8-986b-269898892b39.png" width="550px/"><br></div>

<p>ä½ é€šå¸¸è¦è¯·æ±‚ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ activity å¯¹è±¡çš„ <a href="https://developer.android.com/reference/android/app/Activity.html#onCreate(android.os.Bundle" target="_blank" rel="noopener"><code>onCreate</code></a>) æ–¹æ³•ã€‚åœ¨ activity çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œç³»ç»Ÿå¯èƒ½ä¼šè°ƒç”¨å¤šæ¬¡ <a href="https://developer.android.com/reference/android/app/Activity.html#onCreate(android.os.Bundle" target="_blank" rel="noopener"><code>onCreate</code></a>)ï¼Œæ¯”å¦‚å½“è®¾å¤‡å±å¹•æ—‹è½¬ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ä¼šä»å½“ä½ ç¬¬ä¸€æ¬¡è¯·æ±‚ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ° activity finished å¹¶ destroyedã€‚</p>
<h2 id="åœ¨-fragments-ä¹‹é—´å…±äº«æ•°æ®"><a href="#åœ¨-fragments-ä¹‹é—´å…±äº«æ•°æ®" class="headerlink" title="åœ¨ fragments ä¹‹é—´å…±äº«æ•°æ®"></a>åœ¨ fragments ä¹‹é—´å…±äº«æ•°æ®</h2><p>åœ¨ä¸€ä¸ª activity ä¸­å¤šä¸ª fragments éœ€è¦äº’ç›¸é€šä¿¡æ˜¯å¾ˆå¸¸è§çš„ã€‚æƒ³è±¡ä¸€ä¸ªå¸¸è§çš„ master-detail fragments çš„æƒ…å†µï¼Œå…¶ä¸­ç”¨æˆ·åœ¨ä¸€ä¸ª fragment çš„åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ª itemï¼Œå¦ä¸€ä¸ª fragment æ˜¾ç¤ºæ‰€é€‰ item çš„å†…å®¹ã€‚è¿™ç§æƒ…å†µä»æ¥éƒ½ä¸æ˜¯ä¸é‡è¦çš„ï¼Œå› ä¸ºè¿™ä¸¤ä¸ª fragment éƒ½éœ€è¦å®šä¹‰ä¸€äº›æ¥å£æè¿°ï¼Œå¹¶ä¸” owner activity å¿…é¡»å°†ä¸¤è€…ç»‘å®šåœ¨ä¸€èµ·ã€‚å¦å¤–ï¼Œä¸¤ä¸ª fragment éƒ½å¿…é¡»å¤„ç†å¦ä¸€ä¸ª fragment æ˜¯å¦å·²è¢«åˆ›å»ºæˆ–è€…å¯è§çš„åœºæ™¯ã€‚</p>
<p>è¿™ä¸ªå¸¸è§çš„ç—›ç‚¹å¯ä»¥é€šè¿‡ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å¯¹è±¡æ¥è§£å†³ã€‚è¿™äº› fragment å¯ä»¥å…±äº«ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a>ï¼Œä½¿ç”¨å®ƒä»¬çš„ activity scope æ¥å¤„ç†è¿™ä¸ªé€šä¿¡ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SharedViewModel</span> : <span class="type">ViewModel</span></span>() &#123;</span><br><span class="line">    <span class="keyword">val</span> selected = MutableLiveData&lt;Item&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">select</span><span class="params">(item: <span class="type">Item</span>)</span></span> &#123;</span><br><span class="line">        selected.value = item</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MasterFragment</span> : <span class="type">Fragment</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> itemSelector: Selector</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> model: SharedViewModel</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        model = activity?.run &#123;</span><br><span class="line">            ViewModelProviders.of(<span class="keyword">this</span>).<span class="keyword">get</span>(SharedViewModel::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line">        &#125; ?: <span class="keyword">throw</span> Exception(<span class="string">"Invalid Activity"</span>)</span><br><span class="line">        itemSelector.setOnClickListener &#123; item -&gt;</span><br><span class="line">            <span class="comment">// Update the UI</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DetailFragment</span> : <span class="type">Fragment</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> model: SharedViewModel</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        model = activity?.run &#123;</span><br><span class="line">            ViewModelProviders.of(<span class="keyword">this</span>).<span class="keyword">get</span>(SharedViewModel::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line">        &#125; ?: <span class="keyword">throw</span> Exception(<span class="string">"Invalid Activity"</span>)</span><br><span class="line">        model.selected.observe(<span class="keyword">this</span>, Observer&lt;Item&gt; &#123; item -&gt;</span><br><span class="line">            <span class="comment">// Update the UI</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¦æ³¨æ„çš„æ˜¯ä¸¤ä¸ª fragment åœ¨è·å– <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModelProvider.html" target="_blank" rel="noopener">ViewModelProvider</a> çš„æ—¶å€™éƒ½ä½¿ç”¨ <a href="https://developer.android.com/reference/android/app/Fragment.html#getActivity(" target="_blank" rel="noopener"><code>getActivity()</code></a>)ã€‚ç»“æœï¼Œä¸¤ä¸ª fragment éƒ½æ¥å—ä¸€ä¸ªç›¸åŒçš„ <code>SharedViewModel</code> å®åŠ›ï¼Œå®ƒçš„èŒƒå›´æ˜¯ activityã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•æœ‰ä¸‹é¢å‡ ä¸ªå¥½å¤„ï¼š</p>
<ul>
<li>Activity ä¸éœ€è¦åšä»»ä½•äº‹æƒ…ï¼Œæˆ–è€…çŸ¥é“å…³äºè¿™ä¸ªé€šä¿¡çš„ä»»ä½•äº‹æƒ…</li>
<li>Fragments ä¸éœ€è¦çŸ¥é“äº’ç›¸ä¹‹é—´é™¤äº† <code>SharedViewModel</code> å¥‘çº¦çš„å…¶å®ƒä»»ä½•äº‹æƒ…ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ª fragments æ¶ˆå¤±äº†ï¼Œå¦ä¸€ä¸ªç…§å¸¸ä¿æŒå·¥ä½œã€‚</li>
<li>æ¯ä¸€ä¸ª fragments éƒ½æœ‰å®ƒè‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸å—åˆ°å¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸçš„å½±å“ã€‚å¦‚æœä¸€ä¸ª fragment replace å¦å¤–ä¸€ä¸ªï¼ŒUI ä¼šç»§ç»­å·¥ä½œï¼Œä¸ä¼šæœ‰é—®é¢˜ã€‚</li>
</ul>
<h2 id="ä½¿ç”¨-ViewModel-æ›¿æ¢-Loaders"><a href="#ä½¿ç”¨-ViewModel-æ›¿æ¢-Loaders" class="headerlink" title="ä½¿ç”¨ ViewModel æ›¿æ¢ Loaders"></a>ä½¿ç”¨ ViewModel æ›¿æ¢ Loaders</h2><p>Loader ç±»ï¼Œæ¯”å¦‚ <a href="https://developer.android.com/reference/android/content/CursorLoader.html" target="_blank" rel="noopener"><code>CursorLoader</code></a>ï¼Œä¼šé¢‘ç¹åœ°ä½¿ç”¨æ¥ä¿æŒ app ä¸­çš„ UI æ•°æ®ä¸æ•°æ®åº“ä¿æŒåŒæ­¥ã€‚ä½ å¯ä»¥é€šè¿‡å‡ ä¸ªå…¶å®ƒç±»ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> æ¥æ›¿æ¢ loaderã€‚ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ä»æ•°æ®åŠ è½½æ“ä½œä¸­éš”ç¦»ä½ çš„ UI controllerï¼Œè¿™æ„å‘³ç€ä½ åœ¨è¿™äº›ç±»ä¸­æ‹¥æœ‰æ›´å°‘çš„å¼ºå¼•ç”¨ã€‚</p>
<p>åœ¨ä¸€ä¸ªä½¿ç”¨ loaders çš„å¸¸ç”¨æ–¹æ³•ï¼Œapp å¯èƒ½ä½¿ç”¨ <a href="https://developer.android.com/reference/android/content/CursorLoader.html" target="_blank" rel="noopener"><code>CursorLoader</code></a> æ¥è§‚å¯Ÿæ•°æ®åº“çš„å†…å®¹ã€‚å½“æ•°æ®åº“ä¸­çš„å€¼å‘ç”Ÿæ”¹å˜ï¼Œloader ä¼šè‡ªåŠ¨è§¦å‘ä¸€ä¸ªé‡æ–°åŠ åœ¨å¹¶æ›´æ–° UIï¼š</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/48879871-c41b9c80-ee48-11e8-8b26-c051ca94d272.png" width="600px/"><br></div>

<p><a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ä¸ <a href="https://developer.android.com/topic/libraries/architecture/room.html" target="_blank" rel="noopener">Room</a> å’Œ <a href="https://developer.android.com/topic/libraries/architecture/livedata.html" target="_blank" rel="noopener">LiveData</a> ä¸€èµ·ä½¿ç”¨æ¥æ›¿æ¢ loaderã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ç¡®ä¿æ•°æ®åœ¨è®¾å¤‡é…ç½®æ”¹å˜æ—¶å­˜æ´»ã€‚<a href="https://developer.android.com/topic/libraries/architecture/room.html" target="_blank" rel="noopener">Room</a> ä¼šåœ¨æ•°æ®åº“å‘ç”Ÿæ”¹å˜æ—¶é€šçŸ¥ä½ çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a>ï¼Œç„¶å <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener">LiveData</a> åè¿‡æ¥ä½¿ç”¨æœ€æ–°çš„æ•°æ®æ›´æ–°ä½ çš„ UIã€‚</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/48880164-1c06d300-ee4a-11e8-98b1-cc4dad768914.png" width="600px/"><br></div>

<h2 id="é¢å¤–èµ„æº"><a href="#é¢å¤–èµ„æº" class="headerlink" title="é¢å¤–èµ„æº"></a>é¢å¤–èµ„æº</h2><p><a href="https://medium.com/google-developers/lifecycle-aware-data-loading-with-android-architecture-components-f95484159de4" target="_blank" rel="noopener">æœ¬æ–‡</a> æè¿°äº†å¦‚ä½•ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å’Œ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> æ¥æ›¿æ¢ <a href="https://developer.android.com/reference/android/content/AsyncTaskLoader.html" target="_blank" rel="noopener"><code>AsyncTaskLoader</code></a>ã€‚</p>
<p>å½“ä½ çš„æ•°æ®å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œä½ å¯ä»¥é€‰æ‹©ç”¨ä¸€ä¸ªå•ç‹¬çš„ç±»ä¸“é—¨ç”¨æ¥åŠ è½½æ•°æ®ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> çš„ç›®çš„æ˜¯ä¸º UI Controller å°è£…æ•°æ®ï¼Œä½¿å¾—å½“è®¾ç½®é…ç½®æ”¹å˜æ—¶è®©æ•°æ®å­˜æ´»ã€‚æ›´å¤šå…³äºè·¨é…ç½®æ”¹å˜å»åŠ è½½ï¼ŒæŒä¹…åŒ–ï¼Œç®¡ç†æ•°æ®çš„è¯¦æƒ…ï¼Œè§ <a href="https://developer.android.com/topic/libraries/architecture/saving-states.html" target="_blank" rel="noopener">ä¿å­˜ UI çŠ¶æ€</a>ã€‚</p>
<p><a href="https://developer.android.com/topic/libraries/architecture/guide.html#fetching_data" target="_blank" rel="noopener">Android App Architecture æŒ‡å—</a> å»ºè®®æ„å»ºä¸€ä¸ª repository ç±»æ¥å¤„ç†è¿™äº›å‡½æ•°ã€‚</p>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> è¢«ç”¨åœ¨ Android ç”Ÿå‘½å‘¨æœŸ <a href="https://codelabs.developers.google.com/codelabs/android-lifecycles/#0" target="_blank" rel="noopener">codelab</a> å’Œ <a href="https://github.com/googlesamples/android-sunflower" target="_blank" rel="noopener">Sunflower</a> demo appã€‚ä¹Ÿå¯ä»¥å‚é˜… Architecture Components <a href="https://github.com/googlesamples/android-architecture-components/tree/master/BasicSample" target="_blank" rel="noopener">BasicSample</a>ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component Lifecycleï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_lifecycle/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-Lifecycleï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-Lifecycleï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component Lifecycleï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component Lifecycleï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/architecture/lifecycle" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/architecture/lifecycle</a></p>
</blockquote>
<p>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„ç»„ä»¶æ‰§è¡Œè¡Œä¸ºä»¥å“åº”å¦ä¸€ä¸ªç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€çš„å˜åŒ–ï¼Œæ¯”å¦‚ activities å’Œ fragmentsã€‚è¿™äº›ç»„ä»¶å¯ä»¥å¸®åŠ©ä½ ç”Ÿäº§æ›´å¥½çš„ç»„ç»‡ç»“æ„ï¼Œé€šå¸¸æ˜¯æ›´å®¹æ˜“ç»´æŠ¤çš„è½»é‡ä»£ç ã€‚</p>
<p>ä¸€ç§å¸¸è§çš„æ¨¡å¼æ˜¯åœ¨ activity å’Œ fragment çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­å®ç°ä¾èµ–ç»„ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œè¿™ç§æ¨¡å¼ä¼šå¯¼è‡´è¾ƒå·®çš„ä»£ç ç»„ç»‡ï¼Œå¹¶å¯¼è‡´é”™è¯¯æ¿€å¢ã€‚é€šè¿‡ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„ç»„ä»¶ï¼Œä½ å¯ä»¥å°†ç›¸å…³ç»„ä»¶çš„ä»£ç ä»ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­ç§»åŠ¨åˆ°ç»„ä»¶æœ¬èº«ä¸­å»ã€‚</p>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/package-summary.html" target="_blank" rel="noopener"><code>android.arch.lifecycle</code></a> åŒ…æä¾›äº†ç±»å’Œæ¥å£è®©ä½ å»æ„å»º <em>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</em> ç»„ä»¶ â€”â€” å®ƒä»¬æ˜¯èƒ½åŸºäºå½“å‰ activity æˆ– fragment ç”Ÿå‘½å‘¨æœŸçŠ¶æ€æ¥è‡ªåŠ¨è°ƒæ•´å®ƒä»¬è¡Œä¸ºçš„ç»„ä»¶ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šè¦å¯¼å…¥ <a href="https://developer.android.com/reference/android/arch/lifecycle/package-summary.html" target="_blank" rel="noopener">android.arch.lifecycle</a> åˆ°ä½ çš„ Android é¡¹ç›®ï¼Œå¯å‚é˜… <a href="https://blog.wangjiegulu.com/2018/04/15/android_architecture_components_overview/#Lifecycle">å¢åŠ  components åˆ°ä½ çš„é¡¹ç›®ä¸­</a>ã€‚</p>
</blockquote>
<p>åœ¨ Android Framework ä¸­å®šä¹‰çš„å¤§éƒ¨åˆ† app components éƒ½é™„åŠ äº† lifecycleã€‚Lifecycles æ˜¯è¢«æ“ä½œç³»ç»Ÿæˆ–è€…ä½ è¿›ç¨‹ä¸­çš„è¿è¡Œçš„ framework ä»£ç æ‰€ç®¡ç†ã€‚å®ƒä»¬æ˜¯ android å·¥ä½œåŸç†çš„æ ¸å¿ƒï¼Œä½ çš„åº”ç”¨ç¨‹åºå¿…é¡»å…³å¿ƒå®ƒä»¬ã€‚å¦‚æœä¸è¿™ä¹ˆåšï¼Œå¯èƒ½ä¼šè§¦å‘å†…å­˜æ³„æ¼æˆ–è€…ç”šè‡³æ˜¯åº”ç”¨å´©æºƒã€‚</p>
<p>æƒ³è±¡æˆ‘ä»¬æœ‰ä¸€ä¸ª activityï¼Œå®ƒåœ¨å±å¹•ä¸Šæ˜¾ç¤ºè®¾å¤‡çš„ä½ç½®ä¿¡æ¯ã€‚ä¸€ä¸ªå¸¸ç”¨çš„å®ç°å¯èƒ½å¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLocationListener</span></span>(</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> context: Context,</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> callback: (Location) -&gt; <span class="built_in">Unit</span></span><br><span class="line">) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">start</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// connect to system location service</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// disconnect from system location service</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> myLocationListener: MyLocationListener</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(...)</span></span> &#123;</span><br><span class="line">        myLocationListener = MyLocationListener(<span class="keyword">this</span>) &#123; location -&gt;</span><br><span class="line">            <span class="comment">// update UI</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStart</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onStart()</span><br><span class="line">        myLocationListener.start()</span><br><span class="line">        <span class="comment">// manage other components that need to respond</span></span><br><span class="line">        <span class="comment">// to the activity lifecycle</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStop</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onStop()</span><br><span class="line">        myLocationListener.stop()</span><br><span class="line">        <span class="comment">// manage other components that need to respond</span></span><br><span class="line">        <span class="comment">// to the activity lifecycle</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°½ç®¡è¿™ä¸ªä¾‹å­çœ‹èµ·æ¥ä¸é”™ï¼Œåœ¨å®é™…çš„ app ä¸­ï¼Œä½ æœ€ç»ˆä¼šæœ‰å¤ªå¤šçš„è°ƒç”¨æ¥ç®¡ç† UI å’Œå…¶å®ƒç»„ä»¶æ¥å“åº”ç”Ÿå‘½å‘¨æœŸçš„å½“å‰çŠ¶æ€ã€‚ç®¡ç†å¤šä¸ªç»„ä»¶ä¼šåœ¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­æ”¾ç½®å¤§é‡ä»£ç ï¼Œæ¯”å¦‚ <a href="https://developer.android.com/reference/android/app/Activity.html#onStart(" target="_blank" rel="noopener"><code>onStart()</code></a>) å’Œ <a href="https://developer.android.com/reference/android/app/Activity.html#onStop(" target="_blank" rel="noopener"><code>onStop()</code></a>)ï¼Œå®ƒä¼šå¯¼è‡´éš¾ä»¥ç»´æŠ¤çš„é—®é¢˜ã€‚</p>
<p>æ­¤å¤–ï¼Œè¿˜ä¸èƒ½ä¿è¯ç»„ä»¶åœ¨ activity æˆ–è€… fragment åœ¨åœæ­¢ä¹‹å‰å¯åŠ¨ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦æ‰§è¡Œé•¿æ—¶é—´è¿è¡Œçš„æ“ä½œçš„æ—¶å€™å°¤å…¶å¦‚æ­¤ã€‚æ¯”å¦‚åœ¨ <a href="https://developer.android.com/reference/android/app/Activity.html#onStart(" target="_blank" rel="noopener"><code>onStart()</code></a>) ä¸­æ‰§è¡Œä¸€äº›é…ç½®æ£€æŸ¥ã€‚<a href="https://developer.android.com/reference/android/app/Activity.html#onStop(" target="_blank" rel="noopener"><code>onStop()</code></a>) æ–¹æ³•åœ¨ <a href="https://developer.android.com/reference/android/app/Activity.html#onStart(" target="_blank" rel="noopener"><code>onStart()</code></a>) ä¹‹å‰å®Œæˆè¿™ç‚¹å¯èƒ½ä¼šå¼•èµ·äº‰ç”¨æ¡ä»¶ï¼Œä½¿å¾—ç»„ä»¶çš„ç”Ÿå­˜æœŸè¶…è¿‡æ‰€éœ€çš„æ—¶é—´ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> myLocationListener: MyLocationListener</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(...)</span></span> &#123;</span><br><span class="line">        myLocationListener = MyLocationListener(<span class="keyword">this</span>) &#123; location -&gt;</span><br><span class="line">            <span class="comment">// update UI</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStart</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onStart()</span><br><span class="line">        Util.checkUserStatus &#123; result -&gt;</span><br><span class="line">            <span class="comment">// what if this callback is invoked AFTER activity is stopped?</span></span><br><span class="line">            <span class="keyword">if</span> (result) &#123;</span><br><span class="line">                myLocationListener.start()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStop</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onStop()</span><br><span class="line">        myLocationListener.stop()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/package-summary.html" target="_blank" rel="noopener"><code>android.arch.lifecycle</code></a> åŒ…æä¾›çš„ç±»å’Œæ¥å£å¯ä»¥å¸®åŠ©ä½ ä½¿ç”¨å¼¹æ€§å’Œç‹¬ç«‹çš„æ–¹å¼è§£å†³è¿™äº›é—®é¢˜ã€‚</p>
<h2 id="Lifecycle"><a href="#Lifecycle" class="headerlink" title="Lifecycle"></a>Lifecycle</h2><p><a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> è¿™ä¸ªç±»æŒæœ‰äº†å…³äºç»„ä»¶ï¼ˆæ¯”å¦‚ activity å’Œ fragmentï¼‰ç”Ÿå‘½å‘¨æœŸçŠ¶æ€çš„ä¿¡æ¯ï¼Œå¹¶å…è®¸å…¶å®ƒå¯¹è±¡è§‚å¯Ÿè¿™ä¸ªçŠ¶æ€ã€‚</p>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> ä½¿ç”¨ä¸¤ç§ä¸»è¦çš„æšä¸¾æ¥è¿½è¸ªå…³è”ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ï¼š</p>
<ul>
<li><p><strong>Event</strong></p>
<p>ç”Ÿå‘½å‘¨æœŸ event ä» framework å’Œ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> ç±»ä¸­æ´¾å‘ã€‚è¿™äº›äº‹ä»¶åœ¨ activities å’Œ fragments ä¸­æ˜ å°„åˆ°å›è°ƒ events ä¸­ã€‚</p>
</li>
<li><p><strong>State</strong></p>
<p>ç»„ä»¶é€šè¿‡ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> å¯¹è±¡è¿½è¸ªçš„å½“å‰çŠ¶æ€ã€‚</p>
</li>
</ul>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/48882877-e36df600-ee57-11e8-91df-117c02e796ee.png" width="600px/"><br></div>

<p>å°† states è§†ä¸ºå›¾å½¢çš„èŠ‚ç‚¹ï¼Œå°† events è§†ä¸ºè¿™äº›èŠ‚ç‚¹ä¹‹é—´çš„è¾¹ã€‚</p>
<p>ä¸€ä¸ªç±»å¯ä»¥é€šè¿‡åœ¨å®ƒæ–¹æ³•ä¸Šå¢åŠ ä¸€äº›æ³¨è§£æ¥æ¨¡æ‹Ÿç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ã€‚ç„¶åä½ å¯ä»¥é€šè¿‡è°ƒç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> ç±»çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html#addObserver(android.arch.lifecycle.LifecycleObserver" target="_blank" rel="noopener"><code>addObserver()</code></a>) æ–¹æ³•å¹¶ä¼ å…¥ä¸€ä¸ª observer çš„å®ä¾‹æ¥å¢åŠ ä¸€ä¸ª observerï¼Œå¦‚ä¸‹ä¾‹å­æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyObserver</span> : <span class="type">LifecycleObserver &#123;</span></span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@OnLifecycleEvent(Lifecycle.Event.ON_RESUME)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">connectListener</span><span class="params">()</span></span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OnLifecycleEvent(Lifecycle.Event.ON_PAUSE)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">disconnectListener</span><span class="params">()</span></span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œ<code>myLifecycleOwner</code> å¯¹è±¡å®ç°äº† <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener"><code>LifecycleOwner</code></a> æ¥å£ï¼Œå®ƒä¼šåœ¨é¢å†è¯¦ç»†è¯´æ˜ã€‚</p>
<h2 id="LifecycleOwner"><a href="#LifecycleOwner" class="headerlink" title="LifecycleOwner"></a>LifecycleOwner</h2><p><a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener"><code>LifecycleOwner</code></a> æ˜¯ä¸€ä¸ªå•æ–¹æ³•çš„æ¥å£ï¼Œè¡¨ç¤ºè¿™ä¸ªç±»æœ‰ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener">Lifecycle</a>ã€‚å®ƒæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œ<a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html#getLifecycle(" target="_blank" rel="noopener"><code>getLifecycle()</code></a>)ï¼Œå®ƒå¿…é¡»ç”±ç±»å»å®ç°ã€‚å¦‚æœä½ å°è¯•ç®¡ç†æ•´ä¸ªåº”ç”¨ç¨‹åºè¿›ç¨‹çš„ lifecycleï¼Œè§ <a href="https://developer.android.com/reference/android/arch/lifecycle/ProcessLifecycleOwner.html" target="_blank" rel="noopener"><code>ProcessLifecycleOwner</code></a>ã€‚</p>
<p>è¿™ä¸ªæ¥å£æŠ½è±¡äº†å•ç‹¬çš„ç±»ï¼Œæ¯”å¦‚ <a href="https://developer.android.com/reference/android/support/v4/app/Fragment.html" target="_blank" rel="noopener"><code>Fragment</code></a> å’Œ <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html" target="_blank" rel="noopener"><code>AppCompatActivity</code></a> çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> æ‰€æœ‰æƒï¼Œå…è®¸ç¼–å†™ç»„ä»¶æ¥è·Ÿå®ƒä»¬ä¸€èµ·å·¥ä½œã€‚ä»»ä½•è‡ªå®šä¹‰çš„åº”ç”¨ç±»éƒ½å¯ä»¥å®ç° <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener"><code>LifecycleOwner</code></a> æ¥å£ã€‚</p>
<p>å®ç°äº† <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleObserver.html" target="_blank" rel="noopener"><code>LifecycleObserver</code></a> çš„ç»„ä»¶å¯ä»¥æ— ç¼ä¸ <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener"><code>LifecycleOwner</code></a> ä¸€èµ·å·¥ä½œï¼Œå› ä¸ºä¸€ä¸ª owner å¯ä»¥æä¾›ä¸€ä¸ª lifecycleï¼Œobserver å¯ä»¥æ³¨å†Œè§‚å¯Ÿå®ƒã€‚</p>
<p>å¯¹äºä½ç½®è¿½è¸ªçš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è®© <code>MyLocationListener</code> ç±»å®ç° <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleObserver.html" target="_blank" rel="noopener"><code>LifecycleObserver</code></a> å¹¶é€šè¿‡ Activity <a href="https://developer.android.com/reference/android/app/Activity.html#onCreate(android.os.Bundle" target="_blank" rel="noopener"><code>onCreate</code></a>) æ–¹æ³•ä¸­çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> åˆå§‹åŒ–å®ƒã€‚è¿™å…è®¸ <code>MyLocationListener</code> ç±»è‡ªç»™è‡ªè¶³ï¼Œæ„å‘³ç€å¯¹ç”Ÿå‘½å‘¨æœŸçŠ¶æ€å˜åŒ–åšå‡ºååº”çš„é€»è¾‘çš„å£°æ˜æ˜¯åœ¨ <code>MyLocationListener</code> ä¸­ï¼Œè€Œä¸æ˜¯ activityã€‚è®©å„ä¸ªç»„ä»¶å­˜å‚¨è‡ªå·±çš„é€»è¾‘ä½¿ activity å’Œ fragment é€»è¾‘æ›´æ˜“äºç®¡ç†ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> myLocationListener: MyLocationListener</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(...)</span></span> &#123;</span><br><span class="line">        myLocationListener = MyLocationListener(<span class="keyword">this</span>, lifecycle) &#123; location -&gt;</span><br><span class="line">            <span class="comment">// update UI</span></span><br><span class="line">        &#125;</span><br><span class="line">        Util.checkUserStatus &#123; result -&gt;</span><br><span class="line">            <span class="keyword">if</span> (result) &#123;</span><br><span class="line">                myLocationListener.enable()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªå¸¸ç”¨çš„ç”¨ä¾‹æ˜¯ï¼Œå¦‚æœ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> å½“å‰ä¸æ˜¯ä¸€ä¸ªå¥½çš„çŠ¶æ€ï¼Œåˆ™é¿å…è°ƒç”¨æŸäº›å›è°ƒã€‚ä¸¾ä¾‹ï¼Œå¦‚æœå›è°ƒåœ¨ä¿å­˜ activity çŠ¶æ€åè¿è¡Œ fragment äº‹åŠ¡ï¼Œå®ƒå¯èƒ½ä¼šè§¦å‘ä¸€ä¸ªå´©æºƒï¼Œæ‰€ä»¥æˆ‘ä»¬æ°¸è¿œéƒ½ä¸å¸Œæœ›æ‰§è¡Œè¿™ä¸ªå›è°ƒã€‚</p>
<p>ä¸ºäº†è®©ç”¨ä¾‹ç®€å•ï¼Œ<a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> ç±»å…è®¸å…¶å®ƒå¯¹è±¡å»æŸ¥è¯¢å½“å‰çš„çŠ¶æ€ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLocationListener</span></span>(</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> context: Context,</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> lifecycle: Lifecycle,</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">val</span> callback: (Location) -&gt; <span class="built_in">Unit</span></span><br><span class="line">) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> enabled = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@OnLifecycleEvent(Lifecycle.Event.ON_START)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">start</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (enabled) &#123;</span><br><span class="line">            <span class="comment">// connect</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">enable</span><span class="params">()</span></span> &#123;</span><br><span class="line">        enabled = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">if</span> (lifecycle.currentState.isAtLeast(Lifecycle.State.STARTED)) &#123;</span><br><span class="line">            <span class="comment">// connect if not connected</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@OnLifecycleEvent(Lifecycle.Event.ON_STOP)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// disconnect if connected</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡è¿™ä¸ªå®ç°ï¼Œæˆ‘ä»¬çš„ <code>LocationListener</code> ç±»æ˜¯å®Œå…¨ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦ä»å…¶å®ƒçš„ activity å’Œ fragment å»ä½¿ç”¨ <code>LocationListener</code>ï¼Œæˆ‘ä»¬åªéœ€è¦åˆå§‹åŒ–å®ƒã€‚æ‰€æœ‰ setup å’Œ teardown çš„æ“ä½œéƒ½æ˜¯è‡ªå·±ç±»æœ¬èº«ç®¡ç†çš„ã€‚</p>
<p>å¦‚æœåº“æä¾›çš„ç±»éœ€è¦ä¸ Android ç”Ÿå‘½å‘¨æœŸä¸€èµ·ä½¿ç”¨ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„ç»„ä»¶ã€‚ä½ çš„åº“ client ç«¯å¯ä»¥è½»æ¾é›†æˆè¿™äº›ç»„ä»¶ï¼Œè€Œæ— éœ€åœ¨ client ç«¯è¿›è¡Œæ‰‹åŠ¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚</p>
<h3 id="å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„-LifecycleOwner"><a href="#å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„-LifecycleOwner" class="headerlink" title="å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„ LifecycleOwner"></a>å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„ LifecycleOwner</h3><p>åœ¨ Support Library 26.1.0 åŠä»¥ä¸Šç‰ˆæœ¬ï¼ŒFragments å’Œ Activities å·²ç»ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener"><code>LifecycleOwner</code></a> æ¥å£å®ç°ã€‚</p>
<p>å¦‚æœä½ è¦è‡ªå®šä¹‰ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener"><code>LifecycleOwner</code></a> çš„ç±»ï¼Œä½ å¯ä»¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleRegistry.html" target="_blank" rel="noopener">LifecycleRegistry</a> ç±»ï¼Œä½†æ˜¯éœ€è¦åœ¨è¿™ä¸ª class ä¸­è½¬å‘ eventsï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyActivity</span> : <span class="type">AppCompatActivity</span></span>(), LifecycleOwner &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> mLifecycleRegistry: LifecycleRegistry</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">        mLifecycleRegistry = LifecycleRegistry(<span class="keyword">this</span>)</span><br><span class="line">        mLifecycleRegistry.markState(Lifecycle.State.CREATED)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onStart</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onStart()</span><br><span class="line">        mLifecycleRegistry.markState(Lifecycle.State.STARTED)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getLifecycle</span><span class="params">()</span></span>: Lifecycle &#123;</span><br><span class="line">        <span class="keyword">return</span> mLifecycleRegistry</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶çš„æœ€ä½³å®è·µ"><a href="#ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶çš„æœ€ä½³å®è·µ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶çš„æœ€ä½³å®è·µ"></a>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶çš„æœ€ä½³å®è·µ</h2><ul>
<li>ä¿æŒä½ çš„ UI Controllers ï¼ˆactivities å’Œ fragmentsï¼‰å°½å¯èƒ½ç®€æ´ã€‚å®ƒä»¬ä¸åº”è¯¥å»å°è¯•è·å–å®ƒä»¬è‡ªå·±çš„æ•°æ®ã€‚è€Œæ˜¯åº”è¯¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å»åšï¼Œç„¶åè§‚å¯Ÿä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡å»å“åº”å¯¹ view çš„æ›´æ”¹ã€‚</li>
<li>åœ¨ä½ çš„ UI Controllers ä¸­å°è¯•ç¼–å†™æ•°æ®é©±åŠ¨çš„ UIï¼Œå®ƒè´Ÿè´£åœ¨æ•°æ®æ”¹å˜æ—¶æ›´æ–° viewsï¼Œæˆ–è€…é€šçŸ¥ç”¨æˆ·çš„è¡Œä¸ºç»™ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a>ã€‚</li>
<li>æŠŠæ•°æ®é€»è¾‘ä»£ç æ”¾åœ¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ç±»ä¸­ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> åº”è¯¥ä½œä¸º UI Controller å’Œ app å…¶ä½™éƒ¨åˆ†ä¹‹é—´çš„è¿æ¥å™¨ã€‚ä¸è¿‡è¦å°å¿ƒï¼Œ<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ä¸è´Ÿè´£å»è·å–æ•°æ®ï¼ˆæ¯”å¦‚ï¼Œä»ç½‘ç»œï¼‰ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> åº”è¯¥è°ƒç”¨é€‚å½“çš„ç»„ä»¶å»è·å–æ•°æ®ï¼Œç„¶åæä¾›ç»“æœç»™ UI Controllerã€‚</li>
<li>ä½¿ç”¨ <a href="https://developer.android.com/topic/libraries/data-binding/index.html" target="_blank" rel="noopener">Data Binding</a> åœ¨ä½ çš„ views å’Œ UI Controller ä¹‹é—´å»ç»´æŠ¤ä¸€ä¸ªæ¸…æ™°çš„æ¥å£ã€‚è¿™è®©ä½ å¯ä»¥ä½¿ä½ çš„ views æ›´å…·å£°æ˜æ€§ï¼Œå¹¶æœ€å¤§é™åº¦åœ°å‡å°‘ä½ éœ€è¦åœ¨ activities å’Œ fragments ä¸­ç¼–å†™çš„æ›´æ–°ä»£ç ã€‚å¦‚æœè¿˜æ˜¯å¸Œæœ›ä½¿ç”¨ Java è¯­è¨€æ¥åšè¿™äº›ï¼Œä½¿ç”¨åƒ <a href="http://jakewharton.github.io/butterknife/" target="_blank" rel="noopener">Butter Knife</a> çš„åº“æ¥é¿å…æ¨¡ç‰ˆä»£ç å’Œåšæ›´å¥½çš„æŠ½è±¡ã€‚</li>
<li>å¦‚æœä½ çš„ UI æ˜¯å¤æ‚çš„ï¼Œè€ƒè™‘åˆ›å»ºä¸€ä¸ª <a href="http://www.gwtproject.org/articles/mvp-architecture.html#presenter" target="_blank" rel="noopener">presenter</a> ç±»æ¥å¤„ç† UI æ”¹åŠ¨ã€‚è¿™å¯èƒ½æ˜¯ä¸ªè´¹åŠ›çš„ä»»åŠ¡ï¼Œä½†æ˜¯å®ƒä¼šè®©ä½ çš„ UI ç»„ä»¶å˜å¾—æ›´å®¹æ˜“æµ‹è¯•ã€‚   </li>
<li>é¿å…åœ¨ä½ çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ä¸­å¼•ç”¨ <a href="https://developer.android.com/reference/android/view/View.html" target="_blank" rel="noopener"><code>View</code></a> å’Œ <a href="https://developer.android.com/reference/android/app/Activity.html" target="_blank" rel="noopener"><code>Activity</code></a> contextã€‚å¦‚æœ <code>ViewModel</code> å¯¿å‘½æ¯” activity é•¿ï¼ˆæ¯”å¦‚é…ç½®æ”¹å˜çš„æƒ…å†µï¼‰ï¼Œä½ çš„ activity ä¼šæ³„æ¼å¹¶ä¸” gc ä¸ä¼šæ­£ç¡®å¤„ç†å®ƒã€‚</li>
</ul>
<h2 id="ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶çš„ç”¨ä¾‹"><a href="#ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶çš„ç”¨ä¾‹" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶çš„ç”¨ä¾‹"></a>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶çš„ç”¨ä¾‹</h2><p>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶å¯ä»¥è®©ä½ åœ¨å„ç§æƒ…å†µä¸‹æ›´è½»æ¾åœ°ç®¡ç†ç”Ÿå‘½å‘¨æœŸã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªä¾‹å­ï¼š</p>
<ul>
<li>åœ¨ç²—ç²’åº¦å’Œç»†ç²’åº¦çš„ä½ç½®æ›´æ–°ä¹‹é—´åˆ‡æ¢ã€‚ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶ï¼Œåœ¨ä½ç½®åº”ç”¨å¯è§æ—¶å¯ç”¨ç»†ç²’åº¦ä½ç½®æ›´æ–°ï¼Œå¹¶åœ¨åº”ç”¨å¤„äºåå°æ—¶åˆ‡æ¢åˆ°ç²—ç²’åº¦æ›´æ–°ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a>ï¼Œä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„ç»„ä»¶ï¼Œå½“ä½ çš„ç”¨æˆ·æ”¹å˜ä½ç½®æ—¶ï¼Œå…è®¸ä½ çš„ app è‡ªåŠ¨æ›´æ–° UIã€‚</li>
<li>åœæ­¢å’Œå¯åŠ¨è§†é¢‘ç¼“å†²ã€‚ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶æ¥å°½å¯èƒ½å¿«åœ°å¼€å§‹è§†é¢‘ç¼“å†²ï¼Œä½†ä¼šæ¨è¿Ÿæ’­æ”¾ï¼Œç›´åˆ°åº”ç”¨ç¨‹åºå®Œå…¨å¯åŠ¨ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶åœ¨åº”ç”¨è¢«é”€æ¯æ—¶ç»ˆæ­¢ç¼“å†²ã€‚</li>
<li>å¯åŠ¨å’Œåœæ­¢ç½‘ç»œè¿æ¥ã€‚ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶å½“ app åœ¨å‰å°æ—¶å¯ç”¨ç½‘ç»œæ•°æ®çš„å®æ—¶æ›´æ–°ï¼ˆæµï¼‰ï¼Œä¹Ÿåœ¨ app è¿›å…¥åˆ°åå°çš„æ—¶å€™è‡ªåŠ¨æš‚åœã€‚</li>
<li>æš‚åœå’Œæ¢å¤åŠ¨ç”»ç»˜å›¾ã€‚ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶å½“ app åœ¨åå°æ—¶æš‚åœåŠ¨ç”»ç»˜åˆ¶ï¼Œå½“ app åœ¨å‰å°æ—¶æ¢å¤ç»˜åˆ¶ã€‚</li>
</ul>
<h2 id="å¯¹åœæ­¢äº‹ä»¶çš„å¤„ç†"><a href="#å¯¹åœæ­¢äº‹ä»¶çš„å¤„ç†" class="headerlink" title="å¯¹åœæ­¢äº‹ä»¶çš„å¤„ç†"></a>å¯¹åœæ­¢äº‹ä»¶çš„å¤„ç†</h2><p>å½“ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> å±äºä¸€ä¸ª <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html" target="_blank" rel="noopener"><code>AppCompatActivity</code></a> æˆ–è€… <a href="https://developer.android.com/reference/android/support/v4/app/Fragment.html" target="_blank" rel="noopener"><code>Fragment</code></a>ï¼Œå½“  <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html" target="_blank" rel="noopener"><code>AppCompatActivity</code></a> æˆ–è€… <a href="https://developer.android.com/reference/android/support/v4/app/Fragment.html" target="_blank" rel="noopener"><code>Fragment</code></a> çš„ <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html#onSaveInstanceState(android.os.Bundle" target="_blank" rel="noopener"><code>onSaveInstanceState()</code></a>) è¢«è°ƒç”¨æ—¶ï¼Œäº‹ä»¶è¢«æ´¾å‘ï¼Œä½¿å¾—<a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> çš„çŠ¶æ€å˜ä¸º <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#CREATED" target="_blank" rel="noopener"><code>CREATED</code></a> å’Œ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.Event.html#ON_STOP" target="_blank" rel="noopener"><code>ON_STOP</code></a>ã€‚</p>
<p>å½“ <a href="https://developer.android.com/reference/android/support/v4/app/Fragment.html" target="_blank" rel="noopener"><code>Fragment</code></a> æˆ–è€… <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html" target="_blank" rel="noopener"><code>AppCompatActivity</code></a> çš„çŠ¶æ€è¢«ä¿å­˜åœ¨ <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html#onSaveInstanceState(android.os.Bundle" target="_blank" rel="noopener"><code>onSaveInstanceState()</code></a>)ï¼Œå®ƒçš„ UI è¢«è®¤ä¸ºæ˜¯ä¸å¯å˜çš„ï¼Œç›´åˆ° <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.Event.html#ON_START" target="_blank" rel="noopener"><code>ON_START</code></a> è¢«è°ƒç”¨ã€‚åœ¨ä¿å­˜çŠ¶æ€åå°è¯•ä¿®æ”¹ UI å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºçš„å¯¼èˆªçŠ¶æ€ä¸ä¸€è‡´ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå½“åº”ç”¨åœ¨ä¿å­˜çŠ¶æ€åè¿è¡Œ <a href="https://developer.android.com/reference/android/support/v4/app/FragmentTransaction.html" target="_blank" rel="noopener"><code>FragmentTransaction</code></a> æ—¶ï¼Œ<a href="https://developer.android.com/reference/android/support/v4/app/FragmentManager.html" target="_blank" rel="noopener"><code>FragmentManager</code></a> å°†å¼•å‘å¼‚å¸¸çš„åŸå› ã€‚è¯¦æƒ…è§ <a href="https://developer.android.com/reference/android/support/v4/app/FragmentTransaction.html#commit(" target="_blank" rel="noopener"><code>commit()</code></a>)ã€‚</p>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> é˜²æ­¢è¿™ç§è¾¹ç•Œæƒ…å†µå‘ç”Ÿï¼Œå®ƒé€šè¿‡å½“ observer å…³è”çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> ä¸æ˜¯è‡³å°‘æ˜¯ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#STARTED" target="_blank" rel="noopener"><code>STARTED</code></a>ï¼Œåˆ™é¿å…è°ƒç”¨å®ƒçš„ observerã€‚åœ¨å¹•åï¼Œå®ƒåœ¨å†³å®šè°ƒç”¨ obserfver ä¹‹å‰è°ƒç”¨äº† <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#isAtLeast(android.arch.lifecycle.Lifecycle.State" target="_blank" rel="noopener"><code>isAtLeast()</code></a>)ã€‚</p>
<p>ä¸å¹¸çš„æ˜¯ï¼Œ<a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html" target="_blank" rel="noopener"><code>AppCompatActivity</code></a> çš„ <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html#onStop(" target="_blank" rel="noopener"><code>onStop()</code></a>) æ–¹æ³•æ˜¯åœ¨ <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html#onSaveInstanceState(android.os.Bundle" target="_blank" rel="noopener"><code>onSaveInstanceState()</code></a>) ä¹‹åï¼Œè¿™å°±ç•™ä¸‹äº†ä¸€ä¸ªç©ºéš™ï¼Œå³ä¸å…è®¸ UI çŠ¶æ€æ”¹å˜ï¼Œä½†ç”Ÿå‘½å‘¨æœŸè¿˜æœªåˆ° <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#CREATED" target="_blank" rel="noopener"><code>CREATED</code></a> çŠ¶æ€ã€‚</p>
<p>ä¸ºäº†é˜²æ­¢è¿™ä¸ªé—®é¢˜ï¼Œ<a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> ç±»åœ¨ç‰ˆæœ¬ <code>beta2</code> åŠä»¥ä¸‹æ ‡è®°çŠ¶æ€ä¸º <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#CREATED" target="_blank" rel="noopener"><code>CREATED</code></a> è€Œä¸ç»è¿‡äº‹ä»¶æ´¾å‘ï¼Œæ‰€ä»¥æ£€æŸ¥å½“å‰çŠ¶æ€çš„ä»»ä½•ä»£ç éƒ½ä¼šè·å¾—çœŸæ­£çš„å€¼ï¼Œå³ä½¿åœ¨ <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html#onStop(" target="_blank" rel="noopener"><code>onStop()</code></a>) è¢«ç³»ç»Ÿè°ƒç”¨ä¹‹å‰ï¼Œè¯¥äº‹ä»¶æ‰è¢«è°ƒåº¦ã€‚</p>
<p>ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªè§£å†³æ–¹æ¡ˆä¼šæœ‰ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜ï¼š</p>
<ul>
<li>åœ¨ API level 23 åŠä»¥ä¸‹ï¼ŒAndroid ç³»ç»Ÿå®é™…ä¸Šä¿å­˜äº†ä¸€ä¸ª activity çš„çŠ¶æ€ï¼Œå³ä½¿å®ƒè¢«å¦ä¸€ä¸ª activity <em>éƒ¨åˆ†</em> è¦†ç›–ã€‚æ¢å¥è¯è¯´ï¼ŒAndroid ç³»ç»Ÿè°ƒç”¨ <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html#onSaveInstanceState(android.os.Bundle" target="_blank" rel="noopener"><code>onSaveInstanceState()</code></a>)ï¼Œä½†æ˜¯å®ƒä¸ä¸€å®šè°ƒç”¨ <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html#onStop(" target="_blank" rel="noopener"><code>onStop()</code></a>)ã€‚è¿™å°†åˆ›å»ºä¸€ä¸ªå¯èƒ½è¾ƒé•¿çš„æ—¶é—´é—´éš”ï¼Œè§‚å¯Ÿè€…ä»ç„¶è®¤ä¸ºç”Ÿå‘½å‘¨æœŸæ˜¯ active çš„ï¼Œå°½ç®¡å®ƒçš„ UI çŠ¶æ€æ— æ³•ä¿®æ”¹ã€‚</li>
<li>ä»»ä½•æƒ³è¦å‘ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> ç±»å…¬å¼€ç±»ä¼¼è¡Œä¸ºçš„ç±»éƒ½å¿…é¡»å®ç°ç”Ÿå‘½å‘¨æœŸ <code>beta2</code> åŠä»¥ä¸‹ç‰ˆæœ¬æä¾›çš„è§£å†³æ–¹æ³•ã€‚</li>
</ul>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šä¸ºäº†ä½¿æ­¤æµç¨‹æ›´ç®€å•ï¼Œå¹¶æä¾›ä¸æ—§ç‰ˆæœ¬æ›´å¥½çš„å…¼å®¹æ€§ï¼Œä»ç‰ˆæœ¬ <strong>1.0.0-rc1</strong> å¼€å§‹ï¼Œ<a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener">Lifecycle</a> å¯¹è±¡åœ¨ <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html#onSaveInstanceState(android.os.Bundle" target="_blank" rel="noopener">onSaveInstanceState()</a>) è¢«è°ƒç”¨ï¼ˆæ²¡æœ‰ç­‰ <a href="https://developer.android.com/reference/android/support/v7/app/AppCompatActivity.html#onStop(" target="_blank" rel="noopener">onStop</a>) æ–¹æ³•è¢«è°ƒç”¨ï¼‰ï¼Œæ´¾å‘æ ‡è®° <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#CREATED" target="_blank" rel="noopener">CREATED</a> å’Œ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.Event.html#ON_STOP" target="_blank" rel="noopener">ON_STOP</a>ã€‚è¿™ä¸å¤ªå¯èƒ½å½±å“ä½ çš„ä»£ç ï¼Œä½†è¿™æ˜¯ä½ éœ€è¦æ³¨æ„çš„ï¼Œå› ä¸ºè¿™ä¸ API level 26 åŠä»¥ä¸‹çš„ <a href="https://developer.android.com/reference/android/app/Activity.html" target="_blank" rel="noopener">Activity</a> ç±»ä¸­è°ƒç”¨é¡ºåºä¸ä¸€è‡´ã€‚</p>
</blockquote>
<h2 id="é¢å¤–èµ„æº"><a href="#é¢å¤–èµ„æº" class="headerlink" title="é¢å¤–èµ„æº"></a>é¢å¤–èµ„æº</h2><p>å°è¯•ç”Ÿå‘½å‘¨æœŸç»„ä»¶ <a href="https://codelabs.developers.google.com/codelabs/android-lifecycles/#0" target="_blank" rel="noopener">codelab</a>ï¼Œå¹¶æŸ¥é˜… Architecture Components <a href="https://github.com/googlesamples/android-architecture-components/tree/master/BasicSample" target="_blank" rel="noopener">BasicSample</a>ã€‚ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ç»„ä»¶ä¹Ÿåœ¨ <a href="https://github.com/googlesamples/android-sunflower" target="_blank" rel="noopener">Sunflower</a> demo app ä¸­ä½¿ç”¨ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component LiveDataï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_livedata/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-LiveDataï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-LiveDataï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component LiveDataï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component LiveDataï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/architecture/livedata" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/architecture/livedata</a></p>
</blockquote>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> æ˜¯ä¸€ä¸ªå¯è§‚å¯Ÿæ•°æ®çš„æŒæœ‰ç±»ã€‚ä¸åƒå¸¸è§„çš„ observableï¼ŒLiveData æ˜¯ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„ï¼Œè¿™æ„å‘³ç€å®ƒå…³å¿ƒå…¶å®ƒ app ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ¯”å¦‚ activitiesï¼Œfragmentsï¼Œæˆ–è€… servicesã€‚è¿™ç§æ„ŸçŸ¥å¯ç¡®ä¿ LiveData ä»…æ›´æ–°å¤„äºæ´»åŠ¨ç”Ÿå‘½å‘¨æœŸçŠ¶æ€çš„ app ç»„ä»¶ observersã€‚</p>
<blockquote>
<p>è¦å¯¼å…¥ LiveData åˆ°ä½ çš„ Android é¡¹ç›®ä¸­ï¼Œè§<a href="https://developer.android.com/topic/libraries/architecture/adding-components.html#lifecycle" target="_blank" rel="noopener">å¢åŠ  Components åˆ°ä½ çš„é¡¹ç›®ä¸­</a></p>
</blockquote>
<p>LiveData è®¤ä¸ºï¼Œå¦‚æœè§‚å¯Ÿè€…çš„ç”Ÿå‘½å‘¨æœŸå¤„äº <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#STARTED" target="_blank" rel="noopener">STARTED</a> æˆ– <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#RESUMED" target="_blank" rel="noopener">RESUME</a> çŠ¶æ€ï¼Œåˆ™è¯¥è§‚å¯Ÿè€… (ä»¥ <a href="https://developer.android.com/reference/android/arch/lifecycle/Observer.html" target="_blank" rel="noopener">Observer</a> ç±»å‘ˆç°) å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚LiveData åªé€šçŸ¥æ´»åŠ¨çŠ¶æ€çš„ observers è¿›è¡Œæ›´æ–°ã€‚æ³¨å†Œåˆ° <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> çš„éæ´»åŠ¨çŠ¶æ€çš„ observers ä¸ä¼šæ¥æ”¶åˆ°æ”¹å˜é€šçŸ¥ã€‚</p>
<p>ä½ å¯ä»¥æ³¨å†Œé…å¯¹ä¸€ä¸ª observer å’Œå®ç°äº† <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener"><code>LifecycleOwner</code></a> æ¥å£çš„å¯¹è±¡ã€‚è¿™ç§å…³ç³»å…è®¸åœ¨ç›¸åº” <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> å¯¹è±¡è¿›å…¥åˆ° <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#DESTROYED" target="_blank" rel="noopener"><code>DESTROYED</code></a> çš„æ—¶å€™åˆ é™¤ç›¸åº”çš„ observerã€‚è¿™å¯¹ activities å’Œ fragments ç‰¹åˆ«æœ‰å¸®åŠ©ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å®‰å…¨åœ°è§‚å¯Ÿ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡ï¼Œå¹¶ä¸”ä¸éœ€è¦å»æ‹…å¿ƒæ³„æ¼ â€”â€” activites å’Œ framgents åœ¨é”€æ¯æ—¶ï¼Œå®ƒä»¬ä¼šç«‹å³è¢«å–æ¶ˆè®¢é˜…ã€‚</p>
<p>å…³äºå¦‚ä½•ä½¿ç”¨ LiveData çš„æ›´å¤šè¯¦æƒ…ï¼Œè§ <a href="https://developer.android.com/topic/libraries/architecture/livedata#work_livedata" target="_blank" rel="noopener">ä½¿ç”¨ LiveData å¯¹è±¡</a>ã€‚</p>
<h2 id="ä½¿ç”¨-LiveData-çš„ä¼˜åŠ¿"><a href="#ä½¿ç”¨-LiveData-çš„ä¼˜åŠ¿" class="headerlink" title="ä½¿ç”¨ LiveData çš„ä¼˜åŠ¿"></a>ä½¿ç”¨ LiveData çš„ä¼˜åŠ¿</h2><p>ä½¿ç”¨ LiveData æä¾›äº†ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li><p>ç¡®ä¿æ‚¨çš„ UI ä¸æ‚¨çš„æ•°æ®çŠ¶æ€ç›¸åŒ¹é…</p>
<p>LiveData éµå¾ªè§‚å¯Ÿè€…æ¨¡å¼ã€‚å½“ç”Ÿå‘½å‘¨æœŸçŠ¶æ€æ”¹å˜æ—¶ï¼ŒLiveData é€šçŸ¥ <a href="https://developer.android.com/reference/android/arch/lifecycle/Observer.html" target="_blank" rel="noopener"><code>Observer</code></a> å¯¹è±¡ã€‚ä½ å¯ä»¥å·©å›ºä½ çš„ä»£ç åœ¨è¿™äº› observer å¯¹è±¡ä¸­æ›´æ–° UIã€‚Observer åœ¨æ¯æ¬¡æœ‰å˜åŒ–æ˜¯æ›´æ–° UIï¼Œè€Œä¸åªæ˜¯åœ¨æ¯æ¬¡ app æ•°æ®å˜åŒ–æ—¶æ›´æ–° UIã€‚</p>
</li>
<li><p>æ²¡æœ‰å†…å­˜æ³„æ¼</p>
<p>Observer ç»‘å®šåˆ° <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> å¯¹è±¡ï¼Œå¹¶åœ¨å…¶å…³è”çš„ç”Ÿå‘½å‘¨æœŸé”€æ¯åè¿›è¡Œæ¸…ç†ã€‚</p>
</li>
<li><p>æ²¡æœ‰å› ä¸º activities åœæ­¢å¯¼è‡´çš„å´©æºƒ</p>
<p>å¦‚æœ Observer çš„ç”Ÿå‘½å‘¨æœŸå¤„äºéæ´»åŠ¨çŠ¶æ€ï¼Œä¾‹å¦‚åœ¨åå°å †æ ˆä¸­çš„æ´»åŠ¨çš„æƒ…å†µä¸‹ï¼Œåˆ™å®ƒä¸ä¼šæ¥æ”¶ä»»ä½• LiveData äº‹ä»¶ã€‚</p>
</li>
<li><p>æ— éœ€æ‰‹åŠ¨çš„ç”Ÿå‘½å‘¨æœŸå¤„ç†</p>
<p>UI ç»„ä»¶åªæ˜¯è§‚å¯Ÿç›¸å…³æ•°æ®ï¼Œä¸ä¼šåœæ­¢æˆ–æ¢å¤è§‚å¯Ÿã€‚LiveData ä¼šè‡ªåŠ¨ç®¡ç†æ‰€æœ‰è¿™äº›ï¼Œå› ä¸ºå®ƒåœ¨è§‚å¯Ÿæ—¶äº†è§£ç›¸å…³çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€æ›´æ”¹ã€‚</p>
</li>
<li><p>å§‹ç»ˆæ˜¯æœ€æ–°çš„æ•°æ®</p>
<p>å¦‚æœç”Ÿå‘½å‘¨æœŸå˜ä¸ºéæ´»åŠ¨çŠ¶æ€ï¼Œå®ƒå°†åœ¨å†æ¬¡å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶æ¥æ”¶æœ€æ–°æ•°æ®ã€‚ä¾‹å¦‚ï¼Œåå°çš„æ´»åŠ¨åœ¨è¿”å›åˆ°å‰å°åç«‹å³æ¥æ”¶æœ€æ–°æ•°æ®ã€‚</p>
</li>
<li><p>æ­£ç¡®çš„é…ç½®æ›´æ”¹</p>
<p>å¦‚æœç”±äºé…ç½®æ›´æ”¹ï¼Œæ¯”å¦‚è®¾å¤‡æ—‹è½¬ï¼Œè€Œé‡æ–°åˆ›å»º activity æˆ– fragmentï¼Œå®ƒå°†ç«‹å³æ¥æ”¶æœ€æ–°çš„å¯ç”¨æ•°æ®ã€‚</p>
</li>
<li><p>å…±äº«èµ„æº</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼æ‰©å±• <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡æ¥åŒ…è£…ç³»ç»ŸæœåŠ¡ï¼Œä»¥ä¾¿åœ¨ app ä¸­å…±äº«è¿™äº›æœåŠ¡ã€‚<code>LiveData</code> å¯¹è±¡è¿æ¥åˆ°ç³»ç»ŸæœåŠ¡ä¸€æ¬¡ï¼Œç„¶åä»»ä½•éœ€è¦èµ„æºçš„è§‚å¯Ÿè€…éƒ½å¯ä»¥åªç›‘å¬ <code>LiveData</code> å¯¹è±¡ã€‚æœ‰å…³è¯¦æƒ…ï¼Œè¯·å‚é˜… <a href="https://developer.android.com/topic/libraries/architecture/livedata#extend_livedata" target="_blank" rel="noopener">æ‰©å±• LiveData</a>ã€‚</p>
</li>
</ul>
<h2 id="ä½¿ç”¨-LiveData-å¯¹è±¡"><a href="#ä½¿ç”¨-LiveData-å¯¹è±¡" class="headerlink" title="ä½¿ç”¨ LiveData å¯¹è±¡"></a>ä½¿ç”¨ LiveData å¯¹è±¡</h2><p>è·Ÿéšä»¥ä¸‹å‡ æ­¥æ¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ª <code>LiveData</code> çš„å®ä¾‹æ¥æŒæœ‰æŸä¸ªç±»å‹çš„æ•°æ®ã€‚è¿™é€šå¸¸æ˜¯åœ¨ä½ çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ç±»ä¸­åšçš„ã€‚</li>
<li>åˆ›å»ºä¸€ä¸ªå®šä¹‰äº† <a href="https://developer.android.com/reference/android/arch/lifecycle/Observer.html#onChanged(T" target="_blank" rel="noopener"><code>onChanged()</code></a>) æ–¹æ³•çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/Observer.html" target="_blank" rel="noopener"><code>Observer</code></a> å¯¹è±¡ï¼Œå®ƒä¼šåœ¨ <code>LiveData</code> å¯¹è±¡æŒæœ‰çš„æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶è¿›è¡Œæ§åˆ¶å¤„ç†ã€‚ä½ é€šå¸¸è¦åœ¨ UI controller ä¸­åˆ›å»º <code>Observer</code> å¯¹è±¡ï¼Œæ¯”å¦‚åœ¨ activity æˆ–è€… fragmentã€‚</li>
<li>ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html#observe(android.arch.lifecycle.LifecycleOwner,%0Aandroid.arch.lifecycle.Observer%3CT%3E" target="_blank" rel="noopener"><code>observe()</code></a>) æ–¹æ³•æ¥æŠŠ <code>Observer</code> å¯¹è±¡ attach åˆ° <code>LiveData</code> å¯¹è±¡ä¸Šã€‚<code>observe()</code> æ–¹æ³•æ¥æ”¶ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener"><code>LifecycleOwner</code></a> å¯¹è±¡ã€‚è¿™å°† <code>Observer</code> å¯¹è±¡è®¢é˜…åˆ° <code>LiveData</code> å¯¹è±¡ä¸Šï¼Œä»¥ä¾¿å®ƒæ”¶åˆ°æ”¹å˜çš„é€šçŸ¥ã€‚ä½ é€šå¸¸ä¼š attach <code>Observer</code> åˆ° UI Controller ä¸Šï¼Œæ¯”å¦‚ activity æˆ–è€… fragmentã€‚</li>
</ol>
<blockquote>
<p>ä½ å¯ä»¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html#observeForever(android.arch.lifecycle.Observer%3CT%3E" target="_blank" rel="noopener">observeForever(Observer)</a>) æ–¹æ³•ä»¥ä¸å…³è”ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener">LifecycleOwner</a> å¯¹è±¡çš„æ–¹å¼æ¥æ³¨å†Œä¸€ä¸ª observerã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œobserver è¢«è®¤ä¸ºå§‹ç»ˆå¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œå› æ­¤å§‹ç»ˆä¼šæ”¶åˆ°æœ‰å…³æ”¹å˜çš„é€šçŸ¥ã€‚ä½ å¯ä»¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html#removeObserver(android.arch.lifecycle.Observer%3CT%3E" target="_blank" rel="noopener">removeObserver(Observer)</a>) æ–¹æ³•æ¥ç§»é™¤è¿™äº› observer çš„è°ƒç”¨ã€‚</p>
</blockquote>
<p>å½“ä½ æ›´æ–°å­˜å‚¨åœ¨ <code>LiveData</code> å¯¹è±¡çš„å€¼çš„æ—¶å€™ï¼Œå®ƒä¼šè§¦å‘æ‰€æœ‰æ³¨å†Œçš„ observers åªè¦å…³è”çš„ <code>LifecycleOwner</code> çš„çŠ¶æ€æ˜¯ active çš„ã€‚</p>
<p>LiveData å…è®¸ UI Controller çš„ observer å»è®¢é˜…æ›´æ–°ã€‚å½“æŒæœ‰æ•°æ®çš„ <code>LiveData</code> å¯¹è±¡æ›´æ–°æ—¶ï¼ŒUI ä¼šåœ¨å“åº”ä¸­è‡ªåŠ¨æ›´æ–°ã€‚</p>
<h3 id="åˆ›å»º-LiveData-å¯¹è±¡"><a href="#åˆ›å»º-LiveData-å¯¹è±¡" class="headerlink" title="åˆ›å»º LiveData å¯¹è±¡"></a>åˆ›å»º LiveData å¯¹è±¡</h3><p>LiveData æ˜¯ä¸€ä¸ªå¯ç”¨äºä»»ä½•æ•°æ®çš„ä¸€ä¸ªåŒ…è£…ï¼ŒåŒ…æ‹¬å®ç°äº† <a href="https://developer.android.com/reference/java/util/Collections.html" target="_blank" rel="noopener"><code>Collections</code></a> çš„å¯¹è±¡ï¼Œæ¯”å¦‚ <a href="https://developer.android.com/reference/java/util/List.html" target="_blank" rel="noopener"><code>List</code></a>ã€‚ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡é€šå¸¸å­˜å‚¨åœ¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å¯¹è±¡ä¸­ï¼Œå¹¶ä¸”é€šè¿‡ getter æ–¹æ³•è®¿é—®ï¼Œå°±åƒä¸‹é¢æ¼”ç¤ºçš„é‚£æ ·ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NameViewModel</span> : <span class="type">ViewModel</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create a LiveData with a String</span></span><br><span class="line">    <span class="keyword">val</span> currentName: MutableLiveData&lt;String&gt; <span class="keyword">by</span> lazy &#123;</span><br><span class="line">        MutableLiveData&lt;String&gt;()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Rest of the ViewModel...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€åˆï¼Œ<code>LiveData</code> å¯¹è±¡ä¸­çš„æ•°æ®æ²¡æœ‰è¢«è®¾ç½®ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šç¡®ä¿å­˜å‚¨çš„æ›´æ–° UI çš„ <strong>LiveData</strong> å¯¹è±¡æ˜¯åœ¨ <strong>ViewModel</strong> å¯¹è±¡ä¸­ï¼Œè€Œä¸æ˜¯ activity æˆ–è€… fragmentï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ul>
<li>é¿å…è‡ƒè‚¿çš„ activities å’Œ fragmentsã€‚ç°åœ¨è¿™äº› UI Controllers æ˜¯è´Ÿè´£å±•ç¤ºæ•°æ®ï¼Œè€Œä¸æŒæœ‰æ•°æ®çš„çŠ¶æ€ã€‚</li>
<li>è¦ä»ç‰¹å®šçš„ activity æˆ–è€… fragment å®ä¾‹ä¸­è§£è€¦ <strong>LiveData</strong> å®ä¾‹ï¼Œå¹¶ä¸”å…è®¸ <strong>LiveData</strong> å¯¹è±¡åœ¨é…ç½®æ›´æ”¹åç»§ç»­ç”Ÿå­˜ã€‚</li>
</ul>
</blockquote>
<p>ä½ å¯ä»¥åœ¨ <a href="https://developer.android.com/topic/libraries/architecture/viewmodel.html" target="_blank" rel="noopener">ViewModel æŒ‡å—</a> ä¸­äº†è§£æ›´å¤šå…³äº <code>ViewModel</code> ç±»å‹ä½¿ç”¨çš„å¥½å¤„ã€‚</p>
<h3 id="è§‚å¯Ÿ-LiveData-å¯¹è±¡"><a href="#è§‚å¯Ÿ-LiveData-å¯¹è±¡" class="headerlink" title="è§‚å¯Ÿ LiveData å¯¹è±¡"></a>è§‚å¯Ÿ LiveData å¯¹è±¡</h3><p>åœ¨å¤§å¤šæƒ…å†µä¸‹ï¼Œä¸€ä¸ª app ç»„ä»¶çš„ <a href="https://developer.android.com/reference/android/app/Activity.html#onCreate(android.os.Bundle" target="_blank" rel="noopener"><code>onCreate()</code></a>) æ–¹æ³•æ˜¯å¼€å§‹è§‚å¯Ÿ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡æ¯”è¾ƒæ­£ç¡®çš„åœ°æ–¹ï¼Œæ„¿æ„å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¯ä»¥ç¡®ä¿ç³»ç»Ÿä¸ä¼šåœ¨ activity æˆ–è€… fragment çš„ <a href="https://developer.android.com/reference/android/app/Activity.html#onResume(" target="_blank" rel="noopener">onResume()</a>) æœ‰è¿‡å¤šçš„è°ƒç”¨ã€‚</li>
<li>å¯ä»¥ç¡®ä¿ activity æˆ–è€… fragment çŠ¶æ€å˜ä¸º active æ—¶æœ‰æ•°æ®å¯ä»¥å°½å¿«æ˜¾ç¤ºå‡ºæ¥ã€‚ä¸€æ—¦ä¸€ä¸ª app ç»„ä»¶å¤„äº <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#STARTED" target="_blank" rel="noopener">STARTED</a>ï¼Œå®ƒä¼šä»å®ƒè§‚å¯Ÿä¸­çš„ <code>LiveData</code> å¯¹è±¡æ¥æ”¶åˆ°æœ€è¿‘çš„æ•°æ®ã€‚è¿™åªä¼šåœ¨è§‚å¯Ÿäº† <code>LiveData</code> æ—¶æ‰ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</li>
</ul>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼ŒLiveData ä»…åœ¨æ•°æ®æ›´æ”¹æ—¶æä¾›æ›´æ–°ï¼Œå¹¶ä¸”ä»…å‘ active çŠ¶æ€çš„ observer æä¾›æ›´æ–°ã€‚è¿™ä¸ªè¡Œä¸ºçš„ä¸€ä¸ªä¾‹å¤–æ˜¯ï¼Œobserver åœ¨ä» inactive çŠ¶æ€æ›´æ”¹ä¸º active çŠ¶æ€æ—¶ä¹Ÿä¼šæ”¶åˆ°æ›´æ–°ã€‚æ­¤å¤–ï¼Œobserver ç¬¬äºŒæ¬¡ä» inactive åˆ° active çŠ¶æ€ï¼Œåªæœ‰è‡ªä»ä¸Šæ¬¡å˜æˆ active ä¸ºæ­¢æ•°æ®æ”¹å˜äº†ï¼Œå®ƒæ‰ä¼šæ¥æ”¶åˆ°æ›´æ–°ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­è¯´æ˜äº†å¦‚ä½•å¼€å§‹è§‚å¯Ÿä¸€ä¸ª <code>LiveData</code> å¯¹è±¡ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NameActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> mModel: NameViewModel</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Other code to setup the activity...</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Get the ViewModel.</span></span><br><span class="line">        mModel = ViewModelProviders.of(<span class="keyword">this</span>).<span class="keyword">get</span>(NameViewModel::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create the observer which updates the UI.</span></span><br><span class="line">        <span class="keyword">val</span> nameObserver = Observer&lt;String&gt; &#123; newName -&gt;</span><br><span class="line">            <span class="comment">// Update the UI, in this case, a TextView.</span></span><br><span class="line">            mNameTextView.text = newName</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Observe the LiveData, passing in this activity as the LifecycleOwner and the observer.</span></span><br><span class="line">        mModel.currentName.observe(<span class="keyword">this</span>, nameObserver)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>nameObserver</code> ä½œä¸ºå‚æ•°ä¼ å…¥çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html#observe(android.arch.lifecycle.LifecycleOwner,%0Aandroid.arch.lifecycle.Observer%3CT%3E" target="_blank" rel="noopener"><code>observe()</code></a>) è¢«è°ƒç”¨ä¹‹åï¼Œ<a href="https://developer.android.com/reference/android/arch/lifecycle/Observer.html#onChanged(T" target="_blank" rel="noopener"><code>onChanged()</code></a>) ç«‹åˆ»å°±ä¼šè¢«è°ƒç”¨å¹¶æä¾›å­˜å‚¨åœ¨ <code>mCurrentName</code> ä¸­æœ€è¿‘çš„å€¼ã€‚å¦‚æœ <code>LiveData</code> å¯¹è±¡ <code>mCurrentName</code> ä¸­æ²¡æœ‰è¢«è®¾ç½®å€¼ï¼Œåˆ™ <code>onChanged()</code> ä¸ä¼šè¢«è°ƒç”¨ã€‚</p>
<h3 id="æ›´æ–°-LiveData-å¯¹è±¡"><a href="#æ›´æ–°-LiveData-å¯¹è±¡" class="headerlink" title="æ›´æ–° LiveData å¯¹è±¡"></a>æ›´æ–° LiveData å¯¹è±¡</h3><p>LiveData æ²¡æœ‰å…¬å¼€å¯ç”¨çš„æ–¹æ³•ç”¨æ¥å­˜å‚¨æ›´æ–°å­˜å‚¨çš„æ•°æ®ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/MutableLiveData.html" target="_blank" rel="noopener"><code>MutableLiveData</code></a> ç±»æš´éœ²å…¬å¼€äº† <a href="https://developer.android.com/reference/android/arch/lifecycle/MutableLiveData.html#setValue(T" target="_blank" rel="noopener"><code>setValue(T)</code></a>) å’Œ <a href="https://developer.android.com/reference/android/arch/lifecycle/MutableLiveData.html#postValue(T" target="_blank" rel="noopener"><code>postValue(T)</code></a>) æ–¹æ³•ï¼Œå¦‚æœä½ éœ€è¦ç¼–è¾‘å­˜å‚¨åœ¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡ä¸­çš„å€¼ï¼Œä½ å¿…é¡»è¦ä½¿ç”¨å®ƒä»¬ã€‚é€šå¸¸ï¼Œ<code>MutableLiveData</code> è¢«åœ¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ä¸­è¢«ä½¿ç”¨ï¼Œ<code>ViewModel</code> åªæš´éœ²ä¸å¯ç¼–è¾‘çš„ <code>LiveData</code> å¯¹è±¡ç»™ observersã€‚</p>
<p>å½“ä½ è®¾ç½®äº† observer å…³ç³»ä¹‹åï¼Œä½ å¯ä»¥æ›´æ–° <code>LiveData</code> å¯¹è±¡ä¸­çš„å€¼ï¼Œå°±å¦‚ä¸‹é¢ä¾‹å­å±•ç¤ºçš„ï¼Œå½“ç”¨æˆ·æŒ‰ä¸‹æŒ‰é’®æ—¶è§¦å‘æ‰€æœ‰ observersï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mButton.setOnClickListener &#123;</span><br><span class="line">    <span class="keyword">val</span> anotherName = <span class="string">"John Doe"</span></span><br><span class="line">    mModel.currentName.setValue(anotherName)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¾‹å­ä¸­è°ƒç”¨ <code>setValue(T)</code>ï¼Œobservers è°ƒç”¨å®ƒä»¬çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/Observer.html#onChanged(T" target="_blank" rel="noopener"><code>onChanged()</code></a>) æ–¹æ³•ï¼Œå€¼ä¸º <code>John Doe</code>ã€‚ä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªæŒ‰é’®è¢«æŒ‰ä¸‹ï¼Œä½†ç”±äºå„ç§åŸå› ï¼Œå¯ä»¥è°ƒç”¨ <code>setValue()</code> æˆ– <code>postValue()</code> æ¥æ›´æ–° <code>mName</code>ï¼ŒåŒ…æ‹¬åœ¨ç½‘ç»œè¯·æ±‚çš„ response ä¸­ï¼Œæˆ–è€…æ•°æ®åº“åŠ è½½å®Œæˆï¼›åœ¨æ‰€æœ‰æƒ…å†µä¸­ï¼Œè°ƒç”¨ <code>setValue()</code> å’Œ <code>postValue()</code> ä¼šè§¦å‘ observers å¹¶æ›´æ–° UIã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šä½ å¿…é¡»åœ¨ä¸»çº¿ç¨‹è°ƒç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/MutableLiveData.html#setValue(T" target="_blank" rel="noopener">setValue(T)</a>) æ›´æ–° <strong>LiveData</strong> å¯¹è±¡ã€‚å¦‚æœä»£ç æ‰§è¡Œåœ¨ä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/MutableLiveData.html#postValue(T" target="_blank" rel="noopener">postValue(T)</a>) æ–¹æ³•æ¥æ›´æ–° <strong>LiveData</strong> å¯¹è±¡ã€‚</p>
</blockquote>
<h3 id="ç»“åˆ-Room-ä½¿ç”¨-LiveData"><a href="#ç»“åˆ-Room-ä½¿ç”¨-LiveData" class="headerlink" title="ç»“åˆ Room ä½¿ç”¨ LiveData"></a>ç»“åˆ Room ä½¿ç”¨ LiveData</h3><p>æŒä¹…åŒ–åº“ <a href="https://developer.android.com/training/data-storage/room/index.html" target="_blank" rel="noopener">Room</a> æ”¯æŒ observable æŸ¥è¯¢ï¼Œå®ƒè¿”å› <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡ã€‚Observable æŸ¥è¯¢è¢«ä½œä¸ºæ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰çš„ä¸€éƒ¨åˆ†è¢«ç¼–å†™ã€‚</p>
<p>Room ç”Ÿæˆæ‰€æœ‰å¿…è¦çš„ä»£ç æ¥åœ¨æ•°æ®åº“æ›´æ–°æ—¶æ›´æ–° <code>LiveData</code> å¯¹è±¡ã€‚å¦‚æœéœ€è¦ï¼Œè¢«ç”Ÿæˆçš„ä»£ç åœ¨åå°çº¿ç¨‹è¿è¡Œå¼‚æ­¥æŸ¥è¯¢ã€‚è¿™ä¸ªæ¨¡å¼å¯ç”¨äºä½¿ UI ä¸­æ˜¾ç¤ºçš„æ•°æ®ä¸å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ•°æ®ä¿æŒåŒæ­¥ã€‚ä½ å¯ä»¥åœ¨ <a href="https://developer.android.com/topic/libraries/architecture/room.html" target="_blank" rel="noopener">Room æŒä¹…åŒ–åº“æŒ‡å—</a> äº†è§£æ›´å¤šå…³äº Room å’Œ DAOsã€‚</p>
<h3 id="æ‰©å±•-LiveData"><a href="#æ‰©å±•-LiveData" class="headerlink" title="æ‰©å±• LiveData"></a>æ‰©å±• LiveData</h3><p>å¦‚æœ observer çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#STARTED" target="_blank" rel="noopener"><code>STARTED</code></a> æˆ–è€… <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.State.html#RESUMED" target="_blank" rel="noopener"><code>RESUMED</code></a> çŠ¶æ€ï¼ŒLiveData åˆ™è®¤ä¸º observer å¤„äº active çŠ¶æ€ï¼Œä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•æ‰©å±•ç»§æ‰¿ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> ç±»ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StockLiveData</span></span>(symbol: String) : LiveData&lt;BigDecimal&gt;() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> mStockManager = StockManager(symbol)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> mListener = &#123; price: BigDecimal -&gt;</span><br><span class="line">        value = price</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActive</span><span class="params">()</span></span> &#123;</span><br><span class="line">        mStockManager.requestPriceUpdates(mListener)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onInactive</span><span class="params">()</span></span> &#123;</span><br><span class="line">        mStockManager.removeUpdates(mListener)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šè¿°ä¾‹å­çš„ price listener çš„å®ç°ä¸­åŒ…å«äº†ä»¥ä¸‹å‡ ä¸ªé‡è¦çš„æ–¹æ³•ï¼š</p>
<ul>
<li><a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html#onActive(" target="_blank" rel="noopener"><code>onActive()</code></a>) æ–¹æ³•åœ¨ <code>LiveData</code> å¯¹è±¡æœ‰ä¸€ä¸ª active observer çš„æ—¶å€™è¢«è°ƒç”¨ã€‚è¿™æ„å‘³ç€ä½ éœ€è¦åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¼€å§‹è§‚å¯Ÿ stock price çš„æ›´æ–°ã€‚</li>
<li><a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html#onInactive(" target="_blank" rel="noopener"><code>onInactive()</code></a>) æ–¹æ³•åœ¨ <code>LiveData</code> å¯¹è±¡æ²¡æœ‰ä»»ä½•ä¸€ä¸ª active observer çš„æ—¶å€™è¢«è°ƒç”¨ã€‚å› ä¸ºæ²¡æœ‰ observers æ­£åœ¨ç›‘å¬ï¼Œæ‰€ä»¥æ²¡æœ‰ç†ç”±ä¸ <code>StockManager</code> æœåŠ¡ä¿æŒè¿æ¥ã€‚</li>
<li><a href="https://developer.android.com/reference/android/arch/lifecycle/MutableLiveData.html#setValue(T" target="_blank" rel="noopener"><code>setValue(T)</code></a>) æ–¹æ³•æ›´æ–° <code>LiveData</code> å®ä¾‹çš„å€¼ï¼Œå¹¶ä¸”é€šçŸ¥ä»»ä½• active çŠ¶æ€çš„ observers å…³äºè¿™æ¬¡æ”¹å˜ã€‚</li>
</ul>
<p>ä½ å¯ä»¥å¦‚ä¸‹ä½¿ç”¨ <code>StockLiveData</code> ç±»ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityCreated</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onActivityCreated(savedInstanceState)</span><br><span class="line">    <span class="keyword">val</span> myPriceListener: LiveData&lt;BigDecimal&gt; = ...</span><br><span class="line">    myPriceListener.observe(<span class="keyword">this</span>, Observer&lt;BigDecimal&gt; &#123; price: BigDecimal? -&gt;</span><br><span class="line">        <span class="comment">// Update the UI.</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html#observe(android.arch.lifecycle.LifecycleOwner,%0Aandroid.arch.lifecycle.Observer%3CT%3E" target="_blank" rel="noopener"><code>observe()</code></a>) æ–¹æ³•ä¼ å…¥ fragment ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ <a href="https://developer.android.com/reference/android/arch/lifecycle/LifecycleOwner.html" target="_blank" rel="noopener"><code>LifecycleOwner</code></a> çš„ä¸€ä¸ªå®ä¾‹ã€‚è¿™æ ·åšè¡¨ç¤ºæ­¤ observer ç»‘å®šåˆ°ä¸æ‰€æœ‰è€…å…³è”çš„ <a href="https://developer.android.com/reference/android/arch/lifecycle/Lifecycle.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> å¯¹è±¡ï¼Œæ„å‘³ç€ï¼š</p>
<ul>
<li>å¦‚æœ <code>Lifecycle</code> å¯¹è±¡ä¸å¤„äº active çŠ¶æ€äº†ï¼Œé‚£ä¹ˆå°±ç®—å€¼æ”¹å˜äº† observer ä¹Ÿä¸ä¼šå›è°ƒã€‚</li>
<li>åœ¨ <code>Lifecycle</code> å¯¹è±¡è¢«é”€æ¯äº†ï¼Œobserver ä¼šè‡ªåŠ¨è¢«ç§»é™¤ã€‚</li>
</ul>
<p><code>LiveData</code> å¯¹è±¡æ˜¯ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥çš„äº‹å®ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨å¤šä¸ª activityï¼Œfragmentï¼Œservice ä¹‹é—´å…±äº«å®ƒä»¬ã€‚ä¸ºäº†ä¿æŒä¾‹å­ç®€å•ï¼Œä½ å¯ä»¥æŠŠ <code>LiveData</code> ç±»ä½œä¸ºä¸€ä¸ªå•ä¾‹å®ç°ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StockLiveData</span></span>(symbol: String) : LiveData&lt;BigDecimal&gt;() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> mStockManager: StockManager = StockManager(symbol)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> mListener = &#123; price: BigDecimal -&gt;</span><br><span class="line">        value = price</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActive</span><span class="params">()</span></span> &#123;</span><br><span class="line">        mStockManager.requestPriceUpdates(mListener)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onInactive</span><span class="params">()</span></span> &#123;</span><br><span class="line">        mStockManager.removeUpdates(mListener)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> sInstance: StockLiveData</span><br><span class="line"></span><br><span class="line">        <span class="meta">@MainThread</span></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> <span class="title">get</span><span class="params">(symbol: <span class="type">String</span>)</span></span>: StockLiveData &#123;</span><br><span class="line">            sInstance = <span class="keyword">if</span> (::sInstance.isInitialized) sInstance <span class="keyword">else</span> StockLiveData(symbol)</span><br><span class="line">            <span class="keyword">return</span> sInstance</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åï¼Œä½ å¯ä»¥åœ¨ fragment ä¸­ä½¿ç”¨å®ƒï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyFragment</span> : <span class="type">Fragment</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onActivityCreated</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        StockLiveData.<span class="keyword">get</span>(symbol).observe(<span class="keyword">this</span>, Observer&lt;BigDecimal&gt; &#123; price: BigDecimal? -&gt;</span><br><span class="line">            <span class="comment">// Update the UI.</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å¤šä¸ª fragments å’Œ activities å¯ä»¥è§‚å¯Ÿè¿™ä¸ª <code>MyPriceListener</code> å®ä¾‹ã€‚LiveData åªä¼šåœ¨å®ƒä»¬ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ˜¯å¯è§å’Œ active çš„æ‰ä¼šè¿æ¥åˆ°ç³»ç»ŸæœåŠ¡ã€‚</p>
<h2 id="è½¬æ¢-LiveData"><a href="#è½¬æ¢-LiveData" class="headerlink" title="è½¬æ¢ LiveData"></a>è½¬æ¢ LiveData</h2><p>å‚¨å­˜åœ¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> çš„æ•°æ®åœ¨æ´¾å‘ç»™ observers ä¹‹å‰ï¼Œä½ å¯èƒ½éœ€è¦åšä¸€äº›æ”¹å˜ï¼Œæˆ–è€…ä½ å¯èƒ½éœ€è¦åŸºäºå¦ä¸€ä¸ªå€¼è¿”å›ä¸€ä¸ªä¸åŒçš„ <code>LiveData</code> å®ä¾‹ã€‚<a href="https://developer.android.com/reference/android/arch/lifecycle/package-summary.html" target="_blank" rel="noopener"><code>Lifecycle</code></a> åŒ…æä¾›äº† <a href="https://developer.android.com/reference/android/arch/lifecycle/Transformations.html" target="_blank" rel="noopener"><code>Transformations</code></a> ç±»ï¼Œå®ƒåŒ…å«äº†ä¸€äº›å¸®åŠ©çš„æ–¹æ³•æ¥æ”¯æŒè¿™äº›åœºæ™¯ã€‚</p>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/Transformations.html#map(android.arch.lifecycle.LiveData%3CX%3E,%20android.arch.core.util.Function%3CX,%20Y%3E" target="_blank" rel="noopener"><code>Transformations.map()</code></a>)</p>
<p>å¯¹å­˜å‚¨åœ¨ <code>LiveData</code> å¯¹è±¡ä¸­çš„å€¼æ‰§è¡Œå‡½æ•°ï¼Œå¹¶å°†ç»“æœå‘é€åˆ°ä¸‹æ¸¸ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> userLiveData: LiveData&lt;User&gt; = UserLiveData()</span><br><span class="line"><span class="keyword">val</span> userName: LiveData&lt;String&gt; = Transformations.map(userLiveData) &#123;</span><br><span class="line">    user -&gt; <span class="string">"<span class="subst">$&#123;user.name&#125;</span> <span class="subst">$&#123;user.lastName&#125;</span>"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://developer.android.com/reference/android/arch/lifecycle/Transformations.html#switchMap(android.arch.lifecycle.LiveData%3CX%3E,%20android.arch.core.util.Function%3CX,%20android.arch.lifecycle.LiveData%3CY%3E%3E" target="_blank" rel="noopener"><code>Transformations.switchMap()</code></a>)</p>
<p>ç±»ä¼¼äº <code>map()</code>ï¼Œå¯¹å­˜å‚¨åœ¨ <code>LiveData</code> å¯¹è±¡ä¸­çš„å€¼æ‰§è¡Œå‡½æ•°ï¼Œå¹¶åœ¨ä¸‹æ¸¸å±•å¼€å’Œè°ƒåº¦ç»“æœã€‚ä¼ å…¥ <code>switchMap()</code> çš„å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ª <code>LiveData</code> å¯¹è±¡ï¼Œå¦‚ä¸‹é¢ä¾‹å­æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getUser</span><span class="params">(id: <span class="type">String</span>)</span></span>: LiveData&lt;User&gt; &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">val</span> userId: LiveData&lt;String&gt; = ...</span><br><span class="line"><span class="keyword">val</span> user = Transformations.switchMap(userId) &#123; id -&gt; getUser(id) &#125;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥ä½¿ç”¨è½¬æ¢æ–¹æ³•åœ¨ observer çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ä¼ è¾“ä¿¡æ¯ã€‚transformations ä¸ä¼šè¢«è®¡ç®—ï¼Œé™¤éä¸€ä¸ª observer æ­£åœ¨ç›‘å¬è¿”å›çš„ <code>LiveData</code> å¯¹è±¡ã€‚å› ä¸º transformations æ˜¯æ‡’è®¡ç®—çš„ï¼Œä¸ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„è¡Œä¸ºè¢«éšå¼ä¼ é€’ï¼Œè€Œä¸éœ€è¦é¢å¤–çš„æ˜¾å¼è°ƒç”¨æˆ–ä¾èµ–ã€‚</p>
<p>å¦‚æœä½ è§‰å¾—ä½ åœ¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> å¯¹è±¡ä¸­éœ€è¦ä¸€ä¸ª <code>Lifecycle</code> å¯¹è±¡ï¼Œtransformation æ˜¯ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ª UI ç»„ä»¶ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª address å¹¶è¿”å›ä¸€ä¸ª è¯¥ address çš„ postal codeã€‚ä½ å¯ä»¥é’ˆå¯¹è¯¥ç»„ä»¶å®ç°å•çº¯çš„ <code>ViewModel</code>ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyViewModel</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> repository: PostalCodeRepository) : ViewModel() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getPostalCode</span><span class="params">(address: <span class="type">String</span>)</span></span>: LiveData&lt;String&gt; &#123;</span><br><span class="line">        <span class="comment">// DON'T DO THIS</span></span><br><span class="line">        <span class="keyword">return</span> repository.getPostCode(address)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå½“æ¯æ¬¡è°ƒç”¨ <code>getPostalCode()</code>æ—¶ï¼ŒUI ç»„ä»¶éœ€è¦ä»ä¸Šä¸€ä¸ª <code>LiveData</code> å¯¹è±¡åæ³¨å†Œï¼Œå¹¶æ³¨å†Œåˆ°æ–°çš„å®ä¾‹ã€‚å¦å¤–ï¼Œå¦‚æœ UI component è¢«é‡å»ºï¼Œå®ƒä¼šè§¦å‘å¦ä¸€ä¸ª <code>repository.getPostCode()</code> è°ƒç”¨è€Œä¸æ˜¯ä½¿ç”¨ä¹‹å‰è°ƒç”¨çš„ç»“æœã€‚</p>
<p>å¯¹æ­¤ä½ å®ç° postal code æŸ¥æ‰¾ä½œä¸º address è¾“å…¥çš„è½¬æ¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyViewModel</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> repository: PostalCodeRepository) : ViewModel() &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> addressInput = MutableLiveData&lt;String&gt;()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> postalCode: LiveData&lt;String&gt; =</span><br><span class="line">            Transformations.switchMap(addressInput) &#123; address -&gt; repository.getPostCode(address) &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">setInput</span><span class="params">(address: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        addressInput.value = address</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>postalCode</code> field æ˜¯ <code>public</code> å’Œ <code>final</code> çš„ï¼Œå› ä¸ºè¿™ä¸ª field æ°¸è¿œä¸ä¼šæ”¹å˜ã€‚<code>postalCode</code> è¿™ä¸ª field è¢«å®šä¹‰ä¸º <code>addressInput</code> çš„ä¸€ä¸ªè½¬æ¢ï¼Œè¿™æ„å‘³ç€ <code>repository.getPostCode()</code> åœ¨ <code>addressInput</code> æ”¹å˜æ—¶è¢«è°ƒç”¨ã€‚åœ¨ <code>repository.getPostCode()</code> è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœæœ‰ä¸€ä¸ª active çš„ observer åˆ™æ˜¯çœŸçš„ï¼Œå¦‚æœæ²¡æœ‰ active çš„ observerï¼Œåœ¨æ·»åŠ  observer ä¹‹å‰ï¼Œä¸è¿›è¡Œä»»ä½•è®¡ç®—ã€‚</p>
<p>è¿™ä¸ªæœºåˆ¶å…è®¸ä½çº§åˆ«çš„ app å»åˆ›å»ºæŒ‰éœ€æ‡’è®¡ç®—çš„ <code>LiveData</code> å¯¹è±¡ã€‚ä¸€ä¸ª <code>ViewModel</code> å¯¹è±¡å¯ä»¥è½»æ¾åœ°è·å– <code>LiveData</code> å¯¹è±¡çš„å¼•ç”¨ï¼Œç„¶ååœ¨å…¶åŸºç¡€ä¸Šå®šä¹‰è½¬æ¢è§„åˆ™ã€‚</p>
<h3 id="åˆ›å»ºæ–°çš„è½¬æ¢"><a href="#åˆ›å»ºæ–°çš„è½¬æ¢" class="headerlink" title="åˆ›å»ºæ–°çš„è½¬æ¢"></a>åˆ›å»ºæ–°çš„è½¬æ¢</h3><p>åœ¨ä½ çš„åº”ç”¨ä¸­å¯èƒ½æœ‰åå‡ ä¸ªä¸åŒä¸”æœ‰ç”¨çš„ç‰¹å®šè½¬æ¢ï¼Œä½†é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸æä¾›çš„ã€‚è¦å®ç°ä½ è‡ªå·±çš„ transformation ä½ å¯ä»¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/MediatorLiveData.html" target="_blank" rel="noopener"><code>MediatorLiveData</code></a> ç±»ï¼Œå®ƒç›‘å¬å…¶å®ƒ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡å¹¶å¤„ç†å®ƒä»¬å‘å‡ºçš„äº‹ä»¶ã€‚<code>MediatorLiveData</code> æ­£ç¡®åœ°å°†å…¶çŠ¶æ€ä¼ é€åˆ°æº <code>LiveData</code> å¯¹è±¡ã€‚å­¦ä¹ å…³äºè¿™ä¸ªæ¨¡å¼çš„è¯¦æƒ…ï¼ŒæŸ¥çœ‹ <a href="https://developer.android.com/reference/android/arch/lifecycle/Transformations.html" target="_blank" rel="noopener"><code>Transformations</code></a> ç±»çš„å‚è€ƒæ–‡æ¡£ã€‚</p>
<h2 id="åˆå¹¶å¤šä¸ª-LiveData-æº"><a href="#åˆå¹¶å¤šä¸ª-LiveData-æº" class="headerlink" title="åˆå¹¶å¤šä¸ª LiveData æº"></a>åˆå¹¶å¤šä¸ª LiveData æº</h2><p><a href="https://developer.android.com/reference/android/arch/lifecycle/MediatorLiveData.html" target="_blank" rel="noopener"><code>MediatorLiveData</code></a> æ˜¯ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData.html" target="_blank" rel="noopener"><code>LiveData</code></a> çš„ä¸€ä¸ªå­ç±»ï¼Œå®ƒå…è®¸ä½ å»åˆå¹¶å¤šä¸ª LiveData æºã€‚ æ¯å½“ä»»ä½•åŸå§‹ LiveData æºå¯¹è±¡æ›´æ”¹æ—¶ï¼Œ<code>MediatorLiveData</code> å¯¹è±¡çš„ observers ä¼šè¢«è§¦å‘ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ åœ¨ä½ çš„ UI æœ‰ä¸€ä¸ª <code>LiveData</code> å¯¹è±¡ï¼Œå®ƒå¯ä»¥ä»æœ¬åœ°æ•°æ®åº“å’Œç½‘ç»œä¸­æ›´æ–°ï¼Œç„¶åä½ å¯ä»¥å¢åŠ ä¸‹é¢å‡ ä¸ªæºåˆ° <code>MediatorLiveData</code> å¯¹è±¡ï¼š</p>
<ul>
<li>ä¸€ä¸ª <code>LiveData</code> å¯¹è±¡ï¼Œä¸å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ•°æ®ç›¸å…³è”ã€‚</li>
<li>ä¸€ä¸ª <code>LiveData</code> å¯¹è±¡ï¼Œäºè®¿é—®ç½‘ç»œçš„æ•°æ®ç›¸å…³è”ã€‚</li>
</ul>
<p>ä½ çš„ activity åªéœ€è¦å»è§‚å¯Ÿ <code>MediatorLiveData</code> å¯¹è±¡æ¥ä»ä¸Šé¢ä¸¤ç§æºä¸­æ¥æ”¶æ›´æ–°ã€‚æœ‰è¯¦ç»†ç¤ºä¾‹ï¼Œè§ <a href="">App Architecture æŒ‡å—</a> çš„ <a href="https://developer.android.com/topic/libraries/architecture/guide.html#addendum" target="_blank" rel="noopener">é™„å½•: å…¬å¼€ç½‘ç»œçŠ¶æ€</a> æ ã€‚</p>
<h2 id="é¢å¤–èµ„æº"><a href="#é¢å¤–èµ„æº" class="headerlink" title="é¢å¤–èµ„æº"></a>é¢å¤–èµ„æº</h2><p><code>LiveData</code> è¢«ä½¿ç”¨åœ¨äº† <a href="https://github.com/googlesamples/android-sunflower" target="_blank" rel="noopener">Sunflower</a> çš„ demo app ä¸­ã€‚</p>
<p>ä¹Ÿå¯ä»¥æŸ¥çœ‹ Architecture Components <a href="https://github.com/googlesamples/android-architecture-components/tree/master/BasicSample" target="_blank" rel="noopener">BasicSample</a>ã€‚</p>
<p>äº†è§£æ›´å¤šè¯¦æƒ…å…³äºä¸ <a href="https://developer.android.com/training/snackbar" target="_blank" rel="noopener">Snackbar</a> Messageï¼Œnavigation eventsï¼Œå’Œ other events ä¸€èµ·ä½¿ç”¨ <code>LiveData</code>ï¼ŒæŸ¥çœ‹<a href="https://medium.com/google-developers/livedata-with-snackbar-navigation-and-other-events-the-singleliveevent-case-ac2622673150" target="_blank" rel="noopener">æœ¬æ–‡</a>ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component DataBinding -- åŒå‘ç»‘å®šï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_binding_two_way/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-DataBinding-â€“-åŒå‘ç»‘å®šï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-DataBinding-â€“-åŒå‘ç»‘å®šï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component DataBinding â€“ åŒå‘ç»‘å®šï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component DataBinding â€“ åŒå‘ç»‘å®šï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/data-binding/two-way" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/data-binding/two-way</a></p>
</blockquote>
<p>è¦ä½¿ç”¨åŒå‘æ•°æ®ç»‘å®šï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªå±æ€§ä¸Šè®¾ç½®ä¸€ä¸ªå€¼ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªç›‘å¬å™¨æ¥å“åº”è¿™ä¸ªå±æ€§çš„å˜åŒ–ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;CheckBox</span><br><span class="line">    android:id=<span class="string">"@+id/rememberMeCheckBox"</span></span><br><span class="line">    android:checked=<span class="string">"@&#123;viewmodel.rememberMe&#125;"</span></span><br><span class="line">    android:onCheckedChanged=<span class="string">"@&#123;viewmodel.rememberMeChanged&#125;"</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<p>åŒå‘ç»‘å®šä¸ºè¿™ä¸ªè¿‡ç¨‹æä¾›äº†ä¸€ä¸ªæ·å¾„ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;CheckBox</span><br><span class="line">    android:id=<span class="string">"@+id/rememberMeCheckBox"</span></span><br><span class="line">    android:checked=<span class="string">"@=&#123;viewmodel.rememberMe&#125;"</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ <code>@={}</code> è®°å·ï¼Œé‡ç‚¹æ˜¯é‡Œé¢çš„ â€œ=â€ å·ï¼Œæ¥æ”¶å¯¹å±æ€§çš„æ•°æ®æ›´æ”¹ï¼Œå¹¶åŒæ—¶ç›‘å¬ç”¨æˆ·æ›´æ–°ã€‚</p>
<p>ä¸ºäº†å¯¹è¿”å›æ•°æ®ä¸­çš„å˜åŒ–åšå‡ºååº”ï¼Œä½ å¯ä»¥è®©ä½ çš„ layout variable æ˜¯ä¸€ä¸ª <code>Observable</code> çš„å®ç°ï¼Œé€šå¸¸æ˜¯ <a href="https://developer.android.com/reference/android/databinding/BaseObservable" target="_blank" rel="noopener"><code>BaseObservable</code></a>ï¼Œå¹¶ä½¿ç”¨ <a href="https://developer.android.com/reference/android/databinding/Bindable" target="_blank" rel="noopener"><code>@Bindable</code></a> æ³¨è§£ï¼Œå¦‚ä¸‹ä»£ç ç‰‡æ®µï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginViewModel</span> : <span class="type">BaseObservable &#123;</span></span></span><br><span class="line">    <span class="comment">// val data = ...</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bindable</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getRememberMe</span><span class="params">()</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">data</span>.rememberMe</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">setRememberMe</span><span class="params">(value: <span class="type">Boolean</span>)</span></span> &#123;</span><br><span class="line">        <span class="comment">// Avoids infinite loops.</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">data</span>.rememberMe != value) &#123;</span><br><span class="line">            <span class="keyword">data</span>.rememberMe = value</span><br><span class="line"></span><br><span class="line">            <span class="comment">// React to the change.</span></span><br><span class="line">            saveData()</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Notify observers of a new value.</span></span><br><span class="line">            notifyPropertyChanged(BR.remember_me)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ä¸º bindable å±æ€§çš„ getter æ–¹æ³•æ˜¯ <code>getRememberMe()</code>ï¼Œåˆ™ç›¸åº”çš„ setter æ–¹æ³•è‡ªåŠ¨ä½¿ç”¨ <code>setRememberMe()</code> è¿™ä¸ªåå­—ã€‚</p>
<p>æ›´å¤šå…³äº <code>BaseObservable</code> å’Œ <code>@Bindable</code> çš„ä¿¡æ¯ï¼Œè§ <a href="https://developer.android.com/topic/libraries/data-binding/observability" target="_blank" rel="noopener">ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡</a>ã€‚</p>
<h2 id="è‡ªå®šä¹‰å±æ€§å®ç°åŒå‘ç»‘å®š"><a href="#è‡ªå®šä¹‰å±æ€§å®ç°åŒå‘ç»‘å®š" class="headerlink" title="è‡ªå®šä¹‰å±æ€§å®ç°åŒå‘ç»‘å®š"></a>è‡ªå®šä¹‰å±æ€§å®ç°åŒå‘ç»‘å®š</h2><p>å¹³å°æä¾›äº† <a href="https://developer.android.com/topic/libraries/data-binding/two-way#two-way-attributes" target="_blank" rel="noopener">æœ€å¸¸ç”¨çš„åŒå‘ç»‘å®šå±æ€§</a> åŒå‘ç»‘å®šå®ç°å’Œç›‘å¬å™¨æ”¹å˜ï¼Œä½ å¯ä»¥ä½œä¸ºä½  app çš„ä¸€éƒ¨åˆ†å»ä½¿ç”¨ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå®šä¹‰å±æ€§çš„åŒå‘ç»‘å®šï¼Œä½ éœ€è¦ä½¿ç”¨ <a href="https://developer.android.com/reference/android/databinding/InverseBindingAdapter" target="_blank" rel="noopener"><code>@InverseBindingAdapter</code></a> å’Œ <a href="https://developer.android.com/reference/android/databinding/InverseBindingMethod" target="_blank" rel="noopener"><code>@InverseBindingMethod</code></a> æ³¨è§£ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ æƒ³åœ¨åä¸º <code>MyView</code> çš„è‡ªå®šä¹‰ view ä¸Šé¢å¼€å¯ <code>&quot;time&quot;</code> å±æ€§çš„åŒå‘ç»‘å®šï¼Œé€šè¿‡ä»¥ä¸‹å‡ æ­¥å®Œæˆï¼š</p>
<ol>
<li><p>åœ¨è®¾ç½®åˆå§‹å€¼çš„æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£ï¼Œå¹¶åœ¨å€¼ä½¿ç”¨ <code>@BindingAdapter</code> æ›´æ”¹æ—¶è¿›è¡Œæ›´æ–°ï¼š</p>
 <figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(<span class="meta-string">"time"</span>)</span></span><br><span class="line"><span class="meta">@JvmStatic</span> <span class="function"><span class="keyword">fun</span> <span class="title">setTime</span><span class="params">(view: <span class="type">MyView</span>, newValue: <span class="type">Time</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œå¾ˆé‡è¦ï¼Œè¦æ‰“ç ´æ½œåœ¨çš„æ­»å¾ªç¯</span></span><br><span class="line">    <span class="keyword">if</span> (view.time != newValue) &#123;</span><br><span class="line">        view.time = newValue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨è¯»å– view å€¼çš„æ–¹æ³•ä¸Šæ·»åŠ  <code>@InverseBindingAdapter</code> æ³¨è§£ï¼š</p>
 <figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@InverseBindingAdapter(<span class="meta-string">"time"</span>)</span></span><br><span class="line"><span class="meta">@JvmStatic</span> <span class="function"><span class="keyword">fun</span> <span class="title">getTime</span><span class="params">(view: <span class="type">MyView</span>)</span></span> : Time &#123;</span><br><span class="line">    <span class="keyword">return</span> view.getTime()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>æ­¤æ—¶ï¼ŒData Binding çŸ¥é“åœ¨æ•°æ®æ›´æ”¹æ—¶è¦æ‰§è¡Œçš„æ“ä½œï¼ˆå®ƒä¼šè°ƒç”¨åŠ äº† <a href="https://developer.android.com/reference/android/databinding/BindingAdapter" target="_blank" rel="noopener"><code>@BindingAdapter</code></a> æ³¨è§£çš„æ–¹æ³•ï¼‰å’Œå½“å±æ€§å‘ç”Ÿæ”¹å˜æ—¶ï¼ˆå®ƒä¼šè°ƒç”¨åŠ äº†<a href="https://developer.android.com/reference/android/databinding/InverseBindingListener" target="_blank" rel="noopener"><code>InverseBindingListener</code></a>æ³¨è§£çš„æ–¹æ³•ï¼‰ã€‚ä½†æ˜¯ï¼Œå®ƒä¸çŸ¥é“å±æ€§ä½•æ—¶æˆ–å¦‚ä½•è¢«æ›´æ”¹ã€‚</p>
<p>ä¸ºæ­¤ï¼Œä½ éœ€è¦åœ¨ view ä¸Šé¢è®¾ç½®ç›‘å¬å™¨ã€‚å®ƒå¯ä»¥è‡ªå®šä¹‰ç›‘å¬å™¨ï¼Œå…³è”åˆ°ä½ è‡ªå®šä¹‰çš„ viewï¼Œæˆ–è€…å®ƒæ˜¯ä¸€èˆ¬äº‹ä»¶ï¼Œæ¯”å¦‚å¤±å»ç„¦ç‚¹ï¼Œæ–‡æœ¬çš„å˜åŒ–ç­‰ã€‚åœ¨æ–¹æ³•ä¸Šå¢åŠ ä¸€ä¸ª <code>@BindingAdapter</code> æ³¨è§£ï¼Œä¸ºå±æ€§è®¾ç½®ä¸€ä¸ªæ”¹å˜çš„ç›‘å¬å™¨ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(<span class="meta-string">"app:timeAttrChanged"</span>)</span></span><br><span class="line"><span class="meta">@JvmStatic</span> <span class="function"><span class="keyword">fun</span> <span class="title">setListeners</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        view: <span class="type">MyView</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        attrChange: <span class="type">InverseBindingListener</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span> &#123;</span><br><span class="line">    <span class="comment">// Set a listener for click, focus, touch, etc.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªç›‘å¬å™¨åŒ…å«ä¸€ä¸ª <code>InverseBindingListener</code> ä½œä¸ºå‚æ•°ã€‚ä½ ä½¿ç”¨ <code>InverseBindingListener</code> æ¥å‘Šè¯‰ data binding ç³»ç»Ÿå±æ€§è¢«ä¿®æ”¹äº†ã€‚ç³»ç»Ÿä¼šå¼€å§‹è°ƒç”¨åŠ äº† <code>@InverseBindingAdapter</code> æ³¨è§£çš„æ–¹æ³•ï¼Œç­‰ç­‰ã€‚</p>
<blockquote>
<p>æ¯ä¸€ä¸ªåŒå‘ç»‘å®šç”Ÿæˆäº†ä¸€ä¸ª<strong>åˆæˆçš„äº‹ä»¶å±æ€§</strong>ã€‚è¿™ä¸ªå±æ€§ä¸åŸºå±æ€§å…·æœ‰ä¸€ä¸ªç›¸åŒçš„åå­—ï¼Œä½†æ˜¯å®ƒåŒ…å«äº†ä¸€ä¸ª â€œ<strong>AttrChanged</strong>â€ çš„åç¼€ã€‚åˆæˆäº‹ä»¶å±æ€§å…è®¸åº“å»åˆ›å»ºä¸€ä¸ªä½¿ç”¨ <strong>@BindingAdapter</strong> æ³¨è§£çš„æ–¹æ³•ï¼Œä»¥ä¾¿å°†äº‹ä»¶ç›‘å¬å™¨ä¸ View çš„ç›¸åº”çš„å®ä¾‹ç›¸å…³è”ã€‚</p>
</blockquote>
<p>åœ¨å®è·µä¸­ï¼Œè¿™ä¸ªç›‘å¬å™¨ä¸­åŒ…å«äº†ä¸€äº›ä¸å¹³å‡¡çš„é€»è¾‘ï¼ŒåŒ…æ‹¬å•å‘æ•°æ®ç»‘å®šçš„ç›‘å¬å™¨ã€‚ä¸¾ä¾‹è§ text attribute change çš„ adapterï¼Œ<a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/TextViewBindingAdapter.java#344" target="_blank" rel="noopener">TextViewBindingAdapter</a></p>
<h2 id="è½¬æ¢å™¨"><a href="#è½¬æ¢å™¨" class="headerlink" title="è½¬æ¢å™¨"></a>è½¬æ¢å™¨</h2><p>å¦‚æœç»‘å®šåˆ°ä¸€ä¸ª <a href="https://developer.android.com/reference/android/view/View" target="_blank" rel="noopener"><code>View</code></a> çš„å˜é‡éœ€è¦åœ¨å±•ç¤ºå‡ºæ¥ä¹‹å‰è¢«æ ¼å¼åŒ–ï¼Œè½¬æ¢ï¼ŒæŸç§æ–¹æ³•ä¿®æ”¹ï¼Œå®ƒå¯èƒ½éœ€è¦ä¸€ä¸ª <code>Converter</code> å¯¹è±¡ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œç”¨ä¸€ä¸ª <code>EditText</code> å¯¹è±¡å±•ç¤ºä¸€ä¸ªæ—¥æœŸï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/birth_date"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">"@=&#123;Converter.dateToString(viewmodel.birthDate)&#125;"</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>viewmodel.birthDate</code> å±æ€§åŒ…å«äº†ä¸€ä¸ªç±»å‹ <code>Long</code> çš„å€¼ï¼Œæ‰€ä»¥å®ƒéœ€è¦é€šè¿‡ä¸€ä¸ªæŠ“æš–æ°”æ¥æ ¼å¼åŒ–ã€‚</p>
<p>å› ä¸ºæ­£åœ¨ä½¿ç”¨åŒå‘è¡¨è¾¾å¼ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¸€ä¸ªé€†è½¬æ¢å™¨ï¼Œè®©åº“çŸ¥é“å¦‚ä½•å°†ç”¨æˆ·æä¾›çš„å­—ç¬¦ä¸²è½¬æ¢å›æ”¯æŒæ•°æ®ç±»å‹ï¼Œåœ¨è¿™é‡Œæ˜¯ <code>Long</code>ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯é€šè¿‡å°† <a href="https://developer.android.com/reference/android/databinding/InverseMethod" target="_blank" rel="noopener"><code>@InverseMethod</code></a> æ³¨è§£æ·»åŠ åˆ°å…¶ä¸­ä¸€ä¸ªè½¬æ¢å™¨ä¸­ï¼Œå¹¶è®©è¿™ä¸ªæ‰¹æ³¨å¼•ç”¨é€†è½¬æ¢å™¨æ¥å®Œæˆçš„ã€‚æ­¤é…ç½®çš„ç¤ºä¾‹å‡ºç°åœ¨ä¸‹é¢çš„ä»£ç æ®µä¸­ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">object</span> Converter &#123;</span><br><span class="line">    <span class="meta">@InverseMethod(<span class="meta-string">"stringToDate"</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">dateToString</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        view: <span class="type">EditText</span>, oldValue: <span class="type">Long</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        value: <span class="type">Long</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span>: String &#123;</span><br><span class="line">        <span class="comment">// Converts long to String.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">stringToDate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        view: <span class="type">EditText</span>, oldValue: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        value: <span class="type">String</span></span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span>: <span class="built_in">Long</span> &#123;</span><br><span class="line">        <span class="comment">// Converts String to long.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨åŒå‘ç»‘å®šçš„æ­»å¾ªç¯"><a href="#ä½¿ç”¨åŒå‘ç»‘å®šçš„æ­»å¾ªç¯" class="headerlink" title="ä½¿ç”¨åŒå‘ç»‘å®šçš„æ­»å¾ªç¯"></a>ä½¿ç”¨åŒå‘ç»‘å®šçš„æ­»å¾ªç¯</h2><p>ä½¿ç”¨åŒå‘æ•°æ®ç»‘å®šæ—¶ï¼Œæ³¨æ„ä¸è¦å¼•å…¥æ­»å¾ªç¯ã€‚å½“ç”¨æˆ·æ”¹å˜ä¸€ä¸ªå±æ€§ï¼Œ<code>@InverseBindingAdapter</code> æ³¨è§£çš„æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œå¹¶å°†è¯¥å€¼åˆ†é…ç»™åç«¯å±æ€§ã€‚è¿™åè¿‡æ¥åˆä¼šè°ƒç”¨ä½¿ç”¨ <code>@BindingAdapter</code> æ³¨è§£çš„æ–¹æ³•ï¼Œè¿™å°†è§¦å‘å¯¹ä½¿ç”¨ <code>@InverseBindingAdapter</code> æ³¨è§£çš„æ–¹æ³•çš„å¦ä¸€ä¸ªè°ƒç”¨ï¼Œç­‰ç­‰ã€‚</p>
<p>å› ä¸ºè¿™ä¸ªåŸå› ï¼Œåœ¨ <code>@BindingAdapter</code> æ³¨è§£çš„æ–¹æ³•ä¸­é€šè¿‡å¯¹æ¯”æ–°æ—§çš„å€¼æ¥æ‰“ç ´æ½œåœ¨å¯èƒ½çš„æ­»å¾ªç¯æ˜¯å¾ˆé‡è¦çš„ã€‚</p>
<h2 id="åŒå‘å±æ€§"><a href="#åŒå‘å±æ€§" class="headerlink" title="åŒå‘å±æ€§"></a>åŒå‘å±æ€§</h2><p>å½“ä½ ä½¿ç”¨ä»¥ä¸‹è¡¨ä¸­å±æ€§æ—¶ï¼Œå¹³å°æä¾›äº†å†…ç½®çš„åŒå‘æ•°æ®ç»‘å®šã€‚æœ‰å…³å¹³å°å¦‚ä½•æä¾›æ­¤æ”¯æŒçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ç›¸åº” binding adapters çš„å®ç°:</p>
<table>
<thead>
<tr>
<th>ç±»</th>
<th>å±æ€§</th>
<th>Binding Adapter</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/AdapterView" target="_blank" rel="noopener">AdapterView</a></td>
<td>android:selectedItemPosition<br>android:selection</td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/AdapterViewBindingAdapter.java" target="_blank" rel="noopener">AdapterViewBindingAdapter</a></td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/CalendarView" target="_blank" rel="noopener">CalendarView</a></td>
<td>android:date</td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/CalendarViewBindingAdapter.java" target="_blank" rel="noopener">CalendarViewBindingAdapter</a></td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/CompoundButton" target="_blank" rel="noopener">CompoundButton</a></td>
<td><a href="https://developer.android.com/reference/android/R.attr#checked" target="_blank" rel="noopener">android:checked</a></td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/CompoundButtonBindingAdapter.java" target="_blank" rel="noopener">CompoundButtonBindingAdapter</a></td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/DatePicker" target="_blank" rel="noopener">DatePicker</a></td>
<td>android:year<br>android:month<br>android:day</td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/DatePickerBindingAdapter.java" target="_blank" rel="noopener">DatePickerBindingAdapter</a></td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/NumberPicker" target="_blank" rel="noopener">NumberPicker</a></td>
<td><a href="https://developer.android.com/reference/android/R.attr#value" target="_blank" rel="noopener">android:value</a></td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/NumberPickerBindingAdapter.java" target="_blank" rel="noopener">NumberPickerBindingAdapter</a></td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/RadioButton" target="_blank" rel="noopener">RadioButton</a></td>
<td><a href="https://developer.android.com/reference/android/R.attr#checkedButton" target="_blank" rel="noopener">android:checkedButton</a></td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/RadioGroupBindingAdapter.java" target="_blank" rel="noopener">RadioGroupBindingAdapter</a></td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/RatingBar" target="_blank" rel="noopener">RatingBar</a></td>
<td><a href="https://developer.android.com/reference/android/R.attr#rating" target="_blank" rel="noopener">android:rating</a></td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/RatingBarBindingAdapter.java" target="_blank" rel="noopener">RatingBarBindingAdapter</a></td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/SeekBar" target="_blank" rel="noopener">SeekBar</a></td>
<td><a href="https://developer.android.com/reference/android/R.attr#progress" target="_blank" rel="noopener">android:progress</a></td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/SeekBarBindingAdapter.java" target="_blank" rel="noopener">SeekBarBindingAdapter</a></td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/TabHost" target="_blank" rel="noopener">TabHost</a></td>
<td>android:currentTab</td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/TabHostBindingAdapter.java" target="_blank" rel="noopener">TabHostBindingAdapter</a></td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/TextView" target="_blank" rel="noopener">TextView</a></td>
<td><a href="https://developer.android.com/reference/android/R.attr#text" target="_blank" rel="noopener">android:text</a></td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/TextViewBindingAdapter.java" target="_blank" rel="noopener">TextViewBindingAdapter</a></td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/TimePicker" target="_blank" rel="noopener">TimePicker</a></td>
<td>android:hour<br>android:minute</td>
<td><a href="https://android.googlesource.com/platform/frameworks/data-binding/+/3b920788e90bb0abe615a5d5c899915f0014444b/extensions/baseAdapters/src/main/java/android/databinding/adapters/TimePickerBindingAdapter.java" target="_blank" rel="noopener">TimePickerBindingAdapter</a></td>
</tr>
</tbody>
</table>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component DataBinding -- Architectureï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_binding_architecture/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-DataBinding-â€“-Architectureï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-DataBinding-â€“-Architectureï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component DataBinding â€“ Architectureï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component DataBinding â€“ Architectureï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/data-binding/architecture" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/data-binding/architecture</a></p>
</blockquote>
<p>AndroidX åº“åŒ…å«äº† <a href="https://developer.android.com/topic/libraries/architecture/index.html" target="_blank" rel="noopener">Architecture Components</a>ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥è®¾è®¡å…·æœ‰é²æ£’æ€§ï¼Œå¯æµ‹è¯•æ€§ï¼Œå¯ç»´æŠ¤æ€§çš„ appsã€‚Data Binding åº“ä¸ Architecture Components æ— ç¼åä½œï¼Œä»¥è¿›ä¸€æ­¥ç®€åŒ–äº† UI çš„å¼€å‘ã€‚åœ¨ Architecture Components ä¸­ï¼Œä½  app çš„ layout å¯ä»¥ç»‘å®šåˆ°æ•°æ®ï¼Œå®ƒå·²ç»å¸®åŠ©ä½ ç®¡ç† UI æ§åˆ¶å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶é€šçŸ¥æœ‰å…³æ•°æ®ä¸­çš„æ”¹åŠ¨ã€‚</p>
<p>æœ¬æ–‡å±•ç¤ºå¦‚ä½•æŠŠ Architecture Components ç»§æ‰¿è¿›ä½ çš„ appï¼Œæ¥è®©ä½ çš„ app è¿›ä¸€æ­¥å¢å¼ºä½¿ç”¨ Data Binding åº“çš„å¥½å¤„ã€‚</p>
<h2 id="ä½¿ç”¨-LiveData-æ¥é€šçŸ¥-UI-æ•°æ®çš„æ›´æ”¹"><a href="#ä½¿ç”¨-LiveData-æ¥é€šçŸ¥-UI-æ•°æ®çš„æ›´æ”¹" class="headerlink" title="ä½¿ç”¨ LiveData æ¥é€šçŸ¥ UI æ•°æ®çš„æ›´æ”¹"></a>ä½¿ç”¨ LiveData æ¥é€šçŸ¥ UI æ•°æ®çš„æ›´æ”¹</h2><p>ä½ å¯ä»¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡ä½œä¸º data binding æºåœ¨æ•°æ®å˜åŒ–æ—¶å€™è‡ªåŠ¨é€šçŸ¥ UIã€‚æ›´å¤š Architecture Component ç›¸å…³è¯¦æƒ…è§ <a href="https://developer.android.com/topic/libraries/architecture/livedata" target="_blank" rel="noopener">LiveData æ¦‚è¦</a>ã€‚</p>
<p>ä¸åƒå®ç° <a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener"><code>Observable</code></a> â€”â€” æ¯”å¦‚ <a href=""> observable fields</a> â€”â€” <code>LiveData</code> å¯¹è±¡çŸ¥é“è§‚å¯Ÿè€…è®¢é˜…æ•°æ®å˜åŒ–çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™ç‚¹å¯ä»¥å¼•å‘å¾ˆå¤šå¥½å¤„ï¼Œè¿™å·²ç»åœ¨ <a href="https://developer.android.com/topic/libraries/architecture/livedata.html#the_advantages_of_using_livedata" target="_blank" rel="noopener">LiveData çš„ä¼˜åŠ¿</a> ä¸­è§£é‡Šäº†ã€‚åœ¨ Android Studio 3.1 åŠä»¥ä¸Šï¼Œä½ å¯ä»¥åœ¨ä½ çš„ data binding ä»£ç ä¸­ç”¨ <code>LiveData</code> å¯¹è±¡ æ›¿æ¢ <a href="https://developer.android.com/topic/libraries/data-binding/observability.html#observable_fields" target="_blank" rel="noopener">observable fields</a>ã€‚</p>
<p>è¦åœ¨ä½ çš„ç»‘å®šç±»ä¸­ä½¿ç”¨ <code>LiveData</code> å¯¹è±¡ï¼Œä½ éœ€è¦æŒ‡å®šä¸€ä¸ª lifecycle owner æ¥å®šä¹‰ <code>LiveData</code> å¯¹è±¡çš„èŒƒå›´ã€‚ä¸‹é¢çš„ä¾‹å­åœ¨ç»‘å®šç±»åˆå§‹åŒ–åï¼ŒæŒ‡å®šäº†è¿™ä¸ª activity ä½œä¸º lifecycle ownerï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewModelActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="comment">// Inflate view and obtain an instance of the binding class.</span></span><br><span class="line">        <span class="keyword">val</span> binding: UserBinding = DataBindingUtil.setContentView(<span class="keyword">this</span>, R.layout.user)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Specify the current activity as the lifecycle owner.</span></span><br><span class="line">        binding.setLifecycleOwner(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ ä½¿ç”¨äº†ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel" target="_blank" rel="noopener">ViewModel</a> ç»„ä»¶ï¼Œåœ¨ <a href="https://developer.android.com/topic/libraries/data-binding/architecture#viewmodel" target="_blank" rel="noopener">ä½¿ç”¨ ViewModel ç®¡ç† UI ç›¸å…³çš„æ•°æ®</a>ä¸­è§£é‡Šï¼Œæ¥ç»‘å®šæ•°æ®åˆ° layoutã€‚åœ¨ <code>ViewModel</code> ç»„ä»¶ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>LiveData</code> æ¥æ”¹å˜æ•°æ®æˆ–åˆå¹¶å¤šä¸ªæ•°æ®æºã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•æ”¹å˜ <code>ViewModel</code> ä¸­çš„æ•°æ®æºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ScheduleViewModel</span> : <span class="type">ViewModel</span></span>() &#123;</span><br><span class="line">    <span class="keyword">val</span> userName: LiveData</span><br><span class="line"></span><br><span class="line">    init &#123;</span><br><span class="line">        <span class="keyword">val</span> result = Repository.userName</span><br><span class="line">        userName = Transformations.map(result) &#123; result -&gt; result.value &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨-ViewModel-ç®¡ç†-UI-ç›¸å…³çš„æ•°æ®"><a href="#ä½¿ç”¨-ViewModel-ç®¡ç†-UI-ç›¸å…³çš„æ•°æ®" class="headerlink" title="ä½¿ç”¨ ViewModel ç®¡ç† UI ç›¸å…³çš„æ•°æ®"></a>ä½¿ç”¨ ViewModel ç®¡ç† UI ç›¸å…³çš„æ•°æ®</h2><p>Data Binding åº“ä¸ <code>ViewModel</code> ç»„ä»¶æ— ç¼åä½œï¼Œå®ƒæš´éœ² layout observes æ•°æ®å¹¶å¯¹å…¶æ›´æ”¹åšå‡ºååº”ã€‚ä¸ Data Binding ä½¿ç”¨ <code>ViewModel</code> ç»„ä»¶å…è®¸ä½ æŠŠ UI é€»è¾‘ä» layout ç§»åŠ¨åˆ°ç»„ä»¶ä¸­ï¼Œä½¿å¾—æ›´å®¹æ˜“æµ‹è¯•ã€‚Data Binding åº“ç¡®ä¿åœ¨éœ€è¦æ—¶ä»æ•°æ®æºç»‘å®šå’Œå–æ¶ˆç»‘å®š viewsã€‚å‰©ä¸‹çš„å¤§éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯ä¸ºäº†ç¡®ä¿ä½ æš´éœ²äº†æ­£ç¡®çš„æ•°æ®ã€‚æ›´å¤šå…³äºè¿™ä¸ª Architecture Componentï¼Œè§ <a href="https://developer.android.com/topic/libraries/architecture/viewmodel.html" target="_blank" rel="noopener">ViewModel æ¦‚è¦</a>ã€‚</p>
<p>è¦å°† <code>ViewModel</code> ç»„ä»¶ä¸ Data Binding åº“ä¸€èµ·ä½¿ç”¨ï¼Œä½ å¿…é¡»è¦å®ä¾‹åŒ–ä½ çš„ç»„ä»¶ï¼Œå®ƒç»§æ‰¿è‡ª <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener">ViewModel</a> ç±»ï¼Œè·å–ä¸€ä¸ªä½ ç»‘å®šç±»çš„å®ä¾‹ï¼Œç„¶åæŠŠ <code>ViewModel</code> ç»„ä»¶èµ‹å€¼åˆ°ç»‘å®šç±»ä¸­ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•è·Ÿåº“ä¸€èµ·ä½¿ç”¨ç»„å»ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewModelActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="comment">// Obtain the ViewModel component.</span></span><br><span class="line">        UserModel userModel = ViewModelProviders.of(getActivity())</span><br><span class="line">                                                  .<span class="keyword">get</span>(UserModel.<span class="keyword">class</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Inflate view and obtain an instance of the binding class.</span></span><br><span class="line">        <span class="keyword">val</span> binding: UserBinding = DataBindingUtil.setContentView(<span class="keyword">this</span>, R.layout.user)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Assign the component to a property in the binding class.</span></span><br><span class="line">        binding.viewmodel = userModel</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä½ çš„ layout ä¸­ï¼Œåœ¨ä½ çš„ views ç»‘å®šè¡¨è¾¾å¼ä¸­åˆ†é…ç›¸åº”çš„ <code>ViewModel</code> ç»„ä»¶çš„å±æ€§å’Œæ–¹æ³•ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">CheckBox</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/rememberMeCheckBox"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:checked</span>=<span class="string">"@&#123;viewmodel.rememberMe&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:onCheckedChanged</span>=<span class="string">"@&#123;() -&gt; viewmodel.rememberMeChanged()&#125;"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨ä¸€ä¸ª-Observable-ViewModel-å¯¹-binding-adapters-è¿›è¡Œæ›´å¤šçš„æ§åˆ¶"><a href="#ä½¿ç”¨ä¸€ä¸ª-Observable-ViewModel-å¯¹-binding-adapters-è¿›è¡Œæ›´å¤šçš„æ§åˆ¶" class="headerlink" title="ä½¿ç”¨ä¸€ä¸ª Observable ViewModel å¯¹ binding adapters è¿›è¡Œæ›´å¤šçš„æ§åˆ¶"></a>ä½¿ç”¨ä¸€ä¸ª Observable ViewModel å¯¹ binding adapters è¿›è¡Œæ›´å¤šçš„æ§åˆ¶</h2><p>ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ç»„ä»¶å®ç° <a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener"><code>Observable</code></a> åœ¨æ•°æ®æ”¹å˜æ—¶é€šçŸ¥å…¶å®ƒ app ç»„ä»¶ï¼Œå°±åƒå¦‚ä½•ä½¿ç”¨ <a href="https://developer.android.com/reference/android/arch/lifecycle/LiveData" target="_blank" rel="noopener"><code>LiveData</code></a> å¯¹è±¡ã€‚</p>
<p>åœ¨æŸäº›æƒ…å†µä¸‹, æ‚¨å¯èƒ½æ›´å–œæ¬¢ä½¿ç”¨å®ç° <a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener"><code>Observable</code></a> æ¥å£çš„ <code>ViewModel</code> ç»„ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ <code>LiveData</code> å¯¹è±¡ï¼Œå³ä½¿å¤±å» <code>LiveData</code> çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†åŠŸèƒ½ã€‚ä½¿ç”¨å®ç° <code>Observable</code> çš„ <code>ViewModel</code> ç»„ä»¶å¯è®©ä½ æ›´å¥½åœ°æ§åˆ¶åº”ç”¨ä¸­çš„binding adaptersã€‚ä¸¾ä¾‹ï¼Œè¿™ä¸ªæ¨¡å¼è®©ä½ å¯ä»¥æ›´å¥½åœ°æ§åˆ¶æ•°æ®æ›´æ”¹æ—¶çš„é€šçŸ¥ï¼Œå®ƒè¿˜å…è®¸ä½ æŒ‡å®šè‡ªå®šä¹‰æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨åŒå‘æ•°æ®ç»‘å®šä¸­è®¾ç½®å±æ€§çš„å€¼ã€‚</p>
<p>è¦å®ç°ä¸€ä¸ª observable <code>ViewModel</code> ç»„ä»¶ï¼Œä½ å¿…é¡»åˆ›å»ºä¸€ä¸ªç±»ç»§æ‰¿ <a href="https://developer.android.com/reference/android/arch/lifecycle/ViewModel.html" target="_blank" rel="noopener"><code>ViewModel</code></a> ç±»å¹¶å®ç° <a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener"><code>Observable</code></a> æ¥å£ã€‚å½“ä¸€ä¸ªè§‚å¯Ÿè€…è®¢é˜…æˆ–å–æ¶ˆè®¢é˜…æ¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/databinding/Observable.html#addOnPropertyChangedCallback(android.databinding.Observable.OnPropertyChangedCallback" target="_blank" rel="noopener"><code>addOnPropertyChangedCallback()</code></a>) å’Œ <a href="https://developer.android.com/reference/android/databinding/Observable.html#removeOnPropertyChangedCallback(android.databinding.Observable.OnPropertyChangedCallback" target="_blank" rel="noopener"><code>removeOnPropertyChangedCallback()</code></a>) è¿›è¡Œé€šçŸ¥æ—¶ï¼Œä½ å¯ä»¥æä¾›è‡ªå®šä¹‰é€»è¾‘ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨å±æ€§æ”¹å˜æ—¶è¿è¡Œåœ¨ <a href="https://developer.android.com/reference/android/databinding/BaseObservable.html#notifyPropertyChanged(int" target="_blank" rel="noopener"><code>notifyPropertyChanged()</code></a>) æ–¹æ³•ä¸­æ—¶æä¾›è‡ªå®šä¹‰é€»è¾‘ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•å®ç°ä¸€ä¸ª observable <code>ViewModel</code>ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A ViewModel that is also an Observable,</span></span><br><span class="line"><span class="comment"> * to be used with the Data Binding Library.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">ObservableViewModel</span> : <span class="type">ViewModel</span></span>(), Observable &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> callbacks: PropertyChangeRegistry = PropertyChangeRegistry()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">addOnPropertyChangedCallback</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            callback: <span class="type">Observable</span>.<span class="type">OnPropertyChangedCallback</span>)</span></span> &#123;</span><br><span class="line">        callbacks.add(callback)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">removeOnPropertyChangedCallback</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            callback: <span class="type">Observable</span>.<span class="type">OnPropertyChangedCallback</span>)</span></span> &#123;</span><br><span class="line">        callbacks.remove(callback)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Notifies observers that all properties of this instance have changed.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">notifyChange</span><span class="params">()</span></span> &#123;</span><br><span class="line">        callbacks.notifyCallbacks(<span class="keyword">this</span>, <span class="number">0</span>, <span class="literal">null</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Notifies observers that a specific property has changed. The getter for the</span></span><br><span class="line"><span class="comment">     * property that changes should be marked with the <span class="doctag">@Bindable</span> annotation to</span></span><br><span class="line"><span class="comment">     * generate a field in the BR class to be used as the fieldId parameter.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fieldId The generated BR id for the Bindable field.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">notifyPropertyChanged</span><span class="params">(fieldId: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">        callbacks.notifyCallbacks(<span class="keyword">this</span>, fieldId, <span class="literal">null</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component DataBinding -- Binding adaptersï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_binding_adapters/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-DataBinding-â€“-Binding-adaptersï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-DataBinding-â€“-Binding-adaptersï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component DataBinding â€“ Binding adaptersï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component DataBinding â€“ Binding adaptersï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/data-binding/binding-adapters" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/data-binding/binding-adapters</a></p>
</blockquote>
<p>Binding adapters è´Ÿè´£å¯¹è®¾ç½®å€¼è¿›è¡Œé€‚å½“çš„æ¡†æ¶è°ƒç”¨ã€‚ä¸€ä¸ªä¾‹å­æ˜¯åƒè°ƒç”¨ <a href="https://developer.android.com/reference/android/widget/TextView.html#setText(char[],%20int,%20int" target="_blank" rel="noopener"><code>setText()</code></a>) æ–¹æ³•å»è®¾ç½®å±æ€§å€¼ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯åƒè°ƒç”¨ <a href="https://developer.android.com/reference/android/view/View.html#setOnClickListener(android.view.View.OnClickListener" target="_blank" rel="noopener"><code>setOnClickListener()</code></a>) æ–¹æ³•å»è®¾ç½®ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ã€‚</p>
<p>Data Binding åº“å…è®¸ä½ å»æŒ‡å®šè®¾ç½®ä¸€ä¸ªå€¼çš„æ–¹æ³•ï¼Œæä¾›ä½ è‡ªå·±çš„ç»‘å®šé€»è¾‘ï¼Œä»¥åŠé€šè¿‡ä½¿ç”¨ adapters æ¥æŒ‡å®šè¿”å›å¯¹è±¡çš„ç±»å‹ã€‚</p>
<h2 id="è®¾ç½®å±æ€§å€¼"><a href="#è®¾ç½®å±æ€§å€¼" class="headerlink" title="è®¾ç½®å±æ€§å€¼"></a>è®¾ç½®å±æ€§å€¼</h2><p>æ¯å½“ç»‘å®šçš„å€¼æ”¹å˜ï¼Œç”Ÿæˆçš„ç»‘å®šç±»å¿…é¡»è°ƒç”¨ä¸€ä¸ª view çš„è¡¨è¾¾å¼ çš„ setter æ–¹æ³•ã€‚ä½ å¯ä»¥è®© Data Binding è‡ªåŠ¨ç¡®å®šæ–¹æ³•ï¼Œæ˜¾å¼å£°æ˜æ–¹æ³•æˆ–æä¾›è‡ªå®šä¹‰é€»è¾‘ä»¥é€‰æ‹©æ–¹æ³•ã€‚</p>
<h3 id="è‡ªåŠ¨é€‰æ‹©æ–¹æ³•"><a href="#è‡ªåŠ¨é€‰æ‹©æ–¹æ³•" class="headerlink" title="è‡ªåŠ¨é€‰æ‹©æ–¹æ³•"></a>è‡ªåŠ¨é€‰æ‹©æ–¹æ³•</h3><p>å¯¹äºåä¸º <code>name</code> çš„å±æ€§ï¼Œåº“ä¼šè‡ªåŠ¨å°è¯•å¯»æ‰¾æ–¹æ³• <code>setExample(arg)</code>ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›¸åº”çš„ç±»å‹ä½œä¸ºå‚æ•°ã€‚ä¸è€ƒè™‘å±æ€§çš„å‘½åç©ºé—´ï¼Œåœ¨æœç´¢æ–¹æ³•æ—¶åªä½¿ç”¨å±æ€§åç§°å’Œç±»å‹ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œç»™å®š <code>android:text=&quot;@{user.name}&quot;</code> è¡¨è¾¾å¼ï¼Œåº“ä¼šè‡ªåŠ¨å¯»æ‰¾ä¸€ä¸ª <code>setText(args)</code> çš„æ–¹æ³•ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª <code>user.getName()</code> è¿”å›å€¼çš„ç±»å‹çš„å‚æ•°ã€‚å¦‚æœ <code>user.getName()</code> è¿”å›ç±»å‹æ˜¯ <code>String</code>ï¼Œåº“ä¼šå»å¯»æ‰¾ä¸€ä¸ªæ¥æ”¶ä¸€ä¸ª <code>String</code> ç±»å‹å‚æ•°çš„ <code>setText()</code> æ–¹æ³•ã€‚å¦‚æœ <code>user.getName()</code> è¿”å›ç±»å‹æ˜¯ <code>int</code>ï¼Œåº“ä¼šå»å¯»æ‰¾ä¸€ä¸ªæ¥æ”¶ä¸€ä¸ª <code>int</code> ç±»å‹å‚æ•°çš„ <code>setText()</code> æ–¹æ³•ã€‚è¡¨è¾¾å¼å¿…é¡»è¿”å›æ­£ç¡®çš„ç±»å‹ï¼Œå¿…è¦æ—¶ä½ å¯ä»¥å»å¯¹è¿”å›å€¼è¿›è¡Œè½¬å‹ã€‚</p>
<p>ç”šè‡³æ²¡æœ‰ç»™å®šåå­—çš„å±æ€§å­˜åœ¨ï¼ŒData Binding ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚ä½ å¯ä»¥é€šè¿‡ data binding ä¸ºä»»ä½• setter åˆ›å»ºå±æ€§ã€‚ä¸‹é¢ layout è‡ªåŠ¨ä½¿ç”¨ <a href="https://developer.android.com/reference/android/support/v4/widget/DrawerLayout.html#setScrimColor(int" target="_blank" rel="noopener"><code>setScrimColor(int)</code></a>) å’Œ <a href="https://developer.android.com/reference/android/support/v4/widget/DrawerLayout.html#setDrawerListener(android.support.v4.widget.DrawerLayout.DrawerListener" target="_blank" rel="noopener"><code>setDrawerListener(DrawerListener)</code></a>) æ–¹æ³•ä½œä¸º <code>app:scrimColor</code> å’Œ <code>app:drawerListener</code> å±æ€§çš„ setter æ–¹æ³•ã€‚åˆ†åˆ«ä¸ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:scrimColor</span>=<span class="string">"@&#123;@color/scrim&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:drawerListener</span>=<span class="string">"@&#123;fragment.drawerListener&#125;"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="æŒ‡å®šè‡ªå®šä¹‰æ–¹æ³•å"><a href="#æŒ‡å®šè‡ªå®šä¹‰æ–¹æ³•å" class="headerlink" title="æŒ‡å®šè‡ªå®šä¹‰æ–¹æ³•å"></a>æŒ‡å®šè‡ªå®šä¹‰æ–¹æ³•å</h3><p>ä¸€äº›å±æ€§çš„ setter ä¸åç§°ä¸åŒ¹é…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå±æ€§å¯ä»¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/databinding/BindingMethods.html" target="_blank" rel="noopener"><code>BindingMethods</code></a> æ³¨è§£è¿›è¡Œ setter çš„å…³è”ã€‚æ³¨è§£å¯ä»¥ä¸ç±»ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶ä¸”å¯ä»¥åŒ…å«å¤šä¸ª <a href="https://developer.android.com/reference/android/databinding/BindingMethod.html" target="_blank" rel="noopener"><code>BindingMethod</code></a> æ³¨è§£ï¼Œæ¯ä¸€ä¸ªéƒ½æœ‰ä¸€ä¸ªé‡å‘½åçš„æ–¹æ³•ã€‚BindingMethods æ³¨è§£å¯ä»¥è¢«åŠ åœ¨ä½  app ä¸­çš„ä»»ä½•ç±»ä¸Šé¢ã€‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ<code>android:tint</code> å±æ€§ä¸ <a href="https://developer.android.com/reference/android/widget/ImageView.html#setImageTintList(android.content.res.ColorStateList" target="_blank" rel="noopener"><code>setImageTintList(ColorStateList)</code></a>) æ–¹æ³•å…³è”ï¼Œè€Œä¸æ˜¯ <code>setTint()</code> æ–¹æ³•ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingMethods(value = [</span></span><br><span class="line"><span class="meta">    BindingMethod(</span></span><br><span class="line"><span class="meta">        type = android.widget.ImageView::class,</span></span><br><span class="line"><span class="meta">        attribute = <span class="meta-string">"android:tint"</span>,</span></span><br><span class="line"><span class="meta">        method = <span class="meta-string">"setImageTintList"</span>)</span>])</span><br></pre></td></tr></table></figure>
<p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦é‡å‘½å Android Framework ç±»ä¸­çš„ settersã€‚å±æ€§å·²ç»ä½¿ç”¨åç§°çº¦å®šå®ç°äº†è‡ªåŠ¨æŸ¥æ‰¾åŒ¹é…æ–¹æ³•ã€‚</p>
<h3 id="æä¾›è‡ªå®šä¹‰é€»è¾‘"><a href="#æä¾›è‡ªå®šä¹‰é€»è¾‘" class="headerlink" title="æä¾›è‡ªå®šä¹‰é€»è¾‘"></a>æä¾›è‡ªå®šä¹‰é€»è¾‘</h3><p>ä¸€äº›å±æ€§éœ€è¦è‡ªå®šä¹‰ç»‘å®šé€»è¾‘ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ²¡æœ‰ä¸€ä¸ªä¸ <code>android:paddingLeft</code> å±æ€§å…³è”çš„ setterã€‚ä½†æ˜¯æä¾›äº† <code>setPadding(left, top, right, bottom)</code>ã€‚ä¸€ä¸ªå¸¦æœ‰ <a href="https://developer.android.com/reference/android/databinding/BindingAdapter.html" target="_blank" rel="noopener"><code>BindingAdapter</code></a> æ³¨è§£çš„ï¼Œé™æ€çš„ binding adapter æ–¹æ³•å¯ä»¥å…è®¸ä½ è‡ªå®šä¹‰å±æ€§è°ƒç”¨çš„ setter æ˜¯æ€ä¹ˆæ ·çš„ã€‚</p>
<p>Android Framework ç±»çš„å±æ€§å·²ç»åˆ›å»ºäº† <code>BindingAdapter</code> æ³¨è§£ã€‚ä¸¾ä¾‹ï¼Œä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº† <code>paddingLeft</code> å±æ€§çš„ binding adapterï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(<span class="meta-string">"android:paddingLeft"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setPaddingLeft</span><span class="params">(view: <span class="type">View</span>, padding: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">    view.setPadding(padding,</span><br><span class="line">                view.getPaddingTop(),</span><br><span class="line">                view.getPaddingRight(),</span><br><span class="line">                view.getPaddingBottom())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‚æ•°ç±»å‹æ˜¯å¾ˆé‡è¦çš„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å†³å®šäº†ä¸å±æ€§ç›¸å…³è”çš„ view çš„ç±»å‹ã€‚ç¬¬äºŒä¸ªå‚æ•°å†³å®šäº†ç»™å®šå±æ€§è¡¨è¾¾å¼ä¸­æ¥æ”¶çš„ç±»å‹ã€‚</p>
<p>Binding adapter å¯¹å…¶å®ƒç±»å‹çš„è‡ªå®šä¹‰æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚ä¸¾ä¾‹ï¼Œä¸€ä¸ªå·¥ä½œçº¿ç¨‹ä¸­è‡ªå®šä¹‰åŠ è½½å™¨å¯ä»¥è¢«è°ƒç”¨æ¥åŠ è½½å›¾ç‰‡ã€‚</p>
<p>å¦‚æœä¸ Android Framework å†²çªï¼Œä½ å®šä¹‰çš„ binding adapters ä¼šè¦†ç›–å®ƒã€‚</p>
<p>ä½ çš„ adapters ä¹Ÿå¯ä»¥æ¥æ”¶å¤šä¸ªå±æ€§ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(<span class="meta-string">"imageUrl"</span>, <span class="meta-string">"error"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">loadImage</span><span class="params">(view: <span class="type">ImageView</span>, url: <span class="type">String</span>, error: <span class="type">Drawable</span>)</span></span> &#123;</span><br><span class="line">    Picasso.<span class="keyword">get</span>().load(url).error(error).into(view)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥å¦‚ä¸‹åœ¨ä½ çš„ layout ä¸­ä½¿ç”¨ adapterã€‚æ³¨æ„ï¼Œ<code>@drawable/venueError</code> å¼•ç”¨äº†ä½  app ä¸­çš„ resourceã€‚ä½¿ç”¨ <code>@{}</code> åŒ…å›´ä½¿å®ƒæˆä¸ºä¸€ä¸ªåˆæ³•çš„ binding è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ImageView</span> <span class="attr">app:imageUrl</span>=<span class="string">"@&#123;venue.imageUrl&#125;"</span> <span class="attr">app:error</span>=<span class="string">"@&#123;@drawable/venueError&#125;"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Data Binding Library å¿½ç•¥äº†è‡ªå®šä¹‰å‘½åç©ºé—´ä»¥ç”¨äºåŒ¹é…ã€‚</p>
</blockquote>
<p>å¦‚æœï¼Œ<code>imageUrl</code> å’Œ <code>error</code> éƒ½è¢« <a href="https://developer.android.com/reference/android/widget/ImageView.html" target="_blank" rel="noopener"><code>ImageView</code></a> å¯¹è±¡ä½¿ç”¨ï¼Œå¹¶ä¸” <code>imageUrl</code> æ˜¯ä¸€ä¸ª Stringï¼Œ<code>error</code> æ˜¯ä¸€ä¸ª <a href="https://developer.android.com/reference/android/graphics/drawable/Drawable.html" target="_blank" rel="noopener"><code>Drawable</code></a>ï¼Œadapter å°±ä¼šè¢«è°ƒç”¨ã€‚å¦‚æœä½ å¸Œæœ›å®ƒä»¬ä»»ä½•å±æ€§è¢«è°ƒç”¨æ—¶å°±è®© adapter è°ƒç”¨ï¼Œä½ å¯ä»¥è®¾ç½® <a href="https://developer.android.com/reference/android/databinding/BindingAdapter.html#requireAll(" target="_blank" rel="noopener"><code>requireAll</code></a>) æ ‡å¿—ä¸º <code>false</code>ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(value = [<span class="meta-string">"imageUrl"</span>, <span class="meta-string">"placeholder"</span>], requireAll = false)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setImageUrl</span><span class="params">(imageView: <span class="type">ImageView</span>, url: <span class="type">String</span>, placeHolder: <span class="type">Drawable</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (url == <span class="literal">null</span>) &#123;</span><br><span class="line">        imageView.setImageDrawable(placeholder);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        MyImageLoader.loadInto(imageView, url, placeholder);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å½“æœ‰å†²çªæ—¶ï¼Œä½ çš„ binding adapters è¦†ç›–é»˜è®¤çš„ data binding adaptersã€‚</p>
</blockquote>
<p>Binding adapter æ–¹æ³•å¯ä»¥é€‰æ‹©åœ¨å¤„ç†å™¨ä¸­è¿”å›æ—§å€¼ã€‚ä¸€ä¸ªæ–¹æ³•å£°æ˜æ—§å€¼å’Œæ–°å€¼æ—¶åº”è¯¥é¦–å…ˆå£°æ˜ <em>æ‰€æœ‰</em> å±æ€§çš„æ—§å€¼ï¼Œç„¶åå†æ˜¯æ–°å€¼ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(<span class="meta-string">"android:paddingLeft"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setPaddingLeft</span><span class="params">(view: <span class="type">View</span>, oldPadding: <span class="type">Int</span>, newPadding: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (oldPadding != newPadding) &#123;</span><br><span class="line">        view.setPadding(padding,</span><br><span class="line">                    view.getPaddingTop(),</span><br><span class="line">                    view.getPaddingRight(),</span><br><span class="line">                    view.getPaddingBottom())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>äº‹ä»¶å¤„ç†å™¨åªèƒ½ä¸åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£æˆ–æŠ½è±¡ç±»ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(<span class="meta-string">"android:onLayoutChange"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setOnLayoutChangeListener</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        view: <span class="type">View</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">        oldValue: <span class="type">View</span>.<span class="type">OnLayoutChangeListener</span>?,</span></span></span><br><span class="line"><span class="function"><span class="params">        newValue: <span class="type">View</span>.<span class="type">OnLayoutChangeListener</span>?</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB) &#123;</span><br><span class="line">        <span class="keyword">if</span> (oldValue != <span class="literal">null</span>) &#123;</span><br><span class="line">            view.removeOnLayoutChangeListener(oldValue)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (newValue != <span class="literal">null</span>) &#123;</span><br><span class="line">            view.addOnLayoutChangeListener(newValue)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸‹åœ¨ä½ çš„ layout ä¸­ä½¿ç”¨äº‹ä»¶å¤„ç†å™¨ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">View</span> <span class="attr">android:onLayoutChange</span>=<span class="string">"@&#123;() -&gt; handler.layoutChanged()&#125;"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>å½“ä¸€ä¸ªç›‘å¬å™¨æœ‰å¤šä¸ªæ–¹æ³•ï¼Œå¿…é¡»è¦æŠŠå®ƒåˆ†å‰²æˆå¤šä¸ªç›‘å¬å™¨ã€‚æ¯”å¦‚ï¼Œ<a href="https://developer.android.com/reference/android/view/View.OnAttachStateChangeListener.html" target="_blank" rel="noopener"><code>View.OnAttachStateChangeListener</code></a> æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š<a href="https://developer.android.com/reference/android/view/View.OnAttachStateChangeListener.html#onViewAttachedToWindow(android.view.View" target="_blank" rel="noopener"><code>onViewAttachedToWindow(View)</code></a>) å’Œ <a href="https://developer.android.com/reference/android/view/View.OnAttachStateChangeListener.html#onViewDetachedFromWindow(android.view.View" target="_blank" rel="noopener"><code>onViewDetachedFromWindow(View)</code></a>)ã€‚å¯¹æ­¤ï¼Œåº“æä¾›äº†ä¸¤ä¸ªæ¥å£æ¥åŒºåˆ†å±æ€§å’Œå¤„ç†å™¨ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Translation from provided interfaces in Java:</span></span><br><span class="line"><span class="meta">@TargetApi(Build.VERSION_CODES.HONEYCOMB_MR1)</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">OnViewDetachedFromWindow</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onViewDetachedFromWindow</span><span class="params">(v: <span class="type">View</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TargetApi(Build.VERSION_CODES.HONEYCOMB_MR1)</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">OnViewAttachedToWindow</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onViewAttachedToWindow</span><span class="params">(v: <span class="type">View</span>)</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæ”¹å˜å…¶ä¸­ä¸€ä¸ªç›‘å¬å™¨ä¹Ÿä¼šå½±å“å¦ä¸€ä¸ªï¼Œæ‰€ä»¥ä½ éœ€è¦ä¸€ä¸ªä»»æ„æˆ–è€…å…¨éƒ¨å±æ€§çš„ adapterã€‚ä½ å¯ä»¥åœ¨æ³¨è§£ä¸­è®¾ç½® <a href="https://developer.android.com/reference/android/databinding/BindingAdapter.html#requireAll(" target="_blank" rel="noopener"><code>requireAll</code></a>) ä¸º <code>false</code> æ¥æŒ‡å®šä¸æ˜¯æ‰€æœ‰å±æ€§éƒ½å¿…é¡»è®¾ç½®ä¸€ä¸ªç»‘å®šè¡¨è¾¾å¼ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(</span></span><br><span class="line"><span class="meta">        <span class="meta-string">"android:onViewDetachedFromWindow"</span>,</span></span><br><span class="line"><span class="meta">        <span class="meta-string">"android:onViewAttachedToWindow"</span>,</span></span><br><span class="line"><span class="meta">        requireAll = false</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">setListener</span><span class="params">(view: <span class="type">View</span>, detach: <span class="type">OnViewDetachedFromWindow</span>?, attach: <span class="type">OnViewAttachedToWindow</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB_MR1) &#123;</span><br><span class="line">        <span class="keyword">val</span> newListener: View.OnAttachStateChangeListener?</span><br><span class="line">        newListener = <span class="keyword">if</span> (detach == <span class="literal">null</span> &amp;&amp; attach == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="literal">null</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">object</span> : View.OnAttachStateChangeListener &#123;</span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onViewAttachedToWindow</span><span class="params">(v: <span class="type">View</span>)</span></span> &#123;</span><br><span class="line">                    attach?.onViewAttachedToWindow(v)</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onViewDetachedFromWindow</span><span class="params">(v: <span class="type">View</span>)</span></span> &#123;</span><br><span class="line">                    detach?.onViewDetachedFromWindow(v)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> oldListener: View.OnAttachStateChangeListener? =</span><br><span class="line">                ListenerUtil.trackListener(view, newListener, R.id.onAttachStateChangeListener)</span><br><span class="line">        <span class="keyword">if</span> (oldListener != <span class="literal">null</span>) &#123;</span><br><span class="line">            view.removeOnAttachStateChangeListener(oldListener)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (newListener != <span class="literal">null</span>) &#123;</span><br><span class="line">            view.addOnAttachStateChangeListener(newListener)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­æ¯”ä¸€èˆ¬çš„ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œå› ä¸º <a href="https://developer.android.com/reference/android/view/View.html" target="_blank" rel="noopener"><code>View</code></a> ç±»ä½¿ç”¨ <a href="https://developer.android.com/reference/android/view/View.html#addOnAttachStateChangeListener(android.view.View.OnAttachStateChangeListener" target="_blank" rel="noopener"><code>addOnAttachStateChangeListener()</code></a>) å’Œ <a href="https://developer.android.com/reference/android/view/View.html#removeOnAttachStateChangeListener(android.view.View.OnAttachStateChangeListener" target="_blank" rel="noopener"><code>removeOnAttachStateChangeListener()</code></a>) æ–¹æ³•è€Œä¸æ˜¯ <a href="https://developer.android.com/reference/android/view/View.OnAttachStateChangeListener.html" target="_blank" rel="noopener"><code>OnAttachStateChangeListener</code></a> çš„ setter æ–¹æ³•ã€‚<code>android.databinding.adapters.ListenerUtil</code> ç±»å¸®åŠ©ä¿æŒè·Ÿè¸ªä¹‹å‰çš„ç›‘å¬å™¨ï¼Œä»¥ä¾¿äºå®ƒä»¬åœ¨ binding adapter ä¸­ä¾¿äºç§»é™¤ã€‚</p>
<p>é€šè¿‡åœ¨æ¥å£ <code>OnViewDetachedFromWindow</code> å’Œ <code>OnViewAttachedToWindow</code> æ·»åŠ  <code>@TargetApi(VERSION_CODES.HONEYCOMB_MR1)</code> æ³¨è§£ï¼Œdata binding ä»£ç ç”Ÿæˆå™¨çŸ¥é“ ç›‘å¬å™¨åº”è¯¥åªä¼šåœ¨ Android 3.1ï¼ˆAPI level 12ï¼‰åŠä»¥ä¸Šæ‰ä¼šç”Ÿæˆï¼Œæ”¯æŒçš„ç‰ˆæœ¬ä¸ <a href="https://developer.android.com/reference/android/view/View.html#addOnAttachStateChangeListener(android.view.View.OnAttachStateChangeListener" target="_blank" rel="noopener"><code>addOnAttachStateChangeListener()</code></a>) æ–¹æ³•ç›¸åŒã€‚</p>
<h2 id="å¯¹è±¡è½¬åŒ–"><a href="#å¯¹è±¡è½¬åŒ–" class="headerlink" title="å¯¹è±¡è½¬åŒ–"></a>å¯¹è±¡è½¬åŒ–</h2><h3 id="è‡ªåŠ¨å¯¹è±¡è½¬åŒ–"><a href="#è‡ªåŠ¨å¯¹è±¡è½¬åŒ–" class="headerlink" title="è‡ªåŠ¨å¯¹è±¡è½¬åŒ–"></a>è‡ªåŠ¨å¯¹è±¡è½¬åŒ–</h3><p>å½“ä¸€ä¸ª <a href="https://developer.android.com/reference/java/lang/Object.html" target="_blank" rel="noopener"><code>Object</code></a> ä»ç»‘å®šè¡¨è¾¾å¼ä¸­è¿”å›æ—¶ï¼Œåº“é€‰æ‹©æ–¹æ³•æ¥è®¾ç½®å±æ€§çš„å€¼ã€‚<code>Object</code> è¢«è½¬æ¢ä¸ºæ‰€é€‰æ–¹æ³•çš„å‚æ•°ç±»å‹ã€‚ä½¿ç”¨ <a href="https://developer.android.com/reference/android/databinding/ObservableMap.html" target="_blank" rel="noopener"><code>ObservableMap</code></a> ç±»æ¥å­˜å‚¨æ•°æ®è¿™ä¸ªè¡Œä¸ºåœ¨ app ä¸­æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView</span><br><span class="line">   android:text=<span class="string">'@&#123;userMap["lastName"]&#125;'</span></span><br><span class="line">   android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">   android:layout_height=<span class="string">"wrap_content"</span> /&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <strong>object.key</strong> çš„æ–¹å¼å¼•ç”¨å€¼ã€‚æ¯”å¦‚ï¼Œä¸Šé¢ä¾‹å­ä¸­çš„ @{<strong>userMap[â€œlastNameâ€]</strong>} å¯ä»¥è¢«æ›¿æ¢ä¸º @{<strong>userMap.lastName</strong>}</p>
</blockquote>
<p>è¡¨è¾¾å¼ä¸­çš„ <code>userMap</code> å¯¹è±¡è¿”å›ä¸€ä¸ªå€¼ï¼Œå®ƒè‡ªåŠ¨è½¬å‹æˆ ç”¨æˆ·é€šè¿‡ <code>android:text</code> å±æ€§è®¾ç½®å€¼çš„ <code>setText(CharSequence)</code> æ–¹æ³•çš„å‚æ•°ç±»å‹ã€‚å¦‚æœå‚æ•°ç±»å‹äº§ç”Ÿæ­§ä¹‰çš„ï¼Œä½ å¿…é¡»è¦åœ¨è¡¨è¾¾å¼ä¸­è¿›è¡Œç±»å‹è½¬æ¢ã€‚</p>
<h3 id="è‡ªå®šä¹‰è½¬æ¢"><a href="#è‡ªå®šä¹‰è½¬æ¢" class="headerlink" title="è‡ªå®šä¹‰è½¬æ¢"></a>è‡ªå®šä¹‰è½¬æ¢</h3><p>åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œåœ¨ä¸¤ä¸ªç‰¹æ®Šçš„ç±»å‹ä¹‹é—´è‡ªå®šä¹‰è½¬æ¢æ˜¯éœ€è¦çš„ã€‚æ¯”å¦‚ï¼ŒView çš„ <code>android:background</code> å±æ€§æœŸæœ›æ˜¯ä¸€ä¸ª <a href="https://developer.android.com/reference/android/graphics/drawable/Drawable.html" target="_blank" rel="noopener"><code>Drawable</code></a>ï¼Œä½†æ˜¯æŒ‡å®šçš„ <code>color</code> å€¼æ˜¯ä¸€ä¸ª integerã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å±æ€§æœŸæœ›æ˜¯ <code>Drawable</code>ï¼Œä½†æ˜¯æä¾›çš„å´æ˜¯ integerï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;View</span><br><span class="line">   android:background=<span class="string">"@&#123;isError ? @color/red : @color/white&#125;"</span></span><br><span class="line">   android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">   android:layout_height=<span class="string">"wrap_content"</span>/&gt;</span><br></pre></td></tr></table></figure>
<p>æ¯å½“æœŸæœ›ä¸€ä¸ª <code>Drawable</code> å¹¶è¿”å›ä¸€ä¸ª integer æ—¶ï¼Œ<code>int</code> åº”è¯¥è¦è¢«è½¬æ¢æˆä¸€ä¸ª <a href="https://developer.android.com/reference/android/graphics/drawable/ColorDrawable.html" target="_blank" rel="noopener"><code>ColorDrawable</code></a>ã€‚è¿™ä¸ªè½¬æ¢å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå¸¦æœ‰ <a href="https://developer.android.com/reference/android/databinding/BindingConversion.html" target="_blank" rel="noopener"><code>BindingConversion</code></a> static çš„æ–¹æ³•åšåˆ°ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingConversion</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">convertColorToDrawable</span><span class="params">(color: <span class="type">Int</span>)</span></span> = ColorDrawable(color)</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œç»‘å®šè¡¨è¾¾å¼ä¸­æä¾›çš„å€¼ç±»å‹å¿…é¡»æ˜¯ä¸€è‡´çš„ã€‚ä¸èƒ½åœ¨åŒä¸€è¡¨è¾¾å¼ä¸­ä½¿ç”¨ä¸åŒçš„ç±»å‹ï¼Œå¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;View</span><br><span class="line">   android:background=<span class="string">"@&#123;isError ? @drawable/error : @color/white&#125;"</span></span><br><span class="line">   android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">   android:layout_height=<span class="string">"wrap_content"</span>/&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component DataBinding -- ç”Ÿæˆçš„ç»‘å®šç±»ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_generated_binding/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-DataBinding-â€“-ç”Ÿæˆçš„ç»‘å®šç±»ï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-DataBinding-â€“-ç”Ÿæˆçš„ç»‘å®šç±»ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component DataBinding â€“ ç”Ÿæˆçš„ç»‘å®šç±»ï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component DataBinding â€“ ç”Ÿæˆçš„ç»‘å®šç±»ï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/data-binding/generated-binding" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/data-binding/generated-binding</a></p>
</blockquote>
<p>Data Binding åº“ç”Ÿæˆç»‘å®šç±»æ¥ç”¨äºè®¿é—® layout çš„ variable å’Œ viewsã€‚æœ¬æ–‡å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºå’Œè‡ªå®šä¹‰ç”Ÿæˆçš„ç»‘å®šç±»ã€‚</p>
<p>ç”Ÿæˆçš„ç»‘å®šç±»é“¾æ¥ layout ä¸­çš„ variables å’Œ viewsã€‚ç»‘å®šç±»çš„åå­—å’ŒåŒ…åéƒ½æ˜¯å¯ä»¥<a href="https://developer.android.com/topic/libraries/data-binding/generated-binding#custom_binding_class_names" target="_blank" rel="noopener">è‡ªå®šä¹‰çš„</a>ã€‚æ‰€æœ‰ç”Ÿæˆçš„ç»‘å®šç±»éƒ½ç»§æ‰¿è‡ª <a href="https://developer.android.com/reference/android/databinding/ViewDataBinding.html" target="_blank" rel="noopener"><code>ViewDataBinding</code></a> ç±»ã€‚</p>
<p>æ¯ä¸ª layout æ–‡ä»¶éƒ½ä¼šç”Ÿæˆä¸€ä¸ª binding classã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç±»ååŸºäº layout æ–‡ä»¶çš„åå­—ã€‚å°†å…¶è½¬æ¢ä¸º Pascal å¤§å°å†™, å¹¶å‘å…¶æ·»åŠ  <em>Binding</em> åç¼€ã€‚ä¸Šé¢çš„ layout åå­—æ˜¯ <code>activity_main.xml</code> æ‰€ä»¥ç›¸åº”ç”Ÿæˆçš„ç±»æ˜¯ <code>ActivityMainBinding</code>ã€‚è¿™ä¸ªç±»ä¼šæŒæœ‰ä» layout å±æ€§ï¼ˆæ¯”å¦‚ï¼Œ<code>user</code> å˜é‡ï¼‰åˆ° layout çš„ views çš„æ‰€æœ‰ç»‘å®šï¼Œå¹¶çŸ¥é“å¦‚ä½•ä¸ºç»‘å®šè¡¨è¾¾å¼èµ‹å€¼ã€‚</p>
<h2 id="åˆ›å»ºä¸€ä¸ª-binding-å¯¹è±¡"><a href="#åˆ›å»ºä¸€ä¸ª-binding-å¯¹è±¡" class="headerlink" title="åˆ›å»ºä¸€ä¸ª binding å¯¹è±¡"></a>åˆ›å»ºä¸€ä¸ª binding å¯¹è±¡</h2><p>Binding å¯¹è±¡åœ¨ inflating layout ä¹‹åé©¬ä¸Šåˆ›å»ºæ¥ç¡®ä¿ layout ä¸­ view å±‚çº§åœ¨ä½¿ç”¨è¡¨è¾¾å¼ç»‘å®šåˆ° views ä¹‹å‰æ²¡æœ‰è¢«ä¿®æ”¹ã€‚æœ€å¸¸ç”¨ç»‘å®šå¯¹è±¡åˆ° layout çš„æ–¹å¼æ˜¯ä½¿ç”¨ç»‘å®šç±»çš„é™æ€æ–¹æ³•ã€‚ä½ å¯ä»¥ä½¿ç”¨ç»‘å®šç±»çš„ <code>inflate()</code> æ–¹æ³•æ¥ inflate view å±‚çº§å’Œç»‘å®šå¯¹è±¡åˆ°å®ƒè‡ªèº«ã€‚å¦‚ä¸‹ä¾‹å­ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> binding: MyLayoutBinding = MyLayoutBinding.inflate(layoutInflater)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰ä¸€ä¸ª <code>inflate()</code> æ–¹æ³•çš„æ›¿ä»£ç‰ˆæœ¬ï¼Œå®ƒé™¤äº† <a href="https://developer.android.com/reference/android/view/LayoutInflater.html" target="_blank" rel="noopener"><code>LayoutInflater</code></a> å¯¹è±¡ä¹‹å¤–è¿˜éœ€è¦ä¸€ä¸ª <a href="https://developer.android.com/reference/android/view/ViewGroup.html" target="_blank" rel="noopener"><code>ViewGroup</code></a> å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> binding: MyLayoutBinding = MyLayoutBinding.inflate(getLayoutInflater(), viewGroup, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœ layout æ˜¯ä½¿ç”¨ä¸åŒçš„æœºåˆ¶ inflate çš„ï¼Œå®ƒå¯ä»¥å•ç‹¬å»ç»‘å®šï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> binding: MyLayoutBinding = MyLayoutBinding.bind(viewRoot)</span><br></pre></td></tr></table></figure>
<p>æœ‰æ—¶æ— æ³•äº‹å…ˆçŸ¥é“ç»‘å®šç±»å‹ã€‚åœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼Œbinding å¯ä»¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/databinding/DataBindingUtil.html" target="_blank" rel="noopener"><code>DataBindingUtil</code></a> ç±»æ¥åˆ›å»ºï¼Œå¦‚ä¸‹ä»£ç ç‰‡æ®µï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rootView = LayoutInflater.from(<span class="keyword">this</span>).inflate(layoutId, parent, attachToParent)</span><br><span class="line"><span class="keyword">val</span> binding: ViewDataBinding? = DataBindingUtil.bind(viewRoot)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ åœ¨ <a href="https://developer.android.com/reference/android/app/Fragment.html" target="_blank" rel="noopener"><code>Fragment</code></a>ï¼Œ<a href="https://developer.android.com/reference/android/widget/ListView.html" target="_blank" rel="noopener"><code>ListView</code></a>ï¼Œ<a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.html" target="_blank" rel="noopener"><code>RecyclerView</code></a> adapter ä¸­ä½¿ç”¨ data bindingï¼Œä½ å¯èƒ½æ›´å–œæ¬¢ä½¿ç”¨ bindings classes çš„ <a href="https://developer.android.com/reference/android/databinding/DataBindingUtil.html#inflate(android.view.LayoutInflater,%20int,%20android.view.ViewGroup,%20boolean,%20android.databinding.DataBindingComponent" target="_blank" rel="noopener"><code>inflate</code></a>) æ–¹æ³•ï¼Œæˆ–è€… <a href="https://developer.android.com/reference/android/databinding/DataBindingUtil" target="_blank" rel="noopener"><code>DataBindingUtil</code></a> ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> listItemBinding = ListItemBinding.inflate(layoutInflater, viewGroup, <span class="literal">false</span>)</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="keyword">val</span> listItemBinding = DataBindingUtil.inflate(layoutInflater, R.layout.list_item, viewGroup, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<h2 id="å…·æœ‰-ID-çš„-Views"><a href="#å…·æœ‰-ID-çš„-Views" class="headerlink" title="å…·æœ‰ ID çš„ Views"></a>å…·æœ‰ ID çš„ Views</h2><p>Data Binding åº“åœ¨ç»‘å®šç±»ä¸­ä¸ºæ¯ä¸ª layout ä¸­å¸¦æœ‰ ID çš„ view åˆ›å»ºäº†ä¸€ä¸ªä¸å¯æ”¹å˜çš„å±æ€§ã€‚æ¯”å¦‚ï¼Œä¸‹é¢çš„ layout ä¸­ï¼ŒData Binding åº“åˆ›å»ºäº† <code>firstName</code> å’Œ <code>lastName</code> ä¸¤ä¸ª <code>TextView</code> äº†è¡Œçš„å±æ€§ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;layout xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span><br><span class="line">   &lt;<span class="keyword">data</span>&gt;</span><br><span class="line">       &lt;variable name=<span class="string">"user"</span> type=<span class="string">"com.example.User"</span>/&gt;</span><br><span class="line">   &lt;/<span class="keyword">data</span>&gt;</span><br><span class="line">   &lt;LinearLayout</span><br><span class="line">       android:orientation=<span class="string">"vertical"</span></span><br><span class="line">       android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">       android:layout_height=<span class="string">"match_parent"</span>&gt;</span><br><span class="line">       &lt;TextView android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">           android:layout_height=<span class="string">"wrap_content"</span></span><br><span class="line">           android:text=<span class="string">"@&#123;user.firstName&#125;"</span></span><br><span class="line">   android:id=<span class="string">"@+id/firstName"</span>/&gt;</span><br><span class="line">       &lt;TextView android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">           android:layout_height=<span class="string">"wrap_content"</span></span><br><span class="line">           android:text=<span class="string">"@&#123;user.lastName&#125;"</span></span><br><span class="line">  android:id=<span class="string">"@+id/lastName"</span>/&gt;</span><br><span class="line">   &lt;/LinearLayout&gt;</span><br><span class="line">&lt;/layout&gt;</span><br></pre></td></tr></table></figure>
<p>åº“ä¸€æ¬¡ä» view å±‚çº§ä¸­å–å‡ºåŒ…æ‹¬ IDs çš„ viewsã€‚å¯¹äº layout ä¸­çš„æ¯ä¸ª view æ¥è¯´ï¼Œè¿™ä¸ªæœºåˆ¶ä¼šæ¯”è°ƒç”¨ <a href="https://developer.android.com/reference/android/app/Activity.html#findViewById(int" target="_blank" rel="noopener"><code>findViewById()</code></a>) æ–¹æ³•æ›´å¿«ã€‚</p>
<p>å¦‚æœå®ƒä»¬æ²¡æœ‰ data binding åˆ™ä¸å¿…è¦ï¼Œä½†æ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œä»ç„¶éœ€è¦ä»ä»£ç ä¸­è®¿é—® viewã€‚</p>
<h2 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h2><p>Data Binding åº“é’ˆå¯¹æ¯ä¸ªåœ¨ layout å£°æ˜äº†çš„ variable ç”Ÿæˆè®¿é—®æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œä¸‹é¢çš„ layout åœ¨ç»‘å®šç±»ä¸­ä¸º <code>user</code>ï¼Œ<code>image</code> å’Œ <code>note</code> ç”Ÿæˆ setter å’Œ getter æ–¹æ³•ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"android.graphics.drawable.Drawable"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"com.example.User"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"image"</span> <span class="attr">type</span>=<span class="string">"Drawable"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"note"</span> <span class="attr">type</span>=<span class="string">"String"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="ViewStubs"><a href="#ViewStubs" class="headerlink" title="ViewStubs"></a>ViewStubs</h2><p>ä¸åƒæ™®é€šçš„ Viewï¼Œ<a href="https://developer.android.com/reference/android/view/ViewStub.html" target="_blank" rel="noopener"><code>ViewStub</code></a> å¯¹è±¡ä»¥ä¸å¯è§çš„ view ä½œä¸ºå¼€å§‹ã€‚å½“å®ƒä»¬è¢«è®¾ç½®å¯è§æˆ–è€…æ˜ç¡®åœ° inflate æ—¶ï¼Œå®ƒä»¬é€šè¿‡ inflating å¦ä¸€ä¸ª layout æ¥æ›¿æ¢å®ƒä»¬è‡ªå·±ã€‚</p>
<p>å› ä¸º <code>ViewStub</code> æœ¬è´¨ä¸Šåœ¨ view å±‚çº§ä¸Šæ˜¯ä¸å¯è§çš„ï¼Œbinding å¯¹è±¡ä¸­çš„ view ä¹Ÿå¿…é¡»æ¶ˆå¤±æ¥è¿è¡Œ gc å›æ”¶ã€‚å› ä¸º view æ˜¯ final çš„ï¼Œä¸€ä¸ª <a href="https://developer.android.com/reference/android/databinding/ViewStubProxy.html" target="_blank" rel="noopener"><code>ViewStubProxy</code></a> å¯¹è±¡åœ¨ç”Ÿæˆçš„ç»‘å®šç±»ä¸­å–ä»£ <code>ViewStub</code>ï¼Œä½¿ä½ å¯ä»¥åœ¨ <code>ViewStub</code> å­˜åœ¨æ—¶è®¿é—®å®ƒï¼Œå¹¶åœ¨ <code>ViewStub</code> è¢« inflate æ—¶è®¿é—® view å±‚æ¬¡ç»“æ„ã€‚</p>
<p>å½“ inflate å¦ä¸€ä¸ª layoutï¼Œå¿…é¡»ä¸ºæ–° layout å»ºç«‹ç»‘å®šã€‚å› æ­¤ï¼Œ<code>ViewStubProxy</code> å¿…é¡»ç›‘å¬ <code>ViewStub</code> çš„ <a href="https://developer.android.com/reference/android/view/ViewStub.OnInflateListener.html" target="_blank" rel="noopener"><code>OnInflateListener</code></a>ï¼Œå¹¶åœ¨éœ€è¦æ—¶å»ºç«‹ç»‘å®šã€‚å› ä¸ºåªæœ‰ä¸€ä¸ªç›‘å¬å™¨å¯ä»¥åœ¨ç»™å®šçš„æ—¶é—´é‡Œå­˜åœ¨ï¼Œ<code>ViewStubProxy</code> å…è®¸ä½ å»è®¾ç½®ä¸€ä¸ª <code>OnInflateListener</code>ï¼Œå®ƒä¼šåœ¨å»ºç«‹ç»‘å®šåå›è°ƒã€‚</p>
<h2 id="ç«‹å³ç»‘å®š"><a href="#ç«‹å³ç»‘å®š" class="headerlink" title="ç«‹å³ç»‘å®š"></a>ç«‹å³ç»‘å®š</h2><p>å½“ä¸€ä¸ª variable æˆ–è€… observable å¯¹è±¡æ”¹å˜æ—¶ï¼Œbinding ä¼šåœ¨ä¸‹ä¸€å¸§ä¹‹å‰è°ƒåº¦å˜åŒ–ã€‚ä½†æ˜¯æœ‰æ—¶ binding éœ€è¦ç«‹å³æ‰§è¡Œã€‚è¦å¼ºåˆ¶æ‰§è¡Œï¼Œä½¿ç”¨ <a href="https://developer.android.com/reference/android/databinding/ViewDataBinding.html#executePendingBindings(" target="_blank" rel="noopener"><code>executePendingBindings()</code></a>) æ–¹æ³•ã€‚</p>
<h2 id="é«˜çº§ç»‘å®š"><a href="#é«˜çº§ç»‘å®š" class="headerlink" title="é«˜çº§ç»‘å®š"></a>é«˜çº§ç»‘å®š</h2><h3 id="åŠ¨æ€å˜é‡"><a href="#åŠ¨æ€å˜é‡" class="headerlink" title="åŠ¨æ€å˜é‡"></a>åŠ¨æ€å˜é‡</h3><p>æœ‰æ—¶ï¼Œæ˜¯ä¸çŸ¥é“ç‰¹å®šçš„ç»‘å®šç±»çš„ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªé’ˆå¯¹ä»»æ„å¸ƒå±€çš„ <a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.Adapter.html" target="_blank" rel="noopener"><code>RecyclerView.Adapter</code></a> æ˜¯ä¸çŸ¥é“å…·ä½“ç‰¹å®šçš„ç»‘å®šç±»çš„ã€‚åœ¨è°ƒç”¨ <a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.Adapter.html#onBindViewHolder(VH,%20int" target="_blank" rel="noopener">onBindViewHolder()</a>) æ–¹å¼æ—¶ï¼Œå®ƒä»å¿…é¡»è¦åˆ†é… binding çš„å€¼ã€‚</p>
<p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæ‰€æœ‰ <code>RecyclerView</code> ç»‘å®šçš„å¸ƒå±€éƒ½æœ‰ä¸€ä¸ª <code>item</code> å˜é‡ã€‚<code>BindingHolder</code> å¯¹è±¡æœ‰ä¸€ä¸ª <code>getBinding()</code> æ–¹æ³•è¿”å› <a href="https://developer.android.com/reference/android/databinding/ViewDataBinding.html" target="_blank" rel="noopener"><code>ViewDataBinding</code></a> åŸºç±»ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder: <span class="type">BindingHolder</span>, position: <span class="type">Int</span>)</span></span> &#123;</span><br><span class="line">    item: T = mItems.<span class="keyword">get</span>(position)</span><br><span class="line">    holder.binding.setVariable(BR.item, item);</span><br><span class="line">    holder.binding.executePendingBindings();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Data Binding åº“åœ¨ module åŒ…ä¸‹ç”Ÿæˆäº†ä¸€ä¸ªåä¸º <strong>BR</strong> çš„ç±»ï¼Œå®ƒåŒ…å«äº†ç”¨æˆ·æ•°æ®ç»‘å®šçš„ resources IDsã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œåº“è‡ªåŠ¨ç”Ÿæˆäº† <strong>BR.item</strong> å˜é‡ã€‚</p>
</blockquote>
<h2 id="åå°çº¿ç¨‹"><a href="#åå°çº¿ç¨‹" class="headerlink" title="åå°çº¿ç¨‹"></a>åå°çº¿ç¨‹</h2><p>åªè¦æ•°æ®æ¨¡å‹ä¸æ˜¯é›†åˆï¼Œä½ å¯ä»¥åœ¨åå°çº¿ç¨‹ä¸­æ›´æ”¹æ•°æ®æ¨¡å‹ã€‚Data Binding åœ¨è®¡ç®—æ—¶æœŸå¯¹æ¯ä¸ªvariable / field è¿›è¡Œæœ¬åœ°åŒ–ï¼Œä»¥é¿å…ä»»ä½•å¹¶å‘é—®é¢˜ã€‚</p>
<h2 id="è‡ªå®šä¹‰ç»‘å®šç±»å"><a href="#è‡ªå®šä¹‰ç»‘å®šç±»å" class="headerlink" title="è‡ªå®šä¹‰ç»‘å®šç±»å"></a>è‡ªå®šä¹‰ç»‘å®šç±»å</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç»‘å®šåå­—æ˜¯åŸºäº layout çš„åå­—ç”Ÿæˆçš„ï¼Œä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œç§»é™¤ä¸‹åˆ’çº¿ï¼ˆ<code>_</code> ï¼‰ï¼Œå¤§å†™ä¸‹ä¸€ä¸ªå­—æ¯ï¼Œæ·»åŠ åç¼€å•è¯ <strong>Binding</strong>ã€‚è¿™ä¸ªç±»è¢«æ”¾ç½®åœ¨è¿™ä¸ª module åŒ…ä¸‹çš„ <code>databinding</code> åŒ…ä¸­ã€‚æ¯”å¦‚ï¼Œlayout æ–‡ä»¶ <code>contact_item.xml</code> ç”Ÿæˆ <code>ContactItemBinding</code> ç±»ã€‚å¦‚æœ module åŒ…æ˜¯ <code>com.example.my.app</code>ï¼Œåˆ™ç»‘å®šç±»åˆ™æ”¾ç½®åœ¨ <code>com.example.my.app.databinding</code> åŒ…ä¸­ã€‚</p>
<p>é€šè¿‡è°ƒæ•´ <code>data</code> æ ‡ç­¾çš„ <code>class</code> å±æ€§ï¼Œç»‘å®šç±»å¯ä»¥é‡å‘½åæˆ–æ”¾ç½®åœ¨ä¸åŒçš„åŒ…ä¸­ã€‚ä¸¾ä¾‹ï¼Œä¸‹é¢çš„ layout åœ¨å½“å‰çš„ module çš„ <code>databinding</code> åŒ…ä¸­ ç”Ÿæˆ <code>ContactItem</code> ç±»ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">data</span> <span class="class"><span class="keyword">class</span>="<span class="title">ContactItem</span>"&gt;</span></span><br><span class="line">    â€¦</span><br><span class="line">&lt;/<span class="keyword">data</span>&gt;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥é€šè¿‡åœ¨ç±»åä¹‹å‰åŠ ä¸Šå¥ç‚¹çš„æ–¹å¼åœ¨ä¸åŒçš„åŒ…ä¸­ç”Ÿæˆç»‘å®šç±»ã€‚ä¸‹é¢çš„ä¾‹å­åœ¨ module åŒ…ä¸­ç”Ÿæˆç»‘å®šç±»ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">data</span> <span class="class"><span class="keyword">class</span>=".<span class="title">ContactItem</span>"&gt;</span></span><br><span class="line">    â€¦</span><br><span class="line">&lt;/<span class="keyword">data</span>&gt;</span><br></pre></td></tr></table></figure>
<p>ä½ ä¹Ÿå¯ä»¥æ˜¯ç”¨å…¨åŒ…åæ¥æŒ‡å®šç”Ÿæˆç»‘å®šç±»çš„åå­—ã€‚ä¸‹é¢ä¾‹å­åœ¨ <code>com.example</code> åŒ…ä¸­åˆ›å»º <code>ContactItem</code> ç»‘å®šç±»ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">data</span> <span class="class"><span class="keyword">class</span>="<span class="title">com</span>.<span class="title">example</span>.<span class="title">ContactItem</span>"&gt;</span></span><br><span class="line">    â€¦</span><br><span class="line">&lt;/<span class="keyword">data</span>&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component DataBinding -- ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_observability/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-DataBinding-â€“-ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡ï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-DataBinding-â€“-ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component DataBinding â€“ ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡ï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component DataBinding â€“ ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡ï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/data-binding/observability" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/data-binding/observability</a></p>
</blockquote>
<p>å¯è§‚å¯Ÿæ€§æ˜¯æŒ‡å¯¹è±¡å°†å…¶æ•°æ®çš„å˜åŒ–é€šçŸ¥ä»–äººçš„èƒ½åŠ›ã€‚Data Binding åº“å…è®¸ä½ å»åˆ›å»ºå¯¹è±¡ï¼Œå±æ€§ï¼Œå¯è§‚å¯Ÿé›†åˆã€‚</p>
<p>ä»»ä½•æ™®é€šçš„å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨ Data Bindingï¼Œä½†æ˜¯ä¿®æ”¹ä¿®æ”¹ä¹‹åä¸ä¼šè‡ªåŠ¨å¼•å‘ UI çš„æ›´æ–°ã€‚Data Binding å¯ä»¥ä½¿æ•°æ®å¯¹è±¡èƒ½å¤Ÿåœ¨å…¶æ•°æ®æ›´æ”¹æ—¶é€šçŸ¥å…¶ä»–å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ç›‘å¬å™¨ã€‚æœ‰ 3 ç§ä¸åŒçš„å¯è§‚å¯Ÿç±»çš„ç±»å‹ï¼š<a href="https://developer.android.com/topic/libraries/data-binding/observability#observable_objects" target="_blank" rel="noopener"><code>objects</code></a>ï¼Œ<a href="https://developer.android.com/topic/libraries/data-binding/observability#observable_fields" target="_blank" rel="noopener"><code>fields</code></a> å’Œ <a href="https://developer.android.com/topic/libraries/data-binding/observability#observable_collections" target="_blank" rel="noopener"><code>collections</code></a>ã€‚</p>
<p>å½“è¿™äº›å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡ä¹‹ä¸€ç»‘å®šåˆ° UIï¼Œå¹¶ä¸”æ•°æ®å¯¹è±¡çš„å±æ€§å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒUI å°†è‡ªåŠ¨æ›´æ–°ã€‚</p>
<h2 id="Observable-fields"><a href="#Observable-fields" class="headerlink" title="Observable fields"></a>Observable fields</h2><p>åˆ›å»ºå®ç°äº† <a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener"><code>Observable</code></a> æ¥å£çš„ç±»ä¼šæ¶‰åŠåˆ°ä¸€äº›å·¥ä½œï¼Œå¦‚æœä½ çš„ç±»åªæœ‰å‡ ä¸ªå±æ€§ï¼Œè¿™å°±ä¸å€¼å¾—è¿™ä¹ˆåšã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨æ³›å‹ <a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener"><code>Observable</code></a> ç±»å’Œä¸‹é¢å‡ ç§ç‰¹å®šäºåŸç”Ÿçš„ç±»æ¥ä½¿å¾—å±æ€§å˜å¾—å¯è§‚å¯Ÿï¼š</p>
<ul>
<li><a href="https://developer.android.com/reference/android/databinding/ObservableBoolean.html" target="_blank" rel="noopener"><code>ObservableBoolean</code></a></li>
<li><a href="https://developer.android.com/reference/android/databinding/ObservableByte.html" target="_blank" rel="noopener"><code>ObservableByte</code></a></li>
<li><a href="https://developer.android.com/reference/android/databinding/ObservableChar.html" target="_blank" rel="noopener"><code>ObservableChar</code></a></li>
<li><a href="https://developer.android.com/reference/android/databinding/ObservableShort.html" target="_blank" rel="noopener"><code>ObservableShort</code></a></li>
<li><a href="https://developer.android.com/reference/android/databinding/ObservableInt.html" target="_blank" rel="noopener"><code>ObservableInt</code></a></li>
<li><a href="https://developer.android.com/reference/android/databinding/ObservableLong.html" target="_blank" rel="noopener"><code>ObservableLong</code></a></li>
<li><a href="https://developer.android.com/reference/android/databinding/ObservableFloat.html" target="_blank" rel="noopener"><code>ObservableFloat</code></a></li>
<li><a href="https://developer.android.com/reference/android/databinding/ObservableDouble.html" target="_blank" rel="noopener"><code>ObservableDouble</code></a></li>
<li><a href="https://developer.android.com/reference/android/databinding/ObservableParcelable.html" target="_blank" rel="noopener"><code>ObservableParcelable</code></a></li>
</ul>
<p>Observable fields æ˜¯ä»…åŒ…å«äº†ä¸€ä¸ªå±æ€§çš„å¯è§‚å¯Ÿå¯¹è±¡ã€‚åŸå§‹æ•°æ®ç±»å‹ç‰ˆæœ¬æ˜¯ä¸ºäº†é¿å…è®¿é—®æ—¶çš„è£…ç®±å’Œæ‹†ç®±æ“ä½œã€‚è¦ä½¿ç”¨è¿™ä¸ªæœºåˆ¶ï¼Œåˆ›å»ºä¸€ä¸ªåœ¨ Java è¯­è¨€ä¸­çš„ <code>public final</code> å±æ€§æˆ–è€…åœ¨ Kotlin è¯­è¨€ä¸­çš„åªè¯»å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">val</span> firstName = ObservableField&lt;String&gt;()</span><br><span class="line">    <span class="keyword">val</span> lastName = ObservableField&lt;String&gt;()</span><br><span class="line">    <span class="keyword">val</span> age = ObservableInt()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¦è®¿é—®å±æ€§çš„å€¼ï¼Œä½¿ç”¨ <a href="https://developer.android.com/reference/android/databinding/ObservableField.html#set" target="_blank" rel="noopener"><code>set()</code></a> å’Œ <a href="https://developer.android.com/reference/android/databinding/ObservableField.html#get" target="_blank" rel="noopener"><code>get()</code></a> è®¿é—®å™¨æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user.firstName = <span class="string">"Google"</span></span><br><span class="line"><span class="keyword">val</span> age = user.age</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Android Studio 3.1 æˆ–è€…æ›´é«˜çš„ç‰ˆæœ¬å…è®¸ä½ ä½¿ç”¨ LiveData æ›¿æ¢ Obervable å¯¹è±¡ï¼Œå®ƒå¯ä»¥ç»™ä½ çš„ app å¸¦æ¥é¢å¤–çš„å¥½å¤„ã€‚æ›´å¤šè¯¦æƒ…è§ <a href="https://developer.android.com/topic/libraries/data-binding/architecture.html#livedata" target="_blank" rel="noopener">å½“æ•°æ®æ”¹å˜æ—¶ä½¿ç”¨ LiveData é€šçŸ¥ UI</a>ã€‚</p>
</blockquote>
<h3 id="Observable-collections"><a href="#Observable-collections" class="headerlink" title="Observable collections"></a>Observable collections</h3><p>ä¸€äº› app ä½¿ç”¨åŠ¨æ€ç»“æ„æ¥ä¿å­˜æ•°æ®ã€‚Observable collections å…è®¸ä½ ä½¿ç”¨ä¸€ä¸ª key æ¥è®¿é—®è¿™äº›ç»“æ„ã€‚<a href="https://developer.android.com/reference/android/databinding/ObservableArrayMap.html" target="_blank" rel="noopener"><code>ObservableArrayMap</code></a> ç±»åœ¨ key æ˜¯å¼•ç”¨ç±»å‹æ—¶å€™ï¼ˆæ¯”å¦‚ <code>String</code>ï¼‰æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ObservableArrayMap&lt;String, Any&gt;().apply &#123;</span><br><span class="line">    put(<span class="string">"firstName"</span>, <span class="string">"Google"</span>)</span><br><span class="line">    put(<span class="string">"lastName"</span>, <span class="string">"Inc."</span>)</span><br><span class="line">    put(<span class="string">"age"</span>, <span class="number">17</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ layout ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ string keys æ¥è®¿é—®ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"android.databinding.ObservableMap"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"ObservableMap&lt;String, Object&gt;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">â€¦</span><br><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">"@&#123;user.lastName&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">"@&#123;String.valueOf(1 + (Integer)user.age)&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="https://developer.android.com/reference/android/databinding/ObservableArrayList.html" target="_blank" rel="noopener"><code>ObservableArrayList</code></a> ç±»åœ¨ key æ˜¯ integer æ—¶å¾ˆæœ‰ç”¨ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ObservableArrayList&lt;Any&gt;().apply &#123;</span><br><span class="line">    add(<span class="string">"Google"</span>)</span><br><span class="line">    add(<span class="string">"Inc."</span>)</span><br><span class="line">    add(<span class="number">17</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ layout ä¸­ï¼Œlist å¯ä»¥é€šè¿‡ indexes è®¿é—®ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"android.databinding.ObservableList"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"com.example.my.app.Fields"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"ObservableList&lt;Object&gt;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">â€¦</span><br><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">'@&#123;user[Fields.LAST_NAME]&#125;'</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">'@&#123;String.valueOf(1 + (Integer)user[Fields.AGE])&#125;'</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Observable-objects"><a href="#Observable-objects" class="headerlink" title="Observable objects"></a>Observable objects</h2><p>ä¸€ä¸ªå®ç°äº† <a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener"><code>Observable</code></a> æ¥å£çš„ç±»å…è®¸ç›‘å¬å™¨çš„æ³¨å†Œæ¥é’ˆå¯¹ observable å¯¹è±¡ä¸Šå±æ€§è¢«æ”¹å˜æ—¶å¸Œæœ›æ”¶åˆ°é€šçŸ¥ã€‚</p>
<p><a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener"><code>Observable</code></a> æ¥å£æœ‰ä¸€ä¸ªå¢åŠ å’Œç§»é™¤ç›‘å¬å™¨çš„æœºåˆ¶ï¼Œä½†æ˜¯ä½ å¿…é¡»å†³å®šä»€ä¹ˆæ—¶å€™å‘é€é€šçŸ¥ã€‚ä¸ºäº†è®©å¼€å‘æ›´ç®€å•ï¼ŒData Binding åº“æä¾›äº† <a href="https://developer.android.com/reference/android/databinding/BaseObservable.html" target="_blank" rel="noopener"><code>BaseObservable</code></a> ç±»ï¼Œå®ƒå®ç°äº†ç›‘å¬å™¨çš„æ³¨å†Œæœºåˆ¶ã€‚å®ç°äº† <code>BaseObservable</code> çš„ç±»è´Ÿè´£å±æ€§å˜åŒ–æ—¶çš„é€šçŸ¥ã€‚åœ¨ getter æ–¹æ³•ä¸Šé¢å¢åŠ  <a href="https://developer.android.com/reference/android/databinding/Bindable.html" target="_blank" rel="noopener"><code>Bindable</code></a> æ³¨è§£ï¼Œåœ¨ setter æ–¹æ³•ä¸Šé¢è°ƒç”¨ <a href="https://developer.android.com/reference/android/databinding/BaseObservable.html#notifyPropertyChanged(int" target="_blank" rel="noopener"><code>notifyPropertyChanged()</code></a>) æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> : <span class="type">BaseObservable</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@get:Bindable</span></span><br><span class="line">    <span class="keyword">var</span> firstName: String = <span class="string">""</span></span><br><span class="line">        <span class="keyword">set</span>(value) &#123;</span><br><span class="line">            field = value</span><br><span class="line">            notifyPropertyChanged(BR.firstName)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@get:Bindable</span></span><br><span class="line">    <span class="keyword">var</span> lastName: String = <span class="string">""</span></span><br><span class="line">        <span class="keyword">set</span>(value) &#123;</span><br><span class="line">            field = value</span><br><span class="line">            notifyPropertyChanged(BR.lastName)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Data Binding åœ¨ module åŒ…ä¸‹é¢ï¼ˆåŒ…å«äº† resource idsï¼‰ç”Ÿæˆäº†ä¸€ä¸ªåä¸º <code>BR</code> çš„ç±»ç”¨äºæ•°æ®ç»‘å®šã€‚<a href="https://developer.android.com/reference/android/databinding/Bindable.html" target="_blank" rel="noopener"><code>Bindable</code></a> æ³¨è§£åœ¨ç¼–è¯‘æ—¶æœŸåœ¨ <code>BR</code> ç±»ä¸­ç”Ÿæˆäº†ä¸€ä¸ª entryã€‚å¦‚æœæ•°æ®ç±»ä¸èƒ½è¢«ä¿®æ”¹ï¼Œ<a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener"><code>Observable</code></a> æ¥å£å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸€ä¸ª<a href="https://developer.android.com/reference/android/databinding/PropertyChangeRegistry.html" target="_blank" rel="noopener"><code>PropertyChangeRegistry</code></a>æ¥æœ‰æ•ˆåœ°æ³¨å†Œå’Œé€šçŸ¥ç›‘å¬å™¨çš„æ–¹å¼è¢«å®ç°ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component DataBinding -- å¸ƒå±€å’Œè¡¨è¾¾å¼ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_databinding_expressions/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-DataBinding-â€“-å¸ƒå±€å’Œè¡¨è¾¾å¼ï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-DataBinding-â€“-å¸ƒå±€å’Œè¡¨è¾¾å¼ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component DataBinding â€“ å¸ƒå±€å’Œè¡¨è¾¾å¼ï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component DataBinding â€“ å¸ƒå±€å’Œè¡¨è¾¾å¼ï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/data-binding/expressions" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/data-binding/expressions</a></p>
</blockquote>
<p>è¡¨è¾¾å¼è¯­è¨€å…è®¸ä½ ç¼–å†™è¡¨è¾¾å¼ç”¨äº view æ´¾å‘çš„äº‹ä»¶ã€‚Data binding åº“è‡ªåŠ¨ç”Ÿæˆè¦å°† layout ä¸­çš„ views ä¸æ•°æ®å¯¹è±¡ç»‘å®šæ‰€éœ€çš„ç±»ã€‚</p>
<p>Data binding å¸ƒå±€æœ‰ç¨å¾®çš„å·®åˆ«ï¼Œä» layout çš„æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œç„¶åæ˜¯ <code>data</code> æ ‡ç­¾å’Œ <code>view</code> æ ¹æ ‡ç­¾ã€‚è¿™ä¸ª view æ ‡ç­¾å°±æ˜¯ä½ åœ¨é binding å¸ƒå±€æ–‡ä»¶çš„æ ¹æ ‡ç­¾ã€‚ä¸‹é¢ä»£ç å±•ç¤ºäº†ä¸€ä¸ª layout æ–‡ä»¶çš„ä¾‹å­ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">layout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"com.example.User"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">TextView</span> <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:text</span>=<span class="string">"@&#123;user.firstName&#125;"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">TextView</span> <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:text</span>=<span class="string">"@&#123;user.lastName&#125;"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ <code>data</code> ä¸­çš„ <code>user</code> å˜é‡æè¿°äº†ä¸€ä¸ªå¯èƒ½ä¼šåœ¨è¿™ä¸ªå¸ƒå±€ä¸­ä½¿ç”¨çš„å±æ€§ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"com.example.User"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¸ƒå±€ä¸­çš„è¡¨è¾¾å¼æ˜¯ä½¿ç”¨ <code>&quot;@{}&quot;</code> è¯­æ³•å†™åœ¨å±æ€§é‡Œé¢ã€‚è¿™é‡Œï¼Œ<code>TextView</code> æ–‡æœ¬ç”¨æ¥è®¾ç½® <code>user</code> å˜é‡çš„ <code>firstName</code> å±æ€§ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextView</span> <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:text</span>=<span class="string">"@&#123;user.firstName&#125;"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¸ƒå±€è¡¨è¾¾å¼åº”è¯¥ä¿æŒçŸ­å°è€Œç®€æ´ï¼Œå› ä¸ºå®ƒä»¬ä¸èƒ½è¢«å•å…ƒæµ‹è¯•å¹¶ä¸” IDE æ”¯æŒæœ‰é™ã€‚ä¸ºäº†ç®€åŒ–å¸ƒå±€è¡¨è¾¾å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ <a href="https://developer.android.com/topic/libraries/data-binding/binding-adapters" target="_blank" rel="noopener">binding adapters</a>ã€‚</p>
</blockquote>
<h2 id="æ•°æ®å¯¹è±¡"><a href="#æ•°æ®å¯¹è±¡" class="headerlink" title="æ•°æ®å¯¹è±¡"></a>æ•°æ®å¯¹è±¡</h2><p>å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªç®€å•çš„å¯¹è±¡æ¥æè¿° <code>User</code> å®ä½“ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>(<span class="keyword">val</span> firstName: String, <span class="keyword">val</span> lastName: String)</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">final</span> String firstName;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">final</span> String lastName;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String firstName, String lastName)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.firstName = firstName;</span><br><span class="line">      <span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ç§ç±»å‹çš„å¯¹è±¡æ°¸è¿œä¸ä¼šæ”¹å˜æ•°æ®ã€‚åœ¨åº”ç”¨ä¸­ï¼Œé€šå¸¸ä¼šæœ‰ä¸€æ¬¡è¯»å–çš„æ•°æ®æ­¤åæ°¸è¿œä¸ä¼šæ›´æ”¹çš„æƒ…å†µã€‚è¿˜å¯ä»¥ä½¿ç”¨éµå¾ªä¸€ç»„çº¦å®šçš„å¯¹è±¡ï¼Œä¾‹å¦‚åœ¨ java ä¸­ä½¿ç”¨è®¿é—®å™¨æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> String firstName;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> String lastName;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String firstName, String lastName)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.firstName = firstName;</span><br><span class="line">      <span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getFirstName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.firstName;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getLastName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.lastName;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»æ•°æ®ç»‘å®šçš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸¤ä¸ªç±»æ˜¯ç­‰ä»·çš„ã€‚ç”¨äº <a href="https://developer.android.com/reference/android/widget/TextView.html#attr_android:text" target="_blank" rel="noopener"><code>android:text</code></a> å±æ€§çš„è¡¨è¾¾å¼ <code>@{user.firstName}</code> è®¿é—®å‰è€…ç±»çš„ <code>firstName</code>å±æ€§ï¼Œè®¿é—®åè€…çš„ <code>getFirstName()</code> æ–¹æ³•ã€‚æˆ–è€…å¦‚æœå­˜åœ¨çš„è¯ä¼šè®¿é—® <code>firstName()</code> æ–¹æ³•ã€‚</p>
<h2 id="ç»‘å®šæ•°æ®"><a href="#ç»‘å®šæ•°æ®" class="headerlink" title="ç»‘å®šæ•°æ®"></a>ç»‘å®šæ•°æ®</h2><p>æ¯ä¸ª layout æ–‡ä»¶éƒ½ä¼šç”Ÿæˆä¸€ä¸ª binding classã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç±»ååŸºäº layout æ–‡ä»¶çš„åå­—ã€‚å°†å…¶è½¬æ¢ä¸º Pascal å¤§å°å†™, å¹¶å‘å…¶æ·»åŠ  <em>Binding</em> åç¼€ã€‚ä¸Šé¢çš„ layout åå­—æ˜¯ <code>activity_main.xml</code> æ‰€ä»¥ç›¸åº”ç”Ÿæˆçš„ç±»æ˜¯ <code>ActivityMainBinding</code>ã€‚è¿™ä¸ªç±»ä¼šæŒæœ‰ä» layout å±æ€§ï¼ˆæ¯”å¦‚ï¼Œ<code>user</code> å˜é‡ï¼‰åˆ° layout çš„ views çš„æ‰€æœ‰ç»‘å®šï¼Œå¹¶çŸ¥é“å¦‚ä½•ä¸ºç»‘å®šè¡¨è¾¾å¼èµ‹å€¼ã€‚æ¨èçš„æ–¹æ³•å»åˆ›å»º binding æ˜¯åœ¨ inflating å¸ƒå±€çš„æ—¶å€™ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> binding: ActivityMainBinding = DataBindingUtil.setContentView(</span><br><span class="line">            <span class="keyword">this</span>, R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">    binding.user = User(<span class="string">"Test"</span>, <span class="string">"User"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿è¡Œæ—¶ï¼Œapp åœ¨ UI ä¸Šæ˜¾ç¤º <strong>Test</strong> ç”¨æˆ·ã€‚æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨ <a href="https://developer.android.com/reference/android/view/LayoutInflater.html" target="_blank" rel="noopener"><code>LayoutInflater</code></a> æ¥è·å– viewï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> binding: ActivityMainBinding = ActivityMainBinding.inflate(getLayoutInflater())</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ åœ¨ <a href="https://developer.android.com/reference/android/app/Fragment.html" target="_blank" rel="noopener"><code>Fragment</code></a>ï¼Œ<a href="https://developer.android.com/reference/android/widget/ListView.html" target="_blank" rel="noopener"><code>ListView</code></a>ï¼Œ<a href="https://developer.android.com/reference/android/support/v7/widget/RecyclerView.html" target="_blank" rel="noopener"><code>RecyclerView</code></a> adapter ä¸­ä½¿ç”¨ data bindingï¼Œä½ å¯èƒ½æ›´å–œæ¬¢ä½¿ç”¨ bindings classes çš„ <a href="https://developer.android.com/reference/android/databinding/DataBindingUtil.html#inflate(android.view.LayoutInflater,%20int,%20android.view.ViewGroup,%20boolean,%20android.databinding.DataBindingComponent" target="_blank" rel="noopener"><code>inflate</code></a>) æ–¹æ³•ï¼Œæˆ–è€… <a href="https://developer.android.com/reference/android/databinding/DataBindingUtil" target="_blank" rel="noopener"><code>DataBindingUtil</code></a> ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> listItemBinding = ListItemBinding.inflate(layoutInflater, viewGroup, <span class="literal">false</span>)</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="keyword">val</span> listItemBinding = DataBindingUtil.inflate(layoutInflater, R.layout.list_item, viewGroup, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<h2 id="è¡¨è¾¾è¯­è¨€"><a href="#è¡¨è¾¾è¯­è¨€" class="headerlink" title="è¡¨è¾¾è¯­è¨€"></a>è¡¨è¾¾è¯­è¨€</h2><h3 id="å¸¸è§åŠŸèƒ½"><a href="#å¸¸è§åŠŸèƒ½" class="headerlink" title="å¸¸è§åŠŸèƒ½"></a>å¸¸è§åŠŸèƒ½</h3><p>è¡¨è¾¾å¼è¯­è¨€çœ‹èµ·æ¥å¾ˆåƒæ‰˜ç®¡ä»£ç ä¸­æ‰¾åˆ°çš„è¡¨è¾¾å¼ã€‚ä½ å¯ä»¥åœ¨è¡¨è¾¾å¼è¯­è¨€ä¸­ä½¿ç”¨ä»¥ä¸‹æ“ä½œç¬¦å’Œå…³é”®å­—ï¼š</p>
<ul>
<li>æ•°å­¦ï¼Œ<code>+ - / * %</code></li>
<li>å­—ç¬¦ä¸²è¿æ¥ï¼Œ<code>+</code></li>
<li>é€»è¾‘ï¼Œ<code>&amp;&amp; ||</code></li>
<li>äºŒè¿›åˆ¶ï¼Œ<code>&amp; | ^</code></li>
<li>ä¸€å…ƒï¼Œ<code>+ - ! ~</code></li>
<li>ç§»ä½ï¼Œ<code>&gt;&gt; &gt;&gt;&gt; &lt;&lt;</code></li>
<li>æ¯”è¾ƒï¼Œ<code>== &gt; &lt; &gt;= &lt;=</code></li>
<li><code>instanceof</code></li>
<li>åˆ†ç»„ï¼Œ<code>()</code></li>
<li>æºæ–‡æœ¬ - å­—ç¬¦ï¼Œå­—ç¬¦ä¸²ï¼Œæ•°å­—ï¼Œ<code>null</code></li>
<li>è½¬å‹</li>
<li>æ–¹æ³•è°ƒç”¨</li>
<li>å±æ€§è®¿é—®</li>
<li>æ•°ç»„è®¿é—®</li>
<li>ä¸‰å…ƒæ“ä½œæ³• <code>?:</code></li>
</ul>
<p>ä¸¾ä¾‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">android:text="@&#123;String.valueOf(index + 1)&#125;"</span><br><span class="line">android:visibility="@&#123;age <span class="tag">&lt; <span class="attr">13</span> ? <span class="attr">View.GONE</span> <span class="attr">:</span> <span class="attr">View.VISIBLE</span>&#125;"</span></span><br><span class="line"><span class="tag"><span class="attr">android:transitionName</span>=<span class="string">'@&#123;"image_" + id&#125;'</span></span></span><br></pre></td></tr></table></figure>
<h3 id="ç¼ºå¤±æ“ä½œ"><a href="#ç¼ºå¤±æ“ä½œ" class="headerlink" title="ç¼ºå¤±æ“ä½œ"></a>ç¼ºå¤±æ“ä½œ</h3><p>ä¸‹é¢åœ¨ä»£ç ä¸­å¯ä»¥ä½¿ç”¨çš„æ“ä½œåœ¨è¡¨è¾¾å¼è¯­æ³•ä¸­æ˜¯ç¼ºå¤±çš„ï¼š</p>
<ul>
<li><code>this</code></li>
<li><code>super</code></li>
<li><code>new</code></li>
<li>æ˜¾ç¤ºæ³›å‹è°ƒç”¨</li>
</ul>
<h3 id="ç©ºåˆè¿ç®—ç¬¦"><a href="#ç©ºåˆè¿ç®—ç¬¦" class="headerlink" title="ç©ºåˆè¿ç®—ç¬¦"></a>ç©ºåˆè¿ç®—ç¬¦</h3><p>ç©ºåˆè¿ç®—ç¬¦ï¼ˆ<code>??</code>ï¼‰å¦‚æœå·¦è¾¹ä¸æ˜¯ <code>null</code> åˆ™é€‰æ‹©å·¦è¾¹ï¼Œå¦åˆ™é€‰å³è¾¹ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:text="@&#123;user.displayName ?? user.lastName&#125;"</span><br></pre></td></tr></table></figure>
<p>è¿™åœ¨åŠŸèƒ½ä¸Šç­‰æ•ˆäºï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:text="@&#123;user.displayName != null ? user.displayName : user.lastName&#125;"</span><br></pre></td></tr></table></figure>
<h3 id="å±æ€§å¼•ç”¨"><a href="#å±æ€§å¼•ç”¨" class="headerlink" title="å±æ€§å¼•ç”¨"></a>å±æ€§å¼•ç”¨</h3><p>è¡¨è¾¾å¼å¯ä»¥é€šè¿‡ä½¿ç”¨ä»¥ä¸‹æ ¼å¼å¼•ç”¨ç±»ä¸­çš„å±æ€§ï¼Œè¯¥æ ¼å¼å¯¹äºå­—æ®µï¼Œgetters å’Œ <a href="https://developer.android.com/reference/android/databinding/ObservableField.html" target="_blank" rel="noopener"><code>ObservableField</code></a> å¯¹è±¡æ˜¯ç›¸åŒçš„ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:text="@&#123;user.lastName&#125;"</span><br></pre></td></tr></table></figure>
<h3 id="é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸"><a href="#é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸" class="headerlink" title="é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸"></a>é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸</h3><p>ç”Ÿæˆçš„ data binding ä»£ç ä¼šè‡ªåŠ¨æ£€æŸ¥ <code>null</code> å’Œé¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚ä¸¾ä¾‹ï¼Œåœ¨è¡¨è¾¾å¼ <code>@{user.name}</code>ï¼Œå¦‚æœ <code>user</code> æ˜¯ nullï¼Œ<code>user.name</code> è¢«èµ‹å€¼ <code>null</code> çš„é»˜è®¤å€¼ã€‚å¦‚æœä½ å¼•ç”¨äº† <code>user.age</code>ï¼Œage æ˜¯ <code>int</code> ç±»å‹ï¼Œé‚£ä¹ˆ data binding ä½¿ç”¨é»˜è®¤å€¼ <code>0</code>ã€‚</p>
<h3 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h3><p>å¸¸ç”¨çš„é›†åˆï¼Œæ¯”å¦‚ arraysï¼Œlistsï¼Œsparse list å’Œ mapï¼Œå¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨ <code>[]</code> æ¥è®¿é—®ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"android.util.SparseArray"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"java.util.Map"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"java.util.List"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"list"</span> <span class="attr">type</span>=<span class="string">"List&lt;String&gt;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"sparse"</span> <span class="attr">type</span>=<span class="string">"SparseArray&lt;String&gt;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"map"</span> <span class="attr">type</span>=<span class="string">"Map&lt;String, String&gt;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"index"</span> <span class="attr">type</span>=<span class="string">"int"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"key"</span> <span class="attr">type</span>=<span class="string">"String"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">â€¦</span><br><span class="line">android:text="@&#123;list[index]&#125;"</span><br><span class="line">â€¦</span><br><span class="line">android:text="@&#123;sparse[index]&#125;"</span><br><span class="line">â€¦</span><br><span class="line">android:text="@&#123;map[key]&#125;"</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä½ è¿˜å¯ä»¥ä½¿ç”¨ <strong>object.key</strong> è¡¨ç¤ºæ³•å¼•ç”¨ map ä¸­çš„å€¼ã€‚ä¸¾ä¾‹ï¼Œä¸Šé¢ä¾‹å­ä¸­çš„ @{<strong>map[key]</strong>} æˆ‘ä»¬å¯ä»¥æ›¿æ¢ä¸º @{<strong>map.key</strong>}ã€‚</p>
</blockquote>
<h3 id="String-æºæ–‡æœ¬"><a href="#String-æºæ–‡æœ¬" class="headerlink" title="String æºæ–‡æœ¬"></a>String æºæ–‡æœ¬</h3><p>ä½ å¯ä»¥ä½¿ç”¨å•å¼•å·åŒ…å›´å±æ€§å€¼ï¼Œè¿™å…è®¸æ‚¨åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨åŒå¼•å·ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:text='@&#123;map["firstName"]&#125;'</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨åŒå¼•å·æ¥åŒ…å›´å±æ€§å€¼ã€‚å½“æˆ‘ä»¬è¿™æ ·åšæ—¶ï¼Œå­—ç¬¦ä¸²æ–‡æœ¬åº”ä½¿ç”¨åå¼•å· `ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:text="@&#123;map[`firstName`]&#125;"</span><br></pre></td></tr></table></figure>
<h3 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h3><p>ä½ å¯ä»¥åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨ä»¥ä¸‹è¯­æ³•æ¥è®¿é—® resourcesï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:padding="@&#123;large? @dimen/largePadding : @dimen/smallPadding&#125;"</span><br></pre></td></tr></table></figure>
<p>æ ¼å¼åŒ– string å’Œ plurals å¯èƒ½éœ€è¦é€šè¿‡æä¾›å‚æ•°æ¥è®¡ç®—ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">android:text="@&#123;@string/nameFormat(firstName, lastName)&#125;"</span><br><span class="line">android:text="@&#123;@plurals/banana(bananaCount)&#125;"</span><br></pre></td></tr></table></figure>
<p>å½“ä¸€ä¸ª plural ä½¿ç”¨å¤šä¸ªå‚æ•°ï¼Œåˆ™æ‰€æœ‰å‚æ•°éƒ½åº”è¯¥è¢«ä¼ å…¥ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  Have an orange</span><br><span class="line">  Have %d oranges</span><br><span class="line"></span><br><span class="line">android:text="@&#123;@plurals/orange(orangeCount, orangeCount)&#125;"</span><br></pre></td></tr></table></figure>
<p>ä¸€äº›èµ„æºéœ€è¦æ˜¾å¼ç±»å‹è®¡ç®—ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤º:</p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>æ™®é€šå¼•ç”¨</th>
<th>è¡¨è¾¾å¼å¼•ç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>String[]</td>
<td>@array</td>
<td>@stringArray</td>
</tr>
<tr>
<td>int[]</td>
<td>@array</td>
<td>@intArray</td>
</tr>
<tr>
<td>TypedArray</td>
<td>@array</td>
<td>@typedArray</td>
</tr>
<tr>
<td>Animator</td>
<td>@animator</td>
<td>@animator</td>
</tr>
<tr>
<td>StateListAnimator</td>
<td>@animator</td>
<td>@stateListAnimator</td>
</tr>
<tr>
<td>color</td>
<td>int</td>
<td>@color</td>
<td>@color</td>
</tr>
<tr>
<td>ColorStateList</td>
<td>@color</td>
<td>@colorStateList</td>
</tr>
</tbody>
</table>
<h2 id="äº‹ä»¶å¤„ç†"><a href="#äº‹ä»¶å¤„ç†" class="headerlink" title="äº‹ä»¶å¤„ç†"></a>äº‹ä»¶å¤„ç†</h2><p>Data binding å…è®¸ä½ ç¼–å†™è¡¨è¾¾å¼æ¥å¤„ç†ä» views æ´¾å‘çš„äº‹ä»¶ï¼ˆæ¯”å¦‚ï¼Œ<a href="https://developer.android.com/reference/android/view/View.OnClickListener.html#onClick(android.view.View" target="_blank" rel="noopener"><code>onClick</code></a>) æ–¹æ³•ï¼‰ã€‚äº‹ä»¶å±æ€§åç”±ç›‘å¬å™¨æ–¹æ³•åç¡®å®šï¼Œä½†æœ‰å°‘æ•°ä¾‹å¤–ã€‚ä¸¾ä¾‹ï¼Œ<a href="https://developer.android.com/reference/android/view/View.OnClickListener.html" target="_blank" rel="noopener"><code>View.OnClickListener</code></a> æœ‰ä¸€ä¸ªæ–¹æ³• <a href="https://developer.android.com/reference/android/view/View.OnClickListener.html#onClick(android.view.View" target="_blank" rel="noopener"><code>onClick</code></a>)ï¼Œæ‰€ä»¥è¿™ä¸ª event çš„å±æ€§æ˜¯ <code>android:onClick</code>ã€‚</p>
<p>å¯¹äºç‚¹å‡»äº‹ä»¶ï¼Œæœ‰ä¸€äº›ç‰¹æ®Šçš„äº‹ä»¶å¤„ç†å™¨ä¸ä½¿ç”¨ <code>android:onClick</code> è€Œéœ€è¦ä¸€ä¸ªå±æ€§ï¼Œä»¥é¿å…å†²çªã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢å±æ€§æ¥é¿å…è¿™ç§ç±»å‹çš„å†²çªï¼š</p>
<table>
<thead>
<tr>
<th>ç±»</th>
<th>ç›‘å¬å™¨è®¾ç½®</th>
<th>å±æ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/SearchView.html" target="_blank" rel="noopener"><code>SearchView</code></a></td>
<td><a href="https://developer.android.com/reference/android/widget/SearchView.html#setOnSearchClickListener(android.view.View.OnClickListener" target="_blank" rel="noopener"><code>setOnSearchClickListener(View.OnClickListener)</code></a>)</td>
<td>android:onSearchClick</td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/ZoomControls.html" target="_blank" rel="noopener"><code>ZoomControls</code></a></td>
<td><a href="https://developer.android.com/reference/android/widget/ZoomControls.html#setOnZoomInClickListener(android.view.View.OnClickListener" target="_blank" rel="noopener"><code>setOnZoomInClickListener(View.OnClickListener)</code></a>)</td>
<td>android:onZoomIn</td>
</tr>
<tr>
<td><a href="https://developer.android.com/reference/android/widget/ZoomControls.html" target="_blank" rel="noopener"><code>ZoomControls</code></a></td>
<td><a href="https://developer.android.com/reference/android/widget/ZoomControls.html#setOnZoomOutClickListener(android.view.View.OnClickListener" target="_blank" rel="noopener"><code>setOnZoomOutClickListener(View.OnClickListener)</code></a>)</td>
<td>android:onZoomOut</td>
</tr>
</tbody>
</table>
<p>ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æœºåˆ¶æ¥å¤„ç†äº‹ä»¶ï¼š</p>
<ul>
<li><a href="https://developer.android.com/topic/libraries/data-binding/expressions#method_references" target="_blank" rel="noopener">æ–¹æ³•å¼•ç”¨</a>ï¼šåœ¨ä½ çš„è¡¨è¾¾å¼ä¸­ï¼Œä½ å¯ä»¥å¼•ç”¨ç¬¦åˆç›‘å¬å™¨æ–¹æ³•ç­¾åçš„æ–¹æ³•ã€‚å½“è¡¨è¾¾å¼è®¡ç®—ç»“æœæ˜¯æ–¹æ³•å¼•ç”¨æ—¶ï¼ŒData binding åŒ…è£…æ–¹æ³•å¼•ç”¨å’Œæ‰€æœ‰è€…çš„å¯¹è±¡ï¼Œå¹¶åœ¨ç›®æ ‡ view ä¸Šè®¾ç½®ç›‘å¬å™¨ã€‚å¦‚æœè¡¨è¾¾å¼è®¡ç®—ç»“æœä¸º <code>null</code>ï¼ŒData binding ä¸ä¼šåˆ›å»ºç›‘å¬å™¨å¹¶ä¸”è®¾ç½®ç›‘å¬å™¨ä¸º <code>null</code>ã€‚</li>
<li><a href="https://developer.android.com/topic/libraries/data-binding/expressions#listener_bindings" target="_blank" rel="noopener">ç›‘å¬å™¨ç»‘å®š</a>ï¼šå½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œlambda è¡¨è¾¾å¼ä¼šè¢«è®¡ç®—ã€‚Data binding æ€»æ˜¯åˆ›å»ºç›‘å¬å™¨å¹¶è®¾ç½®åœ¨ view ä¸Šã€‚å½“äº‹ä»¶è¢«æ´¾å‘ï¼Œç›‘å¬å™¨å°†è®¡ç®— lambda è¡¨è¾¾å¼ã€‚</li>
</ul>
<h3 id="æ–¹æ³•å¼•ç”¨"><a href="#æ–¹æ³•å¼•ç”¨" class="headerlink" title="æ–¹æ³•å¼•ç”¨"></a>æ–¹æ³•å¼•ç”¨</h3><p>äº‹ä»¶å¯ä»¥ç›´æ¥ç»‘å®šåˆ°å¤„ç†çš„æ–¹æ³•ä¸Šï¼Œç±»ä¼¼ <a href="https://developer.android.com/reference/android/view/View.html#attr_android:onClick" target="_blank" rel="noopener"><code>android:onClick</code></a> å¯ä»¥è¢«åˆ†é…åˆ°ä¸€ä¸ª Activity ä¸­çš„ä¸€ä¸ªæ–¹æ³•ä¸Šã€‚ä¸ <a href="https://developer.android.com/reference/android/view/View.html" target="_blank" rel="noopener"><code>View</code></a> <code>onClick</code> å±æ€§ç›¸æ¯”ï¼Œä¸€ä¸ªä¸»è¦çš„ä¼˜åŠ¿æ˜¯è¡¨è¾¾å¼åœ¨ç¼–è¯‘æ—¶æœŸè¢«å¤„ç†ï¼Œå› æ­¤å¦‚æœæ–¹æ³•ä¸å­˜åœ¨æˆ–è€…ç­¾åä¸å‡†ç¡®ï¼Œä½ å°†ä¼šæ”¶åˆ°ä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚</p>
<p>æ–¹æ³•å¼•ç”¨ä¸ç›‘å¬å™¨ç»‘å®šä¸¤è€…çš„ä¸»è¦åŒºåˆ«æ˜¯å®é™…çš„ç›‘å¬å™¨å®ç°åœ¨æ•°æ®è¢«ç»‘å®šæ—¶åˆ›å»ºï¼Œè€Œä¸æ˜¯åœ¨äº‹ä»¶è§¦å‘çš„æ—¶å€™ã€‚å¦‚æœä½ å¸Œæœ›åœ¨äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™è®¡ç®—è¡¨è¾¾å¼ï¼Œä½ åº”è¯¥ä½¿ç”¨<a href="https://developer.android.com/topic/libraries/data-binding/expressions#listener_bindings" target="_blank" rel="noopener">ç›‘å¬å™¨ç»‘å®š</a>ã€‚</p>
<p>è¦å°†äº‹ä»¶åˆ†é…ç»™å®ƒçš„å¤„ç†å™¨ï¼Œå°±ä½¿ç”¨æ­£å¸¸çš„ç»‘å®šè¡¨è¾¾å¼ï¼Œå€¼æ˜¯è¦è°ƒç”¨çš„æ–¹æ³•åã€‚ä¾‹å¦‚ï¼Œæ€è€ƒä¸‹é¢çš„å¸ƒå±€æ•°æ®å¯¹è±¡ç¤ºä¾‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHandlers</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onClickFriend</span><span class="params">(view: <span class="type">View</span>)</span></span> &#123; ... &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»‘å®šè¡¨è¾¾å¼å¯ä»¥ä¸ºä¸€ä¸ª view åˆ†é…ä¸€ä¸ªç‚¹å‡»ç›‘å¬å™¨åˆ° <code>onClickFriend()</code> æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">layout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"handlers"</span> <span class="attr">type</span>=<span class="string">"com.example.MyHandlers"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"com.example.User"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">TextView</span> <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:text</span>=<span class="string">"@&#123;user.firstName&#125;"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:onClick</span>=<span class="string">"@&#123;handlers::onClickFriend&#125;"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¡¨è¾¾å¼ä¸­çš„æ–¹æ³•ç­¾åå¿…é¡»è·Ÿç›‘å¬å™¨å¯¹è±¡çš„æ–¹æ³•ç­¾åç¡®åˆ‡åŒ¹é…ã€‚</p>
</blockquote>
<h3 id="ç›‘å¬å™¨ç»‘å®š"><a href="#ç›‘å¬å™¨ç»‘å®š" class="headerlink" title="ç›‘å¬å™¨ç»‘å®š"></a>ç›‘å¬å™¨ç»‘å®š</h3><p>ç›‘å¬å™¨ç»‘å®šæ˜¯åœ¨äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™ç»‘å®šè¡¨è¾¾å¼ã€‚å®ƒä»¬ä¸æ–¹æ³•å¼•ç”¨ç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒä»¬å…è®¸ä½ è¿è¡Œä»»æ„æ•°æ®ç»‘å®šè¡¨è¾¾å¼ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨ Android Gradle Plugin 2.0 åŠä¹‹åç‰ˆæœ¬å¯ç”¨ã€‚</p>
<p>åœ¨æ–¹æ³•å¼•ç”¨ï¼Œæ–¹æ³•çš„å‚æ•°å¿…é¡»è·Ÿäº‹ä»¶ç›‘å¬å™¨çš„å‚æ•°åŒ¹é…ã€‚åœ¨ç›‘å¬å™¨ç»‘å®šä¸­ï¼Œä½ åªéœ€è¦è¿”å›å€¼ä¸ç›‘å¬å™¨æœŸæœ›çš„è¿”å›å€¼ï¼ˆé™¤éæ˜¯ voidï¼‰åŒ¹é…å³å¯ã€‚ä¸¾ä¾‹ï¼Œæ€è€ƒä¸‹é¢åŒ…å« <code>onSaveClick()</code> æ–¹æ³•çš„ presenter ç±»ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Presenter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onSaveClick</span><span class="params">(task: <span class="type">Task</span>)</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€ï¼Œä½ å¯ä»¥ç»‘å®šç‚¹å‡»äº‹ä»¶åˆ° <code>onSaveClick()</code> æ–¹æ³•ï¼Œ å¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</span><br><span class="line">&lt;layout xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">data</span>&gt;</span><br><span class="line">        &lt;variable name=<span class="string">"task"</span> type=<span class="string">"com.android.example.Task"</span> /&gt;</span><br><span class="line">        &lt;variable name=<span class="string">"presenter"</span> type=<span class="string">"com.android.example.Presenter"</span> /&gt;</span><br><span class="line">    &lt;/<span class="keyword">data</span>&gt;</span><br><span class="line">    &lt;LinearLayout android:layout_width=<span class="string">"match_parent"</span> android:layout_height=<span class="string">"match_parent"</span>&gt;</span><br><span class="line">        &lt;Button android:layout_width=<span class="string">"wrap_content"</span> android:layout_height=<span class="string">"wrap_content"</span></span><br><span class="line">        android:onClick=<span class="string">"@&#123;() -&gt; presenter.onSaveClick(task)&#125;"</span> /&gt;</span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line">&lt;/layout&gt;</span><br></pre></td></tr></table></figure>
<p>å½“ä¸€ä¸ªå›è°ƒåœ¨è¡¨è¾¾å¼ä¸­è¢«ä½¿ç”¨ï¼Œdata binding è‡ªåŠ¨åˆ›å»ºå¿…è¦çš„ç›‘å¬å™¨å¹¶æ ¹æ®äº‹ä»¶æ³¨å†Œå®ƒã€‚å½“ view è§¦å‘è¿™ä¸ªäº‹ä»¶ï¼Œdata binding è®¡ç®—æ‰€ç»™çš„è¡¨è¾¾ã€‚ä¸æ­£åˆ™è¡¨è¾¾å¼ç»‘å®šä¸€æ ·ï¼Œåœ¨è®¡ç®—è¿™äº›ç›‘å¬å™¨è¡¨è¾¾å¼æ—¶ï¼Œä½ ä»ç„¶å¾—åˆ°æ•°æ®ç»‘å®šçš„ null å’Œçº¿ç¨‹å®‰å…¨æ€§ã€‚</p>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰å®šä¹‰ä¼ å…¥ <a href="https://developer.android.com/reference/android/view/View.OnClickListener.html#onClick(android.view.View" target="_blank" rel="noopener"><code>onClick(View)</code></a>) çš„ <code>view</code> å‚æ•°ã€‚ç›‘å¬å™¨ç»‘å®šé’ˆå¯¹ç›‘å¬å™¨å‚æ•°æä¾›äº†ä¸¤ç§é€‰æ‹©ï¼šä½ å¯ä»¥å¿½ç•¥æ–¹æ³•çš„æ‰€æœ‰å‚æ•°æˆ–è€…å‘½åå®ƒä»¬ã€‚å¦‚æœä½ æ›´å–œæ¬¢å‘½åå‚æ•°ï¼Œåˆ™å¯ä»¥åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨å®ƒä»¬ã€‚æ¯”å¦‚ï¼Œä¸Šé¢çš„è¡¨è¾¾å¼å¯ä»¥æŒ‰ç…§ä»¥ä¸‹é‡å†™ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:onClick="@&#123;(view) -&gt; presenter.onSaveClick(task)&#125;"</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ä½ æƒ³åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨å‚æ•°ï¼Œå®ƒå¯ä»¥å¦‚ä¸‹å·¥ä½œï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Presenter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onSaveClick</span><span class="params">(view: <span class="type">View</span>, task: <span class="type">Task</span>)</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:onClick="@&#123;(theView) -&gt; presenter.onSaveClick(theView, task)&#125;"</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥ä½¿ç”¨ lambda è¡¨è¾¾å¼ä½¿ç”¨å¤šä¸ªå‚æ•°ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Presenter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onCompletedChanged</span><span class="params">(task: <span class="type">Task</span>, completed: <span class="type">Boolean</span>)</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">CheckBox</span> <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span> <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:onCheckedChanged</span>=<span class="string">"@&#123;(cb, isChecked) -&gt; presenter.completeChanged(task, isChecked)&#125;"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ ç›‘å¬çš„äº‹ä»¶è¿”å›çš„çš„ç±»å‹ä¸æ˜¯ <code>void</code>ï¼Œä½ çš„è¡¨è¾¾å¼ä¹Ÿå¿…é¡»è¿”å›ç›¸åŒç±»å‹çš„ç±»å‹ã€‚ä¸¾ä¾‹ï¼Œå¦‚æœä½ æƒ³ç›‘å¬ long click äº‹ä»¶ï¼Œä½ çš„è¡¨è¾¾å¼åº”è¯¥è¿”å›ä¸€ä¸ª booleanã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Presenter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onLongClick</span><span class="params">(view: <span class="type">View</span>, task: <span class="type">Task</span>)</span></span>: <span class="built_in">Boolean</span> &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:onLongClick="@&#123;(theView) -&gt; presenter.onLongClick(theView, task)&#125;"</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå› ä¸º <code>null</code> å¯¹è±¡æ— æ³•è®¡ç®—è¡¨è¾¾å¼ï¼Œdata binding ä¼šè¿”å›é‚£ä¸ªç±»å‹çš„é»˜è®¤å€¼ã€‚æ¯”å¦‚ï¼Œå¼•ç”¨ç±»å‹çš„ <code>null</code>ï¼Œ<code>int</code> ç±»å‹çš„ <code>0</code>ï¼Œ<code>boolean</code> ç±»å‹çš„ <code>false</code> ç­‰ç­‰ã€‚</p>
<p>å¦‚æœä½ éœ€è¦åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨æ¡ä»¶ï¼ˆæ¯”å¦‚ï¼Œä¸‰å…ƒï¼‰ï¼Œä½ å¯ä»¥æŠŠ <code>void</code> ä½œä¸ºä¸€ä¸ªç¬¦å·ä½¿ç”¨ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:onClick="@&#123;(v) -&gt; v.isVisible() ? doSomething() : void&#125;"</span><br></pre></td></tr></table></figure>
<p><strong>é¿å…å¤æ‚çš„ç›‘å¬å™¨</strong></p>
<p>ç›‘å¬å™¨è¡¨è¾¾å¼æ˜¯å¼ºå¤§çš„ï¼Œå¹¶ä¸”å¯ä»¥ä½¿å¾—ä½ çš„ä»£ç æ›´å®¹æ˜“é˜…è¯»ã€‚å¦ä¸€æ–¹é¢ï¼ŒåŒ…å«è´Ÿè´£è¡¨è¾¾å¼çš„ç›‘å¬å™¨ä¼šä½¿å¾—ä½ çš„ layout éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤ã€‚è¿™äº›è¡¨è¾¾å¼åº”è¯¥éå¸¸ç®€å•ï¼Œå°±åƒå°†å¯ç”¨æ•°æ®ä» UI ä¼ é€’åˆ°å›è°ƒæ–¹æ³•ä¸€æ ·ã€‚ä½ åº”è¯¥åœ¨ä»ç›‘å¬å™¨è¡¨è¾¾å¼è°ƒç”¨çš„å›è°ƒæ–¹æ³•ä¸­å®ç°ä»»ä½•ä¸šåŠ¡é€»è¾‘ã€‚</p>
<h2 id="Imports-variables-å’Œ-includes"><a href="#Imports-variables-å’Œ-includes" class="headerlink" title="Imports, variables, å’Œ includes"></a>Imports, variables, å’Œ includes</h2><p>Data binding åº“æä¾›äº† importsï¼Œvariablesï¼Œincludes ç­‰åŠŸèƒ½ã€‚Imports è®©ä½ åœ¨ layout æ–‡ä»¶ä¸­å¼•ç”¨ç±»å˜å¾—æ›´ç®€å•ã€‚Variables å…è®¸ä½ æè¿°ä¸€ä¸ªå¯ä»¥åœ¨ç»‘å®šè¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„å±æ€§ã€‚Includes è®©ä½ åœ¨ app ä¸­å¤ç”¨å¤æ‚çš„ layoutsã€‚</p>
<h3 id="Imports"><a href="#Imports" class="headerlink" title="Imports"></a>Imports</h3><p>Imports å…è®¸ä½ åœ¨ layouts æ–‡ä»¶ä¸­ç®€å•åœ°å¼•ç”¨ç±»ï¼Œå°±åƒæ‰˜ç®¡ä»£ç ä¸­é‚£æ ·ã€‚åœ¨ <code>data</code> æ ‡ç­¾ä¸­å¯ä»¥æœ‰é›¶ä¸ªæˆ–è€…å¤šä¸ª <code>import</code> æ ‡ç­¾ã€‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç åœ¨ layout æ–‡ä»¶ä¸­å¯¼å…¥ <a href="https://developer.android.com/reference/android/view/View.html" target="_blank" rel="noopener"><code>View</code></a> ç±»ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"android.view.View"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯¼å…¥ <a href="https://developer.android.com/reference/android/view/View.html" target="_blank" rel="noopener"><code>View</code></a> ç±»å…è®¸ä½ ä»ç»‘å®šè¡¨è¾¾å¼ä¸­å¼•ç”¨å®ƒã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•å¼•ç”¨ <code>View</code> ç±»ä¸­çš„ <a href="https://developer.android.com/reference/android/view/View.html#VISIBLE" target="_blank" rel="noopener"><code>VISIBLE</code></a> å’Œ <a href="https://developer.android.com/reference/android/view/View.html#GONE" target="_blank" rel="noopener"><code>GONE</code></a> å¸¸é‡ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:text</span>=<span class="string">"@&#123;user.lastName&#125;"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:visibility</span>=<span class="string">"@&#123;user.isAdult ? View.VISIBLE : View.GONE&#125;"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="ç±»å‹åˆ«å"><a href="#ç±»å‹åˆ«å" class="headerlink" title="ç±»å‹åˆ«å"></a>ç±»å‹åˆ«å</h4><p>å½“ç±»åå†²çªæ—¶ï¼Œå…¶ä¸­ä¸€ä¸ªåº”è¯¥è¢«é‡å‘½åä¸€ä¸ªåˆ«åã€‚ä¸‹é¢ä¾‹å­é‡å‘½å <code>com.example.real.estate</code> åŒ…ä¸­çš„ <code>View</code> ä¸º <code>Vista</code>ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"android.view.View"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"com.example.real.estate.View"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">alias</span>=<span class="string">"Vista"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥åœ¨ layout æ–‡ä»¶ä¸­ä½¿ç”¨ <code>Vista</code> å»å¼•ç”¨ <code>com.example.real.estate.View</code> å’Œä½¿ç”¨ <code>View</code> å¼•ç”¨ <code>android.view.View</code>ã€‚</p>
<h4 id="Import-å…¶å®ƒ-class"><a href="#Import-å…¶å®ƒ-class" class="headerlink" title="Import å…¶å®ƒ class"></a>Import å…¶å®ƒ class</h4><p>å¯¼å…¥çš„ç±»å‹å¯ä»¥åœ¨ variables å’Œè¡¨è¾¾å¼ä¸­ä½œä¸ºç±»å‹æ¥å¼•ç”¨ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº† <code>User</code> å’Œ <code>List</code> ä½œä¸ºå˜é‡çš„ç±»å‹ä½¿ç”¨ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"com.example.User"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"java.util.List"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"User"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"userList"</span> <span class="attr">type</span>=<span class="string">"List&lt;User&gt;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Android Studio ç›®å‰è¿˜ä¸èƒ½å¤„ç†å¯¼å…¥ï¼Œæ‰€ä»¥å¯¹äºå®Œæˆå¯¼å…¥çš„å˜é‡ï¼Œä½ çš„ IDE è¿˜ä¸èƒ½è‡ªåŠ¨è¡¥å…¨ã€‚ä½ çš„ app ä»ç„¶ä¼šç¼–è¯‘ï¼Œå¹¶ä¸”ä½ å¯ä»¥é€šè¿‡å®šä¹‰çš„å˜é‡çš„å®Œå…¨é™å®šåæ¥è§£å†³ IDE é—®é¢˜ã€‚</p>
</blockquote>
<p>ä½ è¿˜å¯ä»¥ä½¿ç”¨å¯¼å…¥çš„ç±»å‹å¯¹è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†è¿›è¡Œè½¬å‹ã€‚ä¸‹é¢çš„ä¾‹å­æŠŠ <code>connection</code> å±æ€§è½¬å‹ä¸º <code>User</code> ç±»å‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:text</span>=<span class="string">"@&#123;((User)(user.connection)).lastName&#125;"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¢«å¯¼å…¥çš„ç±»å‹åœ¨è¡¨è¾¾å¼ä¸­å¯èƒ½ä¹Ÿä¼šè¢«å¼•ç”¨é™æ€å±æ€§å’Œæ–¹æ³•æ¥ä½¿ç”¨ã€‚ä¸‹é¢çš„ä»£ç å¯¼å…¥æ¥ <code>MyStringUtils</code> ç±»å¹¶å¼•ç”¨äº†å®ƒçš„ <code>capitalize</code> æ–¹æ³•ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"com.example.MyStringUtils"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"com.example.User"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">â€¦</span><br><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:text</span>=<span class="string">"@&#123;MyStringUtils.capitalize(user.lastName)&#125;"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>å°±åƒæ‰˜ç®¡ä»£ç é‚£æ ·ï¼Œ<code>java.lang.*</code> æ˜¯è¢«è‡ªåŠ¨å¯¼å…¥äº†çš„ã€‚</p>
<h3 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h3><p>åœ¨ <code>data</code> æ ‡ç­¾ä¸‹ä½ å¯ä»¥ä½¿ç”¨å¤šä¸ª <code>variable</code> æ ‡ç­¾ã€‚æ¯ä¸ª <code>variable</code> æ ‡ç­¾æè¿°äº†ä¸€ä¸ªå±æ€§ï¼Œå®ƒä¼šåœ¨ layout æ–‡ä»¶çš„ç»‘å®šè¡¨è¾¾å¼ä¸­è¢«ä½¿ç”¨ã€‚ä¸‹é¢çš„ä¾‹å­å£°æ˜äº† <code>user</code>ï¼Œ<code>image</code> å’Œ <code>note</code> å˜é‡ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"android.graphics.drawable.Drawable"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"com.example.User"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"image"</span> <span class="attr">type</span>=<span class="string">"Drawable"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"note"</span> <span class="attr">type</span>=<span class="string">"String"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Variable ç±»å‹ä¼šåœ¨ç¼–è¯‘æ—¶æœŸè¢«æ£€æŸ¥ï¼Œæ‰€ä»¥å¦‚æœä¸€ä¸ªå˜é‡å®ç°äº† <a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener"><code>Observable</code></a> æˆ–è€…æ˜¯ä¸€ä¸ª <a href="https://developer.android.com/topic/libraries/data-binding/observability.html#observable_collections" target="_blank" rel="noopener"><code>observable collection</code></a>ï¼Œåˆ™ä¼šåæ˜ åœ¨ç±»å‹ä¸­ã€‚å¦‚æœ variable æ˜¯æ²¡æœ‰å®ç° <code>Observable</code> æ¥å£çš„ä¸€ä¸ªåŸºç±»æˆ–è€…ä¸€ä¸ªæ¥å£ï¼Œé‚£è¿™ä¸ª variable å°±<em>ä¸èƒ½</em>è¢«è§‚å¯Ÿã€‚</p>
<p>å½“ä¸åŒçš„é…ç½®æœ‰ä¸åŒçš„é…ç½®æ–‡ä»¶æ—¶ï¼ˆæ¯”å¦‚ï¼Œæ¨ªå‘æˆ–è€…çºµå‘ï¼‰ï¼Œvariables å°†è¢«ç»„åˆã€‚è¿™äº› layout æ–‡ä»¶ä¹‹é—´ä¸èƒ½æœ‰å†²çªçš„ variable å®šä¹‰ã€‚</p>
<p>ç”Ÿæˆçš„ binding ç±»é’ˆå¯¹æ¯ä¸ªæè¿°çš„ variable éƒ½æœ‰ä¸€ä¸ª setter å’Œ getter æ–¹æ³•ã€‚è¿™äº› variables å€¼éƒ½æ˜¯ä»£ç ä¸­çš„é»˜è®¤å€¼ï¼Œç›´åˆ° setter æ–¹æ³•è¢«è°ƒç”¨ â€”â€” å¼•ç”¨ç±»å‹çš„ <code>null</code>ï¼Œ<code>int</code> ç±»å‹çš„ <code>0</code>ï¼Œ<code>boolean</code> ç±»å‹çš„ <code>false</code> ç­‰ç­‰ã€‚</p>
<p>ä¸€ä¸ªåä¸º <code>context</code> çš„ç‰¹æ®Šçš„ variable ä¼šè¢«ç”Ÿæˆä»¥ä¾¿äºæ ¹æ®éœ€è¦å¯ä»¥åœ¨ç»‘å®šè¡¨è¾¾å¼ä¸­ä½¿ç”¨ã€‚<code>context</code> å€¼æ˜¯ä»æ ¹ view çš„ <a href="https://developer.android.com/reference/android/view/View.html#getContext(" target="_blank" rel="noopener"><code>getContext()</code></a>) æ–¹æ³•è¿”å›çš„ <a href="https://developer.android.com/reference/android/content/Context.html" target="_blank" rel="noopener"><code>Context</code></a> å¯¹è±¡ã€‚<code>context</code> å˜é‡ä¼šè¢«å…·æœ‰è¯¥åç§°çš„æ˜¾å¼å˜é‡å£°æ˜æ‰€è¦†ç›–ã€‚</p>
<h3 id="Includes"><a href="#Includes" class="headerlink" title="Includes"></a>Includes</h3><p>é€šè¿‡ä½¿ç”¨ app å‘½åç©ºé—´å’Œå±æ€§ä¸­çš„å˜é‡åï¼Œå¯ä»¥å°†å˜é‡ä»åŒ…å«å¸ƒå±€ä¼ é€’åˆ°åŒ…å«çš„å¸ƒå±€ç»‘å®šä¸­ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº† <code>name.xml</code> å’Œ <code>contact.xml</code> ä¸­çš„ <code>user</code> å˜é‡ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">layout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:bind</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"com.example.User"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">"@layout/name"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">bind:user</span>=<span class="string">"@&#123;user&#125;"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">"@layout/contact"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">bind:user</span>=<span class="string">"@&#123;user&#125;"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Data Binding ä¸æ”¯æŒå°†å…¶ä½œä¸º merge æ ‡ç­¾çš„ç›´æ¥å­çº§åŒ…æ‹¬åœ¨å†…ã€‚ä¸¾ä¾‹ï¼Œ<em>ä¸‹é¢çš„ layout ä¸æ”¯æŒ</em>ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">layout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:bind</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"com.example.User"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">merge</span>&gt;</span><span class="comment">&lt;!-- Doesn't work --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">"@layout/name"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">bind:user</span>=<span class="string">"@&#123;user&#125;"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">"@layout/contact"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">bind:user</span>=<span class="string">"@&#123;user&#125;"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">merge</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component DataBinding -- Get Startedï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_databinding_get_started/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-DataBinding-â€“-Get-Startedï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-DataBinding-â€“-Get-Startedï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component DataBinding â€“ Get Startedï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component DataBinding â€“ Get Startedï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/data-binding/start" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/data-binding/start</a></p>
</blockquote>
<p>å­¦ä¹ å¦‚ä½•è®©ä½ çš„å¼€å‘ç¯å¢ƒå‡†å¤‡å¥½ä½¿ç”¨ Data Binding åº“ï¼ŒåŒ…æ‹¬æ”¯æŒ android studio ä¸­çš„ Data Binding ä»£ç ã€‚</p>
<p>Data Binding åº“æä¾›äº†çµæ´»æ€§å’Œå¹¿æ³›çš„å…¼å®¹æ€§ â€”â€” å®ƒæ˜¯ä¸€ä¸ªæ”¯æŒåº“ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨è¿è¡Œ Android 4.0ï¼ˆAPI level 14ï¼‰åŠä»¥ä¸Šç‰ˆæœ¬çš„è®¾å¤‡ä¸Šä½¿ç”¨å®ƒã€‚</p>
<p>æ¨èåœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨æœ€æ–°çš„ Android Gradle æ’ä»¶ã€‚ä½†æ˜¯ï¼Œdata binding æ”¯æŒ 1.5.0 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚æ›´å¤šè¯¦æƒ…ï¼Œè§å¦‚ä½•<a href="https://developer.android.com/studio/releases/gradle-plugin.html#updating-plugin" target="_blank" rel="noopener">æ›´æ–° Android Gradle æ’ä»¶</a>ã€‚</p>
<h2 id="æ„å»ºç¯å¢ƒ"><a href="#æ„å»ºç¯å¢ƒ" class="headerlink" title="æ„å»ºç¯å¢ƒ"></a>æ„å»ºç¯å¢ƒ</h2><p>è¦å¼€å§‹ä½¿ç”¨ Data Bindingï¼Œåœ¨ Android SDK Manager çš„ <strong>Support Repository</strong> ä¸­ä¸‹è½½åº“ã€‚æ›´å¤šè¯¦æƒ…è§<a href="https://developer.android.com/studio/intro/update.html" target="_blank" rel="noopener">æ›´æ–° IDE å’Œ SDK Tools</a>ã€‚</p>
<p>è¦é…ç½®ä½ çš„ app ä½¿ç”¨ data bindingï¼Œåœ¨ä½ çš„ app module çš„ <code>build.gradle</code> æ–‡ä»¶ä¸­å¢åŠ  <code>dataBinding</code> æ ‡ç­¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    dataBinding &#123;</span><br><span class="line">        enabled = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šå¦‚æœä½ çš„ app ä¾èµ–äº†ä½¿ç”¨ data binding çš„åº“ï¼Œå°±ç®—ä½ çš„ app module æ²¡æœ‰ç›´æ¥ä½¿ç”¨ data bindingï¼Œä¹Ÿå¿…é¡»åœ¨ä½ çš„ app moudle ä¸­è¿›è¡Œé…ç½®ã€‚</p>
</blockquote>
<h2 id="Android-Studio-æ”¯æŒ-data-binding"><a href="#Android-Studio-æ”¯æŒ-data-binding" class="headerlink" title="Android Studio æ”¯æŒ data binding"></a>Android Studio æ”¯æŒ data binding</h2><p>Android studio æ”¯æŒ Data Binding ä»£ç çš„è®¸å¤šç¼–è¾‘åŠŸèƒ½ã€‚ä¸¾ä¾‹ï¼Œå®ƒæ”¯æŒä»¥ä¸‹ data binding è¡¨è¾¾å¼çš„åŠŸèƒ½ï¼š</p>
<ul>
<li>è¯­æ³•é«˜äº®</li>
<li>è¡¨è¾¾å¼è¯­è¨€çš„è¯­æ³•é”™è¯¯æ ‡è®°</li>
<li>xml ä»£ç ç¼–è¯‘</li>
<li>å¼•ç”¨ï¼ŒåŒ…æ‹¬ <a href="https://www.jetbrains.com/help/idea/2017.1/navigation-in-source-code.html" target="_blank" rel="noopener">å¯¼èˆª</a> ï¼ˆæ¯”å¦‚å¯¼èˆªè·³è½¬åˆ°å£°æ˜ï¼‰å’Œ <a href="https://www.jetbrains.com/help/idea/2017.1/viewing-inline-documentation.html" target="_blank" rel="noopener">å¿«é€Ÿæ–‡æ¡£</a></li>
</ul>
<blockquote>
<p>å°å¿ƒï¼šæ•°ç»„å’Œ<a href="https://docs.oracle.com/javase/tutorial/java/generics/types.html" target="_blank" rel="noopener">æ³›å‹ç±»å‹</a>ï¼Œæ¯”å¦‚ <a href="https://developer.android.com/reference/android/databinding/Observable.html" target="_blank" rel="noopener">Observable</a> ç±»ï¼Œå¯èƒ½é”™è¯¯æç¤ºä¸å‡†ç¡®ã€‚</p>
</blockquote>
<p><strong>Layout Editor</strong> çš„ <strong>Preview</strong> çª—å£ä¼šå±•ç¤º data binding è¡¨è¾¾å¼çš„é»˜è®¤å€¼å¦‚æœæä¾›äº†çš„è¯ã€‚ä¸¾ä¾‹ï¼Œ<strong>Preview</strong> çª—å£åœ¨å¦‚ä¸‹å£°æ˜çš„ <code>TextView</code> æ§ä»¶ä¸­æ˜¾ç¤º <code>my_default</code> å€¼ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextView</span> <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">"@&#123;user.firstName, default=my_default&#125;"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ åªéœ€è¦åœ¨é¡¹ç›®çš„è®¾è®¡é˜¶æ®µæ˜¾ç¤ºé»˜è®¤å€¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>tools</code> å±æ€§æ¥ä»£æ›¿é»˜è®¤çš„è¡¨è¾¾å¼å€¼ï¼Œå°±åƒ <a href="https://developer.android.com/studio/write/tool-attributes.html" target="_blank" rel="noopener">Tools Attributes Reference</a> ä¸­æè¿°çš„é‚£æ ·ã€‚</p>
<h2 id="ç”¨äºç»‘å®šç±»çš„æ–°-data-binding-ç¼–è¯‘å™¨"><a href="#ç”¨äºç»‘å®šç±»çš„æ–°-data-binding-ç¼–è¯‘å™¨" class="headerlink" title="ç”¨äºç»‘å®šç±»çš„æ–° data binding ç¼–è¯‘å™¨"></a>ç”¨äºç»‘å®šç±»çš„æ–° data binding ç¼–è¯‘å™¨</h2><p>Android Gradle plugin ç‰ˆæœ¬ <code>3.1.0-alpha06</code> åŒ…æ‹¬äº†ä¸€ä¸ªæ–°çš„ data binding ç¼–è¯‘å™¨ç”¨äºç”Ÿæˆç»‘å®šç±»ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–°çš„ç¼–è¯‘å™¨ä¼šå¢é‡åˆ›å»ºç»‘å®šç±»ï¼Œè¿™åŠ å¿«äº†æ„å»ºè¿‡ç¨‹ã€‚å­¦ä¹ æ›´å¤šå…³äºç»‘å®šç±»ï¼Œè§ <strong><a href="https://developer.android.com/topic/libraries/data-binding/generated-binding" target="_blank" rel="noopener">ç”Ÿæˆçš„ç»‘å®šç±»</a></strong>ã€‚</p>
<p>ä»¥å‰ç‰ˆæœ¬çš„ data binding ç¼–è¯‘å™¨åœ¨ç¼–è¯‘ä½ çš„æ‰˜ç®¡ä»£ç çš„åŒä¸€æ­¥éª¤ä¸­ç”Ÿæˆç»‘å®šç±»ã€‚å¦‚æœä½ çš„æ‰˜ç®¡ä»£ç ç¼–è¯‘å¤±è´¥ï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°å¤šä¸ª binding class æ‰¾ä¸åˆ°çš„é”™è¯¯ã€‚æ–°çš„ data binding ç¼–è¯‘å™¨é€šè¿‡åœ¨ç¼–è¯‘å™¨ç”Ÿæˆä½ çš„ app ä¹‹å‰ç”Ÿæˆç»‘å®šç±»æ¥é¿å…è¿™äº›é”™è¯¯ã€‚</p>
<p>è¦æ‰“å¼€æ–°çš„ data binding ç¼–è¯‘å™¨ï¼Œåœ¨ä½ çš„ <code>gradle.properties</code> æ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹é€‰é¡¹ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android.databinding.enableV2=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>ä½ ä¹Ÿå¯ä»¥åœ¨ gradle å‘½ä»¤è¡Œä¸­å¢åŠ ä»¥ä¸‹å‚æ•°æ¥å¯ç”¨æ–°çš„ç¼–è¯‘å™¨ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Pandroid.databinding.enableV2=true</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šAndroid Plugin 3.1 ç‰ˆæœ¬çš„æ–°çš„ data binding ç¼–è¯‘å™¨å‘åä¸å…¼å®¹ã€‚ä½ éœ€è¦åœ¨å¯ç”¨æ­¤åŠŸèƒ½çš„æƒ…å†µä¸‹ç”Ÿæˆæ‰€æœ‰ç»‘å®šç±»ï¼Œä»¥ä½¿ç”¨å¢é‡ç¼–è¯‘ã€‚ä½†æ˜¯ï¼ŒAndroid Plugin 3.2 ç‰ˆä¸­çš„æ–°ç¼–è¯‘å™¨ä¸ä»¥å‰ç‰ˆæœ¬ç”Ÿæˆçš„ç»‘å®šç±»å…¼å®¹ã€‚æ–°çš„ç¼–è¯‘å™¨åœ¨ 3.2 ç‰ˆæœ¬ä¸­é»˜è®¤å¯ç”¨ã€‚</p>
</blockquote>
<p>å¯ç”¨æ–°çš„ data binding ç¼–è¯‘å™¨æ—¶ï¼Œä¼šæœ‰ä»¥ä¸‹è¡Œä¸ºå˜åŒ–ï¼š</p>
<ul>
<li>åœ¨ç¼–è¯‘ä½ çš„æ‰˜ç®¡ä»£ç ä¹‹å‰ï¼ŒAndroid Gradle plugin ä¼šä¸ºä½ çš„ layouts ç”Ÿæˆ binding classã€‚</li>
<li>å¦‚æœä¸€ä¸ª layout åŒ…å«åœ¨å¤šä¸ªç›®æ ‡èµ„æºé…ç½®ï¼Œå¯¹äºæ‰€æœ‰å…±äº«ç›¸åŒçš„èµ„æº idï¼ˆä¸åŒ…æ‹¬è§†å›¾ç±»å‹ï¼‰çš„viewsï¼Œdata binding åº“ä¼šä½¿ç”¨ <code>android.view.View</code> ä½œä¸ºé»˜è®¤çš„ view ç±»å‹</li>
<li>Library modules çš„ Binding classï¼Œä¼šè¢«ç¼–è¯‘æ‰“åŒ…åˆ°ç›¸åº”çš„ AAR æ–‡ä»¶ä¸­ã€‚ App modules ä¾èµ–çš„è¿™äº› library modules ä¸éœ€è¦å†å»ç”Ÿæˆè¿™äº› binding classã€‚æ›´å¤šå…³äº AAR æ–‡ä»¶çš„è¯¦æƒ…ï¼Œè§ <a href="https://developer.android.com/studio/projects/android-library" target="_blank" rel="noopener">åˆ›å»ºä¸€ä¸ª Android åº“</a>ã€‚</li>
<li>ä¸€ä¸ª module çš„ binding adapters ä¸èƒ½æ›´æ”¹æ¨¡å—ä¾èµ–çš„ adapter çš„è¡Œä¸ºã€‚Binding adapters åªèƒ½å½±å“è‡ªå·± module çš„ä»£ç  å’Œ module çš„ä½¿ç”¨è€…çš„ä»£ç ã€‚</li>
</ul>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component DataBinding -- æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_databinding_overview/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-DataBinding-â€“-æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-DataBinding-â€“-æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component DataBinding â€“ æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component DataBinding â€“ æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://developer.android.com/topic/libraries/data-binding/index" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/data-binding/index</a></p>
</blockquote>
<p>Data Binding åº“æ˜¯ä¸€ä¸ªå…è®¸ä½ åœ¨ä½ çš„ app ä¸­ä½¿ç”¨å£°æ˜æ€§æ ¼å¼è€ŒéåŠ¨æ€çš„æ–¹å¼ç»‘å®š layout çš„ UI ç»„ä»¶åˆ°æ•°æ®æºçš„æ”¯æŒåº“ã€‚</p>
<p>Layout é€šå¸¸æ˜¯ä½¿ç”¨ä»£ç åœ¨ activities ä¸­è°ƒç”¨ UI å±‚é¢çš„æ–¹æ³•æ¥å®šä¹‰çš„ã€‚ä¸¾ä¾‹ï¼Œä¸‹é¢ä»£ç è°ƒç”¨ <code>[findViewById](https://developer.android.com/reference/android/app/Activity.html#findViewById(int))</code> æ¥æ‰¾åˆ°ä¸€ä¸ª <code>[TextView](https://developer.android.com/reference/android/widget/TextView.html)</code> æ§ä»¶å¹¶æŠŠå®ƒç»‘å®šåˆ° <code>viewModel</code> å˜é‡çš„ <code>userName</code> å±æ€§ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">findViewById&lt;TextView&gt;(R.id.sample_text).apply &#123;</span><br><span class="line">    text = viewModel.userName</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†æ€æ ·ä½¿ç”¨ Data Binding åº“ç›´æ¥åœ¨ layout æ–‡ä»¶ä¸­å°† text åˆ†é…ç»™æ§ä»¶ã€‚è¿™æ ·å°±ä¸éœ€è¦è°ƒç”¨ä»¥ä¸Šä»»ä½•çš„ java ä»£ç ã€‚æ³¨æ„åœ¨åˆ†é…è¡¨è¾¾å¼ä¸­ä½¿ç”¨ <code>@{}</code> è¯­æ³•:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">"@&#123;viewmodel.userName&#125;"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡å¯¹ layout æ–‡ä»¶ä¸­çš„ç»‘å®šç»„ä»¶ï¼Œä½ å¯ä»¥ç§»é™¤ Activities ä¸­å¾ˆå¤šçš„ UI å±‚çš„è°ƒç”¨ï¼Œä½¿å…¶æ›´ç®€å•å’Œæ›´æ˜“äºç»´æŠ¤ã€‚è¿™è¿˜å¯ä»¥æé«˜åº”ç”¨çš„æ€§èƒ½ï¼Œå¹¶æœ‰åŠ©äºé˜²æ­¢å†…å­˜æ³„æ¼å’Œç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p>
<h2 id="ä½¿ç”¨-Data-Binding-åº“"><a href="#ä½¿ç”¨-Data-Binding-åº“" class="headerlink" title="ä½¿ç”¨ Data Binding åº“"></a>ä½¿ç”¨ Data Binding åº“</h2><p>é€šè¿‡ä»¥ä¸‹é¡µé¢äº†è§£å¦‚ä½•åœ¨ android åº”ç”¨ä¸­ä½¿ç”¨ Data Binding åº“ã€‚</p>
<h3 id="Get-Started"><a href="#Get-Started" class="headerlink" title="Get Started"></a><a href="https://developer.android.com/topic/libraries/data-binding/start.html" target="_blank" rel="noopener">Get Started</a></h3><p>äº†è§£å¦‚ä½•è®©ä½ çš„å¼€å‘ç¯å¢ƒå‡†å¤‡å¥½ä½¿ç”¨ data binding åº“ï¼ŒåŒ…æ‹¬æ”¯æŒ android studio ä¸­çš„ data binding ä»£ç ã€‚</p>
<h3 id="å¸ƒå±€å’Œç»‘å®šè¡¨è¾¾å¼"><a href="#å¸ƒå±€å’Œç»‘å®šè¡¨è¾¾å¼" class="headerlink" title="å¸ƒå±€å’Œç»‘å®šè¡¨è¾¾å¼"></a><a href="https://developer.android.com/topic/libraries/data-binding/expressions.html" target="_blank" rel="noopener">å¸ƒå±€å’Œç»‘å®šè¡¨è¾¾å¼</a></h3><p>è¡¨è¾¾å¼è¯­è¨€å…è®¸ä½ ç¼–å†™è¿æ¥å˜é‡åˆ° layout ä¸­çš„ view çš„è¡¨è¾¾å¼ã€‚Data binding åº“ä¼šè‡ªåŠ¨ç”Ÿæˆå°† layout ä¸­çš„ view ä¸æ•°æ®å¯¹è±¡ç»‘å®šæ‰€éœ€çš„ç±»ã€‚è¯¥åº“æä¾›äº† importï¼Œvariables ç­‰åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯åœ¨ layout ä¸­ä½¿ç”¨çš„åŠŸèƒ½ã€‚</p>
<p>è¿™äº›åº“çš„ç‰¹æ€§ä¸ä½ å­˜åœ¨çš„å¸ƒå±€æ˜¯æ— ç¼å…±å­˜çš„ã€‚ä¸¾ä¾‹ï¼Œå¯ä»¥åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„ç»‘å®šå˜é‡æ˜¯è¢«å®šä¹‰åœ¨  UI å¸ƒå±€çš„æ ¹æ ‡ç­¾åŒçº§çš„ <code>data</code> æ ‡ç­¾ã€‚ä¸¤è€…æ ‡ç­¾éƒ½è¢«åŒ…å«åœ¨ä¸€ä¸ª <code>layout</code> æ ‡ç­¾ä¸­ï¼Œå°±å¦‚ä¸‹é¢ä¾‹å­ä¸­è¿™æ ·ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">layout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">variable</span></span></span><br><span class="line"><span class="tag">            <span class="attr">name</span>=<span class="string">"viewmodel"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"com.myapp.data.ViewModel"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ConstraintLayout...</span> /&gt;</span> <span class="comment">&lt;!-- UI layout's root element --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡"><a href="#ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡" class="headerlink" title="ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡"></a><a href="https://developer.android.com/topic/libraries/data-binding/observability.html" target="_blank" rel="noopener">ä½¿ç”¨å¯è§‚å¯Ÿçš„æ•°æ®å¯¹è±¡</a></h3><p>Data binding åº“æä¾›äº†ç±»å’Œæ–¹æ³•æ¥å¾ˆå®¹æ˜“åœ°è§‚å¯Ÿæ•°æ®çš„æ”¹å˜ã€‚å½“åº•å±‚æ•°æ®æºå‘ç”Ÿæ”¹å˜æ—¶ï¼Œä½ ä¸éœ€è¦æ‹…å¿ƒåˆ·æ–° UIã€‚ä½ å¯ä»¥ä½¿å˜é‡æˆ–å…¶å±æ€§æ˜¯å¯è§‚å¯Ÿçš„ã€‚è¿™ä¸ªåº“å…è®¸ä½ ä½¿å¯¹è±¡ï¼Œå­—æ®µï¼Œé›†åˆå¯è§‚å¯ŸåŒ–ã€‚</p>
<h3 id="ç”Ÿæˆç»‘å®šç±»"><a href="#ç”Ÿæˆç»‘å®šç±»" class="headerlink" title="ç”Ÿæˆç»‘å®šç±»"></a><a href="https://developer.android.com/topic/libraries/data-binding/generated-binding.html" target="_blank" rel="noopener">ç”Ÿæˆç»‘å®šç±»</a></h3><p>Data binding åº“ä¼šç”Ÿæˆç»‘å®šç±»ï¼Œç”¨æ¥è®¿é—® layout çš„å˜é‡å’Œ viewsã€‚æ­¤é¡µå±•ç¤ºå¦‚ä½•ä½¿ç”¨å’Œè‡ªå®šä¹‰ç”Ÿæˆçš„ç»‘å®šç±»ã€‚</p>
<h3 id="Binding-adapters"><a href="#Binding-adapters" class="headerlink" title="Binding adapters"></a><a href="https://developer.android.com/topic/libraries/data-binding/binding-adapters.html" target="_blank" rel="noopener">Binding adapters</a></h3><p>å¯¹äºæ¯ä¸ªå¸ƒå±€è¡¨è¾¾å¼ï¼Œéƒ½æœ‰ä¸€ä¸ªç»‘å®šé€‚é…å™¨ï¼Œç”¨æ¥è¿›è¡Œè®¾ç½®æ¡†æ¶è°ƒç”¨éœ€è¦çš„ç›¸åº”çš„å±æ€§æˆ–è€…ç›‘å¬å™¨ã€‚ä¸¾ä¾‹ï¼Œbinding adapter å¯ä»¥è´Ÿè´£è°ƒç”¨ <code>setText()</code> æ–¹æ³•æ¥è®¾ç½®æ–‡æœ¬å±æ€§æˆ–è°ƒç”¨ <code>setOnclickListener()</code> æ–¹æ³•å°†ç›‘å¬å™¨æ·»åŠ åˆ° click Â·ã€‚å¤§éƒ¨åˆ†é€šç”¨çš„ binding adaptersï¼Œæ¯”å¦‚è¿™ä¸€ç« ä¾‹å­ä¸­ä½¿ç”¨çš„ <code>android:text</code> å±æ€§çš„ adapters æ˜¯å¯ç”¨çš„ï¼Œå®ƒåœ¨ <code>android.databinding.adapters</code> åŒ…ä¸­ã€‚å¸¸è§ binding adapters çš„åˆ—è¡¨ï¼Œè§ <a href="https://android.googlesource.com/platform/frameworks/data-binding/+/studio-master-dev/extensions/baseAdapters/src/main/java/androidx/databinding/adapters" target="_blank" rel="noopener">adapters</a>ã€‚ä½ å¯ä»¥åˆ›å»ºè‡ªå·±çš„ adaptersï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BindingAdapter(<span class="meta-string">"app:goneUnless"</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">goneUnless</span><span class="params">(view: <span class="type">View</span>, visible: <span class="type">Boolean</span>)</span></span> &#123;</span><br><span class="line">    view.visibility = <span class="keyword">if</span> (visible) View.VISIBLE <span class="keyword">else</span> View.GONE</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç»‘å®šå¸ƒå±€-views-åˆ°-Architecture-Components"><a href="#ç»‘å®šå¸ƒå±€-views-åˆ°-Architecture-Components" class="headerlink" title="ç»‘å®šå¸ƒå±€ views åˆ° Architecture Components"></a><a href="https://developer.android.com/topic/libraries/data-binding/architecture.html" target="_blank" rel="noopener">ç»‘å®šå¸ƒå±€ views åˆ° Architecture Components</a></h3><p>Android Support Library åŒ…æ‹¬äº† <a href="https://developer.android.com/topic/libraries/architecture/index.html" target="_blank" rel="noopener">Architecture Components</a>ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ è®¾è®¡å…·æœ‰é²æ£’æ€§ï¼Œå¯æµ‹è¯•æ€§ï¼Œå¯ç»´æŠ¤æ€§çš„ appã€‚ä½ å¯ä»¥ä½¿ç”¨ Architecture Components å’Œ Data Binding åº“æ¥è¿›ä¸€æ­¥ç®€åŒ– UI çš„å¼€å‘ã€‚</p>
<h3 id="åŒå‘æ•°æ®ç»‘å®š"><a href="#åŒå‘æ•°æ®ç»‘å®š" class="headerlink" title="åŒå‘æ•°æ®ç»‘å®š"></a><a href="https://developer.android.com/topic/libraries/data-binding/two-way" target="_blank" rel="noopener">åŒå‘æ•°æ®ç»‘å®š</a></h3><p>Data Binding åº“æ”¯æŒåŒå‘ç»‘å®šã€‚ç”¨äºè¿™ç±»ç»‘å®šæ”¯æŒæ¥æ”¶å¯¹å±æ€§çš„æ•°æ®æ›´æ”¹ï¼ŒåŒæ—¶ç›‘å¬ç”¨æˆ·å¯¹è¯¥å±æ€§çš„ä¿®æ”¹çš„èƒ½åŠ›ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
            <category> DataBinding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Architecture Component -- æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/04/15/android_architecture_components_overview/</url>
      <content type="html"><![CDATA[<h1 id="Android-Architecture-Component-â€“-æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰"><a href="#Android-Architecture-Component-â€“-æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Android Architecture Component â€“ æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰"></a>Android Architecture Component â€“ æ¦‚è¦ï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>å†™åœ¨å‰é¢ï¼šæŠ½ç©ºæ•´ç†ä¸€ä¸‹ Android Architecture Component å®˜æ–¹æ–‡æ¡£çš„ç¿»è¯‘ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£ä¼šåˆ†æˆå¾ˆå¤šç¯‡ï¼Œå½“è‡ªå·±å›é¡¾åšä¸ªç¬”è®°ï¼Œä¹Ÿæ–¹ä¾¿å¤§å®¶å‚è€ƒã€‚</p>
<p>æ³¨ï¼šä»¥ä¸‹ â€œAndroid Architecture Componentâ€ï¼ŒAndroid ä½“ç³»ç»“æ„ç»„ä»¶ï¼Œåœ¨è¯‘æ–‡ä¸­å‡ä¸åšå…·ä½“ç¿»è¯‘ã€‚<br><br><br>åŸæ–‡ï¼š</p>
<ul>
<li><a href="https://developer.android.com/topic/libraries/architecture/index" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/architecture/index</a></li>
<li><a href="https://developer.android.com/topic/libraries/architecture/adding-components" target="_blank" rel="noopener">https://developer.android.com/topic/libraries/architecture/adding-components</a></li>
</ul>
</blockquote>
<h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><p>Android Architecture Components æ˜¯ä¸€ç³»åˆ—å¯ä»¥å¸®åŠ©ä½ è®¾è®¡å…·æœ‰é²æ£’æ€§ï¼Œå¯æµ‹è¯•æ€§ï¼Œå¯ç»´æŠ¤æ€§çš„ appã€‚ä»ç®¡ç† UI ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå’Œå¤„ç†æ•°æ®æŒä¹…ç±»å¼€å§‹ã€‚</p>
<ul>
<li>è½»æ¾ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚æ–°çš„ <a href="https://developer.android.com/topic/libraries/architecture/lifecycle" target="_blank" rel="noopener">lifecycle-aware components</a> å¯ä»¥å¸®åŠ©ä½ ç®¡ç† Activity å’Œ Fragment çš„ç”Ÿå‘½å‘¨æœŸã€‚é…ç½®è¢«æ”¹å˜æ—¶é‡å»ºï¼Œé¿å…å†…å­˜æ³„æ¼å¹¶è½»æ¾åœ°åŠ è½½æ•°æ®åˆ°UIã€‚</li>
<li>ä½¿ç”¨ <a href="https://developer.android.com/topic/libraries/architecture/livedata" target="_blank" rel="noopener">LiveData</a> æ¥æ„å»ºæ•°æ®å¯¹è±¡ï¼Œå®ƒä¼šåœ¨åº•å±‚æ•°æ®åº“ä¿®æ”¹æ—¶é€šçŸ¥ç»™ Viewã€‚</li>
<li><a href="https://developer.android.com/topic/libraries/architecture/viewmodel" target="_blank" rel="noopener">ViewModel</a> å­˜å‚¨äº† UI ç›¸å…³çš„å¯¹è±¡ï¼Œå®ƒä¸ä¼šåœ¨ app è¢«æ—‹è½¬æ—¶é”€æ¯ã€‚</li>
<li><a href="https://developer.android.com/topic/libraries/architecture/room" target="_blank" rel="noopener">Room</a> æ˜¯ä¸€ä¸ª SQLite å¯¹è±¡æ˜ å°„åº“ã€‚ä½¿ç”¨å®ƒå¯ä»¥é¿å…æ¨¡ç‰ˆä»£ç å¹¶ç®€å•åœ°è½¬æ¢ SQLite æ•°æ®è¡¨æ•°æ®åˆ° Java å¯¹è±¡)ã€‚Room æä¾›äº†ç¼–è¯‘æ—¶æœŸçš„ SQLite è¯­å¥çš„æ£€æŸ¥ï¼Œå¹¶å¯ä»¥è¿”å› RxJavaï¼ŒFlowable å’Œ LiveData è§‚å¯Ÿè€…ã€‚</li>
</ul>
<h2 id="å¢åŠ -Components-åˆ°ä½ çš„é¡¹ç›®ä¸­"><a href="#å¢åŠ -Components-åˆ°ä½ çš„é¡¹ç›®ä¸­" class="headerlink" title="å¢åŠ  Components åˆ°ä½ çš„é¡¹ç›®ä¸­"></a>å¢åŠ  Components åˆ°ä½ çš„é¡¹ç›®ä¸­</h2><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬æ¨èå…ˆé˜…è¯» Architecture Components <a href="https://developer.android.com/topic/libraries/architecture/guide.html" target="_blank" rel="noopener">App ä½“ç³»ç»“æ„æŒ‡å—</a>ã€‚è¿™ä¸ªæŒ‡å—ä¸­æœ‰ä¸€äº›æœ‰ç”¨çš„å‡†åˆ™å¯ä»¥è¿ç”¨åˆ°æ‰€æœ‰çš„ Android App ä¸­ï¼Œå¹¶ä¸”å±•ç¤ºäº†æ€ä¹ˆä¸€èµ·ä½¿ç”¨ Architecture Componentsã€‚</p>
<p>Architecture Components ç›®å‰åœ¨ Google Maven ä»“åº“ä¸­å·²ç»å¯ç”¨ï¼Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<h3 id="å¢åŠ -Google-Maven-ä»“åº“"><a href="#å¢åŠ -Google-Maven-ä»“åº“" class="headerlink" title="å¢åŠ  Google Maven ä»“åº“"></a>å¢åŠ  Google Maven ä»“åº“</h3><p>Android Studio é¡¹ç›®æ²¡æœ‰è¢«é…ç½®é»˜è®¤è®¿é—®è¿™ä¸ªä»“åº“ã€‚</p>
<p>å¢åŠ åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼Œæ‰“å¼€ä½ <strong>é¡¹ç›®</strong>(ä¸æ˜¯ä½  app æˆ–è€… module çš„)çš„ <code>build.gradle</code> æ–‡ä»¶ï¼Œåœ¨ä»¥ä¸‹ä¸€è¡Œå¢åŠ  <code>google()</code> ä»“åº“ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">        google()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å£°æ˜ä¾èµ–"><a href="#å£°æ˜ä¾èµ–" class="headerlink" title="å£°æ˜ä¾èµ–"></a>å£°æ˜ä¾èµ–</h3><p>æ‰“å¼€ä½  <strong>app æˆ–è€… module</strong> çš„ <code>build.gradle</code> æ–‡ä»¶å¹¶å¢åŠ ä½ éœ€è¦çš„ artifacts ä½œä¸ºä¾èµ–ã€‚ä½ å¯ä»¥å¢åŠ æ‰€æœ‰çš„ä¾èµ–ï¼Œæˆ–è€…é€‰æ‹©å­é›†ã€‚</p>
<h4 id="Android-X"><a href="#Android-X" class="headerlink" title="Android X"></a>Android X</h4><p>å½“å‰ç‰ˆæœ¬çš„ Arch Components æ˜¯ä½¿ç”¨ Android X åŒ…å¼€å‘çš„ã€‚è¿™äº›è¢«åˆ—å‡ºçš„è¡¨ç¤ºå¯ç”¨çš„ï¼Œå¹¶ä¸”åç§°äºä¹‹å‰ç‰ˆæœ¬ï¼ˆ1.xï¼‰ä¸åŒã€‚</p>
<p>æ›´å¤š AndroidX ç›¸å…³çš„é‡æ„çš„ä¿¡æ¯ï¼Œè¿˜æœ‰å®ƒä»¬æ˜¯å¦‚ä½•å½±å“ç±»åŒ…å’Œæ¨¡å— idçš„ï¼Œè¯·çœ‹ AndroidX <a href="https://developer.android.com/topic/libraries/support-library/refactor" target="_blank" rel="noopener">é‡æ„æ–‡æ¡£</a></p>
<h4 id="Kotlin"><a href="#Kotlin" class="headerlink" title="Kotlin"></a>Kotlin</h4><p>Kotlin extesion modules å¦‚ä»¥ä¸‹ç”¨ <code>// use -ktx for Kotlin</code> æ ‡ç­¾çš„åˆ™æ˜¯æ”¯æŒçš„ï¼Œæ›¿æ¢å®ƒå³å¯ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">"androidx.lifecycle:lifecycle-viewmodel:$lifecycle_version"</span> <span class="comment">// use -ktx for Kotlin</span></span><br></pre></td></tr></table></figure>
<p>ä»¥åŠ</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">"androidx.lifecycle:lifecycle-viewmodel-ktx:$lifecycle_version"</span></span><br></pre></td></tr></table></figure>
<p>åŒ…æ‹¬ Kotlin extensions çš„æ–‡æ¡£çš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥çœ‹è¿™é‡Œ <a href="https://developer.android.com/kotlin/ktx" target="_blank" rel="noopener">ktx documentation</a>ã€‚</p>
<blockquote>
<p>å¯¹äºåŸºäº Kotlin çš„appï¼Œç¡®ä¿ä½ ä½¿ç”¨äº† <strong>kapt</strong> ä»£æ›¿ <strong>annotationProcessor</strong>ã€‚ä½ åº”è¯¥å†å¢åŠ  <strong>kotlin-kapt</strong> æ’ä»¶ã€‚</p>
</blockquote>
<h4 id="Futures"><a href="#Futures" class="headerlink" title="Futures"></a>Futures</h4><p>Futures ä¾èµ–ã€‚</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> futures_version = <span class="string">"1.0.0-alpha02"</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">"androidx.concurrent:concurrent-futures:$futures_version"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Lifecycle"><a href="#Lifecycle" class="headerlink" title="Lifecycle"></a>Lifecycle</h4><p><a href="https://developer.android.com/topic/libraries/architecture/lifecycle.html" target="_blank" rel="noopener">Lifecycle</a> ä¾èµ–ï¼ŒåŒ…æ‹¬ <a href="https://developer.android.com/topic/libraries/architecture/livedata.html" target="_blank" rel="noopener">LiveData</a> å’Œ <a href="https://developer.android.com/topic/libraries/architecture/viewmodel.html" target="_blank" rel="noopener">ViewModel</a></p>
<p><strong>AndroidX</strong></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> lifecycle_version = <span class="string">"2.0.0"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ViewModel and LiveData</span></span><br><span class="line">    implementation <span class="string">"androidx.lifecycle:lifecycle-extensions:$lifecycle_version"</span></span><br><span class="line">    <span class="comment">// alternatively - just ViewModel</span></span><br><span class="line">    implementation <span class="string">"androidx.lifecycle:lifecycle-viewmodel:$lifecycle_version"</span> <span class="comment">// use -ktx for Kotlin</span></span><br><span class="line">    <span class="comment">// alternatively - just LiveData</span></span><br><span class="line">    implementation <span class="string">"androidx.lifecycle:lifecycle-livedata:$lifecycle_version"</span></span><br><span class="line">    <span class="comment">// alternatively - Lifecycles only (no ViewModel or LiveData). Some UI</span></span><br><span class="line">    <span class="comment">//     AndroidX libraries use this lightweight import for Lifecycle</span></span><br><span class="line">    implementation <span class="string">"androidx.lifecycle:lifecycle-runtime:$lifecycle_version"</span></span><br><span class="line"></span><br><span class="line">    annotationProcessor <span class="string">"androidx.lifecycle:lifecycle-compiler:$lifecycle_version"</span> <span class="comment">// use kapt for Kotlin</span></span><br><span class="line">    <span class="comment">// alternately - if using Java8, use the following instead of lifecycle-compiler</span></span><br><span class="line">    implementation <span class="string">"androidx.lifecycle:lifecycle-common-java8:$lifecycle_version"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - ReactiveStreams support for LiveData</span></span><br><span class="line">    implementation <span class="string">"androidx.lifecycle:lifecycle-reactivestreams:$lifecycle_version"</span> <span class="comment">// use -ktx for Kotlin</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Test helpers for LiveData</span></span><br><span class="line">    testImplementation <span class="string">"androidx.arch.core:core-testing:$lifecycle_version"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Pre-AndroidX</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> lifecycle_version = <span class="string">"1.1.1"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ViewModel and LiveData</span></span><br><span class="line">    implementation <span class="string">"android.arch.lifecycle:extensions:$lifecycle_version"</span></span><br><span class="line">    <span class="comment">// alternatively - just ViewModel</span></span><br><span class="line">    implementation <span class="string">"android.arch.lifecycle:viewmodel:$lifecycle_version"</span> <span class="comment">// use -ktx for Kotlin</span></span><br><span class="line">    <span class="comment">// alternatively - just LiveData</span></span><br><span class="line">    implementation <span class="string">"android.arch.lifecycle:livedata:$lifecycle_version"</span></span><br><span class="line">    <span class="comment">// alternatively - Lifecycles only (no ViewModel or LiveData).</span></span><br><span class="line">    <span class="comment">//     Support library depends on this lightweight import</span></span><br><span class="line">    implementation <span class="string">"android.arch.lifecycle:runtime:$lifecycle_version"</span></span><br><span class="line"></span><br><span class="line">    annotationProcessor <span class="string">"android.arch.lifecycle:compiler:$lifecycle_version"</span> <span class="comment">// use kapt for Kotlin</span></span><br><span class="line">    <span class="comment">// alternately - if using Java8, use the following instead of compiler</span></span><br><span class="line">    implementation <span class="string">"android.arch.lifecycle:common-java8:$lifecycle_version"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - ReactiveStreams support for LiveData</span></span><br><span class="line">    implementation <span class="string">"android.arch.lifecycle:reactivestreams:$lifecycle_version"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Test helpers for LiveData</span></span><br><span class="line">    testImplementation <span class="string">"android.arch.core:core-testing:$lifecycle_version"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Room"><a href="#Room" class="headerlink" title="Room"></a>Room</h4><p><a href="https://developer.android.com/topic/libraries/architecture/room.html" target="_blank" rel="noopener">Room</a> ä¾èµ–ï¼ŒåŒ…æ‹¬ <a href="https://developer.android.com/topic/libraries/architecture/room.html#db-migration-testing" target="_blank" rel="noopener">æµ‹è¯• Room è¿ç§»</a> å’Œ <a href="https://developer.android.com/training/data-storage/room/accessing-data.html#query-rxjava" target="_blank" rel="noopener">Room RxJava</a></p>
<p><strong>AndroidX</strong></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> room_version = <span class="string">"2.1.0-alpha02"</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">"androidx.room:room-runtime:$room_version"</span></span><br><span class="line">    annotationProcessor <span class="string">"androidx.room:room-compiler:$room_version"</span> <span class="comment">// use kapt for Kotlin</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - RxJava support for Room</span></span><br><span class="line">    implementation <span class="string">"androidx.room:room-rxjava2:$room_version"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Guava support for Room, including Optional and ListenableFuture</span></span><br><span class="line">    implementation <span class="string">"androidx.room:room-guava:$room_version"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Test helpers</span></span><br><span class="line">    testImplementation <span class="string">"androidx.room:room-testing:$room_version"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Pre-AndroidX</strong></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> room_version = <span class="string">"1.1.1"</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">"android.arch.persistence.room:runtime:$room_version"</span></span><br><span class="line">    annotationProcessor <span class="string">"android.arch.persistence.room:compiler:$room_version"</span> <span class="comment">// use kapt for Kotlin</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - RxJava support for Room</span></span><br><span class="line">    implementation <span class="string">"android.arch.persistence.room:rxjava2:$room_version"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Guava support for Room, including Optional and ListenableFuture</span></span><br><span class="line">    implementation <span class="string">"android.arch.persistence.room:guava:$room_version"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Test helpers</span></span><br><span class="line">    testImplementation <span class="string">"android.arch.persistence.room:testing:$room_version"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Paging"><a href="#Paging" class="headerlink" title="Paging"></a>Paging</h4><p><a href="https://developer.android.com/topic/libraries/architecture/paging.html" target="_blank" rel="noopener">Paging</a>ä¾èµ–</p>
<p><strong>AndroidX</strong></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> paging_version = <span class="string">"2.1.0-beta01"</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">"androidx.paging:paging-runtime:$paging_version"</span> <span class="comment">// use -ktx for Kotlin</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// alternatively - without Android dependencies for testing</span></span><br><span class="line">    testImplementation <span class="string">"androidx.paging:paging-common:$paging_version"</span> <span class="comment">// use -ktx for Kotlin</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - RxJava support</span></span><br><span class="line">    implementation <span class="string">"androidx.paging:paging-rxjava2:$paging_version"</span> <span class="comment">// use -ktx for Kotlin</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Pre-AndroidX</strong></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> paging_version = <span class="string">"1.0.0"</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">"android.arch.paging:runtime:$paging_version"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// alternatively - without Android dependencies for testing</span></span><br><span class="line">    testImplementation <span class="string">"android.arch.paging:common:$paging_version"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - RxJava support</span></span><br><span class="line">    implementation <span class="string">"android.arch.paging:rxjava2:$paging_version"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Navigation"><a href="#Navigation" class="headerlink" title="Navigation"></a>Navigation</h4><p><a href="https://developer.android.com/topic/libraries/architecture/navigation/navigation-implementing.html" target="_blank" rel="noopener">Navigation</a> ä¾èµ–</p>
<p>Navigation ç›¸å…³çš„ç±»å·²ç»å­˜åœ¨äº androidx.navigation åŒ…ä¸­ï¼Œä½†æ˜¯å½“å‰ä¾èµ–äº Support Library 27.1.1 å’Œ å…³è”çš„ Arch component ç‰ˆæœ¬ã€‚AndroidX dependencies ä¾èµ–çš„ Navigation ç‰ˆæœ¬å°†ä¼šåœ¨æœªæ¥å‘å¸ƒã€‚</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> nav_version = <span class="string">"1.0.0-alpha07"</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">"android.arch.navigation:navigation-fragment:$nav_version"</span> <span class="comment">// use -ktx for Kotlin</span></span><br><span class="line">    implementation <span class="string">"android.arch.navigation:navigation-ui:$nav_version"</span> <span class="comment">// use -ktx for Kotlin</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Test helpers</span></span><br><span class="line">    <span class="comment">// this library depends on the Kotlin standard library</span></span><br><span class="line">    androidTestImplementation <span class="string">"android.arch.navigation:navigation-testing:$nav_version"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Safe-args"><a href="#Safe-args" class="headerlink" title="Safe args"></a>Safe args</h4><p><a href="https://developer.android.com/topic/libraries/architecture/navigation/navigation-implementing.html#Safe-args" target="_blank" rel="noopener">Safe args</a> ä¾èµ–ï¼Œå¢åŠ ä¸‹é¢çš„ <strong>classPath</strong> åˆ°ä½ <strong>æœ€é¡¶å±‚</strong>çš„ <code>build.gradle</code> æ–‡ä»¶ä¸­</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        google()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath <span class="string">"android.arch.navigation:navigation-safe-args-gradle-plugin:1.0.0-alpha07"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¢åŠ  <strong>ä½ çš„ app æˆ–è€… module</strong> çš„ <code>build.gradle</code> æ–‡ä»¶</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">"androidx.navigation.safeargs"</span></span><br></pre></td></tr></table></figure>
<h4 id="WorkManager"><a href="#WorkManager" class="headerlink" title="WorkManager"></a>WorkManager</h4><p><a href="https://developer.android.com/topic/libraries/architecture/workmanager.html" target="_blank" rel="noopener">WorkManager</a> ä¾èµ–ã€‚</p>
<p>WorkManager ç›¸å…³çš„ç±»å·²ç»å­˜åœ¨äº androidx.navigation åŒ…ä¸­ï¼Œä½†æ˜¯å½“å‰ä¾èµ–äº Support Library 27.1.1 å’Œ å…³è”çš„ Arch component ç‰ˆæœ¬ã€‚AndroidX dependencies ä¾èµ–çš„ WorkManager ç‰ˆæœ¬å°†ä¼šåœ¨æœªæ¥å‘å¸ƒã€‚</p>
<p>WorkManager éœ€è¦ <code>compileSdk</code> ç‰ˆæœ¬ 28 æˆ–è€…æ›´é«˜ã€‚</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    <span class="keyword">def</span> work_version = <span class="string">"1.0.0-alpha11"</span></span><br><span class="line"></span><br><span class="line">    implementation <span class="string">"android.arch.work:work-runtime:$work_version"</span> <span class="comment">// use -ktx for Kotlin</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Firebase JobDispatcher support</span></span><br><span class="line">    implementation <span class="string">"android.arch.work:work-firebase:$work_version"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// optional - Test helpers</span></span><br><span class="line">    androidTestImplementation <span class="string">"android.arch.work:work-testing:$work_version"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> Android Architecture Component </category>
            
            <category> kotlin </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> kotlin </tag>
            
            <tag> architecture </tag>
            
            <tag> Android Architecture Component </tag>
            
            <tag> aac </tag>
            
            <tag> ViewModel </tag>
            
            <tag> LiveData </tag>
            
            <tag> DataBinding </tag>
            
            <tag> Lifecycles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Huginnå®ç°è‡ªåŠ¨é€šè¿‡slackæ¨é€è±†ç“£é«˜åˆ†ç”µå½±]]></title>
      <url>/2018/04/03/huginn_douban_high_score_movies_and_slack/</url>
      <content type="html"><![CDATA[<h1 id="Huginnå®ç°è‡ªåŠ¨é€šè¿‡slackæ¨é€è±†ç“£é«˜åˆ†ç”µå½±"><a href="#Huginnå®ç°è‡ªåŠ¨é€šè¿‡slackæ¨é€è±†ç“£é«˜åˆ†ç”µå½±" class="headerlink" title="Huginnå®ç°è‡ªåŠ¨é€šè¿‡slackæ¨é€è±†ç“£é«˜åˆ†ç”µå½±"></a>Huginnå®ç°è‡ªåŠ¨é€šè¿‡slackæ¨é€è±†ç“£é«˜åˆ†ç”µå½±</h1><blockquote>
<p>å¦‚æœå°šæœªå®‰è£… Huginnï¼Œå¯ä»¥å‚è€ƒ<a href="https://blog.wangjiegulu.com/2018/04/02/build_the_environment_for_huginn/">è¿™é‡Œ</a></p>
</blockquote>
<p>æƒ³è±¡ä¸‹ä»¥ä¸‹åœºæ™¯ï¼šæ¯å½“æœ‰æ­£åœ¨ä¸Šæ˜ çš„ç”µå½±åœ¨è±†ç“£ä¸Šçš„è¯„åˆ†è¶…è¿‡7.8åˆ†ï¼Œåˆ™ huginn è‡ªåŠ¨ç¼–è¾‘ä¸€æ¡ä¿¡æ¯å¹¶é€šè¿‡ <a href="https://slack.com" target="_blank" rel="noopener"><code>Slack</code></a> ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ç”¨ telegram ç­‰appï¼‰é€šçŸ¥åˆ°æˆ‘ç”µè„‘æˆ–è€…æ‰‹æœºä¸Šã€‚æ”¶åˆ°ä¿¡æ¯åï¼Œç‚¹å‡»ä¸å–œæ¬¢å¿½ç•¥ï¼Œæˆ–è€…ç‚¹å‡»è´­ç¥¨æŒ‰é’®ç›´æ¥è¿›å…¥åˆ°è´­ç¥¨é¡µé¢ã€‚ç”šè‡³ Huginn å¯ä»¥ç»“åˆ <code>Google Calendar</code> æŸ¥è¯¢ä½ è¿™å‡ å¤©çš„è¡Œç¨‹å®‰æ’ï¼Œæ¨é€é«˜åˆ†ç”µå½±ä¿¡æ¯çš„åŒæ—¶ç»™ä½ é€‰æ‹©ä¸€ä¸ªæ¯”è¾ƒåˆé€‚è§‚çœ‹ç”µå½±çš„æ—¶é—´ç‚¹ï¼Œè´­ä¹°å¥½ç”µå½±ç¥¨åï¼Œhuginn åˆè‡ªåŠ¨å¸®ä½ æŠŠæ—¥ç¨‹äº‹ä»¶å†™å…¥åˆ° <code>Google Calendar</code> ä¸­ï¼Œå¹¶è®¾ç½®æé†’ã€‚æ˜¯ä¸æ˜¯å¾ˆé…·ï¼Ÿï¼</p>
<p>Huginn å°±å¦‚ä½ çš„è´´å¿ƒç®¡å®¶ï¼ŒæŒ‰ç…§ä½ çš„æ„æ„¿è‡ªåŠ¨å¸®ä½ å®Œæˆå¾ˆå¤šäº‹æƒ…ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥å®ç° <code>æ¯å½“æœ‰æ­£åœ¨ä¸Šæ˜ çš„ç”µå½±åœ¨è±†ç“£ä¸Šçš„è¯„åˆ†è¶…è¿‡7.8åˆ†ï¼Œåˆ™ç»™æˆ‘æ¨é€ Slack ä¿¡æ¯</code> è¿™ä¸€éƒ¨åˆ†éœ€æ±‚ã€‚</p>
<p>æœ€åè¾¾åˆ°çš„æ•ˆæœå¦‚ä¸‹ï¼š</p>
<div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/38308823-d6afbb92-384a-11e8-8db6-4f6def8ff371.png" width="300px/"><br>    <br>æ‰‹æœºç«¯æ•ˆæœ<br></div><br><div style="text-align: center;"><br>    <img src="https://user-images.githubusercontent.com/5423194/38308728-9a9ba6f2-384a-11e8-9cf5-541e828207e2.png" width="600px/"><br>    <br>PCç«¯æ•ˆæœ<br></div>

<h2 id="åˆ›å»º-Agents"><a href="#åˆ›å»º-Agents" class="headerlink" title="åˆ›å»º Agents"></a>åˆ›å»º Agents</h2><p>é¦–å…ˆè¿›å…¥ Huginn é¦–é¡µï¼ˆé»˜è®¤<code>localhost:3000</code>ï¼‰ï¼Œå·¦ä¸Šè§’è¿›å…¥ <code>Scenarios</code>ï¼š</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38248922-84a7d57e-377c-11e8-8073-443bd59fd2f1.png" width="500px/"><br></div>

<p>æˆ‘çš„ç†è§£ï¼š<strong>Scenario</strong> ä»£è¡¨ä¸€ç§åœºæ™¯ï¼Œä¸€èˆ¬ä¼šåŒ…å«å¤šä¸ª <strong>agent</strong>ï¼Œä¸€ä¸ª agent è¡¨ç¤ºè¿›è¡Œä¸€æ¬¡äº‹ä»¶çš„å¤„ç†æˆ–è€…å˜æ¢ã€‚æ‹¿æˆ‘ä»¬ç°åœ¨çš„ä¾‹å­æ¥è¯´ï¼Œ<strong>è‡ªåŠ¨é€šè¿‡slackæ¨é€è±†ç“£é«˜åˆ†ç”µå½±</strong> è¿™ä¸€æ•´ä¸ªå°±æ˜¯ä¸€ä¸ª <code>Scenario</code>ï¼Œä½†æ˜¯è¿™ä¸ª <code>Scenario</code> ä¼šæœ‰å¾ˆå¤šçš„ <code>agent</code>s ç»„æˆï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>æœ‰ä¸€ä¸ª agent æ˜¯ç”¨æ¥ä»è±†ç“£ç½‘é¡µè·å–å½“å‰ä¸Šæ˜ ä¸­çš„æ‰€æœ‰ç”µå½±å’Œå®ƒä»¬çš„åˆ†æ•°ç­‰ä¿¡æ¯ï¼›</li>
<li>ä¸€ä¸ª agent æ˜¯ç”¨æ¥ä»ç¬¬ä¸€ä¸ª agent é‡Œé¢æ‹¿åˆ°çš„æ‰€æœ‰ç”µå½±è¿›è¡Œè¿‡æ»¤ï¼Œè¿‡æ»¤çš„æ ‡å‡†å°±æ˜¯ <code>score &gt; 7.8</code>ï¼Œ</li>
<li>è¿˜æœ‰ä¸€ä¸ª agent æ˜¯ç”¨æ¥æŠŠè¿‡æ»¤åçš„ç”µå½±é€šè¿‡ slack æ¨é€åˆ°æˆ‘ä»¬æ‰‹æœºä¸Šã€‚</li>
</ul>
<p>çœ‹ç€è·Ÿ <code>RxJava</code> çš„è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸æ˜¯å¾ˆåƒï¼Ÿç¬¬ä¸€ä¸ªä»è±†ç“£é¡µé¢æ‹‰å–æ•°æ®çš„è¿‡ç¨‹å°±åƒæ˜¯ <code>Observable</code>ï¼Œç„¶åå…¶å®ƒçš„ agent å°±åƒå¾ˆå¤šçš„ <code>operator</code> ç”¨æ¥æŠŠæ•°æ®è¿›è¡Œè½¬æ¢å’Œå˜åŒ–ï¼Œæœ€ç»ˆé€šçŸ¥åˆ° <code>subscriber</code>ï¼Œè¿™é‡Œçš„ <code>subscriber</code> å°±æ˜¯æˆ‘ä»¬è‡ªå·±ã€‚æˆ‘ä»¬é€šè¿‡ huginn è®¢é˜…äº† <code>è±†ç“£é«˜åˆ†ç”µå½±</code>ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p>
<p>ç‚¹å‡»å·¦ä¸‹è§’çš„ <code>New Scenario</code> åˆ›å»ºä¸€ä¸ªåä¸º <code>douban_high_score_movie</code> çš„ Scenarioã€‚</p>
<h3 id="åˆ›å»ºè·å–æ•°æ®-agent"><a href="#åˆ›å»ºè·å–æ•°æ®-agent" class="headerlink" title="åˆ›å»ºè·å–æ•°æ® agent"></a>åˆ›å»ºè·å–æ•°æ® agent</h3><blockquote>
<p>ç¬¬ä¸€ä¸ª agent ç”¨æ¥ä»è±†ç“£å®˜ç½‘è·å–æ‰€æœ‰æ­£åœ¨ä¸Šæ˜ çš„ç”µå½±</p>
</blockquote>
<p>åœ¨ <code>douban_high_score_movie</code> çš„ Scenario ä¸­ç‚¹å‡» <code>+ New Agent</code> æ¥åˆ›å»ºç¬¬ä¸€ä¸ª Agentã€‚</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38249853-b1eac0d4-377f-11e8-8242-022b28113653.png" width="500px/"><br></div>

<p>å¦‚ä¸Šå›¾ï¼Œä½ éœ€è¦å»å†³å®šä½ è¦åˆ›å»ºçš„ agent çš„ç±»å‹ï¼ˆ<a href="https://github.com/huginn/huginn/wiki/Agent-Types-&amp;-Descriptions" target="_blank" rel="noopener">è¿™é‡Œ</a>æ˜¯ç›®å‰ Huginn æ”¯æŒçš„æ‰€æœ‰çš„ç±»å‹ï¼‰ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡è¾“å…¥ â€œwebâ€ æ¥è¿›è¡Œè¿‡æ»¤é€‰æ‹© <code>Website Agent</code>ã€‚</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38283656-c5dc2f5a-37e9-11e8-8f3c-bd7d8d8d7c5e.png" width="700px/"><br></div>

<p>ä¸Šå›¾ï¼Œå·¦è¾¹æ˜¯æˆ‘ä»¬éœ€è¦å»é…ç½®çš„åœ°æ–¹ï¼›å³è¾¹æ˜¯æ¯ä¸ªè®¾ç½®å¯¹åº”çš„è¯´æ˜ã€‚</p>
<ul>
<li><strong>Nameï¼š</strong>ç»™è¿™ä¸ª agent å–ä¸ªåå­—ï¼Œæˆ‘ä»¬è¿™é‡Œå–åä¸º <code>step1_get_douban_playing_movies</code>ï¼Œè¡¨ç¤ºè¿™ä¸ª agent æ˜¯ <code>douban_high_score_movie</code> è¿™ä¸ª Scenario çš„ç¬¬ä¸€æ­¥ï¼Œæ˜¯ç”¨æ¥ä»è±†ç“£è·å–å½“å‰æ­£åœ¨ä¸Šæ˜ çš„æ‰€æœ‰ç”µå½±ã€‚</li>
<li><strong>Scheduleï¼š</strong>è¡¨ç¤ºè°ƒåº¦å‘¨æœŸï¼Œè¡¨ç¤ºåœ¨ä»€ä¹ˆæ—¶å€™è‡ªåŠ¨æ‰§è¡Œè¿™ä¸ª agentï¼Œæ¯”å¦‚ <code>Every 1d</code> è¡¨ç¤ºæ¯ä¸€å¤©æ‰§è¡Œä¸€æ¬¡ã€<code>Every 2h</code> è¡¨ç¤ºæ¯2å°æ—¶æ‰§è¡Œä¸€æ¬¡ã€<code>8pm</code> è¡¨ç¤ºæ¯å¤©ä¸‹åˆ8ç‚¹æ‰§è¡Œç­‰ç­‰ï¼›è¿™é‡Œæˆ‘ä»¬é€‰æ‹© <code>3pm</code>ï¼Œæ¯å¤©ä¸‹åˆ3ç‚¹æ‰§è¡Œä¸€æ¬¡ã€‚</li>
<li><strong>Keep eventsï¼š</strong>è¡¨ç¤ºäº‹ä»¶ä¿ç•™çš„æ—¶é—´ï¼›æ¯”å¦‚æˆ‘ä»¬ä»è±†ç“£ä¸Šè·å–åˆ°æ‰€æœ‰ä¸Šæ˜ çš„ç”µå½±ï¼Œæ¯ä¸€éƒ¨ç”µå½±ä¿¡æ¯éƒ½æ˜¯ä¸€ä¸ª eventï¼ŒHuginnä¼šæŠŠè¿™äº› event ä¿ç•™åœ¨æœ¬åœ°ï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªå‚æ•°æ¥è®¾ç½®è¿™äº› events åœ¨æœ¬åœ°ä¿ç•™å¤šå°‘æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼ŒHuginnä¼šæŠŠæ•°æ®æ¸…é™¤ã€‚æˆ‘ä»¬è¿™é‡Œè®¾ç½®1å°æ—¶ï¼ˆä¸ºä»€ä¹ˆåªè®¾ç½®ä¸º1å°æ—¶ï¼Œ<a href="#keep_useless">ä¸‹é¢æˆ‘ä»¬ä¼šå†è®¨è®º</a>ï¼‰ã€‚</li>
<li><strong>Sourcesï¼š</strong>è¡¨ç¤ºè¿™ä¸ª agent å¤„ç†çš„æ•°æ®æ¥æºæ˜¯å“ªä¸ª agentã€‚æˆ‘ä»¬ç°åœ¨åˆ›å»ºçš„ agent æ˜¯ç¬¬ä¸€ä¸ª agentï¼Œæ˜¯ä»è±†ç“£ç½‘ç«™ä¸Šè·å–æ­£åœ¨ä¸Šæ˜ çš„æ‰€æœ‰ç”µå½±ï¼Œæ‰€ä»¥ä¸éœ€è¦ä»å…¶ä»– agent ä¼ é€’æ•°æ®ï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢è¯´çš„ eventsï¼‰è¿‡æ¥ï¼Œæ‰€ä»¥è¿™ä¸ªç•™ç©ºã€‚</li>
<li><strong>Receiversï¼š</strong>è¡¨ç¤ºè¿™ä¸ª agent å¤„ç†å®Œæ•°æ®ä¹‹åæŠŠè¿™äº›æ•°æ®ä¼ å…¥åˆ°å“ªä¸ª agentã€‚è¿˜æ˜¯ç”¨ <code>RxJava</code> åšç±»æ¯”ï¼Œå› ä¸ºæ¯ä¸ª agnet éƒ½æœ‰å¯èƒ½åªæ˜¯æ•´ä¸ªè§‚å¯Ÿè€…æ¨¡å¼ä¸­çš„ä¸€ä¸ªæ“ä½œç¬¦ï¼Œç”¨æ¥è½¬åŒ–æ•°æ®ï¼Œæ•°æ®è½¬åŒ–å®Œä¹‹åï¼Œå¯èƒ½è¿˜éœ€è¦å…¶ä»– agent æŠŠè¿™äº›æ•°æ®åšè¿›ä¸€æ­¥çš„è½¬åŒ–ã€‚</li>
<li><strong>Scenariosï¼š</strong>è¡¨ç¤ºè¿™ä¸ª agent æ˜¯æ•°æ®å“ªä¸ª Scenario çš„ã€‚</li>
<li><strong>Optionsï¼š</strong>è¿™ä¸ªéå¸¸å…³é”®ï¼Œå°±æ˜¯é€šè¿‡è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼ˆJSONï¼‰æ¥è¿›è¡Œç½‘ç»œè¯·æ±‚å’Œè±†ç“£ç”µå½±æ•°æ®è§£æç›¸å…³çš„æ“ä½œçš„ï¼Œè¿™ä¸ªæˆ‘ä»¬é‡ç‚¹è®²ä¸‹ã€‚</li>
</ul>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong>ä»¥ä¸Šæ²¡æåˆ°çš„é…ç½®å¯ä»¥ç•™ç©º</p>
</blockquote>
<h4 id="Options-é…ç½®"><a href="#Options-é…ç½®" class="headerlink" title="Options é…ç½®"></a>Options é…ç½®</h4><p>Options é…ç½®å…¶å®å°±æ˜¯ä¸€ä¸ª JSON æ–‡ä»¶ã€‚Website Agent çš„ Options ä¸»è¦çš„å…ƒç´ æœ‰å¦‚ä¸‹ï¼š</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38284371-684365f8-37ed-11e8-8125-b94a2a35e12b.png" width="500px/"><br></div>

<ul>
<li><strong>urlï¼š</strong>ç½‘ç«™åœ°å€ï¼Œè¡¨ç¤ºæˆ‘éœ€è¦ä»å“ªä¸ªç½‘ç«™è·å–æ•°æ®ï¼Œç°åœ¨æˆ‘ä»¬æ˜¯ä»è±†ç“£ï¼Œæ‰€ä»¥éœ€è¦è¾“å…¥è±†ç“£æ­£åœ¨ä¸Šæ˜ çš„ç½‘å€ï¼Œè¿™é‡Œæˆ‘ä»¬è¾“å…¥ <code>https://movie.douban.com/cinema/nowplaying/hangzhou/</code>ï¼Œå½“ç„¶æœ€åä¸€ä¸ªåœ°ç‚¹å¯ä»¥æ ¹æ®ä½ çš„å¸¸é©»åœ°ç‚¹åšç›¸åº”çš„ä¿®æ”¹ã€‚</li>
<li><strong>typeï¼š</strong>æ•°æ®è§£æçš„ç±»å‹ï¼Œæ”¯æŒçš„ç±»å‹æœ‰ <code>xml</code>ã€<code>html</code>ã€<code>json</code>ã€<code>text</code> å››ç§ï¼Œå½“å‰è±†ç“£ç½‘å€è¿”å›çš„å½“ç„¶æ˜¯ html äº†ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¡«å†™ <code>html</code>ã€‚å¦‚æœå…¶ä»–åœºæ™¯ï¼Œæ¯”å¦‚ è°ƒç”¨ç¬¬ä¸‰æ–¹å¼€æ”¾çš„ apiï¼Œè¿”å›çš„ç±»å‹å¯èƒ½å°±æ˜¯ <code>json</code> æˆ–è€… <code>xml</code>äº†ã€‚</li>
<li><strong>modeï¼š</strong>è¡¨ç¤ºè·å–æ•°æ®çš„æ¨¡å¼ï¼Œæˆ‘ä»¬è¿™é‡Œé€‰æ‹© <code>on_change</code>ã€‚<ul>
<li>on_changeï¼šåœ¨æ•°æ®æœ‰æ›´æ”¹æ—¶æ‰ä¼šè·å–ä½œä¸º eventsã€‚</li>
<li>mergeï¼šæŠŠæ–°æ•°æ®å’Œè¾“å…¥çš„æ•°æ®è¿›è¡Œåˆå¹¶ã€‚</li>
<li>allï¼šè·å–æ‰€æœ‰æ•°æ®ã€‚</li>
</ul>
</li>
<li><strong>extractï¼š</strong>ç”¨æ¥é…ç½®ï¼ˆJSONï¼‰ä»è¿™ä¸ªç½‘ç«™è§£æå‡ºçœŸæ­£æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ã€‚å¦‚æœ <code>type</code> æ˜¯ <code>html</code>ï¼Œåˆ™æ¯ä¸ªæ•°æ®é€šè¿‡ <code>css</code> é€‰æ‹©å™¨æˆ–è€… <code>xpath</code> æ¥è§£æå‡ºçœŸæ­£çš„æ•°æ®ã€‚</li>
</ul>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong> <code>on_change</code> è¿™ä¸ªè®¾ç½®åœ¨æˆ‘ä»¬ç°åœ¨çš„åœºæ™¯ä¸‹å…¶å®ç”¨å¤„ä¸å¤§ï¼Œè¿™ä¸ª<a href="#keep_useless">ä¸‹é¢æˆ‘ä»¬ä¼šå†è®¨è®º</a>ã€‚</p>
</blockquote>
<p>æœ€åçš„ options å¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"expected_update_period_in_days"</span>: <span class="string">"2"</span>,</span><br><span class="line">  <span class="attr">"url"</span>: <span class="string">"https://movie.douban.com/cinema/nowplaying/hangzhou/"</span>,</span><br><span class="line">  <span class="attr">"type"</span>: <span class="string">"html"</span>,</span><br><span class="line">  <span class="attr">"mode"</span>: <span class="string">"on_change"</span>,</span><br><span class="line">  <span class="attr">"extract"</span>: &#123;</span><br><span class="line">    <span class="attr">"title"</span>: &#123;</span><br><span class="line">      <span class="attr">"css"</span>: <span class="string">"li[@data-category='nowplaying']"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"@data-title"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"score"</span>: &#123;</span><br><span class="line">      <span class="attr">"css"</span>: <span class="string">"li[@data-category='nowplaying']"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"@data-score"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"star"</span>: &#123;</span><br><span class="line">      <span class="attr">"css"</span>: <span class="string">"li[@data-category='nowplaying']"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"@data-star"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"release"</span>: &#123;</span><br><span class="line">      <span class="attr">"css"</span>: <span class="string">"li[@data-category='nowplaying']"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"@data-release"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"region"</span>: &#123;</span><br><span class="line">      <span class="attr">"css"</span>: <span class="string">"li[@data-category='nowplaying']"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"@data-region"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"actors"</span>: &#123;</span><br><span class="line">      <span class="attr">"css"</span>: <span class="string">"li[@data-category='nowplaying']"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"@data-actors"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"director"</span>: &#123;</span><br><span class="line">      <span class="attr">"css"</span>: <span class="string">"li[@data-category='nowplaying']"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"@data-director"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"detail_url"</span>: &#123;</span><br><span class="line">      <span class="attr">"css"</span>: <span class="string">"li[@data-category='nowplaying']/ul/li/a[@data-psource='poster']"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"@href"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"image_url"</span>: &#123;</span><br><span class="line">      <span class="attr">"css"</span>: <span class="string">"li[@data-category='nowplaying']/ul/li/a[@data-psource='poster']/img"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"@src"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬ä»è±†ç“£çš„æ¯éƒ¨ç”µå½±ä¸­è·å–äº†ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li>titleï¼šç”µå½±åå­—</li>
<li>scoreï¼šç”µå½±åˆ†æ•°ï¼Œæ»¡åˆ†10åˆ†</li>
<li>starï¼šç”µå½±åˆ†æ•°ï¼Œæ»¡åˆ†50åˆ†</li>
<li>releaseï¼šä¸Šæ˜ æ—¥æœŸ</li>
<li>regionï¼šåœ°åŒº</li>
<li>actorsï¼šæ¼”å‘˜</li>
<li>directorï¼šå¯¼æ¼”</li>
<li>detail_urlï¼šè¯¦ç»† url</li>
<li>image_urlï¼šç”µå½±å°é¢</li>
</ul>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong>è·å–å…·ä½“ xpath æ¯”è¾ƒç®€å•çš„æ–¹æ³•ï¼šé€šè¿‡ chrome å³é”®çš„ <code>inspect</code> æ¥å¤åˆ¶æ‹¿åˆ°ã€‚</p>
</blockquote>
<p>ä»¥ä¸Šé…ç½®å®Œæ¯•åï¼Œç‚¹å‡»ä¸‹é¢çš„ <code>Dry Run</code>ï¼Œåº”è¯¥å°±ä¼šå‡ºç°ä»¥ä¸‹é¡µé¢</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38285255-f7211d02-37f1-11e8-84ee-c6b74401094e.png" width="650px/"><br></div>

<p>æœ€åè¿›è¡Œä¿å­˜ã€‚ç¬¬ä¸€ä¸ª agent å°±åˆ›å»ºå®Œæ¯•äº†ã€‚</p>
<p>åŒæ—¶ï¼Œè¿™ä¸ª agent åœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¼šç”Ÿæˆä»¥ä¸‹ eventsï¼š</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38285762-5520c52c-37f4-11e8-9db5-ffa0f1116924.png" width="700px/"><br></div>


<h3 id="åˆ›å»ºè¿‡æ»¤-agnet"><a href="#åˆ›å»ºè¿‡æ»¤-agnet" class="headerlink" title="åˆ›å»ºè¿‡æ»¤ agnet"></a>åˆ›å»ºè¿‡æ»¤ agnet</h3><p><code>step1_get_douban_playing_movies</code> æŠŠæ‰€æœ‰æ­£åœ¨ä¸Šæ˜ çš„ç”µå½±æ•°æ®ä»è±†ç“£ä¸Šæ‹‰å–ä¸‹æ¥å¹¶è§£æå¥½ï¼Œç”Ÿæˆä¸€ä¸ªä¸ª eventsã€‚ç„¶åæˆ‘ä»¬ç¬¬äºŒä¸ª agent å°±éœ€è¦ä»è¿™äº› events é‡Œé¢è¿›è¡Œè¿‡æ»¤ç­›é€‰å‡ºæ‰€æœ‰åˆ†æ•°å¤§äº <code>7.8</code>ï¼ˆå…·ä½“çš„æ ‡å‡†å¯ä»¥è‡ªå·±å®šï¼‰ çš„ç”µå½±ã€‚ç›¸å½“äº RxJava çš„ filter æ“ä½œç¬¦å§ã€‚</p>
<p>åŒæ ·åˆ›å»º agentï¼Œé€‰æ‹©ä¸º <code>TriggerAgent</code>ï¼Œåå­—ä¸º <code>step2_pick_high_score_movies</code>ã€‚è¿™æ˜¯æŠŠ <strong>Sources</strong> å¡«å†™ä¸ºç¬¬ä¸€ä¸ª agent çš„åå­—ï¼Œå³ <code>step1_get_douban_playing_movies</code>ï¼Œè¡¨ç¤ºæˆ‘è¦åˆ›å»ºçš„ agent å¤„ç†çš„æ•°æ®ï¼ˆeventsï¼‰æ˜¯ä» <code>step1_get_douban_playing_movies</code> æ¥çš„ã€‚</p>
<p>ç„¶åé‡ç‚¹è¿˜æ˜¯åœ¨ Options ä¸­</p>
<ul>
<li><strong>keep_eventï¼š</strong>è¡¨ç¤ºæ˜¯å¦æŠŠæˆ‘ä» <code>step1_get_douban_playing_movies</code> è¿™ä¸ª agent æ”¶åˆ°çš„ events åŸå°ä¸åŠ¨åœ°å†ä¼ ç»™ä¸‹ä¸€ä¸ª agentï¼ˆä¸‹ä¸€ä¸ª agent æˆ‘ä»¬è¿˜æ²¡åˆ›å»ºï¼‰ï¼Œæˆ‘ä»¬è®¾ç½®ä¸º trueã€‚å› ä¸ºä¸‹ä¸€ä¸ª agent æˆ‘ä»¬æ˜¯ç”¨æ¥æŠŠæ•°æ®é€šè¿‡ slack å‘é€åˆ°ç»™æˆ‘ä»¬è‡ªå·±çš„ï¼Œé‚£è‚¯å®šéœ€è¦ç¬¬ä¸€ä¸ª agent ä¸­è·å–åˆ°çš„ä¾‹å¦‚ç”µå½±åå­—ã€åˆ†æ•°ç­‰ä¿¡æ¯ã€‚</li>
<li><strong>rulesï¼š</strong>è¡¨ç¤ºæˆ‘ä»¬è¿‡æ»¤çš„è§„åˆ™ï¼Œå¯ä»¥å¤šä¸ªï¼Œå…·ä½“ä¸‹é¢è¯´ã€‚</li>
<li><strong>must_matchï¼š</strong>è¡¨ç¤º rules ä¸­æˆ‘å¿…é¡»è¦æ»¡è¶³å‡ ä¸ªè§„åˆ™ï¼Œå¦‚æœæ˜¯1ï¼Œåˆ™æ„å‘³ç€ rules ä¸­æ‰€æœ‰çš„è§„åˆ™æ˜¯æˆ–å…³ç³»ï¼ˆåªè¦æ»¡è¶³ rules ä¸­çš„1ä¸ªè§„åˆ™å³å¯ï¼‰ï¼›é»˜è®¤ä¸å¡«å†™çš„è¯æ˜¯<strong>å¿…é¡»è¦æ»¡è¶³ rules ä¸­æ‰€æœ‰çš„è§„åˆ™ã€‚</strong>ï¼Œå› ä¸ºæˆ‘ä»¬è¿™é‡Œåªéœ€è¦æ»¡è¶³ä¸€ä¸ªåˆ†æ•°å¤§äº7.8å°±å¯ä»¥ï¼Œæ‰€ä»¥å¯ä»¥ä¸å¡«å†™ã€‚</li>
</ul>
<p>æœ€å Options çš„é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"expected_receive_period_in_days"</span>: <span class="string">"2"</span>,</span><br><span class="line">  <span class="attr">"keep_event"</span>: <span class="string">"true"</span>,</span><br><span class="line">  <span class="attr">"rules"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"field&gt;=value"</span>,</span><br><span class="line">      <span class="attr">"value"</span>: <span class="string">"7.8"</span>,</span><br><span class="line">      <span class="attr">"path"</span>: <span class="string">"$.score"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"message"</span>: <span class="string">"Looks like your pattern matched in '&#123;&#123;value&#125;&#125;'!"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šï¼Œåœ¨ <strong>rules</strong> ä¸­æ·»åŠ ä¸€ä¸ªè§„åˆ™ï¼Œ<strong>type</strong> è¡¨ç¤ºåŒ¹é…è§„åˆ™ï¼Œ<code>field&gt;=value</code>ï¼š</p>
<ul>
<li><strong>field</strong>: é€šè¿‡ä¸‹é¢ path ä» events åŒ¹é…å‡ºæ¥çš„æ•°æ®ï¼Œè¿™é‡Œæ˜¯ <code>$.score</code>ï¼Œæ‰€ä»¥è¡¨ç¤ºçš„æ˜¯ç”µå½±çš„åˆ†æ•°ï¼›</li>
<li><strong>value</strong>ï¼šè¡¨ç¤ºä¸‹é¢ json çš„ <code>value</code> å­—æ®µçš„å€¼ï¼Œè¿™é‡Œä¸º <code>7.8</code>ã€‚</li>
</ul>
<p>é€šè¿‡ç®€å•çš„è¡¨è¾¾å¼ <code>field&gt;=value</code> æ¥è®¾å®šåŒ¹é…è§„åˆ™ï¼šç”µå½±åˆ†æ•° &gt;= 7.8åˆ†ã€‚</p>
<p>è‡³æ­¤ï¼Œç¬¬äºŒä¸ª agent åˆ›å»ºå®Œæ¯•ã€‚</p>
<p>ä½ åŒæ ·å¯ä»¥é€šè¿‡ä¸‹é¢çš„ <code>Dry Run</code> æ¥è¿›è¡Œæµ‹è¯•ï¼Œæµ‹è¯•æ—¶å› ä¸ºæœ‰ <code>Sources</code>ï¼Œéœ€è¦ä½ æ„é€ ä¸€äº›å‡æ•°æ®ä½œä¸ºè¾“å…¥æ¥è¿è¡Œã€‚</p>
<h3 id="åˆ›å»ºå»é‡-agnet"><a href="#åˆ›å»ºå»é‡-agnet" class="headerlink" title="åˆ›å»ºå»é‡ agnet"></a>åˆ›å»ºå»é‡ agnet</h3><p><code>step2_pick_high_score_movies</code>ç”¨æ¥æŠŠ <code>step1_get_douban_playing_movies</code> ä¸­ä»è±†ç“£å®˜ç½‘è·å–çš„ç”µå½±ä¿¡æ¯è¿›è¡Œé«˜åˆ†çš„è¿‡æ»¤ï¼ˆåˆ†æ•°&gt;=7.8ï¼‰ã€‚</p>
<p>æˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªå»é‡çš„ agentï¼Œæ¥é¿å…é‡å¤ç»™æˆ‘ä»¬è‡ªå·±æ¨é€é«˜åˆ†ç”µå½±ï¼ˆå› ä¸ºæˆ‘ä»¬ç°åœ¨è·å–çš„é¢‘ç‡æ˜¯æ¯å¤©è¿›è¡Œè·å–æ£€æµ‹ï¼Œä½†æ˜¯ç”µå½±æ€»ä¸å¯èƒ½æ˜¯æ¯éƒ¨ç”µå½±åªä¸Šæ˜ ä¸€å¤©å§ï¼Œç¬¬äºŒå¤©è·å–çš„æ—¶å€™è‚¯å®šæœ‰ç¬¬ä¸€å¤©è·å–çš„æ•°æ®ï¼‰ã€‚</p>
<p>è¿™é‡Œå¤§å®¶å¯èƒ½ä¼šæœ‰ä¸ªé—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨é…ç½®ç¬¬ä¸€ä¸ª agent çš„æ—¶å€™ï¼Œå·²ç»æŠŠ <code>mode</code> å·²ç»è®¾ç½®ä¸º <code>on_change</code> äº†ï¼Œä¸ºä»€ä¹ˆè¿˜æ˜¯ä¼šæœ‰é‡å¤æ•°æ®å‘¢ï¼Ÿå› ä¸ºè¿™é‡Œçš„ç”µå½±ä¿¡æ¯ä¸­ï¼Œæœ‰è¯¸å¦‚ <code>åˆ†æ•°</code> è¿™ç±»çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®æ˜¯éšæ—¶å¯èƒ½ä¼šæœ‰å˜åŒ–çš„ï¼Œè™½ç„¶æ˜¯åŒä¸€ä¸ªç”µå½±ï¼Œä½†æ˜¯åˆ†æ•°ä» <code>8.1</code> ä¸Šå‡åˆ° <code>8.2</code>ï¼Œé‚£ Huginn ä¹Ÿä¼šè®¤ä¸ºæ»¡è¶³äº† <code>on_change</code> æ¡ä»¶ï¼Œæ‰€ä»¥ä¼šé€ æˆé‡å¤æ¨é€ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å•ç‹¬åšå»é‡å¤„ç†ã€‚</p>
<p><span id="keep_useless"></span></p>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong> ä¹‹å‰æåˆ°è¿‡ <code>on_change</code> ç­‰è®¾ç½®åœ¨ç¬¬ä¸€ä¸ª agent å…¶å®ç”¨å¤„ä¸å¤§ï¼ŒåŒæ ·ä¹Ÿæ˜¯ç”±äºä¸Šé¢è¯´çš„åŸå› ï¼Œæˆ‘ä»¬ä¹Ÿä¸çŸ¥é“åŒæ ·çš„ç”µå½±ä»€ä¹ˆæ—¶å€™åˆ†æ•°ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå°±ç®—ç”¨äº† <code>on_change</code>ï¼Œä¹Ÿå¯èƒ½ä¼šæŠŠä¹‹å‰è·å–è¿‡çš„æ•°æ®æ‹¿åˆ°ã€‚æ‰€ä»¥ç¬¬ä¸€ä¸ª agent çš„ keep_event è®¾ç½®çš„æ—¶é—´æ¯”è¾ƒçŸ­ï¼Œå› ä¸ºè¿™äº› events æä¾›ç»™ <code>on_change</code> åŒ¹é…æ„ä¹‰ä¸å¤§ï¼Œæ‰€ä»¥è¿˜æ˜¯èŠ‚çœç©ºé—´ï¼Œè®¾ç½®çŸ­ä¸€ç‚¹ã€‚</p>
</blockquote>
<p>åˆ›å»º agentï¼Œtype é€‰æ‹© <code>DeDuplicationAgent</code>ï¼Œåå­—å–ä¸º <code>step2_1_deduplication_high_score_movies</code>ï¼Œ<strong>Sources</strong> å¡«å†™ä¸ºä¸Šä¸€ä¸ª agent çš„åå­—ï¼Œå³ <code>step2_pick_high_score_movies</code>ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong>è¿™é‡Œ <strong>keep_event</strong> è®¾ç½®äº†90å¤©ï¼Œå› ä¸ºä¸€æ—¦ç»è¿‡æˆ‘ä»¬è¿™ä¸ª agent å»é‡åï¼Œevents å‡è®¾ä¿ç•™1å°æ—¶ï¼Œé‚£ä¸‹ä¸€å¤©æˆ‘å†å»è·å–æ‰€æœ‰ä¸Šæ˜ çš„ç”µå½±å¹¶é«˜åˆ†è¿‡æ»¤åï¼Œå› ä¸ºæ˜¨å¤©çš„æ•°æ®ï¼ˆeventsï¼‰å·²ç»è¢«æ¸…ç©ºäº†ï¼Œæ‰€ä»¥å°±æ²¡åŠæ³•åšæ¯”è¾ƒå»é‡äº†ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´é‡å¤æ•°æ®ã€‚æ‰€ä»¥è¿™é‡Œä¿å­˜æ—¶é—´åº”è¯¥è¦&gt;=ç”µå½±ä¸Šæ˜ çš„æ—¶é•¿ï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®ä¸º90å¤©ï¼Œå³3ä¸ªæœˆå·¦å³ã€‚</p>
</blockquote>
<p>DeDuplicationAgent çš„ Options å¡«å†™å°±æ¯”è¾ƒç®€å•äº†</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38286554-8fa7b166-37f8-11e8-9d8b-601bf37c895e.png" width="500px/"><br></div>

<ul>
<li><strong>Propertyï¼š</strong>å¡«å†™ä½ è¦å»é‡ä¾æ®çš„å­—æ®µï¼Œæˆ‘ä»¬è¿™é‡Œæ ¹æ®ç”µå½±åå­—æ¥å»é‡ï¼Œä¹Ÿå°±æ˜¯ <code>title</code>ã€‚</li>
<li><strong>Lookbackï¼š</strong>è¡¨ç¤ºå»é‡çš„æ—¶å€™è·Ÿä¹‹å‰çš„å¤šå°‘æ¡å†å² events åšæ¯”è¾ƒï¼ŒåŒä¸€æ—¶æœŸä¸€èµ·ä¸Šæ˜ çš„ç”µå½±åº”è¯¥ä¸ä¼šè¶…è¿‡100éƒ¨ï¼Œæ‰€ä»¥è®¾ç½®ä¸º100äº†ã€‚</li>
</ul>
<h3 id="åˆ›å»º-slack-é€šçŸ¥çš„-agent"><a href="#åˆ›å»º-slack-é€šçŸ¥çš„-agent" class="headerlink" title="åˆ›å»º slack é€šçŸ¥çš„ agent"></a>åˆ›å»º slack é€šçŸ¥çš„ agent</h3><blockquote>
<p>å¦‚æœéœ€è¦é€šè¿‡ telegram è¿›è¡Œé€šçŸ¥ï¼Œè¯·çœ‹è¿™é‡Œ<a href="https://blog.wangjiegulu.com/2018/11/16/douban_high_movie_huginn_telegram/">ã€ŠHuginnå®ç°è‡ªåŠ¨é€šè¿‡Telegramæ¨é€è±†ç“£é«˜åˆ†ç”µå½±ã€‹</a></p>
</blockquote>
<p>Huginn è‡ªå¸¦æœ‰ä¸€ä¸ª <code>SlackAgent</code>ï¼Œç”¨æ¥å‘é€ slack æ¶ˆæ¯ã€‚</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38287159-d1b96f10-37fb-11e8-835f-0b9e620ab075.png" width="700px/"><br></div>

<p>å®ƒä½¿ç”¨äº† <a href="https://api.slack.com/incoming-webhooks" target="_blank" rel="noopener">incoming-webhooks</a> æ¥å®ç°æ¶ˆæ¯çš„å‘é€ã€‚</p>
<p>ä½†æ˜¯ä¸ºäº†æœ‰æ›´å¤šçš„å¯ç©æ€§ï¼Œæˆ‘ä»¬è¿™é‡Œé€‰æ‹©ï¼Œè‡ªå·±åˆ›å»ºä¸€ä¸ª <code>slack app</code>ï¼Œç„¶åé€šè¿‡å®ƒçš„ open api å®ç°ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª <code>PostAgent</code>ã€‚ä½†æ˜¯åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬å…ˆæ¥é…ç½®å¥½ Slack ç¯å¢ƒã€‚</p>
<h4 id="é…ç½®-Slack-ç¯å¢ƒ"><a href="#é…ç½®-Slack-ç¯å¢ƒ" class="headerlink" title="é…ç½® Slack ç¯å¢ƒ"></a>é…ç½® Slack ç¯å¢ƒ</h4><p>å®‰è£… Slackï¼š<a href="https://slack.com" target="_blank" rel="noopener">https://slack.com</a></p>
<ul>
<li>Google Play for Androidï¼š<a href="https://play.google.com/store/apps/details?id=com.Slack" target="_blank" rel="noopener">https://play.google.com/store/apps/details?id=com.Slack</a></li>
</ul>
<p>åˆ›å»ºè‡ªå·±çš„ workspaceï¼ˆå•ç‹¬åˆ›å»ºä¸€ä¸ªè‡ªå·±ç§æœ‰çš„ï¼Œæ³¨æ„ä¸è¦ä½¿ç”¨å…¬å¸ã€å›¢é˜Ÿçš„ workspaceï¼‰ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ <code>https://wangjie.slack.com</code>ã€‚</p>
<p>åœ¨è‡ªå·±ç§æœ‰çš„ workspace ä¸­åˆ›å»ºä¸€ä¸ªç§æœ‰çš„ channelï¼š<code>#huginn-movie</code></p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38288443-62b02016-3803-11e8-8733-ded2ac3b535b.png" width="300px/"><br></div>

<p>è¿™ä¸ª channel å°±æ˜¯ç”¨æ¥æ¥æ”¶é«˜åˆ†ç”µå½±çš„æ•°æ®äº†ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>#general</code>ã€‚</p>
<p>ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„ appï¼Œç”¨æ¥å‘é€ç”µå½±ä¿¡æ¯ã€‚è¿›å…¥ <a href="https://api.slack.com/" target="_blank" rel="noopener">https://api.slack.com/</a></p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38288591-4f2cf702-3804-11e8-9b96-fe8561c21e9c.png" width="300px/"><br></div>

<p>ç‚¹å‡» <code>Start Building</code>ï¼Œ</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38288667-a0cc323a-3804-11e8-9a7d-6da84babc266.png" width="500px/"><br></div>

<ul>
<li><strong>App Nameï¼š</strong>å¯ä»¥éšæ„å¡«å†™</li>
<li><strong>Development Slack Workspaceï¼š</strong>é€‰æ‹©ä½ åˆšåˆšåˆ›å»ºçš„ç§æœ‰çš„ workspace</li>
</ul>
<p>åœ¨ <code>Add features and functionality</code> ä¸­ç‚¹å‡» <code>Permissions</code> è¿›å…¥æƒé™é…ç½®ã€‚</p>
<p>åœ¨ <code>Scope</code> ä¸­æ·»åŠ å¦‚ä¸‹æƒé™ï¼š</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38288837-a0438740-3805-11e8-821e-5e91a1bf401e.png" width="550px/"><br></div>

<p>æ·»åŠ å®Œä»¥ä¸Šæ‰€æœ‰æƒé™åï¼Œç‚¹å‡»ä¿å­˜ï¼Œç„¶åé‡æ–°æ‰“å¼€ <code>Permissions</code>ï¼Œç‚¹å‡»ä¸‹é¢æŒ‰é’®å®‰è£…æˆ‘ä»¬çš„è¿™ä¸ª app åˆ° slackã€‚</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38288942-31655e06-3806-11e8-92af-63c67f778570.png" width="550px/"><br></div>

<p><span id="slack_token"><br>å®‰è£…å®Œæ¯•ä¹‹åï¼Œå†æ¬¡è¿›å…¥ <code>Permissions</code>ï¼Œæ‹·è´ <code>OAuth Access Token</code>ï¼š</span></p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38289144-4ad7c56c-3807-11e8-9599-4e64dd704258.png" width="550px/"><br></div>

<p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„ token æ¥è®¿é—® slack çš„ open api äº†ï¼Œå…·ä½“æ–‡æ¡£åœ¨è¿™é‡Œï¼š<a href="https://api.slack.com/web" target="_blank" rel="noopener">https://api.slack.com/web</a>ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦çš„å‘é€æ¶ˆæ¯åˆ° <code>#huginn-movie</code> channel çš„æ¥å£æ–‡æ¡£ï¼š<br> <a href="https://api.slack.com/methods/chat.postMessage" target="_blank" rel="noopener">https://api.slack.com/methods/chat.postMessage</a></p>
<p>æœ‰äº† api æ–‡æ¡£ï¼Œæœ‰äº† tokenï¼Œä¸€åˆ‡å°±å¥½åŠäº†ã€‚</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38289564-69cd36bc-3809-11e8-820f-8f7cddaf64cb.png" width="650px/"><br></div>

<p>ç”±ä¸Šè¿°æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ post è¯·æ±‚ï¼ŒæŠŠæˆ‘ä»¬è¦å‘é€çš„ç”µå½±ä¿¡æ¯å°è£…åˆ° <code>attachments</code> å‚æ•°ä¸­æ‰§è¡Œè¯·æ±‚å³å¯ã€‚</p>
<p>è€Œä¸” <code>attachments</code> å‚æ•°å¯ä»¥å‚è€ƒæ–‡æ¡£ <a href="https://api.slack.com/docs/message-attachments" target="_blank" rel="noopener">https://api.slack.com/docs/message-attachments</a> æ¥å°è£…ä¿¡æ¯ã€‚</p>
<p>Slack ç¯å¢ƒä¸€åˆ‡å°±ç»ªï¼Œæ¥ä¸‹æ¥ï¼Œå›åˆ° Huginnã€‚</p>
<h4 id="åˆ›å»º-Agent-å‘é€-Slack-æ¶ˆæ¯"><a href="#åˆ›å»º-Agent-å‘é€-Slack-æ¶ˆæ¯" class="headerlink" title="åˆ›å»º Agent å‘é€ Slack æ¶ˆæ¯"></a>åˆ›å»º Agent å‘é€ Slack æ¶ˆæ¯</h4><p>åˆ›å»º <code>PostAgent</code>ï¼ˆæ³¨æ„ï¼Œä¸æ˜¯ <code>SlackAgent</code>ï¼‰ï¼Œå–åä¸º <code>step3_high_score_movies_to_slack_post</code>ã€‚<strong>Sources</strong> å¡«å†™ä¸º <code>step2_1_deduplication_high_score_movies</code>ï¼Œå› ä¸ºè¿™ä¸ª agent éœ€è¦æŠŠå»é‡åçš„ç”µå½±ä¿¡æ¯é€šè¿‡ slack å‘é€ç»™æˆ‘ä»¬ã€‚</p>
<p>æœ€ç»ˆçš„ Options é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"post_url"</span>: <span class="string">"&#123;% credential slack_huginn_url_post_message %&#125;"</span>,</span><br><span class="line">  <span class="attr">"expected_receive_period_in_days"</span>: <span class="string">"1"</span>,</span><br><span class="line">  <span class="attr">"content_type"</span>: <span class="string">"json"</span>,</span><br><span class="line">  <span class="attr">"method"</span>: <span class="string">"post"</span>,</span><br><span class="line">  <span class="attr">"payload"</span>: &#123;</span><br><span class="line">    <span class="attr">"channel"</span>: <span class="string">"huginn-movie"</span>,</span><br><span class="line">    <span class="attr">"username"</span>: <span class="string">"Douban Movie"</span>,</span><br><span class="line">    <span class="attr">"icon_url"</span>: <span class="string">"https://img3.doubanio.com/pics/douban-icons/favicon_48x48.png"</span>,</span><br><span class="line">    <span class="attr">"attachments"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"fallback"</span>: <span class="string">"Required plain-text summary of the attachment."</span>,</span><br><span class="line">        <span class="attr">"mrkdwn_in"</span>: [</span><br><span class="line">          <span class="string">"text"</span>,</span><br><span class="line">          <span class="string">"pretext"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">"color"</span>: <span class="string">"#36a64f"</span>,</span><br><span class="line">        <span class="attr">"pretext"</span>: <span class="string">"Hi~ &lt;@&#123;% credential  slack_at_user_id %&#125;&gt;, There is *high score* movie."</span>,</span><br><span class="line">        <span class="attr">"author_name"</span>: <span class="string">"&#123;&#123;director&#125;&#125;"</span>,</span><br><span class="line">        <span class="attr">"author_link"</span>: <span class="string">"&#123;&#123;detail_url&#125;&#125;"</span>,</span><br><span class="line">        <span class="attr">"author_icon"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="attr">"title"</span>: <span class="string">"ã€Š&#123;&#123;title&#125;&#125;ã€‹"</span>,</span><br><span class="line">        <span class="attr">"title_link"</span>: <span class="string">"&#123;&#123;detail_url&#125;&#125;"</span>,</span><br><span class="line">        <span class="attr">"text"</span>: <span class="string">"*Actors*: &#123;&#123;actors&#125;&#125;"</span>,</span><br><span class="line">        <span class="attr">"fields"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"title"</span>: <span class="string">"Score"</span>,</span><br><span class="line">            <span class="attr">"value"</span>: <span class="string">"&#123;&#123;score&#125;&#125;"</span>,</span><br><span class="line">            <span class="attr">"short"</span>: <span class="literal">true</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"title"</span>: <span class="string">"Star"</span>,</span><br><span class="line">            <span class="attr">"value"</span>: <span class="string">"&#123;&#123;star&#125;&#125;"</span>,</span><br><span class="line">            <span class="attr">"short"</span>: <span class="literal">true</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"title"</span>: <span class="string">"Region"</span>,</span><br><span class="line">            <span class="attr">"value"</span>: <span class="string">"&#123;&#123;region&#125;&#125;"</span>,</span><br><span class="line">            <span class="attr">"short"</span>: <span class="literal">true</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"title"</span>: <span class="string">"Release"</span>,</span><br><span class="line">            <span class="attr">"value"</span>: <span class="string">"&#123;&#123;release&#125;&#125;"</span>,</span><br><span class="line">            <span class="attr">"short"</span>: <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">"image_url"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="attr">"thumb_url"</span>: <span class="string">"&#123;&#123;image_url&#125;&#125;"</span>,</span><br><span class="line">        <span class="attr">"footer"</span>: <span class="string">"Slack"</span>,</span><br><span class="line">        <span class="attr">"footer_icon"</span>: <span class="string">"https://platform.slack-edge.com/img/default_application_icon.png"</span>,</span><br><span class="line">        <span class="attr">"ts"</span>: <span class="string">"&#123;&#123;\"now\" | date: \"%s\"&#125;&#125;"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"headers"</span>: &#123;</span><br><span class="line">    <span class="attr">"Content-Type"</span>: <span class="string">"application/json"</span>,</span><br><span class="line">    <span class="attr">"Authorization"</span>: <span class="string">"&#123;% credential slack_huginn_token %&#125;"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"emit_events"</span>: <span class="string">"false"</span>,</span><br><span class="line">  <span class="attr">"no_merge"</span>: <span class="string">"false"</span>,</span><br><span class="line">  <span class="attr">"output_mode"</span>: <span class="string">"clean"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li><code>{\% credential slack_huginn_url_post_message %\}</code>ï¼šæ­¤ç±»çš„è¡¨è¾¾å¼ä¸º <a href="https://github.com/huginn/huginn/wiki/Formatting-Events-using-Liquid" target="_blank" rel="noopener">Liquid-interpolated</a>ï¼Œå…·ä½“çš„å€¼é…ç½®åœ¨ <code>Credentials</code> ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºå…¨å±€å®šä¹‰ï¼Œåœ¨ <code>Credentials</code> ä¸­é…ç½®å¥½ <code>key-value</code> ä¹‹åï¼Œå¯ä»¥åœ¨å…¶å®ƒåœ°æ–¹ä»¥è¯¸å¦‚ <code>{\% credential key \%}</code> çš„æ–¹å¼æ¥ä½¿ç”¨ï¼Œè¿™é‡Œä¸åšè¿‡å¤šä»‹ç»äº†ã€‚</li>
</ul>
<p><span id="slack_at_anyone"></span></p>
<ul>
<li>åœ¨æ¶ˆæ¯ä¸­ä½¿ç”¨Slack ä¸­çš„ <code>@</code> æŸäººçš„åŠŸèƒ½æ—¶ï¼Œéœ€è¦æ‹¿åˆ°å¯¹åº”ç”¨æˆ·çš„ IDï¼Œå¯ä»¥çš„è·å–æ–¹å¼å¯ä»¥é€šè¿‡åœ¨ slack ä¸­é€‰ä¸­åå­—ç„¶å <code>Copy link</code> çš„æ–¹å¼æ‹¿åˆ°ç”¨æˆ·é“¾æ¥ï¼Œç”¨æˆ·è¿æ¥çš„æœ€åå°±æ˜¯ IDã€‚</li>
</ul>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38290017-c49db6c8-380b-11e8-817c-bbd1aa25396e.png" width="300px/"><br></div>

<p>ä¿å­˜è¯¥ Agentï¼Œè‡³æ­¤ï¼Œæ‰€éœ€çš„æ‰€æœ‰çš„ Agent éƒ½å·²ç»åˆ›å»ºå®Œæ¯•äº†ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ•´ä¸ª Scenario çš„äº‹ä»¶æµç¨‹å›¾å¦‚ä¸‹ï¼š</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/38290316-44ee5e12-380d-11e8-9da2-d6d995fb3e1a.png" width="300px/"><br></div>

<p>Huginn è¿˜æ”¯æŒå…¬å¼€ä½ åˆ›å»ºçš„ Scenarioï¼Œæä¾›ç»™å…¶å®ƒäººä½¿ç”¨ï¼Œä»¥ä¸Šçš„ä»£ç ä¹Ÿå·²ç»å…¬å¼€ï¼š</p>
<p><a href="http://h.wangjiegulu.com/scenarios/8/export.json" target="_blank" rel="noopener">http://h.wangjiegulu.com/scenarios/8/export.json</a></p>
<p>å¤§å®¶å¯ä»¥ç›´æ¥ä¸‹è½½ä½¿ç”¨ï¼Œä¸è¿‡éœ€è¦åœ¨ <code>Credentials</code> ä¸­é…ç½®å¦‚ä¸‹å‚æ•°ï¼š</p>
<ul>
<li><strong>slack_huginn_tokenï¼š</strong>ä½ åˆ›å»ºçš„ Slack App çš„ OAuth Access Tokenï¼Œå…·ä½“æ–¹å¼å¯ä»¥å‚è€ƒ<a href="#slack_token">è¿™é‡Œ</a></li>
<li><strong>slack_at_user_idï¼š</strong>ä½ éœ€è¦ @ çš„ slack ç”¨æˆ· IDï¼Œå¡«å†™ä½ è‡ªå·±çš„ï¼Œæ‹¿åˆ°ä½  ID çš„æ–¹å¼å¯ä»¥å‚è€ƒ<a href="#slack_at_anyone">è¿™é‡Œ</a></li>
<li><strong>slack_huginn_url_post_messageï¼š</strong>å¡«å†™ <code>https://slack.com/api/chat.postMessage</code> å³å¯ã€‚</li>
</ul>
<p>é™¤äº†ä»¥ä¸Šä¾‹å­ï¼ŒHuginn è¿˜å¯ä»¥å®Œæˆæ›´å¤šå¥‡æ€å¦™æƒ³ï¼Œé™åˆ¶ä½ çš„åªæœ‰ä½ çš„æƒ³è±¡åŠ›ã€‚</p>
]]></content>
      
        <categories>
            
            <category> huginn </category>
            
            <category> automate </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ifttt </tag>
            
            <tag> automate </tag>
            
            <tag> huginn </tag>
            
            <tag> integromat </tag>
            
            <tag> zapier </tag>
            
            <tag> geek </tag>
            
            <tag> douban </tag>
            
            <tag> movies </tag>
            
            <tag> slack </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[HuginnåŠç¯å¢ƒæ­å»º]]></title>
      <url>/2018/04/02/build_the_environment_for_huginn/</url>
      <content type="html"><![CDATA[<h1 id="Huginn-åŠç¯å¢ƒæ­å»º"><a href="#Huginn-åŠç¯å¢ƒæ­å»º" class="headerlink" title="Huginn åŠç¯å¢ƒæ­å»º"></a>Huginn åŠç¯å¢ƒæ­å»º</h1><h2 id="ä»€ä¹ˆæ˜¯-Huginn-ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Huginn-ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Huginn ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Huginn ï¼Ÿ</h2><p>Huginn æ˜¯ä¸€ä¸ªå¯ä»¥é€šè¿‡æ„å»º agents æ¥å¸®ä½ å®ç°åœ¨çº¿è‡ªåŠ¨åŒ–ä»»åŠ¡çš„ç³»ç»Ÿã€‚å®ƒä»¬å¯ä»¥ç†è§£ webï¼Œç›‘å¬äº‹ä»¶ï¼ŒæŒ‰ä½ æ‰€éœ€åœ°å»æ‰§è¡Œä¸€äº›è¡Œä¸ºã€‚Huginn çš„ agents åˆ›å»ºå’Œæ¶ˆè´¹äº‹ä»¶ï¼Œé€šè¿‡æœ‰å‘å›¾è¡¨æ¥è¿›è¡Œè½¬æ’­ã€‚ä½ å¯ä»¥æŠŠå®ƒå½“ä½œéƒ¨ç½²åœ¨ä½ è‡ªå·±çš„æœåŠ¡å™¨ä¸Šçš„ç ´è§£ç‰ˆæœ¬çš„ IFTTT æˆ– Zapierã€‚</p>
<p><img src="https://raw.githubusercontent.com/huginn/huginn/master/doc/imgs/the-name.png" alt=""></p>
<p>ä½ å¯ä»¥ç”¨ Huginn åšä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>è¿½è¸ªå¤©æ°”å¹¶åœ¨æ˜å¤©ä¸‹é›¨ï¼ˆé›ªï¼‰çš„æ—¶å€™é‚®ä»¶é€šçŸ¥ç»™ä½ ï¼ˆæ˜å¤©ä¸è¦å¿˜è®°å¸¦ä¼ï¼‰ã€‚</li>
<li>åˆ—å‡ºä½ å…³å¿ƒçš„æ¡ç›®ï¼Œå¹¶åœ¨ Twitter å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ç”µå­é‚®ä»¶é€šçŸ¥ç»™ä½ ã€‚ï¼ˆä¾‹å¦‚ï¼Œæƒ³çŸ¥é“åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸå‘ç”Ÿäº†ä»€ä¹ˆæœ‰è¶£çš„äº‹æƒ…å—ï¼ŸHuginn å°†åœ¨ Twitter ä¸Šè§‚å¯Ÿâ€œmachine learningâ€è¿™ä¸ªè¯ï¼Œå¹¶å‘Šè¯‰ä½ ä»€ä¹ˆæ—¶å€™è®¨è®ºä¼šé«˜é«˜å³°ã€‚ï¼‰</li>
<li>å¸®ä½ è§‚å¯Ÿæ—…æ¸¸æœºç¥¨å’Œè´­ç‰©ä¼˜æƒ ä¿¡æ¯ã€‚</li>
<li>æŠ“å–ä»»æ„ç½‘ç«™å¹¶åœ¨å‘ç”Ÿå˜åŒ–æ—¶ç”µå­é‚®ä»¶é€šçŸ¥ä½ ã€‚</li>
<li>è¿æ¥åˆ° Adioso, HipChat, Basecamp, Growl, FTP, IMAP, Jabber, JIRA, MQTT, nextbus, Pushbullet, Pushover, RSS, Bash, Slack, StubHub, translation APIs, Twilio, Twitter, Wunderground, and å¾®åšç­‰ç¬¬ä¸‰æ–¹.</li>
<li>å‘é€å’Œæ¥æ”¶ WebHooksã€‚</li>
<li>å…¶å®ƒå¾ˆå¤šå¾ˆå¤šä½ èƒ½æƒ³åˆ°çš„ã€‚</li>
</ul>
<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><p>ä»¥ <code>Debian</code> æœåŠ¡å™¨ä¸ºä¾‹ï¼Œè¿›è¡Œç¯å¢ƒæ­å»ºï¼ˆå¤§å®¶å¯ä»¥é€‰æ‹©è´­ä¹°VPSï¼‰ã€‚</p>
<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>Huginn çš„å®‰è£…ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ç»„ä»¶ï¼š</p>
<ol>
<li>Packages / Dependencies</li>
<li>Ruby</li>
<li>System Users</li>
<li>Database</li>
<li>Huginn</li>
<li>Nginx</li>
</ol>
<h3 id="1-Packages-Dependencies"><a href="#1-Packages-Dependencies" class="headerlink" title="1. Packages / Dependencies"></a>1. Packages / Dependencies</h3><p>Debian ä¸­ <code>sudo</code> å¹¶æ²¡æœ‰é»˜è®¤å®‰è£…ã€‚ç¡®ä¿ä½ çš„ç³»ç»Ÿæ˜¯æœ€æ–°çš„ï¼Œç„¶åå®‰è£…å®ƒã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># run as root!</span><br><span class="line">apt-get update -y</span><br><span class="line">apt-get upgrade -y</span><br><span class="line">apt-get install sudo -y</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong>åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–è¾‘ä¸€äº›æ–‡ä»¶ã€‚å¦‚æœä½ ç†Ÿæ‚‰ vimï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å°†å…¶è®¾ç½®ä¸ºé»˜è®¤ç¼–è¾‘å™¨ã€‚å¦‚æœä½ å¯¹ vim ä¸ç†Ÿæ‚‰ï¼Œè¯·è·³è¿‡æ­¤æ“ä½œå¹¶ç»§ç»­ä½¿ç”¨é»˜è®¤ç¼–è¾‘å™¨ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Install vim and set as default editor</span><br><span class="line">sudo apt-get install -y vim</span><br><span class="line">sudo update-alternatives --set editor /usr/bin/vim.basic</span><br></pre></td></tr></table></figure>
<p>å¯¼å…¥ node.js åº“ (å¦‚æœæ˜¯ Ubuntu æˆ–è€… Debian Jessie çš„è¯å¯ä»¥è·³è¿‡)ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sL https://deb.nodesource.com/setup_0.12 | sudo bash -</span><br></pre></td></tr></table></figure>
<p>å®‰è£…éœ€è¦çš„ packagesï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y runit build-essential git zlib1g-dev libyaml-dev libssl-dev libgdbm-dev libreadline-dev libncurses5-dev libffi-dev curl openssh-server checkinstall libxml2-dev libxslt-dev libcurl4-openssl-dev libicu-dev logrotate python-docutils pkg-config cmake nodejs graphviz</span><br></pre></td></tr></table></figure>
<h4 id="Debian-Stretch"><a href="#Debian-Stretch" class="headerlink" title="Debian Stretch"></a>Debian Stretch</h4><p>ç”±äº Debian Stretch çš„ runit ä¸ä¼šè‡ªåŠ¨å¯åŠ¨ï¼Œä½†æ˜¯è¿™ä¼šè¢«initç³»ç»Ÿå¤„ç†ã€‚å¦å¤–ï¼ŒRubyéœ€è¦ OpenSSL 1.0 å¼€å‘åŒ…è€Œä¸æ˜¯ 1.1çš„ã€‚å¯¹äºé»˜è®¤å®‰è£…ä½¿ç”¨è¿™äº›åŒ…ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y runit-systemd libssl1.0-dev</span><br></pre></td></tr></table></figure>
<h3 id="2-Ruby"><a href="#2-Ruby" class="headerlink" title="2. Ruby"></a>2. Ruby</h3><p>åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨å¸¦æœ‰ Huginn çš„ Ruby ç‰ˆæœ¬ç®¡ç†å™¨ï¼ˆå¦‚ <a href="http://rvm.io/" target="_blank" rel="noopener">RVM</a>ï¼Œ<a href="https://github.com/sstephenson/rbenv" target="_blank" rel="noopener">rbenv</a> æˆ– <a href="https://github.com/postmodern/chruby" target="_blank" rel="noopener">chruby</a>ï¼‰ä¼šé¢‘ç¹å¯¼è‡´éš¾ä»¥è¯Šæ–­çš„é—®é¢˜ã€‚ç‰ˆæœ¬ç®¡ç†å™¨ä¸å—æ”¯æŒï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®æ‰€æœ‰äººæŒ‰ç…§ä»¥ä¸‹è¯´æ˜ä½¿ç”¨ç³»ç»Ÿ Rubyã€‚</p>
<p>å¦‚æœå­˜åœ¨çš„è¯ï¼Œåˆ é™¤æ—§ç‰ˆæœ¬çš„ Rubyï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get remove -y ruby1.8 ruby1.9</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½ Rubyï¼Œç„¶åç¼–è¯‘ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir /tmp/ruby &amp;&amp; cd /tmp/ruby</span><br><span class="line">curl -L --progress http://cache.ruby-lang.org/pub/ruby/2.4/ruby-2.4.2.tar.bz2 | tar xj</span><br><span class="line">cd ruby-2.4.2</span><br><span class="line">./configure --disable-install-rdoc</span><br><span class="line">make -j`nproc`</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<p>å®‰è£… bundler å’Œ foreman:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install rake bundler foreman --no-ri --no-rdoc</span><br></pre></td></tr></table></figure>
<h3 id="3-System-Users"><a href="#3-System-Users" class="headerlink" title="3. System Users"></a>3. System Users</h3><p>ä¸º Huginn åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo adduser --disabled-login --gecos &apos;Huginn&apos; huginn</span><br></pre></td></tr></table></figure>
<h3 id="4-Database"><a href="#4-Database" class="headerlink" title="4. Database"></a>4. Database</h3><p>å®‰è£…æ•°æ®åº“</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y mysql-server mysql-client libmysqlclient-dev</span><br><span class="line"></span><br><span class="line"># é€‰æ‹©ä¸€ä¸ª MySQL root å¯†ç  (å¯ä»¥ä»»æ„), è¾“å…¥å¹¶æŒ‰å›è½¦,</span><br><span class="line"># é‡å¤è¾“å…¥ MySQL root å¯†ç  ç„¶åæŒ‰å›è½¦</span><br></pre></td></tr></table></figure>
<p>å¯¹äº Debian Stretch, æ›¿æ¢ libmysqlclient-dev ä¸º default-libmysqlclient-devã€‚</p>
<p>æ£€æŸ¥ä½ å®‰è£…çš„ MySQL ç‰ˆæœ¬ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql --version</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mysql_secure_installation</span><br></pre></td></tr></table></figure>
<p>ç™»å½• MySQLï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line"></span><br><span class="line"># è¾“å…¥ MySQL root å¯†ç </span><br></pre></td></tr></table></figure>
<p>ä¸º Huginn åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œæ›¿æ¢ å‘½ä»¤ä¸­çš„ $password ä¸ºä½ çœŸå®çš„å¯†ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE USER &apos;huginn&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;$password&apos;;</span><br></pre></td></tr></table></figure>
<p>æ”¯æŒ long indexesï¼Œä½ éœ€è¦ç¡®ä¿å¯ä»¥ä½¿ç”¨ InnoDB engineï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SET default_storage_engine=INNODB;</span><br><span class="line"></span><br><span class="line"># å¦‚æœå¤±è´¥ï¼Œæ£€æŸ¥ä½ çš„ MySQL é…ç½®æ–‡ä»¶ (e.g. `/etc/mysql/*.cnf`, `/etc/mysql/conf.d/*`)</span><br><span class="line"># è®¾ç½® &quot;innodb = off&quot;</span><br></pre></td></tr></table></figure>
<p>ç»™äºˆ Huginn ç”¨æˆ·å¿…è¦çš„æ•°æ®åº“ç›¸å…³æƒé™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER, LOCK TABLES ON `huginn_production`.* TO &apos;huginn&apos;@&apos;localhost&apos;;</span><br></pre></td></tr></table></figure>
<p>é€€å‡º database ä¼šè¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; \q</span><br></pre></td></tr></table></figure>
<p>å°è¯•ä½¿ç”¨æ–°çš„ç”¨æˆ·é“¾æ¥åˆ°æ–°çš„æ•°æ®åº“</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo -u huginn -H mysql -u huginn -p -D huginn_production</span><br><span class="line"></span><br><span class="line"># Type the password you replaced $password with earlier</span><br></pre></td></tr></table></figure>
<p>ä½ åº”è¯¥å›çœ‹åˆ° <code>ERROR 1049 (42000): Unknown database &#39;huginn_production&#39;</code>ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¼šç¨ååˆ›å»ºæ•°æ®åº“ã€‚</p>
<h3 id="5-Huginn"><a href="#5-Huginn" class="headerlink" title="5. Huginn"></a>5. Huginn</h3><h4 id="Clone-æºä»£ç "><a href="#Clone-æºä»£ç " class="headerlink" title="Clone æºä»£ç "></a>Clone æºä»£ç </h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># We&apos;ll install Huginn into the home directory of the user &quot;huginn&quot;</span><br><span class="line">cd /home/huginn</span><br><span class="line"></span><br><span class="line"># Clone Huginn repository</span><br><span class="line">sudo -u huginn -H git clone https://github.com/huginn/huginn.git -b master huginn</span><br><span class="line"></span><br><span class="line"># Go to Huginn installation folder</span><br><span class="line">cd /home/huginn/huginn</span><br><span class="line"></span><br><span class="line"># Copy the example Huginn config</span><br><span class="line">sudo -u huginn -H cp .env.example .env</span><br><span class="line"></span><br><span class="line"># Create the log/, tmp/pids/ and tmp/sockets/ directories</span><br><span class="line">sudo -u huginn mkdir -p log tmp/pids tmp/sockets</span><br><span class="line"></span><br><span class="line"># Make sure Huginn can write to the log/ and tmp/ directories</span><br><span class="line">sudo chown -R huginn log/ tmp/</span><br><span class="line">sudo chmod -R u+rwX,go-w log/ tmp/</span><br><span class="line"></span><br><span class="line"># Make sure permissions are set correctly</span><br><span class="line">sudo chmod -R u+rwX,go-w log/</span><br><span class="line">sudo chmod -R u+rwX tmp/</span><br><span class="line">sudo -u huginn -H chmod o-rwx .env</span><br><span class="line"></span><br><span class="line"># Copy the example Unicorn config</span><br><span class="line">sudo -u huginn -H cp config/unicorn.rb.example config/unicorn.rb</span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®å®ƒ"><a href="#é…ç½®å®ƒ" class="headerlink" title="é…ç½®å®ƒ"></a>é…ç½®å®ƒ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Update Huginn config file and follow the instructions</span><br><span class="line">sudo -u huginn -H editor .env</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DATABASE_ADAPTER=mysql2</span><br><span class="line">DATABASE_RECONNECT=true</span><br><span class="line">DATABASE_NAME=huginn_production</span><br><span class="line">DATABASE_POOL=20</span><br><span class="line">DATABASE_USERNAME=huginn</span><br><span class="line">DATABASE_PASSWORD=&apos;$password&apos;</span><br><span class="line">#DATABASE_HOST=your-domain-here.com</span><br><span class="line">#DATABASE_PORT=3306</span><br><span class="line">#DATABASE_SOCKET=/tmp/mysql.sock</span><br><span class="line"></span><br><span class="line">DATABASE_ENCODING=utf8</span><br><span class="line"># MySQL only: If you are running a MySQL server &gt;=5.5.3, you should</span><br><span class="line"># set DATABASE_ENCODING to utf8mb4 instead of utf8 so that the</span><br><span class="line"># database can hold 4-byte UTF-8 characters like emoji.</span><br><span class="line">#DATABASE_ENCODING=utf8mb4</span><br></pre></td></tr></table></figure>
<p><strong>é‡è¦ï¼š</strong> å–æ¶ˆæ³¨é‡Š RAILS_ENV è®¾ç½®ï¼Œä»¥ä¾¿äºåœ¨ç”Ÿäº§ç¯èŠ‚è¿è¡Œ Huginnã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RAILS_ENV=production</span><br></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦æ”¹å˜ Unicorn é…ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Increase the amount of workers if you expect to have a high load instance.</span><br><span class="line"># 2 are enough for most use cases, if the server has less then 2GB of RAM</span><br><span class="line"># decrease the worker amount to 1</span><br><span class="line">sudo -u huginn -H editor config/unicorn.rb</span><br></pre></td></tr></table></figure>
<p><strong>é‡è¦ï¼š</strong>ç¡®ä¿ <code>.env</code> å’Œ <code>unicorn.rb</code> éƒ½ç¬¦åˆä½ çš„é…ç½®ã€‚</p>
<h4 id="å®‰è£…-Gems"><a href="#å®‰è£…-Gems" class="headerlink" title="å®‰è£… Gems"></a>å®‰è£… Gems</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u huginn -H bundle install --deployment --without development test</span><br></pre></td></tr></table></figure>
<h4 id="åˆå§‹åŒ–-Database"><a href="#åˆå§‹åŒ–-Database" class="headerlink" title="åˆå§‹åŒ– Database"></a>åˆå§‹åŒ– Database</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Create the database</span><br><span class="line">sudo -u huginn -H bundle exec rake db:create RAILS_ENV=production</span><br><span class="line"></span><br><span class="line"># Migrate to the latest version</span><br><span class="line">sudo -u huginn -H bundle exec rake db:migrate RAILS_ENV=production</span><br><span class="line"></span><br><span class="line"># Create admin user and example agents using the default admin/password login</span><br><span class="line">sudo -u huginn -H bundle exec rake db:seed RAILS_ENV=production SEED_USERNAME=admin SEED_PASSWORD=password</span><br></pre></td></tr></table></figure>
<h4 id="ç¼–è¯‘-Assets"><a href="#ç¼–è¯‘-Assets" class="headerlink" title="ç¼–è¯‘ Assets"></a>ç¼–è¯‘ Assets</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u huginn -H bundle exec rake assets:precompile RAILS_ENV=production</span><br></pre></td></tr></table></figure>
<h4 id="å®‰è£…åˆå§‹è„šæœ¬"><a href="#å®‰è£…åˆå§‹è„šæœ¬" class="headerlink" title="å®‰è£…åˆå§‹è„šæœ¬"></a>å®‰è£…åˆå§‹è„šæœ¬</h4><p>Huginn ä½¿ç”¨ <a href="http://ddollar.github.io/foreman/" target="_blank" rel="noopener">foreman</a> æ¥ç”ŸæˆåŸºäº <code>Procfile</code> çš„åˆå§‹åŒ–è„šæœ¬ã€‚</p>
<p>ç¼–è¾‘ <a href="https://github.com/huginn/huginn/blob/master/Procfile" target="_blank" rel="noopener"><code>Procfile</code></a> æ¥é’ˆå¯¹ç”Ÿäº§é€‰æ‹©ä¸€ä¸ªæ¨èçš„ç‰ˆæœ¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u huginn -H editor Procfile</span><br></pre></td></tr></table></figure>
<p>æ³¨é‡Š<a href="https://github.com/huginn/huginn/blob/master/Procfile#L6-L7" target="_blank" rel="noopener">è¿™ä¸¤è¡Œ</a>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">web: bundle exec rails server -p $&#123;PORT-3000&#125; -b $&#123;IP-0.0.0.0&#125;</span><br><span class="line">jobs: bundle exec rails runner bin/threaded.rb</span><br></pre></td></tr></table></figure>
<p>å–æ¶ˆæ³¨é‡Š<a href="https://github.com/huginn/huginn/blob/master/Procfile#L6-L7" target="_blank" rel="noopener">è¿™å‡ è¡Œ</a>æˆ–è€…<a href="https://github.com/huginn/huginn/blob/master/Procfile#L28-L31" target="_blank" rel="noopener">è¿™äº›</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># web: bundle exec unicorn -c config/unicorn.rb</span><br><span class="line"># jobs: bundle exec rails runner bin/threaded.rb</span><br></pre></td></tr></table></figure>
<p>Export åˆå§‹åŒ– scripts:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo bundle exec rake production:export</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong>æ¯æ¬¡ä½ ä¿®æ”¹äº† <code>.env</code> æˆ–è€…ä½ çš„ procfile æ–‡ä»¶ï¼Œä½ éƒ½å¿…é¡»è¦é‡æ–° export å‡ºäº‹ scriptã€‚</p>
</blockquote>
<h4 id="è®¾ç½®-Logrotate"><a href="#è®¾ç½®-Logrotate" class="headerlink" title="è®¾ç½® Logrotate"></a>è®¾ç½® Logrotate</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp deployment/logrotate/huginn /etc/logrotate.d/huginn</span><br></pre></td></tr></table></figure>
<h4 id="ç¡®ä¿ä½ çš„-Huginn-å®ä¾‹æ­£åœ¨è¿è¡Œ"><a href="#ç¡®ä¿ä½ çš„-Huginn-å®ä¾‹æ­£åœ¨è¿è¡Œ" class="headerlink" title="ç¡®ä¿ä½ çš„ Huginn å®ä¾‹æ­£åœ¨è¿è¡Œ"></a>ç¡®ä¿ä½ çš„ Huginn å®ä¾‹æ­£åœ¨è¿è¡Œ</h4><p>sudo bundle exec rake production:status</p>
<h3 id="6-Nginx"><a href="#6-Nginx" class="headerlink" title="6. Nginx"></a>6. Nginx</h3><blockquote>
<p><strong>æ³¨æ„ï¼š</strong>Nginx æ˜¯ Huginn å®˜æ–¹æ”¯æŒçš„ web æœåŠ¡å™¨ã€‚å¦‚æœä½ ä¸ä¼šæˆ–è€…ä¸æƒ³ä½¿ç”¨ Nginx ä½œä¸ºä½ çš„ web æœåŠ¡å™¨ï¼Œå‚è€ƒ wiki çš„æ–‡ç« æ¥ä½¿ç”¨é…ç½® <a href="https://github.com/huginn/huginn/wiki/Apache-Huginn-configuration" target="_blank" rel="noopener">apache</a></p>
</blockquote>
<h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y nginx</span><br></pre></td></tr></table></figure>
<h4 id="ç½‘ç«™é…ç½®"><a href="#ç½‘ç«™é…ç½®" class="headerlink" title="ç½‘ç«™é…ç½®"></a>ç½‘ç«™é…ç½®</h4><p>å¤åˆ¶ç¤ºä¾‹ç½‘ç«™é…ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp deployment/nginx/huginn /etc/nginx/sites-available/huginn</span><br><span class="line">sudo ln -s /etc/nginx/sites-available/huginn /etc/nginx/sites-enabled/huginn</span><br></pre></td></tr></table></figure>
<p>ç¡®ä¿ç¼–è¾‘é…ç½®æ–‡ä»¶ä»¥åŒ¹é…ä½ çš„è®¾ç½®ï¼Œå¦‚æœä½ æ­£åœ¨è¿è¡Œå¤šä¸ªnginxç«™ç‚¹ï¼Œè¯·ä» <code>listen</code> æŒ‡ä»¤ä¸­åˆ é™¤ <code>default_server</code> å‚æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Change YOUR_SERVER_FQDN to the fully-qualified</span><br><span class="line"># domain name of your host serving Huginn.</span><br><span class="line">sudo editor /etc/nginx/sites-available/huginn</span><br></pre></td></tr></table></figure>
<p><strong>å¦‚æœ huginn æ˜¯å”¯ä¸€å¯ç”¨çš„ nginx ç½‘ç«™</strong>ï¼Œåˆ é™¤é»˜è®¤çš„ nginx ç½‘ç«™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rm /etc/nginx/sites-enabled/default</span><br></pre></td></tr></table></figure>
<h3 id="Restart"><a href="#Restart" class="headerlink" title="Restart"></a>Restart</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service nginx restart</span><br></pre></td></tr></table></figure>
<p>å®Œæˆã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol>
<li><a href="https://github.com/huginn/huginn" target="_blank" rel="noopener">https://github.com/huginn/huginn</a></li>
<li><a href="https://github.com/huginn/huginn/blob/master/doc/manual/installation.md" target="_blank" rel="noopener">https://github.com/huginn/huginn/blob/master/doc/manual/installation.md</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> huginn </category>
            
            <category> automate </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ifttt </tag>
            
            <tag> automate </tag>
            
            <tag> huginn </tag>
            
            <tag> integromat </tag>
            
            <tag> zapier </tag>
            
            <tag> geek </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¸Šä¼ åˆ°å¤šä¸ªMavenä»“åº“çš„Gradleæ’ä»¶RapidMavenPushPlugin]]></title>
      <url>/2018/03/16/rapid_maven_push_plugin_for_android/</url>
      <content type="html"><![CDATA[<h1 id="RapidMavenPushPlugin"><a href="#RapidMavenPushPlugin" class="headerlink" title="RapidMavenPushPlugin"></a>RapidMavenPushPlugin</h1><p>ç”¨äºä¸Šä¼ ä½ çš„ library åº“åˆ°å¤šä¸ª Maven ä»“åº“çš„ Gradle æ’ä»¶ã€‚</p>
<p><strong>Github: <a href="https://github.com/wangjiegulu/RapidMavenPushPlugin" target="_blank" rel="noopener">https://github.com/wangjiegulu/RapidMavenPushPlugin</a></strong></p>
<h2 id="1-æ€ä¹ˆä½¿ç”¨"><a href="#1-æ€ä¹ˆä½¿ç”¨" class="headerlink" title="1. æ€ä¹ˆä½¿ç”¨"></a>1. æ€ä¹ˆä½¿ç”¨</h2><h3 id="1-1-æ·»åŠ ä¾èµ–"><a href="#1-1-æ·»åŠ ä¾èµ–" class="headerlink" title="1.1 æ·»åŠ ä¾èµ–"></a>1.1 æ·»åŠ ä¾èµ–</h3><p>åœ¨ä½ é¡¹ç›®æ ¹ç›®å½•çš„ <code>build.gradle</code> æ–‡ä»¶ä¸­å¢åŠ  <code>RapidMavenPushPlugin</code> ä¾èµ–ï¼š</p>
<p><strong><a href="http://search.maven.org/#search%7Cga%7C1%7Crapidmavenpush" target="_blank" rel="noopener">æ£€æŸ¥æœ€æ–°ç‰ˆæœ¬</a></strong></p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">buildscript</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">dependencies</span> &#123;</span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">'com.android.tools.build:gradle:3.0.1'</span></span><br><span class="line">        <span class="keyword">classpath</span>(<span class="string">'com.github.wangjiegulu:rapidmavenpush:x.x.x'</span>) &#123;</span><br><span class="line">            <span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'com.android.tools.build'</span>, module: <span class="string">'gradle'</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-2-åˆ›å»º-properties-files"><a href="#1-2-åˆ›å»º-properties-files" class="headerlink" title="1.2 åˆ›å»º properties files"></a>1.2 åˆ›å»º properties files</h3><p>ç°åœ¨ä½ æœ‰3ä¸ª Maven ä»“åº“ï¼ˆ<code>maven type</code>sï¼‰ï¼Œæ‰€ä»¥éœ€è¦åˆ›å»º3ä¸ª maven properties archive æ–‡ä»¶å’Œ1ä¸ªé€šç”¨çš„ archive properties æ–‡ä»¶ï¼ˆproperties æ–‡ä»¶çš„åå­—å’Œä½ç½®å¯ä»¥æ˜¯ä»»æ„çš„ï¼‰ï¼š</p>
<ul>
<li><strong>maven_local.properties</strong>: ä¸Šä¼  archives åˆ°æœ¬åœ°çš„ maven ä»“åº“, é»˜è®¤åœ¨ä½ ç”µè„‘çš„ <code>~/.m2/repository</code>ã€‚</li>
<li><strong>maven_company.properties</strong>: ä¸Šä¼  archives åˆ°ä½ å…¬å¸çš„ maven ä»“åº“ï¼Œä»–éƒ¨ç½²åœ¨ä½ å…¬å¸çš„æœåŠ¡å™¨ä¸Šé¢ã€‚</li>
<li><strong>maven_central.properties</strong>: ä¸Šä¼  archives åˆ° maven ä¸­å¤®åº“ã€‚</li>
<li><strong>common.properties</strong>: ä¸Šé¢3ä¸ª maven ä»“åº“çš„é€šç”¨ propertiesã€‚</li>
</ul>
<blockquote>
<p><strong>NOTE</strong>: å½“ <code>project.afterEvaluate</code> æ—¶, æ‰€æœ‰ properties éƒ½ä¼šè¢«è‡ªåŠ¨æ³¨å…¥åˆ° <code>project.ext</code>ä¸­ï¼Œæ‰€ä»¥åœ¨é‚£ä¹‹åä½ å¯ä»¥ä»¥è¯¸å¦‚ <code>$POM_ARCHIVE_ID</code> çš„æ–¹å¼æ¥ä½¿ç”¨å®ƒä»¬ã€‚</p>
</blockquote>
<h4 id="1-2-1-maven-common-properties"><a href="#1-2-1-maven-common-properties" class="headerlink" title="1.2.1 maven_common.properties"></a>1.2.1 maven_common.properties</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># project info</span><br><span class="line">POM_ARCHIVE_GROUP=com.github.wangjiegulu</span><br><span class="line">#POM_ARCHIVE_VERSION_NAME=0.0.1-SNAPSHOT (command typed)</span><br><span class="line"># aar or jar</span><br><span class="line">POM_PACKAGING=aar</span><br><span class="line">POM_DESC=test-mavenpush-plugin</span><br><span class="line">POM_URL=https://github.com/wangjiegulu</span><br><span class="line">POM_SCM_URL=scm:git@github.com:wangjiegulu</span><br><span class="line">POM_SCM_CONNECTION=scm:git@github.com:wangjiegulu</span><br><span class="line">POM_SCM_DEV_CONNECTION=git@github.com:wangjiegulu</span><br><span class="line">POM_LICENCE_NAME=The Apache Software License, Version 2.0</span><br><span class="line">POM_LICENCE_URL=http://www.apache.org/licenses/LICENSE-2.0.txt</span><br><span class="line">POM_LICENCE_DIST=wangjie</span><br><span class="line">POM_DEVELOPER_ID=wangjie</span><br><span class="line">POM_DEVELOPER_NAME=Wang Jie</span><br><span class="line">POM_DEVELOPER_EMAIL=tiantian.china.2@gmail.com</span><br></pre></td></tr></table></figure>
<h4 id="1-2-2-maven-local-properties"><a href="#1-2-2-maven-local-properties" class="headerlink" title="1.2.2 maven_local.properties"></a>1.2.2 maven_local.properties</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># maven repository</span><br><span class="line">POM_REPOSITORY_URL=/Users/wangjie/.m2/repository</span><br><span class="line">POM_REPOSITORY_URL_SNAPSHOT=/Users/wangjie/.m2/repository</span><br><span class="line">POM_SIGN=false</span><br><span class="line"></span><br><span class="line"># project info</span><br><span class="line">POM_ARCHIVE_ID=mavenpush-plugin-depmodule-local</span><br></pre></td></tr></table></figure>
<h4 id="1-2-3-maven-central-properties"><a href="#1-2-3-maven-central-properties" class="headerlink" title="1.2.3 maven_central.properties"></a>1.2.3 maven_central.properties</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POM_OSSRH_USERNAME=username</span><br><span class="line">POM_OSSRH_PASSWORD=password</span><br><span class="line"></span><br><span class="line"># maven repository</span><br><span class="line">POM_REPOSITORY_URL=https://oss.sonatype.org/service/local/staging/deploy/maven2/</span><br><span class="line">POM_REPOSITORY_URL_SNAPSHOT=https://oss.sonatype.org/content/repositories/snapshots/</span><br><span class="line"></span><br><span class="line">POM_SIGN=true</span><br><span class="line"># Already configure in ~/.gradle/gradle.properties</span><br><span class="line">#signing.keyId=</span><br><span class="line">#signing.password=</span><br><span class="line">#signing.secretKeyRingFile=</span><br><span class="line"></span><br><span class="line"># project info</span><br><span class="line">POM_ARCHIVE_ID=mavenpush-plugin-depmodule</span><br></pre></td></tr></table></figure>
<h3 id="1-3-åº”ç”¨-Plugin-amp-properties"><a href="#1-3-åº”ç”¨-Plugin-amp-properties" class="headerlink" title="1.3 åº”ç”¨ Plugin &amp; properties"></a>1.3 åº”ç”¨ Plugin &amp; properties</h3><p>åœ¨ä½  library çš„ <code>build.gradle</code> æ–‡ä»¶ä¸­, ä½ éœ€è¦ä»¥å¦‚ä¸‹æ–¹å¼æ¥ apply RapidMavenPushPlugin æ’ä»¶ï¼š</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: <span class="string">'com.github.wangjiegulu.plg.rapidmavenpush'</span></span><br><span class="line"></span><br><span class="line">rapidMavenPush &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯ trueï¼Œä¼šåœ¨ç¼–è¯‘æ—¶æœŸæ‰“å°è¢«æ³¨å…¥çš„ properties</span></span><br><span class="line">    printProperties = <span class="keyword">true</span></span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯ trueï¼Œåœ¨æ³¨å…¥ properties å‘ç”Ÿé”™è¯¯æ—¶ä¼šç»ˆæ­¢ç¼–è¯‘</span></span><br><span class="line">    abortOnError = <span class="keyword">false</span></span><br><span class="line">    <span class="comment">// æ˜¯å¦ç¦ç”¨ Rapid Maven Push Plugin</span></span><br><span class="line">    disable = <span class="keyword">false</span></span><br><span class="line">    <span class="comment">// å¦‚æœ `POM_MAVEN_TYPE` æ²¡æœ‰è¢«è®¾ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„ maven typeã€‚</span></span><br><span class="line">    defaultMavenType = <span class="string">'local'</span></span><br><span class="line">    mavens &#123;</span><br><span class="line">        maven &#123;</span><br><span class="line">            mavenType = <span class="string">'local'</span></span><br><span class="line">            propertyFiles = [</span><br><span class="line">                    <span class="keyword">file</span>(<span class="string">"mavenupload/maven_common.properties"</span>),</span><br><span class="line">                    <span class="keyword">file</span>(<span class="string">"mavenupload/maven_local.properties"</span>)</span><br><span class="line">            ]</span><br><span class="line">            <span class="comment">// Property Inject Mode: If the properties is already set, replace it or skip</span></span><br><span class="line">            <span class="comment">// property æ³¨å…¥æ¨¡å¼ï¼šå¦‚æœ properties å·²ç»è¢«è®¾ç½®è¿‡ï¼Œåˆ™æ›¿æ¢è¿˜æ˜¯è·³è¿‡</span></span><br><span class="line">            propertyInjectMode = <span class="string">'replace'</span></span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">            mavenType = <span class="string">'company'</span></span><br><span class="line">            propertyFiles = [</span><br><span class="line">                    <span class="keyword">file</span>(<span class="string">"mavenupload/maven_common.properties"</span>),</span><br><span class="line">                    <span class="keyword">file</span>(<span class="string">"mavenupload/maven_company.properties"</span>)</span><br><span class="line">            ]</span><br><span class="line">            propertyInjectMode = <span class="string">'replace'</span></span><br><span class="line">        &#125;</span><br><span class="line">        maven &#123;</span><br><span class="line">            mavenType = <span class="string">'central'</span></span><br><span class="line">            propertyFiles = [</span><br><span class="line">                    <span class="keyword">file</span>(<span class="string">"mavenupload/maven_common.properties"</span>),</span><br><span class="line">                    <span class="keyword">file</span>(<span class="string">"mavenupload/maven_central.properties"</span>)</span><br><span class="line">            ]</span><br><span class="line">            propertyInjectMode = <span class="string">'replace'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-4-ä¸Šä¼ -Archives"><a href="#1-4-ä¸Šä¼ -Archives" class="headerlink" title="1.4 ä¸Šä¼  Archives"></a>1.4 ä¸Šä¼  Archives</h3><p>åœ¨ç¼–è¯‘ä¹‹åï¼Œrapid maven push plugin è‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>rapidUploadArchives</code> çš„ taskã€‚</p>
<p>æ‰§è¡Œè¿™ä¸ª task !</p>
<p><strong>ä¸Šä¼  archives åˆ°æœ¬åœ°ä»“åº“:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew clean :depmodule:rapidUploadArchives -PPOM_MAVEN_TYPE=local</span><br></pre></td></tr></table></figure>
<p><strong>ä¸Šä¼  archives to åˆ°ä¸­å¤®åº“:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew clean :depmodule:rapidUploadArchives -PPOM_MAVEN_TYPE=central</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>NOTE</strong>: å¦‚æœä½ æ²¡æœ‰åœ¨ <code>build.gradle</code> ä½¿ç”¨ <code>ext.POM_MAVEN_TYPE=xxx</code> çš„æ–¹å¼è¿›è¡Œè®¾ç½®çš„è¯ï¼Œ<code>POM_MAVEN_TYPE</code> å‚æ•°æ˜¯å¿…è¦çš„ã€‚</p>
</blockquote>
<h3 id="1-5-æ”¯æŒçš„-parameters-amp-properties"><a href="#1-5-æ”¯æŒçš„-parameters-amp-properties" class="headerlink" title="1.5 æ”¯æŒçš„ parameters &amp; properties"></a>1.5 æ”¯æŒçš„ parameters &amp; properties</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// maven type, åªèƒ½é€šè¿‡åœ¨ `build.gradle` è®¾ç½® `ext.POM_MAVEN_TYPE=xxx` æˆ–è€…åœ¨å‘½ä»¤è¡Œä¸­è®¾ç½® `-PPOM_MAVEN_TYPE=xxx` æˆ–è€…åœ¨ `gradle.properties` ä¸­è®¾ç½® `PPOM_MAVEN_TYPE=xxx`</span><br><span class="line">POM_MAVEN_TYPE</span><br><span class="line"></span><br><span class="line">// maven repository parameters</span><br><span class="line">POM_REPOSITORY_URL</span><br><span class="line">POM_REPOSITORY_URL_SNAPSHOT</span><br><span class="line">POM_OSSRH_USERNAME</span><br><span class="line">POM_OSSRH_PASSWORD</span><br><span class="line"></span><br><span class="line">// sign parameters</span><br><span class="line">POM_SIGN</span><br><span class="line">signing.keyId</span><br><span class="line">signing.password</span><br><span class="line">signing.secretKeyRingFile</span><br><span class="line"></span><br><span class="line">// archive parameters</span><br><span class="line">POM_ARCHIVE_GROUP</span><br><span class="line">POM_ARCHIVE_ID</span><br><span class="line">POM_ARCHIVE_VERSION_NAME</span><br><span class="line">POM_PACKAGING</span><br><span class="line">POM_DESC</span><br><span class="line">POM_URL</span><br><span class="line">POM_SCM_URL</span><br><span class="line">POM_SCM_CONNECTION</span><br><span class="line">POM_SCM_DEV_CONNECTION</span><br><span class="line">POM_LICENCE_NAME</span><br><span class="line">POM_LICENCE_URL</span><br><span class="line">POM_LICENCE_DIST</span><br><span class="line">POM_DEVELOPER_ID</span><br><span class="line">POM_DEVELOPER_NAME</span><br><span class="line">POM_DEVELOPER_EMAIL</span><br></pre></td></tr></table></figure>
<h1 id="License"><a href="#License" class="headerlink" title="License"></a>License</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Copyright 2018 Wang Jie</span><br><span class="line"></span><br><span class="line">Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="line">you may not use this file except in compliance with the License.</span><br><span class="line">You may obtain a copy of the License at</span><br><span class="line"></span><br><span class="line">  http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line"></span><br><span class="line">Unless required by applicable law or agreed to in writing, software</span><br><span class="line">distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="line">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line">See the License for the specific language governing permissions and</span><br><span class="line">limitations under the License.</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> flutter </category>
            
            <category> dart </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> maven </tag>
            
            <tag> gradle </tag>
            
            <tag> gradle plugin </tag>
            
            <tag> java </tag>
            
            <tag> repository </tag>
            
            <tag> plugin </tag>
            
            <tag> aar </tag>
            
            <tag> jar </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç¼–å†™ç¬¬ä¸€ä¸ªFlutter Appï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/03/01/write_your_first_flutter_app/</url>
      <content type="html"><![CDATA[<p><strong>ä»¥ä¸‹ä»£ç  Github åœ°å€ï¼š<a href="https://github.com/wangjiegulu/flutter_test_01" target="_blank" rel="noopener">https://github.com/wangjiegulu/flutter_test_01</a></strong></p>
<h1 id="ç¼–å†™ä½ çš„ç¬¬ä¸€ä¸ªFlutter-App"><a href="#ç¼–å†™ä½ çš„ç¬¬ä¸€ä¸ªFlutter-App" class="headerlink" title="ç¼–å†™ä½ çš„ç¬¬ä¸€ä¸ªFlutter App"></a>ç¼–å†™ä½ çš„ç¬¬ä¸€ä¸ªFlutter App</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://flutter.io/get-started/codelab/" target="_blank" rel="noopener">https://flutter.io/get-started/codelab/</a></p>
</blockquote>
<p>è¿™ä¸ªä½ åˆ›å»ºç¬¬ä¸€ä¸ªFlutter appçš„æŒ‡å—ã€‚å¦‚æœä½ ç†Ÿæ‚‰é¢å‘å¯¹è±¡çš„ä»£ç ï¼ŒåŸºæœ¬çš„ç¼–ç¨‹æ¦‚å¿µï¼Œæ¯”å¦‚å˜é‡ï¼Œå¾ªç¯ï¼Œå’Œæ¡ä»¶ï¼Œä½ å°±å¯ä»¥å®Œæˆæœ¬æ•™ç¨‹ã€‚ä½ ä¸éœ€è¦ä¹‹å‰æœ‰Dartæˆ–è€…æ‰‹æœºçš„ç¼–ç¨‹ç»éªŒã€‚</p>
<ul>
<li><a href="#step-1-create-the-starting-flutter-app">ç¬¬1æ­¥ï¼šåˆ›å»ºå¯åŠ¨ Flutter app</a></li>
<li><a href="#step-2-use-an-external-package">ç¬¬2æ­¥ï¼šä½¿ç”¨å¤–éƒ¨åŒ…</a></li>
<li><a href="#step-3-add-a-stateful-widget">ç¬¬3æ­¥ï¼šå¢åŠ ä¸€ä¸ª Stateful widget</a></li>
<li><a href="#step-4-create-an-infinite-scrolling-listview">ç¬¬4æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ— é™æ»šåŠ¨çš„ ListView</a></li>
<li><a href="#step-5-add-interactivity">ç¬¬5æ­¥ï¼šå¢åŠ äº¤äº’</a></li>
<li><a href="#step-6-navigate-to-a-new-screen">ç¬¬6æ­¥ï¼šå¯¼èˆªåˆ°ä¸€ä¸ªæ–°çš„é¡µé¢</a></li>
<li><a href="#step-7-change-the-ui-using-themes">ç¬¬7æ­¥ï¼šä½¿ç”¨ Theme æ¥æ”¹å˜ UI</a></li>
<li><a href="#well-done">å¹²å¾—ä¸é”™ï¼</a></li>
</ul>
<p><strong>ä½ å°†æ„å»ºä»€ä¹ˆ</strong></p>
<p>ä½ å°†è¦å®ç°ä¸€ä¸ªç®€å•çš„æ‰‹æœº appï¼Œä¸ºä¸€ä¸ªåˆåˆ›å…¬å¸å»ç”Ÿæˆä¸€äº›æ¨èçš„åå­—ã€‚ç”¨æˆ·å¯ä»¥é€‰æ‹©å’Œå–æ¶ˆé€‰æ‹©è¿™äº›åå­—ï¼Œå¹¶ä¿å­˜æœ€å¥½çš„ä¸€äº›åå­—ã€‚ä»£ç ä¸€æ¬¡ç”Ÿæˆ10ä¸ªåå­—ã€‚å½“ç”¨æˆ·æ»šåŠ¨æ—¶ï¼Œæ–°çš„ä¸€æ‰¹åå­—å°±ä¼šè¢«ç”Ÿæˆã€‚ç”¨æˆ·å¯ä»¥ç‚¹å‡» app bar å³ä¸Šè§’çš„æŒ‰é’®è¿›å…¥ä¸€ä¸ªæ–°çš„é¡µé¢æ¥ä»…å±•ç¤ºè¢«å–œæ¬¢çš„åå­—ã€‚</p>
<p>Gif åŠ¨å›¾å±•ç¤ºäº† app å®Œæˆä¹‹åçš„è¿è¡Œæ•ˆæœã€‚</p>
<div style="text-align: center;"><br><img src="https://flutter.io/get-started/codelab/images/startup-namer-app.gif"><br></div>

<p><strong>ä½ å°†å­¦åˆ°ä»€ä¹ˆ</strong></p>
<ul>
<li>Flutter app çš„åŸºç¡€ç»“æ„ã€‚</li>
<li>æŸ¥è¯¢å’Œä½¿ç”¨åŒ…æ¥æ‰©å±•ç‰¹æ€§ã€‚</li>
<li>ä½¿ç”¨çƒ­é‡è½½æ¥å®ç°å¿«é€Ÿçš„å¼€å‘å‘¨æœŸã€‚</li>
<li>æ€ä¹ˆå»å®ç°ä¸€ä¸ª stateful widget ã€‚</li>
<li>æ€ä¹ˆå»åˆ›å»ºä¸€ä¸ªæ— é™ï¼Œæ‡’åŠ è½½çš„åˆ—è¡¨ã€‚</li>
<li>æ€ä¹ˆå»åˆ›å»ºå’Œå¯¼èˆªåˆ°ç¬¬äºŒä¸ªé¡µé¢ã€‚</li>
<li>æ€ä¹ˆå»ä½¿ç”¨ Theme æ¥æ”¹å˜ app çš„å¤–è§‚ã€‚</li>
</ul>
<p><strong>ä½ å°†ä½¿ç”¨ä»€ä¹ˆ</strong></p>
<ul>
<li>Flutter SDKï¼šFlutter SDK åŒ…æ‹¬ Flutter çš„å¼•æ“ï¼Œframeworkï¼Œ widget ï¼Œå·¥å…·å’Œ Dart SDKã€‚è¿™ä¸ª codelab éœ€è¦ v0.1.4 æˆ–è€…æ›´æ–°ã€‚</li>
<li>Android Studio IDEï¼šè¿™ä¸ª codelab å…·å¤‡ Android Studio IDEï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶å®ƒçš„ IDEï¼Œæˆ–è€…ä½¿ç”¨å‘½ä»¤è¡Œå·¥ä½œã€‚</li>
<li>ä½ çš„ IDE æ’ä»¶ï¼šä½ çš„ IDE ä¸Šé¢å¿…é¡»åˆ†åˆ«å®‰è£… Flutter å’Œ Dart æ’ä»¶ã€‚é™¤äº† Android Studioï¼ŒFlutter å’Œ Dart æ’ä»¶åœ¨ <a href="https://code.visualstudio.com/download" target="_blank" rel="noopener">VS Code</a> å’Œ <a href="https://www.jetbrains.com/idea/download/#section=mac" target="_blank" rel="noopener">IntelliJ</a> IDEã€‚</li>
</ul>
<p>å…³äºæ€ä¹ˆæ­å»ºä½ çš„ç¯å¢ƒï¼Œå¯ä»¥åœ¨ <a href="https://flutter.io/get-started/install/" target="_blank" rel="noopener"></a> æŸ¥çœ‹æ›´å¤šä¿¡æ¯ã€‚</p>
<p><span id="step-1-create-the-starting-flutter-app"></span></p>
<h2 id="ç¬¬1æ­¥ï¼šåˆ›å»ºå¯åŠ¨-Flutter-app"><a href="#ç¬¬1æ­¥ï¼šåˆ›å»ºå¯åŠ¨-Flutter-app" class="headerlink" title="ç¬¬1æ­¥ï¼šåˆ›å»ºå¯åŠ¨ Flutter app"></a>ç¬¬1æ­¥ï¼šåˆ›å»ºå¯åŠ¨ Flutter app</h2><p>æ ¹æ® <a href="https://flutter.io/get-started/test-drive/#create-app" target="_blank" rel="noopener">å¼€å§‹ä½ çš„ç¬¬ä¸€ä¸ª Flutter app</a> çš„ä»‹ç»ï¼Œåˆ›å»ºä¸€ä¸ªç®€å•ï¼Œæ¨¡ç‰ˆçš„ Flutter appã€‚ç»™é¡¹ç›®å–åä¸º <strong>startup_namer</strong> (æ›¿æ¢æ‰ <em>myapp</em>)ã€‚æ‚¨å°†ä¿®æ”¹è¿™ä¸ª app æ¥åˆ›å»ºå®Œæˆçš„ appã€‚</p>
<p>åœ¨è¿™ä¸ª codelab ä¸­ï¼Œä½ ä¸»è¦ç¼–è¾‘ dart ä»£ç å­˜æ”¾å¤„çš„ <strong>lib/main.dart</strong>ã€‚</p>
<blockquote>
<p><strong>æç¤ºï¼š</strong>å½“å¤åˆ¶ä»£ç åˆ°ä½ çš„ app ä¸­ï¼Œç¼©è¿›å¯èƒ½ä¼šæ­ªæ–œã€‚ä½ å¯ä»¥ä½¿ç”¨ Flutter å·¥å…·æ¥è‡ªåŠ¨ä¿®æ­£å®ƒä»¬ï¼š</p>
<ul>
<li>Android Studio / IntelliJ IDEA: åœ¨ dart ä»£ç ä¸Šå³é”®å¹¶é€‰æ‹© <strong>Reformat Code with dartfmt</strong>ã€‚</li>
<li>VS Code: å³é”®å¹¶é€‰æ‹© <strong>Format Document</strong>ã€‚</li>
<li>Ternimal: è¿è¡Œ flutter format <filename>ã€‚</filename></li>
</ul>
</blockquote>
<ol>
<li><p>æ›¿æ¢ lib/main.dartã€‚</p>
<p> åˆ é™¤ <strong>lib/main.dart</strong> ä¸­çš„æ‰€æœ‰ä»£ç ã€‚ä½¿ç”¨ä¸‹é¢çš„ä»£ç è¿›è¡Œæ›¿æ¢ï¼Œå®ƒä¼šåœ¨å±å¹•çš„ä¸­å¤®å±•ç¤º â€œHello Worldâ€ã€‚</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() =&gt; runApp(<span class="keyword">new</span> MyApp());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Welcome to Flutter'</span>,</span><br><span class="line">      home: <span class="keyword">new</span> Scaffold(</span><br><span class="line">        appBar: <span class="keyword">new</span> AppBar(</span><br><span class="line">          title: <span class="keyword">new</span> Text(<span class="string">'Welcome to Flutter'</span>),</span><br><span class="line">        ),</span><br><span class="line">        body: <span class="keyword">new</span> Center(</span><br><span class="line">          child: <span class="keyword">new</span> Text(<span class="string">'Hello World'</span>),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¿è¡ŒAppï¼Œä½ å°†ä¼šçœ‹åˆ°å¦‚ä¸‹çš„å±å¹•</p>
</li>
</ol>
<div style="text-align: center;"><br><img src="https://flutter.io/get-started/codelab/images/hello-world-screenshot.png"><br></div>

<h3 id="è§‚å¯Ÿ"><a href="#è§‚å¯Ÿ" class="headerlink" title="è§‚å¯Ÿ"></a>è§‚å¯Ÿ</h3><ul>
<li>è¿™ä¸ªä¾‹å­åˆ›å»ºäº†ä¸€ä¸ª Material appã€‚<a href="https://material.io/guidelines/" target="_blank" rel="noopener">Material</a> æ˜¯æ‰‹æœºå’Œ web ä¸Šçš„æ ‡å‡†çš„è®¾è®¡è¯­è¨€ã€‚Flutter æä¾›äº†ä¸°å¯Œçš„ Material   widget ã€‚</li>
<li>main æ–¹æ³•åˆ¶å®šäº†ä¸€ä¸ªå®½ç®­å¤´ï¼ˆ<code>=&gt;</code>ï¼‰æ ‡å¿—ï¼Œè¿™æ˜¯ä¸€è¡Œå‡½æ•°æˆ–è€…æ–¹æ³•çš„ç®€å†™ã€‚</li>
<li>App ç»§æ‰¿äº† StatelessWidgetï¼Œè¿™ä½¿å¾— app æœ¬èº«ç§°ä¸ºäº†ä¸€ä¸ª widgetã€‚åœ¨ Flutter ä¸­ï¼Œå‡ ä¹æ‰€æœ‰ä¸€åˆ‡éƒ½æ˜¯ widgetï¼ŒåŒ…æ‹¬ alignment, padding, å’Œ layoutã€‚</li>
<li>Material åº“ä¸­çš„ Scaffoldï¼Œæä¾›äº†ä¸€ä¸ªé»˜è®¤çš„ app barï¼Œtitleï¼Œå’Œä¸€ä¸ª body å±æ€§ï¼Œå®ƒæŒæœ‰äº†ä¸»é¡µé¢çš„ widget æ ‘ã€‚widget çš„å­æ ‘å¯èƒ½ç›¸å½“å¤æ‚ã€‚</li>
<li>Widget çš„ä¸»è¦çš„å·¥ä½œæ˜¯æä¾›ä¸€ä¸ª <code>build()</code> æ–¹æ³•ï¼Œå®ƒæè¿°äº†å¦‚ä½•æ ¹æ®å…¶ä»–è¾ƒä½çº§åˆ«çš„ widget æ˜¾ç¤º widgetã€‚</li>
<li>è¿™ä¸ªä¾‹å­ä¸­çš„ widget æ ‘çš„æ„æˆæ˜¯ä¸€ä¸ªä¸­å¿ƒçš„ widget åŒ…å«äº†ä¸€ä¸ªæ–‡æœ¬çš„å­ child widgetã€‚ä¸­å¿ƒ widget å°†å®ƒçš„ widget å­æ ‘å¯¹é½åˆ°å±å¹•çš„ä¸­å¿ƒã€‚</li>
</ul>
<hr>
<p><span id="step-2-use-an-external-package"></span></p>
<h2 id="ç¬¬2æ­¥ï¼šä½¿ç”¨å¤–éƒ¨åŒ…"><a href="#ç¬¬2æ­¥ï¼šä½¿ç”¨å¤–éƒ¨åŒ…" class="headerlink" title="ç¬¬2æ­¥ï¼šä½¿ç”¨å¤–éƒ¨åŒ…"></a>ç¬¬2æ­¥ï¼šä½¿ç”¨å¤–éƒ¨åŒ…</h2><p>åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘å°†ä½¿ç”¨ä¸€ä¸ªåä¸º <strong>english_words</strong> çš„å¼€æºåŒ…ï¼Œå®ƒåŒ…å«äº†å‡ åƒä¸ªæœ€å¸¸ç”¨çš„è‹±æ–‡å•è¯å’Œå¸¸ç”¨çš„å·¥å…·æ–¹æ³•ã€‚</p>
<p>åœ¨ <a href="https://pub.dartlang.org/flutter/" target="_blank" rel="noopener">pub.dartlang.org</a>ï¼Œä½ å¯ä»¥æ‰¾åˆ° <a href="https://pub.dartlang.org/packages/english_words" target="_blank" rel="noopener">english_words</a>ï¼Œä»¥åŠå¾ˆå¤šå…¶å®ƒçš„å¼€æºåŒ…ã€‚</p>
<ol>
<li><p>pubspec æ–‡ä»¶ä¸º Flutter app ç®¡ç† assetsã€‚åœ¨ <strong>pubspec.yaml</strong>ï¼Œå¢åŠ  <strong>english_words</strong> (3.1.0æˆ–è€…æ›´é«˜) åˆ°ä¾èµ–åˆ—è¡¨ã€‚æ–°å¢è¡Œåœ¨ä¸‹é¢å·²è¢«é«˜äº®ï¼š</p>
 <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dependencies:</span></span><br><span class="line"><span class="attr">flutter:</span></span><br><span class="line"><span class="attr">sdk:</span> <span class="string">flutter</span></span><br><span class="line">    </span><br><span class="line"><span class="attr">cupertino_icons:</span> <span class="string">^0.1.0</span></span><br><span class="line"><span class="attr">english_words:</span> <span class="string">^3.1.0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ Android Studioâ€™s editor è§†å›¾æŸ¥çœ‹ pubspecï¼Œç‚¹å‡»å³ä¸Šè§’çš„ <strong>Packages get</strong>ã€‚è¿™ä¼šæŠŠåŒ…æ‹‰å–åˆ°ä½ çš„é¡¹ç›®ä¸­ã€‚ä½ ä¼šåœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flutter packages get</span><br><span class="line">Running &quot;flutter packages get&quot; in startup_namer...</span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ <strong>lib/main.dart</strong>ï¼Œå¢åŠ ä¸€ä¸ª <code>english_words</code> çš„å¯¼å…¥ï¼Œå°±å¦‚é«˜äº®å±•ç¤ºçš„é‚£æ ·ï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:english_words/english_words.dart'</span>;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>ç”±äºä½ çš„è¾“å…¥ï¼ŒAndroid Studio é’ˆå¯¹åº“ä¼šç»™ä½ ä¸€äº›å¯¼å…¥çš„å»ºè®®ã€‚ç„¶åå°†å¯¼å…¥å­—ç¬¦ä¸²å‘ˆç°ä¸ºç°è‰²ï¼Œè®©ä½ çŸ¥é“å€’å…¥çš„åº“ä½ æ²¡æœ‰ä½¿ç”¨å®ƒï¼ˆç›®å‰ä¸ºæ­¢ï¼‰ã€‚
</code></pre><ol>
<li><p>ä½¿ç”¨ English words åŒ…ç”Ÿæˆæ–‡æœ¬ï¼Œç”¨æ¥æ›¿æ¢æ‰ä¹‹å‰çš„ â€œHello Worldâ€ å­—ç¬¦ä¸²ã€‚</p>
<blockquote>
<p><strong>æç¤ºï¼š</strong>â€œPascal caseâ€ ï¼ˆä¹Ÿç§°ä¸º â€œå¤§é©¼å³°å¼å‘½åæ³•â€ï¼‰ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå•è¯ï¼ŒåŒ…æ‹¬ç¬¬ä¸€ä¸ªå•è¯ï¼Œé¦–å­—æ¯å¤§å†™ã€‚æ‰€ä»¥ï¼Œâ€œuppercamelcaseâ€ å°±å˜æˆ â€œUpperCamelCaseâ€ã€‚</p>
</blockquote>
<p> åšä»¥ä¸‹æ”¹å˜ï¼Œå¦‚ä¸‹é¢é«˜äº®å¤„ï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:english_words/english_words.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() =&gt; runApp(<span class="keyword">new</span> MyApp());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> wordPair = <span class="keyword">new</span> WordPair.random();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Welcome to Flutter'</span>,</span><br><span class="line">      home: <span class="keyword">new</span> Scaffold(</span><br><span class="line">        appBar: <span class="keyword">new</span> AppBar(</span><br><span class="line">          title: <span class="keyword">new</span> Text(<span class="string">'Welcome to Flutter'</span>),</span><br><span class="line">        ),</span><br><span class="line">        body: <span class="keyword">new</span> Center(</span><br><span class="line">          <span class="comment">//child: new Text('Hello World'), // Replace the highlighted text...</span></span><br><span class="line">          child: <span class="keyword">new</span> Text(wordPair.asPascalCase),  <span class="comment">// With this highlighted text.</span></span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li>å¦‚æœ app æ­£åœ¨è¿è¡Œä¸­ï¼Œä½¿ç”¨çƒ­é‡è½½æŒ‰é’®ï¼ˆ<img src="https://flutter.io/get-started/codelab/images/hot-reload-button.png" alt="">ï¼‰æ¥æ›´æ–°è¿è¡Œä¸­çš„ appã€‚æ¯ä¸€æ¬¡ä½ ç‚¹å‡»äº†çƒ­é‡è½½ï¼Œæˆ–è€…ä¿å­˜äº†é¡¹ç›®ï¼Œä½ å°†ä¼šçœ‹è§ä¸åŒçš„è¯å¯¹ï¼Œå®ƒåœ¨è¿è¡Œçš„ app ä¸­æ˜¯éšæœºçš„ã€‚è¿™æ˜¯å› ä¸ºè¯å¯¹åœ¨ build æ–¹æ³•ä¸­è¢«ç”Ÿæˆã€‚åœ¨æ¯æ¬¡ MaterialApp éœ€è¦æ¸²æŸ“æˆ–è€…åœ¨ Flutter Inspector ä¸­åˆ‡æ¢å¹³å°çš„æ—¶å€™ã€‚</li>
</ol>
<div style="text-align: center;"><br><img src="https://flutter.io/get-started/codelab/images/step2-screenshot.png"><br></div>

<h3 id="é—®é¢˜ï¼Ÿ"><a href="#é—®é¢˜ï¼Ÿ" class="headerlink" title="é—®é¢˜ï¼Ÿ"></a>é—®é¢˜ï¼Ÿ</h3><p>å¦‚æœä½ çš„ app æ²¡æœ‰æ­£ç¡®è¿è¡Œï¼Œæ’æŸ¥é”™è¯¯ã€‚å¦‚æœéœ€è¦ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é“¾æ¥çš„ä»£ç æ¥è¿½è¸ªã€‚</p>
<ul>
<li><a href="https://gist.githubusercontent.com/Sfshaza/bb51e3b7df4ebbf3dfd02a4a38db2655/raw/57c25b976ec34d56591cb898a3df0b320e903b99/pubspec.yaml" target="_blank" rel="noopener"><strong>pubspec.yaml</strong></a> (<strong>pubspec.yaml</strong> ä¸ä¼šå†æ¬¡ä¿®æ”¹äº†ã€‚)</li>
<li><a href="https://gist.githubusercontent.com/Sfshaza/bb51e3b7df4ebbf3dfd02a4a38db2655/raw/57c25b976ec34d56591cb898a3df0b320e903b99/main.dart" target="_blank" rel="noopener"><strong>lib/main.dart</strong></a></li>
</ul>
<hr>
<p><span id="step-3-add-a-stateful-widget"></span></p>
<h2 id="ç¬¬3æ­¥ï¼šå¢åŠ ä¸€ä¸ª-Stateful-widget"><a href="#ç¬¬3æ­¥ï¼šå¢åŠ ä¸€ä¸ª-Stateful-widget" class="headerlink" title="ç¬¬3æ­¥ï¼šå¢åŠ ä¸€ä¸ª Stateful widget"></a>ç¬¬3æ­¥ï¼šå¢åŠ ä¸€ä¸ª Stateful widget</h2><p>State<em>less</em> widget æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œæ„å‘³ç€å®ƒä»¬çš„å±æ€§ä¸èƒ½è¢«ä¿®æ”¹ â€”â€” æ‰€æœ‰å€¼éƒ½æ˜¯ final çš„ã€‚</p>
<p>State<em>ful</em> widgets ç»´æŠ¤äº†çŠ¶æ€ï¼Œå®ƒå¯èƒ½ä¼šåœ¨ widget çš„ç”Ÿå‘½å‘¨æœŸå†…è¢«ä¿®æ”¹ã€‚å®ç°ä¸€ä¸ª statful widget éœ€è¦ä¸¤ä¸ªç±»ï¼š1ï¼‰ä¸€ä¸ª StatefulWidget ç±»ï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ªå®ä¾‹ 2ï¼‰ä¸€ä¸ª State ç±»ã€‚StatefulWidget ç±»æœ¬èº«æ˜¯ä¸å¯å˜çš„ï¼Œä½† State ç±»åœ¨æ•´ä¸ª widget çš„ç”Ÿå‘½å‘¨æœŸä¸­ä¿æŒä¸å˜ã€‚</p>
<p>åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œä½ å°†ä¼šå¢åŠ ä¸€ä¸ª stateful widgetï¼ŒRandomWordsï¼Œå¢åŠ å®ƒçš„ State classï¼ŒRandomWordsStateã€‚State ç±»ä¸­å°†æœ€ç»ˆç»´æŠ¤è¿™ä¸ª widget ä¸­æ¨èå–œæ¬¢çš„è¯å¯¹ã€‚</p>
<ol>
<li><p>å¢åŠ   stateful RandomWords widget åˆ°ä½ çš„ main.dart ä¸­ã€‚å®ƒå¯ä»¥è¢«æ”¾åœ¨ä»»ä½•åœ°æ–¹ï¼Œç”šè‡³ MyApp ä¹‹å¤–ï¼Œä½†æ˜¯è¿™é‡Œçš„è§£å†³æ–¹æ¡ˆæ”¾åœ¨äº†æ–‡ä»¶çš„åº•éƒ¨ã€‚RandomWords widget é™¤äº†åˆ›å»ºå®ƒçš„ State ç±»æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ã€‚</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomWords</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  createState() =&gt; <span class="keyword">new</span> RandomWordsState();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¢åŠ  RandomWordsState ç±»ã€‚app çš„å¤§éƒ¨åˆ†ä»£ç å°†ä¼šå†™åœ¨è¿™ä¸ªç±»ä¸­ï¼Œå®ƒç»´æŠ¤æ‹‰è¿™ä¸ª widget ä¸­çš„ stateã€‚è¿™ä¸ªç±»ä¼šä¿å­˜ç”Ÿæˆçš„è¯å¯¹ï¼Œä¼šè¢«ç”¨æˆ·æ— é™æ»šåŠ¨ï¼Œç”¨æˆ·é€šè¿‡åˆ—è¡¨åˆ‡æ¢ä¸­çš„å¿ƒå›¾æ ‡æ¥æ·»åŠ æˆ–åˆ é™¤å®ƒä»¬ã€‚</p>
<p> ä½ å°†é€æ­¥ç¼–å†™è¿™ä¸ªç±»ã€‚ä½œä¸ºå¼€å§‹ï¼Œé€šè¿‡ä»¥ä¸‹é«˜äº®çš„æ–‡æœ¬æ¥åˆ›å»ºä¸€ä¸ªæœ€å°çš„ classï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomWordsState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">RandomWords</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨å¢åŠ äº† state class ä¹‹åï¼ŒIDE è­¦å‘Šè¿™ä¸ªç±»ç¼ºå°‘ä¸€ä¸ª build æ–¹æ³•ã€‚ç„¶åï¼Œä½ å°†å¢åŠ ä¸€ä¸ªåŸºæœ¬çš„ build æ–¹æ³•é€šè¿‡ä» MyApp è½¬ç§»ç”Ÿæˆè¯å¯¹çš„ä»£ç åˆ° RandomWordsState æ¥ç”Ÿæˆè¯å¯¹ï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomWordsState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">RandomWords</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> wordPair = <span class="keyword">new</span> WordPair.random();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Text(wordPair.asPascalCase);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>é€šè¿‡ä»¥ä¸‹é«˜äº®æ”¹å˜ï¼Œä» MyApp ä¸­ç§»é™¤ç”Ÿæˆè¯å¯¹çš„ä»£ç ï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> wordPair = <span class="keyword">new</span> WordPair.random();  <span class="comment">// Delete this line</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Welcome to Flutter'</span>,</span><br><span class="line">      home: <span class="keyword">new</span> Scaffold(</span><br><span class="line">        appBar: <span class="keyword">new</span> AppBar(</span><br><span class="line">          title: <span class="keyword">new</span> Text(<span class="string">'Welcome to Flutter'</span>),</span><br><span class="line">       ),</span><br><span class="line">        body: <span class="keyword">new</span> Center(</span><br><span class="line">          <span class="comment">//child: new Text(wordPair.asPascalCase), // Change the highlighted text to...</span></span><br><span class="line">          child: <span class="keyword">new</span> RandomWords(), <span class="comment">// ... this highlighted text</span></span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>é‡å¯ appï¼Œå¦‚æœä½ å°è¯•å»çƒ­é‡è½½ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸€ä¸ªè­¦å‘Šï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Reloading...</span><br><span class="line">Not all changed program elements ran during view reassembly; consider</span><br><span class="line">restarting.</span><br></pre></td></tr></table></figure>
<p>è¿™å¯èƒ½æ˜¯è¯¯æŠ¥ï¼Œä½†è€ƒè™‘é‡æ–°å¯åŠ¨ä»¥ç¡®ä¿ä½ çš„æ›´æ”¹åæ˜ åœ¨ app UI ä¸­ã€‚</p>
<p>app åº”è¯¥ä¼šè·Ÿä»¥å‰ä¸€æ ·ï¼Œæ¯æ¬¡ä½ çƒ­é‡è½½æˆ–è€…ä¿å­˜çš„æ—¶å€™å±•ç¤ºä¸€ä¸ªè¯å¯¹ã€‚</p>
<div style="text-align: center;"><br><img src="https://flutter.io/get-started/codelab/images/step3-screenshot.png"><br></div>

<h3 id="é—®é¢˜ï¼Ÿ-1"><a href="#é—®é¢˜ï¼Ÿ-1" class="headerlink" title="é—®é¢˜ï¼Ÿ"></a>é—®é¢˜ï¼Ÿ</h3><p>å¦‚æœä½ çš„ app æ²¡æœ‰æ­£ç¡®è¿è¡Œï¼Œæ’æŸ¥é”™è¯¯ã€‚å¦‚æœéœ€è¦ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é“¾æ¥çš„ä»£ç æ¥è¿½è¸ªã€‚</p>
<ul>
<li><a href="https://gist.githubusercontent.com/Sfshaza/d7f13ddd8888556232476be8578efe40/raw/329c397b97309ce99f834bf70ebb90778baa5cfe/main.dart" target="_blank" rel="noopener">lib/main.dart</a></li>
</ul>
<hr>
<p><span id="step-4-create-an-infinite-scrolling-listview"></span></p>
<h2 id="ç¬¬4æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ— é™æ»šåŠ¨çš„-ListView"><a href="#ç¬¬4æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ— é™æ»šåŠ¨çš„-ListView" class="headerlink" title="ç¬¬4æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ— é™æ»šåŠ¨çš„ ListView"></a>ç¬¬4æ­¥ï¼šåˆ›å»ºä¸€ä¸ªæ— é™æ»šåŠ¨çš„ ListView</h2><p>åœ¨è¿™ä¸€æ­¥ï¼Œä½ å°†æ‰©å±• RandomWordsState æ¥ç”Ÿæˆå’Œå±•ç¤ºä¸€ä¸ªåˆ—è¡¨çš„è¯å¯¹ã€‚å½“ç”¨æˆ·æ»šåŠ¨æ—¶ï¼Œå±•ç¤ºåœ¨ ListView widget çš„åˆ—è¡¨ä¼šæ— é™æ»šåŠ¨ã€‚ListView çš„ <code>builder</code> factory æ„é€ æ–¹æ³•å…è®¸ä½ æ ¹æ®éœ€è¦å®ç°æ‡’åŠ è½½ã€‚</p>
<ol>
<li><p>åœ¨ RandomWordsState ç±»ä¸­å¢åŠ ä¸€ä¸ª <code>_suggestions</code> list æ¥ä¿å­˜æ¨èçš„è¯å¯¹ã€‚æ³¨æ„å˜é‡ä»¥ä¸‹åˆ’çº¿ï¼ˆ<code>_</code>ï¼‰å¼€å¤´ã€‚åœ¨ Dart è¯­è¨€ä¸­ï¼Œä»¥ä¸‹åˆ’çº¿ä½œä¸ºå‰ç¼€æ ‡å¿—ä»£è¡¨ç§æœ‰ã€‚</p>
<p> ä¹Ÿå¢åŠ ä¸€ä¸ª <code>biggerFont</code> å˜é‡æ¥ä½¿å­—ä½“å˜å¤§ã€‚</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomWordsState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">RandomWords</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> _suggestions = &lt;WordPair&gt;[];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> _biggerFont = <span class="keyword">const</span> TextStyle(fontSize: <span class="number">18.0</span>);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ RandomWordsState ç±»ä¸­å¢åŠ ä¸€ä¸ª <code>_buildSuggestions()</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ„å»ºå±•ç¤ºè¯å¯¹çš„ ListViewã€‚</p>
<p> ListView ç±»æä¾›äº†ä¸€ä¸ª builder å±æ€§ï¼Œ<code>itemBuilder</code>ï¼Œä»¥åŒ¿åæ–¹æ³•çš„æ–¹å¼æŒ‡å®šä¸€ä¸ªå·¥å‚æ„é€ å™¨å’Œå›è°ƒæ–¹æ³•ã€‚ä¸¤ä¸ªå‚æ•°ä¼šè¢«ä¼ å…¥åˆ°æ–¹æ³•ä¸­ â€”â€” BuildContextï¼Œå’Œè¡Œè¿­ä»£å™¨ï¼Œ<code>i</code>ã€‚è¿­ä»£å™¨ä»0å¼€å§‹ï¼Œæ¯ä¸€æ¬¡æ–¹æ³•è¢«è°ƒç”¨æ—¶é€’å¢ï¼Œæ¯ä¸ªæ¨èè¯å¯¹é…å¯¹ä¸€æ¬¡ã€‚è¿™ä¸ªæ¨¡å‹å…è®¸åœ¨ç”¨æˆ·æ»šåŠ¨æ—¶æ¨èåˆ—è¡¨æ— é™æ»šåŠ¨ã€‚</p>
<p> å¢åŠ ä»¥ä¸‹é«˜äº®è¡Œï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomWordsState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">RandomWords</span>&gt; </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  Widget _buildSuggestions() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ListView.builder(</span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">16.0</span>),</span><br><span class="line">      <span class="comment">// The itemBuilder callback is called, once per suggested word pairing,</span></span><br><span class="line">      <span class="comment">// and places each suggestion into a ListTile row.</span></span><br><span class="line">      <span class="comment">// For even rows, the function adds a ListTile row for the word pairing.</span></span><br><span class="line">      <span class="comment">// For odd rows, the function adds a Divider widget to visually</span></span><br><span class="line">      <span class="comment">// separate the entries. Note that the divider may be difficult</span></span><br><span class="line">      <span class="comment">// to see on smaller devices.</span></span><br><span class="line">      itemBuilder: (context, i) &#123;</span><br><span class="line">        <span class="comment">// Add a one-pixel-high divider widget before each row in theListView.</span></span><br><span class="line">        <span class="keyword">if</span> (i.isOdd) <span class="keyword">return</span> <span class="keyword">new</span> Divider();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// The syntax "i ~/ 2" divides i by 2 and returns an integer result.</span></span><br><span class="line">        <span class="comment">// For example: 1, 2, 3, 4, 5 becomes 0, 1, 1, 2, 2.</span></span><br><span class="line">        <span class="comment">// This calculates the actual number of word pairings in the ListView,</span></span><br><span class="line">        <span class="comment">// minus the divider widgets.</span></span><br><span class="line">        <span class="keyword">final</span> index = i ~/ <span class="number">2</span>;</span><br><span class="line">        <span class="comment">// If you've reached the end of the available word pairings...</span></span><br><span class="line">        <span class="keyword">if</span> (index &gt;= _suggestions.length) &#123;</span><br><span class="line">          <span class="comment">// ...then generate 10 more and add them to the suggestions list.</span></span><br><span class="line">          _suggestions.addAll(generateWordPairs().take(<span class="number">10</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> _buildRow(_suggestions[index]);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>_buildSuggestions</code> æ–¹æ³•åœ¨æ¯ä¸ªè¯é…å¯¹æ—¶è°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•åœ¨ä¸€ä¸ª ListTile ä¸­å±•ç¤ºä¸€ä¸ªæ–°çš„é…å¯¹ï¼Œåœ¨ä¸‹ä¸€æ­¥ä¸­å®ƒå…è®¸ä½ åœ¨è¡Œä¸­å¢åŠ äº¤äº’ã€‚</p>
<p> åœ¨ <code>RandomWordsState</code> ä¸­å¢åŠ ä¸€ä¸ª <code>_buildRow</code> æ–¹æ³•ï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomWordsState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">RandomWords</span>&gt; </span>&#123;</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  Widget _buildRow(WordPair pair) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ListTile(</span><br><span class="line">      title: <span class="keyword">new</span> Text(</span><br><span class="line">        pair.asPascalCase,</span><br><span class="line">        style: _biggerFont,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ <code>_buildSuggestions()</code> æ¥æ›´æ–° RandomWordsState çš„ build æ–¹æ³•ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨ç”Ÿæˆè¯å¯¹çš„åº“ã€‚ä¿®æ”¹ä»¥ä¸‹é«˜äº®æ”¹å˜ï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomWordsState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">RandomWords</span>&gt; </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> wordPair = <span class="keyword">new</span> WordPair.random(); <span class="comment">// Delete these two lines.</span></span><br><span class="line">    Return <span class="keyword">new</span> Text(wordPair.asPascalCase);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Scaffold (</span><br><span class="line">      appBar: <span class="keyword">new</span> AppBar(</span><br><span class="line">        title: <span class="keyword">new</span> Text(<span class="string">'Startup Name Generator'</span>),</span><br><span class="line">      ),</span><br><span class="line">    body: _buildSuggestions(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ›´æ–° MyApp çš„ build æ–¹æ³•ã€‚åœ¨ MyApp ä¸­ç§»é™¤ Scaffold å’Œ AppBar å®ä¾‹ã€‚è¿™äº›åº”è¯¥ç”± RandomWordsState å»ç®¡ç†ï¼Œè¿™è®©åœ¨ä¸‹ä¸€æ­¥ä¸­å¯¼èˆªåˆ°å¦ä¸€ä¸ªé¡µé¢æ—¶ä¿®æ”¹ app bar çš„åå­—æ›´ç®€å•ã€‚</p>
<p> ç”¨ä¸‹é¢é«˜äº®çš„ build æ–¹æ³•æ›¿æ¢åŸç”Ÿçš„æ–¹æ³•ï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Startup Name Generator'</span>,</span><br><span class="line">      home: <span class="keyword">new</span> RandomWords(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>é‡å¯ appï¼Œä½ å°†çœ‹åˆ°ä¸€ä¸ªè¯å¯¹åˆ—è¡¨ã€‚æŒ‰ä½ æƒ³è¦çš„å»æ»šåŠ¨åˆ—è¡¨ï¼Œä½ ä¼šçœ‹åˆ°æ–°çš„è¯å¯¹ã€‚</p>
<div style="text-align: center;"><br><img src="https://flutter.io/get-started/codelab/images/step4-screenshot.png"><br></div>

<h3 id="é—®é¢˜ï¼Ÿ-2"><a href="#é—®é¢˜ï¼Ÿ-2" class="headerlink" title="é—®é¢˜ï¼Ÿ"></a>é—®é¢˜ï¼Ÿ</h3><p>å¦‚æœä½ çš„ app æ²¡æœ‰æ­£ç¡®è¿è¡Œï¼Œæ’æŸ¥é”™è¯¯ã€‚å¦‚æœéœ€è¦ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é“¾æ¥çš„ä»£ç æ¥è¿½è¸ªã€‚</p>
<ul>
<li><a href="https://gist.githubusercontent.com/Sfshaza/d7f13ddd8888556232476be8578efe40/raw/329c397b97309ce99f834bf70ebb90778baa5cfe/main.dart" target="_blank" rel="noopener">lib/main.dart</a></li>
</ul>
<hr>
<p><span id="step-5-add-interactivity"></span></p>
<h2 id="ç¬¬5æ­¥ï¼šå¢åŠ äº¤äº’"><a href="#ç¬¬5æ­¥ï¼šå¢åŠ äº¤äº’" class="headerlink" title="ç¬¬5æ­¥ï¼šå¢åŠ äº¤äº’"></a>ç¬¬5æ­¥ï¼šå¢åŠ äº¤äº’</h2><p>åœ¨è¿™ä¸€æ­¥ï¼Œä½ å°†åœ¨æ²¡è¡Œå¢åŠ ä¸€ä¸ªå¯ç‚¹å‡»çš„å¿ƒå‹å›¾æ ‡ã€‚å½“ç”¨æˆ·ç‚¹å‡» list ä¸­çš„æ¯è¡Œæ—¶ï¼Œåˆ‡æ¢å®ƒçš„ â€œå–œæ¬¢â€ çŠ¶æ€ï¼Œè¿™ä¼šè§¦å‘è¯å¯¹åœ¨ä¿å­˜çš„é›†åˆä¸­å¢åŠ æˆ–è€…åˆ é™¤ã€‚</p>
<ol>
<li><p>åœ¨ RandomWordsState ä¸­å¢åŠ ä¸€ä¸ª <code>_saved</code> é›†åˆã€‚è¿™ä¸ªé›†åˆå­˜å‚¨äº†ç”¨æˆ·å–œæ¬¢äº†çš„è¯å¯¹ã€‚é›†åˆé¦–é€‰ Listï¼Œå› ä¸ºæ­£ç¡®çš„å®ç°æ˜¯ Set ä¸å…è®¸é‡å¤çš„æ¡ç›®ã€‚</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomWordsState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">RandomWords</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> _suggestions = &lt;WordPair&gt;[];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> _saved = <span class="keyword">new</span> <span class="built_in">Set</span>&lt;WordPair&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> _biggerFont = <span class="keyword">const</span> TextStyle(fontSize: <span class="number">18.0</span>);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ <code>_buildRow</code> æ–¹æ³•ä¸­ï¼Œå¢åŠ ä¸€ä¸ª <code>alreadySaved</code> æ£€æŸ¥æ¥ç¡®ä¿è¯å¯¹æ˜¯å¦å·²ç»æ·»åŠ åˆ°å–œæ¬¢é›†åˆä¸­äº†ã€‚</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Widget _buildRow(WordPair pair) &#123;</span><br><span class="line">  <span class="keyword">final</span> alreadySaved = _saved.contains(pair);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ <code>_buildRow()</code>ï¼Œå¢åŠ ä¸€ä¸ªå¿ƒå‹çš„å›¾æ ‡åˆ° ListTile æ¥å¯ç”¨å–œæ¬¢çŠ¶æ€ã€‚ç¨åï¼Œä½ ä¼šåœ¨è¿™ä¸ªå¿ƒå‹å›¾æ ‡ä¸Šå¢åŠ ä¸€ä¸ªäº¤äº’ã€‚</p>
<p> å¢åŠ ä»¥ä¸‹é«˜äº®ï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Widget _buildRow(WordPair pair) &#123;</span><br><span class="line">  <span class="keyword">final</span> alreadySaved = _saved.contains(pair);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ListTile(</span><br><span class="line">    title: <span class="keyword">new</span> Text(</span><br><span class="line">      pair.asPascalCase,</span><br><span class="line">      style: _biggerFont,</span><br><span class="line">    ),</span><br><span class="line">    trailing: <span class="keyword">new</span> Icon(</span><br><span class="line">      alreadySaved ? Icons.favorite : Icons.favorite_border,</span><br><span class="line">      color: alreadySaved ? Colors.red : <span class="keyword">null</span>,</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>é‡å¯ appï¼Œç°åœ¨ä½ ä¼šçœ‹åˆ°æ¯è¡Œéƒ½æœ‰å¿ƒå‹å›¾æ ‡ï¼Œä½†æ˜¯å®ƒä»¬è¿˜ä¸èƒ½äº¤äº’ã€‚</p>
</li>
<li><p>åœ¨ <code>_buildRow</code> æ–¹æ³•ä¸­è®©å¿ƒå½¢å›¾æ ‡å¯ç‚¹å‡»ã€‚å¦‚æœä¸€ä¸ªè¯å¯¹å·²ç»è¢«æ·»åŠ åˆ°å–œæ¬¢é›†åˆï¼Œå†æ¬¡ç‚¹å‡»ä¼šä»å–œæ¬¢é›†åˆä¸­åˆ é™¤ã€‚å½“å¿ƒå½¢å›¾æ ‡è¢«ç‚¹å‡»ï¼Œè°ƒç”¨<code>setState()</code>æ–¹æ³•æ¥é€šçŸ¥ç³»ç»ŸçŠ¶æ€è¢«æ”¹å˜ã€‚</p>
<p> å¢åŠ é«˜äº®è¡Œï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Widget _buildRow(WordPair pair) &#123;</span><br><span class="line">  <span class="keyword">final</span> alreadySaved = _saved.contains(pair);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ListTile(</span><br><span class="line">    title: <span class="keyword">new</span> Text(</span><br><span class="line">      pair.asPascalCase,</span><br><span class="line">      style: _biggerFont,</span><br><span class="line">    ),</span><br><span class="line">    trailing: <span class="keyword">new</span> Icon(</span><br><span class="line">      alreadySaved ? Icons.favorite : Icons.favorite_border,</span><br><span class="line">      color: alreadySaved ? Colors.red : <span class="keyword">null</span>,</span><br><span class="line">    ),</span><br><span class="line">    onTap: () &#123;</span><br><span class="line">      setState(() &#123;</span><br><span class="line">        <span class="keyword">if</span> (alreadySaved) &#123;</span><br><span class="line">          _saved.remove(pair);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          _saved.add(pair);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p><strong>æç¤ºï¼š</strong>åœ¨ Flutter å“åº”å¼é£æ ¼æ¡†æ¶ä¸­ï¼Œè°ƒç”¨ <strong>setState()</strong> è§¦å‘ State å¯¹è±¡çš„ <strong>build()</strong> æ–¹æ³•çš„è°ƒç”¨ï¼Œç»“æœæ›´æ–°åœ¨ UI ä¸­ã€‚</p>
</blockquote>
<p>çƒ­é‡è½½ appï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°ç‚¹å‡»ä»»æ„è¡Œæ¥å–œæ¬¢ï¼Œå–æ¶ˆå–œæ¬¢æ¡ç›®ã€‚æ³¨æ„ï¼Œç‚¹å‡»ä¸€è¡Œä¼šç”Ÿæˆä»å¿ƒå‹å›¾æ ‡å‘å‡ºçš„éšå¼å¢¨è¿¹é£æº…åŠ¨ç”»ã€‚</p>
<div style="text-align: center;"><br><img src="https://flutter.io/get-started/codelab/images/step5-screenshot.png"><br></div>

<h3 id="é—®é¢˜ï¼Ÿ-3"><a href="#é—®é¢˜ï¼Ÿ-3" class="headerlink" title="é—®é¢˜ï¼Ÿ"></a>é—®é¢˜ï¼Ÿ</h3><p>å¦‚æœä½ çš„ app æ²¡æœ‰æ­£ç¡®è¿è¡Œï¼Œæ’æŸ¥é”™è¯¯ã€‚å¦‚æœéœ€è¦ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é“¾æ¥çš„ä»£ç æ¥è¿½è¸ªã€‚</p>
<ul>
<li><a href="https://gist.githubusercontent.com/Sfshaza/d7f13ddd8888556232476be8578efe40/raw/329c397b97309ce99f834bf70ebb90778baa5cfe/main.dart" target="_blank" rel="noopener">lib/main.dart</a></li>
</ul>
<hr>
<p><span id="step-6-navigate-to-a-new-screen"></span></p>
<h2 id="ç¬¬6æ­¥ï¼šå¯¼èˆªåˆ°æ–°çš„é¡µé¢"><a href="#ç¬¬6æ­¥ï¼šå¯¼èˆªåˆ°æ–°çš„é¡µé¢" class="headerlink" title="ç¬¬6æ­¥ï¼šå¯¼èˆªåˆ°æ–°çš„é¡µé¢"></a>ç¬¬6æ­¥ï¼šå¯¼èˆªåˆ°æ–°çš„é¡µé¢</h2><p>åœ¨è¿™ä¸€æ­¥ï¼Œä½ å°†å¢åŠ ä¸€ä¸ªæ–°çš„é¡µé¢ï¼ˆåœ¨ Flutter è¢«ç§°ä¸º <em>router</em>ï¼‰ç”¨æ¥å±•ç¤ºå–œæ¬¢çš„é›†åˆã€‚ä½ å°†ä¼šå­¦ä¹ åˆ°æ€ä¹ˆä»é¦–é¡µå¯¼èˆªåˆ°ä¸€ä¸ªæ–°çš„é¡µé¢ã€‚</p>
<p>åœ¨ Fluterï¼ŒNavigator ç®¡ç†åŒ…å«äº† app è·¯ç”±é¡µé¢çš„æ ˆã€‚å‹å…¥ä¸€ä¸ªé¡µé¢åˆ° Navigator çš„æ ˆï¼Œæ›´æ–°å±•ç¤ºé‚£ä¸ªé¡µé¢ã€‚ä» Navigator å¼¹å‡ºä¸€ä¸ªé¡µé¢ï¼Œè¿”å›å±•ç¤ºä¸Šä¸€ä¸ªé¡µé¢ã€‚</p>
<ol>
<li><p>åœ¨ RandomWordsState çš„ build æ–¹æ³•ä¸­å¢åŠ ä¸€ä¸ªåˆ—è¡¨å›¾æ ‡åˆ° AppBar ä¸Šã€‚å½“ç”¨æˆ·ç‚¹å‡»è¿™ä¸ªåˆ—è¡¨å›¾æ ‡ï¼Œä¸€ä¸ªåŒ…å«äº†å–œæ¬¢çš„æ¡ç›®çš„æ–°é¡µé¢è¢«å‹å…¥åˆ° Navigatorï¼Œå±•ç¤ºå›¾æ ‡ã€‚</p>
<blockquote>
<p><strong>æç¤ºï¼š</strong>ä¸€äº›widgetå±æ€§æ¥æ”¶å•ä¸ª widgetï¼ˆ<strong>child</strong>ï¼‰ï¼Œå…¶å®ƒçš„å±æ€§ï¼Œå¦‚ <strong>action</strong>ï¼Œæ¥æ”¶ä¸€ä¸ªæ•°ç»„ widgetsï¼ˆ<strong>children</strong>ï¼‰ï¼Œé€šè¿‡ä¸­æ‹¬å·ï¼ˆ[]ï¼‰æ ‡æ˜ã€‚</p>
</blockquote>
<p> åœ¨ build æ–¹æ³•ä¸­å¢åŠ å›¾æ ‡å’Œå®ƒå¯¹åº”çš„ actionï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomWordsState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">RandomWords</span>&gt; </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Scaffold(</span><br><span class="line">      appBar: <span class="keyword">new</span> AppBar(</span><br><span class="line">        title: <span class="keyword">new</span> Text(<span class="string">'Startup Name Generator'</span>),</span><br><span class="line">        actions: &lt;Widget&gt;[</span><br><span class="line">          <span class="keyword">new</span> IconButton(icon: <span class="keyword">new</span> Icon(Icons.list), onPressed: _pushSaved),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">      body: _buildSuggestions(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ RandomWordsState ç±»ä¸­å¢åŠ ä¸€ä¸ª <code>_pushSaved()</code> æ–¹æ³•ã€‚</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomWordsState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">RandomWords</span>&gt; </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">void</span> _pushSaved() &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> çƒ­é‡è½½ appï¼Œåˆ—è¡¨å›¾æ ‡å‡ºç°åœ¨ app bar ä¸Šã€‚ç‚¹å‡»å®ƒè¿˜ä¸ä¼šå‘ç”Ÿä»»ä½•äº‹æƒ…ï¼Œå› ä¸º <code>_pushSaved</code> æ–¹æ³•æ˜¯ç©ºçš„ã€‚</p>
</li>
<li><p>å½“ç”¨æˆ·ç‚¹å‡» app bar ä¸Šçš„åˆ—è¡¨å›¾æ ‡ï¼Œæ„å»ºä¸€ä¸ªé¡µé¢å¹¶å‹å…¥ Navigator çš„æ ˆä¸­ã€‚è¿™ä¸ª action ä¼šæ”¹å˜å±å¹•å»å±•ç¤ºæ–°çš„é¡µé¢ã€‚</p>
<p> æ–°é¡µé¢çš„å†…å®¹åœ¨ MaterialPageRoute çš„ <code>builder</code> å±æ€§ä¸­é€šè¿‡åŒ¿åæ–¹æ³•æ„å»ºã€‚</p>
<p> å¢åŠ è°ƒç”¨ <code>Navigator.push</code>ï¼Œå¦‚ä¸‹é«˜äº®ä»£ç å±•ç¤ºï¼ŒæŠŠé¡µé¢å‹å…¥åˆ° Navigator çš„æ ˆé‡Œã€‚</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> _pushSaved() &#123;</span><br><span class="line">  Navigator.of(context).push(</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¢åŠ  MaterialPageRoute å’Œå®ƒçš„ builderã€‚ç°åœ¨ï¼Œå¢åŠ ç”Ÿæˆ ListTile è¡Œçš„ä»£ç ã€‚ListTile çš„ <code>divideTiles()</code> æ–¹æ³•åœ¨æ¯ä¸ª ListTile ä¹‹é—´æ·»åŠ æ°´å¹³é—´è·ã€‚åˆ†å‰²å˜é‡ä¿å­˜æœ€åä¸€è¡Œï¼Œç”± convienice å‡½æ•° <code>toList()</code> è½¬æ¢ä¸ºåˆ—è¡¨ã€‚</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> _pushSaved() &#123;</span><br><span class="line">  Navigator.of(context).push(</span><br><span class="line">    <span class="keyword">new</span> MaterialPageRoute(</span><br><span class="line">      builder: (context) &#123;</span><br><span class="line">        <span class="keyword">final</span> tiles = _saved.map(</span><br><span class="line">              (pair) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ListTile(</span><br><span class="line">              title: <span class="keyword">new</span> Text(</span><br><span class="line">                pair.asPascalCase,</span><br><span class="line">                style: _biggerFont,</span><br><span class="line">              ),</span><br><span class="line">            );</span><br><span class="line">          &#125;,</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">final</span> divided = ListTile</span><br><span class="line">            .divideTiles(</span><br><span class="line">          context: context,</span><br><span class="line">          tiles: tiles,</span><br><span class="line">        )</span><br><span class="line">            .toList();</span><br><span class="line">      &#125;,</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>builder å±æ€§è¿”å›ä¸€ä¸ª Scaffoldï¼ŒåŒ…å«äº†æ–°é¡µé¢çš„ app barï¼Œåä¸º â€œSave Suggestionsâ€ã€‚æ–°é¡µé¢ body çš„æ„æˆæ˜¯ä¸€ä¸ª ListView åŒ…å«äº† ListTiles è¡Œï¼›æ¯è¡Œç”±åˆ†éš”ç¬¦åˆ†å‰²ã€‚</p>
<p> å¢åŠ ä»¥ä¸‹é«˜äº®ä»£ç ï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> _pushSaved() &#123;</span><br><span class="line">  Navigator.of(context).push(</span><br><span class="line">    <span class="keyword">new</span> MaterialPageRoute(</span><br><span class="line">      builder: (context) &#123;</span><br><span class="line">        <span class="keyword">final</span> tiles = _saved.map(</span><br><span class="line">              (pair) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ListTile(</span><br><span class="line">              title: <span class="keyword">new</span> Text(</span><br><span class="line">                pair.asPascalCase,</span><br><span class="line">                style: _biggerFont,</span><br><span class="line">              ),</span><br><span class="line">            );</span><br><span class="line">          &#125;,</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">final</span> divided = ListTile</span><br><span class="line">            .divideTiles(</span><br><span class="line">          context: context,</span><br><span class="line">          tiles: tiles,</span><br><span class="line">        )</span><br><span class="line">            .toList();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Scaffold(</span><br><span class="line">          appBar: <span class="keyword">new</span> AppBar(</span><br><span class="line">            title: <span class="keyword">new</span> Text(<span class="string">'Saved Suggestions'</span>),</span><br><span class="line">          ),</span><br><span class="line">          body: <span class="keyword">new</span> ListView(children: divided),</span><br><span class="line">        );</span><br><span class="line">      &#125;,</span><br><span class="line">    ),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>çƒ­é‡è½½ appï¼Œå–œæ¬¢å…¶ä¸­çš„ä¸€äº›æ¡ç›®å¹¶ç‚¹å‡» app bar ä¸Šçš„åˆ—è¡¨å›¾æ ‡ã€‚æ–°é¡µé¢å±•ç¤ºå‡ºæ¥ï¼Œä¸”åŒ…å«äº†å–œæ¬¢çš„æ¡ç›®ã€‚æ³¨æ„ Navigator åœ¨ app bar ä¸Šå¢åŠ äº†ä¸€ä¸ª â€œBackâ€ æŒ‰é’®ã€‚ä½ ä¸éœ€è¦æ˜ç¡®åœ°å®ç° Navigator.popã€‚ç‚¹å‡»è¿”å›æŒ‰é’®æ¥è¿”å›é¦–é¡µã€‚</p>
 <div style="text-align: center;"><br> <img src="https://flutter.io/get-started/codelab/images/step6a-screenshot.png"><br> <img src="https://flutter.io/get-started/codelab/images/step6b-screenshot.png"><br> </div>

</li>
</ol>
<h3 id="é—®é¢˜ï¼Ÿ-4"><a href="#é—®é¢˜ï¼Ÿ-4" class="headerlink" title="é—®é¢˜ï¼Ÿ"></a>é—®é¢˜ï¼Ÿ</h3><p>å¦‚æœä½ çš„ app æ²¡æœ‰æ­£ç¡®è¿è¡Œï¼Œæ’æŸ¥é”™è¯¯ã€‚å¦‚æœéœ€è¦ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é“¾æ¥çš„ä»£ç æ¥è¿½è¸ªã€‚</p>
<ul>
<li><a href="https://gist.githubusercontent.com/Sfshaza/d7f13ddd8888556232476be8578efe40/raw/329c397b97309ce99f834bf70ebb90778baa5cfe/main.dart" target="_blank" rel="noopener">lib/main.dart</a></li>
</ul>
<hr>
<p><span id="step-7-change-the-ui-using-themes"></span></p>
<h2 id="ç¬¬7æ­¥ï¼šä½¿ç”¨-Theme-æ¥æ”¹å˜-UI"><a href="#ç¬¬7æ­¥ï¼šä½¿ç”¨-Theme-æ¥æ”¹å˜-UI" class="headerlink" title="ç¬¬7æ­¥ï¼šä½¿ç”¨ Theme æ¥æ”¹å˜ UI"></a>ç¬¬7æ­¥ï¼šä½¿ç”¨ Theme æ¥æ”¹å˜ UI</h2><p>åœ¨è¿™ä¸€æ­¥ï¼Œä½ å°†ç©è½¬ app çš„ themeã€‚<strong>Theme</strong>ä¼šæ§åˆ¶ä½ çš„ app çš„è§†è§‰å’Œæ„Ÿè§‰ã€‚ä½ å¯ä»¥ä½¿ç”¨é»˜è®¤çš„ themeï¼Œè¿™ä¾èµ–äºç‰©ç†è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨ï¼Œæˆ–è€…ä½ å¯ä»¥è‡ªå®šä¹‰ theme æ¥åæ˜ å‡ºä½ çš„å“ç‰Œã€‚</p>
<ol>
<li><p>ä½ å¯ä»¥å¾ˆç®€å•åœ°é€šè¿‡é…ç½® ThemeData ç±»æ¥æ”¹å˜ app çš„ä¸»é¢˜ã€‚ä½ çš„ appå½“å‰ä½¿ç”¨çš„æ˜¯é»˜è®¤çš„ä¸»é¢˜ï¼Œä½†æ˜¯ä½ å°†ä¿®æ”¹ä¸»è¦é¢œè‰²ä¸ºç™½è‰²ã€‚</p>
<p> é€šè¿‡å¢åŠ é«˜äº®çš„ä»£ç åˆ° MyApop æ¥æ”¹å˜ app çš„ä¸»é¢˜ä¸ºç™½è‰²ï¼š</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Startup Name Generator'</span>,</span><br><span class="line">      theme: <span class="keyword">new</span> ThemeData(</span><br><span class="line">        primaryColor: Colors.white,</span><br><span class="line">      ),</span><br><span class="line">      home: <span class="keyword">new</span> RandomWords(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>çƒ­é‡è½½ appï¼Œæ³¨æ„ï¼Œæ•´ä¸ªèƒŒæ™¯éƒ½æ˜¯ç™½è‰²çš„ï¼Œç”šè‡³æ˜¯ app barã€‚</p>
</li>
<li><p>ä½œä¸ºè¯»è€…çš„è”ç³»ï¼Œä½¿ç”¨ <a href="https://docs.flutter.io/flutter/material/ThemeData-class.html" target="_blank" rel="noopener">ThemeData</a> æ¥æ”¹å˜ UI çš„å…¶å®ƒæ–¹é¢ã€‚Material åº“ä¸­çš„ <a href="https://docs.flutter.io/flutter/material/Colors-class.html" target="_blank" rel="noopener">Colors</a> ç±»æä¾›äº†å¾ˆå¤šé¢œè‰²å¸¸é‡å¯ä»¥ä½¿ç”¨ï¼Œç„¶åçƒ­é‡è½½ä½¿å¾— UI å®éªŒå˜çš„åˆå¿«åˆç®€å•ã€‚</p>
 <div style="text-align: center;"><br> <img src="https://flutter.io/get-started/codelab/images/step7-themes.png"><br> </div>

</li>
</ol>
<h3 id="é—®é¢˜ï¼Ÿ-5"><a href="#é—®é¢˜ï¼Ÿ-5" class="headerlink" title="é—®é¢˜ï¼Ÿ"></a>é—®é¢˜ï¼Ÿ</h3><p>å¦‚æœä½ çš„ app æ²¡æœ‰æ­£ç¡®è¿è¡Œï¼Œæ’æŸ¥é”™è¯¯ã€‚å¦‚æœéœ€è¦ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é“¾æ¥çš„ä»£ç æ¥è¿½è¸ªã€‚</p>
<ul>
<li><a href="https://gist.githubusercontent.com/Sfshaza/d7f13ddd8888556232476be8578efe40/raw/329c397b97309ce99f834bf70ebb90778baa5cfe/main.dart" target="_blank" rel="noopener">lib/main.dart</a></li>
</ul>
<hr>
<p><span id="well-done"></span></p>
<h2 id="å¹²å¾—ä¸é”™"><a href="#å¹²å¾—ä¸é”™" class="headerlink" title="å¹²å¾—ä¸é”™"></a>å¹²å¾—ä¸é”™</h2><p>ä½ å·²å†™äº†ä¸€ä¸ªè¿è¡Œåœ¨ iOS å’Œ Android çš„å…·æœ‰äº¤äº’æ€§çš„ Flutter appã€‚åœ¨è¿™ä¸ª codelabï¼Œä½ å·²ç»ï¼š</p>
<ul>
<li>ä»å¤´åˆ›å»ºäº†ä¸€ä¸ª Flutter appã€‚</li>
<li>ç¼–å†™ Dart ä»£ç ã€‚</li>
<li>ä½¿ç”¨å¤–éƒ¨ç¬¬ä¸‰æ–¹åº“ã€‚</li>
<li>ä½¿ç”¨çƒ­é‡è½½æ¥è¿›è¡Œå¿«é€Ÿçš„å¼€å‘å‘¨æœŸã€‚</li>
<li>å®ç°äº† stateful widgetï¼Œç»™ä½ çš„ app å¢åŠ äº†äº’åŠ¨æ€§ã€‚</li>
<li>ä½¿ç”¨ ListView å’Œ ListTiles åˆ›å»ºäº†ä¸€ä¸ªæ‡’åŠ è½½ï¼Œæ— é™æ»šåŠ¨çš„åˆ—è¡¨ã€‚</li>
<li>åˆ›å»ºäº†ä¸€ä¸ªé¡µé¢ï¼Œä¸”å¢åŠ äº†åœ¨ä¸»é¡µå’Œæ–°çš„é¡µé¢ä¹‹å‰ç§»åŠ¨çš„é€»è¾‘ã€‚</li>
<li>å­¦ä¹ æ”¹å˜ app ä¸»é¢˜å¤–è§‚å’Œä¸»é¢˜</li>
</ul>
]]></content>
      
        <categories>
            
            <category> flutter </category>
            
            <category> dart </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> flutter </tag>
            
            <tag> ios </tag>
            
            <tag> dart </tag>
            
            <tag> widget </tag>
            
            <tag> fuchsia </tag>
            
            <tag> Google </tag>
            
            <tag> codelab </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åœ¨Androidä¸Šç¼–å†™æ¨¡å—åŒ–é¡¹ç›®ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2018/02/13/writing_a_modular_project_on_android/</url>
      <content type="html"><![CDATA[<blockquote>
<p>åŸæ–‡ï¼š<a href="https://medium.com/mindorks/writing-a-modular-project-on-android-304f3b09cb37" target="_blank" rel="noopener">https://medium.com/mindorks/writing-a-modular-project-on-android-304f3b09cb37</a></p>
</blockquote>
<h1 id="åœ¨Androidä¸Šç¼–å†™æ¨¡å—åŒ–é¡¹ç›®ï¼ˆç¿»è¯‘ï¼‰"><a href="#åœ¨Androidä¸Šç¼–å†™æ¨¡å—åŒ–é¡¹ç›®ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="åœ¨Androidä¸Šç¼–å†™æ¨¡å—åŒ–é¡¹ç›®ï¼ˆç¿»è¯‘ï¼‰"></a>åœ¨Androidä¸Šç¼–å†™æ¨¡å—åŒ–é¡¹ç›®ï¼ˆç¿»è¯‘ï¼‰</h1><p>å½“æˆ‘ä»¬åœ¨ Android Studio ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®æ—¶ï¼Œè‡ªå¸¦ä¸€ä¸ª <code>app</code> moduleã€‚è¿™æ—¶æˆ‘ä»¬å¤§å¤šæ•°äººç¼–å†™æ•´ä¸ªåº”ç”¨çš„åœ°æ–¹ã€‚æ¯æ¬¡ç‚¹å‡» <code>run</code> æŒ‰é’®éƒ½ä¼šè§¦å‘æˆ‘ä»¬æ•´ä¸ªæ‰€æœ‰ module ä¸Šçš„ gradle æ„å»ºï¼Œå¹¶æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶æ˜¯å¦æœ‰å˜åŒ–ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ gradle æ„å»ºä¼šåœ¨æ›´å¤§çš„åº”ç”¨ç¨‹åºä¸ŠèŠ±è´¹ <a href="https://eng.uber.com/android-monorepo/" target="_blank" rel="noopener">10åˆ†é’Ÿ</a>çš„æ—¶é—´ï¼Œå¹¶ä¸”å‡æ…¢å¼€å‘è€…çš„<a href="https://imgs.xkcd.com/comics/compiling.png" target="_blank" rel="noopener">è¾“å‡º</a>ã€‚</p>
<p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¤æ‚çš„åº”ç”¨ç¨‹åºï¼Œå¦‚ Uber å†³å®šå¯¹å®ƒä»¬çš„åº”ç”¨ç¨‹åºè¿›è¡Œæ¨¡å—åŒ–å¹¶ä»ä¸­<a href="https://www.youtube.com/watch?v=j6CiHlapado" target="_blank" rel="noopener">è·å¾—</a>äº†å¾ˆå¤šã€‚ä¸‹é¢æ˜¯è¯•ç”¨æ¨¡å—åŒ–é¡¹ç›®çš„ä¸€äº›ä¼˜åŠ¿ï¼š</p>
<a id="more"></a>
<ul>
<li><a href="https://proandroiddev.com/modular-architecture-for-faster-build-time-d58397cb7bfe" target="_blank" rel="noopener">æ›´å¿«</a>çš„ gradle æ„å»º</li>
<li>è·¨åº”ç”¨/æ¨¡å—å¤ç”¨é€šç”¨çš„åŠŸèƒ½</li>
<li>æ˜“äºæ’æ‹”åˆ°<a href="https://developer.android.com/topic/instant-apps/overview.html#features" target="_blank" rel="noopener">Instant apps</a></li>
<li>æ›´å¥½çš„å›¢é˜Ÿå·¥ä½œï¼Œä¸€ä¸ªäººå¯ä»¥å•ç‹¬è´Ÿè´£ä¸€ä¸ªæ¨¡å—</li>
<li>æ›´æµç•…åœ°git flows</li>
</ul>
<p>ç”±äºä¸Šè¿°ä¼˜åŠ¿ï¼Œå½“æˆ‘åˆšå¼€å§‹<a href="https://github.com/karntrehan/Posts/" target="_blank" rel="noopener">Posts</a>è¿™ä¸ªåº”ç”¨æ—¶ï¼Œæˆ‘å°±åœ¨å§‹ç»ˆåšæŒä½¿ç”¨æ¨¡å—åŒ–æ–¹æ³•ã€‚å¯¹æ­¤ï¼ŒAndroid å›¢é˜Ÿå·²ç»ç»™æˆ‘ä»¬æä¾›äº†ä¸€äº›<a href="https://developer.android.com/google/play/publishing/multiple-apks.html#CreatingApks" target="_blank" rel="noopener">å·¥å…·</a>ï¼Œä½†æ˜¯æˆ‘ç¡®å®é‡åˆ°äº†ä¸€äº›éšœç¢ï¼Œä¸€ä¸‹æ˜¯æˆ‘å­¦ä¹ åˆ°çš„å†…å®¹ï¼š</p>
<h2 id="æˆ‘è¯¥æ€ä¹ˆåˆ†å‰²æˆ‘çš„-modules-ï¼Ÿ"><a href="#æˆ‘è¯¥æ€ä¹ˆåˆ†å‰²æˆ‘çš„-modules-ï¼Ÿ" class="headerlink" title="æˆ‘è¯¥æ€ä¹ˆåˆ†å‰²æˆ‘çš„ modules ï¼Ÿ"></a>æˆ‘è¯¥æ€ä¹ˆåˆ†å‰²æˆ‘çš„ modules ï¼Ÿ</h2><p>ä½ çš„åº”ç”¨ç¨‹åºæ˜¯æµç¨‹é›†æ„æˆçš„ï¼Œæ¯”å¦‚ï¼ŒGoogle Play æœ‰<strong>åº”ç”¨è¯¦æƒ…</strong>æµï¼Œå®ƒåŒ…å«äº†ç®€è¦ï¼Œæè¿°è¯¦æƒ…ï¼Œåº”ç”¨æˆªå›¾ï¼Œè¯„è®ºæ´»åŠ¨ç­‰ã€‚</p>
<p><img src="https://user-images.githubusercontent.com/5423194/36140651-ed8f0d6c-10dc-11e8-9733-e306fd72f9d0.jpeg" alt=""></p>
<p>æ‰€æœ‰è¿™äº›éƒ½å¯ä»¥å½’ä¸ºåŒä¸€æ¨¡å— â€”â€” <code>app-details</code>ã€‚</p>
<p>ä½ çš„åº”ç”¨ä¼šåŒ…å«å¤šä¸ªç±»ä¼¼æµç¨‹çš„æ¨¡å—ï¼Œæœ‰ <code>authentication</code>, <code>settings</code>, <code>on-boarding</code>ç­‰ç­‰ã€‚å½“ç„¶è¿˜æœ‰ä¸€äº›ä¸éœ€è¦UIå…ƒç´ å‘ˆç°çš„æ¨¡å—å¦‚ â€”â€” <code>notifications</code>, <code>analytics</code>, <code>first-fetch</code>ç­‰ç­‰ã€‚è¿™äº›æ¨¡å—åŒ…å«ä¸æµç¨‹æœ‰å…³çš„ activities, repositories, entitieså’Œä¾èµ–æ³¨å…¥ç›¸å…³ä¸œè¥¿ã€‚</p>
<div style="text-align: center;"><br><img src="https://user-images.githubusercontent.com/5423194/36140945-09253f5a-10de-11e8-8ded-003e53fd78b6.png"><br></div>

<p>ä½†æ˜¯è¿™äº›æ¨¡å—ä¸­æ€»æ˜¯æœ‰ä¸€äº›å…±åŒçš„åŠŸèƒ½å’Œå·¥å…·ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ éœ€è¦ä¸€ä¸ª core æ¨¡å—ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯-core-æ¨¡å—-ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-core-æ¨¡å—-ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ core æ¨¡å— ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ core æ¨¡å— ï¼Ÿ</h2><p><code>Core</code> æ¨¡å—æ˜¯ä¸€ä¸ªä½ é¡¹ç›®ä¸­ç®€å•çš„ module åº“ã€‚core åº“å¯ä»¥ï¼ˆé™¤å…¶å®ƒå¤–ï¼‰ï¼Œ</p>
<ul>
<li>ç»™ä½ çš„ä¾èµ–æ³¨å…¥æ¡†æ¶æä¾›å…¨å±€ä¾èµ–ï¼Œå¦‚ <a href="https://github.com/karntrehan/Posts/blob/master/core/src/main/java/com/karntrehan/posts/core/di/NetworkModule.kt" target="_blank" rel="noopener">Retrofit</a>, <a href="https://github.com/karntrehan/Posts/blob/master/core/src/main/java/com/karntrehan/posts/core/di/StorageModule.kt" target="_blank" rel="noopener">SharedPreferences</a>ç­‰ç­‰ã€‚</li>
<li>åŒ…å«å·¥å…·ç±»å’Œ<a href="https://github.com/karntrehan/Posts/tree/master/core/src/main/java/com/karntrehan/posts/core/extensions" target="_blank" rel="noopener">æ‰©å±•æ–¹æ³•</a></li>
<li>åŒ…å«<a href="https://github.com/karntrehan/Posts/blob/master/core/src/main/java/com/karntrehan/posts/core/networking/Outcome.kt" target="_blank" rel="noopener">å…¨å±€ç±»</a>å’Œå›è°ƒ</li>
<li>åœ¨ application ç±»ä¸­çš„<a href="https://github.com/karntrehan/Posts/blob/master/core/src/main/java/com/karntrehan/posts/core/application/CoreApp.kt" target="_blank" rel="noopener">åˆå§‹åŒ–åº“</a>ï¼Œå¦‚ Firebase Analyticsï¼ŒCrashlyticsï¼ŒLeakCanaryï¼ŒStethoç­‰ç­‰</li>
</ul>
<h2 id="æ€ä¹ˆä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Ÿ"><a href="#æ€ä¹ˆä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Ÿ" class="headerlink" title="æ€ä¹ˆä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Ÿ"></a>æ€ä¹ˆä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Ÿ</h2><p>æ ¸å¿ƒ(<code>core</code>)æ¨¡å—çš„å…¶ä¸­ä¸€ä¸ªèŒè´£æ˜¯ä¸ºä½ çš„åŠŸèƒ½(<code>feature</code>)æ¨¡å—æä¾›å¤–éƒ¨ä¾èµ–ã€‚è¿™ä½¿å¾—å¾ˆå®¹æ˜“å®ç°åœ¨ä½ çš„ <code>feature</code> æ¨¡å—ä¸­å…±äº«ç›¸åŒç‰ˆæœ¬çš„åº“ã€‚åªéœ€è¦åœ¨ä½ çš„ <code>core</code> æ¨¡å—çš„ dependencies ä¸­ä½¿ç”¨ <code>api</code>ï¼Œè¿™æ ·ä½ å°±èƒ½åœ¨æ‰€æœ‰ <code>feature</code> æ¨¡å—ä¸­ä½¿ç”¨å®ƒä»¬ã€‚</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    api fileTree(<span class="string">include:</span> [<span class="string">'*.jar'</span>], <span class="string">dir:</span> <span class="string">'libs'</span>)</span><br><span class="line">    api deps.support.appCompat</span><br><span class="line">    api deps.support.recyclerView</span><br><span class="line">    api deps.support.cardView</span><br><span class="line">    api deps.support.support</span><br><span class="line">    api deps.support.designSupport</span><br><span class="line"></span><br><span class="line">    api deps.android.lifecycleExt</span><br><span class="line">    api deps.android.lifecycleCommon</span><br><span class="line">    api deps.android.roomRuntime</span><br><span class="line">    api deps.android.roomRx</span><br><span class="line"></span><br><span class="line">    api deps.kotlin.stdlib</span><br><span class="line"></span><br><span class="line">    api deps.reactivex.rxJava</span><br><span class="line">    api deps.reactivex.rxAndroid</span><br><span class="line"></span><br><span class="line">    api deps.google.dagger</span><br><span class="line">    kapt deps.google.daggerProcessor</span><br><span class="line"></span><br><span class="line">    api deps.square.picasso</span><br><span class="line">    api deps.square.okhttpDownloader</span><br><span class="line"></span><br><span class="line">    api deps.square.retrofit</span><br><span class="line">    api deps.square.okhttp</span><br><span class="line">    api deps.square.gsonConverter</span><br><span class="line">    api deps.square.retrofitRxAdapter</span><br><span class="line"></span><br><span class="line">    implementation deps.facebook.stetho</span><br><span class="line">    implementation deps.facebook.networkInterceptor</span><br><span class="line"></span><br><span class="line">    testApi deps.test.junit</span><br><span class="line">    androidTestApi deps.test.testRunner</span><br><span class="line">    androidTestApi deps.test.espressoCore</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰ç§ä¾èµ–çš„å¯èƒ½æ€§æ˜¯åªæœ‰å¯¹ <code>feature-a</code> æ¨¡å—æœ‰ç”¨ï¼Œä½†æ˜¯åœ¨ <code>feature-b</code> ä¸­æ— ç”¨ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘æ¨èåœ¨ä½ çš„ core çš„ä¾èµ–ä¸­ä½¿ç”¨ <code>api</code>ï¼Œå› ä¸º proguard æ³¨æ„åˆ°è€Œä¸ä¼šåŒ…å«åœ¨ <code>feature-b</code> instant app ä¸­ã€‚</p>
<h2 id="æ€ä¹ˆä½¿ç”¨-Room-ï¼Ÿ"><a href="#æ€ä¹ˆä½¿ç”¨-Room-ï¼Ÿ" class="headerlink" title="æ€ä¹ˆä½¿ç”¨ Room ï¼Ÿ"></a>æ€ä¹ˆä½¿ç”¨ Room ï¼Ÿ</h2><p>è¿™ä¸ªå›°æ‰°æˆ‘æŒºä¹…çš„æ—¶é—´ã€‚æˆ‘ä»¬å¸Œæœ›æŠŠæˆ‘ä»¬çš„æ•°æ®åº“å®šä¹‰åˆ° <code>core</code> æ¨¡å—ä¸­ï¼Œå› ä¸ºå®ƒæ˜¯æˆ‘ä»¬åº”ç”¨ç¨‹åºè¦å…±äº«çš„é€šç”¨çš„åŠŸèƒ½ã€‚ä¸ºäº†è®© Room å·¥ä½œï¼Œä½ éœ€è¦ä¸€ä¸ªåŒ…å«äº†æ‰€æœ‰ entity ç±»çš„æ•°æ®åº“æ–‡ä»¶ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Database(entities = [Post::class, User::class, Comment::class], version = 1,exportSchema = false)</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PostDb</span> : <span class="type">RoomDatabase</span></span>() &#123;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">postDao</span><span class="params">()</span></span>: PostDao</span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">userDao</span><span class="params">()</span></span>: UserDao</span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">commentDao</span><span class="params">()</span></span>: CommentDao</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œå¦‚ä¸Šé¢æåˆ°çš„ï¼Œæˆ‘ä»¬çš„ entity ç±»æ˜¯è¢«å®šä¹‰åœ¨ <code>feature</code> æ¨¡å—ä¸­ï¼Œè€Œä¸” <code>core</code> æ¨¡å—ä¸èƒ½å»è®¿é—®å®ƒä»¬ã€‚è¿™æ˜¯æˆ‘ç¢°åˆ°éšœç¢çš„åœ°æ–¹ï¼Œç»è¿‡ä¸€ç•ªæ€è€ƒåï¼Œä½ åšäº†ä¸€ä»¶æœ€æ£’çš„äº‹ï¼Œå¯»æ±‚ <a href="https://github.com/yigit" target="_blank" rel="noopener">Yigit</a> çš„å¸®åŠ©ã€‚</p>
<p>Yigit é˜æ˜äº†è§‚ç‚¹ï¼Œä½ å¿…é¡»è¦åœ¨æ¯ä¸ª <code>feature</code>æ¨¡å—ä¸­éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„ db æ–‡ä»¶ï¼Œç„¶åæ¯ä¸ªæ¨¡å—ä¸€ä¸ªæ•°æ®åº“ã€‚</p>
<p>è¿™æœ‰å‡ ä¸ªå¥½å¤„ï¼š</p>
<ul>
<li><a href="https://medium.com/google-developers/understanding-migrations-with-room-f01e04b07929" target="_blank" rel="noopener">è¿ç§»</a>æ˜¯æ¨¡å—åŒ–çš„</li>
<li>å³æ—¶ app ä»…åŒ…å«å®ƒä»¬éœ€è¦çš„è¡¨</li>
<li>æŸ¥è¯¢ä¼šæ›´å¿«</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>è·¨æ¨¡å—æ•°æ®å…³ç³»å°†ä¸å¯èƒ½</li>
</ul>
<p><em>æ³¨æ„ï¼šä¸ºäº† Room çš„æ³¨è§£èƒ½å¤Ÿå·¥ä½œï¼Œä¸è¦å¿˜è®°åœ¨ä½ çš„ <code>feature</code> æ¨¡å—ä¸­å¢åŠ ä¸‹é¢ä¾èµ–</em></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kapt <span class="string">"android.arch.persistence.room:compiler:$&#123;versions.room&#125;"</span></span><br></pre></td></tr></table></figure>
<h2 id="æ€ä¹ˆä½¿ç”¨-Dagger-2-ï¼Ÿ"><a href="#æ€ä¹ˆä½¿ç”¨-Dagger-2-ï¼Ÿ" class="headerlink" title="æ€ä¹ˆä½¿ç”¨ Dagger 2 ï¼Ÿ"></a>æ€ä¹ˆä½¿ç”¨ Dagger 2 ï¼Ÿ</h2><p>åŒæ ·çš„é—®é¢˜ Dagger ä¹Ÿé‡åˆ°äº†ã€‚æˆ‘çš„ core æ¨¡å—ä¸­çš„ application ç±»ä¸èƒ½è®¿é—®å’Œåˆå§‹åŒ–æˆ‘ <code>feature</code> æ¨¡å—ä¸­çš„ç»„ä»¶ã€‚è¿™æ˜¯ä»å±ç»„ä»¶å®Œç¾çš„ç”¨ä¾‹ã€‚</p>
<p>ä½ çš„ core ç»„ä»¶å®šä¹‰äº†å®ƒæƒ³è¦æš´éœ²ç»™ä¾èµ–ç»„ä»¶çš„ä¾èµ–å…³ç³»</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Component(modules = [AppModule::class, NetworkModule::class, StorageModule::class, ImageModule::class])</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">CoreComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">context</span><span class="params">()</span></span>: Context</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">retrofit</span><span class="params">()</span></span>: Retrofit</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">picasso</span><span class="params">()</span></span>: Picasso</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">sharedPreferences</span><span class="params">()</span></span>: SharedPreferences</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">scheduler</span><span class="params">()</span></span>: Scheduler</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‚¨çš„æ¨¡å—ç»„ä»¶å°† <code>CoreComponent</code> å®šä¹‰ä¸ºä¾èµ–é¡¹ï¼Œå¹¶ä½¿ç”¨ä¼ é€’çš„ä¾èµ–</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ListScope</span></span><br><span class="line"><span class="meta">@Component(dependencies = [CoreComponent::class], modules = [ListModule::class])</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ListComponent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">inject</span><span class="params">(listActivity: <span class="type">ListActivity</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="meta">@ListScope</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListModule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Uses parent's provided dependencies like Picasso, Context and Retrofit*/</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="meta">@ListScope</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">adapter</span><span class="params">(picasso: <span class="type">Picasso</span>)</span></span>: ListAdapter = ListAdapter(picasso)</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="meta">@ListScope</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">postDb</span><span class="params">(context: <span class="type">Context</span>)</span></span>: PostDb = Room.databaseBuilder(context, PostDb::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>, <span class="type">Constants.Posts.DB_NAME).build</span></span>()</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="meta">@ListScope</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">postService</span><span class="params">(retrofit: <span class="type">Retrofit</span>)</span></span>: PostService = retrofit.create(PostService::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åœ¨å“ªé‡Œåˆå§‹åŒ–æˆ‘çš„-components-ï¼Ÿ"><a href="#åœ¨å“ªé‡Œåˆå§‹åŒ–æˆ‘çš„-components-ï¼Ÿ" class="headerlink" title="åœ¨å“ªé‡Œåˆå§‹åŒ–æˆ‘çš„ components ï¼Ÿ"></a>åœ¨å“ªé‡Œåˆå§‹åŒ–æˆ‘çš„ components ï¼Ÿ</h2><p>æˆ‘ä¸ºæˆ‘çš„åŠŸèƒ½çš„æ‰€æœ‰ç»„ä»¶åˆ›å»ºäº†ä¸€ä¸ªå•ä¾‹ holderã€‚è¿™ä¸ª holder ç”¨äºåˆ›å»ºï¼Œç»´æŠ¤å’Œé”€æ¯æˆ‘çš„ component å®ä¾‹ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="keyword">object</span> PostDH &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> listComponent: ListComponent? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">listComponent</span><span class="params">()</span></span>: ListComponent &#123;</span><br><span class="line">        <span class="keyword">if</span> (listComponent == <span class="literal">null</span>)</span><br><span class="line">            listComponent = DaggerListComponent.builder().coreComponent(CoreApp.coreComponent).build()</span><br><span class="line">        <span class="keyword">return</span> listComponent <span class="keyword">as</span> ListComponent</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">destroyListComponent</span><span class="params">()</span></span> &#123;</span><br><span class="line">        listComponent = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>æ³¨æ„ï¼šä¸ºäº† Dagger çš„æ³¨è§£èƒ½å¤Ÿå·¥ä½œï¼Œä¸è¦å¿˜è®°åœ¨ä½ çš„ <code>feature</code> æ¨¡å—ä¸­å¢åŠ ä¸‹é¢ä¾èµ–</em></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kapt <span class="string">"com.google.dagger:dagger-compiler:$&#123;versions.dagger&#125;"</span></span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å°½ç®¡æŠŠä½ çš„å•ç‹¬çš„ application è½¬æˆæ¨¡å—åŒ–æœ‰ä¸€äº›æ£˜æ‰‹ï¼Œå…¶ä¸­ä¸€äº›æˆ‘è¯•å›¾é€šè¿‡ä¸Šé¢çš„æ–¹æ³•æ¥è§£å†³ï¼Œä¼˜ç‚¹æ˜¯æ·±åˆ»çš„ã€‚å¦‚æœæ‚¨åœ¨æ¨¡å—ä¸­é‡åˆ°ä»»ä½•éšœç¢ï¼Œè¯·éšæ—¶åœ¨ä¸‹é¢æåŠå®ƒä»¬ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·è®¨è®ºè§£å†³æ–¹æ¡ˆã€‚</p>
<p>è°¢è°¢ã€‚</p>
]]></content>
      
        <categories>
            
            <category> android </category>
            
            <category> gradle plugin </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> dagger2 </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> framework </tag>
            
            <tag> architecture </tag>
            
            <tag> modular </tag>
            
            <tag> room </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidç«¯ç”ŸæˆMETA-INFä¿¡æ¯æ–‡ä»¶çš„Gradleæ’ä»¶ RapidMetaInfPlugin]]></title>
      <url>/2018/02/05/Android%E7%AB%AF%E7%94%9F%E6%88%90META-INF%E4%BF%A1%E6%81%AF%E6%96%87%E4%BB%B6%E7%9A%84Gradle%E6%8F%92%E4%BB%B6%20RapidMetaInfPlugin/</url>
      <content type="html"><![CDATA[<h1 id="Androidç«¯ç”ŸæˆMETA-INFä¿¡æ¯æ–‡ä»¶çš„Gradleæ’ä»¶-RapidMetaInfPlugin"><a href="#Androidç«¯ç”ŸæˆMETA-INFä¿¡æ¯æ–‡ä»¶çš„Gradleæ’ä»¶-RapidMetaInfPlugin" class="headerlink" title="Androidç«¯ç”ŸæˆMETA-INFä¿¡æ¯æ–‡ä»¶çš„Gradleæ’ä»¶ RapidMetaInfPlugin"></a>Androidç«¯ç”ŸæˆMETA-INFä¿¡æ¯æ–‡ä»¶çš„Gradleæ’ä»¶ RapidMetaInfPlugin</h1><h2 id="1-éœ€æ±‚èƒŒæ™¯"><a href="#1-éœ€æ±‚èƒŒæ™¯" class="headerlink" title="1. éœ€æ±‚èƒŒæ™¯"></a>1. éœ€æ±‚èƒŒæ™¯</h2><p>æœ€è¿‘æ–°é‡åˆ°äº†ä¸€ä¸ªéœ€æ±‚ï¼Œæƒ³åœ¨è‡ªå·±çš„ä¸€äº›åº“ä¸­å†™å…¥ç‰ˆæœ¬ä¿¡æ¯ï¼Œåœ¨åˆ«äººä½¿ç”¨äº†æˆ‘çš„åº“åï¼Œæˆ‘å¯ä»¥é€šè¿‡apkæ–‡ä»¶æ£€æµ‹å‡ºä¾èµ–äº†æˆ‘çš„å“ªä¸ªç‰ˆæœ¬çš„åº“ã€‚æ„Ÿè§‰è¿™ä¸ªéœ€æ±‚æœ‰ç‚¹å¤šä½™ï¼Ÿé‚£å°±ä¸¾ä¸ªä¾‹å­å§ã€‚</p>
<p>æ¯”å¦‚ï¼Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªå¼€æºåº“ï¼š<a href="https://github.com/wangjiegulu/RapidORM" target="_blank" rel="noopener">RapidORM</a>ï¼Œå¹¶<a href="http://blog.wangjiegulu.com/2015/04/02/Android-%E4%BD%BF%E7%94%A8Gradle%E6%8F%90%E4%BA%A4%E8%87%AA%E5%B7%B1%E5%BC%80%E6%BA%90Android%E5%BA%93%E5%88%B0Maven%E4%B8%AD%E5%BF%83%E5%BA%93/">ä¸Šä¼ åˆ°äº†Mavenä¸­å¿ƒåº“</a> ï¼Œå‡è®¾ä¸€ä¸ªæˆ‘ä¸è®¤è¯†çš„å¼€å‘è€…ï¼ˆæš‚ä¸”ç§°å®ƒä¸º<code>X</code>ï¼‰åœ¨ç¼–å†™appï¼Œè¿™ä¸ªappä¸­çš„ä»£ç å¯¹æˆ‘æ¥è¯´æ˜¯å®Œå…¨æœªçŸ¥çš„ï¼Œä½†æ˜¯ä»–é€šè¿‡åœ¨<code>build.gradle</code>ä¸­æ·»åŠ äº†å¦‚ä¸‹ä¾èµ–ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">compile <span class="string">"com.github.wangjiegulu:rapidorm:1.0.0"</span></span><br><span class="line">compile <span class="string">"com.github.wangjiegulu:rapidorm-api:1.0.0"</span></span><br><span class="line">apt <span class="string">"com.github.wangjiegulu:rapidorm-compiler:1.0.0"</span></span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾ï¼Œ<code>X</code>ä¾èµ–äº†æˆ‘å†™çš„<code>RapidORM</code>åº“ã€‚å¹¶ä¸”æ‰“åŒ…æˆäº†Apkæ–‡ä»¶ç„¶åå‘å¸ƒã€‚è¿™æ—¶æˆ‘ä¸‹è½½äº†è¿™ä¸ªapkï¼Œå¹¶ä¸”å¸Œæœ›å¾—åˆ°è¿™ä¸ªapkä¸­ä¾èµ–çš„<code>RapidORM</code>ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿè¿™ä¸ª<code>RapidORM</code>åœ¨æ„å»ºè¿™ä¸ªaaræ—¶çš„å¼€å‘ç¯å¢ƒæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿåç¼–è¯‘å¯èƒ½æœ‰å¸Œæœ›èƒ½æ‹¿åˆ°<code>RapidORM</code>å…·ä½“çš„ç‰ˆæœ¬å·ï¼Œä½†æ˜¯aarå½“æ—¶çš„æ„å»ºç¯å¢ƒå°±æ— æ³•å¾—çŸ¥äº†ã€‚</p>
<p>è¿™æ—¶ï¼Œæˆ‘å°±å¸Œæœ›åœ¨æˆ‘å‘å¸ƒ<code>RapidORM</code>çš„Releaseç‰ˆæœ¬çš„æ—¶å€™èƒ½å¤Ÿåœ¨aarä¸­æºå¸¦å¥½ä¸€äº›è‡ªå®šä¹‰çš„å‚æ•°ï¼Œå¹¶ä¸”è¿™äº›ä¿¡æ¯ä¼šåœ¨ä¾èµ–äº†è¿™ä¸ªåº“çš„å¼€å‘è€…<code>X</code>æ„å»ºapkçš„æ—¶å€™è·Ÿéšä¿å­˜åˆ°apkæ–‡ä»¶ä¸­ã€‚</p>
<p>æ¯”è¾ƒå…¸å‹çš„ä¸€ä¸ªä¾‹å­å½“ä½ ä¾èµ–äº†<code>RxJava</code>è¿™ä¸ªåº“ï¼Œæˆ‘ä»¬æ„å»ºapkå®Œæˆä¹‹åï¼Œä¼šå‘ç°åœ¨æˆ‘ä»¬çš„apkæ–‡ä»¶ä¸­çš„<code>META-INF</code>æ–‡ä»¶å¤¹ä¸‹é¢ä¼šæœ‰ä¸€ä¸ª<code>rxjava.properties</code>æ–‡ä»¶ï¼Œæ‰“å¼€è¿™ä¸ªæ–‡ä»¶å°±ä¼šå‘ç°å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Manifest-Version=1.0</span><br><span class="line">Implementation-Title=io.reactivex.rxjava2#rxjava;2.1.2</span><br><span class="line">Implementation-Version=2.1.2</span><br><span class="line">Built-Status=integration</span><br><span class="line">Built-By=travis</span><br><span class="line">Built-OS=Linux</span><br><span class="line">Build-Date=2017-07-23_08:21:58</span><br><span class="line">Gradle-Version=2.14</span><br><span class="line">Module-Owner=benjchristensen@netflix.com</span><br><span class="line">Module-Email=benjchristensen@netflix.com</span><br><span class="line">Module-Source=</span><br><span class="line">Module-Origin=https://github.com/ReactiveX/RxJava.git</span><br><span class="line">Change=e4fbe4c</span><br><span class="line">Branch=e4fbe4cfcb3c240d14a42a586eecbbd74cb379d2</span><br><span class="line">Build-Host=testing-gce-361876de-b66f-4569-b841-e037b0fee9af</span><br><span class="line">Build-Job=LOCAL</span><br><span class="line">Build-Number=LOCAL</span><br><span class="line">Build-Id=LOCAL</span><br><span class="line">Created-By=1.7.0_80-b15 (Oracle Corporation)</span><br><span class="line">Build-Java-Version=1.7.0_80</span><br><span class="line">X-Compile-Target-JDK=1.6</span><br><span class="line">X-Compile-Source-JDK=1.6</span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­åŒ…å«äº†ï¼š<code>RxJavaç‰ˆæœ¬å·</code>, <code>æ„å»ºçš„CIä¿¡æ¯</code>ï¼Œ<code>æ„å»ºæ—¶é—´</code>, <code>Gradleç‰ˆæœ¬</code>, <code>æ¨¡å—è´Ÿè´£äººä¿¡æ¯</code>, <code>gitåˆ†æ”¯</code>, <code>JDKç‰ˆæœ¬</code>ç­‰ç­‰ã€‚</p>
<p>é€šè¿‡è¿™ä¸ªæ–¹å¼ï¼Œæˆ‘å¯ä»¥åœ¨ä»»æ„çš„apkä¸­æ‹¿åˆ°å®ƒä¾èµ–çš„<code>RxJava</code>çš„ä¿¡æ¯ã€‚</p>
<p>å½“ç„¶ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨<code>build.gradle</code>è¿›è¡Œå¦‚ä¸‹é…ç½®æ¥è¿‡æ’é™¤è¿™ä¸ª<code>rxjava.properties</code>æ–‡ä»¶ï¼ˆä½†æ˜¯ä¸å»ºè®®è¿™ä¹ˆåšï¼Œè¿™ä¸ªæ–‡ä»¶ä¹Ÿè®¸èƒ½åœ¨ä½ é‡åˆ°é—®é¢˜æ—¶ç»™ä½ å¸®åŠ©ï¼‰ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    packagingOptions &#123;</span><br><span class="line">        exclude <span class="string">'META-INF/rxjava.properties'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-RapidMetaInfPlugin-Gradle-æ’ä»¶"><a href="#2-RapidMetaInfPlugin-Gradle-æ’ä»¶" class="headerlink" title="2. RapidMetaInfPlugin Gradle æ’ä»¶"></a>2. RapidMetaInfPlugin Gradle æ’ä»¶</h2><blockquote>
<p><strong>RapidMetaInfPlugin:</strong> <a href="https://github.com/wangjiegulu/RapidMetaInfPlugin" target="_blank" rel="noopener">https://github.com/wangjiegulu/RapidMetaInfPlugin</a></p>
</blockquote>
<p>å› æ­¤ï¼Œå†™äº† <a href="https://github.com/wangjiegulu/RapidMetaInfPlugin" target="_blank" rel="noopener">RapidMetaInfPlugin</a> è¿™ä¸ª Gradle æ’ä»¶ã€‚</p>
<p>è¿™æ¬¡å…ˆè¯´è¯´æ€ä¹ˆä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼Œä»¥åæŠ½æ—¶é—´å†å†™ä¸€ç¯‡ Gradle æ’ä»¶ç¼–å†™æ•™ç¨‹ã€‚ä¹‹å‰ä¹Ÿå†™è¿‡ä¸€ä¸ªGradleæ’ä»¶ï¼ˆè¯¦æƒ…è§<a href="http://blog.wangjiegulu.com/2017/04/19/Android-Gradle-%E6%8F%92%E4%BB%B6-DiscardFilePlugin%EF%BC%88class%E6%B3%A8%E5%85%A5-%E6%B8%85%E7%A9%BA%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95%EF%BC%89/">Android Gradle æ’ä»¶ DiscardFilePluginï¼ˆæ¸…ç©ºç±»å’Œæ–¹æ³•ï¼‰</a>ï¼‰ä¹ŸæŒºå®ç”¨çš„ã€‚</p>
<h3 id="2-1-æœ€ç»ˆæ•ˆæœ"><a href="#2-1-æœ€ç»ˆæ•ˆæœ" class="headerlink" title="2.1 æœ€ç»ˆæ•ˆæœ"></a>2.1 æœ€ç»ˆæ•ˆæœ</h3><p>é€šè¿‡è¿™ä¸ªæ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>apk</code>æˆ–è€…<code>aar</code>ï¼ˆ<code>app</code>ä¾èµ–ååˆå¹¶åˆ°<code>apk</code>ï¼‰ä¸­å†™å…¥ä»»æ„ä¿¡æ¯ã€‚</p>
<p><img src="https://github.com/wangjiegulu/RapidMetaInfPlugin/raw/master/images/apk_meta_inf.png" width="600px"></p>
<p>ä»¥ä¸Šåœ¨è¿™ä¸ª<code>apk</code>çš„<code>META-INF</code>ä¸­ç”Ÿæˆäº†ä¸€ä¸ªåä¸º<code>DAL_REQUEST.properties</code>çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸­åŒ…å«äº†<code>dal_request</code>è¿™ä¸ªåº“çš„åå­—ã€ç‰ˆæœ¬å·å’Œurlã€‚</p>
<h3 id="2-2-å¦‚ä½•ä½¿ç”¨"><a href="#2-2-å¦‚ä½•ä½¿ç”¨" class="headerlink" title="2.2 å¦‚ä½•ä½¿ç”¨"></a>2.2 å¦‚ä½•ä½¿ç”¨</h3><p>åœ¨ä½ çš„<code>buildscript</code>çš„<code>dependencies</code>ä¸­æ·»åŠ <code>classpath</code>ä¾èµ–ï¼ˆ<a href="http://search.maven.org/#search%7Cga%7C1%7CRapidMetaInf" target="_blank" rel="noopener">ç‚¹å‡»è¿™é‡Œè·å–æœ€æ–°ç‰ˆæœ¬</a>ï¼‰ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">        google()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        classpath (<span class="string">'com.github.wangjiegulu:rapidmetainf:x.x.x'</span>)&#123;</span><br><span class="line">            exclude <span class="string">group:</span> <span class="string">'com.android.tools.build'</span>, <span class="string">module:</span> <span class="string">'gradle'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨ä½ çš„apkæˆ–è€…aarçš„<code>build.gradle</code>æ–‡ä»¶çš„é¡¶éƒ¨å†™å…¥ä»¥ä¸‹ä»£ç æ¥ä½¿ç”¨æ’ä»¶ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.github.wangjiegulu.plg.rapidmetainf'</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åé€šè¿‡å¦‚ä¸‹æ–¹å¼å¡«å†™ä½ éœ€è¦å†™è¿›<code>META-INF</code>ç›®å½•ä¸­çš„æ–‡ä»¶ä¿¡æ¯ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rapidmetainf &#123;</span><br><span class="line">    metaInfName <span class="string">'DAL_REQUEST.properties'</span></span><br><span class="line">    metaInfProperties <span class="string">"archiveName=$dbarchiveName"</span>,</span><br><span class="line">            <span class="string">"archiveVersion=$dbarchiveVersion"</span>,</span><br><span class="line">            <span class="string">"archiveUrl=$dbarchiveUrl"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šï¼Œ<code>metaInfName</code>è¡¨ç¤ºåœ¨<code>META-INF</code>ç›®å½•ä¸­ç”Ÿæˆçš„æ–‡ä»¶åç§°ï¼ˆæ–‡ä»¶åä»»æ„å–ï¼Œä½†æ˜¯ä¸èƒ½ä»¥â€.â€å¼€å¤´ï¼‰ï¼Œ<code>metaInfProperties</code>è¡¨ç¤ºè¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ï¼Œè¿™ä¸ªå˜é‡ä¸ºæ•°ç»„ç±»å‹ï¼Œå¯é€šè¿‡Groovyè¯­æ³•æ¥ç¼–å†™ï¼Œæ¯”å¦‚é€šè¿‡<code>$ç¬¦å·æ¥å¼•ç”¨ext</code>ï¼Œé€šè¿‡å¦‚ä¸‹å‘½ä»¤å‚æ•°çš„æ–¹å¼ç­‰ç­‰ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">rapidmetainf &#123;</span><br><span class="line">    metaInfName <span class="string">'DAL_REQUEST_DEMO.properties'</span></span><br><span class="line"></span><br><span class="line">    String[] infArray = <span class="keyword">new</span> String[<span class="number">10</span>]</span><br><span class="line">    <span class="comment">// ./gradlew clean build -PcommandKey=commandValue</span></span><br><span class="line">    infArray[<span class="number">0</span>] = <span class="string">"propertyFromCommand=$&#123;getParameter('commandKey')&#125;"</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; infArray.length; i++)&#123;</span><br><span class="line">        infArray[i] = <span class="string">"array_item_key_$i=array_item_value_$i"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    metaInfProperties infArray</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> getParameter(String key) &#123;</span><br><span class="line">    <span class="comment">// -D</span></span><br><span class="line">    String value = System.getProperty(key)</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">null</span> != value &amp;&amp; value.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// -P</span></span><br><span class="line">    <span class="keyword">if</span> (hasProperty(key)) &#123;</span><br><span class="line">        <span class="keyword">return</span> getProperty(key)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šï¼ŒCIæ„å»ºæ—¶å°±å¯ä½¿ç”¨å‘½ä»¤<code>./gradlew clean build -PcommandKey=commandValue</code>æ¥æŠŠ<code>commandValue</code>å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚</p>
]]></content>
      
        <categories>
            
            <category> android </category>
            
            <category> gradle plugin </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> gradle </tag>
            
            <tag> gradle plugin </tag>
            
            <tag> Android Studio </tag>
            
            <tag> META-INF </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[IFCTTï¼Œå³If Copy Then Thatï¼Œä¸€ä¸ªåŸºäºIFTTTçš„`This`å®ç°]]></title>
      <url>/2017/12/20/Android-App-IFCTT%EF%BC%8C%E5%8D%B3If-Copy-Then-That%EF%BC%8C%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8EIFTTT%E7%9A%84-This-%E5%AE%9E%E7%8E%B0/</url>
      <content type="html"><![CDATA[<p>IFCTTï¼Œå³ï¼š<code>If Copy Then That</code>ï¼Œæ˜¯ä¸€ä¸ªåŸºäºIFTTTï¼ˆ<code>If This Then That</code>ï¼‰çš„â€Thisâ€å®ç°ï¼Œå®ƒæ‰“é€šäº†â€ç”¨æˆ·æ‰‹æœºç«¯æ“ä½œâ€ä¸â€Thisæ¡ä»¶è§¦å‘â€ä¹‹é—´çš„æ¡¥æ¢ï¼Œè®©è¿™ä¸ªè¿‡ç¨‹æ›´å…·æ–¹ä¾¿æ€§å’Œå¿«æ·æ€§ã€‚é€šè¿‡æ‰‹æœºç«¯çš„CopyåŠ¨ä½œï¼Œä»¥â€Tagged Emailâ€çš„æ–¹å¼è¿æ¥åˆ°IFTTTï¼Œä»è€Œè§¦å‘IFTTTä¸­æ‰€æœ‰æ”¯æŒçš„â€Thatâ€è¡Œä¸ºã€‚ç”¨æˆ·åªéœ€è¦å¤åˆ¶ç„¶åé€‰æ‹©è§¦å‘IFTTTçš„â€Hash Tagâ€å³å¯ï¼Œå®ƒæ”¯æŒç”¨æˆ·é…ç½®å¤šç§â€Hash Tagâ€æ¥è¿›è¡Œå¤šç§è‡ªå®šä¹‰æ–¹å¼å†…å®¹ä¼ è¾“ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>æ‰‹æœºç«¯æ‰§è¡Œæ‹·è´Urlåœ°å€ï¼ˆéšæ—¶éšåœ°ï¼Œä»»ä½•åœ°æ–¹ï¼Œå¦‚Twitter/Facebook/Instagram/wechat/weibo/blogâ€¦ï¼‰ï¼Œä¸€é”®é€šè¿‡IFCTT &amp; IFTTTï¼Œä¿å­˜é“¾æ¥å¯¹åº”çš„æ–‡ç« åˆ°Instapaper/Pocketï¼Œæœ€ä½æˆæœ¬å®ç°Read it later</li>
<li>æ‰‹æœºç«¯æ‰§è¡Œæ‹·è´æ–‡ç« å†…å®¹ï¼Œä¸€é”®é€šè¿‡IFCTT &amp; IFTTTï¼Œä¿å­˜å‘é€å¯¹åº”çš„å†…å®¹åˆ°Evernote/Google doc/kindleâ€¦</li>
<li>ç­‰ç­‰</li>
</ul>
<p>ä½¿ç”¨IFCTTéœ€è¦ä»¥ä¸‹å‡ ä¸ªæ¡ä»¶ï¼š</p>
<ul>
<li>ä½ éœ€è¦æ‹¥æœ‰IFTTTè´¦å·ï¼Œå¹¶å¼€å¯ç›¸åº”çš„Applets</li>
<li>ä½ éœ€è¦ä½¿ç”¨ä¸IFTTTç›¸åŒçš„Emailè´¦å·åœ¨IFCTTä¸­è¿›è¡Œsmtpæˆæƒå’Œé…ç½®</li>
</ul>
<p>é¦–å…ˆï¼Œä¸‹è½½å®‰è£…IFCTT App<font color="#FF2D51">ï¼ˆ12æœˆ21æ—¥ï½12æœˆ28æ—¥åœ£è¯èŠ‚å…é™ä¸­ï¼‰</font>ï¼š</p>
<font color="#FF2D51"><strong>Google Playï¼š<a href="https://play.google.com/store/apps/details?id=com.wangjie.ifctt" target="_blank" rel="noopener">https://play.google.com/store/apps/details?id=com.wangjie.ifctt</a></strong></font>

<a id="more"></a>
<h2 id="IFCTT-Emailé…ç½®"><a href="#IFCTT-Emailé…ç½®" class="headerlink" title="IFCTT Emailé…ç½®"></a>IFCTT Emailé…ç½®</h2><blockquote>
<p><strong>æ ¹æ®ä½ åœ¨IFTTTä½¿ç”¨çš„é‚®ç®±æ¥è¿›è¡Œé…ç½®(æ¨èä½¿ç”¨Gmail)</strong></p>
</blockquote>
<h3 id="1-Gmailé‚®ç®±é…ç½®"><a href="#1-Gmailé‚®ç®±é…ç½®" class="headerlink" title="1. Gmailé‚®ç®±é…ç½®"></a>1. Gmailé‚®ç®±é…ç½®</h3><p><span id="app_password"></span></p>
<h3 id="1-1-ç”Ÿæˆåº”ç”¨ä¸“ç”¨å¯†ç "><a href="#1-1-ç”Ÿæˆåº”ç”¨ä¸“ç”¨å¯†ç " class="headerlink" title="1.1 ç”Ÿæˆåº”ç”¨ä¸“ç”¨å¯†ç "></a>1.1 ç”Ÿæˆåº”ç”¨ä¸“ç”¨å¯†ç </h3><p>é¦–å…ˆéœ€è¦ä¸ºIFCTTç”Ÿæˆä¸€ä¸ªAppä¸“ç”¨å¯†ç ï¼Œæ‰“å¼€ä»¥ä¸‹é“¾æ¥å¹¶ç™»é™†Googleè´¦å·ï¼š</p>
<p><a href="https://support.google.com/accounts/answer/185833" target="_blank" rel="noopener">https://support.google.com/accounts/answer/185833</a></p>
<p>é€‰æ‹©appä¸º<code>Mail</code>ï¼š</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_email_configuration/app_password_01.png" width="700px/"></p>
<p>é€‰æ‹©è®¾å¤‡ä¸º<code>Other (Custom name)</code>ï¼š</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_email_configuration/app_password_02.png" width="700px/"></p>
<p>ç„¶ååœ¨è¾“å…¥æ¡†ä¸­å¡«å…¥<code>IFCTT</code>ï¼š</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_email_configuration/app_password_03.png" width="700px/"></p>
<p>ç„¶åï¼Œç‚¹å‡»<code>GENERATE</code>ï¼š</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_email_configuration/app_password_04.png" width="700px/"></p>
<p><strong>ä»¥ä¸Šé»„è‰²åŒºåŸŸä¸­çš„16ä¸ªå­—ç¬¦çš„å¯†ç å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ä¸“ç”¨å¯†ç ï¼Œé€‰ä¸­å¤åˆ¶</strong></p>
<h3 id="1-2-åœ¨IFCTTä¸­é…ç½®Gmail"><a href="#1-2-åœ¨IFCTTä¸­é…ç½®Gmail" class="headerlink" title="1.2 åœ¨IFCTTä¸­é…ç½®Gmail"></a>1.2 åœ¨IFCTTä¸­é…ç½®Gmail</h3><p>æ‰“å¼€IFCTTï¼Œè¿›å…¥<code>Settings</code> -&gt; <code>Email Configuration</code> å¹¶å¡«å†™ç›¸å…³ä¿¡æ¯ï¼š</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_email_configuration/ifctt_email_configuration_01.png" width="400px/"></p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼š</p>
<p><strong>password</strong>ï¼šä¸º<a href="#app_password">1.1 ç”Ÿæˆåº”ç”¨ä¸“ç”¨å¯†ç </a>ä¸­ç”Ÿæˆçš„åº”ç”¨ä¸“ç”¨å¯†ç <br><strong>Extra properties</strong>ï¼šå¦‚æœä½ ä½¿ç”¨çš„æ˜¯Gmailé‚®ç®±ï¼Œåˆ™å†…å®¹ä¸éœ€è¦æ”¹åŠ¨ï¼Œä¿æŒæœ€åˆå§‹çš„çŠ¶æ€å³å¯</p>
</blockquote>
<h2 id="æ€ä¹ˆä½¿ç”¨IFCTTè‡ªå¸¦é»˜è®¤çš„Hash-tags"><a href="#æ€ä¹ˆä½¿ç”¨IFCTTè‡ªå¸¦é»˜è®¤çš„Hash-tags" class="headerlink" title="æ€ä¹ˆä½¿ç”¨IFCTTè‡ªå¸¦é»˜è®¤çš„Hash tags"></a>æ€ä¹ˆä½¿ç”¨IFCTTè‡ªå¸¦é»˜è®¤çš„Hash tags</h2><p>åœ¨å®‰è£…å®ŒIFCTTä¹‹åï¼Œé¦–æ¬¡è¿›å…¥ï¼Œappä¼šè‡ªåŠ¨å¸®ä½ åˆ›å»ºä»¥ä¸‹5ä¸ªé»˜è®¤çš„Hash tagsï¼š</p>
<ul>
<li><strong>#instapaper</strong>ï¼šè¿™ä¸ªæ ‡ç­¾ä¼šä½¿å¾—å½“ä½ å¤åˆ¶äº†æ–‡æœ¬å†…å®¹æ—¶ï¼Œæ­¤æ ‡ç­¾ä¼šè¯†åˆ«å½“å‰å¤åˆ¶çš„å†…å®¹ï¼Œå¦‚æœæ˜¯é“¾æ¥ï¼Œåˆ™é€šè¿‡IFTTTæ¨é€åˆ°ä½ çš„<code>instapaper</code></li>
<li><strong>#box</strong>ï¼šè¿™ä¸ªæ ‡ç­¾ä¼šä½¿å¾—å½“ä½ å¤åˆ¶äº†æ–‡æœ¬å†…å®¹æ—¶ï¼Œæ­¤æ ‡ç­¾ä¼šé€šè¿‡IFTTTæ¨é€åˆ°ä½ çš„boxï¼ŒæŠŠå†…å®¹è¿½åŠ ä¿å­˜åœ¨boxçš„è·¯å¾„ä¸º<code>IFTTT/Email/IFCTT</code>çš„æ–‡ä»¶ä¸­</li>
<li><strong>#evernote</strong>ï¼šè¿™ä¸ªæ ‡ç­¾ä¼šä½¿å¾—å½“ä½ å¤åˆ¶äº†æ–‡æœ¬å†…å®¹æ—¶ï¼Œæ­¤æ ‡ç­¾ä¼šé€šè¿‡IFTTTæ¨é€åˆ°ä½ çš„<code>evernote</code>ï¼ŒæŠŠå†…å®¹è¿½åŠ ä¿å­˜åœ¨<code>evernote</code>çš„åä¸º<code>IFTTT/Email/IFCTT</code>çš„æ–‡ä»¶ä¸­</li>
<li><strong>#pocket</strong>ï¼šè¿™ä¸ªæ ‡ç­¾ä¼šä½¿å¾—å½“ä½ å¤åˆ¶äº†æ–‡æœ¬å†…å®¹æ—¶ï¼Œæ­¤æ ‡ç­¾ä¼šè¯†åˆ«å½“å‰å¤åˆ¶çš„å†…å®¹ï¼Œå¦‚æœæ˜¯é“¾æ¥ï¼Œåˆ™é€šè¿‡IFTTTæ¨é€åˆ°ä½ çš„<code>pocket</code></li>
<li><strong>#googledoc</strong>ï¼šè¿™ä¸ªæ ‡ç­¾ä¼šä½¿å¾—å½“ä½ å¤åˆ¶äº†æ–‡æœ¬å†…å®¹æ—¶ï¼Œæ­¤æ ‡ç­¾ä¼šé€šè¿‡IFTTTæ¨é€åˆ°ä½ çš„<code>google docs</code>ï¼ŒæŠŠå†…å®¹è¿½åŠ ä¿å­˜åœ¨<code>google docs</code>çš„åä¸º<code>IFTTT/Email/IFCTT</code>çš„æ–‡ä»¶ä¸­</li>
</ul>
<p>ç¬¬ä¸€æ¬¡è¿›å…¥åï¼Œæ‰€æœ‰çš„Hash tagséƒ½æ˜¯é»˜è®¤<code>OFF</code>çŠ¶æ€çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_use_default_hash_tags/hash_tag_disabled.png" width="350/"></p>
<p>ä¸‹é¢ä»¥å¼€å¯<code>instapaper</code>è¿™ä¸ªHash tagä¸ºä¾‹</p>
<p>é¦–å…ˆç‚¹å‡»è¿›å…¥<code>#instapaper</code>çš„ç¼–è¾‘é¡µé¢ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_use_default_hash_tags/instapaper_detail.png" width="350/"></p>
<p>é¦–å…ˆå¦‚ä¸Šå›¾ä¸­ï¼Œå…ˆç‚¹å‡»å¼€å¯æŒ‰é’®</p>
<p>ç„¶åå› ä¸ºé»˜è®¤çš„Hash tagæ‰€å¯¹åº”çš„<code>IFTTT Applet</code>éƒ½å·²ç»åˆ›å»ºå¥½äº†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿›å…¥IFTTTçš„Appletç•Œé¢æ·»åŠ å¹¶å¼€å¯ï¼Œå¦‚ä¸Šå›¾ï¼Œç‚¹å‡»çº¢è‰²å­—ä½“éƒ¨åˆ†æˆ–è€…<code>IFTTT</code>çš„å›¾æ ‡ï¼Œå°†ä¼šæ‰“å¼€å¦‚ä¸‹<code>IFTTT</code>çš„Appletç•Œé¢ï¼š</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_use_default_hash_tags/ifttt_instapaper_applet.png" width="350/"></p>
<p>ç‚¹å‡»å¼€å¯å›¾æ ‡ï¼Œè¿™æ—¶IFTTTå¯èƒ½ä¼šè®©ä½ ç»‘å®šä½ çš„instapaperè´¦å·ï¼ŒæŒ‰ç…§æµç¨‹æ­£å¸¸ç»‘å®šå³å¯ï¼ˆå¦‚æœä»¥å‰å·²ç»ç»‘å®šè¿‡äº†åˆ™ä¸éœ€è¦å†æ¬¡ç»‘å®šï¼‰ï¼Œæ“ä½œå®Œæ¯•åï¼ŒIFTTTçš„instapaper appletå°±ä¼šå¼€å¯ã€‚</p>
<p>æœ€åè¿”å›åˆ°IFCTT <code>#instapaper</code>çš„ç¼–è¾‘é¡µé¢ï¼Œç‚¹å‡»å³ä¸Šè§’è¿›è¡Œä¿å­˜ï¼ŒæˆåŠŸåå›åˆ°é¦–é¡µï¼Œinstapaperçš„cardå°†ä¼šå˜æˆå½©è‰²ã€‚</p>
<p>å…¶ä»–IFCTTè‡ªå¸¦é»˜è®¤çš„Hash tagså¼€å¯æ–¹å¼éƒ½ç±»ä¼¼ã€‚</p>
<h2 id="åˆ›å»ºè‡ªå®šä¹‰çš„Hash-tags"><a href="#åˆ›å»ºè‡ªå®šä¹‰çš„Hash-tags" class="headerlink" title="åˆ›å»ºè‡ªå®šä¹‰çš„Hash tags"></a>åˆ›å»ºè‡ªå®šä¹‰çš„Hash tags</h2><p>é™¤äº†<a href="http://blog.wangjiegulu.com/web/ifctt/ifctt_use_default_hash_tags/ifctt_use_default_hash_tags.md">ä½¿ç”¨IFCTTæä¾›çš„é»˜è®¤Hash tags</a>ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„Hash tagsï¼Œç°åœ¨æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªHash tagså®ç°å¦‚ä¸‹åŠŸèƒ½ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å½“ä½ å¤åˆ¶äº†ä¸€æ®µæ–‡å­—åï¼Œç‚¹å‡»æ­¤æ ‡ç­¾åï¼Œè‡ªåŠ¨é€šè¿‡IFTTTåœ¨ä½ çš„`Twitter`ä¸Šå‘é€ä¸€æ¡æ¨ç‰¹</span><br></pre></td></tr></table></figure>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_create_custom_hash_tags/main_hash_tag.png" width="350/"></p>
<p>ç‚¹å‡»é¦–é¡µå³ä¸Šè§’çš„<code>+</code>æŒ‰é’®ï¼Œæ·»åŠ ä¸€ä¸ªHash tagï¼Œ</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_create_custom_hash_tags/new_twitter_hash_tag.png" width="350/"></p>
<p><span id="tag_twitter"><br>å¦‚ä¸Šï¼Œå¡«å†™<code>tag</code>ä¸º<code>twitter</code>ï¼ˆå¯ä»¥è‡ªå·±ä»»æ„å¡«å†™ï¼‰å’Œnoteï¼ˆä»»æ„å¡«å†™ï¼‰ï¼Œé™¤äº†å¡«å†™ä»¥ä¸Šä¿¡æ¯ï¼Œè¿˜éœ€è¦åœ¨IFTTTä¸­åˆ›å»ºå¯¹åº”çš„<code>IFTTT Applet</code>ï¼Œç‚¹å‡»ä¸Šå›¾çº¢è‰²å­—æˆ–è€…IFTTTçš„å›¾æ ‡ï¼Œå³ä¼šè¿›å…¥åˆ°IFTTTç•Œé¢ï¼Œç‚¹å‡»ä¸‹å›¾é¡¶éƒ¨çš„<code>+</code>æŒ‰é’®æ¥åˆ›å»º<code>IFTTT Applet</code>ï¼š</span></p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_create_custom_hash_tags/ifttt_my_applet.png" width="350/"></p>
<p><code>this</code>ï¼ˆtriggerï¼‰é€‰æ‹©<code>Email</code>ï¼Œå¹¶é€‰æ‹©<strong><code>Send IFTTT an email tagged</code></strong>ï¼ˆå¿…é¡»ï¼‰ï¼š</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_create_custom_hash_tags/ifttt_this_twitter.png" width="350/"></p>
<p>ä¸Šå›¾ä¸­çš„<code>Tag</code>è¾“å…¥ä¸º<code>twitter</code>ï¼ˆ<a href="#tag_twitter">å¿…é¡»è¦ä¸IFCTTä¸­çš„ä¸€è‡´</a>ï¼ï¼‰ï¼Œ</p>
<p><code>that</code>ï¼ˆactionï¼‰é€‰æ‹©<code>Twitter</code>ï¼Œå¹¶é€‰æ‹©<strong><code>Post a tweet</code></strong>ï¼Œç„¶åè®¾ç½®å¦‚ä¸‹ï¼š</p>
<p><img src="http://blog.wangjiegulu.com/web/ifctt/ifctt_create_custom_hash_tags/ifttt_post_a_tweet.png" width="350/"></p>
<p>ä¸Šé¢ä¸­çš„<code>body</code>å°±æ˜¯æŒ‡çš„å°±æ˜¯IFCTTä¸­çš„å¤åˆ¶å†…å®¹</p>
<p>æäº¤æˆåŠŸåï¼Œè¿”å›åˆ°IFCTTä¸­çš„åˆ›å»ºé¡µé¢æäº¤ï¼Œè¿™æ—¶Hash tagåˆ›å»ºæˆåŠŸ</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ifttt </tag>
            
            <tag> ifctt </tag>
            
            <tag> automate </tag>
            
            <tag> huginn </tag>
            
            <tag> hash tag </tag>
            
            <tag> google play </tag>
            
            <tag> clipboard </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åº”æœ‹å‹æ­»çš®ç™½å’§åœ°é‚€è¯·è´´ä¸€ä¸ªæ‹›è˜å¹¿å‘Š]]></title>
      <url>/2017/09/25/%E5%BA%94%E6%9C%8B%E5%8F%8B%E6%AD%BB%E7%9A%AE%E7%99%BD%E5%92%A7%E5%9C%B0%E9%82%80%E8%AF%B7%E8%B4%B4%E4%B8%80%E4%B8%AA%E6%8B%9B%E8%81%98%E5%B9%BF%E5%91%8A/</url>
      <content type="html"><![CDATA[<blockquote>
<p>åº”æœ‹å‹<strike>æ­»çš®ç™½å’§åœ°</strike>é‚€è¯·åœ¨è¿™é‡Œè´´ä¸€ä¸ªæ‹›è˜å¹¿å‘Šï¼Œ<strong>æ³¨æ„ï¼šä»¥ä¸‹çš„è”ç³»æ–¹å¼éƒ½æ˜¯æˆ‘æœ‹å‹çš„</strong></p>
</blockquote>
<h1 id="æ‹›è˜ã€é˜¿é‡Œå·´å·´ICBUå†…éƒ¨æ¨èå¿«é€Ÿé€šé“ã€‘"><a href="#æ‹›è˜ã€é˜¿é‡Œå·´å·´ICBUå†…éƒ¨æ¨èå¿«é€Ÿé€šé“ã€‘" class="headerlink" title="æ‹›è˜ã€é˜¿é‡Œå·´å·´ICBUå†…éƒ¨æ¨èå¿«é€Ÿé€šé“ã€‘"></a>æ‹›è˜ã€é˜¿é‡Œå·´å·´ICBUå†…éƒ¨æ¨èå¿«é€Ÿé€šé“ã€‘</h1><h3 id="ICBUæŠ€æœ¯éƒ¨ä»‹ç»ï¼š"><a href="#ICBUæŠ€æœ¯éƒ¨ä»‹ç»ï¼š" class="headerlink" title="ICBUæŠ€æœ¯éƒ¨ä»‹ç»ï¼š"></a>ICBUæŠ€æœ¯éƒ¨ä»‹ç»ï¼š</h3><p>ä½œä¸ºé˜¿é‡Œå·´å·´é›†å›¢æå‡ºçš„eWTPå»ºè®¾çš„é‡è¦éƒ¨é˜Ÿï¼Œå›½é™…æ— çº¿æŠ€æœ¯éƒ¨æ—¨åœ¨ä»¥ä¼˜ç§€çš„æ— çº¿æŠ€æœ¯æœåŠ¡å…¨çƒä¸­å°ä¼ä¸šã€‚æˆ‘ä»¬é¢ä¸´çš„æŠ€æœ¯æŒ‘æˆ˜æœ‰ï¼šå…¨çƒåŒ–ç¯å¢ƒä¸‹å¤æ‚çš„æŠ€æœ¯ä¸ç½‘ç»œç¯å¢ƒã€å›½é™…è´¸æ˜“å¤æ‚çš„ä¸šåŠ¡æµç¨‹ä¸è§„åˆ™ã€å›½é™…ç‰©æµçš„ä¿¡æ¯è·Ÿè¸ªç­‰å±¥çº¦è§„èŒƒå»ºç«‹ã€è·¨å¢ƒè´¸æ˜“æ²Ÿé€šä¸‹çš„è¯­è¨€éšœç¢ç­‰ã€‚é€šè¿‡æ·±å…¥å¯¹æŠ€æœ¯çš„å…¨çƒåŒ–å¸ƒå±€æå‡æè‡´çš„ç”¨æˆ·ä½“éªŒï¼Œç ”ç©¶æœ€æ–°çš„æ— çº¿æŠ€æœ¯å¦‚IoTç­‰å°†ä¸šåŠ¡åŒ–ç¹ä¸ºç®€ï¼Œä¸°å¯Œçš„æ— çº¿ç›¸æœºèƒ½åŠ›å’Œè¯­è¨€ç¿»è¯‘æœåŠ¡è®©æ²Ÿé€šå…¨æ–¹ä½æ— éšœç¢ã€‚è®©å…¨çƒä¼ä¸šå—æƒ eWTPï¼Œæ— çº¿æŠ€æœ¯å¤§æœ‰å¯ä¸ºï¼ </p>
<p>æ‹›è˜Androidã€IOSã€Javaå·¥ç¨‹å¸ˆ<br>æŠ•é€’é‚®ç®±ï¼šdechong.wc@alibaba-inc.com</p>
<a id="more"></a>
<h3 id="æ— çº¿ç ”å‘å²—ä½è¦æ±‚ï¼š"><a href="#æ— çº¿ç ”å‘å²—ä½è¦æ±‚ï¼š" class="headerlink" title="æ— çº¿ç ”å‘å²—ä½è¦æ±‚ï¼š"></a>æ— çº¿ç ”å‘å²—ä½è¦æ±‚ï¼š</h3><p>æ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼ŒåŸºäºIOS/Androidå¹³å°è¿›è¡Œåº”ç”¨ç¨‹åºå¼€å‘ï¼›å‚ä¸ç§»åŠ¨å¹³å°è½¯ä»¶æ¡†æ¶çš„ç ”ç©¶ï¼Œè®¾è®¡å’Œå®ç°ã€å…³é”®æŠ€æœ¯éªŒè¯å’Œé€‰å‹ç­‰å·¥ä½œï¼›å¸¦é¢†å¹¶æŒ‡å¯¼å¼€å‘å·¥ç¨‹å¸ˆã€ç¨‹åºå‘˜è¿›è¡Œä»£ç å¼€å‘ç­‰å·¥ä½œï¼›<br>1. æœ¬ç§‘åŠä»¥ä¸Šå­¦å†ï¼Œè®¡ç®—æœºæˆ–ç›¸å…³ä¸“ä¸šï¼›<br>2. ä¸‰å¹´åŠä»¥ä¸Šæ‰‹æœºåº”ç”¨å®é™…å¼€å‘ç»éªŒï¼Œä¸‰å¹´ä»¥ä¸ŠIOS/Androidå¼€å‘ç»éªŒï¼Œäº”å¹´ä»¥ä¸ŠC/C+/Javaå¼€å‘ç»éªŒï¼›<br>3. ç²¾é€šObjective-Cã€Mac OS Xã€Xcodeï¼›<br>4. ç²¾é€šIOS/AndroidSDKä¸­çš„UIã€ç½‘ç»œã€æ•°æ®åº“ã€XML/JSONè§£æç­‰å¼€å‘æŠ€å·§ï¼›<br>5. æœ‰å¤šä¸ªå®Œæ•´çš„IOS/Androidé¡¹ç›®ç»éªŒï¼Œè‡³å°‘å‚åŠ è¿‡ä¸€ä¸ªå®Œæ•´çš„å•†ä¸šçº§æ‰‹æœºåº”ç”¨æˆ–æ¸¸æˆå¼€å‘é¡¹ç›®ï¼›<br>6. ç†Ÿæ‚‰å„ç§ä¸»æµæ‰‹æœºç‰¹æ€§ï¼Œæ·±åˆ»ç†è§£æ‰‹æœºå®¢æˆ·ç«¯è½¯ä»¶åŠæœåŠ¡ç«¯å¼€å‘ç‰¹ç‚¹ï¼›<br>7. ç²¾é€šå¸¸ç”¨è½¯ä»¶æ¶æ„æ¨¡å¼ï¼Œç†Ÿæ‚‰å„ç§ç®—æ³•ä¸æ•°æ®ç»“æ„ï¼Œå¤šçº¿ç¨‹ï¼Œç½‘ç»œç¼–ç¨‹ï¼ˆSocketã€http/web serviceï¼‰ç­‰ï¼›</p>
<h3 id="JAVAå¼€å‘å²—ä½è¦æ±‚ï¼š"><a href="#JAVAå¼€å‘å²—ä½è¦æ±‚ï¼š" class="headerlink" title="JAVAå¼€å‘å²—ä½è¦æ±‚ï¼š"></a>JAVAå¼€å‘å²—ä½è¦æ±‚ï¼š</h3><p>ä»ç”¨æˆ·å’ŒæŠ€æœ¯å‡ºå‘ï¼Œè´Ÿè´£é›¶å”®é€šç½‘ç«™ä¸šåŠ¡äº§å“ç›¸å…³çš„æ¶æ„è®¾è®¡ä¸å¼€å‘ï¼› å¯¹ç°æœ‰äº§å“å’Œç³»ç»Ÿè¿›è¡Œæ”¹è¿›å’Œä¼˜åŒ–ï¼Œå®ç°é¢å‘æœªæ¥çš„ç³»ç»Ÿè§„åˆ’ã€è®¾è®¡å’Œè½åœ°ã€‚<br>1. JavaåŸºç¡€æ‰å®ï¼Œç†è§£ioã€å¤šçº¿ç¨‹ã€é›†åˆç­‰åŸºç¡€æ¡†æ¶ï¼Œå¯¹JVMåŸç†æœ‰ä¸€å®šçš„äº†è§£ï¼›<br>2. å¯¹äºä½ ç”¨è¿‡çš„å¼€æºæ¡†æ¶ï¼Œèƒ½äº†è§£åˆ°å®ƒçš„åŸç†å’Œæœºåˆ¶ï¼›å¯¹Springã€ibatiså¼€æºæ¡†æ¶ç†Ÿæ‚‰ï¼›<br>3. æŒæ¡å¤šçº¿ç¨‹åŠé«˜æ€§èƒ½çš„è®¾è®¡ä¸ç¼–ç åŠæ€§èƒ½è°ƒä¼˜ï¼›æœ‰é«˜å¹¶å‘åº”ç”¨å¼€å‘ç»éªŒï¼›<br>4. å¯¹æŠ€æœ¯æœ‰æµ“åšå…´è¶£ï¼Œå­¦ä¹ èƒ½åŠ›å¼ºï¼Œé€‚åº”èƒ½åŠ›å¥½ï¼ŒæŠ—å‹èƒ½åŠ›å¼ºï¼›</p>
<h6 id="æœŸå¾…ä½ çš„åŠ å…¥ï½"><a href="#æœŸå¾…ä½ çš„åŠ å…¥ï½" class="headerlink" title="æœŸå¾…ä½ çš„åŠ å…¥ï½"></a>æœŸå¾…ä½ çš„åŠ å…¥ï½</h6>]]></content>
      
        
        <tags>
            
            <tag> jobs </tag>
            
            <tag> alibaba </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidç„¦ç‚¹æµç¨‹ä»£ç åˆ†æ]]></title>
      <url>/2017/08/04/Android-Android%E7%84%A6%E7%82%B9%E6%B5%81%E7%A8%8B%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/</url>
      <content type="html"><![CDATA[<p>é€šè¿‡Viewçš„<code>View::focusSearch</code>è¿›è¡Œç„¦ç‚¹æœç´¢å¯¹åº”æ–¹å‘ä¸Šçš„ä¸‹ä¸€ä¸ªå¯ä»¥è·å–ç„¦ç‚¹çš„Viewï¼š</p>
<a id="more"></a>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">focusSearch</span><span class="params">(@FocusRealDirection <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (mParent != <span class="keyword">null</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> mParent.focusSearch(<span class="keyword">this</span>, direction);</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span id="focusSearch"><br>ä¸æ–­åœ°è°ƒç”¨çˆ¶æ§ä»¶æ¥è¿›è¡Œæœç´¢ï¼ŒfocusSearchæœ‰ä¸¤ä¸ªå®ç°ï¼š<code>ViewGroup</code>å’Œ<code>RecyclerView</code>ï¼Œå…ˆçœ‹<code>ViewGroup</code>ï¼š</span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">focusSearch</span><span class="params">(View focused, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (isRootNamespace()) &#123;</span><br><span class="line">       <span class="comment">// root namespace means we should consider ourselves the top of the</span></span><br><span class="line">       <span class="comment">// tree for focus searching; otherwise we could be focus searching</span></span><br><span class="line">       <span class="comment">// into other tabs.  see LocalActivityManager and TabHost for more info</span></span><br><span class="line">       <span class="keyword">return</span> FocusFinder.getInstance().findNextFocus(<span class="keyword">this</span>, focused, direction);</span><br><span class="line">   &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mParent != <span class="keyword">null</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> mParent.focusSearch(focused, direction);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span id="FocusFinder.findNextFocus"><br>å¦‚æœæ˜¯æœ€é¡¶å±‚ï¼Œåˆ™ç›´æ¥è°ƒç”¨<code>FocusFinder::findNextFocus</code>æ–¹æ³•è¿›è¡Œæœç´¢ï¼›å¦åˆ™è°ƒç”¨çˆ¶æ§ä»¶çš„<code>focusSearch</code>ã€‚<code>FocusFinder::findNextFocus</code>å¦‚ä¸‹ï¼š</span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> View <span class="title">findNextFocus</span><span class="params">(ViewGroup root, View focused, Rect focusedRect, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">   View next = <span class="keyword">null</span>;</span><br><span class="line">   <span class="keyword">if</span> (focused != <span class="keyword">null</span>) &#123;</span><br><span class="line">       next = findNextUserSpecifiedFocus(root, focused, direction);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span> (next != <span class="keyword">null</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> next;</span><br><span class="line">   &#125;</span><br><span class="line">   ArrayList&lt;View&gt; focusables = mTempList;</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">       focusables.clear();</span><br><span class="line">       root.addFocusables(focusables, direction);</span><br><span class="line">       <span class="keyword">if</span> (!focusables.isEmpty()) &#123;</span><br><span class="line">           next = findNextFocus(root, focused, focusedRect, direction, focusables);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">       focusables.clear();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„<code>root</code>å‚æ•°ä»£è¡¨çš„æ˜¯æœ€é¡¶å±‚çš„viewã€‚</p>
<p>é¦–å…ˆï¼Œé€šè¿‡å°è¯•é€šè¿‡<code>findNextUserSpecifiedFocus</code>æ¥æŸ¥æ‰¾ä¸‹ä¸€ä¸ªâ€œæŒ‡å®šçš„â€å¯è·å¾—ç„¦ç‚¹çš„Viewï¼Œè¿™ä¸ªæŒ‡å®šæ˜¯å¼€å‘è€…é€šè¿‡SDKè‡ªå¸¦çš„<code>setNextFocusLeftId</code>ç­‰æ–¹æ³•è¿›è¡Œæ‰‹åŠ¨è®¾ç½®çš„ã€‚å¦‚æœæŸ¥æ‰¾åˆ°æŒ‡å®šçš„ä¸‹ä¸€ä¸ªå¯è·å¾—ç„¦ç‚¹çš„Viewï¼Œåˆ™è¿”å›è¯¥Viewï¼›å¦åˆ™ï¼Œæ‰§è¡Œ<code>View::addFocusables</code>æ–¹æ³•ï¼Œé€šè¿‡è¿™ä¸ªæœ€é¡¶å±‚çš„Viewå»æ‹¿åˆ°æ‰€æœ‰ç›´æ¥æˆ–é—´æ¥çš„<code>Focusable</code>çš„å­Viewï¼Œå¹¶æ·»åŠ åˆ°<code>ArrayList&lt;View&gt; focusables</code>ä¸­ã€‚</p>
<p><code>View::addFolcusables</code>æ–¹æ³•ä¸­æœ‰4ç§å®ç°ï¼š</p>
<p>ç¬¬ä¸€ç§æ˜¯Viewä¸­é»˜è®¤å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFocusables</span><span class="params">(ArrayList&lt;View&gt; views, @FocusDirection <span class="keyword">int</span> direction,</span></span></span><br><span class="line"><span class="function"><span class="params">            @FocusableMode <span class="keyword">int</span> focusableMode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (views == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!isFocusable()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((focusableMode &amp; FOCUSABLES_TOUCH_MODE) == FOCUSABLES_TOUCH_MODE</span><br><span class="line">                &amp;&amp; !isFocusableInTouchMode()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        views.add(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè‡ªå·±æ˜¯focusableçš„è¯ï¼Œç›´æ¥æŠŠè‡ªå·±æ·»åŠ è¿›å»ã€‚</p>
<p>ç¬¬äºŒç§æ˜¯<code>ViewGroup</code>å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFocusables</span><span class="params">(ArrayList&lt;View&gt; views, <span class="keyword">int</span> direction, <span class="keyword">int</span> focusableMode)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">final</span> <span class="keyword">int</span> focusableCount = views.size();</span><br><span class="line"></span><br><span class="line">   <span class="keyword">final</span> <span class="keyword">int</span> descendantFocusability = getDescendantFocusability();</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (descendantFocusability != FOCUS_BLOCK_DESCENDANTS) &#123;</span><br><span class="line">       <span class="keyword">if</span> (shouldBlockFocusForTouchscreen()) &#123;</span><br><span class="line">           focusableMode |= FOCUSABLES_TOUCH_MODE;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">final</span> <span class="keyword">int</span> count = mChildrenCount;</span><br><span class="line">       <span class="keyword">final</span> View[] children = mChildren;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">           <span class="keyword">final</span> View child = children[i];</span><br><span class="line">           <span class="keyword">if</span> ((child.mViewFlags &amp; VISIBILITY_MASK) == VISIBLE) &#123;</span><br><span class="line">               child.addFocusables(views, direction, focusableMode);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// we add ourselves (if focusable) in all cases except for when we are</span></span><br><span class="line">   <span class="comment">// FOCUS_AFTER_DESCENDANTS and there are some descendants focusable.  this is</span></span><br><span class="line">   <span class="comment">// to avoid the focus search finding layouts when a more precise search</span></span><br><span class="line">   <span class="comment">// among the focusable children would be more interesting.</span></span><br><span class="line">   <span class="keyword">if</span> ((descendantFocusability != FOCUS_AFTER_DESCENDANTS</span><br><span class="line">           <span class="comment">// No focusable descendants</span></span><br><span class="line">           || (focusableCount == views.size())) &amp;&amp;</span><br><span class="line">           (isFocusableInTouchMode() || !shouldBlockFocusForTouchscreen())) &#123;</span><br><span class="line">       <span class="keyword">super</span>.addFocusables(views, direction, focusableMode);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å…ˆä¼šå¤„ç†è‡ªèº«ViewGroupä¸å®ƒåä»£çš„å…³ç³»(descendantFocusability)ï¼Œå‰é¢æåˆ°è¿‡ï¼Œå¯èƒ½çš„å‡ ç§æƒ…å†µï¼š</p>
<ul>
<li><strong>FOCUS_BEFORE_DESCENDANTS</strong>: ViewGroupæœ¬èº«å…ˆå¯¹ç„¦ç‚¹è¿›è¡Œå¤„ç†ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†åˆ™åˆ†å‘ç»™child Viewè¿›è¡Œå¤„ç†</li>
<li><strong>FOCUS_AFTER_DESCENDANTS</strong>: å…ˆåˆ†å‘ç»™Child Viewè¿›è¡Œå¤„ç†ï¼Œå¦‚æœæ‰€æœ‰çš„Child Viewéƒ½æ²¡æœ‰å¤„ç†ï¼Œåˆ™è‡ªå·±å†å¤„ç†</li>
<li><strong>FOCUS_BLOCK_DESCENDANTS</strong>: ViewGroupæœ¬èº«è¿›è¡Œå¤„ç†ï¼Œä¸ç®¡æ˜¯å¦å¤„ç†æˆåŠŸï¼Œéƒ½ä¸ä¼šåˆ†å‘ç»™ChildViewè¿›è¡Œå¤„ç†</li>
</ul>
</blockquote>
<p>æ‰€ä»¥ï¼Œä»¥ä¸Šï¼š</p>
<p>1. å¦‚æœä¸æ˜¯<code>FOCUS_BLOCK_DESCENDANTS</code>ï¼Œåˆ™é¦–å…ˆæ£€æŸ¥<code>blockForTouchscreen</code>å¹¶é‡ç½®æ‰<code>focusableMode</code>ï¼Œç„¶åéå†æ‰€æœ‰çš„å­Viewï¼Œè°ƒç”¨<code>child::addFocusables</code>ã€‚<br>2. å¦‚æœä¸æ˜¯<code>FOCUS_AFTER_DESCENDANTS</code>æˆ–è€…æ²¡æœ‰focusableçš„å­Viewæ—¶è‡ªå·±å¤„ç†ï¼Œæ‰€ä»¥æŠŠè‡ªå·±åŠ å…¥åˆ°<code>views</code>ä¸­ã€‚</p>
<p>ç¬¬ä¸‰ç§æ˜¯<code>ViewPager</code>å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFocusables</span><span class="params">(ArrayList&lt;View&gt; views, <span class="keyword">int</span> direction, <span class="keyword">int</span> focusableMode)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">final</span> <span class="keyword">int</span> focusableCount = views.size();</span><br><span class="line"></span><br><span class="line">   <span class="keyword">final</span> <span class="keyword">int</span> descendantFocusability = getDescendantFocusability();</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (descendantFocusability != FOCUS_BLOCK_DESCENDANTS) &#123;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; getChildCount(); i++) &#123;</span><br><span class="line">           <span class="keyword">final</span> View child = getChildAt(i);</span><br><span class="line">           <span class="keyword">if</span> (child.getVisibility() == VISIBLE) &#123;</span><br><span class="line">               ItemInfo ii = infoForChild(child);</span><br><span class="line">               <span class="keyword">if</span> (ii != <span class="keyword">null</span> &amp;&amp; ii.position == mCurItem) &#123;</span><br><span class="line">                   child.addFocusables(views, direction, focusableMode);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// we add ourselves (if focusable) in all cases except for when we are</span></span><br><span class="line">   <span class="comment">// FOCUS_AFTER_DESCENDANTS and there are some descendants focusable.  this is</span></span><br><span class="line">   <span class="comment">// to avoid the focus search finding layouts when a more precise search</span></span><br><span class="line">   <span class="comment">// among the focusable children would be more interesting.</span></span><br><span class="line">   <span class="keyword">if</span> (descendantFocusability != FOCUS_AFTER_DESCENDANTS</span><br><span class="line">           || (focusableCount == views.size())) &#123; <span class="comment">// No focusable descendants</span></span><br><span class="line">       <span class="comment">// Note that we can't call the superclass here, because it will</span></span><br><span class="line">       <span class="comment">// add all views in.  So we need to do the same thing View does.</span></span><br><span class="line">       <span class="keyword">if</span> (!isFocusable()) &#123;</span><br><span class="line">           <span class="keyword">return</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> ((focusableMode &amp; FOCUSABLES_TOUCH_MODE) == FOCUSABLES_TOUCH_MODE</span><br><span class="line">               &amp;&amp; isInTouchMode() &amp;&amp; !isFocusableInTouchMode()) &#123;</span><br><span class="line">           <span class="keyword">return</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (views != <span class="keyword">null</span>) &#123;</span><br><span class="line">           views.add(<span class="keyword">this</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸<code>ViewGroup</code>åŸºæœ¬ä¸€è‡´ï¼Œåœ¨<code>descendantFocusability</code>ä¸æ˜¯<code>FOCUS_BLOCK_DESCENDANTS</code>æ—¶ï¼Œéå†å­Viewæ—¶åˆ¤æ–­viewæ˜¯å¦å±äºå½“å‰çš„pageï¼Œå¦‚æœæ˜¯æ‰åŠ è¿›å»ã€‚å¦‚æœä¸æ˜¯<code>FOCUS_AFTER_DESCENDANTS</code>æˆ–è€…æ²¡æœ‰focusableçš„å­Viewæ—¶è‡ªå·±å¤„ç†ï¼Œæ‰€ä»¥æŠŠè‡ªå·±åŠ å…¥åˆ°<code>views</code>ä¸­ã€‚</p>
<p>ç¬¬å››ç§æ˜¯<code>RecyclerView</code>å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFocusables</span><span class="params">(ArrayList&lt;View&gt; views, <span class="keyword">int</span> direction, <span class="keyword">int</span> focusableMode)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (mLayout == <span class="keyword">null</span> || !mLayout.onAddFocusables(<span class="keyword">this</span>, views, direction, focusableMode)) &#123;</span><br><span class="line">       <span class="keyword">super</span>.addFocusables(views, direction, focusableMode);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡<code>LayoutManager::onAddFocusables</code>æ¥è¿›è¡Œç®¡ç†ï¼Œå¦‚æœè¿”å›falseï¼Œåˆ™ç›´æ¥è°ƒç”¨çˆ¶ç±»<code>ViewGroup</code>çš„æ–¹æ³•ï¼Œçœ‹ä¸‹<code>LayoutManager::onAddFocusables</code>çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onAddFocusables</span><span class="params">(RecyclerView recyclerView, ArrayList&lt;View&gt; views,</span></span></span><br><span class="line"><span class="function"><span class="params">      <span class="keyword">int</span> direction, <span class="keyword">int</span> focusableMode)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥è¿”å›falseï¼Œå¹¶ä¸”æ²¡æœ‰çœ‹åˆ°ç›¸å…³çš„<code>LayoutManager</code>å¯¹è¯¥æ–¹æ³•çš„é‡å†™ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œåº”è¯¥æ˜¯ç›´æ¥è°ƒç”¨äº†çˆ¶ç±»<code>ViewGroup</code>çš„æ–¹æ³•ã€‚</p>
<p><code>addFocusables</code>æ–¹æ³•å®Œæ¯•ï¼Œå›åˆ° <a href="#FocusFinder.findNextFocus">FocusFinder::findNextFocus</a> æ–¹æ³•ä¸­é€šè¿‡<code>root.addFocusables(focusables, direction);</code>åŠ å…¥æ‰€æœ‰å¯è·å–ç„¦ç‚¹çš„Viewä¹‹åï¼Œåœ¨éç©ºçš„æƒ…å†µä¸‹è°ƒç”¨å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">next = findNextFocus(root, focused, focusedRect, direction, focusables);</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥é‡ç‚¹æ˜¯<code>FocusFinder::findNextFocus</code>æ–¹æ³•çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> View <span class="title">findNextFocus</span><span class="params">(ViewGroup root, View focused, Rect focusedRect,</span></span></span><br><span class="line"><span class="function"><span class="params">       <span class="keyword">int</span> direction, ArrayList&lt;View&gt; focusables)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">if</span> (focused != <span class="keyword">null</span>) &#123;</span><br><span class="line">       <span class="keyword">if</span> (focusedRect == <span class="keyword">null</span>) &#123;</span><br><span class="line">           focusedRect = mFocusedRect;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// fill in interesting rect from focused</span></span><br><span class="line">       focused.getFocusedRect(focusedRect);</span><br><span class="line">       root.offsetDescendantRectToMyCoords(focused, focusedRect);</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (focusedRect == <span class="keyword">null</span>) &#123;</span><br><span class="line">           focusedRect = mFocusedRect;</span><br><span class="line">           <span class="comment">// make up a rect at top left or bottom right of root</span></span><br><span class="line">           <span class="keyword">switch</span> (direction) &#123;</span><br><span class="line">               <span class="keyword">case</span> View.FOCUS_RIGHT:</span><br><span class="line">               <span class="keyword">case</span> View.FOCUS_DOWN:</span><br><span class="line">                   setFocusTopLeft(root, focusedRect);</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> View.FOCUS_FORWARD:</span><br><span class="line">                   <span class="keyword">if</span> (root.isLayoutRtl()) &#123;</span><br><span class="line">                       setFocusBottomRight(root, focusedRect);</span><br><span class="line">                   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                       setFocusTopLeft(root, focusedRect);</span><br><span class="line">                   &#125;</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">               <span class="keyword">case</span> View.FOCUS_LEFT:</span><br><span class="line">               <span class="keyword">case</span> View.FOCUS_UP:</span><br><span class="line">                   setFocusBottomRight(root, focusedRect);</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> View.FOCUS_BACKWARD:</span><br><span class="line">                   <span class="keyword">if</span> (root.isLayoutRtl()) &#123;</span><br><span class="line">                       setFocusTopLeft(root, focusedRect);</span><br><span class="line">                   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                       setFocusBottomRight(root, focusedRect);</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">switch</span> (direction) &#123;</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_FORWARD:</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_BACKWARD:</span><br><span class="line">           <span class="keyword">return</span> findNextFocusInRelativeDirection(focusables, root, focused, focusedRect,</span><br><span class="line">                   direction);</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_UP:</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_DOWN:</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_LEFT:</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_RIGHT:</span><br><span class="line">           <span class="keyword">return</span> findNextFocusInAbsoluteDirection(focusables, root, focused,</span><br><span class="line">                   focusedRect, direction);</span><br><span class="line">       <span class="keyword">default</span>:</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Unknown direction: "</span> + direction);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>å¦‚æœfocusedä¸æ˜¯nullï¼Œè¯´æ˜å½“å‰è·å–åˆ°ç„¦ç‚¹çš„Viewå­˜åœ¨ï¼Œåˆ™è·å¾—ç»˜åˆ¶ç„¦ç‚¹çš„Rectåˆ°focusedRectï¼Œç„¶åæ ¹æ®rootViewéå†æ‰€æœ‰ParentViewä»å­Viewçº æ­£åæ ‡åˆ°æ ¹Viewåæ ‡ã€‚</li>
<li>å¦‚æœfocusedæ˜¯nullï¼Œåˆ™è¯´æ˜å½“å‰æ²¡æœ‰Viewè·å–åˆ°ç„¦ç‚¹ï¼Œåˆ™æŠŠfocusedRectæ ¹æ®ä¸åŒçš„directioné‡ç½®ä¸ºâ€œä¸€ç‚¹â€ã€‚</li>
</ul>
<p>æœ€åæ ¹æ®directionè°ƒç”¨<code>FocusFinder::findNextFocusInAbsoluteDirection</code>æ–¹æ³•è¿›è¡Œå¯¹æ¯”æŸ¥æ‰¾â€œä¸‹ä¸€ä¸ªâ€Viewã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">View <span class="title">findNextFocusInAbsoluteDirection</span><span class="params">(ArrayList&lt;View&gt; focusables, ViewGroup root, View focused,</span></span></span><br><span class="line"><span class="function"><span class="params">       Rect focusedRect, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">   <span class="comment">// initialize the best candidate to something impossible</span></span><br><span class="line">   <span class="comment">// (so the first plausible view will become the best choice)</span></span><br><span class="line">   mBestCandidateRect.set(focusedRect);</span><br><span class="line">   <span class="keyword">switch</span>(direction) &#123;</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_LEFT:</span><br><span class="line">           mBestCandidateRect.offset(focusedRect.width() + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">           <span class="keyword">break</span>;</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_RIGHT:</span><br><span class="line">           mBestCandidateRect.offset(-(focusedRect.width() + <span class="number">1</span>), <span class="number">0</span>);</span><br><span class="line">           <span class="keyword">break</span>;</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_UP:</span><br><span class="line">           mBestCandidateRect.offset(<span class="number">0</span>, focusedRect.height() + <span class="number">1</span>);</span><br><span class="line">           <span class="keyword">break</span>;</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_DOWN:</span><br><span class="line">           mBestCandidateRect.offset(<span class="number">0</span>, -(focusedRect.height() + <span class="number">1</span>));</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   View closest = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">int</span> numFocusables = focusables.size();</span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numFocusables; i++) &#123;</span><br><span class="line">       View focusable = focusables.get(i);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// only interested in other non-root views</span></span><br><span class="line">       <span class="keyword">if</span> (focusable == focused || focusable == root) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// get focus bounds of other view in same coordinate system</span></span><br><span class="line">       focusable.getFocusedRect(mOtherRect);</span><br><span class="line">       root.offsetDescendantRectToMyCoords(focusable, mOtherRect);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (isBetterCandidate(direction, focusedRect, mOtherRect, mBestCandidateRect)) &#123;</span><br><span class="line">           mBestCandidateRect.set(mOtherRect);</span><br><span class="line">           closest = focusable;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> closest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆæŠŠæœ€ä¼˜é€‰æ‹©mBestCandidateRectè®¾ç½®ä¸ºfocusedRectï¼Œæ ¹æ®æ–¹å‘åš1åƒç´ çš„åç§»ä¾¿äºå¯¹æ¯”ã€‚éå†æ‰€æœ‰åˆšåˆšæŸ¥è¯¢å‡ºæ¥çš„<code>focusables</code>ï¼Œæ‹¿åˆ°æ¯ä¸€ä¸ªçš„<code>focusedRect</code>åŒºåŸŸå¹¶è¿›è¡Œè½¬æ¢ï¼Œç„¶åé€šè¿‡<code>FocusFinder::isBetterCandidate</code>æ–¹æ³•è¿›è¡Œå¯¹æ¯”ï¼Œç„¶åæ‹¿åˆ°æ›´å¥½çš„ï¼Œéå†å®Œæˆåå°±æ˜¯æœ€ä¼˜é€‰æ‹©ã€‚æ¥ä¸‹æ¥çœ‹ä¸‹<code>FocusFinder::isBetterCandidate</code>æ–¹æ³•æ¥äº†è§£ä¸‹æ˜¯æ€ä¹ˆåšå¯¹æ¯”çš„ï¼š</p>
<p>ä¸‹é¢ä»£ç æ„æ€æ˜¯ï¼šä»¥sourceè¿™ä¸ªrectæ¥è¯´ï¼Œä½œä¸ºå¯¹åº”derectionä¸Šä¸‹ä¸€ä¸ªfocus viewï¼Œrect1æ˜¯å¦æ¯”rect2æ›´ä¼˜ï¼Ÿ</p>
<p><span id="FocusFinder.isBetterCandidate"></span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isBetterCandidate</span><span class="params">(<span class="keyword">int</span> direction, Rect source, Rect rect1, Rect rect2)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// to be a better candidate, need to at least be a candidate in the first</span></span><br><span class="line">   <span class="comment">// place :)</span></span><br><span class="line">   <span class="keyword">if</span> (!isCandidate(source, rect1, direction)) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// we know that rect1 is a candidate.. if rect2 is not a candidate,</span></span><br><span class="line">   <span class="comment">// rect1 is better</span></span><br><span class="line">   <span class="keyword">if</span> (!isCandidate(source, rect2, direction)) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// if rect1 is better by beam, it wins</span></span><br><span class="line">   <span class="keyword">if</span> (beamBeats(direction, source, rect1, rect2)) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// if rect2 is better, then rect1 cant' be :)</span></span><br><span class="line">   <span class="keyword">if</span> (beamBeats(direction, source, rect2, rect1)) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// otherwise, do fudge-tastic comparison of the major and minor axis</span></span><br><span class="line">   <span class="keyword">return</span> (getWeightedDistanceFor(</span><br><span class="line">                   majorAxisDistance(direction, source, rect1),</span><br><span class="line">                   minorAxisDistance(direction, source, rect1))</span><br><span class="line">           &lt; getWeightedDistanceFor(</span><br><span class="line">                   majorAxisDistance(direction, source, rect2),</span><br><span class="line">                   minorAxisDistance(direction, source, rect2)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆç¡®å®šrect1æ˜¯å¦<code>isCandidate</code>ï¼Ÿ<code>isCandidate</code>åšçš„é€»è¾‘ç®€å•æ¥è¯´å°±æ˜¯ç¡®å®šrectæ˜¯å¦æ»¡è¶³ç»™å®šçš„derectionä½œä¸ºä¸‹ä¸€ä¸ªfocus viewè¿™ä¸ªæ¡ä»¶ï¼Œå®ƒçš„åˆ¤æ–­ä¾æ®å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isCandidate</span><span class="params">(Rect srcRect, Rect destRect, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">switch</span> (direction) &#123;</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_LEFT:</span><br><span class="line">           <span class="keyword">return</span> (srcRect.right &gt; destRect.right || srcRect.left &gt;= destRect.right) </span><br><span class="line">                   &amp;&amp; srcRect.left &gt; destRect.left;</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_RIGHT:</span><br><span class="line">           <span class="keyword">return</span> (srcRect.left &lt; destRect.left || srcRect.right &lt;= destRect.left)</span><br><span class="line">                   &amp;&amp; srcRect.right &lt; destRect.right;</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_UP:</span><br><span class="line">           <span class="keyword">return</span> (srcRect.bottom &gt; destRect.bottom || srcRect.top &gt;= destRect.bottom)</span><br><span class="line">                   &amp;&amp; srcRect.top &gt; destRect.top;</span><br><span class="line">       <span class="keyword">case</span> View.FOCUS_DOWN:</span><br><span class="line">           <span class="keyword">return</span> (srcRect.top &lt; destRect.top || srcRect.bottom &lt;= destRect.top)</span><br><span class="line">                   &amp;&amp; srcRect.bottom &lt; destRect.bottom;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"direction must be one of "</span></span><br><span class="line">           + <span class="string">"&#123;FOCUS_UP, FOCUS_DOWN, FOCUS_LEFT, FOCUS_RIGHT&#125;."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»£ç æ¯”è¾ƒç®€å•ã€‚å†å›åˆ° <a href="#FocusFinder.isBetterCandidate">FocusFinder::isBetterCandidate</a> çš„ä»£ç é€»è¾‘ï¼š</p>
<ul>
<li>å¦‚æœrect1ä¸æ»¡è¶³åŸºæœ¬æ¡ä»¶ï¼Œåˆ™è‚¯å®šè¿”å›falseï¼ˆåŸºæœ¬çš„æ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼‰</li>
<li>å¦‚æœrect2ä¸æ»¡è¶³åŸºæœ¬æ¡ä»¶ï¼Œåˆ™è¿”å›trueï¼Œè®¤ä¸ºrect1æ›´ä¼˜</li>
<li>å¦‚æœéƒ½æ»¡è¶³åŸºæœ¬æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡<code>FocusFinder::beamBeats</code>æ–¹æ³•æ¥åˆ¤æ–­å“ªç§æ›´ä¼˜</li>
</ul>
<p>æ¥ä¸‹æ¥çœ‹ä¸‹<code>FocusFinder::beamBeats</code>çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">beamBeats</span><span class="params">(<span class="keyword">int</span> direction, Rect source, Rect rect1, Rect rect2)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">final</span> <span class="keyword">boolean</span> rect1InSrcBeam = beamsOverlap(direction, source, rect1);</span><br><span class="line">   <span class="keyword">final</span> <span class="keyword">boolean</span> rect2InSrcBeam = beamsOverlap(direction, source, rect2);</span><br><span class="line"></span><br><span class="line">   <span class="comment">// if rect1 isn't exclusively in the src beam, it doesn't win</span></span><br><span class="line">   <span class="keyword">if</span> (rect2InSrcBeam || !rect1InSrcBeam) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// we know rect1 is in the beam, and rect2 is not</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">// if rect1 is to the direction of, and rect2 is not, rect1 wins.</span></span><br><span class="line">   <span class="comment">// for example, for direction left, if rect1 is to the left of the source</span></span><br><span class="line">   <span class="comment">// and rect2 is below, then we always prefer the in beam rect1, since rect2</span></span><br><span class="line">   <span class="comment">// could be reached by going down.</span></span><br><span class="line">   <span class="keyword">if</span> (!isToDirectionOf(direction, source, rect2)) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// for horizontal directions, being exclusively in beam always wins</span></span><br><span class="line">   <span class="keyword">if</span> ((direction == View.FOCUS_LEFT || direction == View.FOCUS_RIGHT)) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">   &#125;        </span><br><span class="line"></span><br><span class="line">   <span class="comment">// for vertical directions, beams only beat up to a point:</span></span><br><span class="line">   <span class="comment">// now, as long as rect2 isn't completely closer, rect1 wins</span></span><br><span class="line">   <span class="comment">// e.g for direction down, completely closer means for rect2's top</span></span><br><span class="line">   <span class="comment">// edge to be closer to the source's top edge than rect1's bottom edge.</span></span><br><span class="line">   <span class="keyword">return</span> (majorAxisDistance(direction, source, rect1)</span><br><span class="line">           &lt; majorAxisDistanceToFarEdge(direction, source, rect2));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆé€šè¿‡<code>beamsOverlap</code>æ–¹æ³•æ¥åˆ¤æ–­ä¸¤ä¸ªrectä¸sourceæ˜¯å¦é‡å ç­‰ç­‰ã€‚<strong>æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ°´å¹³æƒ…å†µä¸‹ï¼Œå¦‚æœrect1é‡å ï¼Œåˆ™å°±æ˜¯æœ€ä¼˜è§£ï¼ˆä¸ºä»€ä¹ˆï¼Ÿæ¯”è¾ƒå¥‡æ€ªï¼‰</strong>ï¼Œæœ€å<strong>å¦‚æœæ˜¯ç«–ç›´æƒ…å†µ</strong>ï¼Œé€šè¿‡<code>FocusFinder::majorAxisDistance</code>æ–¹æ³•æ¥åˆ¤æ–­å“ªä¸ªç¦»sourceæœ€è¿‘ã€‚å¦‚æœè¿˜æ˜¯æ¯”è¾ƒä¸å‡ºï¼Œåˆ™é€šè¿‡<code>getWeightedDistanceFor</code>æ–¹æ³•æ¥é€šè¿‡â€œä¸»è¦è·ç¦»â€å’Œâ€œæ¬¡è¦è·ç¦»â€åšä¸€ä¸ªç»¼åˆçš„æ¯”è¾ƒã€‚</p>
<h2 id="RecyclerView"><a href="#RecyclerView" class="headerlink" title="RecyclerView"></a>RecyclerView</h2><p>ç»§ç»­ <a href="#focusSearch">focusSearch</a> ä»£ç çš„åˆ†æï¼Œåˆšåˆšåªè·Ÿäº†<code>ViewGroup</code>ï¼Œè¿˜æœ‰ä¸€ä¸ªå®ç°æ˜¯<code>RecyclerView</code>çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">focusSearch</span><span class="params">(View focused, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">   View result = mLayout.onInterceptFocusSearch(focused, direction);</span><br><span class="line">   <span class="keyword">if</span> (result != <span class="keyword">null</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆé€šè¿‡<code>onInterceptFocusSearch</code>è¿›è¡Œæ‹¦æˆªï¼Œå¦‚æœè¿”å›å…·ä½“çš„focus Viewï¼Œåˆ™ç›´æ¥è¿”å›ï¼›å¦åˆ™ç»§ç»­å¾€ä¸‹ï¼›<code>onInterceptFocusSearch</code>å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">onInterceptFocusSearch</span><span class="params">(View focused, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é»˜è®¤ä¸ºç©ºå®ç°ï¼Œè¿”å›nullï¼Œä¹Ÿæ²¡æœ‰å…¶å®ƒçš„å­ç±»è¿›è¡Œé‡å†™ï¼Œæ‰€ä»¥æš‚æ—¶ä¸ç®¡è¿™ä¸ªå¤„ç†ï¼Œç»§ç»­çœ‹<code>focusSearch</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">focusSearch</span><span class="params">(View focused, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">   View result = mLayout.onInterceptFocusSearch(focused, direction);</span><br><span class="line">   <span class="keyword">if</span> (result != <span class="keyword">null</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">final</span> <span class="keyword">boolean</span> canRunFocusFailure = mAdapter != <span class="keyword">null</span> &amp;&amp; mLayout != <span class="keyword">null</span></span><br><span class="line">           &amp;&amp; !isComputingLayout() &amp;&amp; !mLayoutFrozen;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">final</span> FocusFinder ff = FocusFinder.getInstance();</span><br><span class="line">   <span class="keyword">if</span> (canRunFocusFailure</span><br><span class="line">           &amp;&amp; (direction == View.FOCUS_FORWARD || direction == View.FOCUS_BACKWARD)) &#123;</span><br><span class="line">       <span class="comment">// convert direction to absolute direction and see if we have a view there and if not</span></span><br><span class="line">       <span class="comment">// tell LayoutManager to add if it can.</span></span><br><span class="line">       <span class="keyword">boolean</span> needsFocusFailureLayout = <span class="keyword">false</span>;</span><br><span class="line">       <span class="keyword">if</span> (mLayout.canScrollVertically()) &#123;</span><br><span class="line">           <span class="keyword">final</span> <span class="keyword">int</span> absDir =</span><br><span class="line">                   direction == View.FOCUS_FORWARD ? View.FOCUS_DOWN : View.FOCUS_UP;</span><br><span class="line">           <span class="keyword">final</span> View found = ff.findNextFocus(<span class="keyword">this</span>, focused, absDir);</span><br><span class="line">           needsFocusFailureLayout = found == <span class="keyword">null</span>;</span><br><span class="line">           <span class="keyword">if</span> (FORCE_ABS_FOCUS_SEARCH_DIRECTION) &#123;</span><br><span class="line">               <span class="comment">// Workaround for broken FOCUS_BACKWARD in API 15 and older devices.</span></span><br><span class="line">               direction = absDir;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (!needsFocusFailureLayout &amp;&amp; mLayout.canScrollHorizontally()) &#123;</span><br><span class="line">           <span class="keyword">boolean</span> rtl = mLayout.getLayoutDirection() == ViewCompat.LAYOUT_DIRECTION_RTL;</span><br><span class="line">           <span class="keyword">final</span> <span class="keyword">int</span> absDir = (direction == View.FOCUS_FORWARD) ^ rtl</span><br><span class="line">                   ? View.FOCUS_RIGHT : View.FOCUS_LEFT;</span><br><span class="line">           <span class="keyword">final</span> View found = ff.findNextFocus(<span class="keyword">this</span>, focused, absDir);</span><br><span class="line">           needsFocusFailureLayout = found == <span class="keyword">null</span>;</span><br><span class="line">           <span class="keyword">if</span> (FORCE_ABS_FOCUS_SEARCH_DIRECTION) &#123;</span><br><span class="line">               <span class="comment">// Workaround for broken FOCUS_BACKWARD in API 15 and older devices.</span></span><br><span class="line">               direction = absDir;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (needsFocusFailureLayout) &#123;</span><br><span class="line">           consumePendingUpdateOperations();</span><br><span class="line">           <span class="keyword">final</span> View focusedItemView = findContainingItemView(focused);</span><br><span class="line">           <span class="keyword">if</span> (focusedItemView == <span class="keyword">null</span>) &#123;</span><br><span class="line">               <span class="comment">// panic, focused view is not a child anymore, cannot call super.</span></span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           eatRequestLayout();</span><br><span class="line">           mLayout.onFocusSearchFailed(focused, direction, mRecycler, mState);</span><br><span class="line">           resumeRequestLayout(<span class="keyword">false</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       result = ff.findNextFocus(<span class="keyword">this</span>, focused, direction);</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       result = ff.findNextFocus(<span class="keyword">this</span>, focused, direction);</span><br><span class="line">       <span class="keyword">if</span> (result == <span class="keyword">null</span> &amp;&amp; canRunFocusFailure) &#123;</span><br><span class="line">           consumePendingUpdateOperations();</span><br><span class="line">           <span class="keyword">final</span> View focusedItemView = findContainingItemView(focused);</span><br><span class="line">           <span class="keyword">if</span> (focusedItemView == <span class="keyword">null</span>) &#123;</span><br><span class="line">               <span class="comment">// panic, focused view is not a child anymore, cannot call super.</span></span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           eatRequestLayout();</span><br><span class="line">           result = mLayout.onFocusSearchFailed(focused, direction, mRecycler, mState);</span><br><span class="line">           resumeRequestLayout(<span class="keyword">false</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span> (result != <span class="keyword">null</span> &amp;&amp; !result.hasFocusable()) &#123;</span><br><span class="line">       <span class="keyword">if</span> (getFocusedChild() == <span class="keyword">null</span>) &#123;</span><br><span class="line">           <span class="comment">// Scrolling to this unfocusable view is not meaningful since there is no currently</span></span><br><span class="line">           <span class="comment">// focused view which RV needs to keep visible.</span></span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">super</span>.focusSearch(focused, direction);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// If the next view returned by onFocusSearchFailed in layout manager has no focusable</span></span><br><span class="line">       <span class="comment">// views, we still scroll to that view in order to make it visible on the screen.</span></span><br><span class="line">       <span class="comment">// If it's focusable, framework already calls RV's requestChildFocus which handles</span></span><br><span class="line">       <span class="comment">// bringing this newly focused item onto the screen.</span></span><br><span class="line">       requestChildOnScreen(result, <span class="keyword">null</span>);</span><br><span class="line">       <span class="keyword">return</span> focused;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> isPreferredNextFocus(focused, result, direction)</span><br><span class="line">           ? result : <span class="keyword">super</span>.focusSearch(focused, direction);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æš‚æ—¶åªè€ƒè™‘<code>direction</code>ä¸ºleftï¼Œtopï¼Œrightï¼Œdownçš„æƒ…å†µï¼Œåˆ™è¿›å…¥æœ€å¤–é¢ifçš„elseåˆ†æ”¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">focusSearch</span><span class="params">(View focused, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    result = ff.findNextFocus(<span class="keyword">this</span>, focused, direction);</span><br><span class="line">    <span class="keyword">if</span> (result == <span class="keyword">null</span> &amp;&amp; canRunFocusFailure) &#123;</span><br><span class="line">     consumePendingUpdateOperations();</span><br><span class="line">     <span class="keyword">final</span> View focusedItemView = findContainingItemView(focused);</span><br><span class="line">     <span class="keyword">if</span> (focusedItemView == <span class="keyword">null</span>) &#123;</span><br><span class="line">         <span class="comment">// panic, focused view is not a child anymore, cannot call super.</span></span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     eatRequestLayout();</span><br><span class="line">     result = mLayout.onFocusSearchFailed(focused, direction, mRecycler, mState);</span><br><span class="line">     resumeRequestLayout(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆé€šè¿‡<code>FocusFinder::findNextFocus</code>æ–¹æ³•æ¥è·å–ä¸‹ä¸€ä¸ªåº”è¯¥è·å¾—ç„¦ç‚¹çš„Viewï¼Œè¿™é‡Œè·å–çš„ç»“æœä¸ <a href="#FocusFinder.findNextFocus">FocusFinder::findNextFocus</a> é€»è¾‘ä¸€è‡´ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> source code </tag>
            
            <tag> focus </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidå†…å­˜æ³„æ¼ä½ æ‰€è¦çŸ¥é“çš„ä¸€åˆ‡ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2017/07/25/Android-Android%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E4%BD%A0%E6%89%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%80%E5%88%87%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="Androidå†…å­˜æ³„æ¼ä½ æ‰€è¦çŸ¥é“çš„ä¸€åˆ‡"><a href="#Androidå†…å­˜æ³„æ¼ä½ æ‰€è¦çŸ¥é“çš„ä¸€åˆ‡" class="headerlink" title="Androidå†…å­˜æ³„æ¼ä½ æ‰€è¦çŸ¥é“çš„ä¸€åˆ‡"></a>Androidå†…å­˜æ³„æ¼ä½ æ‰€è¦çŸ¥é“çš„ä¸€åˆ‡</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://blog.aritraroy.in/everything-you-need-to-know-about-memory-leaks-in-android-apps-655f191ca859" target="_blank" rel="noopener">https://blog.aritraroy.in/everything-you-need-to-know-about-memory-leaks-in-android-apps-655f191ca859</a></p>
</blockquote>
<p>å†™ä¸€ä¸ªAndroid appå¾ˆç®€å•ï¼Œä½†æ˜¯<strong>å†™ä¸€ä¸ªè¶…é«˜å“è´¨çš„å†…å­˜é«˜æ•ˆçš„Android appå¹¶ä¸ç®€å•</strong>ã€‚ä»æˆ‘çš„ä¸ªäººç»éªŒæ¥è¯´ï¼Œæˆ‘æ›¾ç»æ¯”è¾ƒå…³æ³¨å’Œæ„Ÿå…´è¶£æ„å»ºæˆ‘appçš„æ–°ç‰¹æ€§ï¼ŒåŠŸèƒ½å’ŒUIç»„ä»¶ã€‚</p>
<p>æˆ‘ä¸»è¦å€¾å‘äºå·¥ä½œåœ¨å…·æœ‰æ›´å¤šè§†è§‰å†²å‡»åŠ›çš„ä¸œè¥¿ï¼Œè€Œä¸æ˜¯èŠ±æ—¶é—´åœ¨æ²¡æœ‰äººä¸€çœ¼ä¼šæ³¨æ„åˆ°çš„ä¸œè¥¿ä¸Šé¢ã€‚æˆ‘å¼€å§‹å…»æˆäº†é¿å…æˆ–è€…ç»™appä¼˜åŒ–ç­‰äº‹æƒ…æ›´ä½ä¼˜å…ˆçº§çš„ä¹ æƒ¯ï¼ˆæ£€æµ‹å’Œä¿®å¤å†…å­˜æ³„æ¼å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªï¼‰ã€‚</p>
<p>è¿™è‡ªç„¶è€Œç„¶å¯¼è‡´æˆ‘æ‰¿æ‹…èµ·äº†æŠ€æœ¯è´Ÿå€ºï¼Œä»é•¿è¿œæ¥çœ‹ï¼Œå®ƒå¼€å§‹å½±å“æˆ‘çš„åº”ç”¨çš„æ€§èƒ½å’Œè´¨é‡ã€‚æˆ‘æ»¡æ»¡åœ°æ”¹å˜äº†æˆ‘çš„å¿ƒæ€ï¼Œæ¯”èµ·å»å¹´æˆ‘æ›´å¤šåœ°ä»¥â€œæ€§èƒ½ä¸ºé‡ç‚¹â€ã€‚</p>
<a id="more"></a>
<p><strong>å†…å­˜æ³„æ¼çš„æ¦‚å¿µå¯¹å¾ˆå¤šçš„å¼€å‘è€…æ¥è¯´æ˜¯éå¸¸è‰°å·¨çš„ã€‚</strong>ä»–ä»¬è§‰å¾—è¿™æ˜¯å›°éš¾ï¼Œè€—æ—¶ï¼Œæ— èŠå’Œä¸å¿…è¦çš„ï¼Œä½†å¹¸è¿çš„æ˜¯ï¼Œè¿™äº›éƒ½ä¸æ˜¯çœŸçš„ã€‚ä¸€æ—¦ä½ å¼€å§‹æ·±å…¥ï¼Œä½ å°†ç»å¯¹ä¼šçˆ±ä¸Šå®ƒã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å°è¯•è®©è¿™ä¸ªè¯é¢˜å°½å¯èƒ½åœ°ç®€å•ï¼Œè¿™æ ·å³ä½¿æ˜¯æ–°çš„å¼€å‘è€…ä¹Ÿèƒ½ä»ä»–ä»¬çš„èŒä¸šç”Ÿæ¶¯ä¸€å¼€å§‹å°±èƒ½æ„å»ºé«˜è´¨é‡å’Œé«˜æ€§èƒ½çš„Android appsã€‚</p>
<h2 id="åƒåœ¾æ”¶é›†å™¨æ˜¯ä½ çš„æœ‹å‹ï¼Œä½†ä¸ä¸€ç›´æ˜¯"><a href="#åƒåœ¾æ”¶é›†å™¨æ˜¯ä½ çš„æœ‹å‹ï¼Œä½†ä¸ä¸€ç›´æ˜¯" class="headerlink" title="åƒåœ¾æ”¶é›†å™¨æ˜¯ä½ çš„æœ‹å‹ï¼Œä½†ä¸ä¸€ç›´æ˜¯"></a>åƒåœ¾æ”¶é›†å™¨æ˜¯ä½ çš„æœ‹å‹ï¼Œä½†ä¸ä¸€ç›´æ˜¯</h2><p><strong>Javaæ˜¯ä¸€ä¸ªå¼ºå¤§çš„è¯­è¨€</strong>ã€‚åœ¨Androidä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šï¼ˆæœ‰æ—¶å€™æˆ‘ä»¬ä¼šï¼‰åƒ C æˆ–è€… C++ é‚£æ ·å»å†™ä»£ç æ¥è®©æˆ‘ä»¬è‡ªå·±å»ç®¡ç†æ•´ä¸ªå†…å­˜åˆ†é…å’Œé‡Šæ”¾ã€‚</p>
<p>ç°åœ¨æµ®ç°åœ¨æˆ‘è„‘ä¸­çš„ç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œæ—¢ç„¶Javaæœ‰äº†ä¸€ä¸ªå†…ç½®ä¸“ç”¨çš„å†…å­˜ç®¡ç†ç³»ç»Ÿï¼Œå®ƒä¼šåœ¨æˆ‘ä»¬ä¸éœ€è¦æ—¶æ¸…ç†å†…å­˜ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦å…³å¿ƒè¿™ä¸ªå‘¢ã€‚<em>æ˜¯åƒåœ¾æ”¶é›†å™¨ä¸å¤Ÿå®Œå–„ï¼Ÿ</em></p>
<p>ä¸ï¼Œå½“ç„¶ä¸æ˜¯ã€‚<strong>åƒåœ¾æ”¶é›†å™¨çš„å·¥ä½œåŸç†å°±æ˜¯å¦‚æ­¤</strong>ã€‚ä½†æ˜¯æˆ‘ä»¬è‡ªå·±ç¼–ç¨‹é”™è¯¯æœ‰æ—¶å°±ä¼šé˜»æ­¢åƒåœ¾æ”¶é›†å™¨æ”¶é›†å¤§é‡ä¸å¿…è¦çš„å†…å­˜ã€‚</p>
<p>æ‰€ä»¥åŸºæœ¬ä¸Šï¼Œéƒ½æ˜¯æˆ‘ä»¬è‡ªå·±çš„é”™è¯¯æ‰å¯¼è‡´äº†ä¸€åˆ‡çš„æ··ä¹±ã€‚<strong>åƒåœ¾æ”¶é›†å™¨æ˜¯Javaæœ€å¥½çš„æˆå°±ä¹‹ä¸€</strong>ï¼Œå®ƒå€¼å¾—è¢«å°Šé‡ã€‚</p>
<p><strong><a href="https://blog.aritraroy.in/what-my-2-years-of-android-development-have-taught-me-the-hard-way-52b495ba5c51" target="_blank" rel="noopener">æ¨èé˜…è¯»</a></strong></p>
<h2 id="åƒåœ¾æ”¶é›†å™¨â€œæ›´å¤šçš„ä¸€ç‚¹â€"><a href="#åƒåœ¾æ”¶é›†å™¨â€œæ›´å¤šçš„ä¸€ç‚¹â€" class="headerlink" title="åƒåœ¾æ”¶é›†å™¨â€œæ›´å¤šçš„ä¸€ç‚¹â€"></a>åƒåœ¾æ”¶é›†å™¨â€œæ›´å¤šçš„ä¸€ç‚¹â€</h2><p>åœ¨è¿›ä¸€æ­¥ä¹‹å‰ï¼Œä½ éœ€è¦äº†è§£ä¸€ç‚¹åƒåœ¾æ”¶é›†å™¨çš„å·¥ä½œåŸç†ã€‚<strong>å®ƒçš„åŸç†éå¸¸ç®€å•</strong>ï¼Œä½†æ˜¯å®ƒçš„å†…éƒ¨æœ‰æ—¶å€™éå¸¸å¤æ‚ã€‚ä½†æ˜¯ä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬å°†ä¸»è¦å…³æ³¨ç®€å•çš„éƒ¨åˆ†ã€‚</p>
<p><img src="http://images2015.cnblogs.com/blog/378300/201707/378300-20170724130625383-711376452.png" alt=""></p>
<p>æ¯ä¸€ä¸ªAndroidï¼ˆæˆ–è€…Javaï¼‰åº”ç”¨ç¨‹åºéƒ½æœ‰ä¸€ä¸ªä»å¯¹è±¡å¼€å§‹è·å–å®ä¾‹åŒ–ã€æ–¹æ³•è¢«è°ƒç”¨çš„èµ·ç‚¹ã€‚<strong>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™ä¸ªèµ·ç‚¹æ˜¯å†…å­˜æ ‘çš„â€œrootâ€</strong>ã€‚ä¸€äº›å¯¹è±¡ç›´æ¥ä¿æŒäº†ä¸€ä¸ªå¯¹â€œrootâ€çš„å¼•ç”¨ï¼Œå¹¶ä¸”ä»å®ƒä»¬ä¸­å®ä¾‹åŒ–å…¶å®ƒå¯¹è±¡ï¼Œä¿æŒè¿™äº›å¯¹è±¡çš„å¼•ç”¨ç­‰ç­‰ã€‚</p>
<p>å› è€Œï¼Œå½¢æˆäº†åˆ›å»ºå†…å­˜æ ‘çš„å¼•ç”¨é“¾ã€‚æ‰€ä»¥ï¼Œåƒåœ¾æ”¶é›†å™¨ä»GC rootså¼€å§‹ï¼Œç„¶åç›´æ¥æˆ–é—´æ¥éå†å¯¹è±¡é“¾æ¥åˆ°æ ¹ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹çš„æœ€åï¼Œå­˜åœ¨ä¸€äº›GCä»æ¥æ²¡æœ‰è®¿é—®åˆ°çš„å¯¹è±¡ã€‚</p>
<p><strong>è¿™äº›æ˜¯ä½ çš„åƒåœ¾ï¼ˆæˆ–è€…dead objectsï¼‰</strong>ï¼Œè¿™äº›å¯¹è±¡å°±æ˜¯æˆ‘ä»¬æ‰€é’Ÿçˆ±çš„åƒåœ¾æ”¶é›†å™¨æœ‰èµ„æ ¼å»æ”¶é›†çš„ã€‚</p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªç«¥è¯æ•…äº‹ï¼Œä½†è®©æˆ‘ä»¬æ·±å…¥äº†è§£ä¸€ä¸‹å¼€å§‹çœŸæ­£çš„ä¹è¶£ã€‚</p>
<p><strong>Bonus:</strong> å¦‚æœä½ å¸Œæœ›å­¦ä¹ æ›´å¤šå…³äºåƒåœ¾æ”¶é›†å™¨ï¼Œæˆ‘å¼ºçƒˆæ¨èä½ çœ‹ä¸‹ <a href="https://www.youtube.com/watch?v=UnaNQgzw4zY" target="_blank" rel="noopener">è¿™é‡Œ</a> å’Œ <a href="http://www.cubrid.org/blog/dev-platform/understanding-java-garbage-collection/" target="_blank" rel="noopener">è¿™é‡Œ</a> ã€‚</p>
<h2 id="é‚£ä¹ˆç°åœ¨ï¼Œä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼å‘¢ï¼Ÿ"><a href="#é‚£ä¹ˆç°åœ¨ï¼Œä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼å‘¢ï¼Ÿ" class="headerlink" title="é‚£ä¹ˆç°åœ¨ï¼Œä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼å‘¢ï¼Ÿ"></a>é‚£ä¹ˆç°åœ¨ï¼Œä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼å‘¢ï¼Ÿ</h2><p>çŸ¥é“ç°åœ¨ï¼Œä½ æœ‰äº†ä¸€ä¸ªç®€å•æƒ³æ³•çš„åƒåœ¾æ”¶é›†å™¨ï¼Œé‚£ä¹ˆï¼Œåœ¨Android appsä¸­å†…å­˜ç®¡ç†å¸ˆæ€ä¹ˆå·¥ä½œçš„ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å…³æ³¨äºæ›´è¯¦ç»†çš„å†…å­˜æ³„æ¼è¿™ä¸ªè¯é¢˜ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œ<strong>å†…å­˜æ³„æ¼å‘ç”Ÿåœ¨å½“ä½ é•¿æ—¶é—´æŒæœ‰ä¸€ä¸ªå·²ç»è¾¾åˆ°ç›®çš„çš„å¯¹è±¡</strong>ã€‚å®é™…çš„æ¦‚å¿µå°±è¿™ä¹ˆç®€å•ã€‚</p>
<p>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰å®ƒè‡ªå·±çš„ç”Ÿå‘½ï¼Œä¹‹åå®ƒéœ€è¦è¯´æ‹œæ‹œï¼Œç„¶åé‡Šæ”¾å†…å­˜ã€‚ä½†æ˜¯å¦‚æœä¸€äº›å¯¹è±¡æŒæœ‰è¿™ä¸ªå¯¹è±¡ï¼ˆç›´æ¥æˆ–é—´æ¥ï¼‰ï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±æ— æ³•æ”¶é›†å®ƒã€‚<strong>è¿™å°±æ˜¯æˆ‘ä»¬çš„æœ‹å‹ï¼Œå†…å­˜æ³„æ¼</strong>ã€‚</p>
<p>ä½†æ˜¯æœ‰ä¸ªå¥½æ¶ˆæ¯å°±æ˜¯ä½ ä¸éœ€è¦æ‹…å¿ƒä½ appä¸­çš„æ¯ä¸€å¤„çš„å†…å­˜æ³„æ¼ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„å†…å­˜æ³„æ¼éƒ½ä¼šä¼¤å®³ä½ çš„appã€‚</p>
<p>æœ‰ä¸€äº›æ³„æ¼çœŸçš„éå¸¸å°ï¼ˆæ³„æ¼äº†å‡ åƒå­—èŠ‚çš„å†…å­˜ï¼‰ï¼Œæœ‰äº›å­˜åœ¨äºAndroid frameworkæœ¬èº«ï¼ˆæ˜¯çš„ï¼Œä½ æ²¡çœ‹é”™ï¼‰ï¼Œè¿™äº›ä½ ä¸èƒ½ä¹Ÿä¸éœ€è¦å»ä¿®å¤ã€‚ä»–ä»¬é€šå¸¸å¯¹äºä½ çš„appå½±å“å¾ˆå°å¹¶ä¸”ä½ å¯ä»¥å®‰å…¨åœ°å¿½ç•¥å®ƒä»¬ã€‚</p>
<p>ä½†æ˜¯ä¹Ÿå­˜åœ¨å…¶å®ƒçš„å¯ä»¥<strong>è®©ä½ çš„åº”ç”¨ç¨‹åºå´©æºƒï¼Œä½¿å®ƒåƒåœ°ç‹±ä¸€æ ·æ»ç•™ï¼Œå¹¶å°†å…¶é€å­—ç¼©å°</strong>ã€‚è¿™äº›æ˜¯ä½ è¦å…³æ³¨çš„ä¸œè¥¿ã€‚</p>
<p><strong><a href="https://blog.aritraroy.in/20-awesome-open-source-android-apps-to-boost-your-development-skills-b62832cf0fa4" target="_blank" rel="noopener">æ¨èé˜…è¯»</a></strong></p>
<h2 id="ä¸ºä»€ä¹ˆä½ çœŸçš„éœ€è¦è§£å†³å†…å­˜æ³„æ¼ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä½ çœŸçš„éœ€è¦è§£å†³å†…å­˜æ³„æ¼ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä½ çœŸçš„éœ€è¦è§£å†³å†…å­˜æ³„æ¼ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä½ çœŸçš„éœ€è¦è§£å†³å†…å­˜æ³„æ¼ï¼Ÿ</h2><p>æ²¡æœ‰äººå¸Œæœ›ä½¿ç”¨<strong>ä¸€ä¸ªç¼“æ…¢çš„ã€è¿Ÿé’çš„ã€åƒå¾ˆå¤šå†…å­˜ã€æ¯ç”¨å‡ åˆ†é’Ÿå°±ä¼šcrashçš„app</strong>ã€‚å¯¹äºç”¨æˆ·é•¿æ—¶é—´ä½¿ç”¨ï¼Œå®ƒçœŸçš„ä¼šåˆ›å»ºä¸€ä¸ªç³Ÿç³•çš„ä½“éªŒï¼Œç„¶åä½ å°±æœ‰æ°¸è¿œå¤±å»ç”¨æˆ·çš„å¯èƒ½æ€§ã€‚</p>
<p><img src="http://images2015.cnblogs.com/blog/378300/201707/378300-20170724160146731-1663679590.png" alt=""></p>
<p>éšç€ç”¨æˆ·ç»§ç»­ä½¿ç”¨ä½ çš„appï¼Œå †å†…å­˜ä¹Ÿä¸æ–­åœ°å¢é•¿ï¼Œå¦‚æœä½ çš„appä¸­æœ‰å†…å­˜æ³„æ¼ï¼Œé‚£ä¹ˆGCå°±æ— æ³•é‡Šæ”¾ä½ æ— ç”¨çš„å†…å­˜ã€‚æ‰€ä»¥ä½ appçš„å †å†…å­˜å°±ä¼šç»å¸¸å¢é•¿ï¼Œç›´åˆ°è¾¾åˆ°ä¸€ä¸ªæ­»äº¡çš„ç‚¹ï¼Œ<strong>è¿™æ—¶å°†æ²¡æœ‰æ›´å¤šçš„å†…å­˜åˆ†é…ç»™ä½ çš„appï¼Œä»è€Œå¯¼è‡´å¯æ€•çš„ <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/OutOfMemoryError.html" target="_blank" rel="noopener">OutOfMemoryError</a> å¹¶æœ€ç»ˆè®©ä½ çš„åº”ç”¨ç¨‹åºå´©æºƒã€‚</strong></p>
<p>ä½ è¿˜è¦å¿…é¡»è®°ä½ä¸€ä»¶äº‹æƒ…ï¼Œåƒåœ¾æ”¶é›†å™¨æ˜¯ä¸€ä¸ªç¹é‡çš„è¿‡ç¨‹ï¼Œ<em>åƒåœ¾æ”¶é›†å™¨è·‘å¾—è¶Šå°‘ï¼Œå¯¹ä½ çš„appå°±è¶Šå¥½ã€‚</em></p>
<p>Appæ­£åœ¨è¢«ä½¿ç”¨ï¼Œå¯¹å†…å­˜ä¿æŒç€å¢é•¿çŠ¶æ€ï¼Œä¸€ä¸ªå°çš„GCå°†å¯åŠ¨å¹¶å°è¯•æ¸…é™¤åˆšåˆšæ­»äº¡çš„å¯¹è±¡ã€‚ç°åœ¨è¿™äº›å°çš„GCåŒæ—¶è¿è¡Œç€ï¼ˆåœ¨å•ç‹¬çš„çº¿ç¨‹ä¸Šï¼‰ï¼Œå¹¶ä¸”ä¸ä¼šå‡ç¼“ä½ çš„appï¼ˆ2-5msçš„æš‚åœï¼‰ã€‚</p>
<p><strong>ä½†æ˜¯å¦‚æœä½ çš„appå†…éƒ¨æœ‰ä¸¥é‡çš„å†…å­˜æ³„æ¼çš„é—®é¢˜</strong>ï¼Œé‚£ä¹ˆè¿™äº›å°çš„GCæ— æ³•å»å›æ”¶è¿™äº›å†…å­˜ï¼Œå¹¶ä¸”å †è¿˜åœ¨æŒç»­å¢é•¿ï¼Œä»è€Œè¿«ä½¿æ›´å¤§çš„GCè¢«å¯åŠ¨ï¼Œè¿™é€šå¸¸æ˜¯ä¸€ä¸ªâ€<a href="https://plumbr.eu/blog/garbage-collection/minor-gc-vs-major-gc-vs-full-gc" target="_blank" rel="noopener">åœæ­¢ä¸–ç•Œ</a> çš„GCâ€ï¼Œå®ƒä¼šæš‚åœæ•´ä¸ªappä¸»çº¿ç¨‹ï¼ˆå¤§çº¦50-100msï¼‰ï¼Œä»è€Œ<strong>ä½¿ä½ çš„appä¸¥é‡æ»åï¼Œç”šè‡³æœ‰æ—¶å‡ ä¹ä¸å¯ç”¨</strong>ã€‚</p>
<p>æ‰€ä»¥ç°åœ¨ä½ çŸ¥é“è¿™äº›å†…å­˜æ³„æ¼å¯èƒ½å¯¹ä½ çš„åº”ç”¨ç¨‹åºäº§ç”Ÿçš„å½±å“ï¼Œä»¥åŠ<strong>ä¸ºä»€ä¹ˆéœ€è¦ç«‹å³ä¿®å¤å®ƒä»¬</strong>ï¼Œä¸ºç”¨æˆ·æä¾›ä»–ä»¬åº”å¾—çš„æœ€ä½³ä½“éªŒã€‚</p>
<h2 id="æ€ä¹ˆå»æ£€æµ‹è¿™äº›å†…å­˜æ³„æ¼ï¼Ÿ"><a href="#æ€ä¹ˆå»æ£€æµ‹è¿™äº›å†…å­˜æ³„æ¼ï¼Ÿ" class="headerlink" title="æ€ä¹ˆå»æ£€æµ‹è¿™äº›å†…å­˜æ³„æ¼ï¼Ÿ"></a>æ€ä¹ˆå»æ£€æµ‹è¿™äº›å†…å­˜æ³„æ¼ï¼Ÿ</h2><p>ç›®å‰ä¸ºæ­¢ï¼Œä½ åº”è¯¥ç›¸å½“ä¿¡æœä½ éœ€è¦ä¿®å¤è¿™äº›éšè—åœ¨ä½ appä¸­çš„å†…å­˜æ³„æ¼ã€‚<strong>ä½†æ˜¯æ€ä¹ˆå»å®é™…æ£€æµ‹å®ƒä»¬å‘¢ï¼Ÿ</strong></p>
<p>ä¸é”™çš„æ˜¯ï¼Œå¯¹äºè¿™ç‚¹Android Studioæä¾›äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨ä¸”å¼ºå¤§çš„å·¥å…·ï¼Œ<strong>Monitors</strong>ã€‚è¿™ä¸ªæ˜¾ç¤ºå™¨ä¸ä»…å±•ç¤ºäº†å†…å­˜ä½¿ç”¨ï¼ŒåŒæ ·è¿˜æœ‰ç½‘ç»œã€CPUã€GPUä½¿ç”¨ï¼ˆæ›´å¤šä¿¡æ¯æŸ¥çœ‹<a href="https://developer.android.com/studio/profile/android-monitor.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼‰ã€‚</p>
<p><img src="http://images2015.cnblogs.com/blog/378300/201707/378300-20170724162545262-106537289.png" alt=""></p>
<p>å½“ä½ åœ¨ä½¿ç”¨å’Œè°ƒè¯•ä½ çš„appæ—¶ï¼Œåº”è¯¥å¯†åˆ‡å…³æ³¨è¿™ä¸ªå†…å­˜ç›‘è§†å™¨ã€‚<em>å†…å­˜æ³„æ¼çš„ç¬¬ä¸€ç—‡çŠ¶æ˜¯å½“ä½ æŒç»­ä½¿ç”¨ä½ çš„appæ—¶å†…å­˜ä½¿ç”¨å›¾è¡¨ç»å¸¸å¢é•¿</em>ï¼Œå¹¶ä¸”ä»ä¸ä¸‹é™ï¼Œç”šè‡³åœ¨ä½ åˆ‡æ¢åˆ°åå°åã€‚</p>
<p><a href="https://developer.android.com/studio/profile/am-allocation.html" target="_blank" rel="noopener">Allocation Tracker</a>å¯ä»¥æ´¾ä¸Šç”¨åœºï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥æ£€æŸ¥åˆ†é…ç»™åº”ç”¨ç¨‹åºä¸­ä¸åŒç±»å‹å¯¹è±¡çš„å†…å­˜ç™¾åˆ†æ¯”ã€‚</p>
<p>ä½†æ˜¯è¿™æœ¬èº«è¿˜ä¸å¤Ÿï¼Œå› ä¸ºä½ ç°åœ¨éœ€è¦ä½¿ç”¨<strong>Dump Java Heap</strong>é€‰é¡¹æ¥åˆ›å»ºä¸€ä¸ªå®é™…è¡¨ç¤ºç»™å®šæ—¶é—´å†…å­˜å¿«ç…§çš„<a href="https://developer.android.com/studio/profile/am-hprof.html" target="_blank" rel="noopener">heap dump</a>ã€‚çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªæ— èŠå’Œé‡å¤æ€§çš„å·¥ä½œï¼Œå¯¹å§ï¼Ÿå¯¹ï¼Œå®ƒç¡®å®æ˜¯ã€‚</p>
<p><img src="http://images2015.cnblogs.com/blog/378300/201707/378300-20170724163402043-410997.png" alt=""></p>
<p>æˆ‘ä»¬å·¥ç¨‹å¸ˆå¾€å¾€æ˜¯æ‡’æƒ°çš„ï¼Œ<strong>è¿™ç‚¹ <a href="https://github.com/square/leakcanary" target="_blank" rel="noopener">LeakCanary</a> æ¥æ•‘æ´äº†</strong>ã€‚è¿™ä¸ªåº“éšç€ä½ çš„appä¸€èµ·è¿è¡Œã€‚åœ¨éœ€è¦æ—¶dumpå‡ºå†…å­˜ï¼Œå¯»æ‰¾æ½œåœ¨çš„å†…å­˜æ³„æ¼å¹¶ä¸”é€šè¿‡ä¸€ä¸ªæ¸…æ™°æœ‰ç”¨çš„stack traceæ¥å¯»æ‰¾æ³„æ¼çš„æ ¹æºã€‚</p>
<p><em>LeakCanary è®©ä»»ä½•äººåœ¨ä»–ä»¬çš„appä¸­æ£€æµ‹æ³„æ¼å˜å¾—è¶…çº§ç®€å•</em>ã€‚æˆ‘ä¸èƒ½å†æ„Ÿè°¢ <a href="https://twitter.com/piwai" target="_blank" rel="noopener">Py</a>(æ¥è‡ª <a href="https://github.com/square" target="_blank" rel="noopener">Square</a>)å†™äº†å¦‚æ­¤æƒŠäººå’Œæ‹¯æ•‘äº†ç”Ÿå‘½çš„åº“äº†ã€‚å¥–åŠ±ï¼</p>
<p><strong>Bonus</strong>: å¦‚æœä½ æƒ³è¯¦ç»†å­¦ä¹ æ€ä¹ˆå……åˆ†ä½¿ç”¨è¿™ä¸ªåº“ï¼Œçœ‹<a href="https://realm.io/news/droidcon-ricau-memory-leaks-leakcanary/" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p>
<p><a href="https://blog.aritraroy.in/50-ultimate-resources-to-master-android-development-15165d6bc376" target="_blank" rel="noopener">æ¨èé˜…è¯»</a></p>
<h2 id="ä¸€äº›å®é™…å¸¸è§çš„å†…å­˜æ³„æ¼æƒ…å†µå¹¶æ€ä¹ˆå»è§£å†³å®ƒä»¬"><a href="#ä¸€äº›å®é™…å¸¸è§çš„å†…å­˜æ³„æ¼æƒ…å†µå¹¶æ€ä¹ˆå»è§£å†³å®ƒä»¬" class="headerlink" title="ä¸€äº›å®é™…å¸¸è§çš„å†…å­˜æ³„æ¼æƒ…å†µå¹¶æ€ä¹ˆå»è§£å†³å®ƒä»¬"></a>ä¸€äº›å®é™…å¸¸è§çš„å†…å­˜æ³„æ¼æƒ…å†µå¹¶æ€ä¹ˆå»è§£å†³å®ƒä»¬</h2><p>ä»æˆ‘ä»¬ç»éªŒæ¥çœ‹ï¼Œæœ‰å‡ ä¸ªæœ€å¸¸è§çš„å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æ³„æ¼çš„åœºæ™¯ï¼Œå®ƒä»¬éƒ½éå¸¸ç›¸ä¼¼ï¼Œä½ ä¼šåœ¨æ—¥å¸¸çš„Androidå¼€å‘ä¸­é‡åˆ°è¿™äº›æƒ…å†µã€‚</p>
<p>ä¸€æ—¦ä½ çŸ¥é“è¿™äº›å†…å­˜æ³„æ¼å‘ç”Ÿåœ¨ä»€ä¹ˆæ—¶å€™ï¼Œä»€ä¹ˆåœ°æ–¹ï¼Œæ€ä¹ˆå‘ç”Ÿï¼Œä½ å°±å¯ä»¥æ›´å®¹æ˜“å¯¹æ­¤è¿›è¡Œä¿®å¤ã€‚</p>
<h3 id="Unregistered-Listeners"><a href="#Unregistered-Listeners" class="headerlink" title="Unregistered Listeners"></a>Unregistered Listeners</h3><p>æœ‰å¾ˆå¤šåœºæ™¯ï¼Œä½ åœ¨Activityï¼ˆæˆ–è€…Fragmentï¼‰ä¸­è¿›è¡Œäº†ä¸€ä¸ªç›‘å¬å™¨çš„æ³¨å†Œï¼Œä½†æ˜¯å¿˜è®°æŠŠå®ƒåæ³¨å†Œæ‰ã€‚<strong>å¦‚æœè¿æ°”ä¸å¥½ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“å¯¼è‡´ä¸€ä¸ªå·¨å¤§çš„å†…å­˜æ³„æ¼</strong>ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™äº›ç›‘å¬å™¨æ˜¯å¹³è¡¡çš„ï¼Œæ‰€ä»¥å¦‚æœä½ åœ¨æŸäº›åœ°æ–¹æ³¨å†Œäº†å®ƒï¼Œä½ ä¹Ÿéœ€è¦åœ¨é‚£é‡Œåæ³¨å†Œå®ƒã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚å‡è®¾ä½ è¦åœ¨ä½ çš„appä¸­æ¥æ”¶åˆ°ä½ç½®çš„æ›´æ–°ï¼Œä½ è¦åšçš„äº‹å°±æ˜¯æ‹¿åˆ°ä¸€ä¸ª <a href="https://developer.android.com/reference/android/location/LocationManager.html" target="_blank" rel="noopener">LocationManager</a> ç³»ç»ŸæœåŠ¡ï¼Œç„¶åä¸ºä½ç½®æ›´æ–°æ³¨å†Œä¸€ä¸ªlistenerã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">registerLocationUpdates</span><span class="params">()</span></span>&#123;</span><br><span class="line">mManager = (LocationManager) getSystemService(LOCATION_SERVICE);</span><br><span class="line">mManager.requestLocationUpdates(LocationManager.GPS_PROVIDER,</span><br><span class="line">            TimeUnit.MINUTES.toMillis(<span class="number">1</span>), </span><br><span class="line">            <span class="number">100</span>, </span><br><span class="line">            <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ åœ¨Activityæœ¬èº«å®ç°äº†listeneræ¥å£ï¼Œ<em>å› æ­¤ LocationManager æŒæœ‰äº†ä¸€ä¸ªå®ƒçš„å¼•ç”¨</em>ã€‚ç°åœ¨ä½ çš„Activityæ˜¯æ—¶å€™è¦é”€æ¯äº†ï¼ŒAndroid Frameworkå°†ä¼šè°ƒç”¨å®ƒçš„ onDestroy() æ–¹æ³•ï¼Œä½†æ˜¯åƒåœ¾æ”¶é›†å™¨å°†ä¸èƒ½ä»å†…å­˜ä¸­æŠŠè¿™ä¸ªå®ä¾‹åˆ é™¤ï¼Œå› ä¸º LocationManager ä»ç„¶æŒæœ‰äº†å®ƒçš„å¼ºå¼•ç”¨ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆéå¸¸ç®€å•</strong>ã€‚ä»…ä»…åœ¨ onDestroy() æ–¹æ³•ä¸­åæ³¨å†Œæ‰listenerï¼Œè¿™ä¸ªå¾ˆå¥½å®ç°ã€‚è¿™æ˜¯æˆ‘ä»¬å¤§å¤šæ•°äººå¿˜è®°ç”šè‡³ä¸çŸ¥é“çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onDestroy();</span><br><span class="line">    <span class="keyword">if</span> (mManager != <span class="keyword">null</span>) &#123;</span><br><span class="line">        mManager.removeUpdates(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å†…éƒ¨ç±»"><a href="#å†…éƒ¨ç±»" class="headerlink" title="å†…éƒ¨ç±»"></a>å†…éƒ¨ç±»</h3><p>å†…éƒ¨ç±»åœ¨Javaä¸­éå¸¸å¸¸è§ï¼Œç”±äºå®ƒçš„ç®€æ´æ€§ï¼ŒAndroidå¼€å‘è€…ç»å¸¸ä½¿ç”¨åœ¨å„ç§ä»»åŠ¡ä¸­ã€‚ä½†æ˜¯ç”±äºä¸æ°å½“çš„ä½¿ç”¨ï¼Œ<em>è¿™äº›å†…éƒ¨ç±»ä¹Ÿå¯¼è‡´äº†æ½œåœ¨çš„å†…å­˜æ³„æ¼ã€‚</em></p>
<p>è®©æˆ‘ä»¬å†åœ¨ä¸€ä¸ªç®€å•ä¾‹å­çš„å¸®åŠ©ä¸‹çœ‹çœ‹ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BadActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> TextView mMessageView;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.layout_bad_activity);</span><br><span class="line">        mMessageView = (TextView) findViewById(R.id.messageView);</span><br><span class="line">        <span class="keyword">new</span> LongRunningTask().execute();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">LongRunningTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">Void</span>, <span class="title">Void</span>, <span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> String <span class="title">doInBackground</span><span class="params">(Void... params)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"Am finally done!"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPostExecute</span><span class="params">(String result)</span> </span>&#123;</span><br><span class="line">            mMessageView.setText(result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„Activityï¼Œå®ƒåœ¨åå°ï¼ˆä¹Ÿè®¸æ˜¯å¤æ‚çš„æ•°æ®åº“æŸ¥è¯¢æˆ–è€…ä¸€ä¸ªç¼“æ…¢çš„ç½‘ç»œè¯·æ±‚ï¼‰å¯åŠ¨äº†ä¸€ä¸ªè€—æ—¶ä»»åŠ¡ã€‚åœ¨Taskå®Œæˆæ—¶ï¼Œç»“æœè¢«å±•ç¤ºåœ¨ TextViewã€‚çœ‹èµ·æ¥ä¸€åˆ‡éƒ½å¾ˆå¥½ï¼Ÿ</p>
<p>ä¸ï¼Œå½“ç„¶ä¸æ˜¯ã€‚é—®é¢˜åœ¨äº<strong>éé™æ€å†…éƒ¨ç±»æŒæœ‰ä¸€ä¸ªå¤–éƒ¨ç±»çš„éšå¼å¼•ç”¨</strong>ï¼ˆä¹Ÿå°±æ˜¯Activityæœ¬èº«ï¼‰ã€‚ç°åœ¨å¦‚æœæˆ‘ä»¬æ—‹è½¬äº†å±å¹•æˆ–è€…å¦‚æœè¿™ä¸ªè€—æ—¶çš„ä»»åŠ¡æ¯”Activityç”Ÿå‘½é•¿ï¼Œé‚£ä¹ˆå®ƒä¸ä¼šè®©åƒåœ¾æ”¶é›†å™¨æŠŠæ•´ä¸ªActivityå®ä¾‹ä»å†…å­˜å›æ”¶ã€‚<strong>ä¸€ä¸ªç®€å•çš„é”™è¯¯å¯¼è‡´äº†ä¸€ä¸ªå·¨å¤§çš„å†…å­˜æ³„æ¼</strong>ã€‚</p>
<p>ä½†æ˜¯è§£å†³æ–¹æ¡ˆè¿˜æ˜¯éå¸¸ç®€å•ï¼Œçœ‹äº†ä½ å°±æ˜ç™½äº†ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GoodActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> AsyncTask mLongRunningTask;</span><br><span class="line">    <span class="keyword">private</span> TextView mMessageView;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.layout_good_activity);</span><br><span class="line">        mMessageView = (TextView) findViewById(R.id.messageView);</span><br><span class="line">        mLongRunningTask = <span class="keyword">new</span> LongRunningTask(mMessageView).execute();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">        mLongRunningTask.cancel(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">LongRunningTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">Void</span>, <span class="title">Void</span>, <span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> WeakReference&lt;TextView&gt; messageViewReference;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">LongRunningTask</span><span class="params">(TextView messageView)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.messageViewReference = <span class="keyword">new</span> WeakReference&lt;&gt;(messageView);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> String <span class="title">doInBackground</span><span class="params">(Void... params)</span> </span>&#123;</span><br><span class="line">            String message = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (!isCancelled()) &#123;</span><br><span class="line">                message = <span class="string">"I am finally done!"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> message;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPostExecute</span><span class="params">(String result)</span> </span>&#123;</span><br><span class="line">            TextView view = messageViewReference.get();</span><br><span class="line">            <span class="keyword">if</span> (view != <span class="keyword">null</span>) &#123;</span><br><span class="line">                view.setText(result);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä½ æ‰€è§ï¼Œ<strong>æˆ‘æŠŠéé™æ€å†…éƒ¨ç±»æ”¹æˆäº†é™æ€å†…éƒ¨ç±»</strong>ï¼Œè¿™æ ·é™æ€å†…éƒ¨ç±»å°±ä¸ä¼šæŒæœ‰ä»»ä½•å¤–éƒ¨ç±»çš„éšå¼å¼•ç”¨ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½é€šè¿‡é™æ€ä¸Šä¸‹æ–‡å»è®¿é—®å¤–éƒ¨ç±»çš„éé™æ€å˜é‡ï¼ˆæ¯”å¦‚ TextViewï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¾—ä¸é€šè¿‡æ„é€ æ–¹æ³•ä¼ é€’æˆ‘ä»¬éœ€è¦çš„å¯¹è±¡å¼•ç”¨åˆ°å†…éƒ¨ç±»ã€‚</p>
<p>æˆ‘å¼ºçƒˆæ¨èä½¿ç”¨ WeakReference åŒ…è£…è¿™ä¸ªå¯¹è±¡å¼•ç”¨æ¥é˜²æ­¢è¿›ä¸€æ­¥çš„å†…å­˜æ³„æ¼ã€‚ä½ éœ€è¦å¼€å§‹å­¦ä¹ å…³äº<strong>åœ¨Javaä¸­å„ä¸ªå¯ç”¨çš„å¼•ç”¨ç±»å‹</strong>ã€‚</p>
<h3 id="åŒ¿åç±»"><a href="#åŒ¿åç±»" class="headerlink" title="åŒ¿åç±»"></a>åŒ¿åç±»</h3><p>åŒ¿åç±»æ˜¯å¾ˆå¤šå¼€å‘è€…æœ€å–œæ¬¢çš„ï¼Œå› ä¸ºå®ƒä»¬è¢«å®šä¹‰çš„æ–¹å¼ä½¿å¾—ç”¨å®ƒä»¬ç¼–å†™ä»£ç éå¸¸å®¹æ˜“å’Œç®€æ´ã€‚ä½†æ˜¯æ ¹æ®æˆ‘çš„ç»éªŒ<strong>è¿™äº›åŒ¿åç±»æ˜¯å†…å­˜æ³„æ¼æœ€å¸¸è§çš„åŸå› </strong>ã€‚</p>
<p>åŒ¿åç±»æ²¡æœ‰ä»€ä¹ˆï¼Œä½†æ˜¯éé™æ€å†…éƒ¨ç±»ä¼šç”±äºå‰é¢æˆ‘è®²åˆ°è¿‡çš„åŒæ ·çš„ç†ç”±å¼•å‘æ½œåœ¨çš„å†…å­˜æ³„æ¼ã€‚ä½ å·²ç»åœ¨appçš„ä¸€ç³»åˆ—åœ°æ–¹ç”¨åˆ°äº†å®ƒï¼Œ<strong>ä½†æ˜¯ä½ ä¸çŸ¥é“å¦‚æœé”™è¯¯çš„ä½¿ç”¨å¯èƒ½ä¼šå¯¹ä½ appçš„æ€§èƒ½æœ‰ä¸¥é‡çš„å½±å“</strong>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MoviesActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> TextView mNoOfMoviesThisWeek;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.layout_movies_activity);</span><br><span class="line">        mNoOfMoviesThisWeek = (TextView) findViewById(R.id.no_of_movies_text_view);</span><br><span class="line">        MoviesRepository repository = ((MoviesApp) getApplication()).getRepository();</span><br><span class="line">        repository.getMoviesThisWeek()</span><br><span class="line">                .enqueue(<span class="keyword">new</span> Callback&lt;List&lt;Movie&gt;&gt;() &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(Call&lt;List&lt;Movie&gt;&gt; call,</span></span></span><br><span class="line"><span class="function"><span class="params">                                           Response&lt;List&lt;Movie&gt;&gt; response)</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">int</span> numberOfMovies = response.body().size();</span><br><span class="line">                        mNoOfMoviesThisWeek.setText(<span class="string">"No of movies this week: "</span> + String.valueOf(numberOfMovies));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(Call&lt;List&lt;Movie&gt;&gt; call, Throwable t)</span> </span>&#123;</span><br><span class="line">                        <span class="comment">// Oops.</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªéå¸¸æµè¡Œçš„åº“ <a href="https://github.com/square/retrofit" target="_blank" rel="noopener">Retrofit</a> æ¥æ‰§è¡Œä¸€ä¸ªç½‘ç»œè¯·æ±‚å¹¶æŠŠç»“æœæ˜¾ç¤ºåœ¨ TextView ä¸Šã€‚å¾ˆæ˜æ˜¾ï¼ŒCallable å¯¹è±¡æŒæœ‰äº†ä¸€ä¸ªå¤–éƒ¨Activityç±»çš„å¼•ç”¨ã€‚</p>
<p>å¦‚æœè¿™ä¸ªç½‘ç»œè¯·æ±‚æ‰§è¡Œé€Ÿåº¦éå¸¸æ…¢ï¼Œå¹¶ä¸”åœ¨è°ƒç”¨ç»“æŸä¹‹å‰ Activity å› ä¸ºæŸç§æƒ…å†µè¢«æ—‹è½¬äº†å±å¹•æˆ–è€…è¢«é”€æ¯ï¼Œ<strong>é‚£ä¹ˆæ•´ä¸ªActivityå®ä¾‹éƒ½ä¼šè¢«æ³„æ¼</strong>ã€‚</p>
<p>ä¸ç®¡æ˜¯å¦å¿…é¡»ï¼Œä½¿ç”¨é™æ€å†…éƒ¨ç±»æ¥ä»£æ›¿åŒ¿åå†…éƒ¨ç±»é€šå¸¸æ˜¯æ˜æ™ºä¹‹ä¸¾ã€‚ä¸æ˜¯æˆ‘çªç„¶å‘Šè¯‰ä½ å®Œå…¨åœæ­¢ä½¿ç”¨åŒ¿åç±»ï¼Œè€Œæ˜¯ä½ å¿…é¡»è¦æ‡‚å¾—åˆ¤æ–­ä»€ä¹ˆæ—¶å€™èƒ½ç”¨ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨ã€‚</p>
<p><a href="https://blog.aritraroy.in/why-you-should-start-using-kotlin-to-supercharge-your-android-development-in-2017-61db1f11d666" target="_blank" rel="noopener">æ¨èé˜…è¯»</a></p>
<h3 id="Bitmaps"><a href="#Bitmaps" class="headerlink" title="Bitmaps"></a>Bitmaps</h3><p>åœ¨ä½ appä¸­çœ‹åˆ°çš„æ‰€æœ‰å›¾ç‰‡éƒ½æ²¡å…³ç³»ï¼Œé™¤äº† <a href="https://developer.android.com/reference/android/graphics/Bitmap.html" target="_blank" rel="noopener">Bitmap</a> ï¼Œå®ƒåŒ…å«äº†å›¾åƒçš„æ•´ä¸ªåƒç´ æ•°æ®ã€‚</p>
<p>è¿™äº› bitmaps å¯¹è±¡ä¸€èˆ¬éå¸¸é‡ï¼Œ<strong>å¦‚æœå¤„ç†ä¸å½“å¯èƒ½ä¼šå¼•å‘æ˜æ˜¾çš„å†…å­˜æ³„æ¼</strong>ï¼Œå¹¶æœ€ç»ˆè®©ä½ çš„appå› ä¸º <a href="https://developer.android.com/reference/java/lang/OutOfMemoryError.html" target="_blank" rel="noopener">OutOfMemoryError</a> è€Œå´©æºƒã€‚ä½ åœ¨appä¸­ä½¿ç”¨çš„å›¾ç‰‡ç›¸å…³çš„ bitmap å†…å­˜ éƒ½ä¼šç”±Android Framework è‡ªèº«è‡ªåŠ¨ç®¡ç†ï¼Œå¦‚æœä½ æ‰‹åŠ¨å¤„ç† Bitmapï¼Œç¡®ä¿åœ¨ä½¿ç”¨åè¿›è¡Œ <a href="https://developer.android.com/reference/android/graphics/Bitmap.html#recycle%28%29" target="_blank" rel="noopener">recycle()</a>ã€‚</p>
<p><strong>ä½ è¿˜å¿…é¡»å­¦ä¼šæ€ä¹ˆå»æ­£ç¡®åœ°ç®¡ç†è¿™äº›bitmaps</strong>ï¼ŒåŠ è½½å¤§çš„Bitmapæ—¶é€šè¿‡å‹ç¼©ï¼Œä»¥åŠä½¿ç”¨bitmapç¼“å­˜æ± æ¥å°½å¯èƒ½å‡å°‘å†…å­˜çš„å ç”¨ã€‚<a href="https://developer.android.com/training/displaying-bitmaps/manage-memory.html" target="_blank" rel="noopener">è¿™é‡Œ</a> æœ‰ä¸€ä¸ªç†è§£ bitmap å¤„ç†çš„å¾ˆå¥½çš„èµ„æºã€‚</p>
<h3 id="Contexts"><a href="#Contexts" class="headerlink" title="Contexts"></a>Contexts</h3><p>å¦ä¸€ä¸ªç›¸å½“å¸¸è§çš„å†…å­˜æ³„æ¼æ˜¯æ»¥ç”¨ context å®ä¾‹ã€‚<a href="https://developer.android.com/reference/android/content/Context.html" target="_blank" rel="noopener">Context</a> åªæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒæœ‰å¾ˆå¤šç±»ï¼ˆæ¯”å¦‚ Activityï¼ŒApplicationï¼ŒService ç­‰ç­‰ï¼‰ç»§æ‰¿å®ƒå¹¶æä¾›å®ƒä»¬è‡ªå·±çš„åŠŸèƒ½ã€‚</p>
<blockquote>
<p><em>å¦‚æœä½ è¦åœ¨ Android ä¸­å®Œæˆä»»åŠ¡ï¼Œé‚£ä¹ˆ Context å¯¹è±¡å°±æ˜¯ä½ çš„è€æ¿ã€‚</em></p>
</blockquote>
<p>ä½†æ˜¯è¿™äº› contexts æœ‰ä¸€äº›ä¸åŒä¹‹å¤„ã€‚éå¸¸é‡è¦çš„ä¸€ç‚¹æ˜¯<strong>ç†è§£ Activityçº§åˆ«çš„Context å’Œ Applicationçº§åˆ«çš„Context ä¹‹é—´çš„åŒºåˆ«</strong>ï¼Œåˆ†åˆ«ç”¨åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ã€‚</p>
<p>åœ¨é”™è¯¯çš„åœ°æ–¹ä½¿ç”¨ Activity context ä¼šæŒæœ‰æ•´ä¸ª Activity çš„å¼•ç”¨å¹¶å¼•å‘æ½œåœ¨çš„å†…å­˜æ³„æ¼ã€‚<a href="https://medium.com/@ali.muzaffar/which-context-should-i-use-in-android-e3133d00772c#.mruk222z2" target="_blank" rel="noopener">è¿™é‡Œ</a>æœ‰ç¯‡å¾ˆå¥½çš„æ–‡ç« ä½œä¸ºå¼€å§‹ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç°åœ¨ä½ è‚¯å®šçŸ¥é“åƒåœ¾æ”¶é›†å™¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Œä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼ï¼Œå®ƒä»¬å¦‚ä½•å¯¹ä½ çš„appäº§ç”Ÿé‡å¤§çš„å½±å“ã€‚ä½ ä¹Ÿå­¦ä¹ äº†æ€æ ·æ£€æµ‹å’Œä¿®å¤è¿™äº›å†…å­˜æ³„æ¼ã€‚</p>
<p><strong>æ²¡æœ‰ä»»ä½•å€Ÿå£ï¼Œä»ç°åœ¨å¼€å§‹è®©æˆ‘ä»¬å¼€å§‹æ„å»ºä¸€ä¸ªé«˜è´¨é‡ï¼Œé«˜æ€§èƒ½çš„ Android app</strong>ã€‚æ£€æµ‹å’Œä¿®å¤å†…å­˜æ³„æ¼ä¸ä»…ä¼šè®©ä½ çš„appçš„ç”¨æˆ·ä½“éªŒæ›´å¥½ï¼Œè€Œä¸”ä¼šæ…¢æ…¢åœ°è®©ä½ æˆä¸ºä¸€ä¸ªæ›´å¥½çš„å¼€å‘è€…ã€‚</p>
<p>æœ¬æ–‡æœ€åˆå‘è¡¨äº <a href="http://techbeacon.com/" target="_blank" rel="noopener">TechBeacon</a>.</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> memory leak </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨Google Cloud Platform(GCP GCE)å®‰è£…SSR+BBRæ•™ç¨‹]]></title>
      <url>/2017/05/29/gcp-ssr/</url>
      <content type="html"><![CDATA[<h1 id="ä½¿ç”¨Google-Cloud-Platform-GCP-GCE-å®‰è£…SSR-BBRæ•™ç¨‹"><a href="#ä½¿ç”¨Google-Cloud-Platform-GCP-GCE-å®‰è£…SSR-BBRæ•™ç¨‹" class="headerlink" title="ä½¿ç”¨Google Cloud Platform(GCP GCE)å®‰è£…SSR+BBRæ•™ç¨‹"></a>ä½¿ç”¨Google Cloud Platform(GCP GCE)å®‰è£…SSR+BBRæ•™ç¨‹</h1><p>GCPæ˜¯åŸGCEï¼Œå…¶ä¼˜ç¾çš„ç•Œé¢å’Œä¸°å¯Œçš„åŠŸèƒ½æ·±å¾—å„ç±»ç¨‹åºå‘˜çš„å–œå¥½ã€‚è¿‘æ—¥å‘ç°Google Cloud Platformå¯¹å¤§é™†ä¼˜åŒ–å¥½ï¼Œå¹¶ä¸”é€300ç¾é‡‘ï¼ˆ12ä¸ªæœˆï¼‰çš„ç¤¼å“å¡ã€‚ç‰¹æ­¤ä¸€è¯•ï¼Œæ•ˆæœç”šå¥½ï¼Œæ•…æ”¶é›†æ•™ç¨‹å¹¶é›†åˆå…³äºGoogle Cloud Platform(GCP GCE)å®‰è£…SS+BBRã€‚</p>
<h2 id="åˆ›å»ºå®ä¾‹"><a href="#åˆ›å»ºå®ä¾‹" class="headerlink" title="åˆ›å»ºå®ä¾‹"></a>åˆ›å»ºå®ä¾‹</h2><p>åœ¨å·¦ä¾§çš„èœå•ä¸­æ‰¾åˆ° è®¡ç®—å¼•æ“ â€“  VM å®ä¾‹<br>é€šè¿‡åˆ›å»ºå®ä¾‹æˆ–è€…å•å‡»åŠ å·æ¥åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºã€‚</p>
<ul>
<li>åç§°ï¼šéšæ„è¾“å…¥</li>
<li>åœ°åŒºï¼šå»ºè®®<code>asia-east1-c</code></li>
<li>æœºå™¨ç±»å‹ï¼šå°å‹ï¼ˆå»ºè®®ï¼‰/å¾®å‹</li>
<li>å¯åŠ¨ç£ç›˜å•å‡»æ›´æ”¹ â€“ Ubuntu 16.04 LTS</li>
<li>é˜²ç«å¢™ï¼šå…è®¸HTTPæµé‡ï¼Œå…è®¸HTTPSæµé‡</li>
</ul>
<h2 id="åˆæ­¥é…ç½®"><a href="#åˆæ­¥é…ç½®" class="headerlink" title="åˆæ­¥é…ç½®"></a>åˆæ­¥é…ç½®</h2><ul>
<li><p>å·¦ä¾§å¯¼èˆª â€“ è®¡ç®— â€“ ç½‘ç»œ</p>
</li>
<li><p>å¤–éƒ¨IPåœ°å€ â€“ é€‰æ‹©ä¸€ä¸ªip â€“ ç±»å‹è°ƒæ•´ä¸ºé™æ€</p>
</li>
<li><p>é˜²ç«å¢™è§„åˆ™ â€“ åˆ›å»ºé˜²ç«å¢™è§„åˆ™ï¼ˆæœªæåŠçš„å…¨éƒ¨é»˜è®¤ï¼‰ï¼šæµé‡æ–¹å‘<code>å…¥ç«™</code>ã€æ¥æºipåœ°å€<code>0.0.0.0/0</code>ã€åè®®å’Œç«¯å£<code>å…¨éƒ¨å…è®¸</code></p>
</li>
<li><p>é˜²ç«å¢™è§„åˆ™ â€“ åˆ›å»ºé˜²ç«å¢™è§„åˆ™ï¼ˆæœªæåŠçš„å…¨éƒ¨é»˜è®¤ï¼‰ï¼šæµé‡æ–¹å‘<code>å‡ºç«™</code>ã€æ¥æºipåœ°å€<code>0.0.0.0/0</code>ã€åè®®å’Œç«¯å£<code>å…¨éƒ¨å…è®¸ï¼ˆæ³¨æ„è¦åˆ›å»ºä¸¤æ¬¡é˜²ç«å¢™è§„åˆ™ï¼Œä¸€æ¬¡å‡ºç«™ï¼Œä¸€æ¬¡å…¥ç«™ï¼‰</code></p>
</li>
</ul>
<h2 id="é…ç½®SSä»¥åŠBBR"><a href="#é…ç½®SSä»¥åŠBBR" class="headerlink" title="é…ç½®SSä»¥åŠBBR"></a>é…ç½®SSä»¥åŠBBR</h2><p>è¿›å…¥å®ä¾‹æ§åˆ¶å° â€“ SSH â€“ åœ¨æµè§ˆå™¨çª—å£ä¸­æ‰“å¼€</p>
<h3 id="è·å–rootæƒé™"><a href="#è·å–rootæƒé™" class="headerlink" title="è·å–rootæƒé™"></a>è·å–rootæƒé™</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure>
<h3 id="å®‰è£…SSï¼ˆæ ¹æ®è„šæœ¬æç¤ºæ¥ï¼‰"><a href="#å®‰è£…SSï¼ˆæ ¹æ®è„šæœ¬æç¤ºæ¥ï¼‰" class="headerlink" title="å®‰è£…SSï¼ˆæ ¹æ®è„šæœ¬æç¤ºæ¥ï¼‰"></a>å®‰è£…SSï¼ˆæ ¹æ®è„šæœ¬æç¤ºæ¥ï¼‰</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocksR.sh</span><br><span class="line">chmod +x shadowsocksR.sh</span><br><span class="line">./shadowsocksR.sh 2&gt;&amp;1 | tee shadowsocksR.log</span><br></pre></td></tr></table></figure>
<p>æœåŠ¡å™¨ç«¯å£ï¼šé»˜è®¤ä¸º 8989<br>å¯†ç ï¼šé»˜è®¤ä¸º teddysun.com<br>åŠ å¯†æ–¹å¼ï¼šé»˜è®¤ä¸º aes-256-cfb<br>åè®®ï¼ˆProtocolï¼‰ï¼šé»˜è®¤ä¸º origin<br>æ··æ·†ï¼ˆobfsï¼‰ï¼šé»˜è®¤ä¸º plain</p>
<h3 id="å®‰è£…BBRåŠ é€Ÿ"><a href="#å®‰è£…BBRåŠ é€Ÿ" class="headerlink" title="å®‰è£…BBRåŠ é€Ÿ"></a>å®‰è£…BBRåŠ é€Ÿ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh &amp;&amp; chmod +x bbr.sh &amp;&amp; ./bbr.sh</span><br></pre></td></tr></table></figure>
<h3 id="é‡ç½®VMå®ä¾‹"><a href="#é‡ç½®VMå®ä¾‹" class="headerlink" title="é‡ç½®VMå®ä¾‹"></a>é‡ç½®VMå®ä¾‹</h3><h3 id="é‡å¤ç¬¬ä¸€æ­¥å’Œç¬¬äºŒæ­¥ï¼Œè¾“å…¥"><a href="#é‡å¤ç¬¬ä¸€æ­¥å’Œç¬¬äºŒæ­¥ï¼Œè¾“å…¥" class="headerlink" title="é‡å¤ç¬¬ä¸€æ­¥å’Œç¬¬äºŒæ­¥ï¼Œè¾“å…¥"></a>é‡å¤ç¬¬ä¸€æ­¥å’Œç¬¬äºŒæ­¥ï¼Œè¾“å…¥</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl net.ipv4.tcp_available_congestion_control</span><br></pre></td></tr></table></figure>
<p>è‹¥å‡ºç°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net.ipv4.tcp_available_congestion_control = bbr cubic reno</span><br></pre></td></tr></table></figure>
<h3 id="ç¬¬ä¸‰ç¬¬å››æ­¥å¯ä»¥åˆå¹¶ä¸ºä¸€æ­¥ï¼Œé€šè¿‡ShadowsocksR-BBRåŠ é€Ÿä¸€é”®å®‰è£…åŒ…"><a href="#ç¬¬ä¸‰ç¬¬å››æ­¥å¯ä»¥åˆå¹¶ä¸ºä¸€æ­¥ï¼Œé€šè¿‡ShadowsocksR-BBRåŠ é€Ÿä¸€é”®å®‰è£…åŒ…" class="headerlink" title="ç¬¬ä¸‰ç¬¬å››æ­¥å¯ä»¥åˆå¹¶ä¸ºä¸€æ­¥ï¼Œé€šè¿‡ShadowsocksR+BBRåŠ é€Ÿä¸€é”®å®‰è£…åŒ…"></a>ç¬¬ä¸‰ç¬¬å››æ­¥å¯ä»¥åˆå¹¶ä¸ºä¸€æ­¥ï¼Œé€šè¿‡<a href="http://suiyuanjian.com/139.html" target="_blank" rel="noopener">ShadowsocksR+BBRåŠ é€Ÿä¸€é”®å®‰è£…åŒ…</a></h3><h2 id="é—®é¢˜åŠå‚è€ƒ"><a href="#é—®é¢˜åŠå‚è€ƒ" class="headerlink" title="é—®é¢˜åŠå‚è€ƒ"></a>é—®é¢˜åŠå‚è€ƒ</h2><p>æ— æ³•è¿æ¥å¤–ç½‘ï¼š</p>
<ul>
<li>åœ¨VMå®ä¾‹çš„ç½‘ç»œé€‰é¡¹ä¸­è¦å‹¾é€‰å¤–ç½‘IPåœ°å€ï¼Œä¸ç„¶æ— æ³•è”ä¸Šå¤–ç½‘ã€‚</li>
</ul>
<p>åˆ›å»ºæ­¥éª¤å‚è€ƒè‡ªï¼š</p>
<ul>
<li><a href="https://sspai.com/post/39361" target="_blank" rel="noopener">å¦‚ä½•å…è´¹æ‰“é€ ä¸€ä¸ªå®‰å…¨ç¨³å®šè¶…é«˜é€Ÿçš„ç§‘å­¦ä¸Šç½‘ç¯å¢ƒ</a></li>
<li><a href="https://www.91yun.org/archives/2297" target="_blank" rel="noopener">GOOGLE COMPUTE ENGINE(GCE)æ³¨å†Œå¼€VPSæ•™ç¨‹</a></li>
<li><a href="https://github.com/kaiye/kaiye.github.com/issues/9" target="_blank" rel="noopener">æ‹¥æœ‰ä¸€æ¶ Google çš„å°é£æœºæ˜¯ä¸€ç§æ€æ ·çš„ä½“éªŒ</a></li>
</ul>
<p>SSR/SSç›¸å…³é—®é¢˜ï¼š</p>
<ul>
<li><a href="https://shadowsocks.be/9.html" target="_blank" rel="noopener">SSRä¸€é”®è„šæœ¬</a></li>
</ul>
<p>BBRç›¸å…³é—®é¢˜ï¼š</p>
<ul>
<li><a href="https://teddysun.com/489.html" target="_blank" rel="noopener">ä¸€é”®å®‰è£…æœ€æ–°å†…æ ¸å¹¶å¼€å¯BBRè„šæœ¬</a></li>
</ul>
<blockquote>
<p>â€“éšç¼˜ç®­Â·ç‰ˆæƒæ‰€æœ‰ï¼š<a href="https://suiyuanjian.com/124.html" target="_blank" rel="noopener">ä½¿ç”¨Google Cloud Platform(GCP GCE)å®‰è£…SSR+BBRæ•™ç¨‹</a>â€“</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> google cloud platform </tag>
            
            <tag> gcp </tag>
            
            <tag> ssr </tag>
            
            <tag> shadowsocks </tag>
            
            <tag> shadowsocksr </tag>
            
            <tag> vpn </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Gradle æ’ä»¶ DiscardFilePluginï¼ˆclassæ³¨å…¥&æ¸…ç©ºç±»å’Œæ–¹æ³•ï¼‰]]></title>
      <url>/2017/04/19/Android-Gradle-%E6%8F%92%E4%BB%B6-DiscardFilePlugin%EF%BC%88class%E6%B3%A8%E5%85%A5-%E6%B8%85%E7%A9%BA%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="Android-Gradle-æ’ä»¶-DiscardFilePluginï¼ˆæ¸…ç©ºç±»å’Œæ–¹æ³•ï¼‰"><a href="#Android-Gradle-æ’ä»¶-DiscardFilePluginï¼ˆæ¸…ç©ºç±»å’Œæ–¹æ³•ï¼‰" class="headerlink" title="Android Gradle æ’ä»¶ DiscardFilePluginï¼ˆæ¸…ç©ºç±»å’Œæ–¹æ³•ï¼‰"></a>Android Gradle æ’ä»¶ DiscardFilePluginï¼ˆæ¸…ç©ºç±»å’Œæ–¹æ³•ï¼‰</h1><p>An android gradle plugin for discard class or method in compile time.</p>
<p>ç”¨äºåœ¨ç¼–è¯‘æ„å»ºæ—¶æœŸå¿½ç•¥æ¸…ç©ºç±»å’Œæ–¹æ³•çš„ä¸€ä¸ªAndroid Gradleæ’ä»¶ã€‚</p>
<p><strong>Github: <a href="https://github.com/wangjiegulu/DiscardFilePlugin" target="_blank" rel="noopener">https://github.com/wangjiegulu/DiscardFilePlugin</a></strong></p>
<h2 id="1-1-ä½¿ç”¨åœºæ™¯"><a href="#1-1-ä½¿ç”¨åœºæ™¯" class="headerlink" title="1.1 ä½¿ç”¨åœºæ™¯"></a>1.1 ä½¿ç”¨åœºæ™¯</h2><p>åœ¨å®é™…çš„ç”Ÿäº§ä¸­ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¼šåœ¨æˆ‘ä»¬çš„appä¸­å¢åŠ ä¸€äº›è°ƒè¯•çš„å·¥å…·ï¼Œæ¯”å¦‚åœ¨<code>debug</code>æ¨¡å¼ä¸‹åŠ å…¥<code>DebugPanelActivity</code>ï¼ˆè°ƒè¯•é¢æ¿å·¥å…·é¡µé¢ï¼Œæä¾›æ¯”å¦‚â€œåˆ‡æ¢æœåŠ¡å™¨â€ç­‰æ“ä½œï¼‰ã€‚æˆ‘ä»¬éœ€è¦åœ¨æ­£å¼ä¸Šçº¿çš„releaseç‰ˆæœ¬ä¸­æ¸…ç©ºç›¸å…³ç±»å’Œæ–¹æ³•ï¼Œæˆ–è€…ä¿®æ”¹<code>boolean isProductionEnvironment()</code>æ–¹æ³•ï¼Œè®©å®ƒæ°¸è¿œè¿”å›<code>true</code>ï¼Œ<strong>ä»¥æ­¤æ¥é¿å…ä¸Šçº¿ä¹‹åè°ƒè¯•ç›¸å…³ä»£ç é€šè¿‡åç¼–è¯‘ç­‰æ‰‹æ®µæš´éœ²å‡ºæ¥ã€‚</strong></p>
<a id="more"></a>
<h2 id="1-2-Discardæ³¨è§£"><a href="#1-2-Discardæ³¨è§£" class="headerlink" title="1.2 @Discardæ³¨è§£"></a>1.2 <code>@Discard</code>æ³¨è§£</h2><h3 id="1-2-1-Target"><a href="#1-2-1-Target" class="headerlink" title="1.2.1 Target"></a>1.2.1 Target</h3><ul>
<li><p><code>ElementType.METHOD</code>: è¡¨ç¤ºæ¸…ç©ºæ–¹æ³•ä¸­çš„ä»£ç ï¼Œç¼–è¯‘è¿‡ç¨‹ä¸­è¯¥æ–¹æ³•ä¸­ä»£ç è¢«æ¸…ç©ºã€‚</p>
</li>
<li><p><code>ElementType.TYPE</code>: è¡¨ç¤ºæ¸…ç©ºç±»ï¼Œå…¶å®æ˜¯æ¸…ç©ºç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•ã€‚</p>
</li>
</ul>
<h3 id="1-2-2-å‚æ•°"><a href="#1-2-2-å‚æ•°" class="headerlink" title="1.2.2 å‚æ•°"></a>1.2.2 å‚æ•°</h3><h4 id="1-2-2-1-apply"><a href="#1-2-2-1-apply" class="headerlink" title="1.2.2.1 apply"></a>1.2.2.1 <code>apply</code></h4><p><code>apply</code>å‚æ•°è§„èŒƒï¼š<code>key==exceptValue</code></p>
<p>è¡¨ç¤ºå½“<code>key==exceptValue</code>æ—¶ï¼ŒDiscardæ‰ä¼šç”Ÿæ•ˆï¼Œæ‰ä¼šçœŸæ­£åœ¨ç¼–è¯‘æ—¶å»å¯¹æ–¹æ³•æˆ–è€…ç±»è¿›è¡Œæ¸…ç©ºã€‚å› æ­¤å¯ä»¥åœ¨æ¯ä¸ªæ–¹æ³•æˆ–è€…ç±»ä¸­å»è¿›è¡Œä¸åŒçš„é…ç½®ï¼Œåœ¨ä¸åŒçŠ¶æ€ä¸‹é€šè¿‡å¦‚ä¸‹æ–¹å¼å¯¹ä¸åŒæ–¹æ³•è¿›è¡ŒDiscardï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Discard</span>(apply = <span class="string">"test1==true"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMethod_1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"testMethod_1..."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Discard</span>(apply = <span class="string">"test2==true"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMethod_2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"testMethod_2..."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>gradle assembleDebug -Ptest1=true -Ptest2=false</code>æ¥æ„å»ºæ—¶ï¼Œ<code>testMethod_1()</code>æ–¹æ³•ä¼šè¢«discardï¼Œè€Œ<code>testMethod_2()</code>ä¸ä¼šè¢«discardã€‚æ„å»ºå®Œæ¯•åç¼–è¯‘classç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Discard</span>(apply = <span class="string">"test1==true"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMethod_1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Discard</span>(apply = <span class="string">"test2==true"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMethod_2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"testMethod_2..."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-2-2-2-srcCode"><a href="#1-2-2-2-srcCode" class="headerlink" title="1.2.2.2 srcCode"></a>1.2.2.2 <code>srcCode</code></h4><p>æ›¿æ¢æ–¹æ³•çš„æ–¹æ³•ä½“ï¼Œå¦‚æœä¸è®¾ç½®ï¼Œé»˜è®¤discardæ–¹æ³•å®ç°ï¼š</p>
<ul>
<li>è¿”å›ç±»å‹ä¸º<code>void</code>: discardåæ–¹æ³•ä½“ä¸º<code>{}</code></li>
<li>è¿”å›ç±»å‹ä¸ºåŸå§‹æ•°æ®ç±»å‹ï¼šdiscardåæ–¹æ³•è¿”å›é»˜è®¤å€¼ï¼Œæ¯”å¦‚<code>{ return 0; }</code></li>
<li>è¿”å›ç±»å‹ä¸ºç±»å¯¹è±¡æ—¶ï¼š discardåæ–¹æ³•è¿”å›ä¸º<code>{ return null; }</code></li>
</ul>
<p>å¯ä»¥å¦‚ä¸‹å¡«å†™å…·ä½“çš„æ–¹æ³•ä½“ä»£ç å—ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Discard</span>(srcCode = <span class="string">"&#123;super.onCreate($1); System.out.println(\"this: \" + $0);&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        usernameEt = (EditText) findViewById(R.id.activity_main_username_et);</span><br><span class="line">        passwordEt = (EditText) findViewById(R.id.activity_main_password_et);</span><br><span class="line">        setTestAccount();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>discardä¹‹åçš„classåç¼–è¯‘ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Discard</span>(</span><br><span class="line">        srcCode = <span class="string">"&#123;super.onCreate($1); System.out.println(\"this: \" + $0);&#125;"</span></span><br><span class="line">    )</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle var1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(var1);</span><br><span class="line">        System.out.println(<span class="string">"this: "</span> + <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æ–¹æ³•çš„<code>$0</code>è¡¨ç¤ºå½“å‰å¯¹è±¡<code>this</code>ï¼Œæ–¹æ³•å‚æ•°ä¾æ¬¡ä¸º<code>$1, $2, $3...</code>ï¼Œ<a href="http://jboss-javassist.github.io/javassist/tutorial/tutorial2.html#alter" target="_blank" rel="noopener">è¯¦ç»†æ–‡æ¡£å‚è€ƒè¿™é‡Œ</a></p>
<h4 id="1-2-2-3-makeClassNames"><a href="#1-2-2-3-makeClassNames" class="headerlink" title="1.2.2.3 makeClassNames"></a>1.2.2.3 <code>makeClassNames</code></h4><p>å¯ä»¥åœ¨è¿™é‡ŒæŒ‡å®šå…·ä½“çš„ç±»åï¼Œåœ¨discardæ—¶å¯¹æœªåœ¨classPathçš„ç±»è¿›è¡Œmakeã€‚<strong>ä¸å¸¸ç”¨ï¼Œå¯ä»¥çœç•¥ã€‚</strong></p>
<h4 id="1-2-2-4-enable"><a href="#1-2-2-4-enable" class="headerlink" title="1.2.2.4 enable"></a>1.2.2.4 <code>enable</code></h4><p>è¡¨ç¤ºè¯¥æ–¹æ³•æˆ–è€…ç±»çš„discardæ˜¯å¦å¼€å¯ï¼Œé»˜è®¤ä¸º<code>true</code>ï¼Œæ¯”è¾ƒå…¸å‹çš„åœºæ™¯ä¸ºï¼Œåœ¨ç±»ä¸Šé¢å¢åŠ <code>@Discard</code>å¯¹è¯¥ç±»æ‰€æœ‰æ–¹æ³•è¿›è¡Œdiscardï¼Œä½†æ˜¯éœ€è¦æŸä¸ªæ–¹æ³•ä¸discardï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨<code>@Discard(enable = false)</code>æ¥å¯¹æ–¹æ³•è¿›è¡Œæ’é™¤åœ¨<code>discard</code>èŒƒå›´å¤–ã€‚</p>
<h2 id="1-3-ä½¿ç”¨æ–¹å¼"><a href="#1-3-ä½¿ç”¨æ–¹å¼" class="headerlink" title="1.3 ä½¿ç”¨æ–¹å¼"></a>1.3 ä½¿ç”¨æ–¹å¼</h2><h3 id="Gradle-Check-newest-version"><a href="#Gradle-Check-newest-version" class="headerlink" title="Gradle(Check newest version):"></a>Gradle(<a href="http://search.maven.org/#search%7Cga%7C1%7Cdiscardfile" target="_blank" rel="noopener">Check newest version</a>):</h3><p><code>build.gradle</code> in Project:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath <span class="string">'com.android.tools.build:gradle:2.2.2'</span></span><br><span class="line">        <span class="comment">// <span class="doctag">NOTE:</span> Do not place your application dependencies here; they belong</span></span><br><span class="line">        <span class="comment">// in the individual module build.gradle files</span></span><br><span class="line">        classpath <span class="string">'com.github.wangjiegulu:discardfile:x.x.x'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>build.gradle</code> in <code>app</code> or <code>library</code>:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.github.wangjiegulu.plg.discardfile'</span></span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">	compile <span class="string">'com.github.wangjiegulu:discardfile-api:x.x.x'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-3-1-build-gradle"><a href="#1-3-1-build-gradle" class="headerlink" title="1.3.1. build.gradle"></a>1.3.1. <code>build.gradle</code></h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨æ’ä»¶</span></span><br><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.github.wangjiegulu.plg.discardfile'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½®éœ€è¦ä¿®æ”¹çš„ç±»æ‰€å±åœ¨é‚£äº›åŒ…ä¸‹</span></span><br><span class="line">discard &#123;</span><br><span class="line">    includePackagePath <span class="string">'com.wangjie.plg.discardfile.sample.ui'</span>, <span class="string">'com.wangjie.plg.discardfile.sample.include'</span></span><br><span class="line">    excludePackagePath <span class="string">'com.wangjie.plg.discardfile.sample.exclude'</span><span class="comment">/*, 'com.wangjie.plg.discardfile.sample.ui.MainActivity'*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-3-2-ä½¿ç”¨-Discardæ³¨è§£"><a href="#1-3-2-ä½¿ç”¨-Discardæ³¨è§£" class="headerlink" title="1.3.2. ä½¿ç”¨@Discardæ³¨è§£"></a>1.3.2. ä½¿ç”¨<code>@Discard</code>æ³¨è§£</h3><p>åˆ›å»ºè‡ªå®šä¹‰applyé…ç½®(<code>publish</code>å’Œ<code>disable</code>ä¸¤ç§applyé…ç½®)ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplyConstants</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Publish</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PUBLISH = <span class="string">"publish"</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String _TRUE = PUBLISH + <span class="string">"==true"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">DISABLE</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DISABLE = <span class="string">"disable"</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String _TRUE = DISABLE + <span class="string">"==true"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨éœ€è¦æ¸…ç©ºçš„ç±»ä¸Šæ·»åŠ <code>@Discard</code>æ³¨è§£ï¼Œ<code>apply = ApplyConstants.Publish._TRUE</code>è¡¨ç¤ºåªæœ‰åœ¨<code>publish=true</code>çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šæ‰§è¡ŒDiscardã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Discard</span>(apply = ApplyConstants.Publish._TRUE)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IncludeClassC</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å› ä¸ºIncludeClassCç±»å¢åŠ äº†`<span class="doctag">@Discard</span>`æ³¨è§£ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•ä¹Ÿä¼šè¢«discardã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onIncludeMethodC</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"onIncludeMethodC..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›¿æ¢è¯¥æ–¹æ³•çš„å®ç°ä¸ºï¼š&#123;System.out.println("onIncludeMethodC_2... injected!");&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Discard</span>(apply = ApplyConstants.Publish._TRUE, srcCode = <span class="string">"&#123;System.out.println(\"onIncludeMethodC_2... injected!\");&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onIncludeMethodC_2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"onIncludeMethodC_2..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›¿æ¢è¯¥æ–¹æ³•æ°¸è¿œè¿”å›true</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Discard</span>(apply = ApplyConstants.Publish._TRUE, srcCode = <span class="string">"&#123;return true;&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onIncludeMethodC_3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"onIncludeMethodC_3..."</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å› ä¸ºIncludeClassCç±»å¢åŠ äº†`<span class="doctag">@Discard</span>`æ³¨è§£ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•ä¹Ÿä¼šè¢«discardã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">onIncludeMethodC_4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"onIncludeMethodC_4..."</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”±äºä½¿ç”¨äº†`<span class="doctag">@Discard</span>`æ³¨è§£è¿›è¡Œæ˜¾å¼åœ°å£°æ˜ç¦ç”¨äº†æœ¬åœ°çš„discardï¼Œæ‰€ä»¥è¯¥æ–¹æ³•ä¸ä¼šè¢«discard</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Discard</span>(apply = ApplyConstants.Publish._TRUE, enable = <span class="keyword">false</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">onIncludeMethodC_5</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"onIncludeMethodC_5..."</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello world"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›¿æ¢è¯¥æ–¹æ³•æ°¸è¿œè¿”å›"hello world"å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Discard</span>(apply = ApplyConstants.Publish._TRUE, srcCode = <span class="string">"&#123;return \"hello world injected!\";&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">onIncludeMethodC_6</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"onIncludeMethodC_6..."</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello world"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-3-3-buildè¿è¡Œ"><a href="#1-3-3-buildè¿è¡Œ" class="headerlink" title="1.3.3. buildè¿è¡Œ"></a>1.3.3. buildè¿è¡Œ</h3><p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œæ„å»ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gradle clean assembleFullDebug -Ppublish=true -Pdisable=true</span><br></pre></td></tr></table></figure>
<p>å‘½ä»¤ç¼–è¯‘å®Œæˆä¹‹åï¼Œè¯¥ç±»çš„<code>class</code>æ–‡ä»¶å°†ä¼šæ ¹æ®é…ç½®çš„<code>@Discard</code>æ³¨è§£è¢«è‡ªåŠ¨ä¿®æ”¹æˆå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">build/intermediates/transforms/discardFile/.../IncludeClassC.class</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Discard</span>(</span><br><span class="line">    apply = <span class="string">"publish==true"</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IncludeClassC</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">IncludeClassC</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onIncludeMethodC</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Object var10000 = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Discard</span>(</span><br><span class="line">        apply = <span class="string">"publish==true"</span>,</span><br><span class="line">        srcCode = <span class="string">"&#123;System.out.println(\"onIncludeMethodC_2... injected!\");&#125;"</span></span><br><span class="line">    )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onIncludeMethodC_2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"onIncludeMethodC_2... injected!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Discard</span>(</span><br><span class="line">        apply = <span class="string">"publish==true"</span>,</span><br><span class="line">        srcCode = <span class="string">"&#123;return true;&#125;"</span></span><br><span class="line">    )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onIncludeMethodC_3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">onIncludeMethodC_4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Discard</span>(</span><br><span class="line">        apply = <span class="string">"publish==true"</span>,</span><br><span class="line">        enable = <span class="keyword">false</span></span><br><span class="line">    )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">onIncludeMethodC_5</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"onIncludeMethodC_5..."</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello world"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Discard</span>(</span><br><span class="line">        apply = <span class="string">"publish==true"</span>,</span><br><span class="line">        srcCode = <span class="string">"&#123;return \"hello world injected!\";&#125;"</span></span><br><span class="line">    )</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">onIncludeMethodC_6</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello world injected!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> gradle </tag>
            
            <tag> gradle plugin </tag>
            
            <tag> discard </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[NDKé…ç½®]]></title>
      <url>/2017/04/11/NDK%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<h1 id="NDK-é…ç½®"><a href="#NDK-é…ç½®" class="headerlink" title="NDK é…ç½®"></a>NDK é…ç½®</h1><p>Android SDKä¸­ä¸‹è½½<code>NDK</code>, <code>LLDB</code></p>
<h2 id="Android-mk-å’Œ-Application-mk"><a href="#Android-mk-å’Œ-Application-mk" class="headerlink" title="Android.mk å’Œ Application.mk"></a>Android.mk å’Œ Application.mk</h2><p>ç®€å•æ¥è¯´</p>
<ul>
<li>Android.mk ç”¨æ¥æè¿°éœ€è¦ç”Ÿæˆå“ªäº›æ¨¡å—çš„ .so æ–‡ä»¶</li>
<li>Application.mk ç”¨æ¥æè¿°å¦‚ä½•ç”Ÿæˆ .so æ–‡ä»¶ï¼Œç”Ÿæˆé™æ€åº“è¿˜æ˜¯åŠ¨æ€åº“</li>
</ul>
<a id="more"></a>
<p>è¿™é‡Œç»™å‡ºç¤ºä¾‹æ–‡ä»¶</p>
<p>Android.mk</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LOCAL_PATH := $(call my-dir)</span><br><span class="line">include $(CLEAR_VARS)</span><br><span class="line">LOCAL_MODULE := gaussianBlur</span><br><span class="line">LOCAL_SRC_FILES := blur.cpp</span><br><span class="line">LOCAL_LDLIBS := -llog</span><br><span class="line">include $(BUILD_SHARED_LIBRARY)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>å®å‡½æ•° my-dir æ˜¯ç”±ç¼–è¯‘ç³»ç»Ÿæä¾›çš„ï¼Œä¼šè¿”å›å½“å‰ç›®å½•çš„è·¯å¾„ï¼ˆå½“å‰ç›®å½•æŒ‡çš„æ˜¯åŒ…å« Android.mk çš„ç›®å½•ï¼‰</p>
</li>
<li><p>CLEAR_VARS è¿™ä¸ªå˜é‡ä¹Ÿæ˜¯ç”±ç¼–è¯‘ç³»ç»Ÿæä¾›çš„ï¼Œä¼šæ¸…é™¤å¾ˆå¤š LOCAL_XXX å˜é‡</p>
</li>
<li><p>ä»¥ä¸Šä¸¤è¡Œå‘½ä»¤åŸºæœ¬ä¸Šæ˜¯å›ºå®šçš„ï¼Œä¸éœ€è¦å»åŠ¨</p>
</li>
<li><p>LOCAL_MODULE æŒ‡å®šæ¨¡å—åç§°ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„ libgaussianBlur.so æ–‡ä»¶</p>
</li>
<li><p>LOCAL_SRC_FILES æŒ‡å®šè¿™ä¸ªæ¨¡å—è¦ç¼–è¯‘çš„ C++ æ–‡ä»¶</p>
</li>
<li><p>LOCAL_LDLIBS æŒ‡å®šè¿™ä¸ªæ¨¡å—é‡Œä¼šç”¨åˆ°å“ªäº›åŸç”Ÿ API, è¯¦è§ Android NDK Native APIs</p>
</li>
<li><p>BUILD_SHARED_LIBRARY æ ¹æ®ä½ ä¹‹å‰å®šä¹‰çš„ LOCAL_XXX å˜é‡ï¼Œå†³å®šè¦ç¼–è¯‘å•¥ï¼Œå¦‚ä½•å»ç¼–è¯‘ï¼Œè¿™è¡Œå‘½ä»¤ä¸€èˆ¬ä¹Ÿä¸éœ€è¦åŠ¨ï¼Œå›ºå®šçš„</p>
</li>
</ul>
<p>Application.mk</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">APP_STL := gnustl_static</span><br></pre></td></tr></table></figure>
<ul>
<li>APP_STL æŒ‡å®šä½¿ç”¨å“ªäº› C++ è¿è¡Œæ—¶, è¯¦è§ C++ Library Support</li>
</ul>
<p>Android.mk å’Œ Application.mk éƒ½æ”¾åœ¨ jni ç›®å½•ä¸‹,ï¼Œ<br>é¡¹ç›®æ–‡ä»¶ç»“æ„å¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">|____app</span><br><span class="line">| |____src</span><br><span class="line">| | |____main</span><br><span class="line">| | | |____jni</span><br><span class="line">| | | | |____Android.mk</span><br><span class="line">| | | | |____Application.mk</span><br><span class="line">| | | | |____blur.cpp</span><br></pre></td></tr></table></figure>
<h3 id="å¦‚ä½•ä½¿ç”¨-C-ä»£ç "><a href="#å¦‚ä½•ä½¿ç”¨-C-ä»£ç " class="headerlink" title="å¦‚ä½•ä½¿ç”¨ C++ ä»£ç ?"></a>å¦‚ä½•ä½¿ç”¨ C++ ä»£ç ?</h3><p>å‰é¢å·²ç»ç»™å‡ºäº† Android.mk å’Œ Application.mk çš„ç¤ºä¾‹ï¼Œä¸‹é¢åœ¨ build.gradle é‡Œé…ç½® externalNativeBuild å°±å¯ä»¥è‡ªåŠ¨ç¼–è¯‘ C++ ä»£ç äº†</p>
<p>ç¤ºä¾‹å†…å®¹å¦‚ä¸‹</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">defaultConfig &#123;</span><br><span class="line">	applicationId <span class="string">"com.example.app"</span></span><br><span class="line">	minSdkVersion <span class="number">16</span></span><br><span class="line">	targetSdkVersion <span class="number">24</span></span><br><span class="line">	versionCode <span class="number">102</span></span><br><span class="line">	versionName <span class="string">"0.2"</span></span><br><span class="line">	externalNativeBuild &#123;</span><br><span class="line">		ndkBuild &#123;</span><br><span class="line">			arguments <span class="string">"NDK_APPLICATION_MK:=src/main/jni/Application.mk"</span></span><br><span class="line">			cFlags <span class="string">"-DTEST_C_FLAG1"</span>, <span class="string">"-DTEST_C_FLAG2"</span></span><br><span class="line">			cppFlags <span class="string">"-DTEST_CPP_FLAG2"</span>, <span class="string">"-DTEST_CPP_FLAG2"</span></span><br><span class="line">			abiFilters <span class="string">"armeabi-v7a"</span>, <span class="string">"armeabi"</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">externalNativeBuild &#123;</span><br><span class="line">	ndkBuild &#123;</span><br><span class="line">		path <span class="string">"src/main/jni/Android.mk"</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>path ç”¨æ¥æŒ‡å®š Android.mk çš„è·¯å¾„</li>
<li>arguments ç”¨æ¥æŒ‡å®š Application.mk çš„è·¯å¾„</li>
<li>abiFilters ç”¨æ¥æŒ‡å®šç”Ÿæˆå“ªäº›å¹³å°çš„ .so æ–‡ä»¶</li>
<li>cFlags å’Œ cppFlags æ˜¯ç”¨æ¥è®¾ç½®ç¯å¢ƒå˜é‡çš„, ä¸€èˆ¬ä¸éœ€è¦åŠ¨ï¼Œå’Œç¤ºä¾‹ä¸€æ ·å°±å¥½ï¼Œ<br>å¥½äº†ï¼Œç°åœ¨è¿è¡Œé¡¹ç›®ï¼Œå°±å¯ä»¥å°† blur.cpp è‡ªåŠ¨ç¼–è¯‘ä¸º libgaussianBlur.so æ–‡ä»¶äº†</li>
</ul>
<h3 id="æ‰‹åŠ¨ç”Ÿæˆ-so-æ–‡ä»¶"><a href="#æ‰‹åŠ¨ç”Ÿæˆ-so-æ–‡ä»¶" class="headerlink" title="æ‰‹åŠ¨ç”Ÿæˆ .so æ–‡ä»¶"></a>æ‰‹åŠ¨ç”Ÿæˆ .so æ–‡ä»¶</h3><p>å¦‚æœèƒ½ç›´æ¥å¼•ç”¨ç”Ÿæˆå¥½çš„ .so æ–‡ä»¶ï¼Œå¯ä»¥é¿å…é‡å¤ç¼–è¯‘ .so æ–‡ä»¶ï¼Œä»è€ŒåŠ å¿«åº”ç”¨ build é€Ÿåº¦</p>
<p>ä¸‹é¢æ˜¯æ‰‹åŠ¨ç”Ÿæˆ .so æ–‡ä»¶çš„æ­¥éª¤</p>
<h4 id="è¿›å…¥-main-ç›®å½•"><a href="#è¿›å…¥-main-ç›®å½•" class="headerlink" title="è¿›å…¥ main ç›®å½•"></a>è¿›å…¥ main ç›®å½•</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd app/src/main</span><br></pre></td></tr></table></figure>
<h4 id="ç”Ÿæˆ-so-æ–‡ä»¶"><a href="#ç”Ÿæˆ-so-æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆ .so æ–‡ä»¶"></a>ç”Ÿæˆ .so æ–‡ä»¶</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Users/lee/Library/Android/sdk/ndk-bundle/ndk-build NDK_PROJECT_PATH=. NDK_APPLICATION_MK=./jni/Application.mk NDK_LIBS_OUT=./jniLibs</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤åï¼Œä¼šåœ¨ app/src/main/jniLibs ç›®å½•ç”Ÿæˆå„ä¸ªå¹³å°çš„ .so æ–‡ä»¶<br>å¦‚æœéœ€è¦æŠŠ .so æ–‡ä»¶å…±äº«ç»™å…¶ä»–äººï¼ŒæŠŠè¿™äº›å¹³å°ä¸‹çš„ .so æ–‡ä»¶å‘ç»™å…¶ä»–äººå°±å¥½äº†</p>
<ul>
<li>NDK_PROJECT_PATH æŒ‡å®šé¡¹ç›®è·¯å¾„, ä¼šè‡ªåŠ¨è¯»å–è¿™ä¸ªç›®å½•ä¸‹çš„ jni/Android.mk æ–‡ä»¶</li>
<li>NDK_APPLICATION_MK æŒ‡å®š Application.mk çš„ä½ç½®</li>
<li>NDK_LIBS_OUT æŒ‡å®šå°†ç”Ÿæˆçš„ .so æ–‡ä»¶æ”¾åˆ°å“ªä¸ªç›®å½•ï¼Œé»˜è®¤ Android Studio ä¼šè¯»å– jniLibs ç›®å½•ä¸‹çš„ .so æ–‡ä»¶, æ‰€ä»¥æˆ‘ä»¬æŠŠ .so æ–‡ä»¶ç”Ÿæˆåˆ°è¿™</li>
</ul>
<p>æµ‹è¯•ç»“æœ: ï¼ˆæµ‹è¯•å‡åœ¨ clean é¡¹ç›®åè¿›è¡Œï¼‰<br>å¼•ç”¨ .so æ–‡ä»¶å‰å¹³å‡è€—æ—¶ 1m 27s<br>å¼•ç”¨ .so æ–‡ä»¶åå¹³å‡è€—æ—¶ 47s<br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° build é€Ÿåº¦å¿«äº†å°†è¿‘ä¸€å€</p>
<p>è°ƒè¯• NDK<br>è®© NDK_LOG å˜é‡ä¸º1ï¼Œå°±å¯ä»¥æ‰“å°æ—¥å¿—ä¿¡æ¯</p>
<p>ndk-build -e NDK_LOG=1</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="http://jk2k.com/2016/09/how-to-use-ndk-and-generate-so-file-in-android-studio/" target="_blank" rel="noopener">http://jk2k.com/2016/09/how-to-use-ndk-and-generate-so-file-in-android-studio/</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ndk </tag>
            
            <tag> jni </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CPP Note]]></title>
      <url>/2017/04/10/CPP-Note/</url>
      <content type="html"><![CDATA[<p>hello.cpp -&gt; ç¼–è¯‘ä»£ç <code>g++ hello.cpp -o a</code> -&gt; <code>a.out</code></p>
<p>åŒºåˆ†å¤§å°å†™çš„ç¼–ç¨‹è¯­è¨€</p>
<a id="more"></a>
<h3 id="å†…ç½®ç±»å‹"><a href="#å†…ç½®ç±»å‹" class="headerlink" title="å†…ç½®ç±»å‹"></a>å†…ç½®ç±»å‹</h3><p>ä¸€äº›åŸºæœ¬ç±»å‹å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹ä¿®é¥°ç¬¦è¿›è¡Œä¿®é¥°ï¼š</p>
<ul>
<li><strong>signed</strong>: char, int</li>
<li><strong>unsigned</strong>: char, int</li>
<li><strong>short</strong>: int</li>
<li><strong>long</strong>: int, double</li>
</ul>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>å­—èŠ‚</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>bool</strong></td>
<td></td>
</tr>
<tr>
<td><strong>char</strong></td>
<td>1</td>
</tr>
<tr>
<td><strong>int</strong></td>
<td>4, 2(short), 8(long)</td>
</tr>
<tr>
<td><strong>float</strong></td>
<td>4</td>
</tr>
<tr>
<td><strong>double</strong></td>
<td>8</td>
</tr>
<tr>
<td><strong>void</strong></td>
<td></td>
</tr>
<tr>
<td><strong>wchar_t</strong>ï¼ˆå®½å­—ç¬¦å‹ï¼‰</td>
<td>2, 4</td>
</tr>
</tbody>
</table>
<h3 id="typedef-å£°æ˜"><a href="#typedef-å£°æ˜" class="headerlink" title="typedef å£°æ˜"></a>typedef å£°æ˜</h3><p>ä½¿ç”¨ <code>typedef</code> ä¸ºä¸€ä¸ªå·²æœ‰çš„ç±»å‹å–ä¸€ä¸ªæ–°çš„åå­—:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> feet;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">feet distance;</span><br></pre></td></tr></table></figure>
<h3 id="æšä¸¾ç±»å‹"><a href="#æšä¸¾ç±»å‹" class="headerlink" title="æšä¸¾ç±»å‹"></a>æšä¸¾ç±»å‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enum enum-name &#123; list of names &#125; var-list;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">enum color &#123; red, green, blue &#125; c;</span><br><span class="line">c = blue;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enum color &#123; red, green=5, blue &#125;;</span><br></pre></td></tr></table></figure>
<p>åˆ™ blue = 6</p>
<h3 id="å˜é‡å®šä¹‰"><a href="#å˜é‡å®šä¹‰" class="headerlink" title="å˜é‡å®šä¹‰"></a>å˜é‡å®šä¹‰</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">type variable_list;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span>    i, j, k;</span><br><span class="line"><span class="keyword">char</span>   c, ch;</span><br><span class="line"><span class="keyword">float</span>  f, salary;</span><br><span class="line"><span class="keyword">double</span> d;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> d = <span class="number">3</span>, f = <span class="number">5</span>;    <span class="comment">// d å’Œ f çš„å£°æ˜ </span></span><br><span class="line"><span class="keyword">int</span> d = <span class="number">3</span>, f = <span class="number">5</span>;           <span class="comment">// å®šä¹‰å¹¶åˆå§‹åŒ– d å’Œ f</span></span><br><span class="line">byte z = <span class="number">22</span>;                <span class="comment">// å®šä¹‰å¹¶åˆå§‹åŒ– z</span></span><br><span class="line"><span class="keyword">char</span> x = <span class="string">'x'</span>;               <span class="comment">// å˜é‡ x çš„å€¼ä¸º 'x'</span></span><br></pre></td></tr></table></figure>
<h3 id="å˜é‡å£°æ˜"><a href="#å˜é‡å£°æ˜" class="headerlink" title="å˜é‡å£°æ˜"></a>å˜é‡å£°æ˜</h3><p>å˜é‡å£°æ˜å‘ç¼–è¯‘å™¨ä¿è¯å˜é‡ä»¥ç»™å®šçš„ç±»å‹å’Œåç§°å­˜åœ¨ï¼Œè¿™æ ·ç¼–è¯‘å™¨åœ¨ä¸éœ€è¦çŸ¥é“å˜é‡å®Œæ•´ç»†èŠ‚çš„æƒ…å†µä¸‹ä¹Ÿèƒ½ç»§ç»­è¿›ä¸€æ­¥çš„ç¼–è¯‘ã€‚å˜é‡å£°æ˜åªåœ¨ç¼–è¯‘æ—¶æœ‰å®ƒçš„æ„ä¹‰ï¼Œåœ¨ç¨‹åºè¿æ¥æ—¶ç¼–è¯‘å™¨éœ€è¦å®é™…çš„å˜é‡å£°æ˜ã€‚</p>
<h3 id="å…¨å±€å˜é‡é»˜è®¤å€¼"><a href="#å…¨å±€å˜é‡é»˜è®¤å€¼" class="headerlink" title="å…¨å±€å˜é‡é»˜è®¤å€¼"></a>å…¨å±€å˜é‡é»˜è®¤å€¼</h3><table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>int</td>
<td>0</td>
</tr>
<tr>
<td>char</td>
<td>â€˜\0â€™</td>
</tr>
<tr>
<td>float</td>
<td>0</td>
</tr>
<tr>
<td>double</td>
<td>0</td>
</tr>
<tr>
<td>pointer</td>
<td>NULL</td>
</tr>
</tbody>
</table>
<h3 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h3><blockquote>
<p>0x æˆ– 0X è¡¨ç¤ºåå…­è¿›åˆ¶ï¼Œ0 è¡¨ç¤ºå…«è¿›åˆ¶ï¼Œä¸å¸¦å‰ç¼€åˆ™é»˜è®¤è¡¨ç¤ºåè¿›åˆ¶ã€‚</p>
</blockquote>
<h4 id="æ•´æ•°å¸¸é‡"><a href="#æ•´æ•°å¸¸é‡" class="headerlink" title="æ•´æ•°å¸¸é‡"></a>æ•´æ•°å¸¸é‡</h4><p>ä¹Ÿå¯ä»¥å¸¦ä¸€ä¸ªæˆ–è€…å¤šä¸ªåç¼€ï¼š</p>
<ul>
<li>â€˜<strong>U</strong>â€˜: unsigned</li>
<li>â€˜<strong>L</strong>â€˜: long</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">85         // åè¿›åˆ¶</span><br><span class="line">0213       // å…«è¿›åˆ¶ </span><br><span class="line">0x4b       // åå…­è¿›åˆ¶ </span><br><span class="line">30         // æ•´æ•° </span><br><span class="line">30u        // æ— ç¬¦å·æ•´æ•° </span><br><span class="line">30l        // é•¿æ•´æ•° </span><br><span class="line">30ul       // æ— ç¬¦å·é•¿æ•´æ•°</span><br></pre></td></tr></table></figure>
<h4 id="æµ®ç‚¹å¸¸é‡"><a href="#æµ®ç‚¹å¸¸é‡" class="headerlink" title="æµ®ç‚¹å¸¸é‡"></a>æµ®ç‚¹å¸¸é‡</h4><p>ç”±æ•´æ•°éƒ¨åˆ†ã€å°æ•°ç‚¹ã€å°æ•°éƒ¨åˆ†å’ŒæŒ‡æ•°éƒ¨åˆ†ç»„æˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">3.14159       // åˆæ³•çš„ </span><br><span class="line">314159E-5L    // åˆæ³•çš„ </span><br><span class="line">510E          // éæ³•çš„ï¼šä¸å®Œæ•´çš„æŒ‡æ•°</span><br><span class="line">210f          // éæ³•çš„ï¼šæ²¡æœ‰å°æ•°æˆ–æŒ‡æ•°</span><br><span class="line">.e55          // éæ³•çš„ï¼šç¼ºå°‘æ•´æ•°æˆ–åˆ†æ•°</span><br></pre></td></tr></table></figure>
<h4 id="å¸ƒå°”å¸¸é‡"><a href="#å¸ƒå°”å¸¸é‡" class="headerlink" title="å¸ƒå°”å¸¸é‡"></a>å¸ƒå°”å¸¸é‡</h4><ul>
<li><strong>true</strong>: å€¼ä»£è¡¨çœŸã€‚</li>
<li><strong>false</strong>: å€¼ä»£è¡¨å‡ã€‚</li>
</ul>
<blockquote>
<p>ä¸åº”æŠŠ true çš„å€¼çœ‹æˆ 1ï¼ŒæŠŠ false çš„å€¼çœ‹æˆ 0ã€‚</p>
</blockquote>
<h4 id="å­—ç¬¦å¸¸é‡"><a href="#å­—ç¬¦å¸¸é‡" class="headerlink" title="å­—ç¬¦å¸¸é‡"></a>å­—ç¬¦å¸¸é‡</h4><p>å­—ç¬¦å¸¸é‡æ˜¯æ‹¬åœ¨å•å¼•å·ä¸­ã€‚å¦‚æœå¸¸é‡ä»¥ Lï¼ˆä»…å½“å¤§å†™æ—¶ï¼‰å¼€å¤´ï¼Œåˆ™è¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªå®½å­—ç¬¦å¸¸é‡ï¼ˆä¾‹å¦‚ Lâ€™xâ€™ï¼‰ï¼Œæ­¤æ—¶å®ƒå¿…é¡»å­˜å‚¨åœ¨ wchar_t ç±»å‹çš„å˜é‡ä¸­ã€‚å¦åˆ™ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªçª„å­—ç¬¦å¸¸é‡ï¼ˆä¾‹å¦‚ â€˜xâ€™ï¼‰ï¼Œæ­¤æ—¶å®ƒå¯ä»¥å­˜å‚¨åœ¨ char ç±»å‹çš„ç®€å•å˜é‡ä¸­ã€‚</p>
<table>
<thead>
<tr>
<th>è½¬ä¹‰åºåˆ—</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>\</td>
<td>\ å­—ç¬¦</td>
</tr>
<tr>
<td>\â€™</td>
<td>â€˜ å­—ç¬¦</td>
</tr>
<tr>
<td>\â€</td>
<td>â€œ å­—ç¬¦</td>
</tr>
<tr>
<td>\?</td>
<td>? å­—ç¬¦</td>
</tr>
<tr>
<td>\a</td>
<td>è­¦æŠ¥é“ƒå£°</td>
</tr>
<tr>
<td>\b</td>
<td>é€€æ ¼é”®</td>
</tr>
<tr>
<td>\f</td>
<td>æ¢é¡µç¬¦</td>
</tr>
<tr>
<td>\n</td>
<td>æ¢è¡Œç¬¦</td>
</tr>
<tr>
<td>\r</td>
<td>å›è½¦</td>
</tr>
<tr>
<td>\t</td>
<td>æ°´å¹³åˆ¶è¡¨ç¬¦</td>
</tr>
<tr>
<td>\v</td>
<td>å‚ç›´åˆ¶è¡¨ç¬¦</td>
</tr>
</tbody>
</table>
<p>\ooo|ä¸€åˆ°ä¸‰ä½çš„å…«è¿›åˆ¶æ•°|<br>\xhh . . .|ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—çš„åå…­è¿›åˆ¶æ•°|</p>
<h4 id="å­—ç¬¦ä¸²å¸¸é‡"><a href="#å­—ç¬¦ä¸²å¸¸é‡" class="headerlink" title="å­—ç¬¦ä¸²å¸¸é‡"></a>å­—ç¬¦ä¸²å¸¸é‡</h4><p>ä¸‹é¢è¿™ä¸‰ç§å½¢å¼æ‰€æ˜¾ç¤ºçš„å­—ç¬¦ä¸²æ˜¯ç›¸åŒçš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;hello, dear&quot;</span><br><span class="line"></span><br><span class="line">&quot;hello, \</span><br><span class="line"></span><br><span class="line">dear&quot;</span><br><span class="line"></span><br><span class="line">&quot;hello, &quot; &quot;d&quot; &quot;ear&quot;</span><br></pre></td></tr></table></figure>
<h3 id="å®šä¹‰å¸¸é‡"><a href="#å®šä¹‰å¸¸é‡" class="headerlink" title="å®šä¹‰å¸¸é‡"></a>å®šä¹‰å¸¸é‡</h3><p>ä¸¤ç§ç®€å•çš„å®šä¹‰å¸¸é‡çš„æ–¹å¼ï¼š</p>
<ul>
<li>ä½¿ç”¨ <strong>#define</strong> é¢„å¤„ç†å™¨ã€‚</li>
<li>ä½¿ç”¨ <strong>const</strong> å…³é”®å­—ã€‚</li>
</ul>
<h4 id="define-é¢„å¤„ç†å™¨"><a href="#define-é¢„å¤„ç†å™¨" class="headerlink" title="#define é¢„å¤„ç†å™¨"></a>#define é¢„å¤„ç†å™¨</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define identifier value</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#define LENGTH 10   </span><br><span class="line">#define WIDTH  5</span><br><span class="line">#define NEWLINE &apos;\n&apos;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line"></span><br><span class="line">   int area;  </span><br><span class="line"></span><br><span class="line">   area = LENGTH * WIDTH;</span><br><span class="line">   cout &lt;&lt; area;</span><br><span class="line">   cout &lt;&lt; NEWLINE;</span><br><span class="line">   return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="const-å…³é”®å­—"><a href="#const-å…³é”®å­—" class="headerlink" title="const å…³é”®å­—"></a>const å…³é”®å­—</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const type variable = value;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">const</span> <span class="keyword">int</span>  LENGTH = <span class="number">10</span>;</span><br><span class="line">   <span class="keyword">const</span> <span class="keyword">int</span>  WIDTH  = <span class="number">5</span>;</span><br><span class="line">   <span class="keyword">const</span> <span class="keyword">char</span> NEWLINE = <span class="string">'\n'</span>;</span><br><span class="line">   <span class="keyword">int</span> area;  </span><br><span class="line"></span><br><span class="line">   area = LENGTH * WIDTH;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; area;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; NEWLINE;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¿®é¥°ç¬¦ç±»å‹"><a href="#ä¿®é¥°ç¬¦ç±»å‹" class="headerlink" title="ä¿®é¥°ç¬¦ç±»å‹"></a>ä¿®é¥°ç¬¦ç±»å‹</h3><p>å¯ä»¥ä¸å†™ intï¼Œåªå†™å•è¯ unsignedã€short æˆ– unsignedã€longï¼Œint æ˜¯éšå«çš„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unsigned x;</span><br><span class="line">unsigned <span class="keyword">int</span> y;</span><br></pre></td></tr></table></figure>
<h3 id="ç±»å‹é™å®šç¬¦"><a href="#ç±»å‹é™å®šç¬¦" class="headerlink" title="ç±»å‹é™å®šç¬¦"></a>ç±»å‹é™å®šç¬¦</h3><table>
<thead>
<tr>
<th>é™å®šç¬¦</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>const</td>
<td>const ç±»å‹çš„å¯¹è±¡åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ä¸èƒ½è¢«ä¿®æ”¹æ”¹å˜ã€‚</td>
</tr>
<tr>
<td>volatile</td>
<td>ä¿®é¥°ç¬¦ volatile å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œå˜é‡çš„å€¼å¯èƒ½ä»¥ç¨‹åºæœªæ˜ç¡®æŒ‡å®šçš„æ–¹å¼è¢«æ”¹å˜ã€‚</td>
</tr>
<tr>
<td>restrict</td>
<td>ç”± restrict ä¿®é¥°çš„æŒ‡é’ˆæ˜¯å”¯ä¸€ä¸€ç§è®¿é—®å®ƒæ‰€æŒ‡å‘çš„å¯¹è±¡çš„æ–¹å¼ã€‚åªæœ‰ C99 å¢åŠ äº†æ–°çš„ç±»å‹é™å®šç¬¦ restrictã€‚</td>
</tr>
</tbody>
</table>
<h3 id="å­˜å‚¨ç±»"><a href="#å­˜å‚¨ç±»" class="headerlink" title="å­˜å‚¨ç±»"></a>å­˜å‚¨ç±»</h3><p>å­˜å‚¨ç±»å®šä¹‰ C++ ç¨‹åºä¸­å˜é‡/å‡½æ•°çš„èŒƒå›´ï¼ˆå¯è§æ€§ï¼‰å’Œç”Ÿå‘½å‘¨æœŸã€‚</p>
<ul>
<li>auto: ä» C++ 11 å¼€å§‹ä¸å†æ˜¯ C++ å­˜å‚¨ç±»è¯´æ˜ç¬¦</li>
<li>register: ä» C++ 11 å¼€å§‹è¢«å¼ƒç”¨</li>
<li>static</li>
<li>extern</li>
<li>mutable</li>
<li>thread_local (C++11)</li>
</ul>
<h4 id="auto-å­˜å‚¨ç±»"><a href="#auto-å­˜å‚¨ç±»" class="headerlink" title="auto å­˜å‚¨ç±»"></a>auto å­˜å‚¨ç±»</h4><p>å£°æ˜å˜é‡æ—¶æ ¹æ®åˆå§‹åŒ–è¡¨è¾¾å¼è‡ªåŠ¨æ¨æ–­è¯¥å˜é‡çš„ç±»å‹ã€å£°æ˜å‡½æ•°æ—¶å‡½æ•°è¿”å›å€¼çš„å ä½ç¬¦ã€‚ä½¿ç”¨æå°‘ä¸”å¤šä½™ï¼Œåœ¨C++11ä¸­å·²åˆ é™¤è¿™ä¸€ç”¨æ³•ã€‚</p>
<h4 id="register-å­˜å‚¨ç±»"><a href="#register-å­˜å‚¨ç±»" class="headerlink" title="register å­˜å‚¨ç±»"></a>register å­˜å‚¨ç±»</h4><p>register å­˜å‚¨ç±»ç”¨äºå®šä¹‰å­˜å‚¨åœ¨å¯„å­˜å™¨ä¸­è€Œä¸æ˜¯ RAM ä¸­çš„å±€éƒ¨å˜é‡ã€‚è¿™æ„å‘³ç€å˜é‡çš„æœ€å¤§å°ºå¯¸ç­‰äºå¯„å­˜å™¨çš„å¤§å°ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªè¯ï¼‰ï¼Œä¸”ä¸èƒ½å¯¹å®ƒåº”ç”¨ä¸€å…ƒçš„ â€˜&amp;â€™ è¿ç®—ç¬¦ï¼ˆå› ä¸ºå®ƒæ²¡æœ‰å†…å­˜ä½ç½®ï¼‰ã€‚</p>
<p>å¯„å­˜å™¨åªç”¨äºéœ€è¦å¿«é€Ÿè®¿é—®çš„å˜é‡ï¼Œæ¯”å¦‚è®¡æ•°å™¨ã€‚è¿˜åº”æ³¨æ„çš„æ˜¯ï¼Œå®šä¹‰ â€˜registerâ€™ å¹¶ä¸æ„å‘³ç€å˜é‡å°†è¢«å­˜å‚¨åœ¨å¯„å­˜å™¨ä¸­ï¼Œå®ƒæ„å‘³ç€å˜é‡å¯èƒ½å­˜å‚¨åœ¨å¯„å­˜å™¨ä¸­ï¼Œè¿™å–å†³äºç¡¬ä»¶å’Œå®ç°çš„é™åˆ¶ã€‚</p>
<h4 id="static-å­˜å‚¨ç±»"><a href="#static-å­˜å‚¨ç±»" class="headerlink" title="static å­˜å‚¨ç±»"></a>static å­˜å‚¨ç±»</h4><p>static å­˜å‚¨ç±»æŒ‡ç¤ºç¼–è¯‘å™¨åœ¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå†…ä¿æŒå±€éƒ¨å˜é‡çš„å­˜åœ¨ï¼Œè€Œä¸éœ€è¦åœ¨æ¯æ¬¡å®ƒè¿›å…¥å’Œç¦»å¼€ä½œç”¨åŸŸæ—¶è¿›è¡Œåˆ›å»ºå’Œé”€æ¯ã€‚</p>
<p><strong>static å¯ç”¨äºå±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡</strong></p>
<h4 id="extern-å­˜å‚¨ç±»"><a href="#extern-å­˜å‚¨ç±»" class="headerlink" title="extern å­˜å‚¨ç±»"></a>extern å­˜å‚¨ç±»</h4><p>extern å­˜å‚¨ç±»ç”¨äºæä¾›ä¸€ä¸ªå…¨å±€å˜é‡çš„å¼•ç”¨ï¼Œå…¨å±€å˜é‡å¯¹æ‰€æœ‰çš„ç¨‹åºæ–‡ä»¶éƒ½æ˜¯å¯è§çš„ã€‚<br>é€šè¿‡ extern å£°æ˜å…¶å®ƒæ–‡ä»¶çš„å˜é‡ï¼Œç„¶ååœ¨æœ¬æ–‡ä»¶ä¸­ä½¿ç”¨ã€‚</p>
<h4 id="mutable-å­˜å‚¨ç±»"><a href="#mutable-å­˜å‚¨ç±»" class="headerlink" title="mutable å­˜å‚¨ç±»"></a>mutable å­˜å‚¨ç±»</h4><p>mutable è¯´æ˜ç¬¦ä»…é€‚ç”¨äºç±»çš„å¯¹è±¡ï¼Œå®ƒå…è®¸å¯¹è±¡çš„æˆå‘˜æ›¿ä»£å¸¸é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œmutable æˆå‘˜å¯ä»¥é€šè¿‡ const æˆå‘˜å‡½æ•°ä¿®æ”¹ã€‚</p>
<h4 id="thread-local-å­˜å‚¨ç±»"><a href="#thread-local-å­˜å‚¨ç±»" class="headerlink" title="thread_local å­˜å‚¨ç±»"></a>thread_local å­˜å‚¨ç±»</h4><p>ä½¿ç”¨ thread_local è¯´æ˜ç¬¦å£°æ˜çš„å˜é‡ä»…å¯åœ¨å®ƒåœ¨å…¶ä¸Šåˆ›å»ºçš„çº¿ç¨‹ä¸Šè®¿é—®ã€‚ å˜é‡åœ¨åˆ›å»ºçº¿ç¨‹æ—¶åˆ›å»ºï¼Œå¹¶åœ¨é”€æ¯çº¿ç¨‹æ—¶é”€æ¯ã€‚ æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å…¶è‡ªå·±çš„å˜é‡å‰¯æœ¬ã€‚<br>thread_local è¯´æ˜ç¬¦å¯ä»¥ä¸ static æˆ– extern åˆå¹¶ã€‚<br>å¯ä»¥å°† thread_local ä»…åº”ç”¨äºæ•°æ®å£°æ˜å’Œå®šä¹‰ï¼Œthread_local ä¸èƒ½ç”¨äºå‡½æ•°å£°æ˜æˆ–å®šä¹‰ã€‚</p>
<h3 id="æ‚é¡¹è¿ç®—ç¬¦"><a href="#æ‚é¡¹è¿ç®—ç¬¦" class="headerlink" title="æ‚é¡¹è¿ç®—ç¬¦"></a>æ‚é¡¹è¿ç®—ç¬¦</h3><table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>sizeof</td>
<td>sizeof è¿ç®—ç¬¦è¿”å›å˜é‡çš„å¤§å°ã€‚ä¾‹å¦‚ï¼Œsizeof(a) å°†è¿”å› 4ï¼Œå…¶ä¸­ a æ˜¯æ•´æ•°ã€‚</td>
</tr>
<tr>
<td>Condition ? X : Y</td>
<td>æ¡ä»¶è¿ç®—ç¬¦ã€‚å¦‚æœ Condition ä¸ºçœŸ ? åˆ™å€¼ä¸º X : å¦åˆ™å€¼ä¸º Yã€‚</td>
</tr>
<tr>
<td>,</td>
<td>é€—å·è¿ç®—ç¬¦ä¼šé¡ºåºæ‰§è¡Œä¸€ç³»åˆ—è¿ç®—ã€‚æ•´ä¸ªé€—å·è¡¨è¾¾å¼çš„å€¼æ˜¯ä»¥é€—å·åˆ†éš”çš„åˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚</td>
</tr>
<tr>
<td>.ï¼ˆç‚¹ï¼‰å’Œ -&gt;ï¼ˆç®­å¤´ï¼‰</td>
<td>æˆå‘˜è¿ç®—ç¬¦ç”¨äºå¼•ç”¨ç±»ã€ç»“æ„å’Œå…±ç”¨ä½“çš„æˆå‘˜ã€‚</td>
</tr>
<tr>
<td>Cast</td>
<td>å¼ºåˆ¶è½¬æ¢è¿ç®—ç¬¦æŠŠä¸€ç§æ•°æ®ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚ï¼Œint(2.2000) å°†è¿”å› 2ã€‚</td>
</tr>
<tr>
<td>&amp;</td>
<td>æŒ‡é’ˆè¿ç®—ç¬¦ &amp; è¿”å›å˜é‡çš„åœ°å€ã€‚ä¾‹å¦‚ &a; å°†ç»™å‡ºå˜é‡çš„å®é™…åœ°å€ã€‚</td>
</tr>
<tr>
<td>*</td>
<td>æŒ‡é’ˆè¿ç®—ç¬¦ * æŒ‡å‘ä¸€ä¸ªå˜é‡ã€‚ä¾‹å¦‚ï¼Œ*var; å°†æŒ‡å‘å˜é‡ varã€‚</td>
</tr>
</tbody>
</table>
<h3 id="å‡½æ•°å‚æ•°"><a href="#å‡½æ•°å‚æ•°" class="headerlink" title="å‡½æ•°å‚æ•°"></a>å‡½æ•°å‚æ•°</h3><table>
<thead>
<tr>
<th>è°ƒç”¨ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä¼ å€¼è°ƒç”¨</td>
<td>è¯¥æ–¹æ³•æŠŠå‚æ•°çš„å®é™…å€¼å¤åˆ¶ç»™å‡½æ•°çš„å½¢å¼å‚æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¿®æ”¹å‡½æ•°å†…çš„å½¢å¼å‚æ•°å¯¹å®é™…å‚æ•°æ²¡æœ‰å½±å“ã€‚</td>
</tr>
<tr>
<td>æŒ‡é’ˆè°ƒç”¨</td>
<td>è¯¥æ–¹æ³•æŠŠå‚æ•°çš„åœ°å€å¤åˆ¶ç»™å½¢å¼å‚æ•°ã€‚åœ¨å‡½æ•°å†…ï¼Œè¯¥åœ°å€ç”¨äºè®¿é—®è°ƒç”¨ä¸­è¦ç”¨åˆ°çš„å®é™…å‚æ•°ã€‚è¿™æ„å‘³ç€ï¼Œä¿®æ”¹å½¢å¼å‚æ•°ä¼šå½±å“å®é™…å‚æ•°ã€‚</td>
</tr>
<tr>
<td>å¼•ç”¨è°ƒç”¨</td>
<td>è¯¥æ–¹æ³•æŠŠå‚æ•°çš„å¼•ç”¨å¤åˆ¶ç»™å½¢å¼å‚æ•°ã€‚åœ¨å‡½æ•°å†…ï¼Œè¯¥å¼•ç”¨ç”¨äºè®¿é—®è°ƒç”¨ä¸­è¦ç”¨åˆ°çš„å®é™…å‚æ•°ã€‚è¿™æ„å‘³ç€ï¼Œä¿®æ”¹å½¢å¼å‚æ•°ä¼šå½±å“å®é™…å‚æ•°ã€‚</td>
</tr>
</tbody>
</table>
<p><strong>é»˜è®¤æƒ…å†µä¸‹ï¼ŒC++ ä½¿ç”¨ä¼ å€¼è°ƒç”¨æ¥ä¼ é€’å‚æ•°ã€‚</strong>ä¸€èˆ¬æ¥è¯´ï¼Œè¿™æ„å‘³ç€å‡½æ•°å†…çš„ä»£ç ä¸èƒ½æ”¹å˜ç”¨äºè°ƒç”¨å‡½æ•°çš„å‚æ•°ã€‚ä¹‹å‰æåˆ°çš„å®ä¾‹ï¼Œè°ƒç”¨ max() å‡½æ•°æ—¶ï¼Œä½¿ç”¨äº†ç›¸åŒçš„æ–¹æ³•ã€‚</p>
<h3 id="å‚æ•°çš„é»˜è®¤å€¼"><a href="#å‚æ•°çš„é»˜è®¤å€¼" class="headerlink" title="å‚æ•°çš„é»˜è®¤å€¼"></a>å‚æ•°çš„é»˜è®¤å€¼</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b=<span class="number">20</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> result;</span><br><span class="line"></span><br><span class="line">  result = a + b;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">result = sum(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 3</span></span><br><span class="line">result = sum(<span class="number">1</span>); <span class="comment">// 21</span></span><br></pre></td></tr></table></figure>
<h3 id="Lambda-å‡½æ•°ä¸è¡¨è¾¾å¼"><a href="#Lambda-å‡½æ•°ä¸è¡¨è¾¾å¼" class="headerlink" title="Lambda å‡½æ•°ä¸è¡¨è¾¾å¼"></a>Lambda å‡½æ•°ä¸è¡¨è¾¾å¼</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ‰å‚æ•°ï¼š[capture](parameters)-&gt;return-type&#123;body&#125;</span></span><br><span class="line">[](<span class="keyword">int</span> x, <span class="keyword">int</span> y)&#123; <span class="keyword">return</span> x &lt; y ; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ— å‚æ•°ï¼š[capture](parameters)&#123;body&#125;</span></span><br><span class="line">[]&#123; ++global_x; &#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›ç±»å‹å¯ä»¥è¢«æ˜ç¡®çš„æŒ‡å®š:</span></span><br><span class="line">[](<span class="keyword">int</span> x, <span class="keyword">int</span> y) -&gt; <span class="keyword">int</span> &#123; <span class="keyword">int</span> z = x + y; <span class="keyword">return</span> z + x; &#125;</span><br></pre></td></tr></table></figure>
<p>å˜é‡ä¼ é€’æœ‰ä¼ å€¼å’Œä¼ å¼•ç”¨çš„åŒºåˆ«ã€‚å¯ä»¥é€šè¿‡å‰é¢çš„[]æ¥æŒ‡å®šï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[]      // æ²’æœ‰å®šä¹‰ä»»ä½•å˜é‡ã€‚ä½¿ç”¨æœªå®šä¹‰å˜é‡ä¼šå¼•å‘é”™è¯¯ã€‚</span><br><span class="line">[x, &amp;y] // xä»¥ä¼ å€¼æ–¹å¼ä¼ å…¥ï¼ˆé»˜è®¤ï¼‰ï¼Œyä»¥å¼•ç”¨æ–¹å¼ä¼ å…¥ã€‚</span><br><span class="line">[&amp;]     // ä»»ä½•è¢«ä½¿ç”¨åˆ°çš„å¤–éƒ¨å˜é‡éƒ½éšå¼åœ°ä»¥å¼•ç”¨æ–¹å¼åŠ ä»¥å¼•ç”¨ã€‚</span><br><span class="line">[=]     // ä»»ä½•è¢«ä½¿ç”¨åˆ°çš„å¤–éƒ¨å˜é‡éƒ½éšå¼åœ°ä»¥ä¼ å€¼æ–¹å¼åŠ ä»¥å¼•ç”¨ã€‚</span><br><span class="line">[&amp;, x]  // xæ˜¾å¼åœ°ä»¥ä¼ å€¼æ–¹å¼åŠ ä»¥å¼•ç”¨ã€‚å…¶ä½™å˜é‡ä»¥å¼•ç”¨æ–¹å¼åŠ ä»¥å¼•ç”¨ã€‚</span><br><span class="line">[=, &amp;z] // zæ˜¾å¼åœ°ä»¥å¼•ç”¨æ–¹å¼åŠ ä»¥å¼•ç”¨ã€‚å…¶ä½™å˜é‡ä»¥ä¼ å€¼æ–¹å¼åŠ ä»¥å¼•ç”¨ã€‚</span><br></pre></td></tr></table></figure>
<p>å¯¹äº[=]æˆ–[&amp;]çš„å½¢å¼ï¼Œlambda è¡¨è¾¾å¼å¯ä»¥ç›´æ¥ä½¿ç”¨ this æŒ‡é’ˆã€‚ä½†æ˜¯ï¼Œå¯¹äº[]çš„å½¢å¼ï¼Œå¦‚æœè¦ä½¿ç”¨ this æŒ‡é’ˆï¼Œå¿…é¡»æ˜¾å¼ä¼ å…¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[this]() &#123; this-&gt;someFunc(); &#125;();</span><br></pre></td></tr></table></figure>
<h3 id="æ•°å­¦è¿ç®—"><a href="#æ•°å­¦è¿ç®—" class="headerlink" title="æ•°å­¦è¿ç®—"></a>æ•°å­¦è¿ç®—</h3><p>å¼•ç”¨æ•°å­¦å¤´æ–‡ä»¶ \<cmath\></cmath\></p>
<p>sin, cos, tan, log, pow, hypot(ä¸¤æ•°æ€»å’Œå¹³æ–¹æ ¹), fabsï¼ˆç»å¯¹å€¼ï¼‰</p>
<h3 id="éšæœºæ•°"><a href="#éšæœºæ•°" class="headerlink" title="éšæœºæ•°"></a>éšæœºæ•°</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¾ç½®ç§å­</span></span><br><span class="line">srand( (<span class="keyword">unsigned</span>)time( <span class="literal">NULL</span> ) );</span><br><span class="line"></span><br><span class="line">rand();</span><br></pre></td></tr></table></figure>
<h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><h4 id="å£°æ˜æ•°ç»„"><a href="#å£°æ˜æ•°ç»„" class="headerlink" title="å£°æ˜æ•°ç»„"></a>å£°æ˜æ•°ç»„</h4><blockquote>
<p>æ•°ç»„æ˜¯ä¸€ä¸ªå¸¸é‡æŒ‡é’ˆ</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// type arrayName [ arraySize ];</span></span><br><span class="line"><span class="keyword">double</span> balance[<span class="number">10</span>];</span><br></pre></td></tr></table></figure>
<h4 id="åˆå§‹åŒ–æ•°ç»„"><a href="#åˆå§‹åŒ–æ•°ç»„" class="headerlink" title="åˆå§‹åŒ–æ•°ç»„"></a>åˆå§‹åŒ–æ•°ç»„</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> balance[<span class="number">5</span>] = &#123;<span class="number">1000.0</span>, <span class="number">2.0</span>, <span class="number">3.4</span>, <span class="number">17.0</span>, <span class="number">50.0</span>&#125;;</span><br><span class="line"><span class="keyword">double</span> balance[] = &#123;<span class="number">1000.0</span>, <span class="number">2.0</span>, <span class="number">3.4</span>, <span class="number">17.0</span>, <span class="number">50.0</span>&#125;;</span><br><span class="line"></span><br><span class="line">balance[<span class="number">4</span>] = <span class="number">50.0</span>; <span class="comment">//</span></span><br></pre></td></tr></table></figure>
<p>ç›´æ¥åˆå§‹åŒ– char æ•°ç»„æ˜¯ç‰¹æ®Šçš„, <strong>è¿™ç§åˆå§‹åŒ–è¦è®°å¾—å­—ç¬¦æ˜¯ä»¥ä¸€ä¸ª null ç»“å°¾çš„</strong>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">char a1[] = &#123;&apos;C&apos;, &apos;+&apos;, &apos;+&apos;&#125;;          // åˆå§‹åŒ–ï¼Œæ²¡æœ‰ null</span><br><span class="line">char a2[] = &#123;&apos;C&apos;, &apos;+&apos;, &apos;+&apos;, &apos;\0&apos;&#125;;    // åˆå§‹åŒ–ï¼Œæ˜ç¡®æœ‰ null</span><br><span class="line">char a3[] = &quot;C++&quot;;                    // null ç»ˆæ­¢ç¬¦è‡ªåŠ¨æ·»åŠ </span><br><span class="line">const char a4[6] = &quot;runoob&quot;;          // æŠ¥é”™ï¼Œæ²¡æœ‰ null çš„ä½ç½®</span><br></pre></td></tr></table></figure>
<h3 id="æŒ‡é’ˆå˜é‡å£°æ˜"><a href="#æŒ‡é’ˆå˜é‡å£°æ˜" class="headerlink" title="æŒ‡é’ˆå˜é‡å£°æ˜"></a>æŒ‡é’ˆå˜é‡å£°æ˜</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">type *var-name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span>    *ip;    <span class="comment">/* ä¸€ä¸ªæ•´å‹çš„æŒ‡é’ˆ */</span></span><br><span class="line"><span class="keyword">double</span> *dp;    <span class="comment">/* ä¸€ä¸ª double å‹çš„æŒ‡é’ˆ */</span></span><br><span class="line"><span class="keyword">float</span>  *fp;    <span class="comment">/* ä¸€ä¸ªæµ®ç‚¹å‹çš„æŒ‡é’ˆ */</span></span><br><span class="line"><span class="keyword">char</span>   *ch;    <span class="comment">/* ä¸€ä¸ªå­—ç¬¦å‹çš„æŒ‡é’ˆ */</span></span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> var = <span class="number">20</span>;</span><br><span class="line"><span class="comment">// int *ip = &amp;var</span></span><br><span class="line"><span class="keyword">int</span> *ip;</span><br><span class="line">ip = &amp;var;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"var: "</span> &lt;&lt; var &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// 20</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"ip: "</span> &lt;&lt; ip &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// 0x7fff50bbe874</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"*ip: "</span> &lt;&lt; *ip &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// 20</span></span><br></pre></td></tr></table></figure>
<h4 id="NULL-æŒ‡é’ˆ"><a href="#NULL-æŒ‡é’ˆ" class="headerlink" title="NULL æŒ‡é’ˆ"></a>NULL æŒ‡é’ˆ</h4><p>NULL æŒ‡é’ˆæ˜¯ä¸€ä¸ªå®šä¹‰åœ¨æ ‡å‡†åº“ä¸­çš„å€¼ä¸ºé›¶çš„å¸¸é‡ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> *nullP = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">if</span>(!nullP)&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"nullP: "</span> &lt;&lt; nullP &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// 0x0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—"><a href="#æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—" class="headerlink" title="æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—"></a>æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ptr++</span><br></pre></td></tr></table></figure>
<p>å‡è®¾ ptr æ˜¯ä¸€ä¸ªæŒ‡å‘åœ°å€ 1000 çš„æ•´å‹æŒ‡é’ˆï¼Œæ˜¯ä¸€ä¸ª 32 ä½çš„æ•´æ•°(4ä¸ªå­—èŠ‚)ï¼Œ,ptr å°†æŒ‡å‘ä½ç½® 1004ï¼Œå› ä¸º ptr æ¯å¢åŠ ä¸€æ¬¡ï¼Œå®ƒéƒ½å°†æŒ‡å‘ä¸‹ä¸€ä¸ªæ•´æ•°ä½ç½®ï¼Œå³å½“å‰ä½ç½®å¾€åç§» 4 ä¸ªå­—èŠ‚ã€‚</p>
<p>å¦‚æœ ptr æŒ‡å‘ä¸€ä¸ªåœ°å€ä¸º 1000 çš„å­—ç¬¦(1ä¸ªå­—èŠ‚)ï¼Œä¸Šé¢çš„è¿ç®—ä¼šå¯¼è‡´æŒ‡é’ˆæŒ‡å‘ä½ç½® 1001ï¼Œå› ä¸ºä¸‹ä¸€ä¸ªå­—ç¬¦ä½ç½®æ˜¯åœ¨ 1001ã€‚</p>
<p><strong>æ•°ç»„æ˜¯ä¸€ä¸ªå¸¸é‡æŒ‡é’ˆ</strong></p>
<h4 id="ä¼ é€’æŒ‡é’ˆç»™å‡½æ•°"><a href="#ä¼ é€’æŒ‡é’ˆç»™å‡½æ•°" class="headerlink" title="ä¼ é€’æŒ‡é’ˆç»™å‡½æ•°"></a>ä¼ é€’æŒ‡é’ˆç»™å‡½æ•°</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> *pr;</span><br><span class="line"><span class="keyword">int</span> **ppr;</span><br><span class="line">pr = &amp;var;</span><br><span class="line">ppr = &amp;pr;</span><br><span class="line"></span><br><span class="line">funPointer(pr);</span><br><span class="line">funPointer(*ppr);</span><br><span class="line"><span class="keyword">int</span> var = <span class="number">20</span>;</span><br><span class="line">funPointer(&amp;var);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">funPointer</span><span class="params">(<span class="keyword">int</span> *p)</span></span>&#123;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"[funPointer]*p: "</span> &lt;&lt; *p &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä»å‡½æ•°è¿”å›æŒ‡é’ˆ"><a href="#ä»å‡½æ•°è¿”å›æŒ‡é’ˆ" class="headerlink" title="ä»å‡½æ•°è¿”å›æŒ‡é’ˆ"></a>ä»å‡½æ•°è¿”å›æŒ‡é’ˆ</h4><p>C++ ä¸æ”¯æŒåœ¨å‡½æ•°å¤–è¿”å›å±€éƒ¨å˜é‡çš„åœ°å€ï¼Œé™¤éå®šä¹‰å±€éƒ¨å˜é‡ä¸º static å˜é‡ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> var = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> *fp2p = funPointer2(&amp;var);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"*fp2p:"</span> &lt;&lt; *fp2p &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> * <span class="title">funPointer2</span><span class="params">(<span class="keyword">int</span> *p)</span> </span>&#123;</span><br><span class="line">    p++;</span><br><span class="line">    p--;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¼•ç”¨-vs-æŒ‡é’ˆ"><a href="#å¼•ç”¨-vs-æŒ‡é’ˆ" class="headerlink" title="å¼•ç”¨ vs æŒ‡é’ˆ"></a>å¼•ç”¨ vs æŒ‡é’ˆ</h3><p>å¼•ç”¨å¾ˆå®¹æ˜“ä¸æŒ‡é’ˆæ··æ·†ï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä¸‰ä¸ªä¸»è¦çš„ä¸åŒï¼š</p>
<ul>
<li>ä¸å­˜åœ¨ç©ºå¼•ç”¨ã€‚å¼•ç”¨å¿…é¡»è¿æ¥åˆ°ä¸€å—åˆæ³•çš„å†…å­˜ã€‚</li>
<li>ä¸€æ—¦å¼•ç”¨è¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¸èƒ½è¢«æŒ‡å‘åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚æŒ‡é’ˆå¯ä»¥åœ¨ä»»ä½•æ—¶å€™æŒ‡å‘åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚</li>
<li>å¼•ç”¨å¿…é¡»åœ¨åˆ›å»ºæ—¶è¢«åˆå§‹åŒ–ã€‚æŒ‡é’ˆå¯ä»¥åœ¨ä»»ä½•æ—¶é—´è¢«åˆå§‹åŒ–ã€‚</li>
</ul>
<h4 id="åˆ›å»ºå¼•ç”¨"><a href="#åˆ›å»ºå¼•ç”¨" class="headerlink" title="åˆ›å»ºå¼•ç”¨"></a>åˆ›å»ºå¼•ç”¨</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜ç®€å•çš„å˜é‡</span></span><br><span class="line"><span class="keyword">int</span>    i;</span><br><span class="line"><span class="keyword">double</span> d;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜å¼•ç”¨å˜é‡</span></span><br><span class="line"><span class="keyword">int</span>&amp;    r = i; <span class="comment">// r æ˜¯ä¸€ä¸ªåˆå§‹åŒ–ä¸º i çš„æ•´å‹å¼•ç”¨</span></span><br><span class="line"><span class="keyword">double</span>&amp; s = d; <span class="comment">// s æ˜¯ä¸€ä¸ªåˆå§‹åŒ–ä¸º d çš„ double å‹å¼•ç”¨</span></span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™äº›å£°æ˜ä¸­ï¼Œ<strong>&amp;</strong> è¯»ä½œå¼•ç”¨ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> swapA = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> swapB = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">swapWithRef(swapA, swapB);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swapWithRef</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> &amp;b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = a;</span><br><span class="line">    a = b;</span><br><span class="line">    b = temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> swapA = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> swapB = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">swapWithPointer(&amp;swapAP, &amp;swapBP);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swapWithPointer</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> *b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = *a; <span class="comment">// å±€éƒ¨å˜é‡tempçš„å€¼ä¸º[aæŒ‡é’ˆæŒ‡å‘çš„å€¼](1)</span></span><br><span class="line">    *a = *b; <span class="comment">// aæŒ‡é’ˆæŒ‡å‘çš„å€¼æ”¹ä¸º[bæŒ‡é’ˆæŒ‡å‘çš„å€¼](2)</span></span><br><span class="line">    *b = temp; <span class="comment">// bæŒ‡é’ˆæŒ‡å‘çš„å€¼æ”¹ä¸ºtemp(1)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æŠŠå¼•ç”¨ä½œä¸ºè¿”å›å€¼"><a href="#æŠŠå¼•ç”¨ä½œä¸ºè¿”å›å€¼" class="headerlink" title="æŠŠå¼•ç”¨ä½œä¸ºè¿”å›å€¼"></a>æŠŠå¼•ç”¨ä½œä¸ºè¿”å›å€¼</h4><p>å½“å‡½æ•°è¿”å›ä¸€ä¸ªå¼•ç”¨æ—¶ï¼Œåˆ™è¿”å›ä¸€ä¸ªæŒ‡å‘è¿”å›å€¼çš„éšå¼æŒ‡é’ˆã€‚è¿™æ ·ï¼Œå‡½æ•°å°±å¯ä»¥æ”¾åœ¨èµ‹å€¼è¯­å¥çš„å·¦è¾¹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> vals[] = &#123;<span class="number">10.1</span>, <span class="number">12.6</span>, <span class="number">33.1</span>, <span class="number">24.1</span>, <span class="number">50.0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> &amp;<span class="title">setValues</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> vals[i];   <span class="comment">// è¿”å›ç¬¬ i ä¸ªå…ƒç´ çš„å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setValues(<span class="number">1</span>) = <span class="number">20.17</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"vals: "</span> &lt;&lt; vals[<span class="number">1</span>] &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<p>è¿”å›ä¸€ä¸ªå¯¹å±€éƒ¨å˜é‡çš„å¼•ç”¨æ˜¯ä¸åˆæ³•çš„ï¼Œä½†æ˜¯ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªå¯¹é™æ€å˜é‡çš„å¼•ç”¨ã€‚</p>
<h4 id="æ—¥æœŸ-amp-æ—¶é—´"><a href="#æ—¥æœŸ-amp-æ—¶é—´" class="headerlink" title="æ—¥æœŸ &amp; æ—¶é—´"></a>æ—¥æœŸ &amp; æ—¶é—´</h4><p>C/C++ æ ‡å‡†åº“, å¼•ç”¨ \<ctime\> å¤´æ–‡ä»¶</ctime\></p>
<p><code>æœ‰å››ä¸ªä¸æ—¶é—´ç›¸å…³çš„ç±»å‹ï¼šclock_tã€time_tã€size_t å’Œ tm</code></p>
<p>æ„ç±»å‹ tm æŠŠæ—¥æœŸå’Œæ—¶é—´ä»¥ C ç»“æ„çš„å½¢å¼ä¿å­˜</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">tm</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> tm_sec;   <span class="comment">// ç§’ï¼Œæ­£å¸¸èŒƒå›´ä» 0 åˆ° 59ï¼Œä½†å…è®¸è‡³ 61</span></span><br><span class="line">  <span class="keyword">int</span> tm_min;   <span class="comment">// åˆ†ï¼ŒèŒƒå›´ä» 0 åˆ° 59</span></span><br><span class="line">  <span class="keyword">int</span> tm_hour;  <span class="comment">// å°æ—¶ï¼ŒèŒƒå›´ä» 0 åˆ° 23</span></span><br><span class="line">  <span class="keyword">int</span> tm_mday;  <span class="comment">// ä¸€æœˆä¸­çš„ç¬¬å‡ å¤©ï¼ŒèŒƒå›´ä» 1 åˆ° 31</span></span><br><span class="line">  <span class="keyword">int</span> tm_mon;   <span class="comment">// æœˆï¼ŒèŒƒå›´ä» 0 åˆ° 11</span></span><br><span class="line">  <span class="keyword">int</span> tm_year;  <span class="comment">// è‡ª 1900 å¹´èµ·çš„å¹´æ•°</span></span><br><span class="line">  <span class="keyword">int</span> tm_wday;  <span class="comment">// ä¸€å‘¨ä¸­çš„ç¬¬å‡ å¤©ï¼ŒèŒƒå›´ä» 0 åˆ° 6ï¼Œä»æ˜ŸæœŸæ—¥ç®—èµ·</span></span><br><span class="line">  <span class="keyword">int</span> tm_yday;  <span class="comment">// ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©ï¼ŒèŒƒå›´ä» 0 åˆ° 365ï¼Œä» 1 æœˆ 1 æ—¥ç®—èµ·</span></span><br><span class="line">  <span class="keyword">int</span> tm_isdst; <span class="comment">// å¤ä»¤æ—¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">time_t</span> now = time(<span class="number">0</span>); <span class="comment">// åŸºäºå½“å‰ç³»ç»Ÿçš„å½“å‰æ—¥æœŸ/æ—¶é—´</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"now: "</span> &lt;&lt; now &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> *dt = ctime(&amp;now); <span class="comment">// æŠŠ now è½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"æœ¬åœ°æ—¥æœŸå’Œæ—¶é—´ï¼š"</span> &lt;&lt; dt &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠ now è½¬æ¢ä¸º tm ç»“æ„</span></span><br><span class="line">tm *gmtm = gmtime(&amp;now);</span><br><span class="line">dt = asctime(gmtm);</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"UTC æ—¥æœŸå’Œæ—¶é—´ï¼š"</span> &lt;&lt; dt &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">tm *ltm = localtime(&amp;now);</span><br><span class="line"><span class="comment">// è¾“å‡º tm ç»“æ„çš„å„ä¸ªç»„æˆéƒ¨åˆ†</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Year: "</span>&lt;&lt; <span class="number">1900</span> + ltm-&gt;tm_year &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Month: "</span>&lt;&lt; <span class="number">1</span> + ltm-&gt;tm_mon&lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Day: "</span>&lt;&lt;  ltm-&gt;tm_mday &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Time: "</span>&lt;&lt; ltm-&gt;tm_hour &lt;&lt; <span class="string">":"</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ltm-&gt;tm_min &lt;&lt; <span class="string">":"</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ltm-&gt;tm_sec &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<h3 id="æ ‡å‡†è¾“å‡ºæµï¼ˆcoutï¼‰"><a href="#æ ‡å‡†è¾“å‡ºæµï¼ˆcoutï¼‰" class="headerlink" title="æ ‡å‡†è¾“å‡ºæµï¼ˆcoutï¼‰"></a>æ ‡å‡†è¾“å‡ºæµï¼ˆcoutï¼‰</h3><p>é¢„å®šä¹‰çš„å¯¹è±¡ <code>cout</code> æ˜¯ <code>ostream</code> ç±»çš„ä¸€ä¸ªå®ä¾‹, æµæ’å…¥è¿ç®—ç¬¦ <code>&lt;&lt;</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> str[] = <span class="string">"Hello C++"</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Value of str is : "</span> &lt;&lt; str &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<h3 id="æ ‡å‡†è¾“å…¥æµï¼ˆcinï¼‰"><a href="#æ ‡å‡†è¾“å…¥æµï¼ˆcinï¼‰" class="headerlink" title="æ ‡å‡†è¾“å…¥æµï¼ˆcinï¼‰"></a>æ ‡å‡†è¾“å…¥æµï¼ˆcinï¼‰</h3><p>é¢„å®šä¹‰çš„å¯¹è±¡ cin æ˜¯ istream ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚æµæå–è¿ç®—ç¬¦ <code>&gt;&gt;</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> name[<span class="number">50</span>];</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"è¯·è¾“å…¥æ‚¨çš„åç§°ï¼š "</span>;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; name;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"æ‚¨çš„åç§°æ˜¯ï¼š "</span> &lt;&lt; name &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<h3 id="æ ‡å‡†é”™è¯¯æµï¼ˆcerrï¼‰"><a href="#æ ‡å‡†é”™è¯¯æµï¼ˆcerrï¼‰" class="headerlink" title="æ ‡å‡†é”™è¯¯æµï¼ˆcerrï¼‰"></a>æ ‡å‡†é”™è¯¯æµï¼ˆcerrï¼‰</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> str[] = <span class="string">"Fake Error..."</span>;</span><br><span class="line"><span class="built_in">cerr</span> &lt;&lt; <span class="string">"Error message: "</span> &lt;&lt; str &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<h3 id="æ ‡å‡†æ—¥å¿—æµï¼ˆclogï¼‰"><a href="#æ ‡å‡†æ—¥å¿—æµï¼ˆclogï¼‰" class="headerlink" title="æ ‡å‡†æ—¥å¿—æµï¼ˆclogï¼‰"></a>æ ‡å‡†æ—¥å¿—æµï¼ˆclogï¼‰</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> strLog[] = <span class="string">"Fake Log..."</span>;</span><br><span class="line"><span class="built_in">clog</span> &lt;&lt; <span class="string">"Log message: "</span> &lt;&lt; strLog &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<h3 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h3><h4 id="å®šä¹‰ç»“æ„"><a href="#å®šä¹‰ç»“æ„" class="headerlink" title="å®šä¹‰ç»“æ„"></a>å®šä¹‰ç»“æ„</h4><p>ä½¿ç”¨ <strong>struct</strong> è¯­å¥ã€‚struct è¯­å¥å®šä¹‰äº†ä¸€ä¸ªåŒ…å«å¤šä¸ªæˆå‘˜çš„æ–°çš„æ•°æ®ç±»å‹</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">type_name</span> &#123;</span></span><br><span class="line">member_type1 member_name1;</span><br><span class="line">member_type2 member_name2;</span><br><span class="line">member_type3 member_name3;</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">&#125; object_names;</span><br></pre></td></tr></table></figure>
<p>type_name æ˜¯ç»“æ„ä½“ç±»å‹çš„åç§°ï¼Œmember_type1 member_name1 æ˜¯æ ‡å‡†çš„å˜é‡å®šä¹‰ï¼Œæ¯”å¦‚ int i; æˆ–è€… float f; æˆ–è€…å…¶ä»–æœ‰æ•ˆçš„å˜é‡å®šä¹‰ã€‚åœ¨ç»“æ„å®šä¹‰çš„æœ«å°¾ï¼Œæœ€åä¸€ä¸ªåˆ†å·ä¹‹å‰ï¼Œæ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªç»“æ„å˜é‡ï¼Œè¿™æ˜¯å¯é€‰çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Books</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">char</span>  title[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  author[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  subject[<span class="number">100</span>];</span><br><span class="line">   <span class="keyword">int</span>   book_id;</span><br><span class="line">&#125; book;</span><br></pre></td></tr></table></figure>
<h4 id="è®¿é—®ç»“æ„æˆå‘˜"><a href="#è®¿é—®ç»“æ„æˆå‘˜" class="headerlink" title="è®¿é—®ç»“æ„æˆå‘˜"></a>è®¿é—®ç»“æ„æˆå‘˜</h4><p>ä½¿ç”¨æˆå‘˜è®¿é—®è¿ç®—ç¬¦ï¼ˆ<strong>.</strong>ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Book</span>&#123;</span></span><br><span class="line">    <span class="keyword">char</span> title[<span class="number">50</span>];</span><br><span class="line">    <span class="keyword">char</span> author[<span class="number">50</span>];</span><br><span class="line">    <span class="keyword">char</span> subject[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">int</span> book_id;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">Book book1;</span><br><span class="line"><span class="built_in">strcpy</span>(book1.title, <span class="string">"c++"</span>);</span><br><span class="line"><span class="built_in">strcpy</span>(book1.author, <span class="string">"wangjie"</span>);</span><br><span class="line"><span class="built_in">strcpy</span>(book1.subject, <span class="string">"c++ subject"</span>);</span><br><span class="line">book1.book_id = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"book1 title: "</span> &lt;&lt; book1.title &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"book1 author: "</span> &lt;&lt; book1.author &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"book1 subject: "</span> &lt;&lt; book1.subject &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"book1 book_id: "</span> &lt;&lt; book1.book_id &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<h4 id="ç»“æ„ä½œä¸ºå‡½æ•°å‚æ•°"><a href="#ç»“æ„ä½œä¸ºå‡½æ•°å‚æ•°" class="headerlink" title="ç»“æ„ä½œä¸ºå‡½æ•°å‚æ•°"></a>ç»“æ„ä½œä¸ºå‡½æ•°å‚æ•°</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printBook</span><span class="params">(struct Book book)</span></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"[printBook]book title: "</span> &lt;&lt; book.title &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"[printBook]book author: "</span> &lt;&lt; book.author &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"[printBook]book subject: "</span> &lt;&lt; book.subject &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"[printBook]book book_id: "</span> &lt;&lt; book.book_id &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Book book2;</span><br><span class="line"></span><br><span class="line"><span class="built_in">strcpy</span>(book2.title, <span class="string">"java"</span>);</span><br><span class="line"><span class="built_in">strcpy</span>(book2.author, <span class="string">"wangjie"</span>);</span><br><span class="line"><span class="built_in">strcpy</span>(book2.subject, <span class="string">"java subject"</span>);</span><br><span class="line">book2.book_id = <span class="number">200</span>;</span><br><span class="line"></span><br><span class="line">printBook(book2);</span><br></pre></td></tr></table></figure>
<h4 id="æŒ‡å‘ç»“æ„çš„æŒ‡é’ˆ"><a href="#æŒ‡å‘ç»“æ„çš„æŒ‡é’ˆ" class="headerlink" title="æŒ‡å‘ç»“æ„çš„æŒ‡é’ˆ"></a>æŒ‡å‘ç»“æ„çš„æŒ‡é’ˆ</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Book *book1P = &amp;book1;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"book1P-&gt;title: "</span> &lt;&lt; book1P-&gt;title &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"book1P-&gt;author: "</span> &lt;&lt; book1P-&gt;author &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"book1P-&gt;subject: "</span> &lt;&lt; book1P-&gt;subject &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"book1P-&gt;book_id: "</span> &lt;&lt; book1P-&gt;book_id &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<p><strong>ä¸ºäº†ä½¿ç”¨æŒ‡å‘è¯¥ç»“æ„çš„æŒ‡é’ˆè®¿é—®ç»“æ„çš„æˆå‘˜ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨ <code>-&gt;</code> è¿ç®—ç¬¦</strong></p>
<h4 id="typedef-å…³é”®å­—"><a href="#typedef-å…³é”®å­—" class="headerlink" title="typedef å…³é”®å­—"></a>typedef å…³é”®å­—</h4><p>å®šä¹‰ç»“æ„çš„æ–¹å¼ï¼Œå¯ä»¥ä¸ºåˆ›å»ºçš„ç±»å‹å–ä¸€ä¸ªâ€åˆ«åâ€:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">char</span>  title[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  author[<span class="number">50</span>];</span><br><span class="line">   <span class="keyword">char</span>  subject[<span class="number">100</span>];</span><br><span class="line">   <span class="keyword">int</span>   book_id;</span><br><span class="line">&#125;Books;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ä½¿ç”¨ typedef å…³é”®å­—æ¥å®šä¹‰éç»“æ„ç±»å‹:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">int</span> *pint32;</span><br><span class="line">pint32 x, y, z;</span><br></pre></td></tr></table></figure>
<p>x, y å’Œ z éƒ½æ˜¯æŒ‡å‘é•¿æ•´å‹ long int çš„æŒ‡é’ˆã€‚</p>
<h3 id="ç±»å’Œå¯¹è±¡"><a href="#ç±»å’Œå¯¹è±¡" class="headerlink" title="ç±»å’Œå¯¹è±¡"></a>ç±»å’Œå¯¹è±¡</h3><h4 id="åˆ›å»ºç±»"><a href="#åˆ›å»ºç±»" class="headerlink" title="åˆ›å»ºç±»"></a>åˆ›å»ºç±»</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Box</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">double</span> length;</span><br><span class="line">    <span class="keyword">double</span> breadth;</span><br><span class="line">    <span class="keyword">double</span> height;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="æˆå‘˜å‡½æ•°"><a href="#æˆå‘˜å‡½æ•°" class="headerlink" title="æˆå‘˜å‡½æ•°"></a>æˆå‘˜å‡½æ•°</h4><p>èŒƒå›´è§£æè¿ç®—ç¬¦ <strong>::</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Box</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">double</span> length;</span><br><span class="line">    <span class="keyword">double</span> breadth;</span><br><span class="line">    <span class="keyword">double</span> height;</span><br><span class="line">    <span class="comment">// æˆå‘˜å‡½æ•°å®šä¹‰</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getVolume</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆå‘˜å‡½æ•°å£°æ˜</span></span><br><span class="line"><span class="keyword">double</span> Box::getVolume(<span class="keyword">void</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>-&gt;height * <span class="keyword">this</span>-&gt;breadth * <span class="keyword">this</span>-&gt;length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç±»è®¿é—®ä¿®é¥°ç¬¦"><a href="#ç±»è®¿é—®ä¿®é¥°ç¬¦" class="headerlink" title="ç±»è®¿é—®ä¿®é¥°ç¬¦"></a>ç±»è®¿é—®ä¿®é¥°ç¬¦</h3><p><code>public</code>, <code>protected</code>, <code>private</code>(é»˜è®¤)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">  <span class="comment">// public members go here</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">protected</span>:</span><br><span class="line"></span><br><span class="line">  <span class="comment">// protected members go here</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line">  <span class="comment">// private members go here</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><code>public</code>æˆå‘˜åœ¨ç¨‹åºä¸­ç±»çš„å¤–éƒ¨æ˜¯å¯è®¿é—®çš„.</p>
<p><code>private</code>æˆå‘˜å˜é‡æˆ–å‡½æ•°åœ¨ç±»çš„å¤–éƒ¨æ˜¯ä¸å¯è®¿é—®çš„ï¼Œç”šè‡³æ˜¯ä¸å¯æŸ¥çœ‹çš„ã€‚åªæœ‰ç±»å’Œå‹å…ƒå‡½æ•°å¯ä»¥è®¿é—®ç§æœ‰æˆå‘˜ã€‚</p>
<p><code>protected</code>æˆå‘˜å˜é‡æˆ–å‡½æ•°ä¸ç§æœ‰æˆå‘˜ååˆ†ç›¸ä¼¼ï¼Œä½†æœ‰ä¸€ç‚¹ä¸åŒï¼Œä¿æŠ¤æˆå‘˜åœ¨æ´¾ç”Ÿç±»ï¼ˆå³å­ç±»ï¼‰ä¸­æ˜¯å¯è®¿é—®çš„ã€‚</p>
<h3 id="ç±»çš„æ„é€ å‡½æ•°"><a href="#ç±»çš„æ„é€ å‡½æ•°" class="headerlink" title="ç±»çš„æ„é€ å‡½æ•°"></a>ç±»çš„æ„é€ å‡½æ•°</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Box::Box(<span class="keyword">double</span> length, <span class="keyword">double</span> breadth, <span class="keyword">double</span> height)&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;length = length;</span><br><span class="line">    <span class="keyword">this</span>-&gt;breadth = breadth;</span><br><span class="line">    <span class="keyword">this</span>-&gt;height = height;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"box created2..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Box::Box(<span class="keyword">double</span> length, <span class="keyword">double</span> breadth, <span class="keyword">double</span> height) : length(length), breadth(breadth), height(height)&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"box created åˆå§‹åŒ–åˆ—è¡¨..."</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç±»çš„ææ„å‡½æ•°"><a href="#ç±»çš„ææ„å‡½æ•°" class="headerlink" title="ç±»çš„ææ„å‡½æ•°"></a>ç±»çš„ææ„å‡½æ•°</h3><p>ç±»çš„ææ„å‡½æ•°æ˜¯ç±»çš„ä¸€ç§ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼Œå®ƒä¼šåœ¨æ¯æ¬¡åˆ é™¤æ‰€åˆ›å»ºçš„å¯¹è±¡æ—¶æ‰§è¡Œã€‚<br>ææ„å‡½æ•°çš„åç§°ä¸ç±»çš„åç§°æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œåªæ˜¯åœ¨å‰é¢åŠ äº†ä¸ªæ³¢æµªå·ï¼ˆ~ï¼‰ä½œä¸ºå‰ç¼€ï¼Œå®ƒä¸ä¼šè¿”å›ä»»ä½•å€¼ï¼Œä¹Ÿä¸èƒ½å¸¦æœ‰ä»»ä½•å‚æ•°ã€‚ææ„å‡½æ•°æœ‰åŠ©äºåœ¨è·³å‡ºç¨‹åºï¼ˆæ¯”å¦‚å…³é—­æ–‡ä»¶ã€é‡Šæ”¾å†…å­˜ç­‰ï¼‰å‰é‡Šæ”¾èµ„æºã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~Box();</span><br><span class="line"></span><br><span class="line">Box::~Box() &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Object is being deleted"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‹·è´æ„é€ å‡½æ•°"><a href="#æ‹·è´æ„é€ å‡½æ•°" class="headerlink" title="æ‹·è´æ„é€ å‡½æ•°"></a>æ‹·è´æ„é€ å‡½æ•°</h3><p><a href="http://www.runoob.com/cplusplus/cpp-copy-constructor.html" target="_blank" rel="noopener">http://www.runoob.com/cplusplus/cpp-copy-constructor.html</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">classname (<span class="keyword">const</span> classname &amp;obj) &#123;</span><br><span class="line">   <span class="comment">// æ„é€ å‡½æ•°çš„ä¸»ä½“</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Line( <span class="keyword">const</span> Line &amp;obj);      <span class="comment">// æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">Line::Line(<span class="keyword">const</span> Line &amp;obj)&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°å¹¶ä¸ºæŒ‡é’ˆ ptr åˆ†é…å†…å­˜"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    ptr = <span class="keyword">new</span> <span class="keyword">int</span>;</span><br><span class="line">    *ptr = *obj.ptr; <span class="comment">// æ‹·è´å€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å‹å…ƒå‡½æ•°"><a href="#å‹å…ƒå‡½æ•°" class="headerlink" title="å‹å…ƒå‡½æ•°"></a>å‹å…ƒå‡½æ•°</h3><p>ç±»çš„å‹å…ƒå‡½æ•°æ˜¯å®šä¹‰åœ¨ç±»å¤–éƒ¨ï¼Œä½†æœ‰æƒè®¿é—®ç±»çš„æ‰€æœ‰ç§æœ‰ï¼ˆprivateï¼‰æˆå‘˜å’Œä¿æŠ¤ï¼ˆprotectedï¼‰æˆå‘˜ã€‚å°½ç®¡å‹å…ƒå‡½æ•°çš„åŸå‹æœ‰åœ¨ç±»çš„å®šä¹‰ä¸­å‡ºç°è¿‡ï¼Œä½†æ˜¯å‹å…ƒå‡½æ•°å¹¶ä¸æ˜¯æˆå‘˜å‡½æ•°ã€‚<br>å‹å…ƒå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°è¢«ç§°ä¸ºå‹å…ƒå‡½æ•°ï¼›å‹å…ƒä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç±»ï¼Œè¯¥ç±»è¢«ç§°ä¸ºå‹å…ƒç±»ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•´ä¸ªç±»åŠå…¶æ‰€æœ‰æˆå‘˜éƒ½æ˜¯å‹å…ƒã€‚</p>
<p><strong>friend</strong>å…³é”®å­—</p>
<p>å£°æ˜ç±» ClassTwo çš„æ‰€æœ‰æˆå‘˜å‡½æ•°ä½œä¸ºç±» ClassOne çš„å‹å…ƒï¼Œéœ€è¦åœ¨ç±» ClassOne çš„å®šä¹‰ä¸­æ”¾ç½®å¦‚ä¸‹å£°æ˜ï¼š<br><code>friend class ClassTwo;</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Box</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">double</span> width;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">   <span class="keyword">double</span> length;</span><br><span class="line">   <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">printWidth</span><span class="params">( Box box )</span></span>;</span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">setWidth</span><span class="params">( <span class="keyword">double</span> wid )</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯·æ³¨æ„ï¼šprintWidth() ä¸æ˜¯ä»»ä½•ç±»çš„æˆå‘˜å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printWidth</span><span class="params">( Box box )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">/* å› ä¸º printWidth() æ˜¯ Box çš„å‹å…ƒï¼Œå®ƒå¯ä»¥ç›´æ¥è®¿é—®è¯¥ç±»çš„ä»»ä½•æˆå‘˜ */</span></span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"Width of box : "</span> &lt;&lt; box.width &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å†…è”å‡½æ•°"><a href="#å†…è”å‡½æ•°" class="headerlink" title="å†…è”å‡½æ•°"></a>å†…è”å‡½æ•°</h3><p>å†…è”å‡½æ•°æ˜¯é€šå¸¸ä¸ç±»ä¸€èµ·ä½¿ç”¨ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°æ˜¯å†…è”çš„ï¼Œé‚£ä¹ˆåœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæŠŠè¯¥å‡½æ•°çš„ä»£ç å‰¯æœ¬æ”¾ç½®åœ¨æ¯ä¸ªè°ƒç”¨è¯¥å‡½æ•°çš„åœ°æ–¹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Max</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> (x &gt; y)? x : y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Max (20,10): "</span> &lt;&lt; Max(<span class="number">20</span>,<span class="number">10</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Max (0,200): "</span> &lt;&lt; Max(<span class="number">0</span>,<span class="number">200</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Max (100,1010): "</span> &lt;&lt; Max(<span class="number">100</span>,<span class="number">1010</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<h4 id="this-æŒ‡é’ˆ"><a href="#this-æŒ‡é’ˆ" class="headerlink" title="this æŒ‡é’ˆ"></a>this æŒ‡é’ˆ</h4><p>æ¯ä¸€ä¸ªå¯¹è±¡éƒ½èƒ½é€šè¿‡ this æŒ‡é’ˆæ¥è®¿é—®è‡ªå·±çš„åœ°å€ã€‚this æŒ‡é’ˆæ˜¯æ‰€æœ‰æˆå‘˜å‡½æ•°çš„éšå«å‚æ•°ã€‚å› æ­¤ï¼Œåœ¨æˆå‘˜å‡½æ•°å†…éƒ¨ï¼Œå®ƒå¯ä»¥ç”¨æ¥æŒ‡å‘è°ƒç”¨å¯¹è±¡ã€‚</p>
<p>å‹å…ƒå‡½æ•°æ²¡æœ‰ this æŒ‡é’ˆï¼Œå› ä¸ºå‹å…ƒä¸æ˜¯ç±»çš„æˆå‘˜ã€‚åªæœ‰æˆå‘˜å‡½æ•°æ‰æœ‰ this æŒ‡é’ˆã€‚</p>
<h4 id="æŒ‡å‘ç±»çš„æŒ‡é’ˆ"><a href="#æŒ‡å‘ç±»çš„æŒ‡é’ˆ" class="headerlink" title="æŒ‡å‘ç±»çš„æŒ‡é’ˆ"></a>æŒ‡å‘ç±»çš„æŒ‡é’ˆ</h4><p>ä¸€ä¸ªæŒ‡å‘ C++ ç±»çš„æŒ‡é’ˆä¸æŒ‡å‘ç»“æ„çš„æŒ‡é’ˆç±»ä¼¼ï¼Œè®¿é—®æŒ‡å‘ç±»çš„æŒ‡é’ˆçš„æˆå‘˜ï¼Œéœ€è¦ä½¿ç”¨æˆå‘˜è®¿é—®è¿ç®—ç¬¦ -&gt;ï¼Œå°±åƒè®¿é—®æŒ‡å‘ç»“æ„çš„æŒ‡é’ˆä¸€æ ·ã€‚ä¸æ‰€æœ‰çš„æŒ‡é’ˆä¸€æ ·ï¼Œæ‚¨å¿…é¡»åœ¨ä½¿ç”¨æŒ‡é’ˆä¹‹å‰ï¼Œå¯¹æŒ‡é’ˆè¿›è¡Œåˆå§‹åŒ–ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Box *boxBPr = &amp;boxB;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"*boxBPr-&gt;getVolume(): "</span> &lt;&lt; boxBPr-&gt;getVolume() &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<h4 id="ç±»çš„é™æ€æˆå‘˜"><a href="#ç±»çš„é™æ€æˆå‘˜" class="headerlink" title="ç±»çš„é™æ€æˆå‘˜"></a>ç±»çš„é™æ€æˆå‘˜</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> objectCount;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ç±» Box çš„é™æ€æˆå‘˜</span></span><br><span class="line"><span class="keyword">int</span> Box::objectCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"static objects: "</span> &lt;&lt; Box::objectCount &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">static bool staticFunc();</span><br><span class="line"></span><br><span class="line">Box::staticFunc();</span><br></pre></td></tr></table></figure>
<h4 id="åŸºç±»-amp-æ´¾ç”Ÿç±»"><a href="#åŸºç±»-amp-æ´¾ç”Ÿç±»" class="headerlink" title="åŸºç±» &amp; æ´¾ç”Ÿç±»"></a>åŸºç±» &amp; æ´¾ç”Ÿç±»</h4><p>ä¸€ä¸ªç±»å¯ä»¥æ´¾ç”Ÿè‡ªå¤šä¸ªç±»ï¼Œè¿™æ„å‘³ç€ï¼Œå®ƒå¯ä»¥ä»å¤šä¸ªåŸºç±»ç»§æ‰¿æ•°æ®å’Œå‡½æ•°ã€‚å®šä¹‰ä¸€ä¸ªæ´¾ç”Ÿç±»ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç±»æ´¾ç”Ÿåˆ—è¡¨æ¥æŒ‡å®šåŸºç±»ã€‚ç±»æ´¾ç”Ÿåˆ—è¡¨ä»¥ä¸€ä¸ªæˆ–å¤šä¸ªåŸºç±»å‘½åï¼Œå½¢å¼å¦‚ä¸‹ï¼š</p>
<p><code>class derived-class: access-specifier base-class</code></p>
<p><code>access-specifier</code> æ˜¯ <code>public</code>ã€<code>protected</code> æˆ– <code>private</code> å…¶ä¸­çš„ä¸€ä¸ªï¼Œé»˜è®¤ä¸º <code>private</code>ï¼Œ<code>base-class</code> æ˜¯ä¹‹å‰å®šä¹‰è¿‡çš„æŸä¸ªç±»çš„åç§°ã€‚</p>
<p>ä¸€ä¸ªæ´¾ç”Ÿç±»ç»§æ‰¿äº†æ‰€æœ‰çš„åŸºç±»æ–¹æ³•ï¼Œä½†ä¸‹åˆ—æƒ…å†µé™¤å¤–ï¼š</p>
<ul>
<li>åŸºç±»çš„æ„é€ å‡½æ•°ã€ææ„å‡½æ•°å’Œæ‹·è´æ„é€ å‡½æ•°ã€‚</li>
<li>åŸºç±»çš„é‡è½½è¿ç®—ç¬¦ã€‚</li>
<li>åŸºç±»çš„å‹å…ƒå‡½æ•°ã€‚</li>
</ul>
<h4 id="ç»§æ‰¿ç±»å‹"><a href="#ç»§æ‰¿ç±»å‹" class="headerlink" title="ç»§æ‰¿ç±»å‹"></a>ç»§æ‰¿ç±»å‹</h4><p>æˆ‘ä»¬å‡ ä¹ä¸ä½¿ç”¨ protected æˆ– private ç»§æ‰¿ï¼Œé€šå¸¸ä½¿ç”¨ public ç»§æ‰¿ã€‚å½“ä½¿ç”¨ä¸åŒç±»å‹çš„ç»§æ‰¿æ—¶ï¼Œéµå¾ªä»¥ä¸‹å‡ ä¸ªè§„åˆ™ï¼š</p>
<ul>
<li>å…¬æœ‰ç»§æ‰¿ï¼ˆ<strong>public</strong>ï¼‰ï¼šå½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ª<strong>å…¬æœ‰</strong>åŸºç±»æ—¶ï¼ŒåŸºç±»çš„<strong>å…¬æœ‰</strong>æˆå‘˜ä¹Ÿæ˜¯æ´¾ç”Ÿç±»çš„<strong>å…¬æœ‰</strong>æˆå‘˜ï¼ŒåŸºç±»çš„<strong>ä¿æŠ¤</strong>æˆå‘˜ä¹Ÿæ˜¯æ´¾ç”Ÿç±»çš„<strong>ä¿æŠ¤</strong>æˆå‘˜ï¼ŒåŸºç±»çš„<strong>ç§æœ‰</strong>æˆå‘˜ä¸èƒ½ç›´æ¥è¢«æ´¾ç”Ÿç±»è®¿é—®ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è°ƒç”¨åŸºç±»çš„<strong>å…¬æœ‰</strong>å’Œ<strong>ä¿æŠ¤</strong>æˆå‘˜æ¥è®¿é—®ã€‚</li>
<li>ä¿æŠ¤ç»§æ‰¿ï¼ˆ<strong>protected</strong>ï¼‰ï¼š å½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ª<strong>ä¿æŠ¤</strong>åŸºç±»æ—¶ï¼ŒåŸºç±»çš„<strong>å…¬æœ‰</strong>å’Œ<strong>ä¿æŠ¤</strong>æˆå‘˜å°†æˆä¸ºæ´¾ç”Ÿç±»çš„<strong>ä¿æŠ¤</strong>æˆå‘˜ã€‚</li>
<li>ç§æœ‰ç»§æ‰¿ï¼ˆ<strong>private</strong>ï¼‰ï¼šå½“ä¸€ä¸ªç±»æ´¾ç”Ÿè‡ª<strong>ç§æœ‰</strong>åŸºç±»æ—¶ï¼ŒåŸºç±»çš„<strong>å…¬æœ‰</strong>å’Œ<strong>ä¿æŠ¤</strong>æˆå‘˜å°†æˆä¸ºæ´¾ç”Ÿç±»çš„<strong>ç§æœ‰</strong>æˆå‘˜ã€‚</li>
</ul>
<h4 id="å¤šç»§æ‰¿"><a href="#å¤šç»§æ‰¿" class="headerlink" title="å¤šç»§æ‰¿"></a>å¤šç»§æ‰¿</h4><p>å¤šç»§æ‰¿å³ä¸€ä¸ªå­ç±»å¯ä»¥æœ‰å¤šä¸ªçˆ¶ç±»ï¼Œå®ƒç»§æ‰¿äº†å¤šä¸ªçˆ¶ç±»çš„ç‰¹æ€§ã€‚<br>è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> &lt;æ´¾ç”Ÿç±»å&gt;:</span>&lt;ç»§æ‰¿æ–¹å¼<span class="number">1</span>&gt;&lt;åŸºç±»å<span class="number">1</span>&gt;,&lt;ç»§æ‰¿æ–¹å¼<span class="number">2</span>&gt;&lt;åŸºç±»å<span class="number">2</span>&gt;,â€¦</span><br><span class="line">&#123;</span><br><span class="line">&lt;æ´¾ç”Ÿç±»ç±»ä½“&gt;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span>:</span> <span class="keyword">public</span> Shape, <span class="keyword">public</span> PaintCost&#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‡½æ•°é‡è½½"><a href="#å‡½æ•°é‡è½½" class="headerlink" title="å‡½æ•°é‡è½½"></a>å‡½æ•°é‡è½½</h4><p>å½“æ‚¨è°ƒç”¨ä¸€ä¸ªé‡è½½å‡½æ•°æˆ–é‡è½½è¿ç®—ç¬¦æ—¶ï¼Œç¼–è¯‘å™¨é€šè¿‡æŠŠæ‚¨æ‰€ä½¿ç”¨çš„å‚æ•°ç±»å‹ä¸å®šä¹‰ä¸­çš„å‚æ•°ç±»å‹è¿›è¡Œæ¯”è¾ƒï¼Œå†³å®šé€‰ç”¨æœ€åˆé€‚çš„å®šä¹‰ã€‚é€‰æ‹©æœ€åˆé€‚çš„é‡è½½å‡½æ•°æˆ–é‡è½½è¿ç®—ç¬¦çš„è¿‡ç¨‹ï¼Œç§°ä¸ºé‡è½½å†³ç­–ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> Rectangle::print(<span class="keyword">int</span> intValue) &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"int value: "</span> &lt;&lt; intValue &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> Rectangle::print(<span class="keyword">int</span> *intValue) &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"*int value: "</span> &lt;&lt; *intValue &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> Rectangle::print(<span class="keyword">double</span> doubleValue) &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"double value: "</span> &lt;&lt; doubleValue &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> Rectangle::print(<span class="keyword">const</span> <span class="keyword">char</span> *c) &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"char values: "</span> &lt;&lt; c &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rect.print(<span class="number">3</span>);</span><br><span class="line">rect.print(<span class="number">3.3</span>);</span><br><span class="line"><span class="keyword">int</span> intValue = <span class="number">300</span>;</span><br><span class="line">rect.print(&amp;intValue);</span><br><span class="line">rect.print(<span class="string">"hello print string."</span>);</span><br></pre></td></tr></table></figure>
<h4 id="è¿ç®—ç¬¦é‡è½½"><a href="#è¿ç®—ç¬¦é‡è½½" class="headerlink" title="è¿ç®—ç¬¦é‡è½½"></a>è¿ç®—ç¬¦é‡è½½</h4><p>å¯ä»¥é‡å®šä¹‰æˆ–é‡è½½å¤§éƒ¨åˆ† C++ å†…ç½®çš„è¿ç®—ç¬¦ã€‚è¿™æ ·ï¼Œæ‚¨å°±èƒ½ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹çš„è¿ç®—ç¬¦ã€‚</p>
<p>é‡è½½çš„è¿ç®—ç¬¦æ˜¯å¸¦æœ‰ç‰¹æ®Šåç§°çš„å‡½æ•°ï¼Œå‡½æ•°åæ˜¯ç”±å…³é”®å­— operator å’Œå…¶åè¦é‡è½½çš„è¿ç®—ç¬¦ç¬¦å·æ„æˆçš„ã€‚ä¸å…¶ä»–å‡½æ•°ä¸€æ ·ï¼Œé‡è½½è¿ç®—ç¬¦æœ‰ä¸€ä¸ªè¿”å›ç±»å‹å’Œä¸€ä¸ªå‚æ•°åˆ—è¡¨ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Box <span class="keyword">operator</span>+(<span class="keyword">const</span> Box&amp;);</span><br></pre></td></tr></table></figure>
<p>å£°æ˜åŠ æ³•è¿ç®—ç¬¦ç”¨äºæŠŠä¸¤ä¸ª Box å¯¹è±¡ç›¸åŠ ï¼Œè¿”å›æœ€ç»ˆçš„ Box å¯¹è±¡ã€‚</p>
<p>å¤§å¤šæ•°çš„é‡è½½è¿ç®—ç¬¦å¯è¢«å®šä¹‰ä¸ºæ™®é€šçš„éæˆå‘˜å‡½æ•°æˆ–è€…è¢«å®šä¹‰ä¸ºç±»æˆå‘˜å‡½æ•°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Box <span class="keyword">operator</span>+(<span class="keyword">const</span> Box&amp;, <span class="keyword">const</span> Box&amp;);</span><br><span class="line"></span><br><span class="line">Box Box::<span class="keyword">operator</span>+(Box &amp;b) &#123;</span><br><span class="line">    Box resultBox;</span><br><span class="line">    resultBox.width = <span class="keyword">this</span>-&gt;width + b.width;</span><br><span class="line">    resultBox.height = <span class="keyword">this</span>-&gt;height + b.height;</span><br><span class="line">    resultBox.breadth = <span class="keyword">this</span>-&gt;breadth + b.breadth;</span><br><span class="line">    resultBox.length = <span class="keyword">this</span>-&gt;length + b.length;</span><br><span class="line">    <span class="keyword">return</span> resultBox;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="å¯é‡è½½è¿ç®—ç¬¦"><a href="#å¯é‡è½½è¿ç®—ç¬¦" class="headerlink" title="å¯é‡è½½è¿ç®—ç¬¦"></a>å¯é‡è½½è¿ç®—ç¬¦</h5><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>-</td>
<td>*</td>
<td>/</td>
<td>%</td>
<td>^</td>
</tr>
<tr>
<td>&amp;</td>
<td>\</td>
<td></td>
<td>~</td>
<td>!</td>
<td>,</td>
<td>=</td>
</tr>
<tr>
<td>&lt;</td>
<td>&gt;</td>
<td>&lt;=</td>
<td>&gt;=</td>
<td>++</td>
<td>â€“</td>
</tr>
<tr>
<td>&lt;&lt;</td>
<td>&gt;&gt;</td>
<td>==</td>
<td>!=</td>
<td>&amp;&amp;</td>
<td>\</td>
<td>\</td>
<td></td>
</tr>
<tr>
<td>+=</td>
<td>-=</td>
<td>/=</td>
<td>%=</td>
<td>^=</td>
<td>&amp;=</td>
</tr>
<tr>
<td>\</td>
<td></td>
<td>=</td>
<td>*=</td>
<td>&lt;&lt;=</td>
<td>&gt;&gt;=</td>
<td>[]</td>
<td>()</td>
</tr>
<tr>
<td>-&gt;</td>
<td>-&gt;*</td>
<td>new</td>
<td>new []</td>
<td>delete</td>
<td>delete []</td>
</tr>
</tbody>
</table>
<h5 id="ä¸å¯é‡è½½è¿ç®—ç¬¦"><a href="#ä¸å¯é‡è½½è¿ç®—ç¬¦" class="headerlink" title="ä¸å¯é‡è½½è¿ç®—ç¬¦"></a>ä¸å¯é‡è½½è¿ç®—ç¬¦</h5><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>::</td>
<td>.*</td>
<td>.</td>
<td>?:</td>
</tr>
</tbody>
</table>
<p>è¿ç®—ç¬¦é‡è½½å®ä¾‹: <a href="http://www.runoob.com/cplusplus/cpp-overloading.html" target="_blank" rel="noopener">http://www.runoob.com/cplusplus/cpp-overloading.html</a></p>
<h4 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in Shape class</span></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getArea</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in Rectangle class</span></span><br><span class="line"><span class="keyword">int</span> Rectangle::getArea() &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Rectangle::getArea()"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> width * height;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in Triangle class</span></span><br><span class="line"><span class="keyword">int</span> Triangle::getArea() &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Triangle::getArea()"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> width * height;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Shape *shapePtr;</span><br><span class="line">shapePtr = &amp;rect;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"&amp;rect pointer-&gt;getArea(): "</span> &lt;&lt; shapePtr-&gt;getArea() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="function">Triangle <span class="title">triangle</span><span class="params">(<span class="number">3</span>, <span class="number">4</span>)</span></span>;</span><br><span class="line">shapePtr = &amp;triangle;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"&amp;triangle pointer-&gt;getArea(): "</span> &lt;&lt; shapePtr-&gt;getArea() &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// out put</span><br><span class="line">&amp;rect pointer-&gt;getArea(): Rectangle::getArea()</span><br><span class="line">&amp;triangle pointer-&gt;getArea(): Triangle::getArea()</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨å‡½æ•° area() è¢«ç¼–è¯‘å™¨è®¾ç½®ä¸ºåŸºç±»ä¸­çš„ç‰ˆæœ¬ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„<strong>é™æ€å¤šæ€</strong>ï¼Œæˆ–<strong>é™æ€é“¾æ¥</strong> - å‡½æ•°è°ƒç”¨åœ¨ç¨‹åºæ‰§è¡Œå‰å°±å‡†å¤‡å¥½äº†ã€‚æœ‰æ—¶å€™è¿™ä¹Ÿè¢«ç§°ä¸º<strong>æ—©ç»‘å®š</strong>ï¼Œå› ä¸º area() å‡½æ•°åœ¨ç¨‹åºç¼–è¯‘æœŸé—´å°±å·²ç»è®¾ç½®å¥½äº†ã€‚</p>
<p>æ”¾ç½®å…³é”®å­—<strong>virtual</strong>åï¼Œç¼–è¯‘å™¨çœ‹çš„æ˜¯æŒ‡é’ˆçš„å†…å®¹ï¼Œè€Œä¸æ˜¯å®ƒçš„ç±»å‹ã€‚</p>
<h4 id="è™šå‡½æ•°"><a href="#è™šå‡½æ•°" class="headerlink" title="è™šå‡½æ•°"></a>è™šå‡½æ•°</h4><p><strong>è™šå‡½æ•°</strong> æ˜¯åœ¨åŸºç±»ä¸­ä½¿ç”¨å…³é”®å­— virtual å£°æ˜çš„å‡½æ•°ã€‚åœ¨æ´¾ç”Ÿç±»ä¸­é‡æ–°å®šä¹‰åŸºç±»ä¸­å®šä¹‰çš„è™šå‡½æ•°æ—¶ï¼Œä¼šå‘Šè¯‰ç¼–è¯‘å™¨ä¸è¦é™æ€é“¾æ¥åˆ°è¯¥å‡½æ•°ã€‚</p>
<p>æˆ‘ä»¬æƒ³è¦çš„æ˜¯åœ¨ç¨‹åºä¸­ä»»æ„ç‚¹å¯ä»¥æ ¹æ®æ‰€è°ƒç”¨çš„å¯¹è±¡ç±»å‹æ¥é€‰æ‹©è°ƒç”¨çš„å‡½æ•°ï¼Œè¿™ç§æ“ä½œè¢«ç§°ä¸º<strong>åŠ¨æ€é“¾æ¥</strong>ï¼Œæˆ–<strong>åæœŸç»‘å®š</strong>ã€‚</p>
<h4 id="çº¯è™šå‡½æ•°"><a href="#çº¯è™šå‡½æ•°" class="headerlink" title="çº¯è™šå‡½æ•°"></a>çº¯è™šå‡½æ•°</h4><p>æ‚¨å¯èƒ½æƒ³è¦åœ¨åŸºç±»ä¸­å®šä¹‰è™šå‡½æ•°ï¼Œä»¥ä¾¿åœ¨æ´¾ç”Ÿç±»ä¸­é‡æ–°å®šä¹‰è¯¥å‡½æ•°æ›´å¥½åœ°é€‚ç”¨äºå¯¹è±¡ï¼Œä½†æ˜¯æ‚¨åœ¨åŸºç±»ä¸­åˆä¸èƒ½å¯¹è™šå‡½æ•°ç»™å‡ºæœ‰æ„ä¹‰çš„å®ç°ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šç”¨åˆ°çº¯è™šå‡½æ•°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pure virtual function</span></span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">area</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<p><strong>= 0</strong> å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œå‡½æ•°æ²¡æœ‰ä¸»ä½“ï¼Œä¸Šé¢çš„è™šå‡½æ•°æ˜¯çº¯è™šå‡½æ•°ã€‚</p>
<h4 id="æ–‡ä»¶å’Œæµ"><a href="#æ–‡ä»¶å’Œæµ" class="headerlink" title="æ–‡ä»¶å’Œæµ"></a>æ–‡ä»¶å’Œæµ</h4><table>
<thead>
<tr>
<th>æ•°æ®ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>ofstream</td>
<td>è¯¥æ•°æ®ç±»å‹è¡¨ç¤ºè¾“å‡ºæ–‡ä»¶æµï¼Œç”¨äºåˆ›å»ºæ–‡ä»¶å¹¶å‘æ–‡ä»¶å†™å…¥ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td>ifstream</td>
<td>è¯¥æ•°æ®ç±»å‹è¡¨ç¤ºè¾“å…¥æ–‡ä»¶æµï¼Œç”¨äºä»æ–‡ä»¶è¯»å–ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td>fstream</td>
<td>è¯¥æ•°æ®ç±»å‹é€šå¸¸è¡¨ç¤ºæ–‡ä»¶æµï¼Œä¸”åŒæ—¶å…·æœ‰ ofstream å’Œ ifstream ä¸¤ç§åŠŸèƒ½ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥åˆ›å»ºæ–‡ä»¶ï¼Œå‘æ–‡ä»¶å†™å…¥ä¿¡æ¯ï¼Œä»æ–‡ä»¶è¯»å–ä¿¡æ¯ã€‚</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>æ¨¡å¼æ ‡å¿—</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>ios::app</td>
<td>è¿½åŠ æ¨¡å¼ã€‚æ‰€æœ‰å†™å…¥éƒ½è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ã€‚</td>
</tr>
<tr>
<td>ios::ate</td>
<td>æ–‡ä»¶æ‰“å¼€åå®šä½åˆ°æ–‡ä»¶æœ«å°¾ã€‚</td>
</tr>
<tr>
<td>ios::in</td>
<td>æ‰“å¼€æ–‡ä»¶ç”¨äºè¯»å–ã€‚</td>
</tr>
<tr>
<td>ios::out</td>
<td>æ‰“å¼€æ–‡ä»¶ç”¨äºå†™å…¥ã€‚</td>
</tr>
<tr>
<td>ios::trunc</td>
<td>å¦‚æœè¯¥æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œå…¶å†…å®¹å°†åœ¨æ‰“å¼€æ–‡ä»¶ä¹‹å‰è¢«æˆªæ–­ï¼Œå³æŠŠæ–‡ä»¶é•¿åº¦è®¾ä¸º 0ã€‚</td>
</tr>
</tbody>
</table>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *filePath = <span class="string">"/Users/wangjie/work/cpp/HelloCpp/com.wangjie.cpptest/file_temp"</span>;</span><br><span class="line">ofstream outfile;</span><br><span class="line">outfile.open(filePath, ios::trunc);</span><br><span class="line">outfile &lt;&lt; <span class="string">"temp"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">outfile.close();</span><br><span class="line"></span><br><span class="line">ifstream infile;</span><br><span class="line">infile.open(filePath);</span><br><span class="line"><span class="keyword">char</span> data[<span class="number">100</span>];</span><br><span class="line">infile &gt;&gt; data;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; data &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">infile.close();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä½åˆ° fileObject çš„ç¬¬ n ä¸ªå­—èŠ‚ï¼ˆå‡è®¾æ˜¯ ios::begï¼‰</span></span><br><span class="line">fileObject.seekg( n );</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠæ–‡ä»¶çš„è¯»æŒ‡é’ˆä» fileObject å½“å‰ä½ç½®å‘åç§» n ä¸ªå­—èŠ‚</span></span><br><span class="line">fileObject.seekg( n, ios::cur );</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠæ–‡ä»¶çš„è¯»æŒ‡é’ˆä» fileObject æœ«å°¾å¾€å›ç§» n ä¸ªå­—èŠ‚</span></span><br><span class="line">fileObject.seekg( n, ios::end );</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä½åˆ° fileObject çš„æœ«å°¾</span></span><br><span class="line">fileObject.seekg( <span class="number">0</span>, ios::end );</span><br></pre></td></tr></table></figure>
<h4 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h4><p>æŠ›å‡ºå¼‚å¸¸:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">division</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">if</span>( b == <span class="number">0</span> )</span><br><span class="line">   &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="string">"Division by zero condition!"</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> (a/b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>C++ æä¾›äº†ä¸€ç³»åˆ—æ ‡å‡†çš„å¼‚å¸¸ï¼Œå®šä¹‰åœ¨ <exception> ä¸­ã€‚</exception></p>
<p>å®šä¹‰æ–°çš„å¼‚å¸¸ï¼š</p>
<table>
<thead>
<tr>
<th>å¼‚å¸¸</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>std::exception</td>
<td>è¯¥å¼‚å¸¸æ˜¯æ‰€æœ‰æ ‡å‡† C++ å¼‚å¸¸çš„çˆ¶ç±»ã€‚</td>
</tr>
<tr>
<td>std::bad_alloc</td>
<td>è¯¥å¼‚å¸¸å¯ä»¥é€šè¿‡ new æŠ›å‡ºã€‚</td>
</tr>
<tr>
<td>std::bad_cast</td>
<td>è¯¥å¼‚å¸¸å¯ä»¥é€šè¿‡ dynamic_cast æŠ›å‡ºã€‚</td>
</tr>
<tr>
<td>std::bad_exception</td>
<td>è¿™åœ¨å¤„ç† C++ ç¨‹åºä¸­æ— æ³•é¢„æœŸçš„å¼‚å¸¸æ—¶éå¸¸æœ‰ç”¨ã€‚</td>
</tr>
<tr>
<td>std::bad_typeid</td>
<td>è¯¥å¼‚å¸¸å¯ä»¥é€šè¿‡ typeid æŠ›å‡ºã€‚</td>
</tr>
<tr>
<td>std::logic_error</td>
<td>ç†è®ºä¸Šå¯ä»¥é€šè¿‡è¯»å–ä»£ç æ¥æ£€æµ‹åˆ°çš„å¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td>std::domain_error</td>
<td>å½“ä½¿ç”¨äº†ä¸€ä¸ªæ— æ•ˆçš„æ•°å­¦åŸŸæ—¶ï¼Œä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td>std::invalid_argument</td>
<td>å½“ä½¿ç”¨äº†æ— æ•ˆçš„å‚æ•°æ—¶ï¼Œä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td>std::length_error</td>
<td>å½“åˆ›å»ºäº†å¤ªé•¿çš„ std::string æ—¶ï¼Œä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td>std::out_of_range</td>
<td>è¯¥å¼‚å¸¸å¯ä»¥é€šè¿‡æ–¹æ³•æŠ›å‡ºï¼Œä¾‹å¦‚ std::vector å’Œ std::bitset&lt;&gt;::operator[]()ã€‚</td>
</tr>
<tr>
<td>std::runtime_error</td>
<td>ç†è®ºä¸Šä¸å¯ä»¥é€šè¿‡è¯»å–ä»£ç æ¥æ£€æµ‹åˆ°çš„å¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td>std::overflow_error</td>
<td>å½“å‘ç”Ÿæ•°å­¦ä¸Šæº¢æ—¶ï¼Œä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td>std::range_error</td>
<td>å½“å°è¯•å­˜å‚¨è¶…å‡ºèŒƒå›´çš„å€¼æ—¶ï¼Œä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td>std::underflow_error</td>
<td>å½“å‘ç”Ÿæ•°å­¦ä¸‹æº¢æ—¶ï¼Œä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ã€‚</td>
</tr>
</tbody>
</table>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;exception&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MyException</span> :</span> <span class="keyword">public</span> exception</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">const</span> <span class="keyword">char</span> * <span class="title">what</span> <span class="params">()</span> <span class="keyword">const</span> <span class="title">throw</span> <span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"C++ Exception"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">try</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">throw</span> MyException();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span>(MyException&amp; e)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"MyException caught"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; e.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span>(<span class="built_in">std</span>::exception&amp; e)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//å…¶ä»–çš„é”™è¯¯</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åŠ¨æ€å†…å­˜"><a href="#åŠ¨æ€å†…å­˜" class="headerlink" title="åŠ¨æ€å†…å­˜"></a>åŠ¨æ€å†…å­˜</h4><p>å†…å­˜åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>æ ˆï¼šåœ¨å‡½æ•°å†…éƒ¨å£°æ˜çš„æ‰€æœ‰å˜é‡éƒ½å°†å ç”¨æ ˆå†…å­˜ã€‚</li>
<li>å †ï¼šè¿™æ˜¯ç¨‹åºä¸­æœªä½¿ç”¨çš„å†…å­˜ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶å¯ç”¨äºåŠ¨æ€åˆ†é…å†…å­˜ã€‚</li>
</ul>
<p>å¾ˆå¤šæ—¶å€™ï¼Œæ‚¨æ— æ³•æå‰é¢„çŸ¥éœ€è¦å¤šå°‘å†…å­˜æ¥å­˜å‚¨æŸä¸ªå®šä¹‰å˜é‡ä¸­çš„ç‰¹å®šä¿¡æ¯ï¼Œæ‰€éœ€å†…å­˜çš„å¤§å°éœ€è¦åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šã€‚<br>åœ¨ C++ ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„è¿ç®—ç¬¦ä¸ºç»™å®šç±»å‹çš„å˜é‡åœ¨è¿è¡Œæ—¶åˆ†é…å †å†…çš„å†…å­˜ï¼Œè¿™ä¼šè¿”å›æ‰€åˆ†é…çš„ç©ºé—´åœ°å€ã€‚è¿™ç§è¿ç®—ç¬¦å³ <strong>new</strong> è¿ç®—ç¬¦ã€‚</p>
<p>å¦‚æœæ‚¨ä¸éœ€è¦åŠ¨æ€åˆ†é…å†…å­˜ï¼Œå¯ä»¥ä½¿ç”¨ <strong>delete</strong> è¿ç®—ç¬¦ï¼Œåˆ é™¤ä¹‹å‰ç”± new è¿ç®—ç¬¦åˆ†é…çš„å†…å­˜ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span>* pvalue  = <span class="literal">NULL</span>; <span class="comment">// åˆå§‹åŒ–ä¸º null çš„æŒ‡é’ˆ</span></span><br><span class="line">pvalue  = <span class="keyword">new</span> <span class="keyword">double</span>;   <span class="comment">// ä¸ºå˜é‡è¯·æ±‚å†…å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span>* pvalue  = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">if</span>( !(pvalue  = <span class="keyword">new</span> <span class="keyword">double</span> ))</span><br><span class="line">&#123;</span><br><span class="line">   <span class="built_in">cout</span> &lt;&lt; <span class="string">"Error: out of memory."</span> &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// new ä¸ malloc() å‡½æ•°ç›¸æ¯”ï¼Œå…¶ä¸»è¦çš„ä¼˜ç‚¹æ˜¯ï¼Œnew ä¸åªæ˜¯åˆ†é…äº†å†…å­˜ï¼Œå®ƒè¿˜åˆ›å»ºäº†å¯¹è±¡ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> pvalue; <span class="comment">// é‡Šæ”¾ pvalue æ‰€æŒ‡å‘çš„å†…å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span>* pvalue  = <span class="literal">NULL</span>;   <span class="comment">// åˆå§‹åŒ–ä¸º null çš„æŒ‡é’ˆ</span></span><br><span class="line">pvalue  = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">20</span>]; <span class="comment">// ä¸ºå˜é‡è¯·æ±‚å†…å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> [] pvalue;        <span class="comment">// åˆ é™¤ pvalue æ‰€æŒ‡å‘çš„æ•°ç»„</span></span><br></pre></td></tr></table></figure>
<h4 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h4><p>å®šä¹‰å‘½åç©ºé—´:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> namespace_name &#123;</span><br><span class="line">   <span class="comment">// ä»£ç å£°æ˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> first_space &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"Inside first_space"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> second_space &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"Inside second_space"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">first_space::func();</span><br><span class="line">second_space::func();</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ä½¿ç”¨ using namespace æŒ‡ä»¤ï¼Œè¿™æ ·åœ¨ä½¿ç”¨å‘½åç©ºé—´æ—¶å°±å¯ä»¥ä¸ç”¨åœ¨å‰é¢åŠ ä¸Šå‘½åç©ºé—´çš„åç§°ã€‚</p>
<p>using æŒ‡ä»¤ä¹Ÿå¯ä»¥ç”¨æ¥æŒ‡å®šå‘½åç©ºé—´ä¸­çš„ç‰¹å®šé¡¹ç›®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨åªæ‰“ç®—ä½¿ç”¨ std å‘½åç©ºé—´ä¸­çš„ cout éƒ¨åˆ†ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„è¯­å¥ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br></pre></td></tr></table></figure>
<h4 id="ä¸è¿ç»­çš„å‘½åç©ºé—´"><a href="#ä¸è¿ç»­çš„å‘½åç©ºé—´" class="headerlink" title="ä¸è¿ç»­çš„å‘½åç©ºé—´"></a>ä¸è¿ç»­çš„å‘½åç©ºé—´</h4><p>å‘½åç©ºé—´å¯ä»¥å®šä¹‰åœ¨å‡ ä¸ªä¸åŒçš„éƒ¨åˆ†ä¸­ï¼Œå› æ­¤å‘½åç©ºé—´æ˜¯ç”±å‡ ä¸ªå•ç‹¬å®šä¹‰çš„éƒ¨åˆ†ç»„æˆçš„ã€‚ä¸€ä¸ªå‘½åç©ºé—´çš„å„ä¸ªç»„æˆéƒ¨åˆ†å¯ä»¥åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ã€‚</p>
<p>ä¸‹é¢çš„å‘½åç©ºé—´å®šä¹‰å¯ä»¥æ˜¯å®šä¹‰ä¸€ä¸ªæ–°çš„å‘½åç©ºé—´ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸ºå·²æœ‰çš„å‘½åç©ºé—´å¢åŠ æ–°çš„å…ƒç´ ï¼š<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> namespace_name &#123;</span><br><span class="line">   <span class="comment">// ä»£ç å£°æ˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="å‡½æ•°æ¨¡æ¿"><a href="#å‡½æ•°æ¨¡æ¿" class="headerlink" title="å‡½æ•°æ¨¡æ¿"></a>å‡½æ•°æ¨¡æ¿</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> T <span class="keyword">const</span>&amp; <span class="title">maxTemplate</span><span class="params">(T <span class="keyword">const</span>&amp; a, T <span class="keyword">const</span>&amp; b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &lt; b ? b : a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"maxTemplate(1, 2): "</span> &lt;&lt; maxTemplate(<span class="number">1</span>, <span class="number">2</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"maxTemplate(1.0, 2.0): "</span> &lt;&lt; maxTemplate(<span class="number">1.0</span>, <span class="number">2.0</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"maxTemplate(\"a\", \"b\"): "</span> &lt;&lt; maxTemplate(<span class="string">"a"</span>, <span class="string">"b"</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<h4 id="ç±»æ¨¡æ¿"><a href="#ç±»æ¨¡æ¿" class="headerlink" title="ç±»æ¨¡æ¿"></a>ç±»æ¨¡æ¿</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">type</span>&gt; <span class="title">class</span> <span class="title">class</span>-<span class="title">name</span> &#123;</span></span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="é¢„å¤„ç†å™¨"><a href="#é¢„å¤„ç†å™¨" class="headerlink" title="é¢„å¤„ç†å™¨"></a>é¢„å¤„ç†å™¨</h4><p>é¢„å¤„ç†å™¨æ˜¯ä¸€äº›æŒ‡ä»¤ï¼ŒæŒ‡ç¤ºç¼–è¯‘å™¨åœ¨å®é™…ç¼–è¯‘ä¹‹å‰æ‰€éœ€å®Œæˆçš„é¢„å¤„ç†ã€‚<br>æ‰€æœ‰çš„é¢„å¤„ç†å™¨æŒ‡ä»¤éƒ½æ˜¯ä»¥äº•å·ï¼ˆ#ï¼‰å¼€å¤´ï¼Œåªæœ‰ç©ºæ ¼å­—ç¬¦å¯ä»¥å‡ºç°åœ¨é¢„å¤„ç†æŒ‡ä»¤ä¹‹å‰ã€‚é¢„å¤„ç†æŒ‡ä»¤ä¸æ˜¯ C++ è¯­å¥ï¼Œæ‰€ä»¥å®ƒä»¬ä¸ä¼šä»¥åˆ†å·ï¼ˆ;ï¼‰ç»“å°¾ã€‚<br>æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œä¹‹å‰æ‰€æœ‰çš„å®ä¾‹ä¸­éƒ½æœ‰ #include æŒ‡ä»¤ã€‚è¿™ä¸ªå®ç”¨äºæŠŠå¤´æ–‡ä»¶åŒ…å«åˆ°æºæ–‡ä»¶ä¸­ã€‚</p>
<p>C++ è¿˜æ”¯æŒå¾ˆå¤šé¢„å¤„ç†æŒ‡ä»¤ï¼Œæ¯”å¦‚ #includeã€#defineã€#ifã€#elseã€#line ç­‰ï¼Œè®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹è¿™äº›é‡è¦æŒ‡ä»¤ã€‚</p>
<h5 id="define-é¢„å¤„ç†"><a href="#define-é¢„å¤„ç†" class="headerlink" title="#define é¢„å¤„ç†"></a>#define é¢„å¤„ç†</h5><p>#define é¢„å¤„ç†æŒ‡ä»¤ç”¨äºåˆ›å»ºç¬¦å·å¸¸é‡ã€‚è¯¥ç¬¦å·å¸¸é‡é€šå¸¸ç§°ä¸ºå®ï¼ŒæŒ‡ä»¤çš„ä¸€èˆ¬å½¢å¼æ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define macro-name replacement-text</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PI 3.14159</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Value of PI :"</span> &lt;&lt; PI &lt;&lt; <span class="built_in">endl</span>; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‡½æ•°å®ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MIN(a, b) (a &lt; b ? a : b)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"#MIN(1, 2): "</span> &lt;&lt; MIN(<span class="number">1</span>, <span class="number">2</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<p>æ¡ä»¶ç¼–è¯‘: <a href="http://www.runoob.com/cplusplus/cpp-preprocessor.html" target="_blank" rel="noopener">http://www.runoob.com/cplusplus/cpp-preprocessor.html</a></p>
<h3 id="ä¿¡å·å¤„ç†"><a href="#ä¿¡å·å¤„ç†" class="headerlink" title="ä¿¡å·å¤„ç†"></a>ä¿¡å·å¤„ç†</h3><p>ä¿¡å·æ˜¯ç”±æ“ä½œç³»ç»Ÿä¼ ç»™è¿›ç¨‹çš„ä¸­æ–­ï¼Œä¼šææ—©ç»ˆæ­¢ä¸€ä¸ªç¨‹åºã€‚åœ¨ UNIXã€LINUXã€Mac OS X æˆ– Windows ç³»ç»Ÿä¸Šï¼Œå¯ä»¥é€šè¿‡æŒ‰ Ctrl+C äº§ç”Ÿä¸­æ–­ã€‚</p>
<p>æœ‰äº›ä¿¡å·ä¸èƒ½è¢«ç¨‹åºæ•è·ï¼Œä½†æ˜¯ä¸‹è¡¨æ‰€åˆ—ä¿¡å·å¯ä»¥åœ¨ç¨‹åºä¸­æ•è·ï¼Œå¹¶å¯ä»¥åŸºäºä¿¡å·é‡‡å–é€‚å½“çš„åŠ¨ä½œã€‚è¿™äº›ä¿¡å·æ˜¯å®šä¹‰åœ¨ C++ å¤´æ–‡ä»¶ <csignal> ä¸­ã€‚</csignal></p>
<table>
<thead>
<tr>
<th>ä¿¡å·</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>SIGABRT</td>
<td>ç¨‹åºçš„å¼‚å¸¸ç»ˆæ­¢ï¼Œå¦‚è°ƒç”¨ abortã€‚</td>
</tr>
<tr>
<td>SIGFPE</td>
<td>é”™è¯¯çš„ç®—æœ¯è¿ç®—ï¼Œæ¯”å¦‚é™¤ä»¥é›¶æˆ–å¯¼è‡´æº¢å‡ºçš„æ“ä½œã€‚</td>
</tr>
<tr>
<td>SIGILL</td>
<td>æ£€æµ‹éæ³•æŒ‡ä»¤ã€‚</td>
</tr>
<tr>
<td>SIGINT</td>
<td>æ¥æ”¶åˆ°äº¤äº’æ³¨æ„ä¿¡å·ã€‚</td>
</tr>
<tr>
<td>SIGSEGV</td>
<td>éæ³•è®¿é—®å†…å­˜ã€‚</td>
</tr>
<tr>
<td>SIGTERM</td>
<td>å‘é€åˆ°ç¨‹åºçš„ç»ˆæ­¢è¯·æ±‚ã€‚</td>
</tr>
</tbody>
</table>
<h4 id="signal-å‡½æ•°"><a href="#signal-å‡½æ•°" class="headerlink" title="signal() å‡½æ•°"></a>signal() å‡½æ•°</h4><p>ç”¨æ¥æ•è·çªå‘äº‹ä»¶ã€‚ä»¥ä¸‹æ˜¯ signal() å‡½æ•°çš„è¯­æ³•ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> (*signal (<span class="keyword">int</span> sig, <span class="keyword">void</span> (*func)(<span class="keyword">int</span>)))(<span class="keyword">int</span>);</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä»£è¡¨äº†ä¿¡å·çš„ç¼–å·ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæŒ‡å‘ä¿¡å·å¤„ç†å‡½æ•°çš„æŒ‡é’ˆã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">signalHandler</span><span class="params">( <span class="keyword">int</span> signum )</span></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Interrupt signal ("</span> &lt;&lt; signum &lt;&lt; <span class="string">") received.\n"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸…ç†å¹¶å…³é—­</span></span><br><span class="line">    <span class="comment">// ç»ˆæ­¢ç¨‹åº  </span></span><br><span class="line"></span><br><span class="line">   <span class="built_in">exit</span>(signum);  </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// æ³¨å†Œä¿¡å· SIGINT å’Œä¿¡å·å¤„ç†ç¨‹åº</span></span><br><span class="line">    signal(SIGINT, signalHandler);  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">       <span class="built_in">cout</span> &lt;&lt; <span class="string">"Going to sleep...."</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">       sleep(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Going to sleep....</span><br><span class="line">Going to sleep....</span><br><span class="line">Going to sleep....</span><br><span class="line">[æŒ‰ Ctrl+C æ¥ä¸­æ–­ç¨‹åº]</span><br><span class="line">Interrupt signal (2) received.</span><br></pre></td></tr></table></figure>
<h4 id="raise-å‡½æ•°"><a href="#raise-å‡½æ•°" class="headerlink" title="raise() å‡½æ•°"></a>raise() å‡½æ•°</h4><p>å¯ä»¥ä½¿ç”¨å‡½æ•° raise() ç”Ÿæˆä¿¡å·ï¼Œè¯¥å‡½æ•°å¸¦æœ‰ä¸€ä¸ªæ•´æ•°ä¿¡å·ç¼–å·ä½œä¸ºå‚æ•°ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">raise</span> <span class="params">(signal sig)</span></span>;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œï¼Œsig æ˜¯è¦å‘é€çš„ä¿¡å·çš„ç¼–å·ï¼Œè¿™äº›ä¿¡å·åŒ…æ‹¬ï¼šSIGINTã€SIGABRTã€SIGFPEã€SIGILLã€SIGSEGVã€SIGTERMã€SIGHUPã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬ä½¿ç”¨ raise() å‡½æ•°å†…éƒ¨ç”Ÿæˆä¿¡å·çš„å®ä¾‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">signalHandler</span><span class="params">( <span class="keyword">int</span> signum )</span></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Interrupt signal ("</span> &lt;&lt; signum &lt;&lt; <span class="string">") received.\n"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸…ç†å¹¶å…³é—­</span></span><br><span class="line">    <span class="comment">// ç»ˆæ­¢ç¨‹åº </span></span><br><span class="line"></span><br><span class="line">   <span class="built_in">exit</span>(signum);  </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// æ³¨å†Œä¿¡å· SIGINT å’Œä¿¡å·å¤„ç†ç¨‹åº</span></span><br><span class="line">    signal(SIGINT, signalHandler);  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(++i)&#123;</span><br><span class="line">       <span class="built_in">cout</span> &lt;&lt; <span class="string">"Going to sleep...."</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">       <span class="keyword">if</span>( i == <span class="number">3</span> )&#123;</span><br><span class="line">          raise( SIGINT);</span><br><span class="line">       &#125;</span><br><span class="line">       sleep(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Going to sleep....</span><br><span class="line">Going to sleep....</span><br><span class="line">Going to sleep....</span><br><span class="line">Interrupt signal (2) received.</span><br></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> cpp </tag>
            
            <tag> c++ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆå››ï¼šSeizeRecyclerViewï¼‰]]></title>
      <url>/2017/03/29/Android-%E4%BD%BF%E7%94%A8RecyclerView%E6%9B%BF%E4%BB%A3ListView%EF%BC%88%E5%9B%9B%EF%BC%9ASeizeRecyclerView%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="Android-ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆå››ï¼šSeizeRecyclerViewï¼‰"><a href="#Android-ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆå››ï¼šSeizeRecyclerViewï¼‰" class="headerlink" title="[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆå››ï¼šSeizeRecyclerViewï¼‰"></a>[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆå››ï¼šSeizeRecyclerViewï¼‰</h1><p>åœ¨RecyclerViewçš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›çª˜å¢ƒï¼Œæ¯”å¦‚ï¼Œä¸‹å›¾æ˜¯ä»Šæ—¥å¤´æ¡çš„è§†é¢‘è¯¦æƒ…é¡µé¢ï¼š</p>
<a id="more"></a>
<p><img src="http://images2015.cnblogs.com/blog/378300/201703/378300-20170329202135217-815673664.png" alt=""> <img src="http://images2015.cnblogs.com/blog/378300/201703/378300-20170329202140514-614081911.png" alt=""></p>
<p>é™¤å»æ’­æ”¾å™¨å¤–ï¼Œå…¶å®ƒç»„ä»¶åº”è¯¥æ˜¯ä¸€ä¸ªRecyclerViewï¼Œä½†æ˜¯è¿™ä¸ªRecyclerViewä¸­çš„itemæœ‰ä¸¤ç§ç±»å‹ï¼š</p>
<ul>
<li><p>ä¸€ç§æ˜¯ä¸Šéƒ¨çš„æ¨èè§†é¢‘</p>
</li>
<li><p>ä¸€ç§æ˜¯ä¸‹é¢çš„è¯„è®º</p>
</li>
</ul>
<p>é—®é¢˜åœ¨äºä¸¤ç±»æ•°æ®çš„æœ€ä¸‹é¢éƒ½æœ‰ä¸€ä¸ªç»„ä»¶ç”¨äºè¿›è¡Œæ›´å¤šæ•°æ®çš„åŠ è½½ï¼ŒåŠ è½½å®Œæ¯•åæ’å…¥å¯¹åº”çš„positionã€‚</p>
<p>è¿™é‡Œå®ç°çš„æ–¹å¼åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿæ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li><p>æ‰€æœ‰æ•°æ®æ”¾åœ¨ä¸€ä¸ªListä¸­ï¼Œä¿å­˜åŠ è½½æ›´å¤šçš„indexï¼Œç‚¹å‡»åŠ è½½æ›´å¤šçš„indexçš„æ—¶å€™è§¦å‘è¯·æ±‚è¿”å›åæŠŠæ¨èæ›´å¤šæ•°æ®æ’å…¥å¯¹åº”çš„indexä¸­å¹¶æ›´æ–°indexï¼Œè¯„è®ºä¹Ÿæ˜¯ä¸€æ ·ã€‚ã€‚</p>
</li>
<li><p>æ¨èè§†é¢‘å’Œè¯„è®ºä¿å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„Listä¸­ï¼Œåœ¨Adapterä¸­ç»´æŠ¤ä¸¤ä»½æ•°æ®ï¼Œé‡å†™<code>getItemCount()</code>ç­‰æ–¹æ³•ã€‚</p>
</li>
<li><p>â€¦</p>
</li>
</ul>
<p>ä½†æ˜¯è¿™äº›æ–¹æ³•åœ¨ä»¥åä¸šåŠ¡çš„æ‰©å±•å’Œçµæ´»æ€§ç­‰æ–¹é¢éƒ½ä¸å€¼å¾—æå€¡ã€‚å› ä¸ºå°±ç®—æ˜¯ä»¥åçš„ä¸šåŠ¡åªæ˜¯æƒ³æŠŠæ¨èè§†é¢‘å’Œè¯„è®ºä¸¤å¤§å—äº’æ¢ä½ç½®ï¼ˆè™½ç„¶è¿™ä¸ªä¸šåŠ¡åœºæ™¯å¯èƒ½æ€§ä¸å¤§ï¼‰éƒ½æ˜¯ä¸€ä¸ªä¸å°çš„å·¥ä½œé‡ã€‚</p>
<p>åŸå› åœ¨äºï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸€ä¸ª<code>RecyclerView</code>åªä¼šæœ‰ä¸€ä¸ª<code>Adapter</code>æ¥è¿›è¡Œæ•°æ®çš„é€‚é…ï¼Œè¿™æ ·çš„è¯ï¼Œå¦‚æœæ•°æ®åˆ†æˆäº†å‡ ä¸ªå—ï¼ˆæ¨èè§†é¢‘å’Œè¯„è®ºï¼‰ï¼Œå•ä¸ª<code>Adapter</code>çš„æ§åˆ¶èƒ½åŠ›å°±å¾ˆæœ‰é™äº†ã€‚</p>
<p>è®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ª<code>RecyclerView</code>å¯ä»¥æœ‰å¾ˆå¤šä¸ª<code>Adapter</code>æ¥è¿›è¡Œæ•°æ®çš„é€‚é…çš„è¯ï¼Œé‚£é—®é¢˜æ˜¯ä¸æ˜¯è¿åˆƒè€Œè§£äº†ï¼Ÿ</p>
<p><code>RecyclerView</code>ä¸­æœ‰<code>RecommendAdapter</code>å’Œ<code>CommentAdapter</code>ï¼Œ<code>RecommendAdapter</code>ä¸­ç»´æŠ¤ä¸€ä¸ª<code>List&lt;Recommend&gt;</code>æ•°æ®é›†ï¼Œ<code>CommentAdapter</code>ä¸­ç»´æŠ¤äº†ä¸€ä¸ª<code>List&lt;Comment&gt;</code>æ•°æ®é›†ï¼Œæ¯ä¸ª<code>Adapter</code>ä¸­å¯ä»¥è®¾ç½®<code>Header</code>å’Œ<code>Footer</code>ï¼ŒæŠŠåŠ è½½æ›´å¤šçš„ç»„ä»¶ä½œä¸ºä¸€ä¸ª<code>Footer</code>åŠ åœ¨<code>RecommendAdapter</code>å’Œ<code>CommentAdapter</code>ä¸­ï¼Œç„¶åå“åº”ç‚¹å‡»äº‹ä»¶ï¼Œè¯·æ±‚åˆ°æ•°æ®ä¹‹å<code>recommendAdapter.addList(List&lt;Recommend&gt;)</code>åŠ å…¥åˆ°æ¨èè§†é¢‘çš„æ•°æ®é›†ä¸­ï¼Œç„¶å<code>recommendAdapter.notifyDataSetChanged()</code>ï¼Œè¯„è®ºçš„æ•°æ®åŠ è½½ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<p>äºæ˜¯æ ¹æ®è¿™ä¸ªæ€æƒ³ï¼Œ<strong><a href="https://github.com/wangjiegulu/SeizeRecyclerView" target="_blank" rel="noopener">SeizeRecyclerView</a></strong> ç¼–å†™å®Œæˆï¼Œä¸‹é¢ä»¥ç”µå½±è¯¦æƒ…ä¸ºä¾‹ï¼Œç•Œé¢ä¸ä¸Šé¢çš„è§†é¢‘è¯¦æƒ…ä¸€æ ·ï¼Œæ•´ä¸ª<code>RecyclreView</code>è¢«åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š<strong>æ¼”å‘˜åŒºåŸŸ(Actor)</strong>å’Œ<strong>è¯„è®ºåŒºåŸŸ(Comment)</strong>ã€‚</p>
<p>ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<p>å¼•å…¥ <strong><a href="https://github.com/wangjiegulu/SeizeRecyclerView" target="_blank" rel="noopener">SeizeRecyclerView</a> åº“ï¼š<a href="https://github.com/wangjiegulu/SeizeRecyclerView" target="_blank" rel="noopener">https://github.com/wangjiegulu/SeizeRecyclerView</a></strong>ï¼Œåç»­ä¼šä¸Šä¼ åˆ°Mavenä¸­å¿ƒåº“</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">feedRv = (RecyclerView) findViewById(R.id.activity_main_rv);</span><br><span class="line"></span><br><span class="line"><span class="comment">// RecyclerViewçœŸæ­£çš„Adapter</span></span><br><span class="line">adapter = <span class="keyword">new</span> FeedAdapter();</span><br><span class="line"><span class="comment">// ä¸ºçœŸæ­£çš„Adapterå¢åŠ Headerå’ŒFooter</span></span><br><span class="line">adapter.setHeader(headerView = inflaterHeaderOrFooterAndBindClick(R.layout.header_film));</span><br><span class="line">adapter.setFooter(footerView = inflaterHeaderOrFooterAndBindClick(R.layout.footer_film));</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ºçœŸæ­£çš„Adapterç»‘å®šå„ç§seizeAdapterï¼Œè¿™é‡Œçš„é¡ºåºå†³å®šäº†UIä¸Šæ˜¾ç¤ºçš„é¡ºåº</span></span><br><span class="line">adapter.setSeizeAdapters(</span><br><span class="line">        filmActorSeizeAdapter = <span class="keyword">new</span> FilmActorSeizeAdapter(),</span><br><span class="line">        filmCommentSeizeAdapter = <span class="keyword">new</span> FilmCommentSeizeAdapter()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ¼”å‘˜seize adapterçš„ header å’Œ footer</span></span><br><span class="line">filmActorSeizeAdapter.setHeader(actorHeaderView = inflaterHeaderOrFooterAndBindClick(R.layout.header_film_actor));</span><br><span class="line">filmActorSeizeAdapter.setFooter(actorFooterView = inflaterHeaderOrFooterAndBindClick(R.layout.footer_film_actor));</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®è¯„è®ºseize adapterçš„ header å’Œ footer</span></span><br><span class="line">filmCommentSeizeAdapter.setHeader(commentHeaderView = inflaterHeaderOrFooterAndBindClick(R.layout.header_film_comment));</span><br><span class="line">filmCommentSeizeAdapter.setFooter(commentFooterView = inflaterHeaderOrFooterAndBindClick(R.layout.footer_film_comment));</span><br><span class="line"></span><br><span class="line">LinearLayoutManager layoutManager = <span class="keyword">new</span> LinearLayoutManager(<span class="keyword">this</span>);</span><br><span class="line">layoutManager.setOrientation(LinearLayoutManager.VERTICAL);</span><br><span class="line">feedRv.setLayoutManager(layoutManager);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ºRecyclerViewè®¾ç½®çœŸæ­£çš„adapter</span></span><br><span class="line">feedRv.setAdapter(adapter);</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šæ˜¯RecylerViewçš„åˆå§‹åŒ–ï¼Œå¹¶ä¸º<code>Adapter</code>æ·»åŠ ä¸¤ä¸ª<code>SeizeAdapter</code>ï¼ˆ<code>FilmActorSeizeAdapter</code>å’Œ<code>FilmCommentSeizeAdapter</code>ï¼‰ã€‚</p>
<p>è¯·æ±‚å®Œæ•°æ®ä¹‹åç›´æ¥ä½¿ç”¨<code>SeizeAdapter</code>è¿›è¡Œæ•°æ®çš„å¡«å……å’Œ<code>notifyDataSetChanged</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRequestActors</span><span class="params">(List&lt;ActorVM&gt; list)</span> </span>&#123;</span><br><span class="line">    filmActorSeizeAdapter.addList(list);</span><br><span class="line">    filmActorSeizeAdapter.notifyDataSetChanged();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRequestComment</span><span class="params">(List&lt;CommentVM&gt; list)</span> </span>&#123;</span><br><span class="line">    filmCommentSeizeAdapter.addList(list);</span><br><span class="line">    filmCommentSeizeAdapter.notifyDataSetChanged();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åç»­ä¼šå¢åŠ  <a href="https://github.com/wangjiegulu/SeizeRecyclerView" target="_blank" rel="noopener">SeizeRecyclerView</a> è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜ã€‚</p>
<p>æœ€åæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://github.com/wangjiegulu/SeizeRecyclerView/raw/master/screenshot/basic.gif" alt=""> <img src="https://github.com/wangjiegulu/SeizeRecyclerView/raw/master/screenshot/multi_type.gif" alt=""></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> RecyclerView </tag>
            
            <tag> ListView </tag>
            
            <tag> best practices </tag>
            
            <tag> SeizeRecyclerView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Lottieç®€ä»‹ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2017/02/04/Lottie%E7%AE%80%E4%BB%8B%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="Lottieç®€ä»‹ï¼ˆç¿»è¯‘ï¼‰"><a href="#Lottieç®€ä»‹ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Lottieç®€ä»‹ï¼ˆç¿»è¯‘ï¼‰"></a>Lottieç®€ä»‹ï¼ˆç¿»è¯‘ï¼‰</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://medium.com/airbnb-engineering/introducing-lottie-4ff4a0afac0e#.mfnxbtt06" target="_blank" rel="noopener">https://medium.com/airbnb-engineering/introducing-lottie-4ff4a0afac0e#.mfnxbtt06</a></p>
<p>æ–°çš„å‘æœ¬åœ°appsçš„æ„å»ºåŠ¨ç”»çš„å¼€æºå·¥å…·ã€‚</p>
</blockquote>
<p>ä½œè€…ï¼š<a href="http://github.com/buba447" target="_blank" rel="noopener">Brandon Withrow</a>, <a href="https://twitter.com/gpeal8" target="_blank" rel="noopener">Gabridl Peal</a>, <a href="https://twitter.com/intelligibabble" target="_blank" rel="noopener">Leland Richardson</a> å’Œ <a href="https://twitter.com/therealsalih?lang=en" target="_blank" rel="noopener">Salih AbdulKarim</a></p>
<p>åœ¨ä»¥å‰ï¼Œåœ¨Androidï¼ŒiOSå’ŒReact Native appä¸Šé¢æ„å»ºå¤æ‚çš„åŠ¨ç”»æ˜¯å›°éš¾å’Œå†—é•¿çš„è¿‡ç¨‹ã€‚ä½ è¦ä¹ˆä¸å¾—ä¸ä¸ºæ¯ä¸ªå°ºå¯¸å¢åŠ å¤§é‡çš„å›¾ç‰‡æ–‡ä»¶ï¼Œè¦ä¹ˆå¹²è„†ç¼–å†™æ•°åƒè¡Œä¸å¯ç»´æŠ¤çš„ä»£ç ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œå¤§å¤šçš„appså¹¶æ²¡æœ‰ä½¿ç”¨åŠ¨ç”»â€”â€”å°½ç®¡è¿™æ˜¯ä¸€ä¸ªäº¤æµæƒ³æ³•å’Œåˆ›å»ºå¼•äººæ³¨ç›®çš„ç”¨æˆ·ä½“éªŒçš„å¼ºå¤§çš„å·¥å…·ã€‚ä¸€å¹´å‰ï¼Œæˆ‘ä»¬å°±å¼€å§‹æ”¹å˜ã€‚</p>
<a id="more"></a>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å¾ˆé«˜å…´æ¥ä»‹ç»æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆã€‚<a href="http://airbnb.design/lottie/" target="_blank" rel="noopener">Lottie</a>æ˜¯ä¸€ä¸ªiOSï¼ŒAndroidå’ŒReact Nativeåº“ï¼Œå¯ä»¥å®æ—¶æ¸²æŸ“After EffectsåŠ¨ç”»ï¼Œå¹¶ä¸”å…è®¸æœ¬åœ°appåƒé™æ€èµ„æºé‚£æ ·è½»æ¾åœ°ä½¿ç”¨åŠ¨ç”»ã€‚Lottieä½¿ç”¨åä¸º<a href="https://github.com/bodymovin/bodymovin" target="_blank" rel="noopener">Bodymovin</a>çš„å¼€æºAfter Effectsçš„æ‰©å±•ç¨‹åºå¯¼å‡ºçš„JSONæ–‡ä»¶æ ¼å¼çš„åŠ¨ç”»æ•°æ®ã€‚æ‰©å±•ç¨‹åºä¸JavaScript playeræ†ç»‘åœ¨ä¸€èµ·ï¼Œå¯ä»¥åœ¨webä¸Šæ¸²æŸ“åŠ¨ç”»ã€‚è‡ªä»2015å¹´2æœˆå¼€å§‹ï¼ŒBodymovinçš„åˆ›å»ºè€…ï¼Œ<a href="https://twitter.com/airnanan" target="_blank" rel="noopener">Hernan Torrisi</a>é€šè¿‡æ¯æœˆä¸ºæ’ä»¶æ·»åŠ å’Œæ”¹è¿›åŠŸèƒ½ï¼Œæ‰“é€ äº†åšå®çš„åŸºç¡€ã€‚æˆ‘ä»¬çš„å›¢é˜Ÿï¼ˆ<a href="http://github.com/buba447" target="_blank" rel="noopener">Brandon Withrow</a> åœ¨ <a href="https://github.com/airbnb/lottie-ios" target="_blank" rel="noopener">iOS</a>, <a href="https://twitter.com/gpeal8" target="_blank" rel="noopener">Gabriel Peal</a> åœ¨ <a href="https://github.com/airbnb/lottie-android" target="_blank" rel="noopener">Android</a>ï¼Œ<a href="https://twitter.com/intelligibabble" target="_blank" rel="noopener">Leland Richardson</a> åœ¨ <a href="https://github.com/airbnb/lottie-react-native" target="_blank" rel="noopener">React Native</a>ï¼Œå’Œ <a href="http://www.salih.tv/" target="_blank" rel="noopener">æˆ‘</a> åœ¨ä½“éªŒè®¾è®¡ä¸Šï¼‰åœ¨Torrisiçš„éå‡¡çš„å·¥ä½œä¹‹ä¸Šå¼€å§‹æˆ‘ä»¬çš„æ—…ç¨‹ã€‚</p>
<p><img src="https://github.com/airbnb/lottie-android/raw/master/gifs/Example1.gif" alt=""></p>
<h2 id="è½»æ¾åœ°æ„å»ºä¸€ä¸ªä¸°å¯Œçš„åŠ¨ç”»"><a href="#è½»æ¾åœ°æ„å»ºä¸€ä¸ªä¸°å¯Œçš„åŠ¨ç”»" class="headerlink" title="è½»æ¾åœ°æ„å»ºä¸€ä¸ªä¸°å¯Œçš„åŠ¨ç”»"></a>è½»æ¾åœ°æ„å»ºä¸€ä¸ªä¸°å¯Œçš„åŠ¨ç”»</h2><p>Lottieå…è®¸å·¥ç¨‹å¸ˆæ„å»ºä¸€ä¸ªä¸°å¯Œçš„åŠ¨ç”»ï¼Œè€Œæ²¡æœ‰è‰°è‹¦åœ°é‡å†™å®ƒä»¬çš„å¼€é”€ã€‚Nick Butcherâ€™sçš„<a href="https://medium.com/google-developers/animation-jump-through-861f4f5b3de4#.xlw1n2u2d" target="_blank" rel="noopener">è·³è·ƒ</a>åŠ¨ç”»,Bartek Lipinskiçš„<a href="https://android.jlelse.eu/animatedvectordrawablecompat-3d9568727c53#.fmiujhcdj" target="_blank" rel="noopener">æ±‰å ¡èœå•</a>, å’ŒMiroslaw Stanek çš„<a href="http://frogermcs.github.io/twitters-like-animation-in-android-alternative/" target="_blank" rel="noopener">Twitterçˆ±å¿ƒ</a>, æ¼”ç¤ºå®ƒä»¬æ˜¯å¤šä¹ˆå›°éš¾å’Œè€—æ—¶ï¼Œå®ƒå¯ä»¥ç”¨scratché‡å»ºåŠ¨ç”»ã€‚ä½¿ç”¨Lottieï¼ŒæŒ–æ˜å‚è€ƒæ¡†æ¶ï¼ŒçŒœæµ‹æŒç»­æ—¶é—´ï¼Œæ‰‹åŠ¨åˆ›å»ºè´èµ›å°”æ›²çº¿ï¼Œå¹¶é‡æ–°åˆ¶ä½œåªæœ‰ä¸€ä¸ªGIFä½œä¸ºå‚è€ƒçš„åŠ¨ç”»å°†æ˜¯è¿‡å»äº†ã€‚ç°åœ¨å·¥ç¨‹å¸ˆå¯ä»¥å‡†ç¡®åœ°å®ç°è®¾è®¡è€…çš„æ„å›¾ï¼Œç©¶ç«Ÿæ˜¯æ€ä¹ˆåšçš„ã€‚ä¸ºäº†è¯æ˜å®ƒï¼Œæˆ‘ä»¬é‡åˆ›å»ºäº†å®ƒä»¬çš„åŠ¨ç”»ï¼Œç„¶ååœ¨æˆ‘ä»¬çš„æ¯ä¸ªä¾‹å­ä¸­æä¾›äº†After Effectså’ŒJSONæ–‡ä»¶ã€‚</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°½å¯èƒ½å¤šåœ°æ”¯æŒAfter Effectsçš„ç‰¹æ€§ï¼Œè€Œä¸åªæ˜¯ç®€å•çš„å›¾æ ‡åŠ¨ç”»ã€‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€äº›å…¶ä»–ä¾‹å­æ¥å±•ç¤ºåº“çš„çµæ´»æ€§ï¼Œä¸°å¯Œæ€§å’Œæ·±å…¥çš„åŠŸèƒ½é›†ã€‚åœ¨ä¾‹å­appä¸­ï¼Œæœ‰ç”¨äºå„ç§ä¸åŒç§ç±»çš„åŠ¨ç”»çš„æºæ–‡ä»¶ï¼ŒåŒ…æ‹¬åŸºæœ¬çº¿æ¡è‰ºæœ¯ï¼ŒåŸºäºå­—ç¬¦çš„åŠ¨ç”»ï¼Œä»¥åŠå…·æœ‰å¤šä¸ªè§’åº¦å’Œåˆ‡å‰²çš„åŠ¨æ€logoåŠ¨ç”»ã€‚</p>
<p><img src="https://github.com/airbnb/lottie-android/raw/master/gifs/Example2.gif" alt=""></p>
<p>æˆ‘ä»¬å·²ç»å¼€å§‹åœ¨ä¸€äº›ç•Œé¢ä¸Šä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„LottieåŠ¨ç”»ï¼ŒåŒ…æ‹¬åº”ç”¨å†…é€šçŸ¥ï¼Œå…¨å¸§åŠ¨ç”»æ’å›¾å’Œåœ¨æˆ‘ä»¬çš„å®¡æŸ¥æµç¨‹ä¸­ã€‚æˆ‘ä»¬è®¡åˆ’ä»¥ä¸€ç§æœ‰è¶£è€Œæœ‰ç”¨çš„æ–¹å¼å¤§å¤§å¢åŠ æˆ‘ä»¬å¯¹åŠ¨ç”»çš„ä½¿ç”¨ã€‚</p>
<p><img src="https://github.com/airbnb/lottie-android/raw/master/gifs/Example3.gif" alt=""></p>
<h2 id="çµæ´»é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆ"><a href="#çµæ´»é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="çµæ´»é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆ"></a>çµæ´»é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆ</h2><p>Airbnbæ˜¯ä¸€ä¸ªå…¨çƒçš„å…¬å¸ï¼Œå®ƒæ”¯æŒæ•°ç™¾ä¸‡çš„é¡¾å®¢å’Œä¸»äººï¼Œæ‰€æœ‰åœ¨å¤šä¸ªå¹³å°ä¸Šæ’­æ”¾çš„çµæ´»åŠ¨ç”»æ ¼å¼å¯¹æˆ‘ä»¬æ¥è¯´æ˜¯éå¸¸é‡è¦çš„ã€‚æœ‰ä¸€äº›ä¸Lottieç±»ä¼¼çš„åº“ï¼Œå¦‚Marcus Eckertçš„<a href="http://www.marcuseckert.com/squall/" target="_blank" rel="noopener">Squall</a>å’ŒFacebookçš„<a href="https://github.com/facebookincubator/Keyframes" target="_blank" rel="noopener">Keyframes</a>,ä½†æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ç•¥æœ‰ä¸åŒã€‚Facebooké€‰æ‹©äº†ä¸€å°éƒ¨åˆ†After Effectsçš„ç‰¹æ€§è¿›è¡Œäº†æ”¯æŒï¼Œå› ä¸ºå®ƒä»¬ä¸»è¦é›†ä¸­åœ¨å“åº”ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¦å°½å¯èƒ½å¤šåœ°æ”¯æŒã€‚è‡³äºSquallï¼ŒAirbnbçš„è®¾è®¡å¸ˆç»„åˆLottieæ¥ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒæœ‰ä¸€ä¸ªæƒŠè‰³çš„After Effectsé¢„è§ˆappï¼Œè¿™ä½¿å¾—å®ƒæˆä¸ºæˆ‘ä»¬å·¥ä½œæµå¿…è¦çš„ä¸€éƒ¨åˆ†ã€‚ç„¶è€Œï¼Œå®ƒåªæ”¯æŒiOSï¼Œæˆ‘ä»¬çš„å·¥ç¨‹å¸ˆå›¢é˜Ÿéœ€è¦ä¸€ä¸ªè·¨å¹³å°çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>Lottieè¿˜åœ¨å…¶APIä¸­å†…ç½®äº†å‡ ä¸ªåŠŸèƒ½ï¼Œä½¿å®ƒæ›´å¤šæ ·åŒ–å’Œé«˜æ•ˆã€‚å®ƒæ”¯æŒé€šè¿‡ç½‘ç»œåŠ è½½JSONæ–‡ä»¶ï¼Œè¿™åœ¨A/Bæµ‹è¯•æ˜¯éå¸¸æœ‰ç”¨ã€‚å®ƒè¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„ç¼“å­˜æœºåˆ¶ï¼Œæ‰€ä»¥é¢‘ç¹ä½¿ç”¨çš„åŠ¨ç”»ï¼Œæ¯”å¦‚ä¸€ä¸ªæ„¿æœ›æ¸…å•çš„çˆ±å¿ƒï¼Œå¯ä»¥æ¯æ¬¡åŠ è½½ä¸€ä¸ªç¼“å­˜çš„å‰¯æœ¬ã€‚LottieåŠ¨ç”»å¯ä»¥é€šè¿‡ä½¿ç”¨åŠ¨ç”»è¿›åº¦åŠŸèƒ½çš„æ‰‹åŠ¿é©±åŠ¨ï¼Œå¹¶ä¸”åŠ¨ç”»é€Ÿåº¦å¯ä»¥é€šè¿‡ç®€å•æ”¹å˜å€¼æ¥æ§åˆ¶ã€‚iOSç”šè‡³æ”¯æŒåœ¨è¿è¡Œæ—¶å¢åŠ é¢å¤–çš„æœ¬åœ°UIåˆ°ä¸€ä¸ªåŠ¨ç”»ä¸­ï¼Œè¿™å¯ä»¥ç”¨äºå¤æ‚çš„åŠ¨ç”»è¿‡æ¸¡ã€‚</p>
<p>é™¤äº†æˆ‘ä»¬è¿„ä»Šä¸ºæ­¢çš„å¢åŠ æ‰€æœ‰After Effectsç‰¹æ€§å’ŒAPIä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æœ‰è®¸å¤šæœªæ¥çš„æƒ³æ³•ã€‚å®ƒä»¬åŒ…æ‹¬æ˜ å°„è§†å›¾åˆ°LottieåŠ¨ç”»ä¸­ï¼Œä½¿ç”¨Lottieæ§åˆ¶è§†å›¾è¿‡æ¸¡ï¼Œæ”¯æŒ<a href="http://www.battleaxe.co/rubberhose/" target="_blank" rel="noopener">Battle Axe çš„ RubberHose</a>ï¼Œæ¸å˜ï¼Œç±»å‹å’Œå›¾åƒçš„æ”¯æŒã€‚æœ€éš¾çš„éƒ¨åˆ†æ˜¯ä¸‹ä¸€ä¸ªç‰¹æ€§æ”¯æŒåº”è¯¥é€‰æ‹©å“ªä¸€ä¸ªã€‚</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*bZbrDT3NGJDw8LoIy3L3mQ.png" alt=""></p>
<h2 id="æ„å»ºç¤¾åŒº"><a href="#æ„å»ºç¤¾åŒº" class="headerlink" title="æ„å»ºç¤¾åŒº"></a>æ„å»ºç¤¾åŒº</h2><p>ä½œä¸ºå¼€æºå‘å¸ƒä¸€äº›ä¸œè¥¿ï¼Œå¹¶ä¸åªæ˜¯æŠŠå®ƒæ‹¿å‡ºæ¥åšä¸ºå…¬å…±ä½¿ç”¨ã€‚å®ƒæ˜¯ä¸€ä¸ªäººè·Ÿäººä¹‹é—´è¿æ¥å’Œäº¤æµçš„æ¡¥æ¢ã€‚éšç€æˆ‘ä»¬æ›´æ¥è¿‘é€šè¿‡GitHubå‘è®¾è®¡å¸ˆå’Œå·¥ç¨‹å¸ˆå‘å¸ƒLottieï¼Œæˆ‘ä»¬ä¹Ÿæƒ³ç¡®ä¿ä¸åŠ¨ç”»äººå‘˜è¿›è¡Œè¿æ¥ã€‚</p>
<p>æˆ‘ä»¬å—åˆ°äº†åˆ›å»ºçš„<a href="http://9-squares.tumblr.com/" target="_blank" rel="noopener">9 Squares</a>ï¼Œ<a href="https://motioncorpse.tumblr.com/" target="_blank" rel="noopener">Motion Corpse</a>å’Œ<a href="https://animography.net/products/mobilo" target="_blank" rel="noopener">Animography</a>çš„å¯å‘ã€‚æ‰€æœ‰è¿™ä¸‰ä¸ªéƒ½èšé›†äº†æ¥è‡ªä¸–ç•Œå„åœ°çš„äººï¼Œåœ¨å…¬å…±åŠ¨ç”»é¡¹ç›®ä¸Šåˆä½œï¼Œä»–ä»¬å¯èƒ½æ°¸è¿œä¸ä¼šä¸€èµ·å·¥ä½œã€‚è¿™äº›é¡¹ç›®èŠ±è´¹äº†å‡ ä¸ªæœˆçš„å·¥ä½œå’Œå¾ˆå¤šçš„ç»„ç»‡ï¼Œå„è‡ªå›¢é˜Ÿçš„äº‰è®ºï¼Œä½†æ˜¯å®ƒä»¬æ— ç–‘å¯¹æ•´ä¸ªåŠ¨ç”»ç¤¾åŒºæä¾›äº†å·¨å¤§çš„ä»·å€¼ã€‚Motion Corpse å’Œ Animography å…¬å¼€åˆ†äº«äº†After Effectsçš„æºæ–‡ä»¶ï¼Œå®ƒä»¬æä¾›äº†å¤§é‡äººä»¬æ€ä¹ˆå·¥ä½œçš„æ·±åˆ»çš„è§è§£ã€‚</p>
<p>åœ¨ä»–ä»¬çš„åˆä½œé¢†å¯¼ä¸‹ï¼Œæˆ‘ä»¬æ¥è§¦äº†æ‰€æœ‰è¿™ä¸‰ä¸ªå›¢é˜Ÿï¼Œä¸ºæˆ‘ä»¬çš„ç¤ºä¾‹appè´¡çŒ®äº†åŠ¨ç”»ã€‚æˆ‘ä»¬åŒ…æ‹¬äº†ä¸€ä¸ªæ¥è‡ª Motion Corpse J.R Canest åˆ›å»ºçš„åŠ¨ç”»ï¼Œæ¥è‡ª9 Squares é¡¹ç›®çš„ Al Boardman çš„squareä¹‹ä¸€ï¼Œå’Œä¸€ä¸ªä½¿ç”¨Animographyçš„MobiloåŠ¨ç”»å­—ä½“çš„é”®ç›˜åŠ¨ç”»ï¼Œå…¶ä¸­æœ‰äºŒåå¤šä¸ªè‰ºæœ¯å®¶çš„å·¥ä½œã€‚æˆ‘ä»¬å¸Œæœ›è¿™äº›åŠ¨ç”»ç¤¾åŒºä¸å¼ºå¤§çš„å·¥ç¨‹ç¤¾åŒºçš„åˆå¹¶å°†äº§ç”Ÿä¸€äº›ç‰¹åˆ«çš„ä¸œè¥¿ã€‚</p>
<p><img src="https://github.com/airbnb/lottie-android/raw/master/gifs/Community%202_3.gif" alt=""></p>
<blockquote>
<p>ä»å·¦åˆ°å³ï¼šMotion Corpse çš„ Jr.canestï¼Œæ¥è‡ª 9 Squares çš„ AI Boardmanï¼ŒAnimography çš„ Mobilo å­—ä½“åŠ¨ç”»</p>
</blockquote>
<p>æˆ‘ä»¬æƒ³å¬åˆ°ä½ æ€ä¹ˆå»ä½¿ç”¨Lottieâ€”â€”ä¸è®ºä½ æ˜¯ä¸€ä¸ªè®¾è®¡å¸ˆï¼ŒåŠ¨ç”»å¸ˆï¼Œè¿˜æ˜¯å·¥ç¨‹å¸ˆã€‚è¯·éšæ—¶ç›´æ¥é€šè¿‡ lottie@airbnb.com å¸¦ç€ä½ çš„æƒ³æ³•ï¼Œåé¦ˆï¼Œè§è§£ä¸æˆ‘ä»¬è”ç³»ã€‚æˆ‘ä»¬å¾ˆé«˜å…´çœ‹åˆ°å½“ä»–ä»¬å¼€å§‹ä»¥æˆ‘ä»¬ä»æœªæƒ³è±¡çš„æ–¹å¼ä½¿ç”¨Lottieæ—¶ï¼Œä¸–ç•Œå„åœ°çš„ç¤¾åŒºå°†ä¼šåšäº›ä»€ä¹ˆã€‚</p>
<p>ä¸‹è½½ <a href="https://github.com/bodymovin/bodymovin" target="_blank" rel="noopener">Bodymovin</a>ï¼ŒLottie <a href="https://github.com/airbnb/lottie-ios" target="_blank" rel="noopener">iOS</a>ï¼Œ<a href="https://github.com/airbnb/lottie-android" target="_blank" rel="noopener">Android</a> å’Œ <a href="https://github.com/airbnb/lottie-react-native" target="_blank" rel="noopener">React Native</a></p>
<p>æœ€åˆå‘å¸ƒäº <a href="http://airbnb.design/lottie/" target="_blank" rel="noopener">airbnb.design/lottie/</a></p>
]]></content>
      
        
        <tags>
            
            <tag> lottie </tag>
            
            <tag> animator </tag>
            
            <tag> animation </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®šï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2017/01/09/Android-%E5%9C%A8Dagger-2%E4%B8%ADActivities%E5%92%8CSubcomponents%E7%9A%84%E5%A4%9A%E7%BB%91%E5%AE%9A%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="åœ¨Dagger-2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®š"><a href="#åœ¨Dagger-2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®š" class="headerlink" title="åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®š"></a>åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®š</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="http://frogermcs.github.io/activities-multibinding-in-dagger-2" target="_blank" rel="noopener">http://frogermcs.github.io/activities-multibinding-in-dagger-2</a></p>
</blockquote>
<p>å‡ ä¸ªæœˆå‰ï¼Œåœ¨<a href="http://2016.mceconf.com/" target="_blank" rel="noopener">MCE^3</a>ä¼šè®®ä¸­ï¼ŒGregory Kickåœ¨ä»–çš„<a href="https://www.youtube.com/watch?v=iwjXqRlEevg" target="_blank" rel="noopener">æ¼”è®²</a>ä¸­å±•ç¤ºäº†ä¸€ä¸ªæä¾›Subcomponentsï¼ˆæ¯”å¦‚ï¼Œä¸ºActivityï¼‰çš„æ–°æ¦‚å¿µã€‚æ–°çš„æ–¹å¼ç»™æˆ‘ä»¬å¸¦æ¥äº†ä¸€ä¸ªåˆ›å»ºä¸ä½¿ç”¨AppComponentå¯¹è±¡å¼•ç”¨ï¼ˆä»¥å‰æ—¶Activities Subcomponentsçš„å·¥å‚ï¼‰çš„æ–¹å¼ã€‚ä¸ºäº†è®©å®ƒæˆä¸ºç°å®ï¼Œæˆ‘ä»¬ä¸å¾—ä¸ç­‰åˆ°äº†æ–°çš„Dagger releaseç‰ˆæœ¬ï¼š<a href="https://github.com/google/dagger/releases/tag/dagger-2.7" target="_blank" rel="noopener">version 2.7</a>ã€‚</p>
<a id="more"></a>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>åœ¨Dagger 2.7ä¹‹å‰ï¼Œåˆ›å»ºSubcomponentï¼ˆæ¯”å¦‚ï¼Œ<code>AppComponent</code>çš„subcomponent <code>MainActivityComponent</code>ï¼‰æˆ‘ä»¬å¿…é¡»è¦åœ¨çˆ¶Componentä¸­å£°æ˜å®ƒçš„å·¥å‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Component</span>(</span><br><span class="line">    modules = &#123;</span><br><span class="line">        AppModule.class</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">    <span class="function">MainActivityComponent <span class="title">plus</span><span class="params">(MainActivityComponent.ModuleImpl <span class="keyword">module</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤šäºDaggerç†è§£è¿™ä¸ªå£°æ˜ï¼Œ<code>MainActivityComponent</code>èƒ½å¤Ÿè®¿é—®ä»<code>AppComponent</code>çš„ä¾èµ–ã€‚</p>
<p>æœ‰äº†è¿™ä¸ªï¼Œ<code>MainActivity</code>ä¸­çš„æ³¨å…¥çœ‹èµ·æ¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> ActivityComponent <span class="title">onCreateComponent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ((MyApplication) getApplication()).getComponent().plus(<span class="keyword">new</span> MainActivityComponent.ModuleImpl(<span class="keyword">this</span>));</span><br><span class="line">    component.inject(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">return</span> component;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä»£ç çš„é—®é¢˜åœ¨äºï¼š</p>
<ul>
<li><p>Activityä¾èµ–äº<code>AppComponent</code>ï¼ˆé€šè¿‡<code>((MyApplication) getApplication()).getComponent())</code>è¿”å› - æˆ‘ä»¬æ˜¯å¦æƒ³è¦å»åˆ›å»ºSubcomponentï¼Œæˆ‘ä»¬éœ€è¦å»è®¿é—®çˆ¶Componentçš„å¯¹è±¡ï¼‰ã€‚</p>
</li>
<li><p><code>AppComponent</code>å¿…é¡»è¦å»å£°æ˜æ‰€æœ‰Subcomponentsï¼ˆæˆ–è€…å®ƒä»¬çš„buildersï¼‰ï¼Œæ¯”å¦‚ï¼š<code>MainActivityComponent plus(MainActivityComponent.ModuleImpl module);</code>ã€‚</p>
</li>
</ul>
<h2 id="Modules-subcomponents"><a href="#Modules-subcomponents" class="headerlink" title="Modules.subcomponents"></a>Modules.subcomponents</h2><p>ä»Dagger 2.7å¼€å§‹ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•æ¥å£°æ˜subcomponentsçš„çˆ¶çº§ã€‚<code>@Module</code>æ³¨è§£æœ‰ä¸€ä¸ªå¯é€‰çš„<a href="http://google.github.io/dagger/api/2.7/dagger/Module.html#subcomponents--" target="_blank" rel="noopener">subcomponents</a>å±æ€§ï¼Œå®ƒå¯ä»¥å¾—åˆ°subcomponentsç±»çš„åˆ—è¡¨ï¼Œå®ƒä»¬åº”è¯¥æ˜¯å®‰è£…æ­¤moduleç»„ä»¶çš„å­componentã€‚</p>
<h3 id="Exampleï¼š"><a href="#Exampleï¼š" class="headerlink" title="Exampleï¼š"></a>Exampleï¼š</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span>(</span><br><span class="line">        subcomponents = &#123;</span><br><span class="line">                MainActivityComponent.class,</span><br><span class="line">                SecondActivityComponent.class</span><br><span class="line">        &#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ActivityBindingModule</span> </span>&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>ActivityBindingModule</code>åœ¨<code>AppComponent</code>ä¸­è¢«å®‰è£…ã€‚è¿™è¡¨ç¤º<code>MainActivityComponent</code>å’Œ<code>SecondActivityComponent</code>ä¸¤è€…éƒ½æ˜¯<code>AppComponent</code>çš„Subcomponentsã€‚</p>
<p>Subcomponentsçš„å£°æ˜åœ¨è¿™ç§æ–¹æ³•ä¸­ä¸éœ€è¦æ˜ç¡®åœ°åœ¨<code>AppComponent</code>ä¸­è¿›è¡Œå£°æ˜ï¼ˆå°±åƒæœ¬ç« å¼€å¤´çš„ä»£ç ï¼‰ã€‚</p>
<h2 id="Activitiesçš„å¤šç»‘å®š"><a href="#Activitiesçš„å¤šç»‘å®š" class="headerlink" title="Activitiesçš„å¤šç»‘å®š"></a>Activitiesçš„å¤šç»‘å®š</h2><p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘ä»¬æ€ä¹ˆæ ·ä½¿ç”¨<code>Modules.subcomponents</code>æ¥æ„å»ºActivitieså¤šç»‘å®šå¹¶ä¸”æ‘†è„±AppComponentå¯¹è±¡ä¼ å…¥Activityï¼ˆè¿™åœ¨<a href="https://www.youtube.com/watch?v=iwjXqRlEevg&amp;feature=youtu.be&amp;t=1693" target="_blank" rel="noopener">è¿™ä¸ªæ¼”è®²</a>ä¸­ä¹Ÿè§£é‡Šåˆ°ï¼‰ã€‚æˆ‘å°†åªæµè§ˆä»£ç ä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚æ•´ä¸ªå®ç°å·²åœ¨Githubä¸­å¯ç”¨ï¼š<a href="https://github.com/frogermcs/Dagger2Recipes-ActivitiesMultibinding" target="_blank" rel="noopener">Dagger2Recipes-ActivitiesMultibinding</a>ã€‚</p>
<p>æˆ‘ä»¬çš„appåŒ…å«ä¸¤ä¸ªå±å¹•ï¼š<code>MainActivity</code>å’Œ<code>SecondActivity</code>ã€‚æˆ‘ä»¬æƒ³è¦å»ç»™å®ƒä»¬ä¸¤è€…æä¾›Subcomponentsä¸”å¹¶ä¸ä¼ å…¥<code>AppComponent</code>å¯¹è±¡ã€‚</p>
<p>è®©æˆ‘ä»¬ä»ä¸ºæ‰€æœ‰Activity Components buildersæ„å»ºä¸€ä¸ªåŸºæœ¬çš„æ¥å£æ¥å¼€å§‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ActivityComponentBuilder</span>&lt;<span class="title">M</span> <span class="keyword">extends</span> <span class="title">ActivityModule</span>, <span class="title">C</span> <span class="keyword">extends</span> <span class="title">ActivityComponent</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">ActivityComponentBuilder&lt;M, C&gt; <span class="title">activityModule</span><span class="params">(M activityModule)</span></span>;</span><br><span class="line">    <span class="function">C <span class="title">build</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Subcomponentsï¼š<code>MainActivityComponent</code>çš„ä¾‹å­çœ‹èµ·æ¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ActivityScope</span></span><br><span class="line"><span class="meta">@Subcomponent</span>(</span><br><span class="line">        modules = MainActivityComponent.MainActivityModule.class</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MainActivityComponent</span> <span class="keyword">extends</span> <span class="title">ActivityComponent</span>&lt;<span class="title">MainActivity</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Subcomponent</span>.Builder</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Builder</span> <span class="keyword">extends</span> <span class="title">ActivityComponentBuilder</span>&lt;<span class="title">MainActivityModule</span>, <span class="title">MainActivityComponent</span>&gt; </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Module</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MainActivityModule</span> <span class="keyword">extends</span> <span class="title">ActivityModule</span>&lt;<span class="title">MainActivity</span>&gt; </span>&#123;</span><br><span class="line">        MainActivityModule(MainActivity activity) &#123;</span><br><span class="line">            <span class="keyword">super</span>(activity);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Subcomponents buildersçš„<code>Map</code>æ¥å¾—åˆ°æ¯ä¸€ä¸ªActivityç±»çš„æ„å›¾builderã€‚è®©æˆ‘ä»¬å¦‚ä¸‹ä½¿ç”¨<code>Multibinding</code>ç‰¹æ€§ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span>(</span><br><span class="line">        subcomponents = &#123;</span><br><span class="line">                MainActivityComponent.class,</span><br><span class="line">                SecondActivityComponent.class</span><br><span class="line">        &#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ActivityBindingModule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Binds</span></span><br><span class="line">    <span class="meta">@IntoMap</span></span><br><span class="line">    <span class="meta">@ActivityKey</span>(MainActivity.class)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> ActivityComponentBuilder <span class="title">mainActivityComponentBuilder</span><span class="params">(MainActivityComponent.Builder impl)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Binds</span></span><br><span class="line">    <span class="meta">@IntoMap</span></span><br><span class="line">    <span class="meta">@ActivityKey</span>(SecondActivity.class)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> ActivityComponentBuilder <span class="title">secondActivityComponentBuilder</span><span class="params">(SecondActivityComponent.Builder impl)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>ActivityBindingModule</code>åœ¨<code>AppComponent</code>ä¸­è¢«å®‰è£…ã€‚å°±å¦‚å®ƒè¢«è§£é‡Šçš„é‚£æ ·ï¼Œå¤šäº<code>MainActivityComponent</code>å’Œ<code>SecondActivityComponent</code>å°†ä¼šæ˜¯<code>AppComponent</code>çš„Subcomponentã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æ³¨å…¥<code>Subcomponents</code> builderçš„Mapï¼ˆæ¯”å¦‚ï¼Œæ³¨å…¥åˆ°<code>MyApplication</code> classï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplication</span> <span class="keyword">extends</span> <span class="title">Application</span> <span class="keyword">implements</span> <span class="title">HasActivitySubcomponentBuilders</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Map&lt;Class&lt;? extends Activity&gt;, ActivityComponentBuilder&gt; activityComponentBuilders;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> AppComponent appComponent;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> HasActivitySubcomponentBuilders <span class="title">get</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ((HasActivitySubcomponentBuilders) context.getApplicationContext());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line">        appComponent = DaggerAppComponent.create();</span><br><span class="line">        appComponent.inject(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ActivityComponentBuilder <span class="title">getActivityComponentBuilder</span><span class="params">(Class&lt;? extends Activity&gt; activityClass)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> activityComponentBuilders.get(activityClass);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬åˆ›å»ºäº†<code>HashActivitySubcomponentBuilders</code>æ¥å£ä½œä¸ºé¢å¤–çš„æŠ½è±¡ï¼ˆå› ä¸ºbuildersçš„<code>Map</code>ä¸ä¸€å®šæ˜¯æ³¨å…¥åˆ°<code>Appliction</code>ç±»çš„ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HasActivitySubcomponentBuilders</span> </span>&#123;</span><br><span class="line">    <span class="function">ActivityComponentBuilder <span class="title">getActivityComponentBuilder</span><span class="params">(Class&lt;? extends Activity&gt; activityClass)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæœ€ååœ¨Activity classä¸­è¿›è¡Œæ³¨å…¥çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">BaseActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">injectMembers</span><span class="params">(HasActivitySubcomponentBuilders hasActivitySubcomponentBuilders)</span> </span>&#123;</span><br><span class="line">        ((MainActivityComponent.Builder) hasActivitySubcomponentBuilders.getActivityComponentBuilder(MainActivity.class))</span><br><span class="line">                .activityModule(<span class="keyword">new</span> MainActivityComponent.MainActivityModule(<span class="keyword">this</span>))</span><br><span class="line">                .build().injectMembers(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒéå¸¸ç±»ä¼¼äºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå®ç°ï¼Œä½†å¦‚ä¸Šï¼Œæœ€é‡è¦çš„äº‹æ˜¯æˆ‘ä»¬ä¸å†ä¼ å…¥<code>ActivityComponent</code>å¯¹è±¡åˆ°æˆ‘ä»¬çš„Activitiesä¸­ã€‚</p>
<h2 id="ç”¨ä¾‹example-â€”â€”-instrumentation-tests-mocking"><a href="#ç”¨ä¾‹example-â€”â€”-instrumentation-tests-mocking" class="headerlink" title="ç”¨ä¾‹example â€”â€” instrumentation tests mocking"></a>ç”¨ä¾‹example â€”â€” instrumentation tests mocking</h2><p>é™¤äº†è§£è€¦å’Œè§£å†³å¾ªç¯ä¾èµ–ï¼ˆActivity &lt;-&gt; Applicationï¼‰ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå¤§çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨è¾ƒå°çš„é¡¹ç›®/å›¢é˜Ÿä¸­ï¼Œè®©æˆ‘ä»¬æ€è€ƒä¸€ä¸ªè¿™ä¸ªå®ç°æœ‰å¸®åŠ©çš„çœŸå®ç”¨ä¾‹ â€”â€” åœ¨instrumentation testingä¸­çš„mockingä¾èµ–ã€‚</p>
<p>ç›®å‰åœ¨Android Instrumentationæµ‹è¯•ä¸­mockingä¾èµ–æœ€è‘—åçš„æ–¹å¼ä¹‹ä¸€æ˜¯ä½¿ç”¨<a href="https://medium.com/@fabioCollini/android-testing-using-dagger-2-mockito-and-a-custom-junit-rule-c8487ed01b56#.eh5zfyou5" target="_blank" rel="noopener">DaggerMock</a>ï¼ˆGithub <a href="https://github.com/fabioCollini/DaggerMock" target="_blank" rel="noopener">é¡¹ç›®åœ°å€</a>ï¼‰ã€‚è™½ç„¶DaggerMockæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½†æ˜¯éå¸¸éš¾ç†è§£å®ƒé¢å…·ä¹‹ä¸‹æ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚å…¶ä¸­æœ‰ä¸€äº›åå°„ä»£ç ä¸å®¹æ˜“è¢«è¿½è¸ªã€‚</p>
<p>åœ¨Activityä¸­ç›´æ¥æ„å»ºSubcomponentï¼Œè€Œä¸éœ€è¦è®¿é—®AppComponentç±»ç»™äº†æˆ‘ä»¬ä¸€ä¸ªæ–¹å¼æ¥æµ‹è¯•å•ç‹¬çš„Activityå¹¶ä»æˆ‘ä»¬appçš„å…¶å®ƒéƒ¨åˆ†è§£è€¦ã€‚</p>
<p>å¬èµ·æ¥å¾ˆé…·ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸‹ä»£ç ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„instrumentation testä¸­ä½¿ç”¨Applicatonç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplicationMock</span> <span class="keyword">extends</span> <span class="title">MyApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">putActivityComponentBuilder</span><span class="params">(ActivityComponentBuilder builder, Class&lt;? extends Activity&gt; cls)</span> </span>&#123;</span><br><span class="line">        Map&lt;Class&lt;? extends Activity&gt;, ActivityComponentBuilder&gt; activityComponentBuilders = <span class="keyword">new</span> HashMap&lt;&gt;(<span class="keyword">this</span>.activityComponentBuilders);</span><br><span class="line">        activityComponentBuilders.put(cls, builder);</span><br><span class="line">        <span class="keyword">this</span>.activityComponentBuilders = activityComponentBuilders;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>putActivityComponentBuilder()</code>æ–¹æ³•ç»™æˆ‘ä»¬ä¸€ä¸ªå¯¹ç»™å®šActivityç±»æ›¿æ¢ActivityComponentBuilderçš„å®ç°çš„æ–¹æ³•ã€‚</p>
<p>ç°åœ¨æ¥çœ‹ä¸‹æˆ‘ä»¬Espresso Instrumentation Testä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(AndroidJUnit4.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivityUITest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Rule</span></span><br><span class="line">    <span class="keyword">public</span> MockitoRule mockitoRule = MockitoJUnit.rule();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Rule</span></span><br><span class="line">    <span class="keyword">public</span> ActivityTestRule&lt;MainActivity&gt; activityRule = <span class="keyword">new</span> ActivityTestRule&lt;&gt;(MainActivity.class, <span class="keyword">true</span>, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mock</span></span><br><span class="line">    MainActivityComponent.Builder builder;</span><br><span class="line">    <span class="meta">@Mock</span></span><br><span class="line">    Utils utilsMock;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MainActivityComponent mainActivityComponent = <span class="keyword">new</span> MainActivityComponent() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">injectMembers</span><span class="params">(MainActivity instance)</span> </span>&#123;</span><br><span class="line">            instance.mainActivityPresenter = <span class="keyword">new</span> MainActivityPresenter(instance, utilsMock);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        when(builder.build()).thenReturn(mainActivityComponent);</span><br><span class="line">        when(builder.activityModule(any(MainActivityComponent.MainActivityModule.class))).thenReturn(builder);</span><br><span class="line"></span><br><span class="line">        ApplicationMock app = (ApplicationMock) InstrumentationRegistry.getTargetContext().getApplicationContext();</span><br><span class="line">        app.putActivityComponentBuilder(builder, MainActivity.class);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€æ­¥ä¸€æ­¥æ¥ï¼š</p>
<ul>
<li><p>æˆ‘ä»¬æä¾›äº†<code>MainActivityComponent.Builder</code>çš„Mockå’Œæ‰€æœ‰æˆ‘ä»¬å¿…é¡»è¦mockçš„ä¾èµ–ï¼ˆåœ¨æœ¬ä¾‹ä¸­åªæ˜¯<code>Utils</code>ï¼‰ã€‚æˆ‘ä»¬mocked<code>Builder</code>è¿”å›ä¸€ä¸ª<code>MainActivityComponent</code>çš„ä¸€ä¸ªè‡ªå®šä¹‰å®ç°ï¼Œå®ƒç”¨äºæ³¨å…¥<code>MainActivityPresenter</code>ï¼ˆå…¶ä¸­ä½¿ç”¨äº†mocked <code>Utils</code>ï¼‰ã€‚</p>
</li>
<li><p>ç„¶åæˆ‘ä»¬çš„<code>MainActivityComponent.Builder</code>æ›¿æ¢äº†åœ¨<code>MyApplication</code>ï¼ˆ28è¡Œï¼‰ä¸­è¢«æ³¨å…¥çš„åŸå§‹Builderï¼š<code>app.putActivityComponentBuilder(builder, MainActivity.class);</code></p>
</li>
<li><p>æœ€åæµ‹è¯• â€”â€” æˆ‘ä»¬mock<code>Util.getHardcodedText()</code>æ–¹æ³•ã€‚æ³¨å…¥è¿‡ç¨‹å‘ç”Ÿåœ¨Activityè¢«åˆ›å»ºï¼ˆ36è¡Œï¼‰ï¼š<code>activityRule.launchActivity(new Intent());</code>æ¥ç€åœ¨æœ€åæˆ‘ä»¬ä½¿ç”¨Espressoæ¥æ£€éªŒç»“æœã€‚</p>
</li>
</ul>
<p>ä»¥ä¸Šå°±æ˜¯å…¨éƒ¨ã€‚å¦‚ä½ æ‰€è§ï¼Œå‡ ä¹ä¸€åˆ‡éƒ½å‘ç”Ÿåœ¨<code>MainActivityUITest</code>ç±»ä¸­ï¼Œè€Œä¸”ä»£ç ç›¸å½“ç®€å•å’Œå¯è¯»ã€‚</p>
<h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p>å¦‚æœä½ æƒ³è‡ªå·±å»æµ‹è¯•è¿™ä¸ªå®ç°ï¼Œæºç ä¸å·¥ä½œä¾‹å­å±•ç¤ºæ€ä¹ˆå»åˆ›å»º<strong>Activities Multibinding</strong>å’Œåœ¨Instrumentation Testsä¸­mockä¾èµ–è§Githubï¼š<a href="https://github.com/frogermcs/Dagger2Recipes-ActivitiesMultibinding" target="_blank" rel="noopener">Dagger2Recipes-ActivitiesMultibinding</a></p>
<p>æ„Ÿè°¢é˜…è¯»ï¼</p>
<h2 id="ä½œè€…"><a href="#ä½œè€…" class="headerlink" title="ä½œè€…"></a>ä½œè€…</h2><p><a href="http://about.me/froger_mcs" target="_blank" rel="noopener">Miroslaw Stanek</a></p>
<p>Head of Mobile Development @ <a href="https://azimo.com/" target="_blank" rel="noopener">Azimo</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092083.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092083.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - APIï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092525.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092525.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5095426.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5095426.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5098943.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5098943.html</a></p>
<blockquote>
<p><strong>[Android]Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5193437.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5193437.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producersï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6234811.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6234811.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6236646.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6236646.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6237731.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6237731.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®šï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6266442.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6266442.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> google </tag>
            
            <tag> dagger2 </tag>
            
            <tag> DI </tag>
            
            <tag> dependency injection </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScopeï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2016/12/30/Android-%E4%BD%BF%E7%94%A8Dagger-2%E6%9D%A5%E6%9E%84%E5%BB%BAUserScope%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="ä½¿ç”¨Dagger-2æ¥æ„å»ºUserScope"><a href="#ä½¿ç”¨Dagger-2æ¥æ„å»ºUserScope" class="headerlink" title="ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScope"></a>ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScope</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="http://frogermcs.github.io/building-userscope-with-dagger2/" target="_blank" rel="noopener">http://frogermcs.github.io/building-userscope-with-dagger2/</a></p>
</blockquote>
<p>åœ¨Dagger 2ä¸­è‡ªå®šä¹‰scopeså¯ä»¥åœ¨ä¸å¯»å¸¸å­˜æ´»æ—¶é—´ï¼ˆä¸Applicationå’Œç•Œé¢ç”Ÿå‘½å‘¨æœŸä¸åŒçš„ï¼‰çš„ä¾èµ–ä¸Šç»™æˆ‘å¸¦æ¥æ›´å¥½çš„æ§åˆ¶ã€‚ä½†æ˜¯åœ¨Android appä¸­æ­£ç¡®åœ°å®ç°å®ƒéœ€è¦è®°ä½å‡ ä¸ªäº‹æƒ…ï¼šscopeä¸èƒ½å­˜æ´»æ¯”applicationè¿›ç¨‹æ›´é•¿çš„å‘¨æœŸï¼Œè¿›ç¨‹å¯ä»¥è¢«ç³»ç»Ÿæ€æ­»å¹¶ä¸”åœ¨æ›´å¤šçš„å¯¹è±¡å®ä¾‹çš„ç”¨æˆ·æµä¸­æ¢å¤è¿‡æ¥ã€‚ä»Šå¤©æˆ‘ä»¬å°†ä»‹ç»æ‰€æœ‰è¿™äº›ï¼Œå¹¶å°è¯•å®ç°å¯ç”¨äºç”Ÿäº§çš„UserScopeã€‚</p>
<p>åœ¨æˆ‘çš„å…¶ä¸­ä¸€ç¯‡åšå®¢ä¸­<a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-custom-scopes/" target="_blank" rel="noopener">å†™äº†</a>å…³äº<strong>è‡ªå®šä¹‰scopes</strong>å’Œ<strong>Subcomponents</strong>ã€‚ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä½¿ç”¨äº†<code>UserScope</code>ï¼Œåªè¦ç”¨æˆ·æ˜¯ç™»å½•çŠ¶æ€å°±åº”è¯¥å­˜æ´»ã€‚ä¸€ä¸ªscopesç”Ÿå‘½å‘¨æœŸçš„ä¾‹å­ï¼š</p>
<p><img src="http://frogermcs.github.io/images/15/scopes-lifecycle.png" alt=""></p>
<p>è™½ç„¶å®ƒçœ‹èµ·æ¥éå¸¸ç®€å•ï¼Œå®ƒçš„å®ç°åœ¨é‚£ç¯‡æ–‡ç« ä¸­å·²ç»å±•ç¤ºï¼Œä½†æ˜¯å®ƒçš„ä»£ç æ˜¯è„±ç¦»ä¸ç”Ÿäº§ç¯å¢ƒçš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘æƒ³è¦åˆä¸€æ¬¡æ·±å…¥è¿™ä¸ªè¯é¢˜ - ä½†æ˜¯ä¼šæœ‰æ›´å¤šå®ç°çš„ä¸Šä¸‹æ–‡ç»†èŠ‚ã€‚</p>
<h2 id="Example-app"><a href="#Example-app" class="headerlink" title="Example app"></a>Example app</h2><p>æˆ‘ä»¬å°†æ„å»º3ä¸ªç•Œé¢çš„åº”ç”¨ï¼Œå®ƒå¯ä»¥ä»<a href="https://developer.github.com/v3/" target="_blank" rel="noopener">Github API</a>è·å–ç”¨æˆ·è¯¦æƒ…ï¼ˆè®©æˆ‘ä»¬å‡è®¾è¿™åœ¨ç”Ÿäº§ç¯å¢ƒappä¸­ä½œä¸ºä¸€ä¸ªè®¤è¯çš„äº‹ä»¶ï¼‰ã€‚</p>
<p>Appå°†ä¼šæœ‰3ä¸ªscopesï¼š</p>
<ul>
<li>(Application scope, <strong>@Singleton</strong>) - åªè¦applicationå­˜æ´»ä¾èµ–å°±å­˜æ´»ã€‚</li>
<li><strong>@UserScope</strong> - åªè¦ç”¨æˆ·ä¼šè¯æ˜¯æ¿€æ´»çŠ¶æ€ä¾èµ–å°±å­˜æ´»ï¼ˆåœ¨å•ä¸ªåº”ç”¨ç¨‹åºä¸­å¯åŠ¨ï¼‰ã€‚<strong>é‡è¦çš„æ˜¯ï¼š</strong>è¿™ä¸ªscopeå­˜æ´»æ—¶é—´ä¸ä¼šè¶…è¿‡applicationæœ¬èº«ã€‚æ¯ä¸€ä¸ªæ–°çš„appå®ä¾‹éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„@UserScopeï¼ˆç”šè‡³appä¸åŒçš„å¯åŠ¨é—´ç”¨æˆ·ä¼šè¯æ²¡æœ‰å…³é—­ï¼‰ã€‚</li>
<li><strong>@ActivityScope</strong> - åªè¦Activityç•Œé¢å­˜æ´»ä¾èµ–å°±å­˜æ´»ã€‚</li>
</ul>
<h3 id="å®ƒæ€ä¹ˆå·¥ä½œçš„å‘¢ï¼Ÿ"><a href="#å®ƒæ€ä¹ˆå·¥ä½œçš„å‘¢ï¼Ÿ" class="headerlink" title="å®ƒæ€ä¹ˆå·¥ä½œçš„å‘¢ï¼Ÿ"></a>å®ƒæ€ä¹ˆå·¥ä½œçš„å‘¢ï¼Ÿ</h3><p>å½“appä»Github APIå¾—åˆ°ç‰¹å®šç”¨æˆ·åçš„æ•°æ®ï¼Œæ–°çš„ç•Œé¢ä¼šè¢«æ‰“å¼€ï¼ˆUserDetailsï¼‰ã€‚åœ¨å†…éƒ¨ï¼Œ<code>LoginActivityPresenter</code>è®¿é—®<code>UserManager</code>æ¥å¼€å¯ä¸€ä¸ªä¼šè¯ï¼ˆä»Github APIè·å–æ•°æ®ï¼‰ã€‚å½“æ“ä½œæˆåŠŸï¼Œç”¨æˆ·ä¿å­˜åˆ°<code>UserDataStore</code>ï¼Œå¹¶ä¸”<code>UserManager</code>åˆ›å»º<code>UserComponent</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UserManager</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Observable&lt;User&gt; <span class="title">startSessionForUser</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> githubApiService.getUser(username)</span><br><span class="line">            .map(User.UserResponseToUser())</span><br><span class="line">            .doOnNext(<span class="keyword">new</span> Action1&lt;User&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">                    userDataStore.createUser(user);</span><br><span class="line">                    startUserSession();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .subscribeOn(Schedulers.io())</span><br><span class="line">            .observeOn(AndroidSchedulers.mainThread());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">startUserSession</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User user = userDataStore.getUser();</span><br><span class="line">    <span class="keyword">if</span> (user != <span class="keyword">null</span>) &#123;</span><br><span class="line">        Timber.i(<span class="string">"Session started, user: %s"</span>, user);</span><br><span class="line">        userComponent = userComponentBuilder.sessionModule(<span class="keyword">new</span> UserModule(user)).build();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>UserManager</strong>æ˜¯ä¸€ä¸ªå•ä¾‹ï¼Œæ‰€ä»¥å®ƒçš„å­˜æ´»æ—¶é—´ä¸Applicaitonä¸€è‡´ï¼Œè€Œä¸”å®ƒå¯¹ç”Ÿå‘½å‘¨æœŸä¸ç”¨æˆ·ä¼šè¯ä¸€æ ·çš„<code>UserComponet</code>è´Ÿè´£ã€‚å½“ç”¨æˆ·å†³å®šå»å…³é—­ä¼šè¯ï¼Œcomponentä¼šè¢«ç§»é™¤ï¼Œè¿™æ ·æ‰€æœ‰<code>@UserScope</code>æ³¨è§£äº†çš„å¯¹è±¡åº”è¯¥å‡†å¤‡è¢«GCå›æ”¶ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UserManager</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeUserSession</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Timber.i(<span class="string">"Close session for user: %s"</span>, userDataStore.getUser());</span><br><span class="line">    userComponent.logoutManager().startLogoutProcess();</span><br><span class="line">    userDataStore.clearUser();</span><br><span class="line">    userComponent = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Componentsçš„å±‚æ¬¡ç»“æ„"><a href="#Componentsçš„å±‚æ¬¡ç»“æ„" class="headerlink" title="Componentsçš„å±‚æ¬¡ç»“æ„"></a>Componentsçš„å±‚æ¬¡ç»“æ„</h3><p>åœ¨æˆ‘ä»¬çš„appä¸­æ‰€æœ‰çš„subcomponentsä½¿ç”¨äº†ä¸€ä¸ª<code>AppComponent</code>ä½œä¸ºä¸€ä¸ªæ ¹componentã€‚æ˜¾ç¤ºç”¨æˆ·ç›¸å…³å†…å®¹çš„Subcomponentsä½¿ç”¨ä¿æŒäº†å¸¦<code>@Userscope</code>æ³¨è§£çš„å¯¹è±¡ï¼ˆä¸€ä¸ªç”¨æˆ·ä¼šè¯ä¸€ä¸ªå®ä¾‹ï¼‰çš„<code>UserComponent</code>ã€‚</p>
<p><img src="http://frogermcs.github.io/images/28/scopes.png" alt=""></p>
<p><code>UserDetailsActivityComponent</code>ç»„ä»¶å±‚æ¬¡ç»“æ„ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AppComponent.java </span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Component</span>(modules = &#123;</span><br><span class="line">        AppModule.class,</span><br><span class="line">        GithubApiModule.class</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line">    UserComponent.<span class="function">Builder <span class="title">userComponentBuilder</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// UserComponent.java </span></span><br><span class="line"></span><br><span class="line"><span class="meta">@UserScope</span></span><br><span class="line"><span class="meta">@Subcomponent</span>(modules = UserModule.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Subcomponent</span>.Builder</span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line">        UserComponent.<span class="function">Builder <span class="title">sessionModule</span><span class="params">(UserModule userModule)</span></span>;</span><br><span class="line">        <span class="function">UserComponent <span class="title">build</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">UserDetailsActivityComponent <span class="title">plus</span><span class="params">(UserDetailsActivityComponent.UserDetailsActivityModule <span class="keyword">module</span>)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// UserDetailsActivityComponent.java </span></span><br><span class="line"></span><br><span class="line"><span class="meta">@ActivityScope</span></span><br><span class="line"><span class="meta">@Subcomponent</span>(modules = UserDetailsActivityComponent.UserDetailsActivityModule.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDetailsActivityComponent</span> </span>&#123;</span><br><span class="line">    <span class="function">UserDetailsActivity <span class="title">inject</span><span class="params">(UserDetailsActivity activity)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹äº<code>UserComponent</code>ï¼Œæˆ‘ä»¬ä½¿ç”¨<a href="http://google.github.io/dagger/subcomponents.html#subcomponent-builders" target="_blank" rel="noopener">Subcomponent builder</a>æ¨¡å¼æ¥è®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ æ•´æ´ï¼Œæœ‰å¯èƒ½æ³¨å…¥è¿™ä¸ªBuilderåˆ°<code>UserModule</code>ï¼ˆ<code>UserComponent.Builder</code>ç”¨äºåˆ›å»ºç»„ä»¶<code>UserModule.startUserSession</code>æ–¹æ³•å¦‚ä¸Šæ‰€ç¤ºï¼‰ã€‚</p>
<h3 id="åœ¨appçš„å¤šæ¬¡å¯åŠ¨ä¸­æ¢å¤UserScope"><a href="#åœ¨appçš„å¤šæ¬¡å¯åŠ¨ä¸­æ¢å¤UserScope" class="headerlink" title="åœ¨appçš„å¤šæ¬¡å¯åŠ¨ä¸­æ¢å¤UserScope"></a>åœ¨appçš„å¤šæ¬¡å¯åŠ¨ä¸­æ¢å¤UserScope</h3><p>å°±åƒæˆ‘ä¹‹å‰æåˆ°çš„UserScopeçš„å­˜æ´»æ—¶é—´ä¸èƒ½è¶…è¿‡applicationè¿›ç¨‹ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬å‡è®¾ç”¨æˆ·ä¼šè¯å¯ä»¥åœ¨appçš„å¤šæ¬¡å¯åŠ¨ä¹‹é—´ä¿å­˜ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬çš„<code>UserScope</code>å»å¤„ç†çŠ¶æ€æ¢å¤æ“ä½œã€‚æœ‰ä¸¤ç§åœºæ™¯æˆ‘ä»¬éœ€è¦è®°ä½ï¼š</p>
<h4 id="ç”¨æˆ·ä»å¤´å¼€å§‹å¯åŠ¨ç¨‹åº"><a href="#ç”¨æˆ·ä»å¤´å¼€å§‹å¯åŠ¨ç¨‹åº" class="headerlink" title="ç”¨æˆ·ä»å¤´å¼€å§‹å¯åŠ¨ç¨‹åº"></a>ç”¨æˆ·ä»å¤´å¼€å§‹å¯åŠ¨ç¨‹åº</h4><p>è¿™æ˜¯æœ€å¸¸è§çš„æƒ…å†µï¼Œåº”è¯¥å¾ˆç®€å•åœ°å»å¤„ç†ã€‚ç”¨æˆ·ä»å¤´å¼€å§‹å¯åŠ¨appï¼ˆæ¯”å¦‚ï¼Œé€šè¿‡ç‚¹å‡»app iconï¼‰ã€‚<code>Application</code>å¯¹è±¡è¢«åˆ›å»ºï¼Œç„¶åç¬¬ä¸€ä¸ª<code>Activity</code>ï¼ˆ<strong>LAUNCHER</strong>ï¼‰è¢«å¯åŠ¨ã€‚æˆ‘ä»¬éœ€è¦æä¾›ç®€å•çš„é€»è¾‘æ£€æŸ¥æˆ‘ä»¬æ˜¯å¦æœ‰ä¿å­˜çš„ç”¨æˆ·åœ¨æˆ‘ä»¬çš„æ•°æ®å­˜å‚¨ä¸­ã€‚å¦‚æœæ˜¯åˆ™å°†ç”¨æˆ·ä¼ é€åˆ°UserComponentè‡ªåŠ¨åˆ›å»ºçš„æ­£ç¡®çš„ç•Œé¢ï¼ˆåœ¨æˆ‘ä»¬æ¡ˆä¾‹ä¸­æ˜¯<code>UserDetailsActivity</code>ï¼‰ã€‚</p>
<h4 id="ç”¨æˆ·è¿›ç¨‹è¢«ç³»ç»Ÿkill"><a href="#ç”¨æˆ·è¿›ç¨‹è¢«ç³»ç»Ÿkill" class="headerlink" title="ç”¨æˆ·è¿›ç¨‹è¢«ç³»ç»Ÿkill"></a>ç”¨æˆ·è¿›ç¨‹è¢«ç³»ç»Ÿkill</h4><p>ä½†æ˜¯è¿˜æœ‰ä¸€ç§æƒ…å†µæˆ‘ä»¬ç»å¸¸ä¼šå¿˜è®°ã€‚Applicationè¿›ç¨‹å¯ä»¥è¢«ç³»ç»Ÿæ€æ­»ï¼ˆæ¯”å¦‚ï¼Œå› ä¸ºå†…å­˜ä¸è¶³ï¼‰ã€‚è¿™æ„å‘³ç€æ‰€æœ‰applicationæ•°æ®è¢«é”€æ¯ï¼ˆapplicationï¼Œactivitiesï¼Œstatic fieldsï¼‰ã€‚ä¸å¹¸çš„æ˜¯è¿™ä¸èƒ½è¢«å¾ˆå¥½çš„å¤„ç† - æˆ‘ä»¬åœ¨Applicaitonç”Ÿå‘½å‘¨æœŸä¸­æ²¡æœ‰ä»»ä½•å›è°ƒã€‚ä»¤å®ƒæ›´å¤æ‚çš„æ˜¯ï¼Œandroidä¿å­˜äº†activityæ ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç”¨æˆ·å†³å®šå¯åŠ¨ä¹‹å‰è¢«æ€æ­»äºæµä¸­é—´çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œç³»ç»Ÿå°†è¯•å›¾å¸¦ç”¨æˆ·å›åˆ°æ­¤ç•Œé¢ã€‚</p>
<p>å¯¹äºæˆ‘ä»¬è€Œè¨€æˆ‘ä»¬éœ€è¦å‡†å¤‡åœ¨ä»»ä½•è¢«ä½¿ç”¨çš„å±å¹•ä¸­å»æ¢å¤<code>UserComponent</code>ã€‚</p>
<p>è®©æˆ‘ä»¬è€ƒè™‘è¿™ä¸ªä¾‹å­ï¼š</p>
<p>1. ç”¨æˆ·åœ¨<code>UserDetailsActivity</code>ç•Œé¢æœ€å°åŒ–appã€‚<br>2. æ•´ä¸ªappè¢«ç³»ç»Ÿæ€æ­»ï¼ˆç¨åæˆ‘ä¼šå±•ç¤ºå¦‚ä½•æ¨¡æ‹Ÿå®ƒï¼‰<br>3. ç”¨æˆ·æ‰“å¼€ä»»åŠ¡åˆ‡æ¢æ ï¼Œç‚¹å‡»æˆ‘ä»¬çš„appç•Œé¢ã€‚<br>4. ç³»ç»Ÿåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„<code>Application</code>å®ä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´æœ‰ä¸€ä¸ªæ–°çš„<code>AppComponent</code>è¢«åˆ›å»ºã€‚ç„¶åç³»ç»Ÿå¹¶ä¸ä¼šæ‰“å¼€<code>LoginActivity</code>ï¼ˆæˆ‘ä»¬çš„å¯åŠ¨activityï¼‰ï¼Œè€Œæ˜¯ç«‹å³æ‰“å¼€<code>UserDetailsActivity</code>ã€‚</p>
<p>å¯¹äºæˆ‘ä»¬è€Œè¨€ï¼Œ<code>UserComponent</code>è¢«æ¢å¤å›æ¥ï¼ˆæ–°çš„å®ä¾‹è¢«åˆ›å»ºï¼‰ã€‚ç„¶åè¿™æ˜¯æˆ‘ä»¬çš„è´£ä»»ã€‚ä¾‹å­çš„è§£å†³æ–¹æ¡ˆçœ‹èµ·æ¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseUserActivity</span> <span class="keyword">extends</span> <span class="title">BaseActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    UserManager userManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setupActivityComponent</span><span class="params">(AppComponent appComponent)</span> </span>&#123;</span><br><span class="line">        appComponent.inject(<span class="keyword">this</span>);</span><br><span class="line">        setupUserComponent();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setupUserComponent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    isUserSessionStarted = userManager.isUserSessionStartedOrStartSessionIfPossible();</span><br><span class="line">    onUserComponentSetup(userManager.getUserComponent());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//This screen cannot work when user session is not started.</span></span><br><span class="line">    <span class="keyword">if</span> (!isUserSessionStarted) &#123;</span><br><span class="line">        finish();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">onUserComponentSetup</span><span class="params">(UserComponent userComponent)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¯ä¸€ä¸ªä½¿ç”¨äº†UserComponentçš„Activityéƒ½ç»§æ‰¿äº†æˆ‘ä»¬çš„<code>BaseUserActivity</code>ç±»ï¼ˆ<code>setupActivityComponent()</code>æ–¹æ³•åœ¨<code>BaseActivity</code>çš„<code>onCreate()</code>æ–¹æ³•ä¸­è°ƒç”¨ï¼‰ã€‚</p>
<p><code>UserManager</code>ä»Applicationåˆ›å»ºçš„<code>AppComponent</code>ä¸­è¢«æ³¨å…¥ã€‚ä¼šè¯é€šè¿‡è¿™ç§æ–¹å¼å¼€å¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isUserSessionStartedOrStartSessionIfPossible</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> userComponent != <span class="keyword">null</span> || startUserSession();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">startUserSession</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//This method was described earlier</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¦‚æœç”¨æˆ·ä¸å†å­˜åœ¨æ€ä¹ˆåŠï¼Ÿ"><a href="#å¦‚æœç”¨æˆ·ä¸å†å­˜åœ¨æ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="å¦‚æœç”¨æˆ·ä¸å†å­˜åœ¨æ€ä¹ˆåŠï¼Ÿ"></a>å¦‚æœç”¨æˆ·ä¸å†å­˜åœ¨æ€ä¹ˆåŠï¼Ÿ</h4><p>è¿™é‡Œæœ‰å¦å¤–ä¸€ç§æ–¹å¼æ¥å¤„ç† - å¦‚æœç”¨æˆ·ç™»å‡ºï¼ˆæ¯”å¦‚ï¼Œé€šè¿‡<code>SyncAdapter</code>ï¼‰ï¼Œç„¶å<code>UserComponent</code>ä¸èƒ½è¢«åˆ›å»ºæ€ä¹ˆåŠï¼Ÿè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨æˆ‘ä»¬çš„<code>BaseUserActivity</code>ä¸­æœ‰è¿™å‡ è¡Œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setupUserComponent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//This screen cannot work when user session is not started.</span></span><br><span class="line">    <span class="keyword">if</span> (!isUserSessionStarted) &#123;</span><br><span class="line">        finish();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªæƒ…å†µæ—¶å½“UserComponentä¸èƒ½è¢«åˆ›å»ºæ—¶æˆ‘ä»¬å¿…é¡»è¦è®°ä½ä¾èµ–æ³¨å…¥å°†ä¸ä¼šå‘ç”Ÿã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘æ¯æ¬¡éœ€è¦åœ¨<code>onCreate()</code>æ–¹æ³•ä¸­æ£€æŸ¥æ¥é˜²æ­¢æ¥è‡ªä¾èµ–æ³¨å…¥çš„NullPointerExceptionsã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UserDetailsActivity</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_user_details);</span><br><span class="line">    tvUser = (TextView) findViewById(R.id.tvUser);</span><br><span class="line">    tvUserUrl = (TextView) findViewById(R.id.tvUserUrl);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//This check has to be called. Otherwise, when user is not logged in, presenter won't be injected and this line will cause NPE</span></span><br><span class="line">    <span class="keyword">if</span> (isUserSessionStarted()) &#123;</span><br><span class="line">        presenter.onCreate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ€ä¹ˆå»æ¨¡æ‹Ÿåº”ç”¨è¿›ç¨‹è¢«ç³»ç»Ÿæ€æ­»"><a href="#æ€ä¹ˆå»æ¨¡æ‹Ÿåº”ç”¨è¿›ç¨‹è¢«ç³»ç»Ÿæ€æ­»" class="headerlink" title="æ€ä¹ˆå»æ¨¡æ‹Ÿåº”ç”¨è¿›ç¨‹è¢«ç³»ç»Ÿæ€æ­»"></a>æ€ä¹ˆå»æ¨¡æ‹Ÿåº”ç”¨è¿›ç¨‹è¢«ç³»ç»Ÿæ€æ­»</h3><p>1. æ‰“å¼€ä½ æƒ³æµ‹è¯•çš„ç”¨æˆ·ç•Œé¢<br>2. é€šè¿‡ç³»ç»ŸHomeé”®æœ€å°åŒ–appã€‚<br>3. åœ¨Android Studioï¼ŒAndroid Monitor é€‰ä¸­ä½ çš„åº”ç”¨ï¼Œç„¶åç‚¹å‡»Terminate<br>4. ç°åœ¨åœ¨ä½ çš„è®¾å¤‡ä¸Šæ‰“å¼€ä»»åŠ¡åˆ‡æ¢æ ï¼Œæ‰¾åˆ°ä½ çš„appï¼ˆä½ åº”è¯¥ä»ç„¶èƒ½åœ¨æœ€åä¸€ä¸ªå¯è§çš„ç•Œé¢ä¸Šé¢„è§ˆåˆ°ï¼‰ã€‚<br>5. ä½ çš„appè¢«å¯åŠ¨ï¼Œæ–°çš„Applicationå®ä¾‹è¢«åˆ›å»ºï¼Œå¹¶ä¸”Activityè¢«æ¢å¤ã€‚</p>
<h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p>ä¾‹å­ä¸­å±•ç¤ºæ€ä¹ˆæ ·å»åˆ›å»ºå’Œä½¿ç”¨<code>UserComponent</code>çš„å¯ç”¨çš„æºç å·²ç»åœ¨Githubä¸Šï¼š<a href="https://github.com/frogermcs/Dagger2Recipes-UserScope" target="_blank" rel="noopener">Dagger 2 recipes - UserScope</a>ã€‚</p>
<p>æ„Ÿè°¢é˜…è¯»ï¼</p>
<h2 id="ä½œè€…"><a href="#ä½œè€…" class="headerlink" title="ä½œè€…"></a>ä½œè€…</h2><p><a href="http://about.me/froger_mcs" target="_blank" rel="noopener">Miroslaw Stanek</a></p>
<p>Head of Mobile Development @ <a href="https://azimo.com/" target="_blank" rel="noopener">Azimo</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092083.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092083.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - APIï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092525.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092525.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5095426.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5095426.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5098943.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5098943.html</a></p>
<blockquote>
<p><strong>[Android]Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5193437.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5193437.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producersï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6234811.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6234811.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6236646.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6236646.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6237731.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6237731.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®šï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6266442.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6266442.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> google </tag>
            
            <tag> dagger2 </tag>
            
            <tag> DI </tag>
            
            <tag> dependency injection </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2016/12/30/Android-%E5%9C%A8Dagger-2%E4%B8%AD%E4%BD%BF%E7%94%A8RxJava%E6%9D%A5%E8%BF%9B%E8%A1%8C%E5%BC%82%E6%AD%A5%E6%B3%A8%E5%85%A5%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="åœ¨Dagger-2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥"><a href="#åœ¨Dagger-2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥" class="headerlink" title="åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥"></a>åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="http://frogermcs.github.io/async-injection-in-dagger-2-with-rxjava" target="_blank" rel="noopener">http://frogermcs.github.io/async-injection-in-dagger-2-with-rxjava</a></p>
</blockquote>
<p>å‡ æ˜ŸæœŸå‰æˆ‘å†™äº†ä¸€ç¯‡å…³äºåœ¨Dagger 2ä¸­ä½¿ç”¨<em>Producers</em>è¿›è¡Œå¼‚æ­¥æ³¨å…¥çš„<a href="https://medium.com/@froger_mcs/dependency-injection-with-dagger-2-producers-c424ddc60ba3" target="_blank" rel="noopener">æ–‡ç« </a>ã€‚åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œå¯¹è±¡çš„åˆå§‹åŒ–åˆä¸€ä¸ªå¾ˆå¥½çš„ä¼˜åŠ¿ - å®ƒè´Ÿè´£å®æ—¶ï¼ˆ<a href="https://www.youtube.com/watch?v=CaMTIgxCSqU" target="_blank" rel="noopener">æ¯ç§’60å¸§</a>å¯ä»¥ä¿æŒç•Œé¢æµç•…ï¼‰ç»˜åˆ¶UIæ—¶ä¸ä¼šåœ¨ä¸»çº¿ç¨‹ä¸­é˜»å¡ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç¼“æ…¢çš„åˆå§‹åŒ–è¿‡ç¨‹å¹¶ä¸æ˜¯æ¯ä¸ªäººéƒ½ä¼šè§‰å¾—æ˜¯ä¸ªé—®é¢˜ã€‚ä½†æ˜¯å¦‚æœä½ çœŸçš„å…³å¿ƒè¿™ä¸ªï¼Œæ‰€æœ‰å¤–éƒ¨åº“åœ¨æ„é€ ä»¥åŠåœ¨ä»»ä½•<code>init()</code>æ–¹æ³•ä¸­è¿›è¡Œç£ç›˜/ç½‘ç»œçš„æ“ä½œä¼šå¾ˆå¸¸è§ã€‚å¦‚æœä½ ä¸èƒ½ç¡®å®šè¿™ä¸€ç‚¹ï¼Œæˆ‘å»ºè®®ä½ å°è¯•ä¸‹<a href="https://github.com/frogermcs/AndroidDevMetrics" target="_blank" rel="noopener">AndroidDevMetrics</a> - æˆ‘çš„Androidæ€§èƒ½æµ‹é‡åº“ã€‚å®ƒä¼šå‘Šè¯‰ä½ åœ¨appä¸­éœ€è¦èŠ±å¤šå°‘æ—¶é—´æ¥æ˜¾ç¤ºç‰¹å®šçš„ç•Œé¢ï¼Œè¿˜æœ‰ï¼ˆå¦‚æœä½ ä½¿ç”¨äº†Dagger 2ï¼‰åœ¨ä¾èµ–å›¾è¡¨ä¸­æä¾›æ¯ä¸ªå¯¹è±¡æ¶ˆè€—äº†å¤šå°‘æ—¶é—´ã€‚</p>
<p>ä¸å¹¸çš„æ˜¯Producerså¹¶ä¸æ˜¯ä¸ºAndroidè®¾è®¡çš„ï¼Œå®ƒæœ‰ä»¥ä¸‹ç¼ºé™·ï¼š</p>
<ul>
<li>ä¾èµ–ä½¿ç”¨äº†Guavaï¼ˆä¼šå¼•èµ·64kæ–¹æ³•é—®é¢˜ï¼Œå¢åŠ buildæ—¶é—´ï¼‰</li>
<li>å¹¶ä¸æ˜¯éå¸¸å¿«çš„ï¼ˆæ³¨å…¥æœºåˆ¶ä¼šé˜»å¡ä¸»çº¿ç¨‹å‡ æ¯«ç§’åˆ°å‡ åæ¯«ç§’çš„ä¸–ç•Œï¼Œè¿™å–å†³äºè®¾å¤‡ï¼‰</li>
<li>ä¸èƒ½ä½¿ç”¨@Injectæ³¨è§£ï¼ˆä»£ç ä¼šæœ‰ä¸€ç‚¹æ··ä¹±ï¼‰</li>
</ul>
<p>è™½ç„¶æˆ‘ä»¬ä¸èƒ½è§£å†³æœ€åä¸¤ä¸ªé—®é¢˜ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥åœ¨Android Projectä¸­è§£å†³ã€‚</p>
<h2 id="ä½¿ç”¨RxJavaè¿›è¡Œå¼‚æ­¥æ³¨å…¥"><a href="#ä½¿ç”¨RxJavaè¿›è¡Œå¼‚æ­¥æ³¨å…¥" class="headerlink" title="ä½¿ç”¨RxJavaè¿›è¡Œå¼‚æ­¥æ³¨å…¥"></a>ä½¿ç”¨RxJavaè¿›è¡Œå¼‚æ­¥æ³¨å…¥</h2><p>å¹¸è¿çš„æ˜¯ï¼Œæœ‰å¤§é‡çš„Androidå¼€å‘è€…ä½¿ç”¨äº†RxJavaï¼ˆå’Œ<a href="https://github.com/ReactiveX/RxAndroid" target="_blank" rel="noopener">RxAndroid</a>ï¼‰æ¥åœ¨æˆ‘ä»¬appä¸­ç¼–å†™å¼‚æ­¥ä»£ç ã€‚è®©æˆ‘ä»¬æ¥å°è¯•åœ¨Dagger 2ä¸­ä½¿ç”¨å®ƒæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ã€‚</p>
<h3 id="å¼‚æ­¥-Singletonæ³¨å…¥"><a href="#å¼‚æ­¥-Singletonæ³¨å…¥" class="headerlink" title="å¼‚æ­¥@Singletonæ³¨å…¥"></a>å¼‚æ­¥@Singletonæ³¨å…¥</h3><p>è¿™æ˜¯æˆ‘ä»¬ç¹é‡çš„å¯¹è±¡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Provides</span></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="function">HeavyExternalLibrary <span class="title">provideHeavyExternalLibrary</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    HeavyExternalLibrary heavyExternalLibrary = <span class="keyword">new</span> HeavyExternalLibrary();</span><br><span class="line">    heavyExternalLibrary.init(); <span class="comment">//This method takes about 500ms</span></span><br><span class="line">    <span class="keyword">return</span> heavyExternalLibrary;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨è®©æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªé¢å¤–çš„<code>provide...()</code>æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ª<code>Observable&lt;HeavyExternalLibrary&gt;</code>å¯¹è±¡ï¼Œå®ƒä¼šå¼‚æ­¥è°ƒç”¨ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Provides</span></span><br><span class="line"><span class="function">Observable&lt;HeavyExternalLibrary&gt; <span class="title">provideHeavyExternalLibraryObservable</span><span class="params">(<span class="keyword">final</span> Lazy&lt;HeavyExternalLibrary&gt; heavyExternalLibraryLazy)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Observable.create(<span class="keyword">new</span> Observable.OnSubscribe&lt;HeavyExternalLibrary&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber&lt;? <span class="keyword">super</span> HeavyExternalLibrary&gt; subscriber)</span> </span>&#123;</span><br><span class="line">            subscriber.onNext(heavyExternalLibraryLazy.get());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).subscribeOn(Schedulers.io()).observeOn(AndroidSchedulers.mainThread());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è®©æˆ‘ä»¬é€è¡Œæ¥åˆ†æï¼š</p>
<ul>
<li><code>@Singleton</code> - è®°ä½è¿™ä¸ªå¾ˆé‡è¦ï¼Œ<code>Observable</code>å¯¹è±¡å°†ä¼šæ˜¯ä¸€ä¸ªå•ä¾‹ï¼Œè€Œä¸æ˜¯<code>HeavyExternalLibrary</code>ã€‚Singletonä¹Ÿä¼šé˜»æ­¢åˆ›å»ºé¢å¤–çš„Observableå¯¹è±¡ã€‚</li>
<li><code>@Providers</code> - å› ä¸ºè¿™ä¸ªæ–¹æ³•æ˜¯<code>@Module</code>æ³¨è§£äº†çš„ç±»çš„ä¸€éƒ¨åˆ†ã€‚ä½ è¿˜è®°å¾—<a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-the-api/" target="_blank" rel="noopener">Dagger 2 API</a>å—ï¼Ÿ</li>
<li><code>Lazy&lt;HeavyExternalLibrary&gt; heavyExternalLibraryLazy</code>å¯¹è±¡é˜»æ­¢Daggerï¼ˆå¦åˆ™ï¼Œåœ¨è°ƒç”¨<code>provideHeavyExternalLibraryObservable()</code>æ–¹æ³•è°ƒç”¨çš„ç¬é—´å¯¹è±¡å°±ä¼šè¢«åˆ›å»ºï¼‰å†…éƒ¨å¯¹HeavyExternalLibraryå¯¹è±¡çš„åˆå§‹åŒ–ã€‚</li>
<li><code>Observable.create(...)</code>ä»£ç  - å®ƒå°†åœ¨æ¯æ¬¡è¿™ä¸ªObservableè¢«è®¢é˜…æ—¶é€šè¿‡è°ƒç”¨<code>heavyExternalLibraryLazy.get()</code>è¿”å›<code>heavyExternalLibrary</code>å¯¹è±¡ã€‚</li>
<li><code>.subscribeOn(Schedulers.io()).observeOn(AndroidSchedulers.mainThread());</code> - é»˜è®¤æƒ…å†µä¸‹RxJavaä»£ç ä¼šåœ¨Observableè¢«åˆ›å»ºçš„çº¿ç¨‹ä¸­æ‰§è¡Œã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦æŠŠæ‰§è¡Œç§»åŠ¨åˆ°åå°çº¿ç¨‹ï¼ˆè¿™é‡Œçš„<code>Schedulers.io()</code>ï¼‰ï¼Œç„¶ååœ¨ä¸»çº¿ç¨‹ä¸­ï¼ˆ<code>AndroidSchedulers.mainThread()</code>ï¼‰è§‚å¯Ÿç»“æœã€‚</li>
</ul>
<p>æˆ‘ä»¬çš„Observableåƒå›¾è¡¨ä¸­å…¶å®ƒå¯¹è±¡ä¸€æ ·è¢«æ³¨å…¥ï¼Œä½†æ˜¯<code>heavyExternalLibrary</code>å¯¹è±¡æœ¬èº«å°†ä¼šå»¶è¿Ÿä¸€ç‚¹æ‰å¯ç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SplashActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Inject</span></span><br><span class="line">	Observable&lt;HeavyExternalLibrary&gt; heavyExternalLibraryObservable;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//This will be injected asynchronously</span></span><br><span class="line">	HeavyExternalLibrary heavyExternalLibrary; </span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.onCreate();</span><br><span class="line">		<span class="comment">//...</span></span><br><span class="line">		heavyExternalLibraryObservable.subscribe(<span class="keyword">new</span> SimpleObserver&lt;HeavyExternalLibrary&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(HeavyExternalLibrary heavyExternalLibrary)</span> </span>&#123;</span><br><span class="line">	            <span class="comment">//Our dependency will be available from this moment</span></span><br><span class="line">	            SplashActivity.<span class="keyword">this</span>.heavyExternalLibrary = heavyExternalLibrary;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¼‚æ­¥æ–°å®ä¾‹çš„æ³¨å…¥"><a href="#å¼‚æ­¥æ–°å®ä¾‹çš„æ³¨å…¥" class="headerlink" title="å¼‚æ­¥æ–°å®ä¾‹çš„æ³¨å…¥"></a>å¼‚æ­¥æ–°å®ä¾‹çš„æ³¨å…¥</h3><p>ä¸Šé¢çš„ä»£ç å±•ç¤ºäº†æ€ä¹ˆå»æ³¨å…¥å•ä¾‹çš„å¯¹è±¡ã€‚é‚£å¦‚æœæˆ‘ä»¬æƒ³å¼‚æ­¥æ³¨å…¥æ–°çš„å®ä¾‹å‘¢ï¼Ÿ</p>
<p>ç¡®è®¤æˆ‘ä»¬çš„å¯¹è±¡ä¸å†ä½¿ç”¨äº†@Singletonæ³¨è§£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Provides</span></span><br><span class="line"><span class="function">HeavyExternalLibrary <span class="title">provideHeavyExternalLibrary</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    HeavyExternalLibrary heavyExternalLibrary = <span class="keyword">new</span> HeavyExternalLibrary();</span><br><span class="line">    heavyExternalLibrary.init(); <span class="comment">//This method takes about 500ms</span></span><br><span class="line">    <span class="keyword">return</span> heavyExternalLibrary;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬<code>Observable&lt;HeavyExternalLibrary&gt;</code> provideræ–¹æ³•ä¹Ÿä¼šæœ‰ä¸€ç‚¹æ”¹å˜ã€‚æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨<code>Lazy&lt;HeavyExternalLibrary&gt;</code>å› ä¸ºå®ƒåªä¼šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨<code>get()</code>æ–¹æ³•çš„æ—¶å€™ï¼ˆè¯¦è§<a href="http://google.github.io/dagger/api/latest/dagger/Lazy.html" target="_blank" rel="noopener">Lazyæ–‡æ¡£</a>ï¼‰æ‰ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ã€‚</p>
<p>è¿™é‡Œæ˜¯æ›´æ–°åçš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Provides</span></span><br><span class="line"><span class="function">Observable&lt;HeavyExternalLibrary&gt; <span class="title">provideHeavyExternalLibraryObservable</span><span class="params">(<span class="keyword">final</span> Provider&lt;HeavyExternalLibrary&gt; heavyExternalLibraryProvider)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Observable.create(<span class="keyword">new</span> Observable.OnSubscribe&lt;HeavyExternalLibrary&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber&lt;? <span class="keyword">super</span> HeavyExternalLibrary&gt; subscriber)</span> </span>&#123;</span><br><span class="line">            subscriber.onNext(heavyExternalLibraryProvider.get());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).subscribeOn(Schedulers.io()).observeOn(AndroidSchedulers.mainThread());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çš„<code>Observable&lt;HeavyExternalLibrary&gt;</code>å¯ä»¥æ˜¯ä¸€ä¸ªå•ä¾‹ï¼Œï¼Œä½†æ˜¯æ¯ä¸€æ¬¡æˆ‘ä»¬å»è°ƒç”¨å®ƒçš„subscribe()æ–¹æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†ä¼šåœ¨onNext()æ–¹æ³•ä¸­å¾—åˆ°ä¸€ä¸ªæ–°çš„<code>HeavyExternalLibrary</code>å®ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">heavyExternalLibraryObservable.subscribe(<span class="keyword">new</span> SimpleObserver&lt;HeavyExternalLibrary&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(HeavyExternalLibrary heavyExternalLibrary)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//New instance of HeavyExternalLibrary</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="å®Œå…¨çš„å¼‚æ­¥æ³¨å…¥"><a href="#å®Œå…¨çš„å¼‚æ­¥æ³¨å…¥" class="headerlink" title="å®Œå…¨çš„å¼‚æ­¥æ³¨å…¥"></a>å®Œå…¨çš„å¼‚æ­¥æ³¨å…¥</h3><p>è¿˜æœ‰å¦ä¸€ä¸ªæ–¹æ³•æ˜¯ç”¨RxJavaåœ¨Dagger 2ä¸­è¿›è¡Œå¼‚æ­¥æ³¨å…¥ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Observableç®€å•å°è£…æ•´ä¸ªæ³¨å…¥è¿‡ç¨‹ã€‚</p>
<p>æˆ‘ä»¬æ³¨å…¥çš„æ‰§è¡Œæ˜¯è¿™æ ·çš„ï¼ˆä»£ç æ‘˜è‡ª<a href="https://github.com/frogermcs/GithubClient/" target="_blank" rel="noopener">GithubClient</a>é¡¹ç›®ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SplashActivity</span> <span class="keyword">extends</span> <span class="title">BaseActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    SplashActivityPresenter presenter;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    AnalyticsManager analyticsManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//This method is called in super.onCreate() method</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setupActivityComponent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> SplashActivityComponent splashActivityComponent = GithubClientApplication.get(SplashActivity.<span class="keyword">this</span>)</span><br><span class="line">                .getAppComponent()</span><br><span class="line">                .plus(<span class="keyword">new</span> SplashActivityModule(SplashActivity.<span class="keyword">this</span>));</span><br><span class="line">        splashActivityComponent.inject(SplashActivity.<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¦è®©å®ƒå˜æˆå¼‚æ­¥æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨Observableå°è£…<code>setupActivityComponent()</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setupActivityComponent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Observable.create(<span class="keyword">new</span> Observable.OnSubscribe&lt;Object&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber&lt;? <span class="keyword">super</span> Object&gt; subscriber)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">final</span> SplashActivityComponent splashActivityComponent = GithubClientApplication.get(SplashActivity.<span class="keyword">this</span>)</span><br><span class="line">                    .getAppComponent()</span><br><span class="line">                    .plus(<span class="keyword">new</span> SplashActivityModule(SplashActivity.<span class="keyword">this</span>));</span><br><span class="line">            splashActivityComponent.inject(SplashActivity.<span class="keyword">this</span>);</span><br><span class="line">            subscriber.onCompleted();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">            .subscribeOn(Schedulers.io())</span><br><span class="line">            .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">            .subscribe(<span class="keyword">new</span> SimpleObserver&lt;Object&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    <span class="comment">//Here is the moment when injection is done.</span></span><br><span class="line">                    analyticsManager.logScreenView(getClass().getName());</span><br><span class="line">                    presenter.callAnyMethod();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚æ³¨é‡Šï¼Œæ‰€æœ‰<code>@Inject</code>æ³¨è§£äº†çš„å¯¹è±¡å°†è¢«æœªæ¥æŸä¸€æ—¶åˆ»æ³¨å…¥ã€‚åœ¨è¿”å›æ³¨å…¥è¿‡ç¨‹æ˜¯å¼‚æ­¥çš„å¹¶ä¸”ä¸ä¼šå¯¹ä¸»çº¿ç¨‹æœ‰å¾ˆå¤§çš„å½±å“ã€‚</p>
<p>å½“ç„¶åˆ›å»º<code>Observable</code>å¯¹è±¡å’Œé¢å¤–<code>subscribeOn()</code>çº¿ç¨‹å¹¶ä¸æ˜¯å®Œå…¨å…è´¹çš„ - å®ƒå°†ä¼šèŠ±è´¹ä¸€ç‚¹æ—¶é—´ã€‚è¿™ç±»ä¼¼äº<strong>Producers</strong>ä»£ç æ‰€äº§ç”Ÿçš„å½±å“ã€‚</p>
<p><img src="http://frogermcs.github.io/images/26/splash_metrics.png" alt=""></p>
<p>æ„Ÿè°¢é˜…è¯»ï¼</p>
<h2 id="ä½œè€…"><a href="#ä½œè€…" class="headerlink" title="ä½œè€…"></a>ä½œè€…</h2><p><a href="http://about.me/froger_mcs" target="_blank" rel="noopener">Miroslaw Stanek</a></p>
<p>Head of Mobile Development @ <a href="https://azimo.com/" target="_blank" rel="noopener">Azimo</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092083.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092083.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - APIï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092525.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092525.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5095426.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5095426.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5098943.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5098943.html</a></p>
<blockquote>
<p><strong>[Android]Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5193437.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5193437.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producersï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6234811.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6234811.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6236646.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6236646.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6237731.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6237731.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®šï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6266442.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6266442.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> google </tag>
            
            <tag> dagger2 </tag>
            
            <tag> DI </tag>
            
            <tag> dependency injection </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> RxJava </tag>
            
            <tag> RxAndroid </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producersï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2016/12/29/Android-%E4%BD%BF%E7%94%A8Dagger-2%E8%BF%9B%E8%A1%8C%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-Producers%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="ä½¿ç”¨Dagger-2è¿›è¡Œä¾èµ–æ³¨å…¥-Producers"><a href="#ä½¿ç”¨Dagger-2è¿›è¡Œä¾èµ–æ³¨å…¥-Producers" class="headerlink" title="ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producers"></a>ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producers</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-producers/" target="_blank" rel="noopener">http://frogermcs.github.io/dependency-injection-with-dagger-2-producers/</a></p>
</blockquote>
<p>æœ¬æ–‡æ˜¯åœ¨Androidä¸­ä½¿ç”¨Dagger 2æ¡†æ¶è¿›è¡Œä¾èµ–æ³¨å…¥çš„ç³»åˆ—æ–‡ç« ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ä»Šå¤©æˆ‘ä»¬å°†æ¢ç´¢ä¸‹Dagger Producers - ä½¿ç”¨Javaå®ç°å¼‚æ­¥ä¾èµ–æ³¨å…¥çš„Dagger2çš„ä¸€ä¸ªæ‰©å±•ã€‚</p>
<h2 id="åˆå§‹åŒ–æ€§èƒ½é—®é¢˜"><a href="#åˆå§‹åŒ–æ€§èƒ½é—®é¢˜" class="headerlink" title="åˆå§‹åŒ–æ€§èƒ½é—®é¢˜"></a>åˆå§‹åŒ–æ€§èƒ½é—®é¢˜</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“Dagger 2æ˜¯ä¸€ä¸ªä¼˜åŒ–å¾—å¾ˆå¥½çš„ä¾èµ–æ³¨å…¥æ¡†æ¶ã€‚ä½†æ˜¯å³ä½¿æœ‰è¿™äº›å…¨éƒ¨çš„å¾®ä¼˜åŒ–ï¼Œä»ç„¶åœ¨ä¾èµ–æ³¨å…¥çš„æ—¶å€™å­˜åœ¨å¯èƒ½çš„æ€§èƒ½é—®é¢˜ - â€œç¬¨é‡â€çš„ç¬¬ä¸‰æ–¹åº“å’Œ/æˆ–æˆ‘ä»¬é‚£äº›ä¸»çº¿ç¨‹é˜»å¡çš„ä»£ç ã€‚</p>
<p>ä¾èµ–æ³¨å…¥æ˜¯åœ¨å°½å¯èƒ½çŸ­çš„æ—¶é—´å†…åœ¨æ­£ç¡®çš„åœ°æ–¹ä¼ é€’æ‰€è¯·æ±‚çš„ä¾èµ–çš„è¿‡ç¨‹ - è¿™äº›éƒ½æ˜¯Dagger 2åšå¾—å¾ˆå¥½çš„ã€‚ä½†æ˜¯DIä¹Ÿä¼šå»åˆ›å»ºå„ç§ä¾èµ–ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦èŠ±è´¹å‡ ç™¾æ¯«ç§’åˆ›å»ºå®ƒä»¬ï¼Œé‚£ä¹ˆä»¥çº³ç§’çº§çš„æ—¶é—´å»æä¾›ä¾èµ–è¿˜æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ</p>
<p>å½“æˆ‘ä»¬çš„appåˆ›å»ºäº†ä¸€ç³»åˆ—ç¹é‡çš„å•ä¾‹å¹¶ç«‹å³ç”±Dagger2æä¾›æœåŠ¡ä¹‹åä¹Ÿè®¸å¯èƒ½æ²¡æœ‰è¿™ä¹ˆé‡è¦ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬åˆ›å»ºå®ƒä»¬çš„æ—¶å€™ä»ç„¶éœ€è¦ä¸€ä¸ªæ—¶é—´æˆæœ¬ - å¤§å¤šæ•°æƒ…å†µä¸‹å†³å®šäº†appå¯åŠ¨çš„æ—¶é—´ã€‚</p>
<p>è¿™é—®é¢˜ï¼ˆå·²ç»ç»™äº†æç¤ºæ€ä¹ˆå»è°ƒé€‚å®ƒï¼‰å·²ç»åœ¨æˆ‘ä¹‹å‰çš„ä¸€ç¯‡åšå®¢ä¸­æè¿°åœ°å¾ˆè¯¦ç»†äº†ï¼š<a href="http://frogermcs.github.io/dagger-graph-creation-performance/" target="_blank" rel="noopener">Dagger 2 - graph creation performance</a>ã€‚</p>
<p>åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…ï¼Œè®©æˆ‘ä»¬æƒ³è±¡è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ - ä½ çš„appæœ‰ä¸€ä¸ªåˆå§‹åŒ–çš„ç•Œé¢ï¼ˆSplashScreenï¼‰ï¼Œéœ€è¦åœ¨appå¯åŠ¨åç«‹å³åšä¸€äº›éœ€è¦çš„äº‹æƒ…ï¼š</p>
<ul>
<li>åˆå§‹åŒ–æ‰€æœ‰tracking libsï¼ˆGoole Analytics, Crashlyticsï¼‰ç„¶åå‘é€ç¬¬ä¸€ä»½æ•°æ®ç»™å®ƒä»¬ã€‚</li>
<li>åˆ›å»ºç”¨äºAPIå’Œ/æˆ–æ•°æ®åº“é€šä¿¡çš„æ•´ä¸ªæ ˆã€‚</li>
<li>æˆ‘ä»¬è¯•å›¾çš„äº¤äº’é€»è¾‘ï¼ˆMVPä¸­çš„Presentersï¼ŒMVVMä¸­çš„ViewModelsç­‰ç­‰ï¼‰ã€‚</li>
</ul>
<p>å³ä½¿æˆ‘ä»¬çš„ä»£ç æ˜¯ä¼˜åŒ–åœ°éå¸¸å¥½çš„ï¼Œä½†æ˜¯ä»ç„¶æœ‰å¯èƒ½æœ‰äº›é¢å¤–çš„åº“éœ€è¦å‡ åæˆ–è€…å‡ ç™¾æ¯«ç§’çš„æ—¶é—´æ¥åˆå§‹åŒ–ã€‚åœ¨æˆ‘ä»¬å¯åŠ¨ç•Œé¢ä¹‹å‰å°†å±•ç¤ºå¿…é¡»åˆå§‹åŒ–å’Œäº¤ä»˜çš„æ‰€æœ‰è¯·æ±‚çš„ä¾èµ–ï¼ˆå’Œå®ƒä»¬çš„ä¾èµ–ï¼‰ã€‚è¿™æ„å‘³ç€å¯åŠ¨æ—¶é—´å°†ä¼šæ˜¯å®ƒä»¬æ¯ä¸€ä¸ªåˆå§‹åŒ–æ—¶é—´çš„æ€»å’Œã€‚</p>
<p>ç”± <a href="https://github.com/frogermcs/androiddevmetrics" target="_blank" rel="noopener">AndroidDevMetrics</a> æµ‹é‡çš„ç¤ºä¾‹å †æ ˆå¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://frogermcs.github.io/images/24/example_dependencies.png" alt=""></p>
<p>ç”¨æˆ·å°†ä¼šåœ¨600msï¼ˆï¼‹é¢å¤–çš„ç³»ç»Ÿworkï¼‰å†…çœ‹åˆ°SplashActivity - æ‰€æœ‰åˆå§‹åŒ–æ—¶é—´çš„æ€»å’Œã€‚</p>
<h2 id="Producers-å¼‚æ­¥ä¾èµ–æ³¨å…¥"><a href="#Producers-å¼‚æ­¥ä¾èµ–æ³¨å…¥" class="headerlink" title="Producers - å¼‚æ­¥ä¾èµ–æ³¨å…¥"></a>Producers - å¼‚æ­¥ä¾èµ–æ³¨å…¥</h2><p>Dagger 2 æœ‰ä¸€ä¸ªåä¸º <strong>Producers</strong> çš„æ‰©å±•ï¼Œæˆ–å¤šæˆ–å°‘èƒ½ä¸ºæˆ‘ä»¬è§£å†³è¿™äº›é—®é¢˜ã€‚</p>
<p>æ€è·¯å¾ˆç®€å• - æ•´ä¸ªåˆå§‹åŒ–æµç¨‹å¯ä»¥åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªåå°çº¿ç¨‹ä¸­è¢«æ‰§è¡Œï¼Œç„¶åå»¶åå†äº¤ä»˜ç»™appçš„ä¸»çº¿ç¨‹ã€‚</p>
<h4 id="ProducerModule"><a href="#ProducerModule" class="headerlink" title="@ProducerModule"></a>@ProducerModule</h4><p>ç±»ä¼¼äº<code>@Module</code>ï¼Œè¿™ä¸ªè¢«ç”¨æ¥æ ‡è®°ç”¨äºä¼ é€’ä¾èµ–çš„ç±»ã€‚å¤šäºäºå®ƒï¼ŒDaggerå°†ä¼šçŸ¥é“å»å“ªé‡Œæ‰¾åˆ°è¢«è¯·æ±‚çš„ä¾èµ–ã€‚</p>
<h4 id="Produces"><a href="#Produces" class="headerlink" title="@Produces"></a>@Produces</h4><p>ç±»ä¼¼äº<code>@Provide</code>ï¼Œè¿™ä¸ªæ³¨è§£ç”¨æ¥æ ‡è®°å¸¦æœ‰<code>@ProducerModule</code>æ³¨è§£çš„ç±»ä¸­çš„è¿”å›ä¾èµ–çš„æ–¹æ³•ã€‚<code>@Produces</code>æ³¨è§£çš„æ–¹æ³•å¯ä»¥è¿”å›<code>ListenableFuture&lt;T&gt;</code>æˆ–è€…è‡ªèº«çš„å¯¹è±¡ï¼ˆä¹Ÿä¼šåœ¨æ‰€ç»™çš„åå°çº¿ç¨‹ä¸­è¿›è¡Œåˆå§‹åŒ–ï¼‰ã€‚</p>
<h4 id="ProductionComponent"><a href="#ProductionComponent" class="headerlink" title="@ProductionComponent"></a>@ProductionComponent</h4><p>ç±»ä¼¼äº<code>@Component</code>ï¼Œå®ƒè´Ÿè´£ä¾èµ–çš„ä¼ é€’ã€‚å®ƒæ˜¯æˆ‘ä»¬ä»£ç ä¸<code>@ProducerModule</code>ä¹‹é—´çš„æ¡¥æ¢ã€‚å”¯ä¸€è·Ÿ<code>@Component</code>çš„ä¸åŒä¹‹å¤„æ˜¯æˆ‘ä»¬ä¸èƒ½å†³å®šä¾èµ–çš„scopeã€‚è¿™æ„å‘³ç€æä¾›ç»™ <em>component</em> çš„æ¯ä¸€ä¸ª <em>Produces æ–¹æ³•</em> åœ¨ <em>æ¯ä¸ªcomponent å®ä¾‹</em> ä¸­æœ€å¤šåªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œä¸ç®¡å®ƒä½œä¸ºä¸€ä¸ª <em>ä¾èµ–</em> ç”¨äºå¤šå°‘æ¬¡ç»‘å®šã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸€ä¸ªæœåŠ¡äº<code>@ProductionComponent</code>çš„å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªå•ä¾‹ï¼ˆåªè¦æˆ‘ä»¬ä»è¿™ä¸ªç‰¹æ®Šçš„componentä¸­è·å–ï¼‰ã€‚</p>
<hr>
<p>Producersçš„æ–‡æ¡£å·²ç»è¶³å¤Ÿè¯¦ç»†äº†ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰å¿…è¦å»æ‹·è´åˆ°è¿™é‡Œã€‚ç›´æ¥çœ‹ï¼š<a href="http://google.github.io/dagger/producers.html" target="_blank" rel="noopener">Dagger 2 Producers docs</a>ã€‚</p>
<h3 id="Producersçš„ä»£ä»·"><a href="#Producersçš„ä»£ä»·" class="headerlink" title="Producersçš„ä»£ä»·"></a>Producersçš„ä»£ä»·</h3><p>åœ¨æˆ‘ä»¬å¼€å§‹å®è·µå‰ï¼Œæœ‰ä¸€äº›å€¼å¾—æé†’çš„äº‹æƒ…ã€‚Producersç›¸æ¯”Dagger 2æœ¬èº«æœ‰ä¸€ç‚¹æ›´å¤æ‚ã€‚å®ƒçœ‹èµ·æ¥æ‰‹æœºç«¯appä¸æ˜¯ä»–ä»¬å®ƒä»¬ä¸»è¦ä½¿ç”¨çš„ç›®æ ‡ï¼Œè€Œä¸”çŸ¥é“è¿™äº›äº‹æƒ…å¾ˆé‡è¦ï¼š</p>
<ul>
<li>Producersä½¿ç”¨äº†Guavaåº“ï¼Œå¹¶ä¸”å»ºç«‹åœ¨ListenableFutureç±»ä¹‹ä¸Šã€‚è¿™æ„å‘³ç€ä½ ä¸å¾—ä¸å¤„ç†15kçš„é¢å¤–æ–¹æ³•åœ¨ä½ çš„appä¸­ã€‚è¿™å¯èƒ½å¯¼è‡´ä½ ä¸å¾—ä¸ä½¿ç”¨<em>Proguard</em>æ¥å¤„ç†å¹¶ä¸”éœ€è¦ä¸€ä¸ªæ›´é•¿çš„ç¼–è¯‘æ—¶é—´ã€‚</li>
<li>å°±å¦‚ä½ å°†çœ‹åˆ°çš„ï¼Œåˆ›å»º<code>ListenableFutures</code>å¹¶ä¸æ˜¯æ²¡æœ‰æˆæœ¬çš„ã€‚æ‰€ä»¥å¦‚æœä½ æŒ‡æœ›Producersä¼šå¸®ä½ ä»10msä¼˜åŒ–åˆ°0msé‚£ä½ å¯èƒ½å°±é”™äº†ã€‚ä½†æ˜¯å¦‚æœè§„æ¨¡æ›´å¤§ï¼ˆ100ms â€“&gt; 10msï¼‰ï¼Œä½ å°±èƒ½æœ‰æ‰€å‘ç°ã€‚</li>
<li>ç°åœ¨æ— æ³•ä½¿ç”¨<code>@Inject</code>æ³¨è§£ï¼Œæ‰€ä»¥ä½ å¿…é¡»è¦æ‰‹åŠ¨å¤„ç†ProductionComponentsã€‚å®ƒä¼šä½¿å¾—ä½ çš„æ ‡å‡†æ•´æ´çš„ä»£ç å˜å¾—æ··ä¹±ã€‚</li>
</ul>
<p><a href="http://stackoverflow.com/questions/35617378/injects-after-produces" target="_blank" rel="noopener">è¿™é‡Œ</a>ä½ å¯ä»¥é’ˆå¯¹<code>@Inject</code>æ³¨è§£æ‰¾åˆ°å¥½çš„é—´æ¥çš„è§£å†³æ–¹æ¡ˆçš„å°è¯•ã€‚</p>
<h2 id="Example-app"><a href="#Example-app" class="headerlink" title="Example app"></a>Example app</h2><p>å¦‚æœä½ ä»ç„¶å¸Œæœ›ä½¿ç”¨Producersæ¥å¤„ç†ï¼Œé‚£å°±è®©æˆ‘ä»¬æ›´æ–° <a href="https://github.com/frogermcs/GithubClient/" target="_blank" rel="noopener">GithubClient</a> è¿™ä¸ªappä½¿å¾—å®ƒåœ¨æ³¨å…¥è¿‡ç¨‹ä½¿ç”¨Producersã€‚åœ¨å®ç°ä¹‹å‰å’Œä¹‹åæˆ‘ä»¬å°†ä¼šä½¿ç”¨ <a href="https://github.com/frogermcs/androiddevmetrics" target="_blank" rel="noopener">AndroidDevMetrics</a> æ¥æµ‹é‡å¯åŠ¨æ—¶é—´å’Œå¯¹æ¯”ç»“æœã€‚</p>
<p><a href="https://github.com/frogermcs/GithubClient/tree/1c14683691e0e7af17b26055a0fd041d4a7df424" target="_blank" rel="noopener">è¿™é‡Œ</a>æ˜¯ä¸€ä¸ªåœ¨ä½¿ç”¨producersæ›´æ–°ä¹‹å‰çš„ GithubClient appçš„ç‰ˆæœ¬ã€‚å¹¶ä¸”å®ƒæµ‹é‡çš„å¹³å‡å¯åŠ¨æ—¶é—´å¦‚ä¸‹ï¼š</p>
<p><img src="http://frogermcs.github.io/images/24/before_update.png" alt=""></p>
<p>æˆ‘ä»¬çš„è®¡åˆ’æ˜¯å¤„ç†UserManagerè®©å®ƒçš„æ‰€æœ‰çš„ä¾èµ–æ¥è‡ªProducersã€‚</p>
<h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>æˆ‘ä»¬å°†ç»™ä¸€ä¸ªDagger v2.1çš„å°è¯•ï¼ˆä½†æ˜¯å½“å‰2.0ç‰ˆæœ¬çš„Producersä¹Ÿæ˜¯å¯ç”¨çš„ï¼‰ã€‚</p>
<p>è®©æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­åŠ å…¥ä¸€ä¸ªDaggeræ–°çš„ç‰ˆæœ¬ï¼š</p>
<p><strong><em>app/build.gradleï¼š</em></strong></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.android.application'</span></span><br><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.neenbedankt.android-apt'</span></span><br><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.frogermcs.androiddevmetrics'</span></span><br><span class="line"></span><br><span class="line">repositories &#123;</span><br><span class="line">    maven &#123;</span><br><span class="line">        url <span class="string">"https://oss.sonatype.org/content/repositories/snapshots"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//Dagger 2</span></span><br><span class="line">    compile <span class="string">'com.google.dagger:dagger:2.1-SNAPSHOT'</span></span><br><span class="line">    compile <span class="string">'com.google.dagger:dagger-producers:2.1-SNAPSHOT'</span></span><br><span class="line">    apt <span class="string">'com.google.dagger:dagger-compiler:2.1-SNAPSHOT'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä½ æ‰€è§ï¼ŒProducers ä½œä¸ºä¸€ä¸ªæ–°çš„ä¾èµ–ï¼Œåœ¨dagger 2åº“çš„ä¸‹é¢ã€‚è¿˜æœ‰å€¼å¾—ä¸€è¯´çš„æ˜¯Dagger v2.1ç»ˆäºä¸éœ€è¦<code>org.glassfish:javax.annotation:10.0-b28</code>çš„ä¾èµ–äº†ã€‚</p>
<h3 id="Producer-Module"><a href="#Producer-Module" class="headerlink" title="Producer Module"></a>Producer Module</h3><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç§»åŠ¨ä»£ç ä»<code>GithubApiModule</code>åˆ°æ–°åˆ›å»ºçš„<code>GithubApiProducerModule</code>ä¸­ã€‚åŸæ¥çš„ä»£ç å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š<a href="https://github.com/frogermcs/GithubClient/blob/1c14683691e0e7af17b26055a0fd041d4a7df424/app/src/main/java/frogermcs/io/githubclient/data/api/GithubApiModule.java" target="_blank" rel="noopener">GithubApiModule</a></p>
<p><strong><em>GithubApiProducerModule.java</em></strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ProducerModule</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GithubApiProducerModule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Produces</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> OkHttpClient <span class="title">produceOkHttpClient</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> OkHttpClient.Builder builder = <span class="keyword">new</span> OkHttpClient.Builder();</span><br><span class="line">        <span class="keyword">if</span> (BuildConfig.DEBUG) &#123;</span><br><span class="line">            HttpLoggingInterceptor logging = <span class="keyword">new</span> HttpLoggingInterceptor();</span><br><span class="line">            logging.setLevel(HttpLoggingInterceptor.Level.BODY);</span><br><span class="line">            builder.addInterceptor(logging);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        builder.connectTimeout(<span class="number">60</span> * <span class="number">1000</span>, TimeUnit.MILLISECONDS)</span><br><span class="line">                .readTimeout(<span class="number">60</span> * <span class="number">1000</span>, TimeUnit.MILLISECONDS);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> builder.build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Produces</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Retrofit <span class="title">produceRestAdapter</span><span class="params">(Application application, OkHttpClient okHttpClient)</span> </span>&#123;</span><br><span class="line">        Retrofit.Builder builder = <span class="keyword">new</span> Retrofit.Builder();</span><br><span class="line">        builder.client(okHttpClient)</span><br><span class="line">                .baseUrl(application.getString(R.string.endpoint))</span><br><span class="line">                .addCallAdapterFactory(RxJavaCallAdapterFactory.create())</span><br><span class="line">                .addConverterFactory(GsonConverterFactory.create());</span><br><span class="line">        <span class="keyword">return</span> builder.build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Produces</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> GithubApiService <span class="title">produceGithubApiService</span><span class="params">(Retrofit restAdapter)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> restAdapter.create(GithubApiService.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Produces</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserManager <span class="title">produceUserManager</span><span class="params">(GithubApiService githubApiService)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> UserManager(githubApiService);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Produces</span></span><br><span class="line">    <span class="keyword">public</span> UserModule.<span class="function">Factory <span class="title">produceUserModuleFactory</span><span class="params">(GithubApiService githubApiService)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> UserModule.Factory(githubApiService);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥å¾ˆåƒï¼Ÿæ²¡é”™ï¼Œæˆ‘ä»¬åªæ˜¯ä¿®æ”¹äº†ï¼š</p>
<ul>
<li><code>@Module</code> æ”¹ä¸º <code>@ProducerModule</code></li>
<li><code>@Provides @Singleton</code> æ”¹ä¸º <code>@Produces</code>ã€‚<em>ä½ è¿˜è®°å¾—å—ï¼Ÿåœ¨Producersä¸­æˆ‘ä»¬é»˜è®¤å°±æœ‰ä¸€ä¸ªå•ä¾‹</em></li>
</ul>
<p><code>UserModule.Factory</code> ä¾èµ–åªæ˜¯å› ä¸ºappçš„é€»è¾‘åŸå› è€Œæ·»åŠ ã€‚</p>
<h2 id="Production-Component"><a href="#Production-Component" class="headerlink" title="Production Component"></a>Production Component</h2><p>ç°åœ¨è®©æˆ‘ä»¬åˆ›å»º<code>@ProductionComponent</code>ï¼Œå®ƒå°†ä¼šä¸º<code>UserManager</code>å®ä¾‹æä¾›æœåŠ¡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ProductionComponent</span>(</span><br><span class="line">        dependencies = AppComponent.class,</span><br><span class="line">        modules = GithubApiProducerModule.class</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AppProductionComponent</span> </span>&#123;</span><br><span class="line">    <span class="function">ListenableFuture&lt;UserManager&gt; <span class="title">userManager</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    ListenableFuture&lt;UserModule.Factory&gt; userModuleFactory();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆä¸€æ¬¡ï¼Œéå¸¸ç±»ä¼¼åŸæ¥çš„<a href="https://github.com/frogermcs/GithubClient/blob/master/app/src/main/java/frogermcs/io/githubclient/AppComponent.java" target="_blank" rel="noopener">Daggerâ€™s @Component</a>ã€‚</p>
<p>ProductionComponentçš„æ„å»ºä¹Ÿæ˜¯ä¸æ ‡å‡†çš„Componentéå¸¸ç›¸ä¼¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AppProductionComponent appProductionComponent = DaggerAppProductionComponent.builder()</span><br><span class="line">    .executor(Executors.newSingleThreadExecutor())</span><br><span class="line">    .appComponent(appComponent)</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure>
<p>é¢å¤–é™„åŠ çš„å‚æ•°æ˜¯<code>Executor</code>å®ä¾‹ï¼Œå®ƒå‘Šè¯‰ProductionComponentä¾èµ–åº”è¯¥åœ¨å“ªé‡Œï¼ˆå“ªä¸ªçº¿ç¨‹ï¼‰è¢«åˆ›å»ºã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªsingle-thread executorï¼Œä½†æ˜¯å½“ç„¶å¢åŠ å¹¶è¡Œçº§åˆ«å¹¶ä½¿ç”¨å¤šçº¿ç¨‹æ‰§è¡Œä¸æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚</p>
<h2 id="è·å–ä¾èµ–"><a href="#è·å–ä¾èµ–" class="headerlink" title="è·å–ä¾èµ–"></a>è·å–ä¾èµ–</h2><p>å°±åƒæˆ‘è¯´çš„ï¼Œå½“å‰æˆ‘ä»¬ä¸èƒ½å»ä½¿ç”¨<code>@Inject</code>æ³¨è§£ã€‚ç›¸åï¼Œæˆ‘ä»¬å¿…é¡»ç›´æ¥è¯¢é—®ProductionComponentï¼ˆä½ å¯ä»¥åœ¨<a href="https://github.com/frogermcs/GithubClient/blob/master/app/src/main/java/frogermcs/io/githubclient/ui/activity/presenter/SplashActivityPresenter.java" target="_blank" rel="noopener">SplashActivityPresenter</a>æ‰¾åˆ°è¿™äº›ä»£ç ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">appProductionComponent = splashActivity.getAppProductionComponent();</span><br><span class="line">Futures.addCallback(appProductionComponent.userManager(), <span class="keyword">new</span> FutureCallback&lt;UserManager&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(UserManager result)</span> </span>&#123;</span><br><span class="line">        SplashActivityPresenter.<span class="keyword">this</span>.userManager = result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span><span class="params">(Throwable t)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé‡è¦çš„æ˜¯ï¼Œå¯¹è±¡åˆå§‹åŒ–æ˜¯åœ¨ä½ ç¬¬ä¸€æ¬¡è°ƒç”¨<code>appProductionComponent.userManager()</code>çš„æ—¶å€™å¼€å§‹çš„ã€‚åœ¨è¿™ä¹‹å<code>UserManager</code>å¯¹è±¡å°†ä¼šè¢«ç¼“å­˜ã€‚è¿™è¡¨ç¤ºæ¯ä¸€ä¸ªç»‘å®šéƒ½æ‹¥æœ‰è·Ÿcomponentå®ä¾‹ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<p>ä»¥ä¸Šå‡ ä¹å°±æ˜¯æ‰€æœ‰äº†ã€‚å½“ç„¶ä½ åº”è¯¥çŸ¥é“åœ¨<code>Future.onSuccess()</code>æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰userManagerå®ä¾‹ä¼šæ—¶<code>null</code>ã€‚</p>
<h2 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h2><p>åœ¨æœ€åè®©æˆ‘ä»¬æ¥çœ‹ä¸‹ç°åœ¨æ³¨å…¥çš„æ€§èƒ½æ˜¯æ€ä¹ˆæ ·çš„ï¼š</p>
<p><img src="http://frogermcs.github.io/images/24/after_update.png" alt=""></p>
<p>æ˜¯çš„ï¼Œæ²¡é”™ - è¿™æ—¶å¹³å‡å€¼å¤§çº¦æ˜¯15msã€‚å®ƒå°äºåŒæ­¥æ³¨å…¥ï¼ˆå¹³å‡. 25msï¼‰ä½†æ˜¯å¹¶ä¸å¦‚ä½ æœŸæœ›çš„é‚£æ ·å°‘ã€‚è¿™æ—¶å› ä¸ºProducerså¹¶ä¸åƒDaggeræœ¬èº«é‚£æ ·è½»é‡ã€‚</p>
<p>æ‰€ä»¥ç°åœ¨å–å†³äºä½ äº† - æ˜¯å¦å€¼å¾—ä½¿ç”¨Guava, Proguardå’Œä»£ç å¤æ‚åº¦æ¥åš<strong>è¿™ç§</strong>ä¼˜åŒ–ã€‚</p>
<p>è¯·è®°ä½ï¼Œå¦‚æœä½ è§‰å¾—Producerså¹¶ä¸æ˜¯æœ€é€‚åˆä½ çš„appçš„ï¼Œä½ å¯ä»¥åœ¨ä½ çš„appä¸­å°è¯•ä½¿ç”¨RxJavaæˆ–è€…å…¶ä»–å¼‚æ­¥ä»£ç æ¥åŒ…è£…ä½ çš„æ³¨å…¥ã€‚</p>
<p>æ„Ÿè°¢é˜…è¯»ï¼</p>
<h3 id="ä»£ç ï¼š"><a href="#ä»£ç ï¼š" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h3><p>ä»¥ä¸Šæè¿°çš„å®Œæ•´ä»£ç å¯è§Github <a href="https://github.com/frogermcs/GithubClient" target="_blank" rel="noopener">repository</a>ã€‚</p>
<h2 id="ä½œè€…"><a href="#ä½œè€…" class="headerlink" title="ä½œè€…"></a>ä½œè€…</h2><p><a href="http://about.me/froger_mcs" target="_blank" rel="noopener">Miroslaw Stanek</a></p>
<p>Head of Mobile Development @ <a href="https://azimo.com/" target="_blank" rel="noopener">Azimo</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092083.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092083.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - APIï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092525.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092525.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5095426.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5095426.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5098943.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5098943.html</a></p>
<blockquote>
<p><strong>[Android]Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5193437.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5193437.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producersï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6234811.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6234811.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6236646.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6236646.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6237731.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6237731.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®šï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6266442.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6266442.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> google </tag>
            
            <tag> dagger2 </tag>
            
            <tag> DI </tag>
            
            <tag> dependency injection </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM(v2.1)]]></title>
      <url>/2016/11/01/Android-Android%E7%AB%AFORM%E6%A1%86%E6%9E%B6%E2%80%94%E2%80%94RapidORM-v2-1/</url>
      <content type="html"><![CDATA[<h1 id="Android-Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM-v2-1"><a href="#Android-Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM-v2-1" class="headerlink" title="[Android]Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM(v2.1)"></a>[Android]Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM(v2.1)</h1><p><strong><a href="https://github.com/wangjiegulu/RapidORM" target="_blank" rel="noopener">RapidORM</a>ï¼šAndroidç«¯è½»é‡é«˜æ€§èƒ½çš„ORMæ¡†æ¶</strong></p>
<p><strong>GitHub:</strong> <a href="https://github.com/wangjiegulu/RapidORM" target="_blank" rel="noopener">https://github.com/wangjiegulu/RapidORM</a></p>
<h2 id="RapidORM-v2-1-feature"><a href="#RapidORM-v2-1-feature" class="headerlink" title="RapidORM v2.1 feature"></a>RapidORM v2.1 feature</h2><p>1. åœ¨æ‰§è¡ŒSQLå’Œåˆ›å»ºè¡¨æ—¶æå‡æ€§èƒ½ã€‚</p>
<p>2. æå‡bindå‚æ•°æ—¶çš„æ€§èƒ½</p>
<p>3. Indexæ”¯æŒã€‚</p>
<p>4. ä¸Šä¼ è‡³Mavenä¸­å¿ƒåº“ã€‚</p>
<h2 id="å…³äº-RapidORM"><a href="#å…³äº-RapidORM" class="headerlink" title="å…³äº RapidORM"></a>å…³äº RapidORM</h2><ul>
<li><p>ä¸»é”®æ”¯æŒä»»ä½•ç±»å‹ï¼Œæ”¯æŒè”åˆä¸»é”®ã€‚</p>
</li>
<li><p>éåå°„æ‰§è¡ŒSQLã€‚</p>
</li>
<li><p>é«˜æ€§èƒ½ã€‚</p>
</li>
<li><p>å…¼å®¹ <code>android.database.sqlite.SQLiteDatabase</code>ã€ <code>net.sqlcipher.database.SQLiteDatabase</code>ä»¥åŠæ›´å¤šåŠ å¯†å®ç°ã€‚</p>
</li>
<li><p>å‹å¥½çš„é¢å‘å¯¹è±¡æ¥å£è°ƒç”¨ã€‚</p>
</li>
<li><p>Indexæ”¯æŒã€‚</p>
</li>
<li><p>è”è¡¨æŸ¥è¯¢æœªæ”¯æŒã€‚</p>
</li>
</ul>
<p><code>v2.0</code> blog: <a href="http://www.cnblogs.com/tiantianbyconan/p/5626716.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5626716.html</a></p>
<p><code>v1.0</code> blog: <a href="http://www.cnblogs.com/tiantianbyconan/p/4748077.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4748077.html</a></p>
<h2 id="æ€ä¹ˆä½¿ç”¨"><a href="#æ€ä¹ˆä½¿ç”¨" class="headerlink" title="æ€ä¹ˆä½¿ç”¨"></a>æ€ä¹ˆä½¿ç”¨</h2><h3 id="1-build-gradle-æ·»åŠ ä¾èµ–"><a href="#1-build-gradle-æ·»åŠ ä¾èµ–" class="headerlink" title="1. build.gradle æ·»åŠ ä¾èµ–"></a>1. <code>build.gradle</code> æ·»åŠ ä¾èµ–</h3><h3 id="Gadle-è·å–æœ€æ–°ç‰ˆæœ¬"><a href="#Gadle-è·å–æœ€æ–°ç‰ˆæœ¬" class="headerlink" title="Gadle(è·å–æœ€æ–°ç‰ˆæœ¬)"></a>Gadle(<a href="http://search.maven.org/#search%7Cga%7C1%7CRapidORM" target="_blank" rel="noopener">è·å–æœ€æ–°ç‰ˆæœ¬</a>)</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">compile <span class="string">"com.github.wangjiegulu:rapidorm:x.x.x"</span></span><br><span class="line"></span><br><span class="line">compile <span class="string">"com.github.wangjiegulu:rapidorm-api:x.x.x"</span></span><br><span class="line"></span><br><span class="line">apt <span class="string">"com.github.wangjiegulu:rapidorm-compiler:x.x.x"</span></span><br></pre></td></tr></table></figure>
<h3 id="Maven-è·å–æœ€æ–°ç‰ˆæœ¬"><a href="#Maven-è·å–æœ€æ–°ç‰ˆæœ¬" class="headerlink" title="Maven(è·å–æœ€æ–°ç‰ˆæœ¬)"></a>Maven(<a href="http://search.maven.org/#search%7Cga%7C1%7CRapidORM" target="_blank" rel="noopener">è·å–æœ€æ–°ç‰ˆæœ¬</a>)</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.wangjiegulu<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>rapidorm<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>x.x.x<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…·ä½“ä½¿ç”¨æ–¹å¼è§ï¼š</p>
<blockquote>
<p><code>v2.0</code> blog: <a href="http://www.cnblogs.com/tiantianbyconan/p/5626716.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5626716.html</a></p>
<p><code>v1.0</code> blog: <a href="http://www.cnblogs.com/tiantianbyconan/p/4748077.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4748077.html</a></p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> orm </tag>
            
            <tag> rapidorm </tag>
            
            <tag> library </tag>
            
            <tag> database </tag>
            
            <tag> sqlite </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä½¿ç”¨MVPè§£å†³æŠ€æœ¯å€ºåŠ¡ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2016/09/21/Android-%E4%BD%BF%E7%94%A8MVP%E8%A7%A3%E5%86%B3%E6%8A%80%E6%9C%AF%E5%80%BA%E5%8A%A1%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="ä½¿ç”¨MVPè§£å†³æŠ€æœ¯å€ºåŠ¡"><a href="#ä½¿ç”¨MVPè§£å†³æŠ€æœ¯å€ºåŠ¡" class="headerlink" title="ä½¿ç”¨MVPè§£å†³æŠ€æœ¯å€ºåŠ¡"></a>ä½¿ç”¨MVPè§£å†³æŠ€æœ¯å€ºåŠ¡</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://medium.com/picnic-engineering/tackling-technical-debt-with-mvp-67e805ed5103#.couu0d5i0" target="_blank" rel="noopener">https://medium.com/picnic-engineering/tackling-technical-debt-with-mvp-67e805ed5103#.couu0d5i0</a></p>
</blockquote>
<p>å…è´£ç”³æ˜ï¼šè¿™ç¯‡åšå®¢å¹¶ä¸æ˜¯è®²å…³äºæ€ä¹ˆä½¿ç”¨MVPçš„æ–¹å¼ï¼ˆä¸Šå¸çŸ¥é“å…³äºè¿™äº›å·²ç»å¤ªå¤šäº†ï¼‰å»å†™Androidä»£ç ã€‚è€Œä»…ä»…æ˜¯æˆ‘çš„ä¸ªäººç»éªŒï¼Œå…³äºæ€ä¹ˆè½¬æ¢æˆ‘ä»¬çš„è¡¨ç°å±‚åˆ°MVPæ¶æ„æ¥å¸®åŠ©æˆ‘ä»¬è§£å†³ä¸€äº›ç´¯ç§¯çš„æŠ€æœ¯å€ºåŠ¡ï¼Œè€Œä¸”åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿä¼šå¸®åŠ©æˆ‘ä»¬çš„appä»ä¸€ä¸ªåŸå‹è½¬å˜æˆä¸€ä¸ªæ›´å…·ç»´æŠ¤æ€§çš„äº§å“ã€‚</p>
<p>ä»»ä½•ä»äº‹Androidå·¥ä½œè¶³å¤Ÿä¹…ã€é¡¹ç›®è¶³å¤Ÿå¤§çš„å¼€å‘è€…æœ€æœ‰å¯èƒ½è¾¾åˆ°ä¸€ä¸ªç‚¹ï¼Œä»–ä»¬é¢å¯¹ä»–ä»¬çš„ä»£ç åº“ï¼Œè§‰å¾—åº”è¯¥æœ‰æ›´å¥½çš„å®ç°æ–¹æ¡ˆã€‚æˆ‘ä»¬åœ¨Picnicä¹Ÿæ˜¯ä¸€æ ·ï¼Œåœ¨Android appå¼€å‘å¼€å§‹åå¤§çº¦å…«ä¸ªæœˆï¼Œæˆ‘ä»¬åˆ°è¾¾äº†çš„é‚£ä¸€åˆ»ï¼Œå°±åœ¨æˆ‘ä»¬å‘å…¬ä¼—å‘å¸ƒç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„æ—¶å€™ã€‚</p>
<p>è¿™ä¸€åˆ»æ­£å¥½æ˜¯åœ¨æˆ‘ä»¬appæ¨å‡ºçš„æ—¶å€™è¿™ä¹Ÿå¹¶ä¸æ„å¤–ã€‚ç›´åˆ°é‚£æ—¶ï¼Œæˆ‘ä»¬ä»¥ä¸€ä¸ªéå¸¸å¿«çš„é€Ÿåº¦åœ¨å‰è¿›ï¼Œä¸æ–­æ•²æ‰“æˆ‘ä»¬çš„é”®ç›˜ï¼Œä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªå®Œæ•´çš„äº§å“ï¼Œå°è¯•æ–°çš„ä¸œè¥¿ï¼Œç»“åˆç”¨æˆ·åé¦ˆåˆ°æˆ‘ä»¬çš„appä¸­ï¼Œåœ¨æ¯å¤©çš„åŸºç¡€ä¸Šå¢åŠ å’Œä¸¢å¼ƒç‰¹æ€§ã€‚</p>
<p>ä¸ºäº†è·Ÿä¸Šå…¬å¸çš„é€Ÿåº¦æˆ‘ä»¬ç æ‰äº†è¿™é‡Œé‚£é‡Œçš„è¾¹è¾¹è§’è§’ã€‚è¿™æ ·çš„å·¥ä½œå¯¹æˆ‘ä»¬æ¥è¯´å¾ˆå¥½ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬èƒ½å¤Ÿåœ¨è¿™ä¹ˆçŸ­çš„æ—¶é—´å†…æ„å»ºè¿™ä¸ªappçš„åŸå› ä¹‹ä¸€ã€‚ä½†æ˜¯æ­£å¦‚é¢„æœŸé‚£æ ·ï¼Œæœ€åè¿™äº›å†³å®šçš„å½±å“å¼€å§‹ä»¥æŠ€æœ¯å€ºåŠ¡çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ã€‚å¹¸è¿çš„æ˜¯è¿™äº›æŠ€æœ¯å€ºåŠ¡æ˜¯åœ¨æ•°æœˆä¹‹å†…å»ºç«‹çš„ï¼Œåœ¨appçš„æ€§èƒ½å’Œç¨³å®šæ€§ä¸Šé¢å¹¶æ²¡æœ‰ä»»ä½•çœŸæ­£çš„å½±å“ã€‚åè€Œæˆ‘ä»¬æ˜¯åœ¨å…¶å®ƒé¢†åŸŸå¼€å§‹æ³¨æ„åˆ°å®ƒï¼š</p>
<ul>
<li>æ–°åŠŸèƒ½è¿­ä»£æ—¶é—´çš„å¢åŠ ã€‚</li>
<li>æ–°å…¥èŒçš„å¼€å‘è€…é‡åˆ°å›°éš¾</li>
<li>å®ƒè¢«è¯å®éš¾ä»¥å®ç°è‡ªåŠ¨åŒ–æµ‹è¯•</li>
<li>æ•´ä½“åŠŸèƒ½çš„å¤æ‚æ€§åœ¨å¢åŠ </li>
</ul>
<p>æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªå¾ˆå¥½çš„æƒ³æ³•å’Œä¸€ä¸ªæ˜“äºç†è§£çš„æ¶æ„ï¼Œç”¨äºç½‘ç»œå±‚ã€é”™è¯¯å¤„ç†å’Œappå†…éƒ¨æ¨¡å—é€šä¿¡ã€‚ä½†æ˜¯åƒå¤§å¤šæ•°Androidå¼€å‘è€…ï¼Œæˆ‘ä»¬ä¼šå¯¹æŠŠå¤ªå¤šçš„é€»è¾‘æ”¾è¿›Activityå’ŒFragmentä¸­ä¼šäº§ç”Ÿå†…ç–šã€‚</p>
<p>æ—æ³¨ï¼šè¿™æ˜¯Androidå¼€å‘è€…çš„å…±åŒçš„é—®é¢˜ï¼Œè€Œä½œä¸ºå¼€å‘è€…éœ€è¦åœ¨é»‘æš—ä¸­æ‘¸ç´¢ï¼Œå› ä¸ºGoogleå¯¹è¿™ä¸ªè¯é¢˜ä¿æŒæ²‰é»˜ã€‚æˆ‘ä»¬ä»å®ƒä»¬é‚£é‡Œå¾—åˆ°çš„ç¬¬ä¸€ä¸ªï¼ˆç®—æ˜¯ï¼‰å®˜æ–¹å›å¤æ˜¯æ¥è‡ªAndroidå›¢é˜Ÿçš„ä¸€ä¸ªå¼€å‘è€…åœ¨ <a href="https://plus.google.com/+DianneHackborn/posts/FXCCYxepsDU" target="_blank" rel="noopener">Google+ post</a>ï¼Œè¯´æ˜æˆ‘ä»¬åº”è¯¥æŠŠæ ¸å¿ƒçš„Android APIä½œä¸ºä¸€ä¸ªâ€˜ç³»ç»Ÿæ¡†æ¶â€™ï¼Œæ„å‘³ç€ä»–ä»¬ä¼šå¸¦æˆ‘ä»¬æ‰‹æŠŠæ‰‹åœ°åˆ°è¾¾Androidæ ¸å¿ƒçš„ç»„ä»¶ï¼ˆActivity, BroadcastReceiver, Service å’Œ ContentProviderï¼‰ã€‚ä¹‹åæˆ‘ä»¬åšä»€ä¹ˆéƒ½æ˜¯çœ‹æˆ‘ä»¬è‡ªå·±äº†ã€‚è€Œä¸”å°±åœ¨æœ€è¿‘ï¼ŒGoogleç»ˆäºæä¾›äº†ä¸€ç³»åˆ—çš„ä¾‹å­ç”¨æ¥è§£å†³å…³äºæ€ä¹ˆæ„å»ºä¸€ä¸ªAndroid appçš„å…±åŒé—®é¢˜ï¼Œå®ƒç€é‡äºMVPã€‚å°½ç®¡åªæ˜¯betaï¼Œä½†æ˜¯å®ƒå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ï¼š<a href="https://github.com/googlesamples/android-architecture" target="_blank" rel="noopener">Android Architecture Blueprints</a>ã€‚</p>
<p>æ— è®ºå¦‚ä½•ï¼Œè¿™å…¶å®æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œå› ä¸ºè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥è‡ªç”±åœ°å»å®éªŒä»»ä½•æˆ‘ä»¬å–œæ¬¢çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯è¢«å¼ºåˆ¶åœ¨ä¸€ä¸ªå¹³å°éµå¾ªä¸€ä¸ªç‰¹å®šçš„æ¨¡å¼ã€‚</p>
<p>ç°åœ¨è®²å›æˆ‘ä»¬çš„æ•…äº‹â€¦ é™¤éä½ å¤„åœ¨Androidå¼€å‘ä¸–ç•Œçš„è¿œå¤æ—¶æœŸï¼Œä½ åº”è¯¥ä¼šæ³¨æ„åˆ°è¡¨ç°å±‚æ¶æ„æ˜¯ç°åœ¨çš„çƒ­é—¨ã€‚å…³äºæœ€å¥½çš„æ–¹å¼æ˜¯ä»€ä¹ˆï¼Œæ¯ä¸ªäººç”šè‡³è¿ä»–å¦ˆå¦ˆä¼¼ä¹éƒ½æœ‰è‡ªå·±çš„è§‚ç‚¹ã€‚å·¥ä½œä¸­æ ‡å‡†çš„Androidæ–¹å¼ï¼ˆç±»ä¼¼MVCï¼‰ï¼Œåˆ°MVPï¼Œåˆ°é€šè¿‡data-bindingçš„MVVMï¼Œæ‰€æœ‰çš„æ–¹å¼éƒ½æ²¿ç”¨äº† Uncle Bob çš„ <em>clean architecture</em>ã€‚æ¯ä¸€ç§æ–¹å¼å›´ç»•èµæˆæˆ–è€…åå¯¹çš„æ„è§éƒ½æœ‰ä¸€äº›æœ‰è¶£çš„è®¨è®ºï¼Œä½†æ˜¯æœ‰ä¸€ä»¶äº‹æˆ‘ä»¬è¦æ˜ç¡®çŸ¥é“ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬åº”è¯¥é¿å…å–Kool-Aid<em>ï¼ˆè¯‘è€…æ³¨ï¼šè¿™é‡Œæ˜¯æ¯”å–»ï¼Œè¡¨ç¤ºéå¸¸æ„šæ˜§åœ°æ¥å—ä¿¡å¥‰æŸç§è§‚ç‚¹æˆ–è€…æ€æƒ³ï¼‰</em>å’ŒæœŸæœ›å…¶ä¸­ä¸€ç§æ˜¯é“¶è‰²å­å¼¹<em>ï¼ˆè¯‘è€…æ³¨ï¼šè¿™é‡Œæ˜¯æ¯”å–»ä¸ºå…·æœ‰æç«¯æœ‰æ•ˆæ€§çš„è§£å†³æ–¹æ³•ï¼‰</em>ç„¶åæ°¸è¿œè§£å†³æ‰€æœ‰é—®é¢˜ã€‚</p>
<p>å½“åœ¨è€ƒè™‘æ€ä¹ˆå»é‡æ„æˆ‘ä»¬çš„è¡¨ç°å±‚æ—¶ï¼Œæˆ‘ä»¬å·²ç»æœ‰è¿‘ä¸€å¹´çš„ä»£ç åº“çš„ç§¯ç´¯ï¼Œæˆ‘ä»¬å¾ˆæ¸…æ¥šæˆ‘ä»¬çš„ç¼ºé™·åœ¨å“ªé‡Œï¼Œç„¶åæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ–°çš„å®ç°ï¼ˆä»¥ä¸Šä¸»è¦è¡¨ç¤ºä¸€äº›èƒ½å¤Ÿè§£å†³æˆ‘ä»¬çš„æŠ€æœ¯å€ºåŠ¡çš„ç‚¹ï¼‰æ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®æ ‡ã€‚æˆ‘ä»¬åœ¨è™šæ‹Ÿçš„é¡¹ç›®ä¸­è¯•ç©äº†ä¸€äº›ï¼Œä½“éªŒäº†å„ç§æ–¹æ³•çš„ä¸åŒä¹‹å¤„ï¼Œç„¶åæœ€ç»ˆå†³å®šä½¿ç”¨MVPã€‚ä»å®ƒçš„æ ¸å¿ƒæ¥è¯´ï¼ŒMVPæœ¬èº«ä»…ä»…æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œè€ŒAndroidæ¡†æ¶ï¼Œæ ¹æ®è®¾è®¡ï¼Œå¹¶ä¸å¼ºåˆ¶ä»»ä½•æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±åœ°é€‰æ‹©å®é™…çš„å®ç°ç»†èŠ‚ã€‚</p>
<p>åœ¨Androidå›¢é˜Ÿä¸­ï¼Œé¦–å…ˆæˆ‘ä»¬æ˜¯ä¸è¿‡åº¦å·¥ç¨‹çš„ä¿¡å¾’ï¼Œè®©ä»£ç éšç€æ—¶é—´çš„æ¨ç§»è‡ªç„¶åœ°å‘å±•ï¼Œè€Œä¸æ˜¯è¿‡æ—©åœ°åœ¨è¯•å›¾ä¸ºè‡ªå·±ä¸å¯é¢„çŸ¥çš„æœªæ¥åšå‡†å¤‡çš„æŠ½è±¡ä¹‹ä¸Šå¢åŠ æŠ½è±¡ã€‚æ­£å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬é€‰æ‹©å¦ä¸€é£å‘³çš„MVPï¼Œä½¿å¾—å¯ä»¥æœ€ä½é™åº¦åœ°ä¿æŒæˆ‘ä»¬çš„æŠ½è±¡å±‚æ¬¡ã€‚åœ¨ä»£ç çº§åˆ«ï¼Œè¿™æ„å‘³ç€æœ‰ä¸€ä¸ªå•ç‹¬çš„æ¥å£æ¥è¡¨ç¤ºViewã€‚æ‰€æœ‰å…¶å®ƒçš„ç»„ä»¶éƒ½æ˜¯å…·ä½“çš„ç±»ã€‚ä½ å¯èƒ½ä¼šé—®è‡ªå·±ï¼Œæ€ä¹ˆä¼šåªæœ‰Viewä½¿ç”¨æ¥å£ï¼Ÿè€ƒè™‘åˆ°æˆ‘ä»¬è¿«åˆ‡çš„éœ€è¦ï¼Œè¿™æ˜¯çœŸæ­£å—ç›Šäºè¿™æ ·çš„æ¥å£çš„å”¯ä¸€çš„ç»„ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬å®é™…ä¸Šæœ‰ä¸åŒçš„å…·ä½“çš„Viewsæ¥å…±äº«ç›¸åŒçš„æ¥å£ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œè¿™é‡Œçš„ä¸€ä¸ªæ¥å£å°†è¢«å…è®¸æˆ‘ä»¬å»é‡ç”¨Presentersã€‚ä¸€äº›MVPå®ç°å»ºè®®ç»™æ‰€æœ‰ç»„ä»¶ï¼ˆMï¼ŒVå’ŒPï¼‰è®¾ç½®æ¥å£ã€‚å°½ç®¡è¿™æ ·ä¼šå·¥ä½œå¾—å¾ˆå®Œç¾ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨è¾ƒæ—©çš„é˜¶æ®µå¹¶ä¸æå€¡ï¼Œå› ä¸ºæ·»åŠ ä¹‹åçš„æˆæœ¬æ˜¯ä»£ç å¯è¯»æ€§å’Œç»´æŠ¤æ€§ï¼Œå°¤å…¶æ˜¯å½“æˆ‘ä»¬è€ƒè™‘åˆ°æ–°å…¥èŒå¯¹MVPé™Œç”Ÿçš„åˆçº§å¼€å‘è€…çš„æ—¶å€™ï¼Œå¥½å¤„è¶…è¿‡é¢å‘æ¥å£ç¼–ç¨‹çš„æ–¹å¼ã€‚</p>
<p>ç›¸æ¯”å…¶ä»–ï¼ŒMVPå®ç°æ˜¯éå¸¸æ ‡å‡†çš„ã€‚Viewï¼ˆActivityï¼ŒFragmentæˆ–è€…ä¸€ä¸ªè‡ªå®šä¹‰Viewï¼‰è´Ÿè´£åˆ›é€ å’Œç»´æŠ¤Presenterï¼Œè€ŒPresenterå¤„ç†å„ç§ä¸šåŠ¡ç›¸å…³çš„é€»è¾‘ï¼ˆæ•°æ®è·å–ï¼Œå­˜å‚¨ï¼Œæ ¼å¼åŒ–ç­‰ç­‰ï¼‰ï¼Œç„¶åæ ¹æ®éœ€è¦é€šè¿‡æ›´æ–°UIå›è°ƒåˆ°Viewã€‚åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œæ•°æ®å±‚å·²ç»æ˜¯ç›¸å½“æ¨¡å—åŒ–äº†ï¼Œæ„é€ ç”¨äºè¡¨ç¤ºæ•°æ®æ¨¡å‹çš„POJOsï¼Œä»¥åŠä¸€ä¸ªé¢„å…ˆå­˜åœ¨çš„æ§åˆ¶å±‚ç”¨äºå¤„ç†ç½‘ç»œé€šä¿¡ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªéå¸¸æ ‡å‡†çš„MVPè®¾ç½®ï¼Œä¹Ÿå› ä¸ºå®ƒå¾ˆç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‡ å‘¨çš„æ—¶é—´å†…æ›¿æ¢å‡ ä¹æˆ‘ä»¬çš„æ‰€æœ‰çš„UIä»£ç ã€‚å› ä¸ºæˆ‘ä»¬å·²ç»å­˜åœ¨ç‹¬ç«‹çš„æ•°æ®å±‚æ¥å¤„ç†æ‰€æœ‰ä¸åç«¯çš„APIäº¤äº’ï¼Œæ‰€ä»¥çœŸæ­£éœ€è¦é‡æ„çš„åªæ˜¯Viewså’ŒPresentersçš„äº¤äº’ã€‚</p>
<p>åœ¨é‡æ„çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå­¦ä¹ äº†ä¸€äº›å¯èƒ½ä¼šæ´¾å¾—ä¸Šç”¨åœºçš„ä¸œè¥¿ï¼š</p>
<ul>
<li><p><strong>ç”Ÿå‘½å‘¨æœŸï¼š</strong>å› ä¸ºPresenteræ˜¯Viewåˆ›å»ºçš„ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å®Œå…¨åœ°ç†è§£Viewçš„ç”Ÿå‘½å‘¨æœŸï¼Œç‰¹åˆ«æ˜¯å› ä¸ºå®ƒå°†æœ€æœ‰å¯èƒ½å»å¤„ç†çŠ¶æ€æ›´æ–°å’Œå¼‚æ­¥æ•°æ®ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯ä¸€ä¸ªPresenteråº”è¯¥åœ¨View destroyedçš„æƒ…å†µä¸‹æœ‰ä¸€ä¸ªå–æ¶ˆå¼‚æ­¥ä»»åŠ¡çš„æ–¹å¼ï¼Œæˆ–è€…åº”è¯¥åœ¨ç”¨æˆ·æš‚åœæˆ–è€…æ¢å¤è§†å›¾äº‹ä»¶æ—¶é‡ç½®åˆ°åŸå§‹çŠ¶æ€ç­‰ç­‰ã€‚æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œå½“Viewå·²ç»è¢«é”€æ¯ï¼Œè¯•å›¾ä»Presenterå»æ›´æ–°Viewå…ƒç´ ï¼Œå§‹ç»ˆéœ€è¦æ³¨æ„å¯æ€•çš„NPEsã€‚</p>
</li>
<li><p><strong>ä¿æŒViewså°½å¯èƒ½åœ°æ„šè ¢ï¼š</strong>æˆ‘ä»¬çš„Viewsåº”è¯¥ä¸å†åŒ…å«ä»»ä½•ä¸šåŠ¡ç›¸å…³çš„é€»è¾‘ã€‚å®ƒåº”è¯¥åªåŒ…å«Androidæ¡†æ¶inflateå’Œè®¾ç½®Viewçš„è¿™äº›æœ€ä½é™åº¦çš„ä¸œè¥¿ã€‚ä»»ä½•ç”¨æˆ·äº¤äº’åº”è¯¥æ´¾å‘åˆ°Presenterã€‚æ ¹æ®ç»éªŒï¼Œå¦‚æœä½ çš„viewsæœ‰ä»»ä½•å…¶å®ƒæ–¹æ³•å»æ›´æ–°UIå…ƒç´ æˆ–è€…å“åº”ç”¨æˆ·è§¦å‘çš„äº‹ä»¶ï¼Œé‚£ä¹ˆä½ å¯èƒ½åº”è¯¥å»æ£€æŸ¥å®ƒä»¬çš„å®ç°ã€‚</p>
</li>
<li><p><strong>ä¿æŒPresenterå°½å¯èƒ½åœ°çº¯ç²¹ï¼š</strong>è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬çš„æ„æ€æ—¶ä½ åº”è¯¥å°½å¯èƒ½åœ°é¿å…æœ‰Androidç›¸å…³çš„ä»£ç åœ¨ä½ çš„presentersä¸­ã€‚ä¸ºè¿™äº›ç»„ä»¶ç¼–å†™çº¯ç²¹çš„å•å…ƒæµ‹è¯•ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨å…¶å®ƒå¦‚Robolectricç­‰æµ‹è¯•æ¡†æ¶ï¼Œè¿™æ˜æ˜¾åœ°å¾—åˆ°äº†ç®€åŒ–ã€‚è¿™æ˜æ˜¾è¯´èµ·æ¥æ¯”åšèµ·æ¥å®¹æ˜“å¾—å¤šï¼Œå› ä¸ºä½ ç»ˆå½’ä¼šåœ¨æŸäº›åœ°æ–¹é‡åˆ°è¿™ç§æƒ…å†µï¼Œä¸¾ä¸ªä¾‹å­ï¼Œä½ å°†éœ€è¦æœ‰ä¸€ä¸ªContextçš„å¼•ç”¨ç”¨æ¥æ¯”å¦‚æ•°æ®åŠ è½½ã€è®¿é—®stringsæ–‡ä»¶ç­‰ç­‰ã€‚</p>
</li>
</ul>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>é‚£ä¹ˆï¼Œè¯´äº†é‚£ä¹ˆå¤šï¼Œæœ€ç»ˆçš„ç»“è®ºæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ€»çš„æ¥è¯´ï¼Œæˆ‘å¾ˆé«˜å…´ä½¿ç”¨äº†MVPã€‚å®ƒä¸€å®šç¨‹åº¦ä¸Šå¸®æˆ‘ä»¬è§£å†³äº†æˆ‘ä»¬å¿«é€Ÿå¼€å‘æ‰€ç´¯ç§¯çš„æŠ€æœ¯å€ºåŠ¡ï¼Œç„¶åï¼Œæˆ‘ä»¬å‡†å¤‡äº†æ›´å¤šæ¥é’ˆå¯¹ç¬¬äºŒé˜¶æ®µçš„å¼€å‘ã€‚</p>
<p>ä¸€äº›å€¼å¾—ä¸€æçš„äº‹æƒ…ï¼š</p>
<ul>
<li><p><strong>æµ‹è¯•æ•°ï¼š</strong>åœ¨é‡æ„ä¹‹å‰ï¼Œæµ‹è¯•çš„æ•°é‡ç”¨ä¸¤åªæ‰‹éƒ½å¯ä»¥æ•°å¾—è¿‡æ¥ã€‚è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„ä»»åŠ¡æ¥é’ˆå¯¹åŒ…å«äº†æ‰€æœ‰é€»è¾‘å¦‚æ‰§è¡Œæ•°æ®è§£æã€æ ¼å¼åŒ–ã€ç½‘ç»œè¯·æ±‚ã€é”™è¯¯å¤„ç†å’Œç®¡ç†è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸçš„Activityç¼–å†™æµ‹è¯•ã€‚ä»…æ€è€ƒå¦‚æœåœ¨è¿™äº›æ¡ä»¶ä¸‹ç¼–å†™æµ‹è¯•å°±è¶³ä»¥è®©æˆ‘ä»¬å»å¯»æ‰¾å…¶å®ƒçš„æ–¹å¼äº†ã€‚ä¸€æ—¦è½¬æ¢æˆ‘ä»¬çš„ç¬¬ä¸€ä»½ä»£ç åˆ°MVPï¼Œå¯¹æ­¤ç¼–å†™æµ‹è¯•å°±å˜å¾—ç¢ç‰‡åŒ–äº†ã€‚é€šè¿‡ä¸€ä¸ªæ¸…æ™°çš„åˆåŒæ˜ç¡®ä»€ä¹ˆViewèƒ½å¤Ÿå¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè‡ªå·±çš„ä»£ç ä¸Android UIæ¡†æ¶éš”ç¦»å¼€ï¼Œç„¶åä»…ä»…æµ‹è¯•å®é™…è°ƒç”¨çš„æ˜¯å¦æ˜¯æ­£ç¡®çš„æ–¹æ³•ï¼Œå¹¶ç»™å‡ºæ¯ä¸ªæµ‹è¯•åœºæ™¯ã€‚ç°åœ¨å®é™…çš„ä¸šåŠ¡ç›¸å…³é€»è¾‘è¢«æ”¾ç½®åœ¨Presentersä¸­ï¼Œå› ä¸ºå®ƒä»¬ç»å¤§å¤šæ•°éƒ½ä¸éœ€è¦æœ‰Android OSç›¸å…³çš„è®¤çŸ¥ï¼ˆæˆ–è€…å°éƒ¨åˆ†ç›¸å…³çš„å¯ä»¥è¢«mockedï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é’ˆå¯¹å®ƒä»¬ç¼–å†™éå¸¸æœ‰æ•ˆç‡çš„å•å…ƒæµ‹è¯•ï¼Œå› æ­¤ï¼Œåœ¨è¿‡å»å‡ ä¸ªæœˆé‡Œï¼Œæˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹ä»åŸæ¥çš„10å¢åŠ åˆ°900ï¼Œè€Œä¸”è¿˜åœ¨å¢é•¿ä¸­ã€‚</p>
</li>
<li><p><strong>å¯é¢„è§æ€§ï¼š</strong>è¿™ä¸ªæ˜¯æœ‰ä¸€ç‚¹è½¯åº¦é‡ï¼Œä½†æ˜¯éå¸¸å¼ºå¤§çš„ä¸€ç‚¹ã€‚é’ˆå¯¹UIï¼Œæˆ‘ä»¬é€‰æ‹©å¹¶åšæŒä¸€ä¸ªé€šç”¨çš„æ¨¡å¼ï¼Œæˆ‘å¯ä»¥åœ¨ä»£ç åº“ä¸­è·å¾—å¯é¢„è§çš„å¥½å¤„ã€‚è¿™æ„å‘³ç€ï¼Œæ— è®ºæ˜¯å“ªç§å¼€å‘è€…çœ¼é‡Œçš„UIå…ƒç´ ï¼ˆActivityï¼ŒDialogï¼ŒFragmentç­‰ç­‰ï¼‰ï¼Œå¦‚æœç†è§£å…¶ä¸­ä¸€ä¸ªæ€ä¹ˆå·¥ä½œï¼Œé‚£ä¹Ÿå°±èƒ½ç†è§£æ‰€æœ‰æ€ä¹ˆå·¥ä½œã€‚æ‰“å¼€ä¸€ä¸ªå°±ç®—ä¸æ˜¯ä½ å†™çš„æ–‡ä»¶ä¹Ÿä¸å†ä¼šé‡åˆ°è®©ä½ è§‰å¾—æƒŠå–œçš„ä¸œè¥¿äº†ã€‚æ˜ç¡®è§„å®šèŒè´£ï¼Œæ¯ä¸€å•ä¸ªçš„UIç»„ä»¶éƒ½éµå¾ªç›¸åŒçš„æ˜ç¡®çš„æ¨¡å¼ã€‚è®©æ–°å…¥èŒçš„æ–°å¼€å‘è€…ä»ç¬¬ä¸€å¤©èµ·å°±æ˜¯é«˜æ•ˆçš„ï¼Œè¿™æ˜¯éå¸¸å®è´µçš„ã€‚</p>
</li>
</ul>
<p>æˆ‘ä»¬åˆ«å¿˜è®°MVPå¹¶ä¸åªæ˜¯ç”¨äºè¡¨ç°å±‚ï¼Œä½†æ˜¯ä½œä¸ºå‰ç«¯å¼€å‘äººå‘˜ï¼Œè¿™é‡ŒèŠ±è´¹äº†æˆ‘ä»¬å¤ªå¤šçš„æ—¶é—´ã€‚æ‰€ä»¥åŠªåŠ›å»å¯»æ‰¾ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥ç»™æˆ‘ä»¬å¸¦æ¥æ›´å¥½çš„å¯é¢„è§æ€§å’Œåœ¨æ–°çš„å¼€å‘è€…åŠ å…¥æˆ‘ä»¬çš„æ—¶å€™ä¹Ÿèƒ½è®©æˆ‘ä»¬å¿«é€Ÿè¿­ä»£æ˜¯å€¼å¾—çš„ã€‚ç»è¿‡å…¨é¢çš„è€ƒè™‘ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰æŠŠæ¡åœ°è¯´MVPæ˜¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¾¾åˆ°è¿™ä¸ªç›®æ ‡çš„ä¸€ä¸ªé‡è¦çš„é‡Œç¨‹ç¢‘ã€‚</p>
<p>P.S. å¦‚æœä½ ä»ç„¶æ¸´æœ›çœ‹åˆ°ä¸€äº›æºä»£ç ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæˆ‘ä»¬MVPå®ç°â€˜å¿˜è®°å¯†ç â€™ç”¨ä¾‹çš„å‰¥ç¦»ä¸‹æ¥çš„ç‰ˆæœ¬ï¼Œå±•ç¤ºMVPç»„ä»¶ä¸ç”¨æˆ·çš„äº¤äº’ï¼Œç”¨æˆ·ç‚¹å‡»â€˜é‡ç½®å¯†ç â€™æŒ‰é’®è¿›å…¥ä»–ä»¬çš„é‚®ä»¶åœ°å€ï¼ˆä¸ºä¿æŒä»£ç çš„ç®€æ´ï¼ŒAndroidæ¨¡ç‰ˆä»£ç å·²ç»ç§»é™¤ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BasePresenter.java (Base class for all our Presenters)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BasePresenter</span>&lt;<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> WeakReference&lt;V&gt; mView;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bindView</span><span class="params">(@NonNull V view)</span> </span>&#123;</span><br><span class="line">    mView = <span class="keyword">new</span> WeakReference&lt;&gt;(view);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unbindView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mView = <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> V <span class="title">getView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mView == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> mView.get();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">isViewAttached</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> mView != <span class="keyword">null</span> &amp;&amp; mView.get() != <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IForgotPasswordView.java (view interface)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IForgotPasswordView</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">showLoading</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">hideLoading</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">setEmailText</span><span class="params">(String email)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">showEmailNotValidError</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">showPasswordRequestOk</span><span class="params">(String message)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">showPasswordRequestFail</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ForgotPasswordFragment.java (view implementation)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForgotPasswordFragment</span> <span class="keyword">implements</span> <span class="title">IForgotPasswordView</span>,</span></span><br><span class="line"><span class="class">        <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Triggered by the user clicking a button</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResetPasswordClick</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String email = mEmailEditText.getText().toString();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Forward all logic to the Presenter</span></span><br><span class="line">    mPresenter.requestPasswordChange(email);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ForgotPasswordPresenter.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForgotPasswordPresenter</span> <span class="keyword">extends</span> <span class="title">BasePresenter</span>&lt;<span class="title">IForgotPasswordView</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestPasswordChange</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!Utils.isEmailValid(email)) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Make sure the view is still alive before trying to access it</span></span><br><span class="line">      <span class="keyword">if</span>(isViewAttached()) &#123;</span><br><span class="line">        getView().showEmailNotValidError();    </span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      requestPasswordChangeAsync(email);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">requestPasswordChangeAsync</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update the view's UI elements</span></span><br><span class="line">    <span class="keyword">if</span>(isViewAttached()) &#123;</span><br><span class="line">      getView().hideKeyboard();</span><br><span class="line">      getView().showLoading();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Call our API (results are posted back on an EventBus)</span></span><br><span class="line">      api.forgotPassword(email);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Subscription to the event bus</span></span><br><span class="line">  <span class="meta">@Subscribe</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEvent</span><span class="params">(<span class="keyword">final</span> Event event)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isViewAttached()) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Update the view's UI elements</span></span><br><span class="line">      getView().hideLoading();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">switch</span> (event.getType()) &#123;</span><br><span class="line">        <span class="keyword">case</span> FORGOT_PASSWORD_OK:</span><br><span class="line">          getView().showPasswordRequestOk((String) event.getData());</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> FORGOT_PASSWORD_FAILED:</span><br><span class="line">          getView().showPasswordRequestFail();</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> mvp </tag>
            
            <tag> framework </tag>
            
            <tag> technical debt </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]å¼‚æ­¥ layout inflationï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2016/09/01/Android-%E5%BC%82%E6%AD%A5-layout-inflation%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="å¼‚æ­¥-layout-inflation"><a href="#å¼‚æ­¥-layout-inflation" class="headerlink" title="å¼‚æ­¥ layout inflation"></a>å¼‚æ­¥ layout inflation</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="&#109;&#97;&#x69;&#108;&#x74;&#x6f;&#x3a;&#104;&#116;&#x74;&#x70;&#x73;&#58;&#47;&#x2f;&#x6d;&#x65;&#100;&#x69;&#x75;&#x6d;&#46;&#99;&#x6f;&#109;&#47;&#64;&#x6c;&#117;&#x70;&#x61;&#106;&#x7a;&#x2f;&#x61;&#x73;&#121;&#110;&#99;&#104;&#x72;&#111;&#x6e;&#111;&#117;&#x73;&#x2d;&#108;&#x61;&#121;&#x6f;&#117;&#116;&#45;&#105;&#x6e;&#x66;&#x6c;&#97;&#x74;&#105;&#x6f;&#110;&#x2d;&#x37;&#x63;&#98;&#x63;&#97;&#50;&#x36;&#x35;&#51;&#98;&#x66;&#35;&#46;&#113;&#50;&#x32;&#x76;&#112;&#101;&#122;&#x67;&#52;">&#104;&#116;&#x74;&#x70;&#x73;&#58;&#47;&#x2f;&#x6d;&#x65;&#100;&#x69;&#x75;&#x6d;&#46;&#99;&#x6f;&#109;&#47;&#64;&#x6c;&#117;&#x70;&#x61;&#106;&#x7a;&#x2f;&#x61;&#x73;&#121;&#110;&#99;&#104;&#x72;&#111;&#x6e;&#111;&#117;&#x73;&#x2d;&#108;&#x61;&#121;&#x6f;&#117;&#116;&#45;&#105;&#x6e;&#x66;&#x6c;&#97;&#x74;&#105;&#x6f;&#110;&#x2d;&#x37;&#x63;&#98;&#x63;&#97;&#50;&#x36;&#x35;&#51;&#98;&#x66;&#35;&#46;&#113;&#50;&#x32;&#x76;&#112;&#101;&#122;&#x67;&#52;</a></p>
</blockquote>
<p>éšç€æœ€è¿‘å‘å¸ƒçš„<a href="https://developer.android.com/topic/libraries/support-library/revisions.html" target="_blank" rel="noopener">Android Support Library, revision 24</a>ï¼ŒGoogleå¼€å‘è€…åœ¨v4åŒ…ä¸­å¢åŠ äº†ä¸€ä¸ªç”¨æ¥å¼‚æ­¥inflate layoutsçš„å¸®åŠ©ç±»ã€‚</p>
<h2 id="è¿›å…¥-AsyncLayoutInflater"><a href="#è¿›å…¥-AsyncLayoutInflater" class="headerlink" title="è¿›å…¥ AsyncLayoutInflater"></a>è¿›å…¥ AsyncLayoutInflater</h2><p>ä½ ä¼šå‘ç°AsyncLayoutInflaterå¯ä»¥ä½¿ç”¨åœ¨å½“ä½ æƒ³è¦å»æ‡’åŠ è½½ä½ åº”ç”¨ä¸­éƒ¨åˆ†UIæˆ–è€…ç”¨æˆ·è¡Œä¸ºçš„å“åº”ã€‚è¿™ä¸ªå¸®åŠ©ç±»å°†ä¼šå…è®¸ä½ çš„UIçº¿ç¨‹åœ¨æ‰§è¡Œç¹é‡çš„inflateæ—¶ç»§ç»­ä¿æŒå“åº”ã€‚</p>
<p>ä½¿ç”¨AsyncLayoutInflaterä½ éœ€è¦åœ¨ä½ åº”ç”¨çš„<strong>UIçº¿ç¨‹</strong>åˆ›å»ºä¸€ä¸ªå®ƒçš„å®ä¾‹ã€‚</p>
<p>å‡è®¾ä¸‹é¢éƒ¨åˆ†ä»£ç æ˜¯ä½ Activityä»£ç ä¸­çš„ä¸€éƒ¨åˆ†ï¼ˆæˆ‘å°†åœ¨è¿™é‡Œä½¿ç”¨Kotlinè¯­æ³•ï¼‰ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> inflater = AsyncLayoutInflater(<span class="keyword">this</span>)</span><br></pre></td></tr></table></figure>
<p>ç„¶åç°åœ¨å¯ä»¥é€šè¿‡è¿™ä¸ªå®ä¾‹inflateä½ çš„layoutæ–‡ä»¶ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inflater.inflate(resId: <span class="built_in">Int</span>, parent: ViewGroup)</span><br></pre></td></tr></table></figure>
<p>å¦‚ä½ æ‰€è§ï¼Œinflateå‡½æ•°æ¥æ”¶3ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªæ˜¯ä½ layoutèµ„æºï¼Œç¬¬äºŒä¸ªæ˜¯å¯é€‰çš„viewä½œä¸ºé¢„æœŸinflatedå±‚æ¬¡ç»“æ„çš„parentï¼Œç„¶åç¬¬ä¸‰ä¸ªæ˜¯ä¸€ä¸ª<code>OnInflateFinishedListener</code>ï¼Œæ˜¯ä¸€ä¸ªå›è°ƒï¼Œä¸€æ—¦layoutè¢«inflateå®Œæ¯•å®ƒå°±ä¼šè¢«å›è°ƒï¼ˆä¾‹å­ä¸­è¢«lambdaå‡½æ•°ä»£æ›¿ï¼‰ã€‚</p>
<p>æ¯”è¾ƒåŸºæœ¬çš„LayoutInflaterçš„inflateå‡½æ•°ï¼Œä¸€èˆ¬ä½¿ç”¨ä¸€ä¸ªbooleanä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå®ƒè¡¨ç¤ºæ˜¯å¦inflateå±‚æ¬¡ç»“æ„åº”è¯¥é™„å±å²›ä¸€ä¸ªrootå‚æ•°ä¸Šé¢ã€‚åœ¨æˆ‘ä»¬çš„inflateå‡½æ•°çš„å¼‚æ­¥ç‰ˆæœ¬ä¸­å¹¶æ²¡æœ‰è¿™æ ·ä¸€ä¸ªå‚æ•°ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä½ ä¼šä½¿ç”¨è¿™ç§æ–¹å¼è°ƒç”¨ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inflater.inflate(resId: <span class="built_in">Int</span>, parent: ViewGroup) </span><br><span class="line">    &#123; view, resid, parent -&gt; parent.addView(view) &#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨AsyncLayoutInflaterçš„ç¼ºç‚¹"><a href="#ä½¿ç”¨AsyncLayoutInflaterçš„ç¼ºç‚¹" class="headerlink" title="ä½¿ç”¨AsyncLayoutInflaterçš„ç¼ºç‚¹"></a>ä½¿ç”¨AsyncLayoutInflaterçš„ç¼ºç‚¹</h2><p>å½“ç„¶å®ƒæœ‰å¦‚ä¸‹ä¸€äº›ç¼ºç‚¹ï¼š</p>
<ul>
<li><p>parentçš„ <code>generateLayoutParams()</code> å‡½æ•°å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
</li>
<li><p>æ‰€æœ‰æ­£åœ¨æ„å»ºçš„viewsä¸€å®šä¸èƒ½åˆ›å»ºä»»ä½• <code>Handlers</code> æˆ–è€…è°ƒç”¨ <code>Looper.myLooper</code> å‡½æ•°ã€‚</p>
</li>
<li><p>ä¸æ”¯æŒè®¾ç½®<code>LayoutInflater.Factory</code>ä¹Ÿä¸æ”¯æŒ<code>LayoutInflater.Factory2</code></p>
</li>
<li><p>ä¸æ”¯æŒåŒ…å«Fragmentsçš„inflating layouts</p>
</li>
</ul>
<p>å¦‚æœæˆ‘ä»¬å°è¯•å¼‚æ­¥çš„æ–¹å¼å»inflateçš„layoutä¸æ”¯æŒè¿™ç§æ–¹å¼ï¼Œé‚£ä¹ˆinflationå¤„ç†å°†ä¼šè‡ªåŠ¨å›é€€åˆ°ä¸»çº¿ç¨‹ä¸­ã€‚</p>
<h2 id="ä½¿ç”¨Kotlin-Android-Extensions-çš„-Kotlinçš„å°ä¾‹å­"><a href="#ä½¿ç”¨Kotlin-Android-Extensions-çš„-Kotlinçš„å°ä¾‹å­" class="headerlink" title="ä½¿ç”¨Kotlin Android Extensions çš„ Kotlinçš„å°ä¾‹å­"></a>ä½¿ç”¨Kotlin Android Extensions çš„ Kotlinçš„å°ä¾‹å­</h2><p>MainActivity</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        loadFirst.setOnClickListener &#123; </span><br><span class="line">           loadAsync(R.layout.async) &#123; </span><br><span class="line">             second.text = <span class="string">"I am second TextView"</span> </span><br><span class="line">           &#125; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> MainActivity.<span class="title">loadAsync</span><span class="params">(<span class="meta">@LayoutRes</span> res: <span class="type">Int</span>, </span></span></span><br><span class="line"><span class="function"><span class="params">                           action: <span class="type">View</span>.()</span></span> -&gt; <span class="built_in">Unit</span>) =</span><br><span class="line">    AsyncLayoutInflater(<span class="keyword">this</span>).inflate(res, frame) </span><br><span class="line">    &#123; view, resid, parent -&gt;</span><br><span class="line">        with(parent) &#123;</span><br><span class="line">            addView(view)</span><br><span class="line">            action(view)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>activity_main.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/frame"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:padding</span>=<span class="string">"@dimen/activity_vertical_margin"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">"com.cartoon.player.MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/loadFirst"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"48dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">"center"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginBottom</span>=<span class="string">"16dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Load f async"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>async.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/first"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginBottom</span>=<span class="string">"16dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/second"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginBottom</span>=<span class="string">"16dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"2"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> layout </tag>
            
            <tag> inflation </tag>
            
            <tag> asynchronize </tag>
            
            <tag> async </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[HTTPåè®®è¯¦è§£]]></title>
      <url>/2016/08/29/HTTP%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3/</url>
      <content type="html"><![CDATA[<div id="editor-reader-full" class="editor-reader-full-shown"><br><div class="reader-full-topInfo-shown">æ¥è‡ª:&nbsp;<a href="https://www.zybuluo.com/yangfch3/note/167490" target="_blank" rel="noopener">https://www.zybuluo.com/yangfch3/note/167490</a></div><br><div class="reader-full-topInfo-shown">&nbsp;</div><br><div id="reader-full-topInfo" class="reader-full-topInfo-shown">HTTPåè®®è¯¦è§£</div><br><div id="wmd-preview" class="wmd-preview wmd-preview-full-reader" data-medium-element="true"><br><br><code>http</code><br><br><em> </em> *<br><br><div class="md-section-divider">&nbsp;</div>

<h3 id="httpï¼Ÿ"><a href="#httpï¼Ÿ" class="headerlink" title="httpï¼Ÿ"></a><code>http</code>ï¼Ÿ</h3><ul>
<li>å…¨ç§°ï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®<code>(HyperText Transfer Protocol)</code></li>
<li>ä½œç”¨ï¼šè®¾è®¡ä¹‹åˆæ˜¯ä¸ºäº†å°†è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€<code>(HTML)</code>æ–‡æ¡£ä»WebæœåŠ¡å™¨ä¼ é€åˆ°å®¢æˆ·ç«¯çš„æµè§ˆå™¨ã€‚ç°åœ¨<code>http</code>çš„ä½œç”¨å·²ä¸å±€é™äº<code>HTML</code>çš„ä¼ è¾“ã€‚</li>
<li>ç‰ˆæœ¬ï¼š<code>http/1.0</code>&nbsp;<code>http/1.1*</code>&nbsp;<code>http/2.0</code></li>
</ul>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="ä¸¤ç¯‡ä½³æ–‡"><a href="#ä¸¤ç¯‡ä½³æ–‡" class="headerlink" title="ä¸¤ç¯‡ä½³æ–‡"></a>ä¸¤ç¯‡ä½³æ–‡</h3><p><a href="https://www.zybuluo.com/yangfch3/note/113028" target="_blank" rel="noopener">è¾“å…¥ç½‘å€ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆ</a>&nbsp;<br><a href="http://rapheal.sinaapp.com/" target="_blank" rel="noopener">Webå¼€å‘æ–°äººåŸ¹è®­ç³»åˆ—</a></p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="URLè¯¦è§£"><a href="#URLè¯¦è§£" class="headerlink" title="URLè¯¦è§£"></a>URLè¯¦è§£</h3><p>ä¸€ä¸ªç¤ºä¾‹URL</p>
<pre><code>http://www.mywebsite.com/sj/test;id=8079?name=sviergn&amp;amp;x=true#stuff

Schema: http
host: www.mywebsite.com
path: /sj/test
URL params: id=8079
Query String: name=sviergn&amp;amp;x=true
Anchor: stuff
</code></pre><ul>
<li><code>scheme</code>ï¼šæŒ‡å®šä½å±‚ä½¿ç”¨çš„åè®®(ä¾‹å¦‚ï¼š<code>http</code>,&nbsp;<code>https</code>,&nbsp;<code>ftp</code>)</li>
<li><code>host</code>ï¼š<code>HTTP</code>æœåŠ¡å™¨çš„<code>IP</code>åœ°å€æˆ–è€…åŸŸå</li>
<li><code>port#</code>ï¼š<code>HTTP</code>æœåŠ¡å™¨çš„é»˜è®¤ç«¯å£æ˜¯<code>80</code>ï¼Œè¿™ç§æƒ…å†µä¸‹ç«¯å£å·å¯ä»¥çœç•¥ã€‚å¦‚æœä½¿ç”¨äº†åˆ«çš„ç«¯å£ï¼Œå¿…é¡»æŒ‡æ˜ï¼Œä¾‹å¦‚<code>http://www.mywebsite.com:8080/</code></li>
<li><code>path</code>ï¼šè®¿é—®èµ„æºçš„è·¯å¾„</li>
<li><code>url-params</code></li>
<li><code>query-string</code>ï¼šå‘é€ç»™<code>http</code>æœåŠ¡å™¨çš„æ•°æ®</li>
<li><code>anchor</code>ï¼šé”š</li>
</ul>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="æ— çŠ¶æ€çš„åè®®"><a href="#æ— çŠ¶æ€çš„åè®®" class="headerlink" title="æ— çŠ¶æ€çš„åè®®"></a>æ— çŠ¶æ€çš„åè®®</h3><p><code>http</code>åè®®æ˜¯æ— çŠ¶æ€çš„ï¼š</p>
<blockquote>
<p>åŒä¸€ä¸ªå®¢æˆ·ç«¯çš„è¿™æ¬¡è¯·æ±‚å’Œä¸Šæ¬¡è¯·æ±‚æ˜¯æ²¡æœ‰å¯¹åº”å…³ç³»ï¼Œå¯¹httpæœåŠ¡å™¨æ¥è¯´ï¼Œå®ƒå¹¶ä¸çŸ¥é“è¿™ä¸¤ä¸ªè¯·æ±‚æ¥è‡ªåŒä¸€ä¸ªå®¢æˆ·ç«¯ã€‚</p>
</blockquote>
<p>è§£å†³æ–¹æ³•ï¼š<code>Cookie</code>æœºåˆ¶æ¥ç»´æŠ¤çŠ¶æ€</p>
<p>æ—¢ç„¶Httpåè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œé‚£ä¹ˆ<code>Connection:keep-alive</code>&nbsp;åˆæ˜¯æ€æ ·ä¸€å›äº‹ï¼Ÿ</p>
<blockquote>
<p>æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼ŒæœåŠ¡å™¨ä¸çŸ¥é“å®¢æˆ·ç«¯æ˜¯ä»€ä¹ˆçŠ¶æ€ã€‚ä»å¦ä¸€æ–¹é¢è®²ï¼Œæ‰“å¼€ä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µå’Œä½ ä¹‹å‰æ‰“å¼€è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µä¹‹é—´æ²¡æœ‰ä»»ä½•è”ç³»ã€‚</p>
</blockquote>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="httpæ¶ˆæ¯ç»“æ„"><a href="#httpæ¶ˆæ¯ç»“æ„" class="headerlink" title="httpæ¶ˆæ¯ç»“æ„"></a><code>http</code>æ¶ˆæ¯ç»“æ„</h3><ol>
<li><code>Request</code>&nbsp;æ¶ˆæ¯çš„ç»“æ„ï¼šä¸‰éƒ¨åˆ†</li>
</ol>
<blockquote>
<p>ç¬¬ä¸€éƒ¨åˆ†å«<code>Request line</code>ï¼ˆè¯·æ±‚è¡Œï¼‰ï¼Œ ç¬¬äºŒéƒ¨åˆ†å«<code>http header</code>, ç¬¬ä¸‰éƒ¨åˆ†æ˜¯<code>body</code></p>
<pre><code>*   è¯·æ±‚è¡Œï¼šåŒ…æ‹¬`http`è¯·æ±‚çš„ç§ç±»ï¼Œè¯·æ±‚èµ„æºçš„è·¯å¾„ï¼Œ`http`åè®®ç‰ˆæœ¬
*   `http header`ï¼š`http`å¤´éƒ¨ä¿¡æ¯
*   `body`ï¼šå‘é€ç»™æœåŠ¡å™¨çš„`query`ä¿¡æ¯&amp;nbsp;
</code></pre><p>å½“ä½¿ç”¨çš„æ˜¯â€<code>GET</code>â€œ æ–¹æ³•çš„æ—¶å€™ï¼Œ<code>body</code>æ˜¯ä¸ºç©ºçš„ï¼ˆ<code>GET</code>åªèƒ½è¯»å–æœåŠ¡å™¨ä¸Šçš„ä¿¡æ¯ï¼Œ<code>post</code>èƒ½å†™å…¥ï¼‰&nbsp;</p>
<pre><code>    1.  `&lt;span class=&quot;pln&quot;&gt;GET &lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;pln&quot;&gt;hope&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;pln&quot;&gt; HTTP&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;lit&quot;&gt;1.1&lt;span class=&quot;pln&quot;&gt;   &lt;span class=&quot;com&quot;&gt;//---è¯·æ±‚è¡Œ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
2.  `&lt;span class=&quot;typ&quot;&gt;Host&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; ce&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;sysu&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;edu&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;cn&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
3.  `&lt;span class=&quot;typ&quot;&gt;Accept&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;*&lt;span class=&quot;com&quot;&gt;/*&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
4.  `&lt;span class=&quot;com&quot;&gt;Accept-Encoding: gzip, deflate, sdch&lt;/span&gt;`
5.  `&lt;span class=&quot;com&quot;&gt;Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.6&lt;/span&gt;`
6.  `&lt;span class=&quot;com&quot;&gt;Cache-Control: max-age=0&lt;/span&gt;`
7.  `&lt;span class=&quot;com&quot;&gt;Cookie:.........&lt;/span&gt;`
8.  `&lt;span class=&quot;com&quot;&gt;Referer: http://ce.sysu.edu.cn/hope/&lt;/span&gt;`
9.  `&lt;span class=&quot;com&quot;&gt;User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.130 Safari/537.36&lt;/span&gt;`
</code></pre><p>10.11.  <code>&lt;span class=&quot;com&quot;&gt;---åˆ†å‰²çº¿---&lt;/span&gt;</code><br>12.13.  <code>&lt;span class=&quot;com&quot;&gt;POST /hope/ HTTP/1.1   //---è¯·æ±‚è¡Œ&lt;/span&gt;</code></p>
<pre><code>14.  `&lt;span class=&quot;com&quot;&gt;Host: ce.sysu.edu.cn&lt;/span&gt;`
15.  `&lt;span class=&quot;com&quot;&gt;Accept: */&lt;span class=&quot;pun&quot;&gt;*&lt;/span&gt;&lt;/span&gt;`
16.  `&lt;span class=&quot;typ&quot;&gt;Accept&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Encoding&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; gzip&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; deflate&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; sdch&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
17.  `&lt;span class=&quot;typ&quot;&gt;Accept&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Language&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; zh&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt;CN&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt;zh&lt;span class=&quot;pun&quot;&gt;;&lt;span class=&quot;pln&quot;&gt;q&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;lit&quot;&gt;0.8&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt;zh&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt;TW&lt;span class=&quot;pun&quot;&gt;;&lt;span class=&quot;pln&quot;&gt;q&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;lit&quot;&gt;0.6&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
18.  `&lt;span class=&quot;typ&quot;&gt;Cache&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Control&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; max&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt;age&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;lit&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
19.  `&lt;span class=&quot;typ&quot;&gt;Cookie&lt;span class=&quot;pun&quot;&gt;:.........&lt;/span&gt;&lt;/span&gt;`
20.  `&lt;span class=&quot;typ&quot;&gt;Referer&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; http&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;com&quot;&gt;//ce.sysu.edu.cn/hope/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
21.  `&lt;span class=&quot;typ&quot;&gt;User&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Agent&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;Mozilla&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;lit&quot;&gt;5.0&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;typ&quot;&gt;Windows&lt;span class=&quot;pln&quot;&gt; NT &lt;span class=&quot;lit&quot;&gt;10.0&lt;span class=&quot;pun&quot;&gt;;&lt;span class=&quot;pln&quot;&gt; WOW64&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;AppleWebKit&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;lit&quot;&gt;537.36&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;pun&quot;&gt;(&lt;span class=&quot;pln&quot;&gt;KHTML&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; like &lt;span class=&quot;typ&quot;&gt;Gecko&lt;span class=&quot;pun&quot;&gt;)&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;Chrome&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;lit&quot;&gt;44.0&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;lit&quot;&gt;2403.130&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;Safari&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;lit&quot;&gt;537.36&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
</code></pre><p>22.23.  <code>&lt;span class=&quot;pun&quot;&gt;...&lt;span class=&quot;pln&quot;&gt;body&lt;span class=&quot;pun&quot;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</code></p>
</blockquote>
<ol>
<li>Responseæ¶ˆæ¯çš„ç»“æ„</li>
</ol>
<blockquote>
<p>ä¹Ÿåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†å«request line, ç¬¬äºŒéƒ¨åˆ†å«request headerï¼Œç¬¬ä¸‰éƒ¨åˆ†æ˜¯body</p>
<pre><code>*   `request line`ï¼šåè®®ç‰ˆæœ¬ã€çŠ¶æ€ç ã€`message`
*   `request header`ï¼š`request`å¤´ä¿¡æ¯
*   `body`ï¼šè¿”å›çš„è¯·æ±‚èµ„æºä¸»ä½“&amp;nbsp;

    1.  `&lt;span class=&quot;pln&quot;&gt;HTTP&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;lit&quot;&gt;1.1&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;200&lt;span class=&quot;pln&quot;&gt; OK&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
    2.  `&lt;span class=&quot;typ&quot;&gt;Accept&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Ranges&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; bytes&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
    3.  `&lt;span class=&quot;typ&quot;&gt;Content&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Encoding&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; gzip&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
    4.  `&lt;span class=&quot;typ&quot;&gt;Content&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Length&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;4533&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
    5.  `&lt;span class=&quot;typ&quot;&gt;Content&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Type&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; text&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;pln&quot;&gt;html&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
    6.  `&lt;span class=&quot;typ&quot;&gt;Date&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;Sun&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;06&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;Sep&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;2015&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;07&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;lit&quot;&gt;56&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;lit&quot;&gt;07&lt;span class=&quot;pln&quot;&gt; GMT&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
    7.  `&lt;span class=&quot;typ&quot;&gt;ETag&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;str&quot;&gt;&quot;2788e6e716e7d01:0&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
    8.  `&lt;span class=&quot;typ&quot;&gt;Last&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Modified&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;Fri&lt;span class=&quot;pun&quot;&gt;,&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;04&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;Sep&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;2015&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;lit&quot;&gt;13&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;lit&quot;&gt;37&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;lit&quot;&gt;55&lt;span class=&quot;pln&quot;&gt; GMT&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
    9.  `&lt;span class=&quot;typ&quot;&gt;Server&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;Microsoft&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;pln&quot;&gt;IIS&lt;span class=&quot;pun&quot;&gt;/&lt;span class=&quot;lit&quot;&gt;7.5&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
    10.  `&lt;span class=&quot;typ&quot;&gt;Vary&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; &lt;span class=&quot;typ&quot;&gt;Accept&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Encoding&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
    11.  `&lt;span class=&quot;pln&quot;&gt;X&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;Powered&lt;span class=&quot;pun&quot;&gt;-&lt;span class=&quot;typ&quot;&gt;By&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; ASP&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;NET&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
</code></pre><p>12.13.  <code>&lt;span class=&quot;pun&quot;&gt;&amp;lt;!&lt;span class=&quot;pln&quot;&gt;DOCTYPE html&lt;span class=&quot;pun&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</code></p>
<pre><code>14.  `&lt;span class=&quot;pun&quot;&gt;...&lt;/span&gt;`
15.  `&lt;span class=&quot;pun&quot;&gt;&amp;lt;&amp;gt;&lt;/span&gt;`
16.  `&lt;span class=&quot;pun&quot;&gt;...&lt;/span&gt;`
</code></pre></blockquote>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="get-nbsp-å’Œ-nbsp-post-nbsp-åŒºåˆ«"><a href="#get-nbsp-å’Œ-nbsp-post-nbsp-åŒºåˆ«" class="headerlink" title="get&nbsp;å’Œ&nbsp;post&nbsp;åŒºåˆ«"></a><code>get</code>&nbsp;å’Œ&nbsp;<code>post</code>&nbsp;åŒºåˆ«</h3><p><code>http</code>åè®®å®šä¹‰äº†å¾ˆå¤šä¸æœåŠ¡å™¨äº¤äº’çš„æ–¹æ³•ï¼Œæœ€åŸºæœ¬çš„æœ‰4ç§ï¼Œåˆ†åˆ«æ˜¯<code>GET</code>,<code>POST</code>,<code>PUT</code>,<code>DELETE</code>ã€‚ ä¸€ä¸ª<code>URL</code>åœ°å€ç”¨äºæè¿°ä¸€ä¸ªç½‘ç»œä¸Šçš„èµ„æºï¼Œè€Œ<code>HTTP</code>ä¸­çš„<code>GET</code>,&nbsp;<code>POST</code>,&nbsp;<code>PUT</code>,&nbsp;<code>DELETE</code>&nbsp;å°±å¯¹åº”ç€å¯¹è¿™ä¸ªèµ„æºçš„æŸ¥ï¼Œæ”¹ï¼Œå¢ï¼Œåˆ 4ä¸ªæ“ä½œã€‚ æˆ‘ä»¬æœ€å¸¸è§çš„å°±æ˜¯<code>GET</code>å’Œ<code>POST</code>äº†ã€‚<code>GET</code>ä¸€èˆ¬ç”¨äºè·å–/æŸ¥è¯¢èµ„æºä¿¡æ¯ï¼Œè€ŒPOSTä¸€èˆ¬ç”¨äºæ›´æ–°èµ„æºä¿¡æ¯.</p>
<ol>
<li><p><code>GET</code>&nbsp;æäº¤çš„æ•°æ®ä¼šæ”¾åœ¨<code>URL</code>ä¹‹åï¼Œä»¥<code>?</code>åˆ†å‰²<code>URL</code>å’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥<code>&amp;amp;</code>ç›¸è¿ï¼Œå¦‚<code>EditPosts.aspx?name=test1&amp;amp;id=123456</code>ã€‚<code>POST</code>&nbsp;æ–¹æ³•æ˜¯æŠŠæäº¤çš„æ•°æ®æ”¾åœ¨<code>HTTP</code>åŒ…çš„<code>Body</code>ä¸­ã€‚</p>
</li>
<li><p><code>GET</code>&nbsp;æäº¤çš„æ•°æ®å¤§å°æœ‰é™åˆ¶ï¼ˆå› ä¸ºæµè§ˆå™¨å¯¹<code>URL</code>çš„é•¿åº¦æœ‰é™åˆ¶ï¼‰ï¼Œè€Œ<code>POST</code>æ–¹æ³•æäº¤çš„æ•°æ®æ²¡æœ‰é™åˆ¶.</p>
</li>
<li><p><code>GET</code>&nbsp;æ–¹å¼éœ€è¦ä½¿ç”¨<code>Request.QueryString</code>&nbsp;æ¥å–å¾—å˜é‡çš„å€¼ï¼Œè€Œ<code>POST</code>æ–¹å¼é€šè¿‡<code>Request.Form</code>æ¥è·å–å˜é‡çš„å€¼ã€‚</p>
</li>
<li><p><code>GET</code>&nbsp;æ–¹å¼æäº¤æ•°æ®ï¼Œä¼šå¸¦æ¥å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œé€šè¿‡<code>GET</code>æ–¹å¼æäº¤æ•°æ®æ—¶ï¼Œç”¨æˆ·åå’Œå¯†ç å°†å‡ºç°åœ¨<code>URL</code>ä¸Šï¼Œå¦‚æœé¡µé¢å¯ä»¥è¢«ç¼“å­˜æˆ–è€…å…¶ä»–äººå¯ä»¥è®¿é—®è¿™å°æœºå™¨ï¼Œå°±å¯ä»¥ä»å†å²è®°å½•è·å¾—è¯¥ç”¨æˆ·çš„è´¦å·å’Œå¯†ç .&nbsp;</p>
<p><a href="https://www.zybuluo.com/yangfch3/note/123476" target="_blank" rel="noopener">HTTPè¯·æ±‚çš„Getä¸Post</a></p>
</li>
</ol>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="çŠ¶æ€ç "><a href="#çŠ¶æ€ç " class="headerlink" title="çŠ¶æ€ç "></a>çŠ¶æ€ç </h3><p><code>Response</code>&nbsp;æ¶ˆæ¯ä¸­çš„ç¬¬ä¸€è¡Œå«åšçŠ¶æ€è¡Œï¼Œç”±<code>HTTP</code>åè®®ç‰ˆæœ¬å·ï¼Œ&nbsp;çŠ¶æ€ç ï¼Œ&nbsp;çŠ¶æ€æ¶ˆæ¯&nbsp;ä¸‰éƒ¨åˆ†ç»„æˆã€‚</p>
<p>çŠ¶æ€ç ç”¨æ¥å‘Šè¯‰<code>HTTP</code>å®¢æˆ·ç«¯ï¼Œ<code>HTTP</code>æœåŠ¡å™¨æ˜¯å¦äº§ç”Ÿäº†é¢„æœŸçš„<code>Response</code>.</p>
<p><code>HTTP/1.1</code>ä¸­å®šä¹‰äº† 5 ç±»çŠ¶æ€ç ã€‚</p>
<p>çŠ¶æ€ç ç”±ä¸‰ä½æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªæ•°å­—å®šä¹‰äº†å“åº”çš„ç±»åˆ«</p>
<ul>
<li><code>1XX</code>&nbsp;æç¤ºä¿¡æ¯ - è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ï¼Œç»§ç»­å¤„ç†</li>
<li><code>2XX</code>&nbsp;æˆåŠŸ - è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ï¼Œç†è§£ï¼Œæ¥å—</li>
<li><code>3XX</code>&nbsp;é‡å®šå‘ - è¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„å¤„ç†</li>
<li><code>4XX</code>&nbsp;å®¢æˆ·ç«¯é”™è¯¯ - è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®ç°</li>
<li><p><code>5XX</code>&nbsp;æœåŠ¡å™¨ç«¯é”™è¯¯ - æœåŠ¡å™¨æœªèƒ½å®ç°åˆæ³•çš„è¯·æ±‚</p>
<ol>
<li><code>200 OK</code>&nbsp;<br>è¯·æ±‚è¢«æˆåŠŸåœ°å®Œæˆï¼Œæ‰€è¯·æ±‚çš„èµ„æºå‘é€å›å®¢æˆ·ç«¯</li>
<li><code>302 Found</code>&nbsp;<br>é‡å®šå‘ï¼Œæ–°çš„<code>URL</code>ä¼šåœ¨<code>response</code>ä¸­çš„<code>Location</code>ä¸­è¿”å›ï¼Œæµè§ˆå™¨å°†ä¼šä½¿ç”¨æ–°çš„<code>URL</code>å‘å‡ºæ–°çš„<code>Request</code></li>
<li><code>304 Not Modified</code>&nbsp;<br>æ–‡æ¡£å·²ç»è¢«ç¼“å­˜ï¼Œç›´æ¥ä»ç¼“å­˜è°ƒç”¨</li>
<li><code>400 Bad Request</code>&nbsp;<br>å®¢æˆ·ç«¯è¯·æ±‚ä¸è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£&nbsp;<br><code>403 Forbidden</code>&nbsp;<br>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡&nbsp;<br><code>404 Not Found</code>&nbsp;<br>è¯·æ±‚èµ„æºä¸å­˜åœ¨</li>
<li><code>500 Internal Server Error</code>&nbsp;<br>æœåŠ¡å™¨å‘ç”Ÿäº†ä¸å¯é¢„æœŸçš„é”™è¯¯&nbsp;<br><code>503 Server Unavailable</code>&nbsp;<br>æœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½æ¢å¤æ­£å¸¸</li>
</ol>
</li>
</ul>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="http-reauest-header"><a href="#http-reauest-header" class="headerlink" title="http reauest header"></a>http reauest header</h3><p><code>http</code>&nbsp;è¯·æ±‚å¤´åŒ…æ‹¬å¾ˆå¤šé”®å€¼å¯¹ï¼Œè¿™äº›é”®å€¼å¯¹æœ‰ä»€ä¹ˆæ„ä¹‰ä¸ä½œç”¨ï¼Ÿå¦‚ä½•æ ¹æ®åŠŸèƒ½ä¸ºä»–ä»¬åˆ†ä¸€ä¸‹ç»„å‘¢ï¼Ÿ</p>
<ol>
<li><p><code>cache</code>&nbsp;å¤´åŸŸ</p>
<ul>
<li><code>If-Modified-Since</code>&nbsp;<br>ç”¨æ³•ï¼š<code>If-Modified-Since: Thu, 09 Feb 2012 09:07:57 GMT</code></li>
</ul>
<p>æŠŠæµè§ˆå™¨ç«¯ç¼“å­˜é¡µé¢çš„æœ€åä¿®æ”¹æ—¶é—´å‘é€åˆ°æœåŠ¡å™¨å»ï¼ŒæœåŠ¡å™¨ä¼šæŠŠè¿™ä¸ªæ—¶é—´ä¸æœåŠ¡å™¨ä¸Šå®é™…æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´è¿›è¡Œå¯¹æ¯”ã€‚å¦‚æœæ—¶é—´ä¸€è‡´ï¼Œé‚£ä¹ˆè¿”å›304ï¼Œå®¢æˆ·ç«¯å°±ç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ–‡ä»¶ã€‚å¦‚æœæ—¶é—´ä¸ä¸€è‡´ï¼Œå°±ä¼šè¿”å›200å’Œæ–°çš„æ–‡ä»¶å†…å®¹ã€‚å®¢æˆ·ç«¯æ¥åˆ°ä¹‹åï¼Œä¼šä¸¢å¼ƒæ—§æ–‡ä»¶ï¼ŒæŠŠæ–°æ–‡ä»¶ç¼“å­˜èµ·æ¥ï¼Œå¹¶æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸­ã€‚&nbsp;</p>
<pre><code>*   `If-None-Match`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>If-None-Match: &quot;03f2b33c0bfcc1:0&quot;</code></p>
<p><code>If-None-Match</code>å’Œ<code>ETag</code>ä¸€èµ·å·¥ä½œï¼Œå·¥ä½œåŸç†æ˜¯åœ¨<code>HTTP Response</code>ä¸­æ·»åŠ <code>ETag</code>ä¿¡æ¯ã€‚ å½“ç”¨æˆ·å†æ¬¡è¯·æ±‚è¯¥èµ„æºæ—¶ï¼Œå°†åœ¨<code>HTTP Request</code>&nbsp;ä¸­åŠ å…¥<code>If-None-Match</code>ä¿¡æ¯(<code>ETag</code>çš„å€¼)ã€‚å¦‚æœæœåŠ¡å™¨éªŒè¯èµ„æºçš„<code>ETag</code>æ²¡æœ‰æ”¹å˜ï¼ˆè¯¥èµ„æºæ²¡æœ‰æ›´æ–°ï¼‰ï¼Œå°†è¿”å›ä¸€ä¸ª<code>304</code>çŠ¶æ€å‘Šè¯‰å®¢æˆ·ç«¯ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ–‡ä»¶ã€‚å¦åˆ™å°†è¿”å›<code>200</code>çŠ¶æ€å’Œæ–°çš„èµ„æºå’Œ<code>Etag</code>. ä½¿ç”¨è¿™æ ·çš„æœºåˆ¶å°†æé«˜ç½‘ç«™çš„æ€§èƒ½&nbsp;</p>
<pre><code>*   `Pragma`ï¼š`Pragma: no-cache`&amp;nbsp;
</code></pre><p><code>Pargma</code>åªæœ‰ä¸€ä¸ªç”¨æ³•ï¼Œ ä¾‹å¦‚ï¼š&nbsp;<code>Pragma: no-cache</code></p>
<p>ä½œç”¨ï¼š é˜²æ­¢é¡µé¢è¢«ç¼“å­˜ï¼Œ åœ¨<code>HTTP/1.1</code>ç‰ˆæœ¬ä¸­ï¼Œå®ƒå’Œ<code>Cache-Control:no-cache</code>ä½œç”¨ä¸€æ¨¡ä¸€æ ·&nbsp;</p>
<pre><code>*   `Cache-Control`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š</p>
<pre><code>    *   `Cache-Control:Public`&amp;nbsp;å¯ä»¥è¢«ä»»ä½•ç¼“å­˜æ‰€ç¼“å­˜ï¼ˆï¼‰
*   `Cache-Control:Private`&amp;nbsp;å†…å®¹åªç¼“å­˜åˆ°ç§æœ‰ç¼“å­˜ä¸­
*   `Cache-Control:no-cache`&amp;nbsp;æ‰€æœ‰å†…å®¹éƒ½ä¸ä¼šè¢«ç¼“å­˜
</code></pre><p>ä½œç”¨ï¼šç”¨æ¥æŒ‡å®š<code>Response-Request</code>éµå¾ªçš„ç¼“å­˜æœºåˆ¶</p>
</li>
<li><p><code>Client</code>&nbsp;å¤´åŸŸ</p>
<ul>
<li><code>Accept</code>&nbsp;<br>ç”¨æ³•ï¼š<code>Accept: */*</code>ï¼Œ<code>Accept: text/html</code></li>
</ul>
<p>ä½œç”¨ï¼š æµè§ˆå™¨ç«¯å¯ä»¥æ¥å—çš„åª’ä½“ç±»å‹ï¼›&nbsp;<br><code>Accept: */*</code>&nbsp;ä»£è¡¨æµè§ˆå™¨å¯ä»¥å¤„ç†æ‰€æœ‰å›å‘çš„ç±»å‹ï¼Œ(ä¸€èˆ¬æµè§ˆå™¨å‘ç»™æœåŠ¡å™¨éƒ½æ˜¯å‘è¿™ä¸ªï¼‰&nbsp;<br><code>Accept: text/html</code>&nbsp;ä»£è¡¨æµè§ˆå™¨å¯ä»¥æ¥å—æœåŠ¡å™¨å›å‘çš„ç±»å‹ä¸º&nbsp;<code>text/html</code>&nbsp;ï¼›å¦‚æœæœåŠ¡å™¨æ— æ³•è¿”å›<code>text/html</code>ç±»å‹çš„æ•°æ®ï¼ŒæœåŠ¡å™¨åº”è¯¥è¿”å›ä¸€ä¸ª<code>406</code>é”™è¯¯(<code>non acceptable</code>)&nbsp;</p>
<pre><code>*   `Accept-Encoding`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>Accept-Encoding: gzip, deflate</code></p>
<p>ä½œç”¨ï¼š æµè§ˆå™¨ç”³æ˜è‡ªå·±æ¥æ”¶çš„æ–‡ä»¶ç¼–ç æ–¹æ³•ï¼Œé€šå¸¸æŒ‡å®šå‹ç¼©æ–¹æ³•ï¼Œæ˜¯å¦æ”¯æŒå‹ç¼©ï¼Œæ”¯æŒä»€ä¹ˆå‹ç¼©æ–¹æ³•ï¼ˆ<code>gzip</code>ï¼Œ<code>deflate</code>ï¼‰ï¼Œï¼ˆæ³¨æ„ï¼šè¿™ä¸æ˜¯æŒ‡å­—ç¬¦ç¼–ç ï¼‰&nbsp;</p>
<pre><code>*   `Accept-Language`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>Accept-Language: en-us</code></p>
<p>ä½œç”¨ï¼š æµè§ˆå™¨ç”³æ˜è‡ªå·±æ¥æ”¶çš„è¯­è¨€ã€‚&nbsp;</p>
<pre><code>è¯­è¨€è·Ÿå­—ç¬¦é›†çš„åŒºåˆ«ï¼šä¸­æ–‡æ˜¯è¯­è¨€ï¼Œä¸­æ–‡æœ‰å¤šç§å­—ç¬¦é›†ï¼Œæ¯”å¦‚`big5`ï¼Œ`gb2312`ï¼Œ`gbk`ç­‰ç­‰ï¼›&amp;nbsp;

*   `User-Agent`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š&nbsp;<code>User-Agent: Mozilla/4.0......</code></p>
<p>ä½œç”¨ï¼šå‘Šè¯‰<code>HTTP</code>æœåŠ¡å™¨ï¼Œ å®¢æˆ·ç«¯ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨çš„åç§°å’Œç‰ˆæœ¬.&nbsp;</p>
<pre><code>*   `Accept-Charset`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>Accept-Charsetï¼šutf-8</code></p>
<p>ä½œç”¨ï¼šæµè§ˆå™¨ç”³æ˜è‡ªå·±æ¥æ”¶çš„å­—ç¬¦é›†ï¼Œè¿™å°±æ˜¯æœ¬æ–‡å‰é¢ä»‹ç»çš„å„ç§å­—ç¬¦é›†å’Œå­—ç¬¦ç¼–ç ï¼Œå¦‚gb2312ï¼Œutf-8ï¼ˆé€šå¸¸æˆ‘ä»¬è¯´CharsetåŒ…æ‹¬äº†ç›¸åº”çš„å­—ç¬¦ç¼–ç æ–¹æ¡ˆï¼‰&nbsp;</p>
</li>
<li><p><code>Cookie/Login</code>&nbsp;å¤´åŸŸ</p>
<ul>
<li><p><code>Cookie</code></p>
<pre><code>1.  `&lt;span class=&quot;typ&quot;&gt;Cookie&lt;span class=&quot;pun&quot;&gt;:&lt;span class=&quot;pln&quot;&gt; bdshare_firstime&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;lit&quot;&gt;1439081296143&lt;span class=&quot;pun&quot;&gt;;&lt;span class=&quot;pln&quot;&gt; ASP&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;NET_SessionId&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt;rcqayd4ufldcke0wkbm1vhxb&lt;span class=&quot;pun&quot;&gt;;&lt;span class=&quot;pln&quot;&gt; pgv_pvi&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;lit&quot;&gt;7361416192&lt;span class=&quot;pun&quot;&gt;;&lt;span class=&quot;pln&quot;&gt; pgv_si&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;pln&quot;&gt;s6686106624&lt;span class=&quot;pun&quot;&gt;;&lt;span class=&quot;pln&quot;&gt; ce&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;sysu&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;edu&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;cn80&lt;span class=&quot;pun&quot;&gt;.&lt;span class=&quot;pln&quot;&gt;ASPXAUTH&lt;span class=&quot;pun&quot;&gt;=&lt;span class=&quot;lit&quot;&gt;9E099592DD5A414BEECD8CF43CFC71664&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;`
</code></pre></li>
</ul>
<p>ä½œç”¨ï¼š&nbsp;æœ€é‡è¦çš„header, å°†<code>cookie</code>çš„å€¼å‘é€ç»™<code>HTTP</code>&nbsp;æœåŠ¡å™¨</p>
</li>
<li><p><code>Entity</code>&nbsp;å¤´åŸŸ</p>
<ul>
<li><code>Content-Length</code>&nbsp;<br>ç”¨æ³•ï¼š<code>Content-Length: 38</code></li>
</ul>
<p>ä½œç”¨ï¼šå‘é€ç»™HTTPæœåŠ¡å™¨æ•°æ®çš„é•¿åº¦ã€‚&nbsp;</p>
<pre><code>*   `Content-Type`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>Content-Type: application/x-www-form-urlencoded</code></p>
<p>ä¸å¸¸å‡ºç°ï¼Œä¸€èˆ¬å‡ºç°åœ¨<code>response</code>å¤´éƒ¨ï¼Œç”¨äºæŒ‡å®šæ•°æ®æ–‡ä»¶ç±»å‹&nbsp;</p>
</li>
<li><p><code>Miscellaneous</code>&nbsp;å¤´åŸŸ</p>
<ul>
<li><code>Referer</code>&nbsp;<br>ç”¨æ³•ï¼š<code>Referer: http://ce.sysu.edu.cn/hope/</code></li>
</ul>
<p>ä½œç”¨ï¼šæä¾›äº†<code>Request</code>çš„ä¸Šä¸‹æ–‡ä¿¡æ¯çš„æœåŠ¡å™¨ï¼Œå‘Šè¯‰æœåŠ¡å™¨æˆ‘æ˜¯ä»å“ªä¸ªé“¾æ¥è¿‡æ¥çš„ï¼Œæ¯”å¦‚ä»æˆ‘ä¸»é¡µä¸Šé“¾æ¥åˆ°ä¸€ä¸ªæœ‹å‹é‚£é‡Œï¼Œä»–çš„æœåŠ¡å™¨å°±èƒ½å¤Ÿä»<code>HTTP Referer</code>ä¸­ç»Ÿè®¡å‡ºæ¯å¤©æœ‰å¤šå°‘ç”¨æˆ·ç‚¹å‡»æˆ‘ä¸»é¡µä¸Šçš„é“¾æ¥è®¿é—®ä»–çš„ç½‘ç«™ã€‚&nbsp;</p>
</li>
<li><p><code>Transport</code>&nbsp;å¤´åŸŸ</p>
<ul>
<li><code>Connection</code>&nbsp;<br><code>Connection: keep-alive</code>ï¼š å½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“HTTPæ•°æ®çš„TCPè¿æ¥ä¸ä¼šå…³é—­ï¼Œå¦‚æœå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µï¼Œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„è¿æ¥</li>
</ul>
<p><code>Connection: close</code>ï¼š ä»£è¡¨ä¸€ä¸ª<code>Request</code>å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“<code>HTTP</code>æ•°æ®çš„<code>TCP</code>è¿æ¥ä¼šå…³é—­ï¼Œ å½“å®¢æˆ·ç«¯å†æ¬¡å‘é€<code>Request</code>ï¼Œéœ€è¦é‡æ–°å»ºç«‹<code>TCP</code>è¿æ¥&nbsp;</p>
<pre><code>*   `Host`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>Host: ce.sysu.edu.cn</code></p>
<p>ä½œç”¨: è¯·æ±‚æŠ¥å¤´åŸŸä¸»è¦ç”¨äºæŒ‡å®šè¢«è¯·æ±‚èµ„æºçš„<code>Internet</code>ä¸»æœºå’Œç«¯å£å·ï¼ˆé»˜è®¤80ï¼‰ï¼Œå®ƒé€šå¸¸ä»<code>HTTP URL</code>ä¸­æå–å‡ºæ¥çš„</p>
<div class="md-section-divider">&nbsp;</div>

</li>
</ol>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="HTTP-Response-header"><a href="#HTTP-Response-header" class="headerlink" title="HTTP Response header"></a>HTTP Response header</h3><ol>
<li><p><code>Cache</code>&nbsp;å¤´åŸŸ</p>
<ul>
<li><code>Date</code>&nbsp;<br>ç”¨æ³•ï¼š<code>Date: Sat, 11 Feb 2012 11:35:14 GMT</code></li>
</ul>
<p>ä½œç”¨: ç”Ÿæˆæ¶ˆæ¯çš„å…·ä½“æ—¶é—´å’Œæ—¥æœŸ&nbsp;</p>
<pre><code>*   `Expires`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>Expires: Tue, 08 Feb 2022 11:35:14 GMT</code>&nbsp;<br>ä½œç”¨: æµè§ˆå™¨ä¼šåœ¨æŒ‡å®šè¿‡æœŸæ—¶é—´å†…ä½¿ç”¨æœ¬åœ°ç¼“å­˜&nbsp;</p>
<pre><code>*   `Vary`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼šVary: Accept-Encoding&nbsp;</p>
</li>
<li><p><code>Cookie/Login</code>&nbsp;å¤´åŸŸ</p>
<ul>
<li><code>P3P</code>&nbsp;<br>ç”¨æ³•ï¼š&nbsp;<br><code>P3P: CP=CURa ADMa DEVa PSAo PSDo OUR BUS UNI PUR INT DEM STA PRE COM NAV OTC NOI DSP COR</code></li>
</ul>
<p>ä½œç”¨: ç”¨äºè·¨åŸŸè®¾ç½®Cookie, è¿™æ ·å¯ä»¥è§£å†³<code>iframe</code>è·¨åŸŸè®¿é—®<code>cookie</code>çš„é—®é¢˜&nbsp;</p>
<pre><code>*   `Set-Cookie`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š&nbsp;<br><code>Set-Cookie: sc=4c31523a; path=/; domain=.acookie.taobao.com</code></p>
<p>ä½œç”¨ï¼šéå¸¸é‡è¦çš„<code>header</code>, ç”¨äºæŠŠ<code>cookie</code>&nbsp;å‘é€åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œ æ¯ä¸€ä¸ªå†™å…¥<code>cookie</code>éƒ½ä¼šç”Ÿæˆä¸€ä¸ª<code>Set-Cookie</code>.</p>
</li>
<li><p><code>Entity</code>&nbsp;å¤´åŸŸ</p>
<ul>
<li><code>ETag</code>&nbsp;<br>ç”¨æ³•ï¼š<code>ETag: &quot;03f2b33c0bfcc1:0&quot;</code></li>
</ul>
<p>ä½œç”¨: å’Œ<code>request header</code>çš„<code>If-None-Match</code>&nbsp;é…åˆä½¿ç”¨&nbsp;</p>
<pre><code>*   `Last-Modified`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>Last-Modified: Wed, 21 Dec 2011 09:09:10 GMT</code></p>
<p>ä½œç”¨ï¼šç”¨äºæŒ‡ç¤ºèµ„æºçš„æœ€åä¿®æ”¹æ—¥æœŸå’Œæ—¶é—´ã€‚ï¼ˆå®ä¾‹è¯·çœ‹ä¸ŠèŠ‚çš„<code>If-Modified-Since</code>çš„å®ä¾‹ï¼‰&nbsp;</p>
<pre><code>*   `Content-Type`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š</p>
<pre><code>    *   Content-Type: text/html; charset=utf-8
*   Content-Type:text/html;charset=GB2312
*   Content-Type: image/jpeg
</code></pre><p>ä½œç”¨ï¼šWEBæœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨è‡ªå·±å“åº”çš„å¯¹è±¡çš„ç±»å‹å’Œå­—ç¬¦é›†&nbsp;</p>
<pre><code>*   Content-Encoding&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>Content-Encodingï¼šgzip</code></p>
<p>ä½œç”¨ï¼šWEBæœåŠ¡å™¨è¡¨æ˜è‡ªå·±ä½¿ç”¨äº†ä»€ä¹ˆå‹ç¼©æ–¹æ³•ï¼ˆ<code>gzip</code>ï¼Œ<code>deflate</code>ï¼‰å‹ç¼©å“åº”ä¸­çš„å¯¹è±¡ã€‚&nbsp;</p>
<pre><code>*   `Content-Language`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š&nbsp;<code>Content-Language:da</code></p>
<p>WEBæœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨è‡ªå·±å“åº”çš„å¯¹è±¡çš„è¯­è¨€</p>
</li>
<li><p><code>Miscellaneous</code>&nbsp;å¤´åŸŸ</p>
<ul>
<li><code>Server</code>&nbsp;<br>ç”¨æ³•ï¼š<code>Server: Microsoft-IIS/7.5</code></li>
</ul>
<p>ä½œç”¨ï¼šæŒ‡æ˜HTTPæœåŠ¡å™¨çš„è½¯ä»¶ä¿¡æ¯&nbsp;</p>
<pre><code>*   `X-AspNet-Version`&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>X-AspNet-Version: 4.0.30319</code></p>
<p>ä½œç”¨ï¼šå¦‚æœç½‘ç«™æ˜¯ç”¨<code>ASP.NET</code>å¼€å‘çš„ï¼Œè¿™ä¸ª<code>header</code>ç”¨æ¥è¡¨ç¤º<code>ASP.NET</code>çš„ç‰ˆæœ¬&nbsp;</p>
<pre><code>*   X-Powered-By&amp;nbsp;
</code></pre><p>ç”¨æ³•ï¼š<code>X-Powered-By: ASP.NET</code></p>
<p>ä½œç”¨ï¼šè¡¨ç¤ºç½‘ç«™æ˜¯ç”¨ä»€ä¹ˆæŠ€æœ¯å¼€å‘çš„&nbsp;</p>
</li>
<li><p><code>Transport</code>å¤´åŸŸ</p>
<ul>
<li><p><code>Connection</code>&nbsp;<br>ç”¨æ³•ä¸ä½œç”¨ï¼š&nbsp;</p>
<pre><code>*   `Connection: keep-alive`ï¼šå½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“HTTPæ•°æ®çš„TCPè¿æ¥ä¸ä¼šå…³é—­ï¼Œå¦‚æœå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µï¼Œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„è¿æ¥
</code></pre><ul>
<li><code>Connection: close</code>ï¼šä»£è¡¨ä¸€ä¸ªRequestå®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“HTTPæ•°æ®çš„TCPè¿æ¥ä¼šå…³é—­ï¼Œ å½“å®¢æˆ·ç«¯å†æ¬¡å‘é€Requestï¼Œéœ€è¦é‡æ–°å»ºç«‹TCPè¿æ¥</li>
</ul>
</li>
</ul>
</li>
<li><p>Locationå¤´åŸŸ</p>
<ul>
<li>Location&nbsp;<br>ç”¨æ³•ï¼š<code>Locationï¼šhttp://ce.sysu.edu.cn/hope/</code>&nbsp;<br>ä½œç”¨ï¼š ç”¨äºé‡å®šå‘ä¸€ä¸ªæ–°çš„ä½ç½®ï¼Œ åŒ…å«æ–°çš„<code>URL</code>åœ°å€</li></ul></li></ol></div><div class="remark-icons"><br><div class="remark-icon unselectable remark-icon-empty" data-anchor-id="1xa3"><span class="icon-stack"><span class="glyph-comment"><span class="remark-count">+</span></span></span></div>





<p></p></div><p></p>
<p></p></div><p></p>
<div class="in-page-preview-buttons in-page-preview-buttons-full-reader">&nbsp;</div><br><div id="reader-full-toolbar" class="reader-full-toolbar-shown">&nbsp;</div>

]]></content>
      
        
        <tags>
            
            <tag> http </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç½‘ç»œåŸºç¡€]]></title>
      <url>/2016/08/29/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/</url>
      <content type="html"><![CDATA[<div id="editor-reader-full" class="editor-reader-full-shown"><br><div class="reader-full-topInfo-shown"><span style="font-size: 14px; font-family: verdana, Arial, Helvetica, sans-serif; line-height: 1.5;">æ¥è‡ªï¼š<a href="https://www.zybuluo.com/yangfch3/note/140188" target="_blank" rel="noopener">https://www.zybuluo.com/yangfch3/note/140188</a></span></div><br><div class="reader-full-topInfo-shown">&nbsp;</div><br><div id="reader-full-topInfo" class="reader-full-topInfo-shown"><code>&lt;span style=&quot;font-size: 2em; font-family: verdana, Arial, Helvetica, sans-serif; line-height: 1.5;&quot;&gt;ç½‘ç»œåŸºç¡€&lt;/span&gt;</code></div><br><div id="wmd-preview" class="wmd-preview wmd-preview-full-reader" data-medium-element="true"><br><br><em> </em> *<br><br><div class="md-section-divider">&nbsp;</div>

<h2 id="ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚"><a href="#ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚" class="headerlink" title="ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚"></a>ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚</h2><ol>
<li>åŸŸåDNSè§£æï¼Œè·å–å¯¹æ–¹IPï¼Œè¿ç®—åˆ¤æ–­æ˜¯å¦åŒä¸€å­ç½‘&nbsp;<br>hosts â€“&gt; DNSç¼“å­˜ â€“&gt; DNSé€’å½’</li>
<li>å‘èµ·TCPçš„3æ¬¡æ¡æ‰‹ï¼Œå»ºç«‹TCPè¿æ¥&nbsp;<br>æ„å»ºè¿æ¥è¯·æ±‚æŠ¥æ–‡ï¼Œå°è£…æˆæ•°æ®åŒ…ï¼Œè·¯ç”±ã€ARPåˆ°è¾¾ï¼ˆä¸åœ¨åŒä¸€å­ç½‘æ—¶è·¯ç”±+ARPï¼Œåœ¨åŒä¸€å­ç½‘æ—¶ARPï¼‰</li>
<li>å‘èµ·httpè¯·æ±‚&nbsp;<br>æ„å»º HTTP/TCP/IPæ•°æ®åŒ…ï¼Œè·¯ç”±ã€ARPåˆ°è¾¾ï¼ˆåŒä¸Šï¼‰</li>
<li>æœåŠ¡å™¨å“åº”httpè¯·æ±‚ï¼Œè¿”å›æ•°æ®åŒ…&nbsp;<br>æ„å»º HTTP/TCP/IPæ•°æ®åŒ…ï¼Œè·¯ç”±ã€ARPåˆ°è¾¾ï¼ˆåŒä¸Šï¼‰</li>
<li>æµè§ˆå™¨å¾—åˆ°htmlä»£ç </li>
<li>æµè§ˆå™¨è§£æhtmlä»£ç å¹¶å†æ¬¡å‘èµ·HTTPè¯·æ±‚ï¼Œè¯·æ±‚htmlä»£ç ä¸­çš„èµ„æºï¼ˆå¦‚jsã€cssã€å›¾ç‰‡ç­‰</li>
<li>æµè§ˆå™¨å¯¹é¡µé¢è¿›è¡Œæ¸²æŸ“å‘ˆç°ç»™ç”¨æˆ·</li>
<li>å‘èµ·TCPå››æ¬¡åˆ†æ‰‹</li>
<li>æ–­å¼€è¿æ¥</li>
</ol>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h2 id="ä»æ¡æ‰‹åˆ°åˆ†æ‰‹"><a href="#ä»æ¡æ‰‹åˆ°åˆ†æ‰‹" class="headerlink" title="ä»æ¡æ‰‹åˆ°åˆ†æ‰‹"></a>ä»æ¡æ‰‹åˆ°åˆ†æ‰‹</h2><hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸‰æ¬¡æ¡æ‰‹</h3><p>ä¸‰æ¬¡æ¡æ‰‹ï¼šå»ºç«‹è¿æ¥å‰çš„&nbsp;<code>B/S</code>&nbsp;æˆ–&nbsp;<code>C/S</code>&nbsp;äº¤æµ</p>
<blockquote>
<p>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå»ºç«‹è¿æ¥ã€‚å®¢æˆ·ç«¯å‘é€è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå°†<code>SYN</code>ä½ç½®ä¸º<code>1</code>ï¼Œ<code>Sequence Number</code>ä¸º<code>&#39;xxx&#39;</code>ï¼›ç„¶åï¼Œå®¢æˆ·ç«¯è¿›å…¥<code>SYN_SEND</code>çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨çš„ç¡®è®¤ï¼›</p>
<p>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°<code>SYN</code>æŠ¥æ–‡æ®µã€‚æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„<code>SYN</code>æŠ¥æ–‡æ®µï¼Œéœ€è¦å¯¹è¿™ä¸ª<code>SYN</code>æŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤ï¼Œè®¾ç½®<code>Acknowledgment Number</code>ä¸º<code>xxx+1</code>(<code>Sequence Number</code>+1)ï¼›åŒæ—¶ï¼Œè‡ªå·±è‡ªå·±è¿˜è¦å‘é€<code>SYN</code>è¯·æ±‚ä¿¡æ¯ï¼Œå°†<code>SYN</code>ä½ç½®ä¸º<code>1</code>ï¼Œ<code>Sequence Number</code>ä¸º<code>&#39;yyy&#39;</code>ï¼›æœåŠ¡å™¨ç«¯å°†ä¸Šè¿°æ‰€æœ‰ä¿¡æ¯æ”¾åˆ°ä¸€ä¸ªæŠ¥æ–‡æ®µï¼ˆå³SYN+ACKæŠ¥æ–‡æ®µï¼‰ä¸­ï¼Œä¸€å¹¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥<code>SYN_RECV</code>çŠ¶æ€ï¼›</p>
<p>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„<code>SYN+ACK</code>æŠ¥æ–‡æ®µã€‚ç„¶åå°†<code>Acknowledgment Number</code>è®¾ç½®ä¸º<code>yyy+1</code>(æœåŠ¡å™¨<code>Sequence Number</code>+1)ï¼Œå‘æœåŠ¡å™¨å‘é€<code>ACK</code>æŠ¥æ–‡æ®µï¼Œè¿™ä¸ªæŠ¥æ–‡æ®µå‘é€å®Œæ¯•ä»¥åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½è¿›å…¥<code>ESTABLISHED</code>çŠ¶æ€ï¼Œå®Œæˆ<code>TCP</code>ä¸‰æ¬¡æ¡æ‰‹ã€‚è¿æ¥å»ºç«‹æˆåŠŸã€‚</p>
<p>å®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸»æœºAä¸ä¸»æœºBå¼€å§‹ä¼ é€æ•°æ®ã€‚</p>
</blockquote>
<p>å®ä¾‹:</p>
<blockquote>
<p>IP 192.168.1.116.3337 &gt; 192.168.1.123.7788: S 3626544836:3626544836&nbsp;<br>IP 192.168.1.123.7788 &gt; 192.168.1.116.3337: S 1739326486:1739326486 ack 3626544837&nbsp;<br>IP 192.168.1.116.3337 &gt; 192.168.1.123.7788: ack 1739326487,ack 1</p>
<p>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š192.168.1.116å‘é€ä½ç <code>SYN</code>ï¼1,éšæœºäº§ç”Ÿ<code>Sequence number</code>=3626544836çš„æ•°æ®åŒ…åˆ°192.168.1.123,192.168.1.123ç”±<code>SYN</code>=1çŸ¥é“192.168.1.116è¦æ±‚å»ºç«‹è”æœº;</p>
<p>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š192.168.1.123æ”¶åˆ°è¯·æ±‚åè¦ç¡®è®¤è”æœºä¿¡æ¯ï¼Œå‘192.168.1.116å‘é€<code>Acknowledgment Number</code>=3626544837,<code>SYN</code>=1,<code>ACK</code>=1,éšæœºäº§ç”Ÿ<code>Sequence Number</code>=1739326486çš„åŒ…;</p>
<p>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š192.168.1.116æ”¶åˆ°åæ£€æŸ¥<code>Acknowledgment Number</code>æ˜¯å¦æ­£ç¡®ï¼Œå³ç¬¬ä¸€æ¬¡å‘é€çš„<code>Sequence Number+1</code>,ä»¥åŠä½ç <code>ACK</code>æ˜¯å¦ä¸º1ï¼Œè‹¥æ­£ç¡®ï¼Œ192.168.1.116ä¼šå†å‘é€<code>Acknowledgment Number</code>=1739326487,<code>ACK</code>=1ï¼Œ192.168.1.123æ”¶åˆ°åç¡®è®¤<code>Sequence Number=Sequence Number+1</code>,<code>ACK</code>=1åˆ™è¿æ¥å»ºç«‹æˆåŠŸã€‚</p>
</blockquote>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="å››æ¬¡åˆ†æ‰‹"><a href="#å››æ¬¡åˆ†æ‰‹" class="headerlink" title="å››æ¬¡åˆ†æ‰‹"></a>å››æ¬¡åˆ†æ‰‹</h3><p>å½“å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹äº†TCPè¿æ¥ä»¥åï¼Œå½“æ•°æ®ä¼ é€å®Œæ¯•ï¼Œè‚¯å®šæ˜¯è¦æ–­å¼€TCPè¿æ¥çš„å•Šã€‚é‚£å¯¹äºTCPçš„æ–­å¼€è¿æ¥ï¼Œè¿™é‡Œå°±æœ‰äº†ç¥ç§˜çš„&ldquo;å››æ¬¡åˆ†æ‰‹&rdquo;ã€‚</p>
<blockquote>
<p>ç¬¬ä¸€æ¬¡åˆ†æ‰‹ï¼šä¸»æœº1ï¼ˆå¯ä»¥æ˜¯å®¢æˆ·ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯æœåŠ¡å™¨ç«¯ï¼‰ï¼Œè®¾ç½®<code>Sequence Number</code>å’Œ<code>Acknowledgment Number</code>ï¼Œå‘ä¸»æœº2å‘é€ä¸€ä¸ª<code>FIN</code>æŠ¥æ–‡æ®µï¼›æ­¤æ—¶ï¼Œä¸»æœº1è¿›å…¥<code>FIN_WAIT_1</code>çŠ¶æ€ï¼›è¿™è¡¨ç¤ºä¸»æœº1æ²¡æœ‰æ•°æ®è¦å‘é€ç»™ä¸»æœº2äº†ï¼›</p>
<p>ç¬¬äºŒæ¬¡åˆ†æ‰‹ï¼šä¸»æœº2æ”¶åˆ°äº†ä¸»æœº1å‘é€çš„<code>FIN</code>æŠ¥æ–‡æ®µï¼Œå‘ä¸»æœº1å›ä¸€ä¸ª<code>ACK</code>æŠ¥æ–‡æ®µï¼Œ<code>Acknowledgment Number</code>ä¸º<code>Sequence Number</code>åŠ 1ï¼›ä¸»æœº1è¿›å…¥<code>FIN_WAIT_2</code>çŠ¶æ€ï¼›ä¸»æœº2å‘Šè¯‰ä¸»æœº1ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œå¯ä»¥è¿›è¡Œå…³é—­è¿æ¥äº†ï¼›</p>
<p>ç¬¬ä¸‰æ¬¡åˆ†æ‰‹ï¼šä¸»æœº2å‘ä¸»æœº1å‘é€<code>FIN</code>æŠ¥æ–‡æ®µï¼Œè¯·æ±‚å…³é—­è¿æ¥ï¼ŒåŒæ—¶ä¸»æœº2è¿›å…¥<code>CLOSE_WAIT</code>çŠ¶æ€ï¼›</p>
<p>ç¬¬å››æ¬¡åˆ†æ‰‹ï¼šä¸»æœº1æ”¶åˆ°ä¸»æœº2å‘é€çš„FINæŠ¥æ–‡æ®µï¼Œå‘ä¸»æœº2å‘é€<code>ACK</code>æŠ¥æ–‡æ®µï¼Œç„¶åä¸»æœº1è¿›å…¥<code>TIME_WAIT</code>çŠ¶æ€ï¼›ä¸»æœº2æ”¶åˆ°ä¸»æœº1çš„<code>ACK</code>æŠ¥æ–‡æ®µä»¥åï¼Œå°±å…³é—­è¿æ¥ï¼›æ­¤æ—¶ï¼Œä¸»æœº1ç­‰å¾…<code>2MSL</code>åä¾ç„¶æ²¡æœ‰æ”¶åˆ°å›å¤ï¼Œåˆ™è¯æ˜<code>Server</code>ç«¯å·²æ­£å¸¸å…³é—­ï¼Œé‚£å¥½ï¼Œä¸»æœº1ä¹Ÿå¯ä»¥å…³é—­è¿æ¥äº†ã€‚</p>
</blockquote>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹</h3><p>å¼•è‡ªï¼šè°¢å¸Œä»çš„ã€Šè®¡ç®—æœºç½‘ç»œã€‹</p>
<blockquote>
<p>ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚</p>
</blockquote>
<p>ä¾‹å­ï¼š</p>
<blockquote>
<p>&ldquo;å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µ&rdquo;çš„äº§ç”Ÿåœ¨è¿™æ ·ä¸€ç§æƒ…å†µä¸‹ï¼šclientå‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œç»“ç‚¹é•¿æ—¶é—´çš„æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾serverã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½†serveræ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸ºæ˜¯clientå†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘clientå‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚å‡è®¾ä¸é‡‡ç”¨&ldquo;ä¸‰æ¬¡æ¡æ‰‹&rdquo;ï¼Œé‚£ä¹ˆåªè¦serverå‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚ç”±äºç°åœ¨clientå¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼Œå› æ­¤ä¸ä¼šç†ç¬serverçš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘serverå‘é€æ•°æ®ã€‚ä½†serverå´ä»¥ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹ï¼Œå¹¶ä¸€ç›´ç­‰å¾…clientå‘æ¥æ•°æ®ã€‚è¿™æ ·ï¼Œserverçš„å¾ˆå¤šèµ„æºå°±ç™½ç™½æµªè´¹æ‰äº†ã€‚é‡‡ç”¨&ldquo;ä¸‰æ¬¡æ¡æ‰‹&rdquo;çš„åŠæ³•å¯ä»¥é˜²æ­¢ä¸Šè¿°ç°è±¡å‘ç”Ÿã€‚ä¾‹å¦‚åˆšæ‰é‚£ç§æƒ…å†µï¼Œclientä¸ä¼šå‘serverçš„ç¡®è®¤å‘å‡ºç¡®è®¤ã€‚serverç”±äºæ”¶ä¸åˆ°ç¡®è®¤ï¼Œå°±çŸ¥é“clientå¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¿æ¥ã€‚&rdquo;</p>
</blockquote>
<p>æ‰€ä»¥ï¼Œä¸‰æ¬¡æ¡æ‰‹çš„ç›®çš„æ˜¯ï¼šé˜²æ­¢æœåŠ¡å™¨ç«¯ä¸€ç›´ç­‰å¾…è€Œæµªè´¹èµ„æº</p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="ä¸ºä»€ä¹ˆè¦å››æ¬¡åˆ†æ‰‹"><a href="#ä¸ºä»€ä¹ˆè¦å››æ¬¡åˆ†æ‰‹" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å››æ¬¡åˆ†æ‰‹"></a>ä¸ºä»€ä¹ˆè¦å››æ¬¡åˆ†æ‰‹</h3><p>é‚£å››æ¬¡åˆ†æ‰‹åˆæ˜¯ä¸ºä½•å‘¢ï¼Ÿ<code>TCP</code>åè®®æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„è¿è¾“å±‚é€šä¿¡åè®®ã€‚<code>TCP</code>æ˜¯å…¨åŒå·¥æ¨¡å¼ï¼Œè¿™å°±æ„å‘³ç€ï¼Œå½“ä¸»æœº1å‘å‡º<code>FIN</code>æŠ¥æ–‡æ®µæ—¶ï¼Œåªæ˜¯è¡¨ç¤ºä¸»æœº1å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä¸»æœº1å‘Šè¯‰ä¸»æœº2ï¼Œå®ƒçš„æ•°æ®å·²ç»å…¨éƒ¨å‘é€å®Œæ¯•äº†ï¼›ä½†æ˜¯ï¼Œè¿™ä¸ªæ—¶å€™ä¸»æœº1è¿˜æ˜¯å¯ä»¥æ¥å—æ¥è‡ªä¸»æœº2çš„æ•°æ®ï¼›å½“ä¸»æœº2è¿”å›<code>ACK</code>æŠ¥æ–‡æ®µæ—¶ï¼Œè¡¨ç¤ºå®ƒå·²ç»çŸ¥é“ä¸»æœº1æ²¡æœ‰æ•°æ®å‘é€äº†ï¼Œä½†æ˜¯ä¸»æœº2è¿˜æ˜¯å¯ä»¥å‘é€æ•°æ®åˆ°ä¸»æœº1çš„ï¼›å½“ä¸»æœº2ä¹Ÿå‘é€äº†<code>FIN</code>æŠ¥æ–‡æ®µæ—¶ï¼Œè¿™ä¸ªæ—¶å€™å°±è¡¨ç¤ºä¸»æœº2ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œå°±ä¼šå‘Šè¯‰ä¸»æœº1ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä¹‹åå½¼æ­¤å°±ä¼šæ„‰å¿«çš„ä¸­æ–­è¿™æ¬¡<code>TCP</code>è¿æ¥ã€‚å¦‚æœè¦æ­£ç¡®çš„ç†è§£å››æ¬¡åˆ†æ‰‹çš„åŸç†ï¼Œå°±éœ€è¦äº†è§£å››æ¬¡åˆ†æ‰‹è¿‡ç¨‹ä¸­çš„çŠ¶æ€å˜åŒ–ã€‚</p>
<blockquote>
<ul>
<li><p><code>FIN_WAIT_1</code>: è¿™ä¸ªçŠ¶æ€è¦å¥½å¥½è§£é‡Šä¸€ä¸‹ï¼Œå…¶å®<code>FIN_WAIT_1</code>å’Œ<code>FIN_WAIT_2</code>çŠ¶æ€çš„çœŸæ­£å«ä¹‰éƒ½æ˜¯è¡¨ç¤ºç­‰å¾…å¯¹æ–¹çš„<code>FIN</code>æŠ¥æ–‡ã€‚è€Œè¿™ä¸¤ç§çŠ¶æ€çš„åŒºåˆ«æ˜¯ï¼š<code>FIN_WAIT_1</code>çŠ¶æ€å®é™…ä¸Šæ˜¯å½“<code>SOCKET</code>åœ¨<code>ESTABLISHED</code>çŠ¶æ€æ—¶ï¼Œå®ƒæƒ³ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œå‘å¯¹æ–¹å‘é€äº†<code>FIN</code>æŠ¥æ–‡ï¼Œæ­¤æ—¶è¯¥<code>SOCKET</code>å³è¿›å…¥åˆ°<code>FIN_WAIT_1</code>çŠ¶æ€ã€‚è€Œå½“å¯¹æ–¹å›åº”<code>ACK</code>æŠ¥æ–‡åï¼Œåˆ™è¿›å…¥åˆ°<code>FIN_WAIT_2</code>çŠ¶æ€ï¼Œå½“ç„¶åœ¨å®é™…çš„æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ— è®ºå¯¹æ–¹ä½•ç§æƒ…å†µä¸‹ï¼Œéƒ½åº”è¯¥é©¬ä¸Šå›åº”<code>ACK</code>æŠ¥æ–‡ï¼Œæ‰€ä»¥<code>FIN_WAIT_1</code>çŠ¶æ€ä¸€èˆ¬æ˜¯æ¯”è¾ƒéš¾è§åˆ°çš„ï¼Œè€Œ<code>FIN_WAIT_2</code>çŠ¶æ€è¿˜æœ‰æ—¶å¸¸å¸¸å¯ä»¥ç”¨<code>netstat</code>çœ‹åˆ°ã€‚ï¼ˆä¸»åŠ¨æ–¹ï¼‰&nbsp;</p>
</li>
<li><p><code>FIN_WAIT_2</code>ï¼šä¸Šé¢å·²ç»è¯¦ç»†è§£é‡Šäº†è¿™ç§çŠ¶æ€ï¼Œå®é™…ä¸Š<code>FIN_WAIT_2</code>çŠ¶æ€ä¸‹çš„<code>SOCKET</code>ï¼Œè¡¨ç¤ºåŠè¿æ¥ï¼Œä¹Ÿå³æœ‰ä¸€æ–¹è¦æ±‚<code>close</code>è¿æ¥ï¼Œä½†å¦å¤–è¿˜å‘Šè¯‰å¯¹æ–¹ï¼Œæˆ‘æš‚æ—¶è¿˜æœ‰ç‚¹æ•°æ®éœ€è¦ä¼ é€ç»™ä½ (<code>ACK</code>ä¿¡æ¯)ï¼Œç¨åå†å…³é—­è¿æ¥ã€‚ï¼ˆä¸»åŠ¨æ–¹ï¼‰&nbsp;</p>
</li>
<li><p><code>CLOSE_WAIT</code>ï¼šè¿™ç§çŠ¶æ€çš„å«ä¹‰å…¶å®æ˜¯è¡¨ç¤ºåœ¨ç­‰å¾…å…³é—­ã€‚æ€ä¹ˆç†è§£å‘¢ï¼Ÿå½“å¯¹æ–¹<code>close</code>ä¸€ä¸ª<code>SOCKET</code>åå‘é€<code>FIN</code>æŠ¥æ–‡ç»™è‡ªå·±ï¼Œä½ ç³»ç»Ÿæ¯«æ— ç–‘é—®åœ°ä¼šå›åº”ä¸€ä¸ª<code>ACK</code>æŠ¥æ–‡ç»™å¯¹æ–¹ï¼Œæ­¤æ—¶åˆ™è¿›å…¥åˆ°<code>CLOSE_WAIT</code>çŠ¶æ€ã€‚æ¥ä¸‹æ¥å‘¢ï¼Œå®é™…ä¸Šä½ çœŸæ­£éœ€è¦è€ƒè™‘çš„äº‹æƒ…æ˜¯å¯Ÿçœ‹ä½ æ˜¯å¦è¿˜æœ‰æ•°æ®å‘é€ç»™å¯¹æ–¹ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé‚£ä¹ˆä½ ä¹Ÿå°±å¯ä»¥&nbsp;<code>close</code>è¿™ä¸ª<code>SOCKET</code>ï¼Œå‘é€<code>FIN</code>æŠ¥æ–‡ç»™å¯¹æ–¹ï¼Œä¹Ÿå³å…³é—­è¿æ¥ã€‚æ‰€ä»¥ä½ åœ¨<code>CLOSE_WAIT</code>çŠ¶æ€ä¸‹ï¼Œéœ€è¦å®Œæˆçš„äº‹æƒ…æ˜¯ç­‰å¾…ä½ å»å…³é—­è¿æ¥ã€‚ï¼ˆè¢«åŠ¨æ–¹ï¼‰&nbsp;</p>
</li>
<li><p><code>LAST_ACK</code>: è¿™ä¸ªçŠ¶æ€è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“å¥½ç†è§£çš„ï¼Œå®ƒæ˜¯è¢«åŠ¨å…³é—­ä¸€æ–¹åœ¨å‘é€<code>FIN</code>æŠ¥æ–‡åï¼Œæœ€åç­‰å¾…å¯¹æ–¹çš„<code>ACK</code>æŠ¥æ–‡ã€‚å½“æ”¶åˆ°<code>ACK</code>æŠ¥æ–‡åï¼Œä¹Ÿå³å¯ä»¥è¿›å…¥åˆ°<code>CLOSED</code>å¯ç”¨çŠ¶æ€äº†ã€‚ï¼ˆè¢«åŠ¨æ–¹ï¼‰&nbsp;</p>
</li>
<li><p><code>TIME_WAIT</code>: è¡¨ç¤ºæ”¶åˆ°äº†å¯¹æ–¹çš„<code>FIN</code>æŠ¥æ–‡ï¼Œå¹¶å‘é€å‡ºäº†<code>ACK</code>æŠ¥æ–‡ï¼Œå°±ç­‰<code>2MSL</code>åå³å¯å›åˆ°<code>CLOSED</code>å¯ç”¨çŠ¶æ€äº†ã€‚å¦‚æœ<code>FINWAIT1</code>çŠ¶æ€ä¸‹ï¼Œæ”¶åˆ°äº†å¯¹æ–¹åŒæ—¶å¸¦<code>FIN</code>æ ‡å¿—å’Œ<code>ACK</code>æ ‡å¿—çš„æŠ¥æ–‡æ—¶ï¼Œå¯ä»¥ç›´æ¥è¿›å…¥åˆ°<code>TIME_WAIT</code>çŠ¶æ€ï¼Œè€Œæ— é¡»ç»è¿‡<code>FIN_WAIT_2</code>çŠ¶æ€ã€‚ï¼ˆä¸»åŠ¨æ–¹ï¼‰&nbsp;</p>
</li>
<li><p><code>CLOSED</code>: è¡¨ç¤ºè¿æ¥ä¸­æ–­ã€‚</p>
</li>
</ul>
</blockquote>
<p><a href="http://www.jellythink.com/archives/705" target="_blank" rel="noopener">ç®€æTCPçš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡åˆ†æ‰‹</a></p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h2 id="äº’è”ç½‘åè®®å…¥é—¨ï¼ˆä¸€ï¼‰"><a href="#äº’è”ç½‘åè®®å…¥é—¨ï¼ˆä¸€ï¼‰" class="headerlink" title="äº’è”ç½‘åè®®å…¥é—¨ï¼ˆä¸€ï¼‰"></a>äº’è”ç½‘åè®®å…¥é—¨ï¼ˆä¸€ï¼‰</h2><div class="md-section-divider">&nbsp;</div>

<h3 id="ä¸ƒå±‚æ¨¡å‹ä¸äº”å±‚æ¨¡å‹"><a href="#ä¸ƒå±‚æ¨¡å‹ä¸äº”å±‚æ¨¡å‹" class="headerlink" title="ä¸ƒå±‚æ¨¡å‹ä¸äº”å±‚æ¨¡å‹"></a>ä¸ƒå±‚æ¨¡å‹ä¸äº”å±‚æ¨¡å‹</h3><hr>
<div class="md-section-divider">&nbsp;</div>

<h4 id="ä¸ƒå±‚æ¨¡å‹"><a href="#ä¸ƒå±‚æ¨¡å‹" class="headerlink" title="ä¸ƒå±‚æ¨¡å‹"></a>ä¸ƒå±‚æ¨¡å‹</h4><p>ä¸ƒå±‚æ¨¡å‹ï¼Œç»å…¸å´ä¸å®ç”¨&nbsp;<br><img src="http://7xjv7y.com1.z0.glb.clouddn.com/OSI_seven.jpg" alt=""></p>
<p>å„å±‚çš„æ•°æ®å°è£…æƒ…å†µ&nbsp;<br><img src="http://jellythink.u.qiniudn.com/jellythinkTCP1.jpg" alt=""></p>
<p>å„å±‚çš„åŠŸèƒ½ä¸éµä»åè®®&nbsp;<br><img src="http://jellythink.u.qiniudn.com/jellythinkTCP2.gif" alt=""></p>
<p><code>TCP</code>å·¥ä½œåœ¨ç½‘ç»œ<code>OSI</code>çš„ä¸ƒå±‚æ¨¡å‹ä¸­çš„ç¬¬å››å±‚&mdash;&mdash;<code>Transport</code>å±‚ï¼Œ<code>IP</code>åœ¨ç¬¬ä¸‰å±‚&mdash;&mdash;<code>Network</code>å±‚ï¼Œ<code>ARP</code>åœ¨ç¬¬äºŒå±‚&mdash;&mdash;<code>Data Link</code>å±‚ã€‚</p>
<p>åœ¨ç¬¬äºŒå±‚ä¸Šçš„æ•°æ®ï¼Œæˆ‘ä»¬æŠŠå®ƒå«<code>Frame</code>ï¼Œåœ¨ç¬¬ä¸‰å±‚ä¸Šçš„æ•°æ®å«<code>Packet</code>ï¼Œç¬¬å››å±‚çš„æ•°æ®å«<code>Segment</code>ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ç®€å•çš„çŸ¥é“ï¼Œæ•°æ®ä»åº”ç”¨å±‚å‘ä¸‹æ¥ï¼Œä¼šåœ¨æ¯ä¸€å±‚éƒ½ä¼šåŠ ä¸Šå¤´éƒ¨ä¿¡æ¯ï¼Œè¿›è¡Œå°è£…ï¼Œç„¶åå†å‘é€åˆ°æ•°æ®æ¥æ”¶ç«¯ã€‚è¿™ä¸ªåŸºæœ¬çš„æµç¨‹ä½ éœ€è¦çŸ¥é“ï¼Œå°±æ˜¯æ¯ä¸ªæ•°æ®éƒ½ä¼šç»è¿‡æ•°æ®çš„å°è£…å’Œè§£å°è£…çš„è¿‡ç¨‹ã€‚</p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h4 id="äº”å±‚æ¨¡å‹"><a href="#äº”å±‚æ¨¡å‹" class="headerlink" title="äº”å±‚æ¨¡å‹"></a>äº”å±‚æ¨¡å‹</h4><p>æŠŠåº”ç”¨å±‚ã€è¡¨ç¤ºå±‚å’Œä¼šè¯å±‚åˆå¹¶åˆ°åº”ç”¨å±‚ï¼Œç®€åŒ–ä¸ºäº”å±‚æ¨¡å‹ï¼ŒåŸå› æ˜¯ä¸ºäº†æ›´åŠ åœ°é€šä¿—æ˜“æ‡‚ã€‚&nbsp;<br><img src="http://image.beekka.com/blog/201205/bg2012052902.png" alt=""></p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h5 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h5><p>ç”±äºäº’è”ç½‘æ˜¯å¼€æ”¾æ¶æ„ï¼Œæ•°æ®æ¥æºäº”èŠ±å…«é—¨ï¼Œå¿…é¡»äº‹å…ˆè§„å®šå¥½æ ¼å¼ï¼Œå¦åˆ™æ ¹æœ¬æ— æ³•è§£è¯»ã€‚</p>
<p>â€œåº”ç”¨å±‚â€çš„ä½œç”¨ï¼Œå°±æ˜¯å¤„ç†å¹¶è§„å®šåº”ç”¨ç¨‹åºçš„æ•°æ®æ ¼å¼ã€‚æ‰€ä»¥åœ¨åº”ç”¨å±‚è§„å®šäº†ä¸€ç³»åˆ—æˆ‘ä»¬æœ€å¸¸ç”¨ï¼Œä¹Ÿå¾ˆå®¹æ˜“çœ‹å¾—è§çš„åè®®ï¼Œæˆ‘ä»¬çš„æ™®é€šç”¨æˆ·ä¹Ÿè®¸ä¸çŸ¥é“åº•å±‚çš„åè®®æƒ…å†µï¼Œä½†æ˜¯ä¸€å®šçŸ¥é“è¿™äº›åº”ç”¨å±‚çš„åè®®</p>
<ul>
<li><code>HTTP/HTTPS</code></li>
<li><code>FTP</code></li>
<li><code>SMTP</code></li>
<li><code>DNS</code></li>
</ul>
<p>æœ‰ä¸åŒåè®®è§„å®š&nbsp;ç”µå­é‚®ä»¶ã€ç½‘é¡µã€FTP æ•°æ®&nbsp;çš„æ ¼å¼ï¼Œè¿™äº›åº”ç”¨ç¨‹åºåè®®å°±æ„æˆäº†&ldquo;åº”ç”¨å±‚&rdquo;ã€‚</p>
<p>è¿™æ˜¯æœ€é«˜çš„ä¸€å±‚ï¼Œç›´æ¥é¢å¯¹ç”¨æˆ·ã€‚å®ƒçš„æ•°æ®ä¸€èˆ¬åŒ…å«è§„èŒƒçš„åº”ç”¨å±‚åè®®å¤´&nbsp;<br><img src="http://static.zybuluo.com/yangfch3/wv1xh5qhgg969odokvs9t94h/2016-03-27_140636.jpg" alt="2016-03-27_140636.jpg-7kB"></p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h5 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h5><ul>
<li><p>ç«¯å£ï¼šä¸€å°ä¸»æœºä¸Šè¿è¡Œå¤šä¸ªç¨‹åºï¼Œæ¯ä¸ªéœ€è¦ç½‘ç»œæœåŠ¡çš„ç¨‹åºéƒ½ä¼šæœ‰è‡ªå·±çš„ä¸»æœºç«¯å£ï¼Œç”¨äºå†³å®šåˆ°åº•å“ªä¸ªç¨‹åºä½¿ç”¨é‚£ä¸ªç«¯å£æ¥å‘é€å’Œæ¥æ”¶æ•°æ®åŒ…ï¼Ÿï¼ˆä¸å¯èƒ½æ¯ä¸ªç¨‹åºéƒ½æ¥æ”¶æ•°æ®åŒ…ï¼Œæ€§èƒ½å’Œå®‰å…¨ä¸Šéƒ½åˆ’ä¸æ¥ï¼‰</p>
</li>
<li><p>ç½‘å¡çš„ä¸åŒç«¯å£å¯¹åº”ä¸åŒç¨‹åºçš„æ•°æ®ä¼ é€’</p>
<ol>
<li>1-1023ç«¯å£æ˜¯ç³»ç»Ÿå ç”¨</li>
<li>1024-65535ç«¯å£ä¼šè¢«åº”ç”¨ç¨‹åºéšæœºåˆ†é…ï¼ˆåœ¨ç¨‹åºæ²¡æœ‰æ˜ç¡®è¦æ±‚ç”¨å“ªä¸ªç«¯å£çš„æƒ…å†µä¸‹ï¼‰</li>
</ol>
</li>
<li><p>ä¸»æœº+ç«¯å£=socketï¼ˆå¥—æ¥å­—ï¼‰</p>
</li>
<li><p>ä¼ è¾“å±‚åè®®ï¼šåœ¨æ•°æ®åŒ…ä¸­åŠ å…¥ä¼ è¾“å±‚åè®®å¤´ï¼ˆTCP/UDP ç«¯å£ä¿¡æ¯)</p>
<ol>
<li>UDPåè®®&nbsp;<br>åœ¨&nbsp;åº”ç”¨å±‚æ•°æ®&nbsp;ä¸­åŠ å…¥&nbsp;ç«¯å£ä¿¡æ¯&nbsp;æœ€ç®€å•çš„å®ç°æ–¹å¼ï¼Œå¦‚ä½•ä¸ªç®€å•æ³•ï¼šå®ƒçš„æ ¼å¼å‡ ä¹å°±æ˜¯åœ¨æ•°æ®å‰é¢ï¼ŒåŠ ä¸Šç«¯å£å·ï¼Œå°è£…æˆä¸º&nbsp;<code>UDP</code>&nbsp;æ•°æ®åŒ…ã€‚</li>
</ol>
<p>UDP æ•°æ®åŒ…&nbsp;çš„æ€»é•¿åº¦ä¸è¶…è¿‡&nbsp;<code>65535</code>&nbsp;å­—èŠ‚</p>
<pre><code>    *   æ ‡å¤´ï¼ˆHeadï¼‰ï¼šå®šä¹‰äº†å‘å‡ºç«¯å£å’Œæ¥æ”¶ç«¯å£ï¼Œé•¿åº¦åªæœ‰8å­—èŠ‚
*   æ•°æ®ï¼ˆDataï¼‰ï¼šæ¥è‡ªåº”ç”¨å±‚çš„å…·ä½“çš„æ•°æ®
</code></pre><blockquote>
<p>ç¼ºç‚¹ï¼šå¯é æ€§è¾ƒå·®ï¼Œä¸€æ—¦æ•°æ®åŒ…å‘å‡ºï¼Œæ— æ³•çŸ¥é“å¯¹æ–¹æ˜¯å¦æ”¶åˆ°ï¼Œæ²¡æœ‰ç¡®è®¤æœºåˆ¶</p>
</blockquote>
<pre><code>2.  TCP åè®®&amp;nbsp;
</code></pre><p>è¿‘ä¼¼è®¤ä¸ºï¼Œå®ƒå°±æ˜¯&nbsp;æœ‰ç¡®è®¤æœºåˆ¶&nbsp;çš„&nbsp;<code>UDP</code>&nbsp;åè®®ï¼Œæ¯å‘å‡ºä¸€ä¸ªæ•°æ®åŒ…éƒ½&nbsp;è¦æ±‚ç¡®è®¤ã€‚å¦‚æœæœ‰ä¸€ä¸ªæ•°æ®åŒ…é—å¤±ï¼Œå°±æ”¶ä¸åˆ°ç¡®è®¤ï¼Œå‘å‡ºæ–¹å°±çŸ¥é“æœ‰å¿…è¦é‡å‘è¿™ä¸ªæ•°æ®åŒ…ã€‚</p>
<p><code>TCP</code>&nbsp;åè®®èƒ½å¤Ÿç¡®ä¿æ•°æ®ä¸ä¼šé—å¤±ã€‚å®ƒçš„ç¼ºç‚¹æ˜¯è¿‡ç¨‹å¤æ‚ã€å®ç°å›°éš¾ã€æ¶ˆè€—è¾ƒå¤šçš„èµ„æºã€‚</p>
<p><code>TCP</code>&nbsp;æ•°æ®åŒ…å’Œ&nbsp;<code>UDP</code>&nbsp;æ•°æ®åŒ…ä¸€æ ·ï¼Œä½†&nbsp;<code>TCP</code>&nbsp;æ•°æ®åŒ…æ²¡æœ‰é•¿åº¦é™åˆ¶ï¼Œç†è®ºä¸Š&nbsp;å¯ä»¥æ— é™é•¿ã€‚</p>
</li>
</ul>
<blockquote>
<p>ä½†æ˜¯ä¸ºäº†ä¿è¯ç½‘ç»œçš„æ•ˆç‡ï¼Œé€šå¸¸&nbsp;<code>TCP</code>&nbsp;æ•°æ®åŒ…çš„é•¿åº¦ä¸ä¼šè¶…è¿‡&nbsp;ç½‘ç»œå±‚&nbsp;<code>IP</code>&nbsp;æ•°æ®åŒ…&nbsp;çš„é•¿åº¦ï¼Œä»¥ç¡®ä¿å•ä¸ª&nbsp;<code>TCP</code>æ•°æ®åŒ…ä¸å¿…åœ¨ä¸‹ä¸€çº§çš„å°è£…ä¸­è¢«åˆ†å‰²ã€‚</p>
</blockquote>
<p>å°±æ”¾åœ¨TCPæ•°æ®åŒ…çš„â€æ•°æ®â€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œç°åœ¨çš„ä»¥å¤ªç½‘çš„æ•°æ®åŒ…å°±å˜æˆä¸‹é¢è¿™æ ·ï¼š</p>
<blockquote>
<p>TCP æ•°æ®å¤´&nbsp;&gt;&gt;&nbsp;åº”ç”¨å±‚æ•°æ®åŒ…&nbsp;<br><img src="http://image.beekka.com/blog/201205/bg2012052904.png" alt=""></p>
</blockquote>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h5 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h5><ul>
<li><p>ä¼ è¾“å±‚å·²ç»ä¸ºæˆ‘ä»¬çš„æ•°æ®åŒºåˆ†äº†ä¸åŒçš„ç«¯å£ï¼ˆåº”ç”¨ç¨‹åºï¼‰</p>
</li>
<li><p>ç½‘ç»œå±‚å¼•è¿›ä¸€å¥—æ–°çš„ç½‘ç»œåœ°å€åè®®ï¼ˆ<code>Internet Protocol</code>ï¼‰ï¼Œèƒ½åŒºåˆ†ä¸åŒè®¡ç®—æœºæ˜¯å¦å±äºåŒä¸€å­ç½‘</p>
</li>
<li><p>è·¯ç”±ï¼šå®ç°ä¸åŒ&nbsp;<code>IP</code>&nbsp;çš„ä¸»æœºï¼ˆæˆ–æœåŠ¡å™¨ï¼‰ä¹‹é—´çš„æ•°æ®åŒ…ä¼ è¾“</p>
</li>
<li><p><code>IP</code>&nbsp;æ•°æ®åŒ…æ ‡å¤´ï¼š</p>
<ol>
<li>åŒ…å«åè®®ç‰ˆæœ¬ã€é•¿åº¦ã€<code>IP</code>&nbsp;åœ°å€ç­‰ä¿¡æ¯</li>
<li>é•¿åº¦ï¼š20-60 å­—èŠ‚</li>
</ol>
</li>
<li><p><code>IP</code>&nbsp;æ•°æ®åŒ…æ•´ä½“é•¿åº¦æœ€é•¿ä¸è¶…è¿‡&nbsp;<code>65515</code>&nbsp;å­—èŠ‚ï¼Œå¦‚æœæ•°æ®åŒ…è¶…è¿‡äº†&nbsp;<code>65515</code>&nbsp;å­—èŠ‚å°†ä¼šè¢«åˆ†å‰²ä¸ºå¤šä¸ª&nbsp;<code>IP</code>&nbsp;æ•°æ®åŒ…å‘é€</p>
</li>
<li><p>æ•°æ®å½¢å¼ï¼š</p>
</li>
</ul>
<blockquote>
<p>IP åè®®å¤´&nbsp;&gt;&gt;&nbsp;TCP åè®®å¤´&nbsp;&gt;&gt;&nbsp;åº”ç”¨å±‚æ•°æ®&nbsp;<br><img src="http://image.beekka.com/blog/201205/bg2012052910.png" alt=""></p>
</blockquote>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h5 id="æ•°æ®é“¾è·¯å±‚"><a href="#æ•°æ®é“¾è·¯å±‚" class="headerlink" title="æ•°æ®é“¾è·¯å±‚"></a>æ•°æ®é“¾è·¯å±‚</h5><ul>
<li><p>éµå¾ªåè®®ï¼š<code>ä»¥å¤ªç½‘åè®®</code></p>
</li>
<li><p>æ•°æ®å¸§ï¼š<code>IP</code>&nbsp;æ•°æ®åŒ…&nbsp;åˆ°è¾¾&nbsp;æ•°æ®é“¾è·¯å±‚&nbsp;åä¼šè¿›è¡Œåˆ†å‰²ï¼Œå˜ä¸ºå¤šä¸ªå°å‹çš„æ•°æ®åŒ…ï¼Œåˆå«åš&nbsp;æ•°æ®å¸§</p>
</li>
<li><p>å•ä¸ªæ•°æ®å¸§æœ€é•¿ä¸º&nbsp;1518&nbsp;å­—èŠ‚ï¼Œæœ€çŸ­ä¸º&nbsp;64&nbsp;å­—èŠ‚</p>
</li>
<li><p><code>æ•°æ®å¸§</code>åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li>æ ‡å¤´ï¼ˆHeadï¼‰</li>
<li>æ•°æ®ï¼ˆDataï¼‰</li>
</ul>
</li>
<li><p>å®šä½å‡†ç¡®åœ°å€çš„æ–¹æ¡ˆï¼š<code>MAC</code>&nbsp;åœ°å€</p>
</li>
<li><p>æ•°æ®å¸§&nbsp;æ ‡å¤´ï¼š</p>
<ol>
<li>å›ºå®š&nbsp;<code>18</code>&nbsp;å­—èŠ‚</li>
<li>åŒ…å«æ•°æ®å¸§è¯´æ˜é¡¹ï¼šå‘é€è€…ï¼ˆMACåœ°å€ï¼‰ï¼Œæ¥å—è€…ï¼ˆMACåœ°å€ï¼‰ï¼Œæ•°æ®ç±»å‹</li>
</ol>
</li>
<li><p>æ•°æ®å¸§&nbsp;æœ€çŸ­&nbsp;<code>46</code>&nbsp;å­—èŠ‚ï¼Œæœ€é•¿&nbsp;<code>1500</code>&nbsp;å­—èŠ‚</p>
</li>
<li><p>MAC åœ°å€ï¼šæ¯å—ç½‘å¡ç‹¬ä¸€æ— äºŒï¼›48 ä¸ªäºŒè¿›åˆ¶&nbsp;===&gt;&nbsp;12 ä¸ªåå…­è¿›åˆ¶&nbsp;===&gt;&nbsp;6 ä¸ªå‚å•†ç¼–ç  +6 ä½ç½‘å¡æµæ°´å·</p>
</li>
<li><p><code>ARP</code>ï¼ˆ<code>Address Resolution Protocol</code>ï¼‰ï¼šç½‘å¡çš„&nbsp;<code>MAC</code>&nbsp;åœ°å€å¯»å€ä¾é &nbsp;<code>ARP</code>&nbsp;åè®® &mdash;&mdash; åŒä¸€å­ç½‘ï¼Œå³æ•°æ®å¸§&nbsp;<code>å¹¿æ’­</code>ï¼Œå…¨éƒ¨ç½‘å¡æ¥æ”¶ï¼Œæ¯”å¯¹æ•°æ®å¸§æ ‡å¤´ï¼Œç¬¦åˆè€…æ¥æ”¶ï¼Œä¸ç¬¦è€…ä¸¢å¼ƒ</p>
</li>
<li><p>æ•°æ®é“¾è·¯å±‚æ•°æ®æ ¼å¼&nbsp;</p>
</li>
</ul>
<blockquote>
<p><img src="http://image.beekka.com/blog/201205/bg2012052913.png" alt=""></p>
</blockquote>
<p>&nbsp;</p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h5 id="å®ä½“å±‚"><a href="#å®ä½“å±‚" class="headerlink" title="å®ä½“å±‚"></a>å®ä½“å±‚</h5><ul>
<li><p>æŠŠç”µè„‘è¿æ¥èµ·æ¥çš„ç‰©ç†æ‰‹æ®µ</p>
</li>
<li><p>åœ¨è¿™ä¸ªå±‚é¢é‡Œï¼Œæ•°æ®å¸§è½¬æ¢ä¸º ä¼ è¾“ 0 å’Œ 1 çš„ç”µä¿¡å·</p>
</li>
</ul>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h5 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h5><ul>
<li><p>ä¸Šé¢çš„è®²è¿°äº†æ•°æ®ä»ä¸Šåˆ°ä¸‹ï¼Œå±‚å±‚&nbsp;åˆ†å‰²ï¼Œå±‚å±‚&nbsp;åŒ…è£…&nbsp;çš„è¿‡ç¨‹</p>
</li>
<li><p>è§£åŒ…çš„è¿‡ç¨‹ä¸ä¸Šé¢çš„è¿‡ç¨‹åˆšå¥½ç›¸å</p>
</li>
<li><p>è·¯ç”±åè®®ç”¨äºä¸åŒ IP ä¹‹é—´ä¼ é€’æ•°æ®</p>
</li>
<li><p>ARP åè®®ç”¨äºåŒä¸€å±€åŸŸç½‘ä¸‹ä¸åŒç½‘å¡æ¥æ”¶æ•°æ®</p>
</li>
</ul>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h2 id="äº’è”ç½‘åè®®å…¥é—¨ï¼ˆäºŒï¼‰"><a href="#äº’è”ç½‘åè®®å…¥é—¨ï¼ˆäºŒï¼‰" class="headerlink" title="äº’è”ç½‘åè®®å…¥é—¨ï¼ˆäºŒï¼‰"></a>äº’è”ç½‘åè®®å…¥é—¨ï¼ˆäºŒï¼‰</h2><p>ä»ç”¨æˆ·çš„è§’åº¦ä»ä¸Šè‡³ä¸‹çœ‹äº’è”ç½‘åè®®</p>
<div class="md-section-divider">&nbsp;</div>

<h3 id="ä¸ŠèŠ‚å°ç»“"><a href="#ä¸ŠèŠ‚å°ç»“" class="headerlink" title="ä¸ŠèŠ‚å°ç»“"></a>ä¸ŠèŠ‚å°ç»“</h3><p>ç½‘ç»œé€šä¿¡å°±æ˜¯äº¤æ¢æ•°æ®åŒ…ã€‚ç”µè„‘Aå‘ç”µè„‘Bå‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œåè€…æ”¶åˆ°äº†ï¼Œå›å¤ä¸€ä¸ªæ•°æ®åŒ…ï¼Œä»è€Œå®ç°ä¸¤å°ç”µè„‘ä¹‹é—´çš„é€šä¿¡ã€‚æ•°æ®åŒ…çš„ç»“æ„ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸‹é¢è¿™æ ·ï¼š</p>
<p><img src="http://image.beekka.com/blog/201205/bg2012052913.png" alt=""></p>
<p>å‘é€è¿™ä¸ªåŒ…ï¼Œéœ€è¦çŸ¥é“ä¸¤ä¸ªåœ°å€ï¼š</p>
<blockquote>
<ul>
<li>å¯¹æ–¹çš„MACåœ°å€</li>
<li>å¯¹æ–¹çš„IPåœ°å€</li>
</ul>
</blockquote>
<p>æœ‰äº†è¿™ä¸¤ä¸ªåœ°å€ï¼Œæ•°æ®åŒ…æ‰èƒ½å‡†ç¡®é€åˆ°æ¥æ”¶è€…æ‰‹ä¸­ã€‚ä½†æ˜¯ï¼Œå‰é¢è¯´è¿‡ï¼ŒMACåœ°å€æœ‰å±€é™æ€§ï¼Œå¦‚æœä¸¤å°ç”µè„‘ä¸åœ¨åŒä¸€ä¸ªå­ç½‘ç»œï¼Œå°±æ— æ³•çŸ¥é“å¯¹æ–¹çš„MACåœ°å€ï¼Œå¿…é¡»é€šè¿‡ç½‘å…³ï¼ˆgatewayï¼‰è½¬å‘ã€‚</p>
<p><img src="http://image.beekka.com/blog/201206/bg2012061101.jpg" alt=""></p>
<p>ä¸Šå›¾ä¸­ï¼Œ1å·ç”µè„‘è¦å‘4å·ç”µè„‘å‘é€ä¸€ä¸ªæ•°æ®åŒ…ã€‚å®ƒå…ˆåˆ¤æ–­4å·ç”µè„‘æ˜¯å¦åœ¨åŒä¸€ä¸ªå­ç½‘ç»œï¼Œç»“æœå‘ç°ä¸æ˜¯ï¼ˆåˆ¤æ–­æ–¹æ³•è§ä¸‹é¢ï¼‰ï¼Œäºæ˜¯å°±æŠŠè¿™ä¸ªæ•°æ®åŒ…å‘åˆ°ç½‘å…³Aã€‚ç½‘å…³Aé€šè¿‡è·¯ç”±åè®®ï¼Œå‘ç°4å·ç”µè„‘ä½äºå­ç½‘ç»œBï¼ŒåˆæŠŠæ•°æ®åŒ…å‘ç»™ç½‘å…³Bï¼Œç½‘å…³Bå†è½¬å‘åˆ°4å·ç”µè„‘ã€‚</p>
<p>1å·ç”µè„‘æŠŠæ•°æ®åŒ…å‘åˆ°ç½‘å…³Aï¼Œå¿…é¡»çŸ¥é“ç½‘å…³Açš„MACåœ°å€ã€‚æ‰€ä»¥ï¼Œæ•°æ®åŒ…çš„ç›®æ ‡åœ°å€ï¼Œå®é™…ä¸Šåˆ†æˆä¸¤ç§æƒ…å†µï¼š</p>
<table class="table table-striped-white table-bordered" data-anchor-id="qtxz"><br><thead><br><tr><th>åœºæ™¯</th><th>æ•°æ®åŒ…åœ°å€</th></tr><br><br></thead><br><tbody><br><tr><br><td>åŒä¸€ä¸ªå­ç½‘ç»œ</td><br><td>å¯¹æ–¹çš„MACåœ°å€ï¼ˆé€šè¿‡ARPè·å¾—ï¼‰ï¼Œå¯¹æ–¹çš„IPåœ°å€</td><br><br></tr><br><tr><br><td>éåŒä¸€ä¸ªå­ç½‘ç»œ</td><br><td>ç½‘å…³çš„MACåœ°å€ï¼Œå¯¹æ–¹çš„IPåœ°å€</td><br><br></tr><br><br></tbody><br><br></table>

<p>å‘é€æ•°æ®åŒ…ä¹‹å‰ï¼Œç”µè„‘å¿…é¡»åˆ¤æ–­å¯¹æ–¹æ˜¯å¦åœ¨åŒä¸€ä¸ªå­ç½‘ç»œï¼Œç„¶åé€‰æ‹©ç›¸åº”çš„MACåœ°å€ï¼šå¯¹æ–¹çš„MACåœ°å€è¿˜æ˜¯ç½‘å…³çš„MACåœ°å€</p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="ç”¨æˆ·ä¸Šç½‘è®¾ç½®"><a href="#ç”¨æˆ·ä¸Šç½‘è®¾ç½®" class="headerlink" title="ç”¨æˆ·ä¸Šç½‘è®¾ç½®"></a>ç”¨æˆ·ä¸Šç½‘è®¾ç½®</h3><p>åˆ†ä¸ºé™æ€IPåœ°å€ä¸Šç½‘å’ŒåŠ¨æ€IPåœ°å€ä¸Šç½‘&nbsp;</p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="åŠ¨æ€IPåœ°å€"><a href="#åŠ¨æ€IPåœ°å€" class="headerlink" title="åŠ¨æ€IPåœ°å€"></a>åŠ¨æ€IPåœ°å€</h4><p>æ‰€è°“â€åŠ¨æ€IPåœ°å€â€ï¼ŒæŒ‡è®¡ç®—æœºå¼€æœºåï¼Œä¼šè‡ªåŠ¨åˆ†é…åˆ°ä¸€ä¸ªIPåœ°å€ï¼Œä¸ç”¨äººä¸ºè®¾å®šã€‚å®ƒä½¿ç”¨çš„åè®®å«åšDHCPåè®®ã€‚</p>
<p>è¿™ä¸ªåè®®è§„å®šï¼Œæ¯ä¸€ä¸ªå­ç½‘ç»œä¸­ï¼Œæœ‰ä¸€å°è®¡ç®—æœºè´Ÿè´£ç®¡ç†æœ¬ç½‘ç»œçš„æ‰€æœ‰IPåœ°å€ï¼Œå®ƒå«åšâ€DHCPæœåŠ¡å™¨â€ã€‚æ–°çš„è®¡ç®—æœºåŠ å…¥ç½‘ç»œï¼Œå¿…é¡»å‘â€DHCPæœåŠ¡å™¨â€å‘é€ä¸€ä¸ªâ€DHCPè¯·æ±‚â€æ•°æ®åŒ…ï¼Œç”³è¯·IPåœ°å€å’Œç›¸å…³çš„ç½‘ç»œå‚æ•°ã€‚</p>
<p>å¦‚æœä¸¤å°è®¡ç®—æœºåœ¨åŒä¸€ä¸ªå­ç½‘ç»œï¼Œå¿…é¡»çŸ¥é“å¯¹æ–¹çš„MACåœ°å€å’ŒIPåœ°å€ï¼Œæ‰èƒ½å‘é€æ•°æ®åŒ…ã€‚ä½†æ˜¯ï¼Œæ–°åŠ å…¥çš„è®¡ç®—æœºä¸çŸ¥é“è¿™ä¸¤ä¸ªåœ°å€ï¼Œæ€ä¹ˆå‘é€æ•°æ®åŒ…å‘¢ï¼Ÿ&nbsp;</p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="DHCP-åè®®"><a href="#DHCP-åè®®" class="headerlink" title="DHCP åè®®"></a>DHCP åè®®</h4><p>DHCPï¼ˆDynamic Host Configuration Protocolï¼‰æ˜¯ä¸€ä¸ªå±€åŸŸç½‘çš„ç½‘ç»œåè®®ï¼Œä½¿ç”¨&nbsp;<code>UDP</code>&nbsp;åè®®å·¥ä½œ.</p>
<p>é¦–å…ˆï¼Œå®ƒæ˜¯ä¸€ç§åº”ç”¨å±‚åè®®ï¼Œå»ºç«‹åœ¨&nbsp;<code>UDP</code>&nbsp;åè®®ä¹‹ä¸Šï¼Œæ‰€ä»¥æ•´ä¸ªæ•°æ®åŒ…æ˜¯è¿™æ ·çš„ï¼š&nbsp;<br><img src="http://image.beekka.com/blog/201206/bg2012061102.png" alt=""></p>
<p>ï¼ˆ1ï¼‰æœ€å‰é¢çš„&nbsp;ä»¥å¤ªç½‘æ ‡å¤´ï¼Œè®¾ç½®å‘å‡ºæ–¹ï¼ˆæœ¬æœºï¼‰çš„&nbsp;<code>MAC</code>&nbsp;åœ°å€å’Œæ¥æ”¶æ–¹ï¼ˆ<code>DHCP</code>&nbsp;æœåŠ¡å™¨ï¼‰çš„&nbsp;<code>MAC</code>&nbsp;åœ°å€ã€‚å‰è€…å°±æ˜¯æœ¬æœºç½‘å¡çš„&nbsp;<code>MAC</code>&nbsp;åœ°å€ï¼Œåè€…&nbsp;è¿™æ—¶ä¸çŸ¥é“ï¼Œå°±å¡«å…¥ä¸€ä¸ªå¹¿æ’­åœ°å€ï¼š<code>FF-FF-FF-FF-FF-FF</code>ã€‚</p>
<p>ï¼ˆ2ï¼‰åé¢çš„&nbsp;IP æ ‡å¤´ï¼Œè®¾ç½®å‘å‡ºæ–¹çš„ IP åœ°å€å’Œæ¥æ”¶æ–¹çš„ IP åœ°å€ã€‚è¿™æ—¶ï¼Œå¯¹äºè¿™ä¸¤è€…ï¼Œæœ¬æœºéƒ½ä¸çŸ¥é“ã€‚äºæ˜¯ï¼Œå‘å‡ºæ–¹çš„ IP åœ°å€å°±è®¾ä¸º&nbsp;<code>0.0.0.0</code>ï¼Œæ¥æ”¶æ–¹çš„ IP åœ°å€è®¾ä¸º&nbsp;<code>255.255.255.255</code>ã€‚</p>
<p>ï¼ˆ3ï¼‰æœ€åçš„&nbsp;UDP æ ‡å¤´ï¼Œè®¾ç½®å‘å‡ºæ–¹çš„ç«¯å£å’Œæ¥æ”¶æ–¹çš„ç«¯å£ã€‚è¿™ä¸€éƒ¨åˆ†æ˜¯&nbsp;<code>DHCP</code>&nbsp;åè®®è§„å®šå¥½çš„ï¼Œå‘å‡ºæ–¹æ˜¯&nbsp;<code>68</code>&nbsp;ç«¯å£ï¼Œæ¥æ”¶æ–¹æ˜¯&nbsp;<code>67</code>&nbsp;ç«¯å£ã€‚</p>
<p>è¿™ä¸ªæ•°æ®åŒ…æ„é€ å®Œæˆåï¼Œå°±å¯ä»¥å‘å‡ºäº†ã€‚</p>
<p>ä»¥å¤ªç½‘æ˜¯å¹¿æ’­å‘é€ï¼ŒåŒä¸€ä¸ªå­ç½‘ç»œçš„æ¯å°è®¡ç®—æœºéƒ½æ”¶åˆ°äº†è¿™ä¸ªåŒ…ã€‚å› ä¸ºæ¥æ”¶æ–¹çš„MACåœ°å€æ˜¯FF-FF-FF-FF-FF-FFï¼Œçœ‹ä¸å‡ºæ˜¯å‘ç»™è°çš„ï¼Œæ‰€ä»¥æ¯å°æ”¶åˆ°è¿™ä¸ªåŒ…çš„è®¡ç®—æœºï¼Œè¿˜å¿…é¡»åˆ†æè¿™ä¸ªåŒ…çš„ IP åœ°å€ï¼Œæ‰èƒ½ç¡®å®šæ˜¯ä¸æ˜¯å‘ç»™è‡ªå·±çš„ã€‚å½“çœ‹åˆ°å‘å‡ºæ–¹ IP åœ°å€æ˜¯&nbsp;<code>0.0.0.0</code>ï¼Œæ¥æ”¶æ–¹æ˜¯&nbsp;<code>255.255.255.255</code>ï¼Œäºæ˜¯DHCPæœåŠ¡å™¨çŸ¥é“ è¿™ä¸ªåŒ…æ˜¯å‘ç»™æˆ‘çš„ï¼Œè€Œå…¶ä»–è®¡ç®—æœºå°±å¯ä»¥ä¸¢å¼ƒè¿™ä¸ªåŒ…ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼ŒDHCP æœåŠ¡å™¨è¯»å‡ºè¿™ä¸ªåŒ…çš„æ•°æ®å†…å®¹ï¼Œåˆ†é…å¥½ IP åœ°å€ï¼Œå‘é€å›å»ä¸€ä¸ª&nbsp;â€DHCPå“åº”â€æ•°æ®åŒ…ã€‚è¿™ä¸ªå“åº”åŒ…çš„ç»“æ„ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œä»¥å¤ªç½‘æ ‡å¤´çš„ MAC åœ°å€æ˜¯åŒæ–¹çš„ç½‘å¡åœ°å€ï¼ŒIP æ ‡å¤´çš„ IP åœ°å€æ˜¯ DHCP æœåŠ¡å™¨çš„ IP åœ°å€ï¼ˆå‘å‡ºæ–¹ï¼‰å’Œ<code>255.255.255.255</code>ï¼ˆæ¥æ”¶æ–¹ï¼‰ï¼ŒUDP æ ‡å¤´çš„ç«¯å£æ˜¯ 67ï¼ˆå‘å‡ºæ–¹ï¼‰å’Œ 68ï¼ˆæ¥æ”¶æ–¹ï¼‰ï¼Œåˆ†é…ç»™è¯·æ±‚ç«¯çš„IPåœ°å€å’Œæœ¬ç½‘ç»œçš„å…·ä½“å‚æ•°åˆ™åŒ…å«åœ¨Dataéƒ¨åˆ†ã€‚</p>
<p>æ–°åŠ å…¥çš„è®¡ç®—æœºæ”¶åˆ°è¿™ä¸ªå“åº”åŒ…ï¼Œäºæ˜¯å°±çŸ¥é“äº†è‡ªå·±çš„IPåœ°å€ã€å­ç½‘æ©ç ã€ç½‘å…³åœ°å€ã€DNSæœåŠ¡å™¨ç­‰ç­‰å‚æ•°ã€‚</p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="å®ä¾‹ï¼šè®¿é—®é¡µé¢"><a href="#å®ä¾‹ï¼šè®¿é—®é¡µé¢" class="headerlink" title="å®ä¾‹ï¼šè®¿é—®é¡µé¢"></a>å®ä¾‹ï¼šè®¿é—®é¡µé¢</h3><p>å‡å®šç”¨æˆ·å·²ç»åŠ¨æ€è®¾ç½®å¥½äº†è‡ªå·±çš„ç½‘ç»œå‚æ•°ï¼š</p>
<blockquote>
<ul>
<li>æœ¬æœºçš„IPåœ°å€ï¼š192.168.1.100</li>
<li>å­ç½‘æ©ç ï¼š255.255.255.0</li>
<li>ç½‘å…³çš„IPåœ°å€ï¼š192.168.1.1</li>
<li>DNSçš„IPåœ°å€ï¼š8.8.8.8</li>
</ul>
</blockquote>
<p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® Googleï¼Œåœ¨åœ°å€æ è¾“å…¥äº†ç½‘å€ï¼šwww.google.comã€‚</p>
<p>è¿™æ„å‘³ç€ï¼Œæµè§ˆå™¨è¦å‘ Google å‘é€ä¸€ä¸ª&nbsp;ç½‘é¡µè¯·æ±‚&nbsp;çš„æ•°æ®åŒ…ã€‚</p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="DNSåè®®"><a href="#DNSåè®®" class="headerlink" title="DNSåè®®"></a>DNSåè®®</h4><p>DNS åè®®å¯ä»¥å¸®åŠ©æˆ‘ä»¬ï¼Œå°†è¿™ä¸ªç½‘å€è½¬æ¢æˆ IP åœ°å€ã€‚å·²çŸ¥ DNS æœåŠ¡å™¨ä¸º 8.8.8.8ï¼Œäºæ˜¯æˆ‘ä»¬å‘è¿™ä¸ªåœ°å€å‘é€ä¸€ä¸ªDNSæ•°æ®åŒ…ï¼ˆ53 ç«¯å£ï¼‰ã€‚</p>
<p><img src="http://image.beekka.com/blog/201206/bg2012061105.png" alt=""></p>
<p>ç„¶åï¼ŒDNS æœåŠ¡å™¨åšå‡ºå“åº”ï¼Œå‘Šè¯‰æˆ‘ä»¬ Google çš„IPåœ°å€æ˜¯ 172.194.72.105ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬çŸ¥é“äº†å¯¹æ–¹çš„ IP åœ°å€ã€‚</p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="å­ç½‘æ©ç "><a href="#å­ç½‘æ©ç " class="headerlink" title="å­ç½‘æ©ç "></a>å­ç½‘æ©ç </h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦åˆ¤æ–­ï¼Œè¿™ä¸ªIPåœ°å€æ˜¯ä¸æ˜¯åœ¨åŒä¸€ä¸ªå­ç½‘ç»œï¼Œè¿™å°±è¦ç”¨åˆ°å­ç½‘æ©ç ã€‚</p>
<p>å·²çŸ¥å­ç½‘æ©ç æ˜¯ 255.255.255.0ï¼Œæœ¬æœºç”¨å®ƒå¯¹è‡ªå·±çš„IPåœ°å€ 192.168.1.100ï¼Œåšä¸€ä¸ªäºŒè¿›åˆ¶çš„ANDè¿ç®—ï¼ˆä¸¤ä¸ªæ•°ä½éƒ½ä¸º 1ï¼Œç»“æœä¸º 1ï¼Œå¦åˆ™ä¸º 0ï¼‰ï¼Œè®¡ç®—ç»“æœä¸º 192.168.1.0ï¼›ç„¶åå¯¹ Google çš„ IP åœ°å€ 172.194.72.105 ä¹Ÿåšä¸€ä¸ª AND è¿ç®—ï¼Œè®¡ç®—ç»“æœä¸º 172.194.72.0ã€‚è¿™ä¸¤ä¸ªç»“æœä¸ç›¸ç­‰ï¼Œæ‰€ä»¥ç»“è®ºæ˜¯ï¼ŒGoogle ä¸æœ¬æœºä¸åœ¨åŒä¸€ä¸ªå­ç½‘ç»œã€‚</p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h4 id="åº”ç”¨å±‚åè®®"><a href="#åº”ç”¨å±‚åè®®" class="headerlink" title="åº”ç”¨å±‚åè®®"></a>åº”ç”¨å±‚åè®®</h4><p>æµè§ˆç½‘é¡µçš„æµè§ˆå™¨ç”¨çš„æ˜¯HTTPåè®®ï¼Œå®ƒçš„æ•´ä¸ªæ•°æ®åŒ…æ„é€ æ˜¯è¿™æ ·çš„ï¼š&nbsp;<br><img src="http://image.beekka.com/blog/201206/bg2012061106.png" alt=""></p>
<p>HTTPéƒ¨åˆ†çš„å†…å®¹ï¼Œç±»ä¼¼äºä¸‹é¢è¿™æ ·ï¼š</p>
<pre><code>GET / HTTP/1.1
Host: www.google.com
Connection: keep-alive
User-Agent: Mozilla/5.0 (Windows NT 6.1) ......
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip,deflate,sdch
Accept-Language: zh-CN,zh;q=0.8
Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3
Cookie: ... ...
</code></pre><p>æˆ‘ä»¬å‡å®šè¿™ä¸ªéƒ¨åˆ†çš„é•¿åº¦ä¸º 4960 å­—èŠ‚ï¼Œå®ƒä¼šè¢«åµŒåœ¨TCPæ•°æ®åŒ…ä¹‹ä¸­ã€‚</p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="TCPåè®®"><a href="#TCPåè®®" class="headerlink" title="TCPåè®®"></a>TCPåè®®</h4><p>TCP æ•°æ®åŒ…éœ€è¦è®¾ç½®ç«¯å£ï¼Œæ¥æ”¶æ–¹ï¼ˆGoogleï¼‰çš„&nbsp;HTTPç«¯å£é»˜è®¤æ˜¯80ï¼Œå‘é€æ–¹ï¼ˆæœ¬æœºï¼‰çš„ç«¯å£æ˜¯ä¸€ä¸ª&nbsp;éšæœºç”Ÿæˆçš„1024-65535ä¹‹é—´çš„æ•´æ•°ï¼Œå‡å®šä¸º 51775ã€‚</p>
<p>TCP æ•°æ®åŒ…çš„æ ‡å¤´é•¿åº¦ä¸º 20 å­—èŠ‚ï¼ŒåŠ ä¸ŠåµŒå…¥ HTTP çš„æ•°æ®åŒ…ï¼Œæ€»é•¿åº¦å˜ä¸º4980å­—èŠ‚ã€‚</p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="IPåè®®"><a href="#IPåè®®" class="headerlink" title="IPåè®®"></a>IPåè®®</h4><p>ç„¶åï¼ŒTCP æ•°æ®åŒ…å†åµŒå…¥ IP æ•°æ®åŒ…ã€‚IP æ•°æ®åŒ…éœ€è¦è®¾ç½®åŒæ–¹çš„ IP åœ°å€ï¼Œè¿™æ˜¯å·²çŸ¥çš„ï¼Œå‘é€æ–¹æ˜¯ 192.168.1.100ï¼ˆæœ¬æœºï¼‰ï¼Œæ¥æ”¶æ–¹æ˜¯ 172.194.72.105ï¼ˆGoogleï¼‰ã€‚</p>
<p>IP æ•°æ®åŒ…çš„æ ‡å¤´é•¿åº¦ä¸º 20 å­—èŠ‚ï¼ŒåŠ ä¸ŠåµŒå…¥çš„ TCP æ•°æ®åŒ…ï¼Œæ€»é•¿åº¦å˜ä¸º 5000 å­—èŠ‚ã€‚</p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="ä»¥å¤ªç½‘åè®®"><a href="#ä»¥å¤ªç½‘åè®®" class="headerlink" title="ä»¥å¤ªç½‘åè®®"></a>ä»¥å¤ªç½‘åè®®</h4><p>æœ€åï¼ŒIP æ•°æ®åŒ…åµŒå…¥ä»¥å¤ªç½‘æ•°æ®åŒ…ã€‚ä»¥å¤ªç½‘æ•°æ®åŒ…éœ€è¦è®¾ç½®åŒæ–¹çš„ MAC åœ°å€ï¼Œå‘é€æ–¹ä¸ºæœ¬æœºçš„ç½‘å¡ MAC åœ°å€ï¼Œæ¥æ”¶æ–¹ä¸ºç½‘å…³ 192.168.1.1 çš„ MAC åœ°å€ï¼ˆé€šè¿‡ ARP åè®®å¾—åˆ°ï¼‰ã€‚</p>
<p>ä»¥å¤ªç½‘æ•°æ®åŒ…çš„æ•°æ®éƒ¨åˆ†ï¼Œæœ€å¤§é•¿åº¦ä¸º 1500 å­—èŠ‚ï¼Œè€Œç°åœ¨çš„IPæ•°æ®åŒ…é•¿åº¦ä¸º 5000 å­—èŠ‚ã€‚å› æ­¤ï¼ŒIP æ•°æ®åŒ…å¿…é¡»åˆ†å‰²æˆå››ä¸ªåŒ…ã€‚å› ä¸ºæ¯ä¸ªåŒ…éƒ½æœ‰è‡ªå·±çš„ IP æ ‡å¤´ï¼ˆ20 å­—èŠ‚ï¼‰ï¼Œæ‰€ä»¥å››ä¸ªåŒ…çš„ IPæ•°æ®åŒ…çš„é•¿åº¦åˆ†åˆ«ä¸º 1500ã€1500ã€1500ã€560ã€‚</p>
<p><img src="http://image.beekka.com/blog/201206/bg2012061107.png" alt=""></p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="æœåŠ¡å™¨å“åº”"><a href="#æœåŠ¡å™¨å“åº”" class="headerlink" title="æœåŠ¡å™¨å“åº”"></a>æœåŠ¡å™¨å“åº”</h4><p>ç»è¿‡å¤šä¸ªç½‘å…³çš„è½¬å‘ï¼ŒGoogle çš„æœåŠ¡å™¨ 172.194.72.105ï¼Œæ”¶åˆ°äº†è¿™å››ä¸ªä»¥å¤ªç½‘æ•°æ®åŒ…ã€‚</p>
<p>æ ¹æ® IP æ ‡å¤´çš„åºå·ï¼ŒGoogle å°†å››ä¸ªåŒ…æ‹¼èµ·æ¥ï¼Œå–å‡ºå®Œæ•´çš„ TCP æ•°æ®åŒ…ï¼Œç„¶åè¯»å‡ºé‡Œé¢çš„â€HTTPè¯·æ±‚â€ï¼Œæ¥ç€åšå‡ºâ€HTTPå“åº”â€ï¼Œå†ç”¨TCPåè®®å‘å›æ¥ã€‚</p>
<p>æœ¬æœºæ”¶åˆ°HTTPå“åº”ä»¥åï¼Œå°±å¯ä»¥å°†ç½‘é¡µæ˜¾ç¤ºå‡ºæ¥ï¼Œå®Œæˆä¸€æ¬¡ç½‘ç»œé€šä¿¡ã€‚</p>
<p><img src="http://image.beekka.com/blog/201206/bg2012061104.jpg" alt=""></p>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h2 id="Webå¼€å‘æ–°äººåŸ¹è®­ç³»åˆ—å¤‡å¿˜"><a href="#Webå¼€å‘æ–°äººåŸ¹è®­ç³»åˆ—å¤‡å¿˜" class="headerlink" title="Webå¼€å‘æ–°äººåŸ¹è®­ç³»åˆ—å¤‡å¿˜"></a>Webå¼€å‘æ–°äººåŸ¹è®­ç³»åˆ—å¤‡å¿˜</h2><div class="md-section-divider">&nbsp;</div>

<h3 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h3><ul>
<li><p>è¿›ç¨‹aå‘é€æ•°æ®æ˜¯é€šè¿‡socketå‘å‡ºå»ï¼Œsocketéœ€è¦ç»‘å®šä¸€ä¸ªç«¯å£ï¼Œç”¨äºåŒºåˆ†è®¡ç®—æœºå†…çš„ä¸åŒè¿›ç¨‹ã€‚è¿›ç¨‹aä½¿ç”¨çš„socketç»‘å®šäº†2048ç«¯å£ï¼Œè¿›ç¨‹bä½¿ç”¨çš„socketç»‘å®šäº†4096ç«¯å£ã€‚</p>
</li>
<li><p>çœŸæ­£æƒ³è¦æ•°æ®çš„è¿›ç¨‹æ‰æ˜¯æœ€ç»ˆåº”ç”¨å±‚ã€‚</p>
</li>
<li><p>åè®®çš„ç›®çš„å°±æ˜¯è®©é€šä¿¡çš„åŒæ–¹çŸ¥é“å½“å‰è¿™ä¸ªæ•°æ®åŒ…æ˜¯æ€ä¹ˆæ ·ä¸€ä¸ªç»„æˆæ ¼å¼ï¼Œä¸€èˆ¬ï¼šåŒ…å¤´å°±æ˜¯åŒæ–¹çº¦å®šå¥½çš„ä¸€äº›ä¿¡æ¯ï¼ŒåŒ…ä½“å°±æ˜¯è¿™æ¬¡é€šä¿¡ä¼ è¾“çš„æ•°æ®ã€‚&nbsp;<br>åè®® == åŒ…å¤´ + åŒ…ä½“ã€‚</p>
</li>
<li><p>HTTPåè®®</p>
</li>
</ul>
<blockquote>
<p>HTTPè¯·æ±‚åŒ…çš„HTTPåŒ…å¤´æ ¼å¼ï¼š</p>
<pre><code>*   GET / HTTP/1.1&amp;nbsp;
</code></pre><p>è·å–çš„è·¯å¾„ä»¥åŠHTTPç‰ˆæœ¬</p>
<pre><code>*   Host: www.qq.com:8080&amp;nbsp;
</code></pre><p>æœåŠ¡å™¨ä¸»æœºåå­—&amp;ç«¯å£å·</p>
<pre><code>*   Connection: keep-alive&amp;nbsp;
</code></pre><p>ç”¨äºé•¿è¿</p>
<pre><code>*   User-Agent: Chrome/35.0.1916.153&amp;nbsp;
</code></pre><p>æµè§ˆå™¨åŸºæœ¬ä¿¡æ¯</p>
<pre><code>*   Accept-Encoding: gzip,deflate,sdch&amp;nbsp;
</code></pre><p>å‘Šè¯‰æœåŠ¡å™¨æ”¯æŒçš„ç¼–ç </p>
<pre><code>*   Accept-Language: zh-CN,zh;q=0.8,en;q=0.6,nl;q=0.4,zh-TW;q=0.2&amp;nbsp;
</code></pre><p>å‘Šè¯‰æœåŠ¡å™¨ä¼˜å…ˆæ”¯æŒçš„è¯­è¨€</p>
<pre><code>*   Cookie: id=1;username=raphealguo;&amp;nbsp;
</code></pre><p>è§£å†³HTTPæ— çŠ¶æ€é‡è¦çš„Cookieï¼Œé‡Œè¾¹æ˜¯key=valueå¯¹</p>
</blockquote>
<ul>
<li>æœåŠ¡å™¨æ”¶åˆ°HTTPè¯·æ±‚ï¼Œç»è¿‡&nbsp;CGIå¤„ç†&nbsp;ä¹‹åå›å¤ä¸€ä¸ªHTTPå“åº”åŒ…</li>
</ul>
<blockquote>
<p>HTTPå“åº”åŒ…åŒ…å¤´å¸¸è§æ ¼å¼</p>
<pre><code>*   HTTP/1.1 200 OK&amp;nbsp;
</code></pre><p>HTTPç‰ˆæœ¬ä»¥åŠçŠ¶æ€ç </p>
<pre><code>*   Server: nginx/1.4.1&amp;nbsp;
</code></pre><p>æœåŠ¡å™¨ç‰ˆæœ¬</p>
<pre><code>*   Date: Mon, 30 Jun 2014 09:44:10 GMT&amp;nbsp;
</code></pre><p>å›åŒ…æ—¶é—´</p>
<pre><code>*   Content-Type: text/html; charset=UTF-8&amp;nbsp;
</code></pre><p>åŒ…é‡Œè¾¹çš„ç±»å‹</p>
<pre><code>*   Content-Length: 14534&amp;nbsp;
</code></pre><p>åŒ…ä½“çš„é•¿åº¦</p>
<pre><code>*   Connection: keep-alive&amp;nbsp;
</code></pre><p>ç”¨äºé•¿è¿</p>
<pre><code>*   Cache-Control: no-cache, must-revalidate&amp;nbsp;
</code></pre><p>ç”¨äºç¼“å­˜æ§åˆ¶</p>
</blockquote>
<ul>
<li><p>HTTPSåè®®&nbsp;</p>
<ol>
<li>HTTPS=HTTPåè®®+SSL</li>
<li>HTTPä¼ è¾“æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œæ˜“è¢«åŠ«æŒç¯¡æ”¹</li>
<li>HTTPSé‡‡ç”¨éå¯¹ç§°åŠ å¯†ï¼šä¸¤è¾¹çš„åŠ å¯†ã€è§£å¯†ä¸æ˜¯å®Œå…¨ä¸€æ ·çš„</li>
</ol>
<p>&nbsp;</p>
</li>
</ul>
<blockquote>
<p>éå¯¹ç§°åŠ å¯†ç¤ºä¾‹ï¼š</p>
<pre><code>Bobå°†è¡£æœæ”¾åˆ°ä¸€ä¸ªä¿é™©ç®±é‡Œè¾¹é”èµ·æ¥ï¼Œä»–æ‰“äº†ä¸ªç”µè¯å‘Šè¯‰Aliceä¿é™©ç®±å¼€æŸœå¯†ç æ˜¯1234ï¼Œè€Œé»‘å®¢Hä¸çŸ¥é“å¯†ç ï¼Œæ‰€ä»¥ä»–çœ‹ä¸åˆ°ä¿é™©ç®±é‡Œè¾¹çš„ä¸œè¥¿ï¼ŒAliceæ”¶åˆ°å¿«é€’åç”¨é¢„å…ˆæ²Ÿé€šå¥½çš„å¯†ç å°±å¯ä»¥æ‰“å¼€ä¿é™©ç®±äº†ã€‚

    è¿™é‡Œä¿æŠ¤çš„æ‰‹æ®µå°±æ˜¯Bobå¯¹ç‰©å“è¿›è¡ŒåŠ å¯†ï¼ŒåŒæ—¶ç»™äº†å‘Šè¯‰Aliceè§£å¯†çš„æ–¹æ³•ï¼

    é‚£å¦‚æœç°åœ¨è¦æ±‚Bobçš„å¯†ç åªèƒ½é€šè¿‡å¿«é€’ä¼ ç»™Aliceå‘¢ï¼Ÿå¦‚æœBobç›´æ¥ä¼ å¯†ç ç»™Aliceï¼ŒHå¦‚æœå—…æ¢åˆ°è¿™ä¸ªå¿«é€’ï¼Œé‚£Hä¹ŸçŸ¥é“å¯†ç äº†ï¼Œè¿™å°±æ— æ³•ä¿æŠ¤å¿«é€’çš„å®‰å…¨æ€§äº†ã€‚å› æ­¤è¿˜éœ€è¦æœ‰ä¸ªæ–¹æ¡ˆï¼Œè®©Bobèƒ½å¤Ÿå‘Šè¯‰Aliceå¯†ç çš„åŒæ—¶ï¼ŒHåˆæ— æ³•æŸ¥çœ‹åˆ°Bobè·ŸAliceé€šä¿¡çš„æ•°æ®ã€‚

    éå¯¹ç§°åŠ å¯†åœ¨è¿™ä¸ªæ—¶å€™å°±å‘æŒ¥ä½œç”¨äº†ï¼Œæ¥çœ‹çœ‹æ€ä¹ˆå›äº‹ï¼šBobæ‹¥æœ‰ä¸¤æŠŠé’¥åŒ™ï¼Œä¸€æŠŠå«åšå…¬é’¥ï¼Œä¸€æŠŠå«åšç§é’¥ã€‚å…¬é’¥æ˜¯å…¬å¼€è®©å…¨ç¤¾ä¼šéƒ½çŸ¥é“ï¼Œæ²¡å…³ç³»ï¼ŒBobå‘Šè¯‰æ‰€æœ‰äººï¼Œä½ ä»¬è¦ä¼ é€’æ•°æ®ç»™æˆ‘çš„æ—¶å€™è¯·å…ˆç”¨è¿™ä¸ªå¯†é’¥å»åŠ å¯†ä¸€ä¸‹ä½ ä»¬çš„æ•°æ®ï¼ŒåŠ å¯†åçš„æ•°æ®åªèƒ½é€šè¿‡Bobç§è‡ªè—ç€çš„ç§é’¥æ‰èƒ½è§£å¯†ã€‚

    å›åˆ°åˆšåˆšä¾‹å­ï¼ŒBobå…ˆå‘ç»™ä¿é™©æŸœï¼ˆBobå…¬é’¥ï¼‰ç»™Aliceï¼Œæ¥ç€AliceæŠŠè‡ªå·±çš„ä¿é™©æŸœï¼ˆAliceå…¬é’¥ï¼‰æ”¾åˆ°Bobçš„ä¿é™©æŸœé‡Œè¾¹å‘è¿˜ç»™Bobï¼Œæ¥ç€Bobæ‹¿åˆ°Aliceçš„å›åŒ…åï¼Œç”¨è‡ªå·±çš„ç§é’¥è§£å¼€äº†å¤–å±‚ä¿é™©æŸœï¼Œæ‹¿åˆ°äº†é‡Œè¾¹Aliceä¿é™©æŸœã€‚æ­¤æ—¶Aliceè·ŸBobéƒ½æœ‰äº†å„è‡ªçš„å…¬é’¥ï¼Œæ¥ç€åªè¦ä¿è¯æ¯æ¬¡äº’ç›¸ä¼ é€’æ•°æ®çš„æ—¶å€™ï¼ŒæŠŠæ•°æ®æ”¾åœ¨å¯¹æ–¹çš„ä¿é™©æŸœé‡Œè¾¹å³å¯ï¼Œè¿™æ ·æ— è®ºå¦‚ä½•ï¼ŒHéƒ½æ— æ³•è§£å¼€ä¿é™©æŸœï¼ˆå› ä¸ºåªæœ‰å„è‡ªçš„ç§é’¥æ‰èƒ½è§£å¼€å„è‡ªçš„ä¿é™©æŸœï¼‰ã€‚
</code></pre></blockquote>
<pre><code>4.  HTTPSéš§é“
</code></pre><blockquote>
<p>HTTPSé€šä¿¡ä¼šæœ‰å¦‚ä¸‹çš„è¿‡ç¨‹ï¼š</p>
<pre><code>    1.  å®¢æˆ·ç«¯å…ˆè·ŸæœåŠ¡å™¨åšä¸€æ¬¡SSLæ¡æ‰‹ï¼Œä¹Ÿå°±æ˜¯åˆšåˆšBobè·ŸAliceäº¤æ¢å…¬é’¥çš„è¿‡ç¨‹ã€‚
2.  æ­¤æ—¶å®¢æˆ·ç«¯è·ŸæœåŠ¡å™¨éƒ½æœ‰äº†å„è‡ªçš„å…¬é’¥ï¼Œè¿™æ—¶ä»–ä»¬ä¸­é—´ç›¸å½“äºæœ‰äº†ä¸€æ¡å®‰å…¨çš„HTTPSéš§é“ã€‚
3.  å®¢æˆ·ç«¯è¦å‘é€è¯·æ±‚æ—¶ï¼Œé‡‡ç”¨æœåŠ¡å™¨ç»™çš„å…¬é’¥å¯¹è¯·æ±‚åŒ…è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå‘å‡ºå»ã€‚
4.  æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œä½¿ç”¨è‡ªå·±çš„ç§é’¥è§£å¼€äº†è¿™ä¸ªè¯·æ±‚åŒ…å¾—åˆ°å…¶å†…å®¹ã€‚
5.  æœåŠ¡å™¨å“åº”çš„æ—¶å€™ï¼Œé‡‡ç”¨å®¢æˆ·ç«¯ç»™çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå‘è¿˜ç»™å®¢æˆ·ç«¯ã€‚
6.  å®¢æˆ·ç«¯æ”¶åˆ°å“åº”åï¼Œä½¿ç”¨è‡ªå·±çš„ç§é’¥è§£å¼€å“åº”åŒ…å¾—åˆ°å…¶å†…å®¹ã€‚
7.  ç»“æŸçš„æ—¶å€™ï¼ŒåŒæ–¹å…³é—­SSLéš§é“ï¼Œä¸¢æ‰ä¸Šæ¬¡äº¤æ¢çš„å…¬é’¥ã€‚
</code></pre></blockquote>
<pre><code>5.  HTTPSä¹Ÿä¸å®‰å…¨çš„æƒ…å†µï¼š&amp;nbsp;
</code></pre><blockquote>
<p>&nbsp;</p>
<pre><code>    1.  ç§é’¥è¢«çªƒå–ï¼›
2.  HTTPSæ˜¯æ— æ³•ä¿è¯ç«¯å†…å®‰å…¨ï¼ˆHTTPå°±æ›´ä¸èƒ½äº†ï¼‰ï¼Œç”µè„‘å·²ç»è¢«ç—…æ¯’ä¾µå…¥ï¼Œç—…æ¯’å¯ä»¥ç›‘å¬åˆ°ä½ å¼€é”çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥çŸ¥é“ä½ çš„ç§é’¥ï¼›
3.  HTTPSä¸‹çš„é¡µé¢å¼•ç”¨äº†HTTPä¸‹çš„èµ„æºï¼Œä¾‹å¦‚HTTPSä¸‹çš„é¡µé¢å¼•ç”¨äº†HTTPä¸‹çš„Javascriptæ–‡ä»¶ï¼Œæ­¤æ—¶å¦‚æœè¿™ä¸ªJavascriptæ–‡ä»¶è¢«ç¯¡æ”¹äº†ï¼Œé‚£é€šè¿‡è¿™ä¸ªJSæ–‡ä»¶å°±å¯ä»¥åœ¨æ‰§è¡Œçš„æ—¶å€™è·å–åˆ°æ•´ä¸ªç½‘é¡µå†…å®¹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŸäº›æµè§ˆå™¨ä¼šé˜»æ­¢ä½ å»åŠ è½½è¿™äº›éHTTPèµ„æºï¼Œæœ‰äº›åˆ™ä¼šæç¤ºé”™è¯¯æˆ–è€…ç»™å‡ºè­¦å‘Šä¿¡æ¯ã€‚
</code></pre><div class="md-section-divider">&nbsp;</div>

</blockquote>
<hr>
<div class="md-section-divider">&nbsp;</div>

<h3 id="ç»å…¸çš„Webåº”ç”¨ç½‘ç»œæ¨¡å‹"><a href="#ç»å…¸çš„Webåº”ç”¨ç½‘ç»œæ¨¡å‹" class="headerlink" title="ç»å…¸çš„Webåº”ç”¨ç½‘ç»œæ¨¡å‹"></a>ç»å…¸çš„Webåº”ç”¨ç½‘ç»œæ¨¡å‹</h3><p>æ€»ä½“æ¨¡å‹æ¦‚è§ˆï¼š&nbsp;<br><img src="http://rapheal-wordpress.stor.sinaapp.com/uploads/2014/10/%E6%A6%82%E8%A7%88.png" alt=""></p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h4><ul>
<li><p>æµè§ˆå™¨ä¼šå…ˆè¯¢é—®æœ¬åœ°Hostsï¼Œå¦‚æœæ²¡æœ‰æ˜ å°„åˆ™å†è¯¢é—®DNSç¼“å­˜ï¼Œå¦‚æœæ²¡æœ‰è®°å½•è¿‡è¿™ä¸ªåŸŸåæ˜ å°„çš„IPï¼Œé‚£å°±å‘æœ¬åœ°çš„DNSç½‘å…³è¯¢é—®ï¼Œå¦‚æœç½‘å…³ä¹Ÿä¸çŸ¥é“ï¼Œå°±ç»§ç»­å¾€ä¸Šä¸€å±‚çš„DNSæœåŠ¡å™¨è¯¢é—®ï¼Œç›´åˆ°æ‹¿åˆ°è¿™ä¸ªIPåœ°å€ã€‚</p>
</li>
<li><p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸€å°æœåŠ¡å™¨å¤„ç†çš„è¯·æ±‚æ˜¯æœ‰é™çš„ï¼Œå› æ­¤å¤§å‹çš„åº”ç”¨éƒ½ä¼šæœ‰å¤šå°<code>proxy</code>æœºå™¨ï¼Œæˆ‘ä»¬å¯ä»¥è®©DNSæœåŠ¡å™¨åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚è¿”å›IP1ï¼Œç¬¬äºŒä¸ªè¯·æ±‚è¿”å›IP2&hellip;&hellip;è¿™æ ·ç”¨æˆ·çš„è¯·æ±‚å°±ä¼šå‡åŒ€çš„è½åœ¨è¿™äº›æœºå™¨ä¸Šï¼Œè¿™ä¸ªå°±æ˜¯<code>DNS</code>è´Ÿè½½å‡è¡¡ã€‚<code>CDN</code>å°±æ˜¯é€šè¿‡æ™ºèƒ½<code>DNS</code>ç®—å‡ºç¦»ç”¨æˆ·æœ€è¿‘çš„<code>CDN</code>èŠ‚ç‚¹çš„<code>IP</code>åœ°å€ï¼Œè¿™æ ·ç”¨æˆ·å¯ä»¥è®¿é—®ä¸€å°ç¦»ä»–æœ€è¿‘çš„æœºå™¨ï¼Œå¤§å¤§èŠ‚çº¦è¿æ¥æ—¶é—´ã€‚&nbsp;<br><img src="http://rapheal-wordpress.stor.sinaapp.com/uploads/2014/10/DNS%E8%B4%9F%E8%BD%BD.png" alt=""></p>
<div class="md-section-divider">&nbsp;</div>

</li>
</ul>
<h4 id="ä»£ç†ä¸åå‘ä»£ç†"><a href="#ä»£ç†ä¸åå‘ä»£ç†" class="headerlink" title="ä»£ç†ä¸åå‘ä»£ç†"></a>ä»£ç†ä¸åå‘ä»£ç†</h4><ul>
<li>ä¸€èˆ¬æ¥è¯´ï¼Œæµè§ˆå™¨è·ŸçœŸæ­£æä¾›WebæœåŠ¡çš„æœºå™¨æ˜¯æ²¡æœ‰ç›´æ¥è¿æ¥çš„ï¼Œä»–ä»¬ä¸­é—´éƒ½ä¼šæœ‰ä»£ç†è·Ÿåå‘ä»£ç†ã€‚</li>
<li>ä»£ç†å¯ä»¥æ˜¯å…¬å¸å†…éƒ¨çš„ä»£ç†æœåŠ¡å™¨ã€å„çº§<code>ISP</code>è½¬å‘æœåŠ¡å™¨ã€VPNä»£ç†æœåŠ¡å™¨&nbsp;<br><img src="http://rapheal-wordpress.stor.sinaapp.com/uploads/2014/10/%E4%BB%A3%E7%90%86%E4%B8%8E%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86.png" alt=""></li>
<li><p>ä»£ç†æœåŠ¡å™¨çš„ä½œç”¨ï¼šæ¶æ„è¯·æ±‚/å“åº”çš„æ‹¦æˆªã€ç¼“å­˜å†…éƒ¨ç½‘ç»œæ‰€éœ€çš„å…¬å…±èµ„æºã€GFWä¸åGFW&nbsp;<br><img src="http://rapheal-wordpress.stor.sinaapp.com/uploads/2014/10/%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86.png" alt=""></p>
</li>
<li><p>åå‘ä»£ç†å°±æ˜¯ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥æ”¶ç½‘ç»œè¿æ¥è¯·æ±‚ï¼Œæˆ‘ä»¬ä¸Šä¸‹æ–‡ç§°Proxyæœºå™¨æŒ‡çš„å°±æ˜¯åå‘ä»£ç†æœºå™¨ï¼ŒProxyæœºå™¨æ”¶åˆ°è¯·æ±‚åä¼šç»è¿‡ä¸€å®šçš„åˆ†ææœ€åæŠŠè¯·æ±‚å†…å®¹è½¬å‘ç»™å†…ç½‘å¯¹åº”çš„WebæœåŠ¡å™¨ï¼ŒWebæœåŠ¡å™¨çš„HTTPå“åº”åŒ…ä¼šå…ˆåˆ°Proxyæœºå™¨ï¼Œç„¶åå†åˆ°ç”¨æˆ·æœºå™¨ã€‚</p>
</li>
</ul>
<p>åå‘ä»£ç†çš„å¥½å¤„æ˜¯å¯ä»¥è´Ÿè½½å‡è¡¡ï¼Œåœ¨å®ƒåè¾¹å¯ä»¥æœ‰å¤šå°å·¥ä½œçš„WebæœåŠ¡å™¨ï¼Œè¿™æ ·åˆ†å±‚æ¬¡ä¹‹åï¼Œå¾ˆå¤šèŒè´£å°±æ˜ç¡®å¾ˆå¤šäº†ï¼šProxyæœºå™¨è´Ÿè´£è´Ÿè½½å‡è¡¡ã€æ‹¦æˆªæ¶æ„è¯·æ±‚ã€ç»´æŒé•¿è¿æ¥ï¼Œè¿˜å¯ä»¥å±è”½ä¸å·¥ä½œçš„WebæœåŠ¡å™¨ï¼›è€ŒWebæœåŠ¡å™¨å°±åªè¦å…³å¿ƒè‡ªå·±å¤„ç†çš„Webä¸šåŠ¡é€»è¾‘å³å¯ã€‚</p>
<p>å¾€å¾€ProxyæœåŠ¡å™¨è·Ÿç”¨æˆ·æœºå™¨ä¿æŒé•¿è¿æ¥ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœç”¨æˆ·æ¯æ¬¡è·ŸæœåŠ¡å™¨å»ºç«‹è¿æ¥çš„æ¶ˆè€—ï¼Œè€ŒProxyæœåŠ¡å™¨è·ŸWebæœåŠ¡å™¨é‡‡ç”¨çŸ­è¿æ¥çš„æ–¹å¼ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆèŠ‚çº¦WebæœåŠ¡å™¨çš„èµ„æºã€‚&nbsp;</p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="Web-server"><a href="#Web-server" class="headerlink" title="Web server"></a>Web server</h4><ul>
<li>Web serverçš„èŒè´£å°±æ˜¯æ ¹æ®ç”¨æˆ·çš„è¯·æ±‚ï¼Œè¿”å›å…¶æ‰€éœ€è¦çš„å“åº”å†…å®¹ã€‚å¾€å¾€Web serveråªæ¶‰åŠä¸šåŠ¡æµ‹é€»è¾‘çš„åˆ¤æ–­ä»¥åŠæ•°æ®çš„ç»„è£…ï¼Œè€ŒçœŸæ­£çš„æ•°æ®ä½äºåç«¯çš„å­˜å‚¨Serverã€‚</li>
</ul>
<p>å¯¹äºä¸€èˆ¬åº”ç”¨æ¥è¯´ï¼ŒWeb serverè¿”å›çš„æ˜¯åŠ¨æ€äº§ç”Ÿçš„å†…å®¹ï¼ˆæ¯ä¸ªç”¨æˆ·éƒ½ä¸ä¸€è‡´çš„åŠ¨æ€å†…å®¹æˆ–è€…ç»å¸¸ç¼–è¾‘å˜åŠ¨çš„å†…å®¹ï¼‰ï¼Œå¦‚é¡µé¢çš„HTMLå†…å®¹ã€JSONæ•°æ®ã€XMLæ•°æ®ç­‰ã€‚è€ŒJavascriptæ–‡ä»¶ã€CSSæ–‡ä»¶ã€å›¾ç‰‡è¿™äº›é™æ€èµ„æºï¼ˆä¸æ ¹æ®ç”¨æˆ·è€Œå˜åŠ¨çš„èµ„æºï¼‰å¾€å¾€å­˜æ”¾åœ¨CDNä¸­ã€‚&nbsp;<br><img src="http://rapheal-wordpress.stor.sinaapp.com/uploads/2014/10/Web-server.png" alt="">&nbsp;</p>
<div class="md-section-divider">&nbsp;</div>

<h4 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h4><ul>
<li><p>å¯¹äºåŠ¨æ€çš„å†…å®¹ï¼Œè¯·æ±‚æ€»æ˜¯åˆ°Web serverå»åŠ¨æ€è®¡ç®—è·å–å†…å®¹ï¼Œä½†æ˜¯å¯¹äºä¸éšç”¨æˆ·çŠ¶æ€å˜åŒ–çš„å†…å®¹æˆ‘ä»¬æŠŠå†…å®¹æ¨é€åˆ°CDNèŠ‚ç‚¹ä¸Šã€‚</p>
</li>
<li><p>é™æ€èµ„æºçš„åŸŸåè·Ÿé¡µé¢HTMLçš„åŸŸåä¸€èˆ¬æ¥è¯´æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› ä¸ºé™æ€èµ„æºçš„è¯·æ±‚éœ€è¦è§£æåˆ°CDNèŠ‚ç‚¹å»ã€‚æˆ‘ä»¬å‡è®¾ä¸»è¯·æ±‚æ˜¯ï¼šwww.qq.com/index.htmlï¼›CDNè¯·æ±‚æ˜¯cdn.qq.com/index.cssã€‚&nbsp;<br><img src="http://rapheal-wordpress.stor.sinaapp.com/uploads/2014/10/CDN.png" alt=""></p>
</li>
<li><p>ä¸€èˆ¬Webåº”ç”¨æŠŠé™æ€å†…å®¹æ¨åˆ°CDNæœ‰ä¸¤ç§æ¨¡å¼ï¼Œä¸€ç§æ˜¯åœ¨ä¸Šçº¿å‰ä¸»åŠ¨å°†å†…å®¹æ¨é€åˆ°CDNèŠ‚ç‚¹ï¼Œä¸€ç§æ˜¯CDNå‘ç°æœ¬åœ°æ²¡æœ‰è¯¥æ–‡ä»¶æ—¶ï¼Œå›æºåˆ°Web serveræœºå™¨å–å†…å®¹ï¼Œç„¶åç¼“å­˜åœ¨ä»–æœ¬åœ°ã€‚&nbsp;<br><img src="http://rapheal-wordpress.stor.sinaapp.com/uploads/2014/10/CDN%E6%8E%A8%E9%80%81%E5%86%85%E5%AE%B9.png" alt=""></p>
<div class="md-section-divider">&nbsp;</div>

</li>
</ul>
<h4 id="ä¸Šçº¿"><a href="#ä¸Šçº¿" class="headerlink" title="ä¸Šçº¿"></a>ä¸Šçº¿</h4><ul>
<li><p>åƒJSæ–‡ä»¶ã€CSSæ–‡ä»¶è¿™äº›èµ„æºå¯¹äºæ‰€æœ‰ç”¨æˆ·æ¥è¯´éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬æŠŠå®ƒä»¬å½’ç±»åˆ°é™æ€èµ„æºã€‚å¯¹äºä¸åŒç”¨æˆ·ï¼Œå®ƒä»¬çœ‹åˆ°çš„ç½‘é¡µå…¶å®æ˜¯ä¸ä¸€è‡´çš„ï¼ˆä¾‹å¦‚é¡µé¢é‡Œè¾¹æœ‰ä»–ä»¬å„è‡ªçš„æ˜µç§°ï¼Œidç­‰ä¿¡æ¯ï¼‰ï¼Œè¿™æ˜¯é€šè¿‡CGIç¨‹åºå®æ—¶è®¡ç®—ï¼Œä¸ºä¸åŒç”¨æˆ·ç”Ÿæˆä¸åŒçš„HTMLäº§ç”Ÿï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„HTMLèµ„æºå½’ç±»ä¸ºåŠ¨æ€èµ„æºã€‚</p>
</li>
<li><p>ç”±äºåŠ¨æ€èµ„æºæ˜¯éœ€è¦å®æ—¶è·å–çš„ï¼Œå› æ­¤è¯·æ±‚æœ€åéƒ½éœ€è¦è½åˆ°æˆ‘ä»¬çš„CGIç¨‹åºä¸Šã€‚è€Œå¯¹äºé™æ€èµ„æºæ¥è¯´ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¸éœ€è¦é€šè¿‡CGIå»å®æ—¶è·å–æ–‡ä»¶å†…å®¹åšå“åº”ã€‚</p>
</li>
<li><p>ä¸€èˆ¬æˆ‘ä»¬éœ€è¦å¤šå°WebæœåŠ¡å™¨ï¼Œåœ¨å®ƒä»¬ä¸Šå±‚çš„proxyæœºå™¨æŠŠç”¨æˆ·çš„è¯·æ±‚å¹³æ‘Šåœ¨è¿™äº›æœºå™¨ä¸Šã€‚æˆ‘ä»¬ç°å®çš„ç½‘ç»œç»“æ„å¤§å¤šæ•°æ˜¯è¿™æ ·çš„ï¼š&nbsp;<br><img src="http://rapheal-wordpress.stor.sinaapp.com/uploads/2015/01/%E4%B8%8A%E7%BA%BF%E2%80%94%E2%80%94proxy%E8%B7%AF%E7%94%B1.png" alt=""></p>
</li>
<li><p>åˆšåˆšæˆ‘ä»¬åœ¨åªæœ‰ä¸€å°æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæ–‡ä»¶ä¼ è¾“åˆ°è¿™å°æœåŠ¡å™¨å°±ç®—æ­¤æ¬¡ä¸Šçº¿å®Œæ¯•ã€‚åŒæ ·é“ç†åœ¨å¤šå°æœåŠ¡å™¨çš„ç½‘ç»œç»“æ„ä¸‹ï¼Œæˆ‘ä»¬æŠŠæ–‡ä»¶ä¾æ¬¡ä¸Šä¼ åˆ°è¿™äº›æœåŠ¡å™¨ä¸Šï¼Œå¯¹äºæ‰€æœ‰æœåŠ¡å™¨éƒ½ä¼ è¾“å®Œæ¯•åæ‰ç®—æ­¤æ¬¡ä¸Šçº¿å®Œæ¯•ã€‚&nbsp;<br><img src="http://rapheal-wordpress.stor.sinaapp.com/uploads/2015/01/%E4%B8%8A%E7%BA%BF%E2%80%94%E2%80%94%E5%A4%9A%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%BA%BF.png" alt=""></p>
</li>
<li><p>åœ¨ä¸Šçº¿çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€äº›æœåŠ¡å™¨æ˜¯æ–°èµ„æºï¼Œæœ‰ä¸€äº›æœåŠ¡å™¨æ˜¯æ—§èµ„æºã€‚é—®é¢˜å°±æ¥äº†ï¼š</p>
</li>
</ul>
<blockquote>
<p>æœåŠ¡å™¨1å·²ç»éƒ¨ç½²ä¸Šæ–°çš„èµ„æºï¼Œè€ŒæœåŠ¡å™¨2ä¸Šè¿˜æ˜¯æ—§èµ„æºã€‚å‡è®¾è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œç”¨æˆ·ç¬¬ä¸€ä¸ªHTMLè¯·æ±‚åˆ°äº†æœåŠ¡å™¨1ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„HTMLï¼Œæ¥ç€ç”¨æˆ·ç¬¬äºŒä¸ªJSè¯·æ±‚åˆè·‘åˆ°æœåŠ¡å™¨2ã€‚&nbsp;</p>
<pre><code>åœ¨ç”¨æˆ·ä¾§çš„è¡¨ç°å°±æ˜¯ä¸€ä¸ªæ—§çš„JSæ–‡ä»¶ä½œç”¨åœ¨ä¸€ä¸ªæ–°çš„HTMLä¸Šï¼Œè¿™æ ·å¯èƒ½å°±å¼•å‘äº†å¼‚å¸¸ã€‚&amp;nbsp;
</code></pre><p><img src="http://rapheal-wordpress.stor.sinaapp.com/uploads/2015/01/%E4%B8%8A%E7%BA%BF%E2%80%94%E2%80%94%E4%B8%8A%E7%BA%BF%E5%BC%82%E5%B8%B8.png" alt=""></p>
</blockquote>
<ul>
<li><p>æ²¡æ³•åšåˆ°èµ„æºçš„å®æ—¶ä¸€è‡´ï¼Œå¤šå°æœåŠ¡å™¨çš„ç½‘ç»œç»“æ„ä¸‹å¿…ç„¶ä¼šå­˜åœ¨æŸå°æ®µæ—¶é—´é—´éš™å­˜åœ¨èµ„æºä¸ä¸€è‡´çš„ç°è±¡ã€‚</p>
</li>
<li><p>è§£å†³æ–¹æ¡ˆï¼šè®©åŒä¸€ä¸ªç”¨æˆ·çš„å¤šæ¬¡è¯·æ±‚æ°¸è¿œéƒ½åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œç”¨æˆ·è¦ä¹ˆè®¿é—®åˆ°çš„å…¨éƒ¨éƒ½æ˜¯æ—§èµ„æºï¼Œè¦ä¹ˆå…¨éƒ¨éƒ½æ˜¯æ–°èµ„æºã€‚ï¼ˆè¿™æ ·è¿˜èƒ½è¾¾åˆ°ç°åº¦æµ‹è¯•çš„ä½œç”¨ï¼‰</p>
</li>
<li><p>æ€ä¹ˆè®©åŒä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚ä¸€ç›´éƒ½è½åœ¨åŒä¸€å°æœºå™¨ä¸Š?</p>
</li>
</ul>
<blockquote>
<p>é€šè¿‡proxyæŠŠåŒä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚è½¬å‘åˆ°åŒä¸€ä¸ªWebæœåŠ¡å™¨ï¼š</p>
<pre><code>1.  proxyåå‘ä»£ç†æœºå™¨æ”¶åˆ°ç”¨æˆ·è¯·æ±‚
2.  proxyé€šè¿‡è¿™ä¸ªè¯·æ±‚æŸäº›flagidæ ‡è®°å¾—çŸ¥å½“å‰è¿™ä¸ªè¯·æ±‚æ˜¯Aç”¨æˆ·çš„
3.  æ¥ç€proxyå®šä¹‰ä¸€ä¸ªhashç®—æ³•getServerï¼Œé€šè¿‡è®¡ç®—svr = getServer(flag)å¾—åˆ°æœ€åè¿™ä¸ªè¯·æ±‚è¦å»åˆ°çš„WebæœåŠ¡å™¨svr&amp;nbsp;

    åªè¦ä¿è¯getServerè¿™ä¸ªhashç®—æ³•æ¯æ¬¡è¾“å‡ºæ˜¯å”¯ä¸€å³å¯ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“åšåˆ°ã€‚é—®é¢˜ï¼šç”¨æˆ·çš„è¯·æ±‚å¸¦ä¸Šçš„flagidæ˜¯æ€ä¹ˆå¸¦çš„ï¼Ÿæˆ‘ä»¬å…ˆä¸çº ç»“è¿™ä¸ªæ€ä¹ˆåšï¼Œæˆ‘ä»¬åªè¦åœ¨ç”¨æˆ·ç™»é™†æˆ‘ä»¬ç³»ç»Ÿåï¼Œåœ¨cookiesç§ä¸Šä¸€ä¸ªèƒ½æ ‡è®°å‡ºè¿™ä¸ªç”¨æˆ·çš„idå³å¯ã€‚
</code></pre><div class="md-section-divider">&nbsp;</div><br><div class="md-section-divider">&nbsp;</div>

</blockquote>
<p>&nbsp;</p>
<p></p></div><p></p>
<p></p></div><p></p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Git Note]]></title>
      <url>/2016/08/24/Git-Note/</url>
      <content type="html"><![CDATA[<h1 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h1><blockquote>
<p>å‚è€ƒ <a href="http://chengshiwen.com/article/head-first-git/" target="_blank" rel="noopener">http://chengshiwen.com/article/head-first-git/</a></p>
</blockquote>
<h2 id="æ–‡ä»¶çŠ¶æ€"><a href="#æ–‡ä»¶çŠ¶æ€" class="headerlink" title="æ–‡ä»¶çŠ¶æ€"></a>æ–‡ä»¶çŠ¶æ€</h2><ul>
<li><p><strong>Gitç›®å½•</strong>: ï¼ˆgit directoryï¼‰ï¼Œäº¦å³Gitä»“åº“ï¼Œä¸€èˆ¬å¯¹åº”é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„.gitç›®å½•ã€‚è¯¥ç›®å½•éå¸¸é‡è¦ï¼Œæ¯æ¬¡å…‹éš†é•œåƒä»“åº“çš„æ—¶å€™ï¼Œå®é™…æ‹·è´çš„å°±æ˜¯è¿™ä¸ªç›®å½•é‡Œé¢çš„æ•°æ®ã€‚</p>
</li>
<li><p><strong>å·¥ä½œç›®å½•</strong>:ï¼ˆworking directoryï¼‰æ˜¯é¡¹ç›®æŸä¸ªç‰ˆæœ¬çš„ç­¾å‡ºï¼ˆThe working directory is a single checkout of one version of the projectï¼‰ ï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°é¡¹ç›®ç›®å½•ï¼Œå…¶åŒ…å«è¯¥ç‰ˆæœ¬çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬Gitç›®å½•ï¼‰ã€‚è¿™äº›æ–‡ä»¶éƒ½æ˜¯ä»Gitç›®å½•ä¸­å–å‡ºçš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å·¥ä½œç›®å½•ä¸­ä¿®æ”¹å®ƒä»¬(modify)ã€åˆ é™¤å®ƒä»¬(remove)æˆ–æ·»åŠ æ–°æ–‡ä»¶(add)â€”â€”è¿™äº›ç§°ä¹‹ä¸ºæ”¹åŠ¨ï¼ˆChangesï¼‰ã€‚</p>
</li>
<li><p><strong>æš‚å­˜åŒºåŸŸ</strong>:ï¼ˆstaging areaï¼‰æ˜¯å·¥ä½œç›®å½•å’ŒGitç›®å½•ä¹‹é—´çš„ä¸´æ—¶ä¸­è½¬åŒºï¼Œå­˜å‚¨ç€å·¥ä½œç›®å½•ä¸­éƒ¨åˆ†æ”¹åŠ¨æ–‡ä»¶çš„å¿«ç…§ï¼Œè¯¥å¿«ç…§å°†åœ¨ä¸‹æ¬¡æäº¤æ—¶è¢«æ°¸ä¹…åœ°ä¿å­˜åˆ°Gitç›®å½•ä¸­ã€‚æš‚å­˜åŒºåŸŸä¹Ÿå«ç´¢å¼•ï¼ˆindexï¼‰ï¼Œå®é™…æ˜¯Gitç›®å½•ä¸‹çš„indexæ–‡ä»¶ï¼ˆ<code>.git/index</code>ï¼‰ï¼Œå…¶å­˜æ”¾äº†ä¸å½“å‰æš‚å­˜å†…å®¹ç›¸å…³çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æš‚å­˜çš„æ–‡ä»¶åã€æ–‡ä»¶å†…å®¹çš„SHA-1å“ˆå¸Œå€¼å’Œæ–‡ä»¶è®¿é—®æƒé™ï¼Œä½¿ç”¨<code>git ls-files --stage</code>å‘½ä»¤å¯æŸ¥çœ‹å…¶å†…å®¹ã€‚</p>
</li>
</ul>
<h2 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><h3 id="æŸ¥çœ‹é…ç½®ä¿¡æ¯"><a href="#æŸ¥çœ‹é…ç½®ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹é…ç½®ä¿¡æ¯"></a>æŸ¥çœ‹é…ç½®ä¿¡æ¯</h3><p><code>git config --list</code></p>
<p><code>git config [--system/--global/--local] user.name</code></p>
<h3 id="åˆå§‹åŒ–æ–°ä»“åº“"><a href="#åˆå§‹åŒ–æ–°ä»“åº“" class="headerlink" title="åˆå§‹åŒ–æ–°ä»“åº“"></a>åˆå§‹åŒ–æ–°ä»“åº“</h3><p><code>git init</code></p>
<h3 id="ä»ç°æœ‰ä»“åº“å…‹éš†"><a href="#ä»ç°æœ‰ä»“åº“å…‹éš†" class="headerlink" title="ä»ç°æœ‰ä»“åº“å…‹éš†"></a>ä»ç°æœ‰ä»“åº“å…‹éš†</h3><p>ä»ç°æœ‰çš„é¡¹ç›®ä»“åº“ï¼ˆå¦‚è¿œç¨‹æœåŠ¡å™¨ä¸Šè‡ªå·±çš„é¡¹ç›®ï¼Œæˆ–è€…å…¶å®ƒæŸä¸ªå¼€æºé¡¹ç›®ï¼‰å…‹éš†åˆ°æœ¬åœ°ï¼ŒGitæ¥æ”¶çš„æ˜¯é¡¹ç›®å†å²çš„æ‰€æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬æ¯ä¸€ä¸ªæ–‡ä»¶çš„æ¯ä¸€ä¸ªç‰ˆæœ¬ï¼‰ã€‚</p>
<p><code>git clone &lt;repo&gt; [&lt;dir&gt;]</code></p>
<p>å…‹éš†æ—¶å¯ä»¥åœ¨ä¸Šé¢çš„å‘½ä»¤æœ«å°¾æŒ‡å®šæ–°çš„åå­—ï¼Œæ¥å®šä¹‰è¦æ–°å»ºçš„é¡¹ç›®ç›®å½•åç§°ï¼ˆä»…ç›®å½•åç§°ä¸åŒï¼‰ï¼Œä¾‹å¦‚ï¼š</p>
<p><code>git clone git@github.com:jquery/jquery.git myjquery</code></p>
<p>Gitæ”¯æŒ<code>git://</code>ï¼Œ<code>http(s)://</code>ï¼Œ<code>ssh://</code>ç­‰å¤šç§æ•°æ®ä¼ è¾“åè®®ã€‚</p>
<h2 id="Gitçš„åŸºæœ¬å·¥ä½œæµç¨‹"><a href="#Gitçš„åŸºæœ¬å·¥ä½œæµç¨‹" class="headerlink" title="Gitçš„åŸºæœ¬å·¥ä½œæµç¨‹"></a>Gitçš„åŸºæœ¬å·¥ä½œæµç¨‹</h2><ul>
<li><p>æ”¹åŠ¨æ–‡ä»¶ï¼šåœ¨å·¥ä½œç›®å½•ä¸­ä¿®æ”¹ã€åˆ é™¤æˆ–æ·»åŠ æŸäº›æ–‡ä»¶</p>
</li>
<li><p>æš‚å­˜æ–‡ä»¶ï¼šå¯¹æ”¹åŠ¨åçš„æ–‡ä»¶è¿›è¡Œå¿«ç…§ï¼Œä¿å­˜è‡³æš‚å­˜åŒºåŸŸ</p>
</li>
<li><p>æäº¤å¿«ç…§ï¼šå°†ä¿å­˜åœ¨æš‚å­˜åŒºåŸŸçš„æ–‡ä»¶å¿«ç…§æ°¸ä¹…è½¬å‚¨åˆ°Gitç›®å½•ä¸­</p>
</li>
</ul>
<h3 id="æŸ¥çœ‹å·¥ä½œç›®å½•ä¸‹å½“å‰æ–‡ä»¶çš„çŠ¶æ€"><a href="#æŸ¥çœ‹å·¥ä½œç›®å½•ä¸‹å½“å‰æ–‡ä»¶çš„çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹å·¥ä½œç›®å½•ä¸‹å½“å‰æ–‡ä»¶çš„çŠ¶æ€"></a>æŸ¥çœ‹å·¥ä½œç›®å½•ä¸‹å½“å‰æ–‡ä»¶çš„çŠ¶æ€</h3><p><code>git status</code></p>
<h3 id="æš‚å­˜æ–‡ä»¶"><a href="#æš‚å­˜æ–‡ä»¶" class="headerlink" title="æš‚å­˜æ–‡ä»¶"></a>æš‚å­˜æ–‡ä»¶</h3><p>å…¶ä½œç”¨æ˜¯æŠŠç›®æ ‡æ–‡ä»¶å¿«ç…§æ”¾å…¥æš‚å­˜åŒºåŸŸï¼ˆadd file into staged areaï¼‰ã€‚</p>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>æ–°æ–‡ä»¶</th>
<th>è¢«ä¿®æ”¹æ–‡ä»¶</th>
<th>è¢«åˆ é™¤æ–‡ä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>git add</code></td>
<td>Y</td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td><code>git add -u</code></td>
<td>N</td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><code>git add -A</code></td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
</tr>
</tbody>
</table>
<h4 id="å–æ¶ˆå·²ä¿®æ”¹æˆ–å·²æš‚å­˜æ–‡ä»¶"><a href="#å–æ¶ˆå·²ä¿®æ”¹æˆ–å·²æš‚å­˜æ–‡ä»¶" class="headerlink" title="å–æ¶ˆå·²ä¿®æ”¹æˆ–å·²æš‚å­˜æ–‡ä»¶"></a>å–æ¶ˆå·²ä¿®æ”¹æˆ–å·²æš‚å­˜æ–‡ä»¶</h4><p><code>git checkout [&lt;commit&gt;] [--] &lt;file&gt;...</code></p>
<ul>
<li><p>çœç•¥commit: æš‚å­˜åŒºåŸŸ è¦†ç›–å·¥ä½œç›®å½• çš„æ–‡ä»¶</p>
</li>
<li><p>æŒ‡å®šcommit: æŒ‡å®šcommit è¦†ç›–æš‚å­˜åŒºåŸŸå’Œå·¥ä½œç›®å½•</p>
</li>
</ul>
<p>ä¸¤è€…ä¸ä¼šæ”¹å˜HEADæŒ‡é’ˆï¼Œå…¶ä¸­â€“ç”¨äºåˆ†éš”æŒ‡å®šæ–‡ä»¶ï¼Œé˜²æ­¢è¯¥æ–‡ä»¶ä¸åˆ†æ”¯é‡åé€ æˆåˆ†æ”¯è¯¯æ“ä½œã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -- grep.py   # æ”¾å¼ƒgrep.pyæ–‡ä»¶æœªæš‚å­˜çš„æ”¹åŠ¨</span><br><span class="line">$ git checkout .            # æ”¾å¼ƒæ‰€æœ‰æœªæš‚å­˜çš„æ”¹åŠ¨</span><br><span class="line">$ git checkout HEAD *.txt   # æ”¾å¼ƒæœ¬æ¬¡æ‰€æœ‰txtæ–‡ä»¶ä½œçš„æ”¹åŠ¨ï¼ˆåŒ…æ‹¬å·¥ä½œç›®å½•å’Œæš‚å­˜åŒºåŸŸï¼‰</span><br><span class="line">$ git checkout HEAD .       # æ”¾å¼ƒæ‰€æœ‰å·²æš‚å­˜æ”¹åŠ¨å’Œæœªæš‚å­˜æ”¹åŠ¨ï¼Œå³å®Œå…¨é‡ç½®åˆ°æœ€è¿‘çš„æäº¤çŠ¶æ€</span><br></pre></td></tr></table></figure>
<h4 id="æ–‡ä»¶é‡ç½®ä¸ºæœ€è¿‘æäº¤æ—¶çš„çŠ¶æ€"><a href="#æ–‡ä»¶é‡ç½®ä¸ºæœ€è¿‘æäº¤æ—¶çš„çŠ¶æ€" class="headerlink" title="æ–‡ä»¶é‡ç½®ä¸ºæœ€è¿‘æäº¤æ—¶çš„çŠ¶æ€"></a>æ–‡ä»¶é‡ç½®ä¸ºæœ€è¿‘æäº¤æ—¶çš„çŠ¶æ€</h4><p><code>git reset HEAD &lt;file&gt;</code></p>
<h4 id="ä»æš‚å­˜åŒºåŸŸç§»é™¤æ–‡ä»¶"><a href="#ä»æš‚å­˜åŒºåŸŸç§»é™¤æ–‡ä»¶" class="headerlink" title="ä»æš‚å­˜åŒºåŸŸç§»é™¤æ–‡ä»¶"></a>ä»æš‚å­˜åŒºåŸŸç§»é™¤æ–‡ä»¶</h4><p><code>git rm --cached &lt;file&gt;</code></p>
<h3 id="å·®å¼‚æ¯”è¾ƒ"><a href="#å·®å¼‚æ¯”è¾ƒ" class="headerlink" title="å·®å¼‚æ¯”è¾ƒ"></a>å·®å¼‚æ¯”è¾ƒ</h3><table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>git diff</code></td>
<td>å·¥ä½œç›®å½• / æš‚å­˜åŒºåŸŸå¿«ç…§</td>
</tr>
<tr>
<td><code>git diff [--] &lt;path&gt;...</code></td>
<td>å·¥ä½œç›®å½• / æš‚å­˜åŒºåŸŸå¿«ç…§(æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•)</td>
</tr>
<tr>
<td><code>git diff --cached</code></td>
<td>æš‚å­˜åŒºåŸŸå¿«ç…§ / ä¸Šæ¬¡æäº¤</td>
</tr>
<tr>
<td><code>git diff --cached [--] &lt;path&gt;...</code></td>
<td>æš‚å­˜åŒºåŸŸå¿«ç…§ / ä¸Šæ¬¡æäº¤(æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•)</td>
</tr>
<tr>
<td><code>git diff HEAD</code></td>
<td>å·¥ä½œç›®å½• / ä¸Šæ¬¡æäº¤</td>
</tr>
<tr>
<td><code>git diff &lt;commit&gt;</code></td>
<td>å·¥ä½œç›®å½• / commit</td>
</tr>
<tr>
<td><code>git diff &lt;commit&gt; [--] &lt;path&gt;...</code></td>
<td>å·¥ä½œç›®å½• / commit(æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•)</td>
</tr>
<tr>
<td><code>git diff --cached HEAD</code></td>
<td>æš‚å­˜åŒºåŸŸå¿«ç…§ / ä¸Šæ¬¡æäº¤</td>
</tr>
<tr>
<td><code>git diff --cached &lt;commit&gt;</code></td>
<td>æš‚å­˜åŒºåŸŸå¿«ç…§ / commit</td>
</tr>
<tr>
<td><code>git diff --cached &lt;commit&gt; [--] &lt;path&gt;...</code></td>
<td>æš‚å­˜åŒºåŸŸå¿«ç…§ / commit(æŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•)</td>
</tr>
<tr>
<td><code>git diff &lt;commit1&gt; &lt;commit2&gt;</code></td>
<td>commit1 / commit2</td>
</tr>
<tr>
<td><code>git diff --check</code></td>
<td>åˆ—å‡ºæ‰€æœ‰çš„å°¾éšç©ºç™½ç¬¦</td>
</tr>
</tbody>
</table>
<h3 id="æäº¤å¿«ç…§"><a href="#æäº¤å¿«ç…§" class="headerlink" title="æäº¤å¿«ç…§"></a>æäº¤å¿«ç…§</h3><p>æŠŠæš‚å­˜åŒºåŸŸå†…çš„æ–‡ä»¶å¿«ç…§æäº¤è‡³Gitç›®å½•ä¸­:<br><code>git commit -m &quot;Fix Bug #182: Fix benchmarks for speed&quot;</code></p>
<p>æŠŠæ‰€æœ‰å·²ç»è·Ÿè¸ªè¿‡çš„æ–‡ä»¶æš‚å­˜èµ·æ¥ä¸€å¹¶æäº¤:<br><code>git commit -a -m &quot;added new benchmarks&quot;</code></p>
<p>ä»¥æ–°ä½œè€…æäº¤:<code>git commit --author wjhook&lt;wjhook@gmail.com&gt;</code></p>
<p>å°†æŒ‡å®šæ–‡ä»¶å’Œå·²æš‚å­˜æ–‡ä»¶ä¸€å¹¶æäº¤:<code>git commit -i &lt;file&gt;...</code></p>
<p>åªæäº¤æŒ‡å®šæ–‡ä»¶:<code>git commit -o &lt;file&gt;...</code></p>
<p>ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤:</p>
<ul>
<li>é‡æ–°ç¼–è¾‘æäº¤è¯´æ˜: <code>git commit --amend -m &lt;message&gt;</code></li>
<li>é‡æ–°ç¼–è¾‘æäº¤ä½œè€…: <code>git commit --amend --author wjhook&lt;wjhook@gmail.com&gt;</code></li>
</ul>
<h3 id="Gitçš„åŸºæœ¬å·¥ä½œæ‰©å±•"><a href="#Gitçš„åŸºæœ¬å·¥ä½œæ‰©å±•" class="headerlink" title="Gitçš„åŸºæœ¬å·¥ä½œæ‰©å±•"></a>Gitçš„åŸºæœ¬å·¥ä½œæ‰©å±•</h3><h4 id="æŸ¥çœ‹æäº¤å†å²"><a href="#æŸ¥çœ‹æäº¤å†å²" class="headerlink" title="æŸ¥çœ‹æäº¤å†å²"></a>æŸ¥çœ‹æäº¤å†å²</h4><p><code>git log --pretty=format:&quot;%h [%an]&lt;%ae&gt;(%ad) message -&gt; %s&quot; --after=&quot;2016-08-12 15:26:00&quot; --before=&quot;2016-08-25&quot; --graph --author= wangjie -p -- *android/alibaba/member*FragmentMemberSignIn.java  -3</code></p>
<p>æŒ‰ç…§â€hash [ä½œè€…]&lt;é‚®ç®±&gt;(æ—¶é—´) message -&gt; æäº¤è¯´æ˜â€çš„æ ¼å¼æŸ¥çœ‹æäº¤æ—¶é—´åœ¨2016-08-12 15:26:00 ~ 2016-08-25 ä¹‹é—´çš„ã€ä½œè€…ä¸ºwangjieçš„å…³äº<code>*android/alibaba/member*FragmentMemberSignIn.java</code>æ–‡ä»¶çš„logå¹¶æ˜¾ç¤ºæäº¤å·®å¼‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">%H	ï¼šæäº¤å¯¹è±¡ï¼ˆcommitï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸²</span><br><span class="line">%h	ï¼šæäº¤å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸²</span><br><span class="line">%anï¼šä½œè€…ï¼ˆauthorï¼‰çš„åå­—</span><br><span class="line">%aeï¼šä½œè€…çš„ç”µå­é‚®ä»¶åœ°å€</span><br><span class="line">%adï¼šä½œè€…ä¿®è®¢æ—¥æœŸï¼ˆå¯ä»¥ç”¨ -date= é€‰é¡¹å®šåˆ¶æ ¼å¼ï¼‰</span><br><span class="line">%arï¼šä½œè€…ä¿®è®¢æ—¥æœŸï¼ŒæŒ‰å¤šä¹…ä»¥å‰çš„æ–¹å¼æ˜¾ç¤º</span><br><span class="line">%sï¼šæäº¤è¯´æ˜</span><br></pre></td></tr></table></figure>
<p><code>git log --diff-filter=[A/D] --summary</code>ï¼š<br>åˆ—å‡ºç‰ˆæœ¬åº“ä¸­æ›¾æ·»åŠ /åˆ é™¤è¿‡æ–‡ä»¶çš„æäº¤</p>
<p><code>git log --diff-filter=[A/D] --summary | grep create</code>ï¼š<br>åˆ—å‡ºæ‰€æœ‰æ·»åŠ /åˆ é™¤è¿‡çš„å†å²æ–‡ä»¶</p>
<p><code>git log branch1..branch2</code>ï¼šå±äºbranch2ï¼Œä¸å±äºbranch1çš„æäº¤</p>
<h5 id="æš‚å­˜æ ˆ"><a href="#æš‚å­˜æ ˆ" class="headerlink" title="æš‚å­˜æ ˆ"></a>æš‚å­˜æ ˆ</h5><blockquote>
<p><stash> -&gt; stash@{0/1/2/3â€¦}</stash></p>
</blockquote>
<p><code>git stash [save &lt;message&gt;]</code>: å½“å‰å·¥ä½œä¿å­˜åˆ°æš‚å­˜æ ˆä¸­</p>
<p><code>git stash pop [&lt;stash&gt;]</code>: æ¢å¤æš‚å­˜æ ˆä¸­å¼•ç”¨ä¸º<stash>çš„å·¥ä½œï¼Œå¹¶ä»æš‚å­˜æ ˆä¸­åˆ é™¤</stash></p>
<p><code>git stash apply [&lt;stash&gt;]</code>: æ¢å¤æš‚å­˜æ ˆä¸­å¼•ç”¨ä¸º<stash>çš„å·¥ä½œï¼Œæš‚å­˜æ ˆä¸­ä¸åˆ é™¤</stash></p>
<p><code>git stash drop [&lt;stash&gt;]</code>: åˆ é™¤æš‚å­˜æ ˆä¸­å¼•ç”¨ä¸º<stash>çš„å·¥ä½œ</stash></p>
<p><code>git stash list</code>: åˆ—å‡ºæš‚å­˜æ ˆä¸­çš„æ‰€æœ‰å·¥ä½œ</p>
<p><code>git stash show [&lt;stash&gt;]</code>: æ˜¾ç¤ºæš‚å­˜æ ˆä¸­å¼•ç”¨ä¸º<stash>çš„å·¥ä½œçš„æ”¹åŠ¨è®°å½•</stash></p>
<p><code>git stash clear</code>: æ¸…é™¤æš‚å­˜æ ˆä¸­æ‰€æœ‰ä¿ç•™çš„å·¥ä½œ</p>
<p><code>git stash branch &lt;branchname&gt; [&lt;stash&gt;]</code>: åŸºäºæŒ‡å®šå·¥ä½œåˆ›å»ºæ–°åˆ†æ”¯ï¼Œå®Œå…¨æ¢å¤è¯¥å·¥ä½œè¢«ä¿å­˜å‰çš„çŠ¶æ€ï¼ˆæ–°å»ºä¸€ä¸ªæœ€æ–°æäº¤ä¸º<stash>åˆ›å»ºæ—¶æ‰€åœ¨çš„æäº¤ã€åä¸º<branchname>çš„åˆ†æ”¯ï¼ŒåŒæ—¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯ï¼Œæ¢å¤æš‚å­˜æ ˆä¸­å¼•ç”¨ä¸º<stash>çš„å·¥ä½œï¼Œå¹¶å°†å…¶ä»æš‚å­˜æ ˆä¸­åˆ é™¤ï¼‰</stash></branchname></stash></p>
<h5 id="åˆ é™¤æ–‡ä»¶"><a href="#åˆ é™¤æ–‡ä»¶" class="headerlink" title="åˆ é™¤æ–‡ä»¶"></a>åˆ é™¤æ–‡ä»¶</h5><p><code>rm &lt;file&gt;...</code>ï¼šä»å·¥ä½œç›®å½•ä¸­åˆ é™¤æŒ‡å®šæ–‡ä»¶ï¼Œä½†ä¸ä»æš‚å­˜åŒºåŸŸç§»é™¤</p>
<p><code>git rm &lt;file&gt;...</code>ï¼šä»å·¥ä½œç›®å½•ä¸­åˆ é™¤æŒ‡å®šæ–‡ä»¶ï¼ŒåŒæ—¶å°†å…¶ä»æš‚å­˜åŒºåŸŸç§»é™¤</p>
<p><code>git rm --cached &lt;file&gt;...</code>ï¼šä»…ä»…å°†æ–‡ä»¶ä»æš‚å­˜åŒºåŸŸä¸­ç§»é™¤ï¼ˆå…¶çŠ¶æ€å˜ä¸ºæœªè·Ÿè¸ªï¼‰ï¼Œä¸å¯¹è¯¥æ–‡ä»¶è¿›è¡Œå…¶å®ƒæ“ä½œ</p>
<p><code>git rm -f &lt;file&gt;...</code>ï¼šå¼ºåˆ¶åˆ é™¤</p>
<p><code>git rm -r &lt;file&gt;...</code>ï¼šé€’å½’åˆ é™¤ï¼ˆç”¨äºåˆ é™¤ç›®å½•ï¼‰</p>
<h5 id="ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶"><a href="#ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶" class="headerlink" title="ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶"></a>ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶</h5><p><code>git mv &lt;file_from&gt; &lt;file_to&gt;</code></p>
<p>å…¶ç­‰ä»·äº</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mv &lt;file_from&gt; &lt;file_to&gt;</span><br><span class="line">$ git rm &lt;file_from&gt;</span><br><span class="line">$ git add &lt;file_to</span><br></pre></td></tr></table></figure>
<h5 id="æ¸…é™¤æœªè·Ÿè¸ªæ–‡ä»¶"><a href="#æ¸…é™¤æœªè·Ÿè¸ªæ–‡ä»¶" class="headerlink" title="æ¸…é™¤æœªè·Ÿè¸ªæ–‡ä»¶"></a>æ¸…é™¤æœªè·Ÿè¸ªæ–‡ä»¶</h5><p><code>git clean -n</code>: æ˜¾ç¤ºå°†è¦æ¸…é™¤çš„æ–‡ä»¶å’Œç›®å½•</p>
<p><code>git clean -f</code>ï¼šå¼ºåˆ¶æ¸…é™¤æ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬ç›®å½•ï¼‰</p>
<p><code>git clean -df</code>ï¼šå¼ºåˆ¶æ¸…é™¤æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•</p>
<p>è‹¥è¦åŒæ—¶å†ç§»é™¤è¢«å¿½ç•¥çš„æ–‡ä»¶æˆ–ç›®å½•ï¼ŒåŠ ä¸Š-xå‚æ•°ï¼›è‹¥åªç§»é™¤è¢«å¿½ç•¥çš„æ–‡ä»¶æˆ–ç›®å½•ï¼ŒåŠ ä¸Š-Xå‚æ•°ã€‚</p>
<h5 id="åˆå¹¶"><a href="#åˆå¹¶" class="headerlink" title="åˆå¹¶"></a>åˆå¹¶</h5><p><code>git merge -m &lt;msg&gt; &lt;commit&gt;</code>ï¼šå¦‚æœäº§ç”Ÿæ–°çš„åˆå¹¶æäº¤ï¼Œåˆ™é™„åŠ msgè¯´æ˜</p>
<p><code>git merge --no-commit &lt;commit&gt;</code>ï¼šåˆå¹¶æˆåŠŸåä¸ä¼šè‡ªåŠ¨äº§ç”Ÿæ–°çš„æäº¤ï¼Œç”¨æˆ·å¯ä»¥åœ¨ä¸‹æ¬¡æäº¤å‰å¯¹è¿™æ¬¡çš„åˆå¹¶ç»“æœè¿›è¡Œä¿®æ”¹å’Œè°ƒæ•´</p>
<p><code>git merge --abort</code>ï¼šé‡åˆ°åˆå¹¶å†²çªæ—¶ï¼Œæ­¤å‘½ä»¤å°†ç»ˆæ­¢åˆå¹¶ï¼Œå¹¶æ¢å¤æœªåˆå¹¶ä¹‹å‰çš„çŠ¶æ€</p>
<h5 id="åˆ†æ”¯æŒ‘æ¡"><a href="#åˆ†æ”¯æŒ‘æ¡" class="headerlink" title="åˆ†æ”¯æŒ‘æ¡"></a>åˆ†æ”¯æŒ‘æ¡</h5><p>å¦‚æœä¸éœ€è¦åˆå¹¶æŸä¸ªåˆ†æ”¯çš„å…¨éƒ¨æäº¤,è€Œåªéœ€è¦è¯¥åˆ†æ”¯çš„æŸä¸ªæˆ–æŸäº›æäº¤,ä½¿ç”¨git cherry-pickå‘½ä»¤ï¼Œå®ƒä¼šå°†æŒ‡å®šçš„commité‡æ–°åº”ç”¨åˆ°å½“å‰åˆ†æ”¯ï¼Œå‘½ä»¤æ ¼å¼ä¸ºï¼š</p>
<p><code>$ git cherry-pick &lt;commit&gt;...</code></p>
<h3 id="è¿œç¨‹äº¤äº’"><a href="#è¿œç¨‹äº¤äº’" class="headerlink" title="è¿œç¨‹äº¤äº’"></a>è¿œç¨‹äº¤äº’</h3><h5 id="æŸ¥çœ‹è¿œç¨‹ä»“åº“"><a href="#æŸ¥çœ‹è¿œç¨‹ä»“åº“" class="headerlink" title="æŸ¥çœ‹è¿œç¨‹ä»“åº“"></a>æŸ¥çœ‹è¿œç¨‹ä»“åº“</h5><p><code>git remote</code></p>
<p>åŠ ä¸Š<code>-v</code>é€‰é¡¹ï¼Œæ˜¾ç¤ºå¯¹åº”çš„å…‹éš†åœ°å€ï¼š<code>git remote -v</code></p>
<h5 id="æ·»åŠ è¿œç¨‹ä»“åº“"><a href="#æ·»åŠ è¿œç¨‹ä»“åº“" class="headerlink" title="æ·»åŠ è¿œç¨‹ä»“åº“"></a>æ·»åŠ è¿œç¨‹ä»“åº“</h5><p><code>git remote add &lt;shortname&gt; &lt;url&gt;</code></p>
<p><code>git remote add upstream https://github.com/xgenvn/InputHelper.git</code></p>
<p>æ‹‰å–æ‰€æœ‰xgenvnæœ‰çš„ï¼Œä½†æœ¬åœ°ä»“åº“æ²¡æœ‰çš„ä¿¡æ¯</p>
<p><code>git fetch upstream</code></p>
<p><code>git remote rename &lt;old&gt; &lt;new&gt;</code>ï¼šé‡å‘½åè¿œç¨‹ä»“åº“</p>
<p><code>git remote rm &lt;name&gt;</code>ï¼šåˆ é™¤åä¸ºnameçš„è¿œç¨‹ä»“åº“</p>
<p><code>git remote [-v] show &lt;name&gt;</code>ï¼šæŸ¥çœ‹è¿œç¨‹ä»“åº“ä¿¡æ¯</p>
<p><code>git remote prune &lt;name&gt;</code>ï¼šåˆ é™¤ä¸å­˜åœ¨å¯¹åº”è¿œç¨‹åˆ†æ”¯çš„æœ¬åœ°åˆ†æ”¯</p>
<h5 id="æ¨é€æäº¤åˆ°è¿œç¨‹ä»“åº“"><a href="#æ¨é€æäº¤åˆ°è¿œç¨‹ä»“åº“" class="headerlink" title="æ¨é€æäº¤åˆ°è¿œç¨‹ä»“åº“"></a>æ¨é€æäº¤åˆ°è¿œç¨‹ä»“åº“</h5><p><code>git push &lt;remote&gt; &lt;branch&gt;</code></p>
<p><code>git push &lt;remote&gt; &lt;lbranch&gt;:[&lt;rbranch&gt;]</code>ï¼šå°†æœ¬åœ°lbranchåˆ†æ”¯æ¨é€åˆ°remoteè¿œç¨‹ä»“åº“çš„rbranchåˆ†æ”¯ã€‚è‹¥rbranchç¼ºçœåˆ™é»˜è®¤ä¸ºlbranchï¼Œç­‰åŒäºgit push <remote> <lbranch></lbranch></remote></p>
<p><code>git push &lt;remote&gt; :&lt;branch&gt;</code>ï¼šå°†ç©ºæ¨é€åˆ°remoteè¿œç¨‹ä»“åº“çš„branchåˆ†æ”¯ï¼Œå³åˆ é™¤remoteè¿œç¨‹ä»“åº“çš„branchåˆ†æ”¯</p>
<p><code>git push &lt;remote&gt; --delete &lt;branch&gt;</code>ï¼šåˆ é™¤remoteè¿œç¨‹ä»“åº“çš„branchåˆ†æ”¯</p>
<p><code>git push &lt;remote&gt; -f &lt;lbranch&gt;:[&lt;rbranch&gt;]</code>ï¼šå°†æœ¬åœ°lbranchåˆ†æ”¯å¼ºåˆ¶æ¨é€åˆ°remoteè¿œç¨‹ä»“åº“çš„rbranchåˆ†æ”¯</p>
<h5 id="ä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°æ”¹åŠ¨"><a href="#ä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°æ”¹åŠ¨" class="headerlink" title="ä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°æ”¹åŠ¨"></a>ä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°æ”¹åŠ¨</h5><p>åŸºæœ¬å‘½ä»¤ä¸º<code>git fetch</code>ï¼Œå…¶ä½œç”¨æ˜¯åˆ°è¿œç¨‹ä»“åº“ä¸­æ‹‰å–æ‰€æœ‰æœ¬åœ°ä»“åº“ä¸­è¿˜æ²¡æœ‰çš„æœ€æ–°æ”¹åŠ¨ï¼Œä½†ä¸ä¼šè‡ªåŠ¨å°†è¿™äº›æ”¹åŠ¨åˆå¹¶åˆ°å½“å‰å·¥ä½œåˆ†æ”¯</p>
<p><code>git fetch [&lt;remote&gt;]</code>ï¼šåˆ°remoteè¿œç¨‹ä»“åº“æ‹‰å–æ‰€æœ‰æœ¬åœ°ä»“åº“ä¸­è¿˜æ²¡æœ‰çš„æœ€æ–°æ”¹åŠ¨ï¼Œä¸æŒ‡å®šremoteåˆ™é»˜è®¤ä¸ºorigin</p>
<p><code>git fetch &lt;remote&gt; &lt;branch&gt;</code>ï¼šå°†remoteè¿œç¨‹ä»“åº“çš„branchåˆ†æ”¯æ‹‰å–åˆ°æœ¬åœ°ï¼ŒåŒæ—¶ç”¨FETCH_HEADæŒ‡é’ˆæŒ‡å‘å®ƒ</p>
<p><code>git fetch --all</code>ï¼šæ‹‰å–æ‰€æœ‰è¿œç¨‹ä»“åº“</p>
<p><code>git fetch -p</code>ï¼šåˆ é™¤ä¸å­˜åœ¨å¯¹åº”è¿œç¨‹åˆ†æ”¯çš„æœ¬åœ°åˆ†æ”¯</p>
<h5 id="ä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°æ”¹åŠ¨å¹¶åˆå¹¶"><a href="#ä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°æ”¹åŠ¨å¹¶åˆå¹¶" class="headerlink" title="ä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°æ”¹åŠ¨å¹¶åˆå¹¶"></a>ä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°æ”¹åŠ¨å¹¶åˆå¹¶</h5><p>åŸºæœ¬å‘½ä»¤ä¸º<code>git pull</code>ï¼Œå…¶ä½œç”¨æ˜¯ä»è¿œç¨‹ä»“åº“è‡ªåŠ¨æ‹‰å–æœ€æ–°æ”¹åŠ¨åˆ°æœ¬åœ°ï¼ˆFetchï¼‰ï¼Œç„¶åå°†è¿œç¨‹åˆ†æ”¯è‡ªåŠ¨åˆå¹¶åˆ°æœ¬åœ°ä»“åº“ä¸­çš„å½“å‰åˆ†æ”¯(Merge)</p>
<p><code>git pull &lt;remote&gt; &lt;branch&gt;</code></p>
<p>å…¶å°†remoteè¿œç¨‹ä»“åº“çš„branchåˆ†æ”¯æ‹‰å–åˆ°æœ¬åœ°ï¼Œç„¶åå°†å…¶åˆå¹¶åˆ°æœ¬åœ°å½“å‰åˆ†æ”¯ã€‚</p>
<p><code>git pull &lt;remote&gt; &lt;rbranch&gt;:&lt;lbranch&gt;</code>ï¼šå°†remoteè¿œç¨‹ä»“åº“çš„rbranchåˆ†æ”¯æ‹‰å–åˆ°æœ¬åœ°ï¼Œç„¶åå°†å…¶åˆå¹¶åˆ°æœ¬åœ°lbranchåˆ†æ”¯</p>
<h5 id="é‡ç½®"><a href="#é‡ç½®" class="headerlink" title="é‡ç½®"></a>é‡ç½®</h5><p>åŸºæœ¬å‘½ä»¤ä¸ºgit resetï¼Œå…¶ä½œç”¨æ˜¯å°†å½“å‰åˆ†æ”¯æŒ‡é’ˆï¼ˆHEADæŒ‡é’ˆï¼‰é‡ç½®ä¸ºæŒ‡å®šçŠ¶æ€</p>
<p><code>git reset [&lt;commit&gt;] [--] &lt;paths&gt;...</code></p>
<p>å°†æš‚å­˜åŒºåŸŸä¸­æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶é‡ç½®ä¸ºæŒ‡å®šcommitï¼ˆä¸æŒ‡å®šåˆ™é»˜è®¤ä¸ºHEADï¼‰æ—¶çš„çŠ¶æ€ï¼Œä½†ä¸ä¼šæ”¹å˜å·¥ä½œç›®å½•åŠå½“å‰åˆ†æ”¯ï¼Œå…¶ç›¸å½“äºgit add <paths>çš„åå‘æ“ä½œã€‚è¯¥å‘½ä»¤æ‰§è¡Œåï¼Œè‡ªä»commitä»¥æ¥æŒ‡å®šæ–‡ä»¶çš„æ‰€æœ‰æ”¹åŠ¨éƒ½æ˜¾ç¤ºåœ¨Changes not staged for commitä¸­ï¼Œè€Œè¿™äº›æ”¹åŠ¨çš„åå‘æ”¹åŠ¨ä¼šæ˜¾ç¤ºåœ¨Changes to be committedä¸­ã€‚</paths></p>
<p><code>git reset (--soft|--mixed|--hard) [&lt;commit&gt;]</code></p>
]]></content>
      
        
        <tags>
            
            <tag> tips </tag>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä½¿ç”¨è‡ªå®šä¹‰JUnit Rulesã€annotationså’ŒResourcesè¿›è¡Œå•å…ƒæµ‹è¯•ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2016/08/22/Android-%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89JUnit-Rules%E3%80%81annotations%E5%92%8CResources%E8%BF%9B%E8%A1%8C%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="ä½¿ç”¨è‡ªå®šä¹‰JUnit-Rulesã€annotationså’ŒResourcesè¿›è¡Œå•å…ƒæµ‹è¯•"><a href="#ä½¿ç”¨è‡ªå®šä¹‰JUnit-Rulesã€annotationså’ŒResourcesè¿›è¡Œå•å…ƒæµ‹è¯•" class="headerlink" title="ä½¿ç”¨è‡ªå®šä¹‰JUnit Rulesã€annotationså’ŒResourcesè¿›è¡Œå•å…ƒæµ‹è¯•"></a>ä½¿ç”¨è‡ªå®šä¹‰JUnit Rulesã€annotationså’ŒResourcesè¿›è¡Œå•å…ƒæµ‹è¯•</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="http://www.thedroidsonroids.com/blog/android/unit-tests-rules-annotations-resources" target="_blank" rel="noopener">http://www.thedroidsonroids.com/blog/android/unit-tests-rules-annotations-resources</a></p>
</blockquote>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Unit Testå¹¶ä¸åªæœ‰æ–­è¨€å’Œæµ‹è¯•æ–¹æ³•ç»„æˆã€‚å®ƒæœ‰ä¸€äº›å¯ä»¥ç”¨æ¥æé«˜è´¨é‡å’Œæµ‹è¯•ä»£ç å¯è¯»æ€§çš„æŠ€æœ¯ã€‚åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬å°†æ¢ç´¢ï¼š</p>
<ul>
<li>annotations</li>
<li>JUnit rules</li>
<li>java resources</li>
</ul>
<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>å¾ˆå¤šæˆ–è€…å¤§å¤šæ•°Android appsä½œä¸ºä¸€ä¸ªAPI Clientï¼Œå› æ­¤éœ€è¦æ•°æ®æ ¼å¼ä¹‹é—´çš„è½¬æ¢ï¼ˆé€šå¸¸æ˜¯JSONï¼‰å’ŒPOJOï¼ˆæ•°æ®æ¨¡å‹ç±»ï¼‰ã€‚æˆ‘ä»¬ä¸éœ€è¦åœ¨è‡ªå·±çš„ä»£ç ä¸­å®ç°ä¸€ä¸ªè½¬æ¢å¼•æ“è€Œæ˜¯å¯ä»¥ä½¿ç”¨å¦‚ <a href="https://github.com/google/gson" target="_blank" rel="noopener">GSON</a> æˆ– <a href="https://github.com/square/moshi" target="_blank" rel="noopener">moshi</a> ç­‰ä¸‰æ–¹åº“æ¥å®Œæˆã€‚</p>
<p>ä¼—æ‰€å‘¨çŸ¥çš„åº“é€šå¸¸éƒ½æ˜¯æœ‰å¾ˆé«˜çš„å•å…ƒæµ‹è¯•çš„è¦†ç›–ç‡çš„ï¼Œæ‰€ä»¥å¦‚ä¸‹æµ‹è¯•å®ƒä»¬æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGson</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> <span class="comment">//given</span></span><br><span class="line"> Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line"> <span class="comment">//when</span></span><br><span class="line"> String result = gson.fromJson(<span class="string">"\"test\""</span>, String.class);</span><br><span class="line"> <span class="comment">//then</span></span><br><span class="line"> assertThat(result).isEqualTo(<span class="string">"test"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Listing 1. æ— ç”¨çš„GSONå•å…ƒæµ‹è¯•.</em></p>
<p>å¦ä¸€æ–¹é¢æµ‹è¯•è§£æï¼ˆJSONåˆ°POJOï¼‰å’Œç”Ÿæˆï¼ˆPOJOåˆ°JSONï¼‰é€»è¾‘ç›¸å…³çš„æ¨¡å‹ç±»å¯èƒ½æ˜¯æœ‰ç”¨çš„ã€‚å¦‚ä¸‹çš„POJOï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Contributor</span> </span>&#123;</span><br><span class="line"> <span class="keyword">public</span> String login;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">boolean</span> siteAdmin;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">long</span> id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Listing 2. ç®€å•POJO.</em></p>
<p>å’Œç›¸åº”çš„JSONï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"login"</span>: <span class="string">"koral--"</span>,</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">3340954</span>,</span><br><span class="line">    <span class="attr">"site_admin"</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Listing 3. ç®€å•JSON.</em></p>
<p>å¦‚æœå±æ€§æ˜ å°„éƒ½æ­£ç¡®çš„è¯ï¼Œæˆ‘ä»¬å¸Œæœ›å»æµ‹è¯•å®ƒã€‚æ³¨æ„å±æ€§<code>siteAdmin</code>ä½¿ç”¨äº†ä¸åŒçš„å‘½åé£æ ¼ ï¼ Javaä¸­çš„é©¼å³°å‘½åå’ŒJSONä¸­çš„è›‡åº•å‘½åã€‚</p>
<h2 id="ç®€å•æ–¹æ¡ˆ"><a href="#ç®€å•æ–¹æ¡ˆ" class="headerlink" title="ç®€å•æ–¹æ¡ˆ"></a>ç®€å•æ–¹æ¡ˆ</h2><p>æœ€ç®€å•çš„ä¸€ç§unit testçœ‹èµ·æ¥å¦‚ä¸‹ï¼š</p>
<p><span id="listing4"></span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testParseHardcodedContributors</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"> <span class="comment">//given</span></span><br><span class="line"> String json = <span class="string">"[\n"</span> +</span><br><span class="line"> <span class="string">"  &#123;\n"</span> +</span><br><span class="line"> <span class="string">"    \"login\": \"koral--\",\n"</span> +</span><br><span class="line"> <span class="string">"    \"id\": 3340954,\n"</span> +</span><br><span class="line"> <span class="string">"    \"site_admin\": true\n"</span> +</span><br><span class="line"> <span class="string">"  &#125;,\n"</span> +</span><br><span class="line"> <span class="string">"  &#123;\n"</span> +</span><br><span class="line"> <span class="string">"    \"login\": \"Wavesonics\",\n"</span> +</span><br><span class="line"> <span class="string">"    \"id\": 406473,\n"</span> +</span><br><span class="line"> <span class="string">"    \"site_admin\": false\n"</span> +</span><br><span class="line"> <span class="string">"  &#125;\n"</span> +</span><br><span class="line"> <span class="string">"]\n"</span>;</span><br><span class="line"></span><br><span class="line"> GsonBuilder gsonBuilder = <span class="keyword">new</span> GsonBuilder();</span><br><span class="line"> gsonBuilder.setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_UNDERSCORES);</span><br><span class="line"> Gson gson = gsonBuilder.create();</span><br><span class="line"></span><br><span class="line"> <span class="comment">//when</span></span><br><span class="line"> Contributor[] contributors;</span><br><span class="line"> <span class="keyword">try</span> (Reader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> StringReader(json))) &#123;</span><br><span class="line"> contributors = gson.fromJson(reader, Contributor[].class);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><em>Listing 4. ä½¿ç”¨ç¡¬ç¼–ç JSONçš„å•å…ƒæµ‹è¯•.</em></p>
<p>è¿™ç§æ–¹æ³•æœ‰å‡ ä¸ªå¼Šç«¯ã€‚æœ€å€¼å¾—æ³¨æ„çš„å°±æ˜¯æ¯”è¾ƒå·®çš„JSONå¯è¯»æ€§ï¼Œæœ‰å¤§é‡çš„è½¬ä¹‰å­—ç¬¦å’Œæ²¡æœ‰è¯­æ³•é«˜äº®ã€‚æ­¤å¤–æœ‰ä¸€ç‚¹æ¨¡ç‰ˆä»£ç ï¼Œå¦‚æœæœ‰æ›´å¤šçš„JSONéœ€è¦æµ‹è¯•çš„è¯å°†ä¼šäº§ç”Ÿé‡å¤ä»£ç ã€‚è®©æˆ‘ä»¬æ€è€ƒæ€æ ·å¯ä»¥ç”¨æ›´åŠ ç®€ä¾¿çš„æ–¹æ³•æ¥ç¼–å†™ï¼Œæé«˜å¯è¯»æ€§å’Œæ¶ˆé™¤ä»£ç é‡å¤ç‡ã€‚</p>
<h2 id="æ”¹è¿›"><a href="#æ”¹è¿›" class="headerlink" title="æ”¹è¿›"></a>æ”¹è¿›</h2><p>é¦–å…ˆ<code>Gson</code>å¯¹è±¡å¯ä»¥åœ¨æµ‹è¯•æ–¹æ³•å¤–éƒ¨å®ä¾‹åŒ–ï¼Œæ¯”å¦‚ä½¿ç”¨ä¸€äº›åƒ [Dagger] (<a href="http://google.github.io/dagger" target="_blank" rel="noopener">http://google.github.io/dagger</a>) çš„DIï¼ˆä¾èµ–æ³¨å…¥ï¼‰æœºåˆ¶æˆ–è€…ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å¸¸é‡ã€‚DIå·²ç»è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´æ‰€ä»¥æˆ‘ä»¬åœ¨ä¾‹å­ä»£ç ä¸­ä½¿ç”¨åè€…ã€‚åœ¨ä»£ç æå–åçœ‹èµ·æ¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Constants</span> </span>&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Gson GSON;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">static</span> &#123;</span><br><span class="line"> <span class="keyword">final</span> GsonBuilder gsonBuilder = <span class="keyword">new</span> GsonBuilder();</span><br><span class="line"> gsonBuilder.setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_UNDERSCORES);</span><br><span class="line"> GSON = gsonBuilder.create();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Listing 5. æŠŠGSONå®ä¾‹ä½œä¸ºä¸€ä¸ªå…¨å±€å˜é‡.</em></p>
<p>æ¥ç€ï¼Œæ–‡æœ¬å½¢å¼çš„JSONå¯ä»¥è¢«ç½®äºä¸€ä¸ªresource fileä¸­ã€‚è¿™ä¼šç»™æˆ‘ä»¬å¸¦æ¥è¯­æ³•çš„é«˜äº®å’Œç¼©è¿›ï¼ˆæ¼‚äº®çš„æ‰“å°ï¼‰ï¼Œé»˜è®¤æƒ…å†µä¸‹Android Studioå’ŒIntellij IDEAå†…ç½®äº†è¿™äº›åŠŸèƒ½ç‰¹æ€§ã€‚ä¸éœ€è¦å¼•å·çš„è½¬ä¹‰ï¼Œæ‰€ä»¥å¯è¯»æ€§ä¹Ÿä¸å†æ˜¯é—®é¢˜ã€‚å†è€…ï¼Œæ–‡ä»¶ä¸­çš„è¡Œæ•°å’Œåˆ—æ•°å’ŒGSONä¸­çš„ä¸€è‡´ï¼Œæ‰€ä»¥å°†ä¼šæ›´åŠ å®¹æ˜“åœ°åƒè¿™æ ·debugå¼‚å¸¸ï¼š<code>MalformedJsonException: Unterminated array at line 4 column 5 path $[2]</code>ã€‚å¦‚æœJSONè¢«æ”¾ç½®åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ï¼Œè¡Œæ•°æ˜¯ä¼šè¢«ç¡®åˆ‡åœ°åŒ¹é…åˆ°çš„ï¼Œè·Ÿä¸Šè¿°ç¡¬ç¼–ç JSONçš„ä¾‹å­çŸ›ç›¾çš„åœ°æ–¹æ˜¯ï¼Œéœ€è¦é€šè¿‡javaæºæ–‡ä»¶ä¸­çš„åç§»è¿›è¡Œè°ƒæ•´ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªç¤ºä¾‹ä¸­è¢«ä½¿ç”¨çš„æ–‡ä»¶ï¼š</p>
<p><span id="listing6"><span></span></span></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"login"</span>: <span class="string">"koral--"</span>,</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">3340954</span>,</span><br><span class="line">    <span class="attr">"site_admin"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"login"</span>: <span class="string">"Wavesonics"</span>,</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">406473</span>,</span><br><span class="line">    <span class="attr">"site_admin"</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><em>Listing 6. åŒ…å«JSONçš„Java resourceæ–‡ä»¶.</em></p>
<p>æœ€åï¼Œä»£ç æ‰§è¡Œè½¬æ¢å¯ä»¥ä»æµ‹è¯•æ–¹æ³•ä¸­æå–ï¼Œæ‰€ä»¥å¹¿ä¹‰è¯´å®ƒä¼šæ›´å®¹æ˜“åœ¨ä¸åŒçš„æµ‹è¯•ç”¨ä¾‹ä¸Šä½¿ç”¨ã€‚å®ƒå¯ä»¥ä½¿ç”¨ä¸‹ç« å°†ä¼šè®¨è®ºçš„Javaå’ŒJUnitç‰¹æ€§æ¥å®ç°ã€‚</p>
<h2 id="Goodies"><a href="#Goodies" class="headerlink" title="Goodies"></a>Goodies</h2><h3 id="Java-resources"><a href="#Java-resources" class="headerlink" title="Java resources"></a>Java resources</h3><p>Java resourcesæ˜¯ç¨‹åºéœ€è¦çš„æ•°æ®æ–‡ä»¶ï¼Œå®ƒè¢«æ”¾ç½®åœ¨æºä»£ç å¤–é¢ã€‚æ³¨æ„æˆ‘ä»¬è®¨è®ºçš„æ˜¯ <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/lang/resources.html" target="_blank" rel="noopener">Java resources</a>ï¼Œé»˜è®¤è¢«æ”¾ç½®åœ¨<code>src/&lt;source set&gt;/resources</code>ï¼Œå¹¶ä¸æ˜¯ <a href="https://developer.android.com/guide/topics/resources/providing-resources.html" target="_blank" rel="noopener">Android App Resources</a>(drawables, layoutsç­‰)ã€‚è¿™æœ¬ä¾‹å­ä¸­å¹¶æ²¡æœ‰Androidç‰¹åˆ«çš„ç‰¹æ€§ã€‚æ‰€ä»¥ä¸€åˆ‡éƒ½æ˜¯å¯ä»¥åƒ <a href="http://robolectric.org/" target="_blank" rel="noopener">Robolectric</a> é‚£æ ·è„±ç¦»frameworkså¯å•å…ƒæµ‹è¯•çš„ã€‚</p>
<p>å¦‚æœ<a href="#listing6">listing 6</a>çš„JSONæ–‡ä»¶è¢«ä¿å­˜äº<code>src/test/resources/pl/droidsonroids/modeltesting/api/contributors.json</code>ï¼Œå®ƒå¯ä»¥é€šè¿‡è°ƒç”¨<code>TestClass.getResourceAsStream(&quot;contributors.json&quot;)</code>æ¥è¢«å•å…ƒæµ‹è¯•ä»£ç è®¿é—®ã€‚ç›¸å…³çš„ç±»éœ€è¦è¢«æ”¾ç½®åœ¨å¯¹åº”çš„packageä¸­ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯<code>pl.droidsonroids.modeltesting.api</code>ã€‚è¯¦æƒ…è§<a href="https://developer.android.com/reference/java/lang/Class.html#getResourceAsStream(java.lang.String" target="_blank" rel="noopener"><strong><code>#getResourceAsStream()</code> javadoc</strong></a>)</p>
<h3 id="æ³¨è§£Annotation"><a href="#æ³¨è§£Annotation" class="headerlink" title="æ³¨è§£Annotation"></a>æ³¨è§£Annotation</h3><p><a href="http://docs.oracle.com/javase/8/docs/technotes/guides/language/annotations.html" target="_blank" rel="noopener">Annotation</a>æ˜¯å…³è”åˆ°æºä»£ç å…ƒç´ çš„å…ƒæ•°æ®ï¼ˆeg. æ–¹æ³•æˆ–è€…ç±»ï¼‰ã€‚æœ‰ä¼—æ‰€å‘¨çŸ¥çš„ä¸€äº›å¦‚<a href="https://developer.android.com/reference/java/lang/Override.html" target="_blank" rel="noopener">@Override</a>æˆ–<a href="https://developer.android.com/reference/java/lang/Deprecated.html" target="_blank" rel="noopener">@Deprecated</a>çš„å†…ç½®æ³¨è§£ã€‚ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å¹¶ä½¿ç”¨å®ƒä»¬æŠŠç‰¹å®šçš„resourcesç»‘å®šåˆ°æµ‹è¯•æ–¹æ³•ä¸­ã€‚</p>
<p>æ³¨è§£æ¥èµ·æ¥ä¸interfaceå¾ˆç±»ä¼¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention</span>(RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(METHOD)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> JsonFileResource &#123;</span><br><span class="line">	<span class="function">String <span class="title">fileName</span><span class="params">()</span></span>;</span><br><span class="line">	Class&lt;?&gt; clazz();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Listing 7. ç®€å•æ³¨è§£.</em></p>
<p>æ³¨æ„<code>interface</code>å…³é”®å­—å‰é¢çš„<code>@</code>ç¬¦å·ã€‚æˆ‘ä»¬è‡ªå®šä¹‰çš„æ³¨è§£è¢«2ä¸ªå…ƒæ³¨è§£æ¥æ³¨è§£ã€‚æˆ‘ä»¬è®¾ç½®<a href="https://developer.android.com/reference/java/lang/annotation/Retention.html" target="_blank" rel="noopener">Retention</a>ä¸º<a href="https://developer.android.com/reference/java/lang/annotation/RetentionPolicy.html#RUNTIME" target="_blank" rel="noopener">RUNTIME</a>ï¼Œå› ä¸ºæ³¨è§£éœ€è¦åœ¨å•å…ƒæµ‹è¯•æ‰§è¡Œæ—¶ï¼ˆè¿è¡Œæ—¶ï¼‰ä¸ºå¯è¯»ï¼Œæ‰€ä»¥é»˜è®¤çš„retentionï¼ˆ<a href="https://developer.android.com/reference/java/lang/annotation/RetentionPolicy.html#CLASS" target="_blank" rel="noopener">CLASS</a>ï¼‰çš„å¹¶ä¸æ»¡è¶³ã€‚æˆ‘ä»¬ä¹Ÿéœ€è¦è®¾ç½®<a href="https://developer.android.com/reference/java/lang/annotation/Target.html" target="_blank" rel="noopener">Target</a>ä¸º<a href="https://developer.android.com/reference/java/lang/annotation/ElementType.html#METHOD" target="_blank" rel="noopener">METHOD</a>å› ä¸ºæˆ‘ä»¬åªéœ€è¦ä¸ºæ–¹æ³•è¿›è¡Œæ³¨è§£ï¼ˆç»‘å®šç‰¹å®šçš„resourceï¼‰ã€‚é”™ä½çš„æ³¨è§£ä¼šå¼•å‘ç¼–è¯‘é”™è¯¯ã€‚æ²¡æœ‰æŒ‡å®šä¸€ä¸ªtargetï¼Œæ³¨è§£ä¼šå¯ä»¥è¢«ç”¨äºä»»ä½•åœ°æ–¹ã€‚</p>
<h3 id="JUnit-Rules"><a href="#JUnit-Rules" class="headerlink" title="JUnit Rules"></a>JUnit Rules</h3><p>ç®€å•æ¥è¯´ï¼Œ<a href="https://github.com/junit-team/junit4/wiki/Rules" target="_blank" rel="noopener">rule</a>æ˜¯åœ¨æµ‹è¯•ï¼ˆæ–¹æ³•ï¼‰è¿è¡Œæ—¶è§¦å‘çš„ä¸€ä¸ªhookã€‚æˆ‘ä»¬å°†ä½¿ç”¨ruleåœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰å¢åŠ ä¸€äº›é¢å¤–çš„è¡Œä¸ºã€‚å³æˆ‘ä»¬å°†ä»resourcesä¸­è§£æJSONå¹¶æä¾›ç»™æµ‹è¯•æ–¹æ³•å†…éƒ¨ç›¸åº”çš„POJOã€‚æˆ‘ä»¬çš„ç›®æ ‡æ—¶åƒä¸‹é¢è¿™æ ·æ”¯æŒå•å…ƒæµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Rule</span> <span class="keyword">public</span> JsonParsingRule jsonParsingRule = <span class="keyword">new</span> JsonParsingRule(Constants.GSON);</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@JsonFileResource</span>(fileName = <span class="string">"contributors.json"</span>, clazz = Contributor[].class)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetContributors</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"> Contributor[] contributors = jsonParsingRule.getValue();</span><br><span class="line"> assertThat(contributors).hasSize(<span class="number">2</span>);</span><br><span class="line"> assertThat(contributors[<span class="number">0</span>].login).isEqualTo(<span class="string">"koral--"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Listing 8. ä½¿ç”¨è‡ªå®šä¹‰ruleçš„ç®€å•æµ‹è¯•æ–¹æ³•.</em></p>
<p>å¦‚ä½ æ‰€è§ï¼Œæ¨¡ç‰ˆä»£ç ä¸<a href="#listing4">listing 4</a>ç›¸æ¯”æ˜æ˜¾åœ°å‡å°‘ã€‚åªæœ‰å¿…è¦çš„éƒ¨åˆ†æ˜¯ç±»å‹æ˜ç¡®çš„ï¼š</p>
<ul>
<li><p>GSONå®ä¾‹ç”¨æ¥è§£æJSONs - <code>jsonParsingRule = new JsonParsingRule(Constants.GSON)</code></p>
</li>
<li><p>è¢«æ”¾ç½®JSONå­—ç¬¦ä¸²çš„resource - <code>@JsonFileResource(fileName = &quot;contributors.json&quot;</code></p>
</li>
<li><p>POJOç±» - <code>, clazz = Contributor[].class</code></p>
</li>
<li><p>POJOå®ä¾‹çš„æ¥æ”¶ - <code>contributors = jsonParsingRule.getValue()</code></p>
</li>
</ul>
<p>æ³¨æ„å¯¹äºæµ‹è¯•ç±»åªéœ€è¦ä¸€ä¸ª<code>JsonParsingRule</code>å®ä¾‹ã€‚å¯¹äºæ¯ä¸ªæµ‹è¯•æ–¹æ³•Ruleä¼šè¢«ç‹¬ç«‹è®¡ç®—å¹¶ä¸”åœ¨ç‰¹å®šæ–¹æ³•ä¸­<code>jsonParsingRule.getValue()</code>çš„ç»“æœä¸ä¼šå½±å“åˆ°ä¸Šä¸€æ¬¡æµ‹è¯•ã€‚<strong>clazz</strong>å¹¶ä¸æ˜¯ä¸€ä¸ªé”™å­—è€Œæ˜¯æ•…æ„çš„ï¼Œå› ä¸º<code>class</code>æ˜¯Javaè¯­è¨€å…³é”®å­—å¹¶ä¸èƒ½ç”¨åšä¸€ä¸ªæ ‡è¯†ç¬¦ã€‚è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ˜¯è¢«<a href="http://junit.org/junit4/javadoc/latest/org/junit/Rule.html" target="_blank" rel="noopener">@Rule</a>æ³¨è§£çš„å±æ€§å¿…é¡»æ˜¯publicå’Œéstaticçš„ã€‚</p>
<h4 id="Ruleå®ç°"><a href="#Ruleå®ç°" class="headerlink" title="Ruleå®ç°"></a>Ruleå®ç°</h4><p>çœ‹ä¸‹ruleå®ç°çš„è‰æ¡ˆï¼š</p>
<p><span id="listing9"></span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JsonParsingRule</span> <span class="keyword">implements</span> <span class="title">TestRule</span> </span>&#123;</span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">final</span> Gson mGson;</span><br><span class="line"> <span class="keyword">private</span> Object mValue;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">JsonParsingRule</span><span class="params">(Gson gson)</span> </span>&#123;</span><br><span class="line"> mGson = gson;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line"> <span class="function"><span class="keyword">public</span>  T <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> <span class="keyword">return</span> (T) mValue;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> Statement <span class="title">apply</span><span class="params">(<span class="keyword">final</span> Statement base, <span class="keyword">final</span> Description description)</span> </span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">new</span> Statement() &#123;</span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">evaluate</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"> <span class="comment">//TODO set mValue according to annotation</span></span><br><span class="line"> base.evaluate();</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Listing 9. Ruleéª¨æ¶.</em></p>
<p>æˆ‘ä»¬çš„ruleå®ç°äº†<a href="http://junit.org/junit4/javadoc/latest/org/junit/rules/TestRule.html" target="_blank" rel="noopener">TestRule</a>ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¢«ä½¿ç”¨<code>@Rule</code>æ³¨è§£ã€‚æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªèŒƒå‹çš„getterï¼Œæ‰€ä»¥å®ƒçš„è¿”å›å€¼å¯ä»¥è¢«ç›´æ¥åˆ†é…ç»™ç‰¹å®šç±»å‹çš„å˜é‡è€Œä¸éœ€è¦åœ¨æµ‹è¯•æ–¹æ³•ä¸­è½¬å‹ã€‚åœ¨<code>apply()</code>æ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸå§‹<a href="http://junit.org/junit4/javadoc/latest/org/junit/runners/model/Statement.html" target="_blank" rel="noopener">Statement</a>ï¼ˆæµ‹è¯•æ–¹æ³•ï¼‰çš„åŒ…è£…ã€‚è°ƒç”¨<code>base.evaluate()</code>è¢«æ”¾ç½®åœ¨æœ€åï¼ˆåœ¨æ³¨è§£å¤„ç†ä¹‹åï¼‰ï¼Œå› æ­¤åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­ruleçš„æ•ˆæœæ˜¯å¯è§çš„ã€‚</p>
<p>ç°åœ¨æ›´æ¥è¿‘åœ°è§‚çœ‹statementåŒ…è£…çš„å…³é”®éƒ¨åˆ†ï¼ˆ<a href="#listing9">listing 9</a>ä¸­<code>TODO</code>çš„å®ç°ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">JsonFileResource jsonFileResource = description.getAnnotation(JsonFileResource.class);</span><br><span class="line"><span class="keyword">if</span> (jsonFileResource != <span class="keyword">null</span>) &#123;</span><br><span class="line"> Class&lt;?&gt; clazz = jsonFileResource.clazz();</span><br><span class="line"> String resourceName = jsonFileResource.fileName();</span><br><span class="line"> Class&lt;?&gt; testClass = description.getTestClass();</span><br><span class="line"> InputStream in = testClass.getResourceAsStream(resourceName);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">assert</span> in != <span class="keyword">null</span> : <span class="string">"Failed to load resource: "</span> + resourceName + <span class="string">" from "</span> + testClass;</span><br><span class="line"> <span class="keyword">try</span> (Reader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in))) &#123;</span><br><span class="line"> mValue = mGson.fromJson(reader, clazz);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Listing 10. Statementçš„å®ç°.</em></p>
<p><code>description</code>å‚æ•°åœ¨è¿™é‡Œæ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬è®¿é—®æµ‹è¯•æ–¹æ³•åŒ…æ‹¬æ³¨è§£åœ¨å†…çš„å…ƒæ•°æ®ã€‚Ruleé€‚ç”¨äºæ‰€æœ‰æµ‹è¯•æ–¹æ³•ï¼ŒåŒ…æ‹¬æ²¡æœ‰æ³¨è§£çš„ï¼Œè¿™ç§æƒ…å†µä¸‹<a href="http://junit.org/junit4/javadoc/latest/org/junit/runner/Description.html#getAnnotation(java.lang.Class" target="_blank" rel="noopener">getAnnotation()</a>)ä¼šè¿”å›<code>null</code>ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥æœ‰æ¡ä»¶åœ°è·³è¿‡å®šåˆ¶çš„å…¶ä½™éƒ¨åˆ†ã€‚æ‰€ä»¥æµ‹è¯•æ–¹æ³•æ²¡æœ‰<code>@JsonFileResource</code>æ³¨è§£çš„æµ‹è¯•æ–¹æ³•ï¼ˆæ¯”å¦‚ï¼Œä¸€äº›ä¸æ¶‰åŠJSONçš„æµ‹è¯•ï¼‰å¯ä»¥æ”¾åœ¨ä½¿ç”¨äº†<code>JsonParsingRule</code>çš„æµ‹è¯•ç±»ä¸­ã€‚ç¬¬8è¡Œæ˜¯ä¸‹é¢ä»£ç çš„ä¸€ä¸ª<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/language/assert.html#intro" target="_blank" rel="noopener">ç®€å†™ç­‰æ•ˆ</a>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (in != <span class="keyword">null</span>) &#123;</span><br><span class="line"> <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError(<span class="string">"Failed to load resource: "</span> + resourceName + <span class="string">" from "</span> + testClass);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Listing 11. æ–­è¨€è¯­å¥åˆ¤å®š.</em></p>
<p>æœ€åæˆ‘ä»¬ä¼ å…¥ä½¿ç”¨è¢«<a href="https://developer.android.com/reference/java/io/Reader.html" target="_blank" rel="noopener">Reader</a>åŒ…è£…çš„resourceåˆ°GSONå¼•æ“ã€‚<a href="https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html" target="_blank" rel="noopener">Try-with-resources</a>è¯­å¥åœ¨è¿™é‡Œè¢«ä½¿ç”¨ï¼Œæ‰€ä»¥Readerå°†ä¼šåœ¨è¯»å–ç”šè‡³å‘ç”Ÿå¼‚å¸¸ä¹‹åè‡ªåŠ¨å…³é—­ã€‚è¿™é‡Œéœ€è¦åœ¨<code>finally</code>å—ä¸­æ˜ç¡®ç±»å‹ã€‚</p>
<p>æ³¨æ„try-with-resourcesä»Android API 19ï¼ˆKitkatï¼‰æ‰å¯ç”¨ã€‚å¦‚æœæµ‹è¯•ä»£ç ä½äºAndroid gradle moduleä¸­ï¼Œå¹¶ä¸”ä½ çš„<code>minSdkVersion</code>ä½äº19ï¼Œé‚£ä¹ˆä½ å¯èƒ½éœ€è¦åœ¨<code>evaluate()</code>æ–¹æ³•ä¸Šå¢åŠ <code>@TargetApi(Build.VERSION_CODES.KITKAT)</code>æ³¨è§£æ¥é¿å…<a href="http://tools.android.com/tips/lint-checks" target="_blank" rel="noopener">lint</a>é”™è¯¯ã€‚å•å…ƒæµ‹è¯•ä¼šåœ¨å¼€å‘æœºå™¨ï¼ˆMacï¼ŒPCç­‰ï¼‰ä¸Šè¢«æ‰§è¡Œè€Œä¸æ˜¯Androidè®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨ï¼Œæ‰€ä»¥è¿™é‡Œåªæœ‰<code>compileSdkVersion</code>æ‰æ˜¯å…³é”®ã€‚</p>
<p>è¿™æ ·çš„å•å…ƒæµ‹è¯•ï¼ˆä¸éœ€è¦ä½¿ç”¨Androidç‰¹å®šçš„APIï¼‰ä¹Ÿå¯ä»¥è¢«æ”¾åœ¨java moduleä¸­ï¼ˆ<code>build.gradle</code>ä¸­<code>apply plugin: &#39;java&#39;</code>ï¼‰ã€‚ç†è®ºä¸Šè¿™äº‹æœ€å¥½çš„ideaï¼Œä½†æ˜¯åœ¨Android Studio/Intellij IDEAä¸­æœ‰ä¸€ä¸ª<a href="http://tools.android.com/knownissues#TOC-JUnit-tests-missing-resources-in-classpath-when-run-from-Studio" target="_blank" rel="noopener">é—®é¢˜</a>éœ€è¦é¢„é˜²ï¼Œé‚£å°±æ˜¯ä»IDEå¼€ç®±å³ç”¨åœ°æ‰§è¡Œå•å…ƒæµ‹è¯•çš„é…ç½®å·¥ä½œã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> unit test </tag>
            
            <tag> JUnit </tag>
            
            <tag> Junit Rules </tag>
            
            <tag> annotations </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM(v2.0)]]></title>
      <url>/2016/06/29/Android-Android%E7%AB%AFORM%E6%A1%86%E6%9E%B6%E2%80%94%E2%80%94RapidORM-v2-0/</url>
      <content type="html"><![CDATA[<h1 id="Android-Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM-v2-0"><a href="#Android-Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM-v2-0" class="headerlink" title="[Android]Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM(v2.0)"></a>[Android]Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM(<code>v2.0</code>)</h1><p><strong><a href="https://github.com/wangjiegulu/RapidORM" target="_blank" rel="noopener">RapidORM</a>ï¼šAndroidç«¯è½»é‡é«˜æ€§èƒ½çš„ORMæ¡†æ¶</strong></p>
<p><strong>GitHub:</strong> <a href="https://github.com/wangjiegulu/RapidORM" target="_blank" rel="noopener">https://github.com/wangjiegulu/RapidORM</a></p>
<h2 id="1-RapidORM-v1-0"><a href="#1-RapidORM-v1-0" class="headerlink" title="1. RapidORM v1.0"></a>1. RapidORM <code>v1.0</code></h2><blockquote>
<p><code>v1.0</code>åšå®¢æ–‡æ¡£ï¼š<a href="http://www.cnblogs.com/tiantianbyconan/p/4748077.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4748077.html</a></p>
</blockquote>
<p><code>v1.0</code>ç‰ˆæœ¬æ”¯æŒä½¿ç”¨åå°„å’Œéåå°„ï¼ˆæ¨¡ç‰ˆç”Ÿæˆï¼‰ä¸¤ç§æ–¹å¼å®ç°æ‰§è¡ŒSQLã€‚</p>
<h3 id="1-1-v1-0ç¼ºç‚¹ï¼š"><a href="#1-1-v1-0ç¼ºç‚¹ï¼š" class="headerlink" title="1.1. v1.0ç¼ºç‚¹ï¼š"></a>1.1. <code>v1.0</code>ç¼ºç‚¹ï¼š</h3><p>1. å…¶ä¸­é»˜è®¤ä¸ºåå°„å®ç°ï¼Œå¯¹æ€§èƒ½æœ‰ä¸€å®šçš„å½±å“ã€‚</p>
<p>2. è€Œå¦‚æœè¦é‡‡ç”¨éåå°„å®ç°ï¼Œåˆ™éœ€è¦ä½¿ç”¨RapidORMæä¾›çš„æ¨¡ç‰ˆå·¥å…·ç±»æ‰‹åŠ¨ç”Ÿæˆç›¸å…³çš„å¸®åŠ©ç±»ï¼Œå½“æ•°æ®è¡¨éœ€è¦ä¿®æ”¹æ—¶ï¼Œå¿…é¡»è¦æ‰‹åŠ¨æ‰‹åŠ¨ç”Ÿæˆå¸®åŠ©ç±»ï¼Œæœ‰æ½œåœ¨çš„é£é™©ã€‚</p>
<p>3. éåå°„æ—¶ç”Ÿæˆçš„æ–‡ä»¶æ˜¯é€šè¿‡<code>getter/setter</code>æ–¹æ³•è°ƒç”¨çš„ï¼Œä½†æ˜¯<code>getter/setter</code>æ–¹æ³•åå¯èƒ½ä¼šä¸ä¸€è‡´ï¼Œå¯¼è‡´éœ€è¦æ‰‹åŠ¨è°ƒæ•´<code>setter/getter</code>æ–¹æ³•åç§°ã€‚</p>
<h2 id="2-RapidORM-v2-0"><a href="#2-RapidORM-v2-0" class="headerlink" title="2. RapidORM v2.0"></a>2. RapidORM <code>v2.0</code></h2><p>ç›¸æ¯”è¾ƒäº<code>v1.0</code>ç‰ˆæœ¬ï¼Œ<code>v2.0</code>ç‰ˆæœ¬åˆ™æ›´åŠ ä¾§é‡äºéåå°„æ“ä½œï¼Œæ‰€æœ‰é»˜è®¤éƒ½æ˜¯éåå°„çš„ã€‚</p>
<p>é€šè¿‡åœ¨ç¼–è¯‘æ—¶æœŸæ ¹æ®<code>@Table</code>ã€<code>@Column</code>ç­‰æ³¨è§£è‡ªåŠ¨ç”Ÿæˆè¾…åŠ©ç±»<code>Xxx_RORM.java</code>æ–‡ä»¶ï¼Œ<strong>RapidORM</strong>åº“ä¼šä½¿ç”¨è¿™äº›ç”Ÿæˆçš„è¾…åŠ©ç±»æ¥è¿›è¡Œæ•°æ®è¡¨çš„åˆå§‹åŒ–ã€æ‰§è¡ŒSQLç­‰æ“ä½œï¼Œå¦‚æœæ•°æ®è¡¨æœ‰ç»“æ„æœ‰æ”¹åŠ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨é‡æ–°ç”Ÿæˆæˆ–è€…<code>rebuild</code>æ¥æ‰‹åŠ¨ç”Ÿæˆã€‚</p>
<h3 id="2-1-v2-0-ä½¿ç”¨æŒ‡å—"><a href="#2-1-v2-0-ä½¿ç”¨æŒ‡å—" class="headerlink" title="2.1 v2.0 ä½¿ç”¨æŒ‡å—"></a>2.1 <code>v2.0</code> ä½¿ç”¨æŒ‡å—</h3><blockquote>
<p>ä¸<code>v1.0</code>ç›¸åŒéƒ¨åˆ†çœç•¥ã€‚</p>
</blockquote>
<h4 id="2-1-1-åŒæ ·ï¼Œåˆ›å»ºæŒä¹…ç±»Person"><a href="#2-1-1-åŒæ ·ï¼Œåˆ›å»ºæŒä¹…ç±»Person" class="headerlink" title="2.1.1 åŒæ ·ï¼Œåˆ›å»ºæŒä¹…ç±»Person"></a>2.1.1 åŒæ ·ï¼Œåˆ›å»ºæŒä¹…ç±»<code>Person</code></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Author: wangjie</span></span><br><span class="line"><span class="comment"> * Email: tiantian.china.2@gmail.com</span></span><br><span class="line"><span class="comment"> * Date: 6/25/15.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Table</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(primaryKey = <span class="keyword">true</span>)</span><br><span class="line">    Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(primaryKey = <span class="keyword">true</span>, name = <span class="string">"type_id"</span>)</span><br><span class="line">    Integer typeId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span></span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span></span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span></span><br><span class="line">    String address;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span></span><br><span class="line">    Long birth;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span></span><br><span class="line">    Boolean student;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"is_succeed"</span>)</span><br><span class="line">    <span class="keyword">boolean</span> isSucceed;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// getter/setter</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œv2.0ç‰ˆæœ¬ä¸æ”¯æŒå˜é‡ä¸º<code>private</code>ç±»å‹ï¼Œè¿™æ˜¯ä¸ºäº†é¿å…ä½¿ç”¨<code>getter/setter</code>æ–¹æ³•æ¥è¿›è¡Œæ•°æ®ç»‘å®šã€‚å¦‚æœå˜é‡ä¸º<code>private</code>ç±»å‹ï¼Œåˆ™ç¼–è¯‘ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Error:Execution failed <span class="keyword">for</span> task <span class="string">':example:compileDebugJavaWithJavac'</span>.</span><br><span class="line">&gt; java.lang.RuntimeException: id in com.wangjie.rapidorm.example.database.model.Person can not be <span class="keyword">private</span>!</span><br></pre></td></tr></table></figure>
<h4 id="2-1-2-Rebuild-Project"><a href="#2-1-2-Rebuild-Project" class="headerlink" title="2.1.2 Rebuild Project"></a>2.1.2 Rebuild Project</h4><blockquote>
<p>Android Studio -&gt; Build -&gt; Rebuild Project</p>
</blockquote>
<p>BuildæˆåŠŸåï¼Œåœ¨ä¸»é¡¹ç›®<code>build/generated/source/apt/</code>ç›®å½•ä¸‹ä¼šç”Ÿæˆ<code>Person_RORM</code>ç±», å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GENERATED CODE BY RapidORM. DO NOT MODIFY! "2016-06-29 14:08:504", Source table: "com.wangjie.rapidorm.example.database.model.Person"</span></span><br><span class="line"><span class="keyword">package</span> com.wangjie.rapidorm.example.database.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.database.Cursor;</span><br><span class="line"><span class="keyword">import</span> com.wangjie.rapidorm.core.config.ColumnConfig;</span><br><span class="line"><span class="keyword">import</span> com.wangjie.rapidorm.core.config.TableConfig;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person_RORM</span> <span class="keyword">extends</span> <span class="title">TableConfig</span>&lt;<span class="title">Person</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Column name: "id", field name: &#123;<span class="doctag">@link</span> Person#id&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ID = <span class="string">"id"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Column name: "type_id", field name: &#123;<span class="doctag">@link</span> Person#typeId&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String TYPE_ID = <span class="string">"type_id"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Column name: "name", field name: &#123;<span class="doctag">@link</span> Person#name&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String NAME = <span class="string">"name"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Column name: "age", field name: &#123;<span class="doctag">@link</span> Person#age&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String AGE = <span class="string">"age"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Column name: "address", field name: &#123;<span class="doctag">@link</span> Person#address&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String ADDRESS = <span class="string">"address"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Column name: "birth", field name: &#123;<span class="doctag">@link</span> Person#birth&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String BIRTH = <span class="string">"birth"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Column name: "student", field name: &#123;<span class="doctag">@link</span> Person#student&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String STUDENT = <span class="string">"student"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Column name: "is_succeed", field name: &#123;<span class="doctag">@link</span> Person#isSucceed&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String IS_SUCCEED = <span class="string">"is_succeed"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Person_RORM</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(Person.class);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">parseAllConfigs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    tableName = <span class="string">"Person"</span>;</span><br><span class="line">    ColumnConfig idColumnConfig = buildColumnConfig(<span class="string">"id"</span><span class="comment">/*column name*/</span>, <span class="keyword">false</span><span class="comment">/*autoincrement*/</span>, <span class="keyword">false</span><span class="comment">/*notNull*/</span>, <span class="string">""</span><span class="comment">/*defaultValue*/</span>, <span class="keyword">false</span><span class="comment">/*index*/</span>, <span class="keyword">false</span><span class="comment">/*unique*/</span>, <span class="keyword">false</span><span class="comment">/*uniqueCombo*/</span>, <span class="keyword">true</span><span class="comment">/*primaryKey*/</span>, <span class="string">"INTEGER"</span><span class="comment">/*dbType*/</span>);</span><br><span class="line">    allColumnConfigs.add(idColumnConfig);</span><br><span class="line">    allFieldColumnConfigMapper.put(<span class="string">"id"</span><span class="comment">/*field name*/</span>, idColumnConfig);</span><br><span class="line">    pkColumnConfigs.add(idColumnConfig);</span><br><span class="line">    ColumnConfig typeIdColumnConfig = buildColumnConfig(<span class="string">"type_id"</span><span class="comment">/*column name*/</span>, <span class="keyword">false</span><span class="comment">/*autoincrement*/</span>, <span class="keyword">false</span><span class="comment">/*notNull*/</span>, <span class="string">""</span><span class="comment">/*defaultValue*/</span>, <span class="keyword">false</span><span class="comment">/*index*/</span>, <span class="keyword">false</span><span class="comment">/*unique*/</span>, <span class="keyword">false</span><span class="comment">/*uniqueCombo*/</span>, <span class="keyword">true</span><span class="comment">/*primaryKey*/</span>, <span class="string">"INTEGER"</span><span class="comment">/*dbType*/</span>);</span><br><span class="line">    allColumnConfigs.add(typeIdColumnConfig);</span><br><span class="line">    allFieldColumnConfigMapper.put(<span class="string">"typeId"</span><span class="comment">/*field name*/</span>, typeIdColumnConfig);</span><br><span class="line">    pkColumnConfigs.add(typeIdColumnConfig);</span><br><span class="line">    ColumnConfig nameColumnConfig = buildColumnConfig(<span class="string">"name"</span><span class="comment">/*column name*/</span>, <span class="keyword">false</span><span class="comment">/*autoincrement*/</span>, <span class="keyword">false</span><span class="comment">/*notNull*/</span>, <span class="string">""</span><span class="comment">/*defaultValue*/</span>, <span class="keyword">false</span><span class="comment">/*index*/</span>, <span class="keyword">false</span><span class="comment">/*unique*/</span>, <span class="keyword">false</span><span class="comment">/*uniqueCombo*/</span>, <span class="keyword">false</span><span class="comment">/*primaryKey*/</span>, <span class="string">"TEXT"</span><span class="comment">/*dbType*/</span>);</span><br><span class="line">    allColumnConfigs.add(nameColumnConfig);</span><br><span class="line">    allFieldColumnConfigMapper.put(<span class="string">"name"</span><span class="comment">/*field name*/</span>, nameColumnConfig);</span><br><span class="line">    noPkColumnConfigs.add(nameColumnConfig);</span><br><span class="line">    ColumnConfig ageColumnConfig = buildColumnConfig(<span class="string">"age"</span><span class="comment">/*column name*/</span>, <span class="keyword">false</span><span class="comment">/*autoincrement*/</span>, <span class="keyword">false</span><span class="comment">/*notNull*/</span>, <span class="string">""</span><span class="comment">/*defaultValue*/</span>, <span class="keyword">false</span><span class="comment">/*index*/</span>, <span class="keyword">false</span><span class="comment">/*unique*/</span>, <span class="keyword">false</span><span class="comment">/*uniqueCombo*/</span>, <span class="keyword">false</span><span class="comment">/*primaryKey*/</span>, <span class="string">"INTEGER"</span><span class="comment">/*dbType*/</span>);</span><br><span class="line">    allColumnConfigs.add(ageColumnConfig);</span><br><span class="line">    allFieldColumnConfigMapper.put(<span class="string">"age"</span><span class="comment">/*field name*/</span>, ageColumnConfig);</span><br><span class="line">    noPkColumnConfigs.add(ageColumnConfig);</span><br><span class="line">    ColumnConfig addressColumnConfig = buildColumnConfig(<span class="string">"address"</span><span class="comment">/*column name*/</span>, <span class="keyword">false</span><span class="comment">/*autoincrement*/</span>, <span class="keyword">false</span><span class="comment">/*notNull*/</span>, <span class="string">""</span><span class="comment">/*defaultValue*/</span>, <span class="keyword">false</span><span class="comment">/*index*/</span>, <span class="keyword">false</span><span class="comment">/*unique*/</span>, <span class="keyword">false</span><span class="comment">/*uniqueCombo*/</span>, <span class="keyword">false</span><span class="comment">/*primaryKey*/</span>, <span class="string">"TEXT"</span><span class="comment">/*dbType*/</span>);</span><br><span class="line">    allColumnConfigs.add(addressColumnConfig);</span><br><span class="line">    allFieldColumnConfigMapper.put(<span class="string">"address"</span><span class="comment">/*field name*/</span>, addressColumnConfig);</span><br><span class="line">    noPkColumnConfigs.add(addressColumnConfig);</span><br><span class="line">    ColumnConfig birthColumnConfig = buildColumnConfig(<span class="string">"birth"</span><span class="comment">/*column name*/</span>, <span class="keyword">false</span><span class="comment">/*autoincrement*/</span>, <span class="keyword">false</span><span class="comment">/*notNull*/</span>, <span class="string">""</span><span class="comment">/*defaultValue*/</span>, <span class="keyword">false</span><span class="comment">/*index*/</span>, <span class="keyword">false</span><span class="comment">/*unique*/</span>, <span class="keyword">false</span><span class="comment">/*uniqueCombo*/</span>, <span class="keyword">false</span><span class="comment">/*primaryKey*/</span>, <span class="string">"LONG"</span><span class="comment">/*dbType*/</span>);</span><br><span class="line">    allColumnConfigs.add(birthColumnConfig);</span><br><span class="line">    allFieldColumnConfigMapper.put(<span class="string">"birth"</span><span class="comment">/*field name*/</span>, birthColumnConfig);</span><br><span class="line">    noPkColumnConfigs.add(birthColumnConfig);</span><br><span class="line">    ColumnConfig studentColumnConfig = buildColumnConfig(<span class="string">"student"</span><span class="comment">/*column name*/</span>, <span class="keyword">false</span><span class="comment">/*autoincrement*/</span>, <span class="keyword">false</span><span class="comment">/*notNull*/</span>, <span class="string">""</span><span class="comment">/*defaultValue*/</span>, <span class="keyword">false</span><span class="comment">/*index*/</span>, <span class="keyword">false</span><span class="comment">/*unique*/</span>, <span class="keyword">false</span><span class="comment">/*uniqueCombo*/</span>, <span class="keyword">false</span><span class="comment">/*primaryKey*/</span>, <span class="string">"INTEGER"</span><span class="comment">/*dbType*/</span>);</span><br><span class="line">    allColumnConfigs.add(studentColumnConfig);</span><br><span class="line">    allFieldColumnConfigMapper.put(<span class="string">"student"</span><span class="comment">/*field name*/</span>, studentColumnConfig);</span><br><span class="line">    noPkColumnConfigs.add(studentColumnConfig);</span><br><span class="line">    ColumnConfig isSucceedColumnConfig = buildColumnConfig(<span class="string">"is_succeed"</span><span class="comment">/*column name*/</span>, <span class="keyword">false</span><span class="comment">/*autoincrement*/</span>, <span class="keyword">false</span><span class="comment">/*notNull*/</span>, <span class="string">""</span><span class="comment">/*defaultValue*/</span>, <span class="keyword">false</span><span class="comment">/*index*/</span>, <span class="keyword">false</span><span class="comment">/*unique*/</span>, <span class="keyword">false</span><span class="comment">/*uniqueCombo*/</span>, <span class="keyword">false</span><span class="comment">/*primaryKey*/</span>, <span class="string">"INTEGER"</span><span class="comment">/*dbType*/</span>);</span><br><span class="line">    allColumnConfigs.add(isSucceedColumnConfig);</span><br><span class="line">    allFieldColumnConfigMapper.put(<span class="string">"isSucceed"</span><span class="comment">/*field name*/</span>, isSucceedColumnConfig);</span><br><span class="line">    noPkColumnConfigs.add(isSucceedColumnConfig);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bindInsertArgs</span><span class="params">(Person model, List&lt;Object&gt; insertArgs)</span> </span>&#123;</span><br><span class="line">    Integer id = model.id;</span><br><span class="line">    insertArgs.add(<span class="keyword">null</span> == id ? <span class="keyword">null</span> : id );</span><br><span class="line">    Integer typeId = model.typeId;</span><br><span class="line">    insertArgs.add(<span class="keyword">null</span> == typeId ? <span class="keyword">null</span> : typeId );</span><br><span class="line">    String name = model.name;</span><br><span class="line">    insertArgs.add(<span class="keyword">null</span> == name ? <span class="keyword">null</span> : name );</span><br><span class="line">    <span class="keyword">int</span> age = model.age;</span><br><span class="line">    insertArgs.add(age);</span><br><span class="line">    String address = model.address;</span><br><span class="line">    insertArgs.add(<span class="keyword">null</span> == address ? <span class="keyword">null</span> : address );</span><br><span class="line">    Long birth = model.birth;</span><br><span class="line">    insertArgs.add(<span class="keyword">null</span> == birth ? <span class="keyword">null</span> : birth );</span><br><span class="line">    Boolean student = model.student;</span><br><span class="line">    insertArgs.add(<span class="keyword">null</span> == student ? <span class="keyword">null</span> : student  ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">boolean</span> isSucceed = model.isSucceed;</span><br><span class="line">    insertArgs.add(isSucceed ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bindUpdateArgs</span><span class="params">(Person model, List&lt;Object&gt; updateArgs)</span> </span>&#123;</span><br><span class="line">    String name = model.name;</span><br><span class="line">    updateArgs.add(<span class="keyword">null</span> == name ? <span class="keyword">null</span> : name);</span><br><span class="line">    <span class="keyword">int</span> age = model.age;</span><br><span class="line">    updateArgs.add(age);</span><br><span class="line">    String address = model.address;</span><br><span class="line">    updateArgs.add(<span class="keyword">null</span> == address ? <span class="keyword">null</span> : address);</span><br><span class="line">    Long birth = model.birth;</span><br><span class="line">    updateArgs.add(<span class="keyword">null</span> == birth ? <span class="keyword">null</span> : birth);</span><br><span class="line">    Boolean student = model.student;</span><br><span class="line">    updateArgs.add(<span class="keyword">null</span> == student ? <span class="keyword">null</span> : student ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">boolean</span> isSucceed = model.isSucceed;</span><br><span class="line">    updateArgs.add(isSucceed ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bindPkArgs</span><span class="params">(Person model, List&lt;Object&gt; pkArgs)</span> </span>&#123;</span><br><span class="line">    Integer id = model.id;</span><br><span class="line">    pkArgs.add(<span class="keyword">null</span> == id ? <span class="keyword">null</span> : id);</span><br><span class="line">    Integer typeId = model.typeId;</span><br><span class="line">    pkArgs.add(<span class="keyword">null</span> == typeId ? <span class="keyword">null</span> : typeId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Person <span class="title">parseFromCursor</span><span class="params">(Cursor cursor)</span> </span>&#123;</span><br><span class="line">    Person model = <span class="keyword">new</span> Person();</span><br><span class="line">    <span class="keyword">int</span> index;</span><br><span class="line">    index = cursor.getColumnIndex(<span class="string">"id"</span>);</span><br><span class="line">    <span class="keyword">if</span>(-<span class="number">1</span> != index) &#123;</span><br><span class="line">      model.id = cursor.isNull(index) ? <span class="keyword">null</span> : (cursor.getInt(index));</span><br><span class="line">    &#125;</span><br><span class="line">    index = cursor.getColumnIndex(<span class="string">"type_id"</span>);</span><br><span class="line">    <span class="keyword">if</span>(-<span class="number">1</span> != index) &#123;</span><br><span class="line">      model.typeId = cursor.isNull(index) ? <span class="keyword">null</span> : (cursor.getInt(index));</span><br><span class="line">    &#125;</span><br><span class="line">    index = cursor.getColumnIndex(<span class="string">"name"</span>);</span><br><span class="line">    <span class="keyword">if</span>(-<span class="number">1</span> != index) &#123;</span><br><span class="line">      model.name = cursor.isNull(index) ? <span class="keyword">null</span> : (cursor.getString(index));</span><br><span class="line">    &#125;</span><br><span class="line">    index = cursor.getColumnIndex(<span class="string">"age"</span>);</span><br><span class="line">    <span class="keyword">if</span>(-<span class="number">1</span> != index) &#123;</span><br><span class="line">      model.age = cursor.isNull(index) ? <span class="keyword">null</span> : (cursor.getInt(index));</span><br><span class="line">    &#125;</span><br><span class="line">    index = cursor.getColumnIndex(<span class="string">"address"</span>);</span><br><span class="line">    <span class="keyword">if</span>(-<span class="number">1</span> != index) &#123;</span><br><span class="line">      model.address = cursor.isNull(index) ? <span class="keyword">null</span> : (cursor.getString(index));</span><br><span class="line">    &#125;</span><br><span class="line">    index = cursor.getColumnIndex(<span class="string">"birth"</span>);</span><br><span class="line">    <span class="keyword">if</span>(-<span class="number">1</span> != index) &#123;</span><br><span class="line">      model.birth = cursor.isNull(index) ? <span class="keyword">null</span> : (cursor.getLong(index));</span><br><span class="line">    &#125;</span><br><span class="line">    index = cursor.getColumnIndex(<span class="string">"student"</span>);</span><br><span class="line">    <span class="keyword">if</span>(-<span class="number">1</span> != index) &#123;</span><br><span class="line">      model.student = cursor.isNull(index) ? <span class="keyword">null</span> : (cursor.getInt(index) == <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    index = cursor.getColumnIndex(<span class="string">"is_succeed"</span>);</span><br><span class="line">    <span class="keyword">if</span>(-<span class="number">1</span> != index) &#123;</span><br><span class="line">      model.isSucceed = cursor.isNull(index) ? <span class="keyword">null</span> : (cursor.getInt(index) == <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> model;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-1-3-æ³¨å†ŒæŒä¹…ç±»"><a href="#2-1-3-æ³¨å†ŒæŒä¹…ç±»" class="headerlink" title="2.1.3 æ³¨å†ŒæŒä¹…ç±»"></a>2.1.3 æ³¨å†ŒæŒä¹…ç±»</h4><p>ä¸<code>v1.0</code>ä¸€æ ·ï¼Œæ–°å»ºç±»DatabaseFactoryï¼Œç»§æ‰¿RapidORMConnectionï¼ˆå¯å‚è€ƒ<a href="http://www.cnblogs.com/tiantianbyconan/p/4748077.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4748077.html</a>ï¼‰ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯éœ€è¦å®ç°çš„å¹¶ä¸æ˜¯åŸæ¥çš„<code>registerAllTableClass()</code>æ–¹æ³•ï¼Œè€Œæ˜¯<code>registerTableConfigMapper(HashMap&lt;Class, TableConfig&gt; tableConfigMapper)</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">registerTableConfigMapper</span><span class="params">(HashMap&lt;Class, TableConfig&gt; tableConfigMapper)</span> </span>&#123;</span><br><span class="line">    tableConfigMapper.put(Person.class, <span class="keyword">new</span> Person_RORM());</span><br><span class="line">    <span class="comment">// register all table config here...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šæ³¨å†Œ<code>Person</code>æ—¶ï¼Œéœ€è¦è¿å¸¦ç”Ÿæˆçš„<code>Person_RORM</code>åŒæ—¶æ³¨å†Œã€‚</p>
<h4 id="2-1-4-æ„å»ºBuilder"><a href="#2-1-4-æ„å»ºBuilder" class="headerlink" title="2.1.4 æ„å»ºBuilder"></a>2.1.4 æ„å»ºBuilder</h4><p>æ„å»ºBuilderæ—¶ä¸<code>v1.0</code>çš„æ–¹å¼ä¸€è‡´ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨<code>Person_RORM</code>ä¸­çš„staticå˜é‡æ¥ä½œä¸ºcolumn nameï¼š</p>
<p><strong>PersonDaoImpl</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Person&gt; <span class="title">findPersonsByWhere</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> queryBuilder()</span><br><span class="line">            .addSelectColumn(Person_RORM.ID, Person_RORM.TYPE_ID, Person_RORM.NAME,</span><br><span class="line">                    Person_RORM.AGE, Person_RORM.BIRTH, Person_RORM.ADDRESS)</span><br><span class="line">            .setWhere(</span><br><span class="line">            	Where.and(</span><br><span class="line">	                Where.like(Person_RORM.NAME, <span class="string">"%wangjie%"</span>),</span><br><span class="line">	                Where.lt(Person_RORM.ID, <span class="number">200</span>),</span><br><span class="line">	                Where.or(</span><br><span class="line">	                        Where.between(Person_RORM.AGE, <span class="number">19</span>, <span class="number">39</span>),</span><br><span class="line">	                        Where.isNull(Person_RORM.ADDRESS)</span><br><span class="line">	                ),</span><br><span class="line">	                Where.eq(Person_RORM.TYPE_ID, <span class="number">1</span>)</span><br><span class="line">        		)</span><br><span class="line">            )</span><br><span class="line">            .addOrder(Person_RORM.ID, <span class="keyword">false</span>)</span><br><span class="line">            .addOrder(Person_RORM.NAME, <span class="keyword">true</span>)</span><br><span class="line">            .setLimit(<span class="number">10</span>)</span><br><span class="line">            .query(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-1-5-å…¼å®¹SqlCipher"><a href="#2-1-5-å…¼å®¹SqlCipher" class="headerlink" title="2.1.5 å…¼å®¹SqlCipher"></a>2.1.5 å…¼å®¹SqlCipher</h4><p>ä¸<code>v1.0</code>ä¸€è‡´.</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> orm </tag>
            
            <tag> rapidorm </tag>
            
            <tag> library </tag>
            
            <tag> database </tag>
            
            <tag> sqlite </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]Google å¼€æºçš„ Android æ’ç‰ˆåº“ï¼šFlexboxLayout]]></title>
      <url>/2016/05/31/Android-Google-%E5%BC%80%E6%BA%90%E7%9A%84-Android-%E6%8E%92%E7%89%88%E5%BA%93%EF%BC%9AFlexboxLayout/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘Googleå¼€æºäº†ä¸€ä¸ªé¡¹ç›®å«ã€ŒFlexboxLayoutã€ã€‚</p>
<h2 id="1-ä»€ä¹ˆæ˜¯-Flexbox"><a href="#1-ä»€ä¹ˆæ˜¯-Flexbox" class="headerlink" title="1.ä»€ä¹ˆæ˜¯ Flexbox"></a>1.ä»€ä¹ˆæ˜¯ Flexbox</h2><p>ç®€å•æ¥è¯´ Flexbox æ˜¯å±äºwebå‰ç«¯é¢†åŸŸCSSçš„ä¸€ç§å¸ƒå±€æ–¹æ¡ˆï¼Œæ˜¯2009å¹´W3Cæå‡ºäº†ä¸€ç§æ–°çš„å¸ƒå±€æ–¹æ¡ˆï¼Œå¯ä»¥ç®€ä¾¿ã€å®Œæ•´ã€å“åº”å¼åœ°å®ç°å„ç§é¡µé¢å¸ƒå±€ï¼Œå¹¶ä¸” React Native ä¹Ÿæ˜¯ä½¿ç”¨çš„ Flex å¸ƒå±€ã€‚</p>
<p>ä½ å¯ä»¥ç®€å•çš„ç†è§£ä¸º Flexbox æ˜¯CSSé¢†åŸŸç±»ä¼¼ Linearlayout çš„ä¸€ç§å¸ƒå±€ï¼Œä½†æ˜¯è¦æ¯” Linearlayout è¦å¼ºå¤§çš„å¤šã€‚</p>
<h2 id="2-ä»€ä¹ˆæ˜¯-FlexboxLayoutï¼Ÿ"><a href="#2-ä»€ä¹ˆæ˜¯-FlexboxLayoutï¼Ÿ" class="headerlink" title="2.ä»€ä¹ˆæ˜¯ FlexboxLayoutï¼Ÿ"></a>2.ä»€ä¹ˆæ˜¯ FlexboxLayoutï¼Ÿ</h2><p>åˆšæ‰è¯´äº† Flexbox æ˜¯CSSé¢†åŸŸçš„æ¯”è¾ƒå¼ºå¤§çš„ä¸€ä¸ªå¸ƒå±€ï¼Œæˆ‘ä»¬åœ¨ Android å¼€å‘ä¸­ä½¿ç”¨ Linearlayout + RelativeLayout åŸºæœ¬å¯ä»¥å®ç°å¤§éƒ¨åˆ†å¤æ‚çš„å¸ƒå±€ï¼Œä½†æ˜¯Googleå°±æƒ³äº†ï¼Œæœ‰æ²¡æœ‰ç±»ä¼¼ Flexbox çš„ä¸€ä¸ªå¸ƒå±€å‘¢ï¼Ÿè¿™ä½¿ç”¨èµ·æ¥ä¸€ä¸ªå¸ƒå±€å°±å¯ä»¥æå®šå„ç§å¤æ‚çš„æƒ…å†µäº†ï¼Œäºæ˜¯ FlexboxLayout å°±åº”è¿è€Œç”Ÿäº†ã€‚</p>
<p>æ‰€ä»¥ FlexboxLayout æ˜¯é’ˆå¯¹ Android å¹³å°çš„ï¼Œå®ç°ç±»ä¼¼ Flexbox å¸ƒå±€æ–¹æ¡ˆçš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå¼€æºåœ°å€ï¼š<a href="https://github.com/google/flexbox-layout" target="_blank" rel="noopener">https://github.com/google/flexbox-layout</a></p>
<h2 id="3-ä½¿ç”¨æ–¹å¼"><a href="#3-ä½¿ç”¨æ–¹å¼" class="headerlink" title="3.ä½¿ç”¨æ–¹å¼"></a>3.ä½¿ç”¨æ–¹å¼</h2><p>ä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼Œåªéœ€è¦æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile <span class="string">'com.google.android:flexbox:0.1.2'</span></span><br></pre></td></tr></table></figure>
<p>xmlä¸­è¿™æ ·ä½¿ç”¨ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">com.google.android.flexbox.FlexboxLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:flexWrap</span>=<span class="string">"wrap"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:alignItems</span>=<span class="string">"stretch"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:alignContent</span>=<span class="string">"stretch"</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/textview1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"120dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"80dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_flexBasisPercent</span>=<span class="string">"50%"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/textview2"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"80dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"80dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_alignSelf</span>=<span class="string">"center"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/textview3"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"160dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"80dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_alignSelf</span>=<span class="string">"flex_end"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">com.google.android.flexbox.FlexboxLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ä»£ç ä¸­è¿™æ ·ä½¿ç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">FlexboxLayout flexboxLayout = (FlexboxLayout) findViewById(R.id.flexbox_layout);</span><br><span class="line">flexboxLayout.setFlexDirection(FlexboxLayout.FLEX_DIRECTION_COLUMN);</span><br><span class="line"></span><br><span class="line">View view = flexboxLayout.getChildAt(<span class="number">0</span>);</span><br><span class="line">FlexboxLayout.LayoutParams lp = (FlexboxLayout.LayoutParams) view.getLayoutParams();</span><br><span class="line">lp.order = -<span class="number">1</span>;</span><br><span class="line">lp.flexGrow = <span class="number">2</span>;</span><br><span class="line">view.setLayoutParams(lp);</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆåƒLinearlayoutçš„ç”¨æ³•ï¼Œåªä¸è¿‡æœ‰å¾ˆå¤šå±æ€§ä½ ä»¬æ¯”è¾ƒé™Œç”Ÿï¼Œè¿™äº›å±æ€§éƒ½æ˜¯Flexboxå¸ƒå±€æœ¬èº«å…·å¤‡çš„ï¼Œåˆ«ç€æ€¥ï¼Œä¸‹é¢è·Ÿä½ ä»¬ä»‹ç»ä¸‹FlexboxLayoutçš„ä¸€äº›å…·ä½“å±æ€§çš„ç”¨æ³•ä¸æ„ä¹‰ã€‚</p>
<h2 id="4-æ”¯æŒçš„å±æ€§"><a href="#4-æ”¯æŒçš„å±æ€§" class="headerlink" title="4.æ”¯æŒçš„å±æ€§"></a>4.æ”¯æŒçš„å±æ€§</h2><h3 id="flexDirection"><a href="#flexDirection" class="headerlink" title="flexDirection"></a>flexDirection</h3><p>flexDirection å±æ€§å†³å®šä¸»è½´çš„æ–¹å‘ï¼ˆå³é¡¹ç›®çš„æ’åˆ—æ–¹å‘ï¼‰ã€‚ç±»ä¼¼ LinearLayout çš„ vertical å’Œ horizontalã€‚</p>
<p>æœ‰å››ä¸ªå€¼å¯ä»¥é€‰æ‹©ï¼š</p>
<ul>
<li>rowï¼ˆé»˜è®¤å€¼ï¼‰ï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯ã€‚</li>
<li>row-reverseï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ç«¯ã€‚</li>
<li>columnï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿ã€‚</li>
<li>column-reverseï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿ã€‚</li>
</ul>
<h3 id="flexWrap"><a href="#flexWrap" class="headerlink" title="flexWrap"></a>flexWrap</h3><p>é»˜è®¤æƒ…å†µä¸‹ Flex è·Ÿ LinearLayout ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸å¸¦æ¢è¡Œæ’åˆ—çš„ï¼Œä½†æ˜¯flexWrapå±æ€§å¯ä»¥æ”¯æŒæ¢è¡Œæ’åˆ—ã€‚æœ‰ä¸‰ä¸ªå€¼ï¼š</p>
<p><img src="http://static.oschina.net/uploads/space/2016/0516/075805_YI0O_2652078.png" alt=""></p>
<ul>
<li>nowrap ï¼šä¸æ¢è¡Œ</li>
<li>wrapï¼šæŒ‰æ­£å¸¸æ–¹å‘æ¢è¡Œ</li>
<li>wrap-reverseï¼šæŒ‰åæ–¹å‘æ¢è¡Œ</li>
</ul>
<h3 id="justifyContent"><a href="#justifyContent" class="headerlink" title="justifyContent"></a>justifyContent</h3><p>justifyContentå±æ€§å®šä¹‰äº†é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼ã€‚</p>
<ul>
<li>flex-startï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå·¦å¯¹é½</li>
<li>flex-endï¼šå³å¯¹é½</li>
<li>centerï¼š å±…ä¸­</li>
<li>space-betweenï¼šä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”éƒ½ç›¸ç­‰ã€‚</li>
<li>space-aroundï¼šæ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚</li>
</ul>
<h3 id="alignItems"><a href="#alignItems" class="headerlink" title="alignItems"></a>alignItems</h3><p>alignItemså±æ€§å®šä¹‰é¡¹ç›®åœ¨å‰¯è½´è½´ä¸Šå¦‚ä½•å¯¹é½ã€‚</p>
<ul>
<li>flex-startï¼šäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚</li>
<li>flex-endï¼šäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚</li>
<li>centerï¼šäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚</li>
<li>baseline: é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½ã€‚</li>
<li>stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå¦‚æœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ã€‚</li>
</ul>
<p><img src="http://static.oschina.net/uploads/space/2016/0516/075958_K7iO_2652078.png" alt=""></p>
<h3 id="alignContent"><a href="#alignContent" class="headerlink" title="alignContent"></a>alignContent</h3><p>alignContentå±æ€§å®šä¹‰äº†å¤šæ ¹è½´çº¿çš„å¯¹é½æ–¹å¼ã€‚å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿ï¼Œè¯¥å±æ€§ä¸èµ·ä½œç”¨ã€‚</p>
<ul>
<li>flex-startï¼šä¸äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚</li>
<li>flex-endï¼šä¸äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚</li>
<li>centerï¼šä¸äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚</li>
<li>space-betweenï¼šä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒã€‚</li>
<li>space-aroundï¼šæ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚</li>
<li>stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šè½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´ã€‚</li>
</ul>
<h2 id="5-å­å…ƒç´ å±æ€§"><a href="#5-å­å…ƒç´ å±æ€§" class="headerlink" title="5.å­å…ƒç´ å±æ€§"></a>5.å­å…ƒç´ å±æ€§</h2><p>é™¤ä»¥ä¸Šä¹‹å¤–ï¼ŒFlexboxLayoutè¿˜æ”¯æŒå¦‚ä¸‹å­å…ƒç´ å±æ€§ï¼š</p>
<h3 id="layout-order"><a href="#layout-order" class="headerlink" title="layout_order"></a>layout_order</h3><p>é»˜è®¤æƒ…å†µä¸‹å­å…ƒç´ çš„æ’åˆ—æ–¹å¼æŒ‰ç…§æ–‡æ¡£æµçš„é¡ºåºä¾æ¬¡æ’åºï¼Œè€Œorderå±æ€§å¯ä»¥æ§åˆ¶æ’åˆ—çš„é¡ºåºï¼Œè´Ÿå€¼åœ¨å‰ï¼Œæ­£å€¼ç¾åï¼ŒæŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºä¾æ¬¡æ’åˆ—ã€‚æˆ‘ä»¬è¯´ä¹‹æ‰€ä»¥ FlexboxLayout ç›¸å¯¹LinearLayoutå¼ºå°±æ˜¯å› ä¸ºä¸€äº›å±æ€§æ¯”è¾ƒç»™åŠ›ï¼Œorderå°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p>
<p><img src="http://static.oschina.net/uploads/space/2016/0516/080144_woPx_2652078.png" alt=""></p>
<h3 id="layout-flexGrow"><a href="#layout-flexGrow" class="headerlink" title="layout_flexGrow"></a>layout_flexGrow</h3><p>layout_flexGrow å±æ€§å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ã€‚ä¸€å¼ å›¾çœ‹æ‡‚ã€‚è·Ÿ LinearLayout ä¸­çš„weightå±æ€§ä¸€æ ·ã€‚</p>
<p><img src="http://static.oschina.net/uploads/space/2016/0516/080148_QD0P_2652078.png" alt=""></p>
<p>å¦‚æœæ‰€æœ‰é¡¹ç›®çš„ layout_flexGrow  å±æ€§éƒ½ä¸º1ï¼Œåˆ™å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„ layout_flexGrow  å±æ€§ä¸º2ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™å‰è€…å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å…¶ä»–é¡¹å¤šä¸€å€ã€‚</p>
<h3 id="layout-flexShrink"><a href="#layout-flexShrink" class="headerlink" title="layout_flexShrink"></a>layout_flexShrink</h3><p>layout_flexShrink  å±æ€§å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°ã€‚</p>
<p>å¦‚æœæ‰€æœ‰é¡¹ç›®çš„ layout_flexShrink  å±æ€§éƒ½ä¸º1ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„flex-shrinkå±æ€§ä¸º0ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™ç©ºé—´ä¸è¶³æ—¶ï¼Œå‰è€…ä¸ç¼©å°ã€‚</p>
<p>è´Ÿå€¼å¯¹è¯¥å±æ€§æ— æ•ˆã€‚</p>
<h3 id="layout-alignSelf"><a href="#layout-alignSelf" class="headerlink" title="layout_alignSelf"></a>layout_alignSelf</h3><p>layout_alignSelf  å±æ€§å…è®¸å•ä¸ªå­å…ƒç´ æœ‰ä¸å…¶ä»–å­å…ƒç´ ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›– alignItems å±æ€§ã€‚é»˜è®¤å€¼ä¸ºautoï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„ alignItems å±æ€§ï¼Œå¦‚æœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäºstretchã€‚</p>
<ul>
<li>auto (default)</li>
<li>flex_start</li>
<li>flex_end</li>
<li>center</li>
<li>baseline</li>
<li>stretch</li>
</ul>
<blockquote>
<p>è¯¥å±æ€§å¯èƒ½å–6ä¸ªå€¼ï¼Œé™¤äº†autoï¼Œå…¶ä»–éƒ½ä¸align-itemså±æ€§å®Œå…¨ä¸€è‡´ã€‚</p>
</blockquote>
<h3 id="layout-flexBasisPercent"><a href="#layout-flexBasisPercent" class="headerlink" title="layout_flexBasisPercent"></a>layout_flexBasisPercent</h3><p>layout_flexBasisPercent å±æ€§å®šä¹‰äº†åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰ï¼Œå­å…ƒç´ å æ®çš„main sizeä¸»è½´ç©ºé—´ï¼Œæµè§ˆå™¨æ ¹æ®è¿™ä¸ªå±æ€§ï¼Œè®¡ç®—ä¸»è½´æ˜¯å¦æœ‰å¤šä½™ç©ºé—´ã€‚å®ƒçš„é»˜è®¤å€¼ä¸ºautoï¼Œå³å­å…ƒç´ çš„æœ¬æ¥å¤§å°ã€‚</p>
<h2 id="6-ä¸åŒä¹‹å¤„"><a href="#6-ä¸åŒä¹‹å¤„" class="headerlink" title="6.ä¸åŒä¹‹å¤„"></a>6.ä¸åŒä¹‹å¤„</h2><p>è·Ÿä¼ ç»Ÿçš„CSSä¸­çš„Flexboxå¸ƒå±€æœ‰äº›ä¸åŒçš„æ˜¯ï¼š</p>
<p>1. æ²¡æœ‰ flex-flow å±æ€§</p>
<p>2. æ²¡æœ‰ flex å±æ€§</p>
<p>3. layout_flexBasisPercent å±æ€§å³ä¸ºCSSä¸­ flexbox ä¸­çš„ flexBasis å±æ€§</p>
<p>4. ä¸æ”¯æŒ min-width å’Œ min-height ä¸¤ä¸ªå±æ€§</p>
<p>ä»¥ä¸Šå°±æ˜¯ FlexboxLayout çš„ä¸€äº›åŸºæœ¬ä»‹ç»ä¸åŸºæœ¬ç”¨æ³•ï¼Œå€¼å¾—æé†’å¤§å®¶çš„æ˜¯ï¼Œæœ¬èº«è¿™ä¸ªé¡¹ç›®ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è‡ªå®šä¹‰Viewçš„å­¦ä¹ èµ„æ–™ï¼Œå€¼å¾—å¤§å®¶å­¦ä¹ å€Ÿé‰´ï¼</p>
<h2 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h2><p>æœ¬æ–‡çš„å¾ˆå¤š Flexbox æ–¹é¢çš„çŸ¥è¯†å¤§é‡å‚è€ƒäº†æˆ‘å¸åŒäº‹çš„è¿™ç¯‡æ–‡ç« ï¼Œæƒ³è¦æ›´å¤šçš„äº†è§£ Flexbox ç›¸å…³çš„çŸ¥è¯†å»ºè®®é˜…è¯»è¿™é‡Œï¼š</p>
<p><a href="http://w4lle.github.io/2016/05/08/Flexbox/" target="_blank" rel="noopener">http://w4lle.github.io/2016/05/08/Flexbox/</a></p>
<blockquote>
<p>å‡ºå¤„ï¼šå¾®ä¿¡å…¬ä¼—å¹³å° <a href="http://mp.weixin.qq.com/s?__biz=MzA4NTQwNDcyMA==&amp;mid=2650661681&amp;idx=1&amp;sn=b151aba0c5fb702492f6bbd82211988d#rd" target="_blank" rel="noopener">AndroidDeveloper</a></p>
<p>ç›¸å…³é“¾æ¥<br>FlexboxLayout çš„è¯¦ç»†ä»‹ç»ï¼š<a href="http://www.oschina.net/p/flexboxlayout" target="_blank" rel="noopener">è¯·ç‚¹è¿™é‡Œ</a></p>
<p>FlexboxLayout çš„ä¸‹è½½åœ°å€ï¼š<a href="http://www.oschina.net/action/project/go?id=42172&amp;p=download" target="_blank" rel="noopener">è¯·ç‚¹è¿™é‡Œ</a></p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> FlexboxLayout </tag>
            
            <tag> google </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android MVP&ä¾èµ–æ³¨å…¥&å•å…ƒæµ‹è¯•]]></title>
      <url>/2016/04/22/Android-Android-MVP-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/</url>
      <content type="html"><![CDATA[<h1 id="Android-MVP-amp-ä¾èµ–æ³¨å…¥-amp-å•å…ƒæµ‹è¯•"><a href="#Android-MVP-amp-ä¾èµ–æ³¨å…¥-amp-å•å…ƒæµ‹è¯•" class="headerlink" title="Android MVP&amp;ä¾èµ–æ³¨å…¥&amp;å•å…ƒæµ‹è¯•"></a>Android MVP&amp;ä¾èµ–æ³¨å…¥&amp;å•å…ƒæµ‹è¯•</h1><blockquote>
<p><strong>æ³¨æ„</strong>ï¼šä¸ºäº†åŒºåˆ†<code>MVP</code>ä¸­çš„<code>View</code>ä¸<code>Android</code>ä¸­æ§ä»¶çš„<code>View</code>ï¼Œä»¥ä¸‹<code>MVP</code>ä¸­çš„<code>View</code>ä½¿ç”¨<code>Viewer</code>æ¥è¡¨ç¤ºã€‚</p>
</blockquote>
<p>è¿™é‡Œæš‚æ—¶å…ˆåªè®¨è®º <code>Viewer</code> å’Œ <code>Presenter</code>ï¼Œ<code>Model</code>æš‚æ—¶ä¸å»æ¶‰åŠã€‚</p>
<h2 id="1-1-MVP-åŸºç¡€æ¡†æ¶"><a href="#1-1-MVP-åŸºç¡€æ¡†æ¶" class="headerlink" title="1.1 MVP åŸºç¡€æ¡†æ¶"></a>1.1 MVP åŸºç¡€æ¡†æ¶</h2><h3 id="1-1-1-å‰æ"><a href="#1-1-1-å‰æ" class="headerlink" title="1.1.1 å‰æ"></a>1.1.1 å‰æ</h3><p>é¦–å…ˆéœ€è¦è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>
<blockquote>
<p><code>MVP</code>ä¸­æŠŠLayoutå¸ƒå±€å’Œ<code>Activity</code>ç­‰ç»„ä»¶ä½œä¸º<code>Viewer</code>å±‚ï¼Œå¢åŠ äº†<code>Presenter</code>ï¼Œ<code>Presenter</code>å±‚ä¸<code>Model</code>å±‚è¿›è¡Œä¸šåŠ¡çš„äº¤äº’ï¼Œå®Œæˆåå†ä¸<code>Viewer</code>å±‚äº¤äº’,è¿›è¡Œå›è°ƒæ¥åˆ·æ–°UIã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸šåŠ¡é€»è¾‘çš„å·¥ä½œéƒ½äº¤ç»™äº†<code>Presenter</code>ä¸­è¿›è¡Œï¼Œä½¿å¾—<code>Viewer</code>å±‚ä¸<code>Model</code>å±‚çš„è€¦åˆåº¦é™ä½ï¼Œ<code>Viewer</code>ä¸­çš„å·¥ä½œä¹Ÿè¿›è¡Œäº†ç®€åŒ–ã€‚ä½†æ˜¯åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œéšç€é€»è¾‘çš„å¤æ‚åº¦è¶Šæ¥è¶Šå¤§ï¼Œ<code>Viewer</code>ï¼ˆå¦‚<code>Activity</code>ï¼‰è‡ƒè‚¿çš„ç¼ºç‚¹ä»ç„¶ä½“ç°å‡ºæ¥äº†ï¼Œå› ä¸º<code>Activity</code>ä¸­è¿˜æ˜¯å……æ»¡äº†å¤§é‡ä¸<code>Viewer</code>å±‚æ— å…³çš„ä»£ç ï¼Œæ¯”å¦‚å„ç§äº‹ä»¶çš„å¤„ç†æ´¾å‘ï¼Œå°±å¦‚<code>MVC</code>ä¸­çš„é‚£æ ·<code>Viewer</code>å±‚å’Œ<code>Controller</code>ä»£ç è€¦åˆåœ¨ä¸€èµ·æ— æ³•è‡ªæ‹”ã€‚</p>
</blockquote>
<p>è½¬è‡ªæˆ‘ä¹‹å‰çš„åšå®¢ï¼ˆ<strong><a href="http://www.cnblogs.com/tiantianbyconan/p/5036289.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5036289.html</a></strong>ï¼‰ä¸­ç¬¬äºŒé˜¶æ®µæ‰€å¼•å‘çš„é—®é¢˜ã€‚</p>
<p>è§£å†³çš„æ–¹æ³•ä¹‹ä¸€åœ¨ä¸Šè¿°æ–‡ç« ä¸­ä¹Ÿæœ‰æåˆ° â€”â€” åŠ å…¥<code>Controller</code>å±‚æ¥åˆ†æ‹…<code>Viewer</code>çš„èŒè´£ã€‚</p>
<h3 id="1-1-2-Contract"><a href="#1-1-2-Contract" class="headerlink" title="1.1.2 Contract"></a>1.1.2 Contract</h3><p>æ ¹æ®ä»¥ä¸Šçš„è§£å†³æ–¹æ¡ˆï¼Œé¦–å…ˆè€ƒè™‘åˆ°<code>Viewer</code>ç›´æ¥äº¤äº’çš„å¯¹è±¡å¯èƒ½æ˜¯<code>Presenter</code>ï¼ˆåŸæ¥çš„æ–¹å¼ï¼‰ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯<code>Controller</code>ã€‚</p>
<ul>
<li><p>å¦‚æœç›´æ¥äº¤äº’çš„å¯¹è±¡æ˜¯<code>Presenter</code>ï¼Œç”±äº<code>Presenter</code>ä¸­å¯èƒ½ä¼šè¿›è¡Œå¾ˆå¤šåŒæ­¥ã€å¼‚æ­¥æ“ä½œæ¥è°ƒç”¨<code>Model</code>å±‚çš„ä»£ç ï¼Œå¹¶ä¸”ä¼šå›è°ƒåˆ°UIæ¥è¿›è¡ŒUIçš„æ›´æ–°ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨<code>Viewer</code>å±‚å¯¹è±¡é”€æ¯æ—¶èƒ½å¤Ÿåœæ­¢<code>Presenter</code>ä¸­æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæˆ–è€…æ‰§è¡Œå®Œæˆåæ‹¦æˆªUIçš„ç›¸å…³å›è°ƒã€‚å› æ­¤ï¼Œ<code>Presenter</code>ä¸­åº”è¯¥ç»‘å®š<code>Viewer</code>å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆè‡³å°‘<code>Viewer</code>é”€æ¯çš„ç”Ÿå‘½å‘¨æœŸæ˜¯éœ€è¦å…³å¿ƒçš„ï¼‰</p>
</li>
<li><p>å¦‚æœç›´æ¥äº¤äº’çš„å¯¹è±¡æ˜¯<code>Controller</code>ï¼Œç”±äº<code>Controller</code>ä¸­ä¼šæ‰¿æ‹…<code>Viewer</code>ä¸­çš„äº‹ä»¶å›è°ƒå¹¶æ´¾å‘çš„èŒè´£ï¼ˆæ¯”å¦‚ï¼ŒListView item çš„ç‚¹å‡»å›è°ƒå’Œç‚¹å‡»ä¹‹åå¯¹ç›¸åº”çš„é€»è¾‘è¿›è¡Œæ´¾å‘ã€æˆ–è€…<code>Viewer</code>ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å›è°ƒåçš„å¤„ç†ï¼‰ï¼Œæ‰€ä»¥<code>Controller</code>å±‚ä¹Ÿæ˜¯éœ€è¦ç»‘å®š<code>Viewer</code>å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸçš„ã€‚</p>
</li>
</ul>
<p>è¿™é‡Œï¼Œä½¿ç”¨<code>Viewer</code>ç”Ÿå‘½å‘¨æœŸå›è°ƒè¿›è¡ŒæŠ½è±¡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnViewerDestroyListener</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onViewerDestroy</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnViewerLifecycleListener</span> <span class="keyword">extends</span> <span class="title">OnViewerDestroyListener</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onViewerResume</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onViewerPause</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>OnViewerDestroyListener</code>æ¥å£æä¾›ç»™éœ€è¦å…³å¿ƒ<code>Viewer</code>å±‚é”€æ¯æ—¶æœŸçš„ç»„ä»¶ï¼Œå¦‚ä¸Šï¼Œåº”è¯¥æ˜¯<code>Presenter</code>æ‰€éœ€è¦å…³å¿ƒçš„ã€‚</p>
<p><code>OnViewerLifecycleListener</code>æ¥å£æä¾›ç»™éœ€è¦å…³å¿ƒ<code>Viewer</code>å±‚ç”Ÿå‘½å‘¨æœŸå›è°ƒçš„ç»„ä»¶ï¼Œå¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚å¢åŠ æ›´å¤šçš„ç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬åªå…³å¿ƒ<code>Viewer</code>çš„<code>resume</code>å’Œ<code>pause</code>ã€‚</p>
<h3 id="1-1-3-Viewerå±‚"><a href="#1-1-3-Viewerå±‚" class="headerlink" title="1.1.3 Viewerå±‚"></a>1.1.3 Viewerå±‚</h3><h4 id="1-1-3-1-Viewer-æŠ½è±¡"><a href="#1-1-3-1-Viewer-æŠ½è±¡" class="headerlink" title="1.1.3.1 Viewer æŠ½è±¡"></a>1.1.3.1 Viewer æŠ½è±¡</h4><p><code>Viewer</code>å±‚ï¼Œä¹Ÿå°±æ˜¯è¡¨ç°å±‚ï¼Œå½“ç„¶æœ‰ç›¸å…³å¸¸ç”¨çš„UIæ“ä½œï¼Œæ¯”å¦‚æ˜¾ç¤ºä¸€ä¸ª<code>toast</code>ã€æ˜¾ç¤º/å–æ¶ˆä¸€ä¸ªåŠ è½½è¿›åº¦æ¡ç­‰ç­‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç”±äº<code>Viewer</code>å±‚å¯èƒ½ä¼šç›´æ¥ä¸<code>Presenter</code>æˆ–è€…<code>Controller</code>å±‚äº¤äº’ï¼Œæ‰€ä»¥åº”è¯¥è¿˜æä¾›å¯¹è¿™ä¸¤è€…çš„ç»‘å®šæ“ä½œï¼Œæ‰€ä»¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Viewer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">Viewer <span class="title">bind</span><span class="params">(OnViewerLifecycleListener onViewerLifecycleListener)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Viewer <span class="title">bind</span><span class="params">(OnViewerDestroyListener onViewerDestroyListener)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Context <span class="title">context</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showToast</span><span class="params">(String message)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showToast</span><span class="params">(<span class="keyword">int</span> resStringId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showLoadingDialog</span><span class="params">(String message)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showLoadingDialog</span><span class="params">(<span class="keyword">int</span> resStringId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cancelLoadingDialog</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šä»£ç ï¼Œä¸¤ä¸ª<code>bind()</code>æ–¹æ³•å°±æ˜¯ç”¨äºè·Ÿ<code>Presenter</code>/<code>Controller</code>çš„ç»‘å®šã€‚</p>
<h4 id="1-1-3-2-Viewer-å§”æ‰˜å®ç°"><a href="#1-1-3-2-Viewer-å§”æ‰˜å®ç°" class="headerlink" title="1.1.3.2 Viewer å§”æ‰˜å®ç°"></a>1.1.3.2 Viewer å§”æ‰˜å®ç°</h4><p>åˆå› ä¸ºï¼Œåœ¨Androidä¸­<code>Viewer</code>å±‚å¯¹è±¡å¯èƒ½æ˜¯<code>Activity</code>ã€<code>Fragment</code>ã€<code>View</code>ï¼ˆåŒ…æ‹¬<code>ViewGroup</code>ï¼‰ï¼Œç”šè‡³è¿˜æœ‰è‡ªå·±å®ç°çš„ç»„ä»¶ï¼Œå½“ç„¶å®ç°çš„æ–¹å¼ä¸€èˆ¬ä¸å¤–ä¹ä¸Šé¢è¿™å‡ ç§ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨ç»Ÿä¸€çš„<code>Activity</code>ã€<code>Fragment</code>ã€<code>View</code>ï¼Œæ¯ä¸ªéƒ½éœ€è¦å®ç°<code>Viewer</code>æ¥å£ã€‚ä¸ºäº†å¤ç”¨ç›¸å…³ä»£ç ï¼Œè¿™é‡Œæä¾›é»˜è®¤çš„å§”æ‰˜å®ç°<code>ViewerDelegate</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewerDelegate</span> <span class="keyword">implements</span> <span class="title">Viewer</span>, <span class="title">OnViewerLifecycleListener</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Context mContext;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ViewerDelegate</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        mContext = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;OnViewerDestroyListener&gt; mOnViewerDestroyListeners;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;OnViewerLifecycleListener&gt; mOnViewerLifecycleListeners;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Toast toast;</span><br><span class="line">    <span class="keyword">private</span> ProgressDialog loadingDialog;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Viewer <span class="title">bind</span><span class="params">(OnViewerLifecycleListener onViewerLifecycleListener)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == mOnViewerLifecycleListeners) &#123;</span><br><span class="line">            mOnViewerLifecycleListeners = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            mOnViewerLifecycleListeners.add(onViewerLifecycleListener);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!mOnViewerLifecycleListeners.contains(onViewerLifecycleListener)) &#123;</span><br><span class="line">                mOnViewerLifecycleListeners.add(onViewerLifecycleListener);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Viewer <span class="title">bind</span><span class="params">(OnViewerDestroyListener onViewerDestroyListener)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == mOnViewerDestroyListeners) &#123;</span><br><span class="line">            mOnViewerDestroyListeners = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            mOnViewerDestroyListeners.add(onViewerDestroyListener);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!mOnViewerDestroyListeners.contains(onViewerDestroyListener)) &#123;</span><br><span class="line">                mOnViewerDestroyListeners.add(onViewerDestroyListener);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Context <span class="title">context</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showToast</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!checkViewer()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == toast) &#123;</span><br><span class="line">            toast = Toast.makeText(mContext, <span class="string">""</span>, Toast.LENGTH_SHORT);</span><br><span class="line">            toast.setGravity(Gravity.CENTER, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        toast.setText(message);</span><br><span class="line">        toast.show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showToast</span><span class="params">(<span class="keyword">int</span> resStringId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!checkViewer()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        showToast(mContext.getString(resStringId));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showLoadingDialog</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!checkViewer()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == loadingDialog) &#123;</span><br><span class="line">            loadingDialog = <span class="keyword">new</span> ProgressDialog(mContext);</span><br><span class="line">            loadingDialog.setCanceledOnTouchOutside(<span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        loadingDialog.setMessage(message);</span><br><span class="line">        loadingDialog.show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showLoadingDialog</span><span class="params">(<span class="keyword">int</span> resStringId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!checkViewer()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        showLoadingDialog(mContext.getString(resStringId));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cancelLoadingDialog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!checkViewer()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != loadingDialog) &#123;</span><br><span class="line">            loadingDialog.cancel();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkViewer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span> != mContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewerResume</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != mOnViewerLifecycleListeners) &#123;</span><br><span class="line">            <span class="keyword">for</span> (OnViewerLifecycleListener oll : mOnViewerLifecycleListeners) &#123;</span><br><span class="line">                oll.onViewerResume();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewerPause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != mOnViewerLifecycleListeners) &#123;</span><br><span class="line">            <span class="keyword">for</span> (OnViewerLifecycleListener oll : mOnViewerLifecycleListeners) &#123;</span><br><span class="line">                oll.onViewerPause();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewerDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != mOnViewerLifecycleListeners) &#123;</span><br><span class="line">            <span class="keyword">for</span> (OnViewerLifecycleListener oll : mOnViewerLifecycleListeners) &#123;</span><br><span class="line">                oll.onViewerDestroy();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != mOnViewerDestroyListeners) &#123;</span><br><span class="line">            <span class="keyword">for</span> (OnViewerDestroyListener odl : mOnViewerDestroyListeners) &#123;</span><br><span class="line">                odl.onViewerDestroy();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        mContext = <span class="keyword">null</span>;</span><br><span class="line">        mOnViewerDestroyListeners = <span class="keyword">null</span>;</span><br><span class="line">        mOnViewerLifecycleListeners = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šä»£ç ï¼š</p>
<ul>
<li><p>å®ƒæä¾›äº†é»˜è®¤åŸºæœ¬çš„<code>toast</code>ã€å’Œæ˜¾ç¤º/éšè—åŠ è½½è¿›åº¦æ¡çš„æ–¹æ³•ã€‚</p>
</li>
<li><p>å®ƒå®ç°äº†ä¸¤ä¸ªé‡è½½<code>bind()</code>æ–¹æ³•ï¼Œå¹¶æŠŠéœ€è¦å›è°ƒçš„<code>OnViewerLifecycleListener</code>å’Œ<code>OnViewerDestroyListener</code>å¯¹åº”ä¿å­˜åœ¨<code>mOnViewerDestroyListeners</code>å’Œ<code>mOnViewerLifecycleListeners</code>ä¸­ã€‚</p>
</li>
<li><p>å®ƒå®ç°äº†<code>OnViewerLifecycleListener</code>æ¥å£ï¼Œåœ¨å›è°ƒæ–¹æ³•ä¸­å›è°ƒåˆ°æ¯ä¸ª<code>mOnViewerDestroyListeners</code>å’Œ<code>mOnViewerLifecycleListeners</code>ã€‚</p>
</li>
</ul>
<p><code>mOnViewerDestroyListeners</code>ï¼šViewer destroy æ—¶çš„å›è°ƒï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªä¼šæœ‰Presenterä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ç”±äºä¸€ä¸ªVieweræ˜¯å¯ä»¥æœ‰å¤šä¸ªPresenterçš„,æ‰€ä»¥å¯èƒ½ä¼šç»´æŠ¤ä¸€ä¸ªPresenteråˆ—è¡¨ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯å…¶ä»–éœ€è¦å…³å¿ƒ Viewer destroy çš„ç»„ä»¶</p>
<p><code>mOnViewerLifecycleListeners</code>ï¼šViewer ç®€å•çš„ç”Ÿå‘½å‘¨æœŸç›‘å¬å¯¹è±¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªæœ‰ä¸€ä¸ªControllerä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ä¸€ä¸ªViewerå¹¶ä¸é™åˆ¶åªæœ‰ä¸€ä¸ªControllerå¯¹è±¡,æ‰€ä»¥å¯èƒ½ä¼šç»´æŠ¤ä¸€ä¸ªControlleråˆ—è¡¨ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯å…¶ä»–å…³å¿ƒ Viewer ç®€å•ç”Ÿå‘½å‘¨æœŸçš„ç»„ä»¶</p>
<h4 id="1-1-3-3-çœŸå®-Viewer-å®ç°"><a href="#1-1-3-3-çœŸå®-Viewer-å®ç°" class="headerlink" title="1.1.3.3 çœŸå® Viewer å®ç°"></a>1.1.3.3 çœŸå® Viewer å®ç°</h4><p>ç„¶ååœ¨çœŸå®çš„<code>Viewer</code>ä¸­ï¼ˆè¿™é‡Œä»¥<code>Activity</code>ä¸ºä¾‹ï¼Œå…¶ä»–<code>Fragment</code>/<code>View</code>ç­‰ä¹Ÿæ˜¯ä¸€æ ·ï¼‰ï¼Œé¦–å…ˆï¼Œåº”è¯¥å®ç°<code>Viewer</code>æ¥å£ï¼Œå¹¶ä¸”åº”è¯¥ç»´æŠ¤ä¸€ä¸ªå§”æ‰˜å¯¹è±¡<code>mViewerDelegate</code>ï¼Œåœ¨å®ç°çš„<code>Viewer</code>æ–¹æ³•ä¸­ä½¿ç”¨<code>mViewerDelegate</code>çš„å…·ä½“å®ç°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">Viewer</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> ViewerDelegate mViewerDelegate;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    	<span class="comment">// ...</span></span><br><span class="line">    	mViewerDelegate = <span class="keyword">new</span> ViewerDelegate(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mViewerDelegate.onViewerResume();</span><br><span class="line">        <span class="keyword">super</span>.onResume();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mViewerDelegate.onViewerPause();</span><br><span class="line">        <span class="keyword">super</span>.onPause();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mViewerDelegate.onViewerDestroy();</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Viewer <span class="title">bind</span><span class="params">(OnViewerDestroyListener onViewerDestroyListener)</span> </span>&#123;</span><br><span class="line">        mViewerDelegate.bind(onViewerDestroyListener);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Viewer <span class="title">bind</span><span class="params">(OnViewerLifecycleListener onViewerLifecycleListener)</span> </span>&#123;</span><br><span class="line">        mViewerDelegate.bind(onViewerLifecycleListener);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Context <span class="title">context</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mViewerDelegate.context();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showToast</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        mViewerDelegate.showToast(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showToast</span><span class="params">(<span class="keyword">int</span> resStringId)</span> </span>&#123;</span><br><span class="line">        mViewerDelegate.showToast(resStringId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showLoadingDialog</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        mViewerDelegate.showLoadingDialog(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showLoadingDialog</span><span class="params">(<span class="keyword">int</span> resStringId)</span> </span>&#123;</span><br><span class="line">        mViewerDelegate.showLoadingDialog(resStringId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cancelLoadingDialog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mViewerDelegate.cancelLoadingDialog();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šï¼Œ<code>BaseActivity</code>æ„å»ºå®Œæˆã€‚</p>
<p><strong>åœ¨å…·ä½“çœŸå®çš„<code>Viewer</code>å®ç°ä¸­ï¼ŒåŒ…å«çš„æ–¹æ³•åº”è¯¥éƒ½æ˜¯ç±»ä¼¼<code>onXxxYyyZzz()</code>çš„å›è°ƒæ–¹æ³•ï¼Œå¹¶ä¸”è¿™äº›å›è°ƒæ–¹æ³•åº”è¯¥åªè¿›è¡ŒUIæ“ä½œï¼Œæ¯”å¦‚<code>onLoadMessage(List&lt;Message&gt; message)</code>æ–¹æ³•åœ¨åŠ è½½å®Œ<code>Message</code>æ•°æ®åå›è°ƒè¯¥æ–¹æ³•æ¥è¿›è¡ŒUIçš„æ›´æ–°ã€‚</strong></p>
<p>åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ—¶ï¼Œåº”è¯¥ä½¿ç”¨ä¾èµ–æ³¨å…¥æ¥æŠŠ<code>Controller</code>å¯¹è±¡æ³¨å…¥åˆ°<code>Viewer</code>ä¸­ï¼ˆè¿™ä¸ªåé¢ä¼šæåˆ°ï¼‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RInject</span></span><br><span class="line">IBuyingRequestPostSucceedController controller;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    BuyingRequestPostSucceedView_Rapier</span><br><span class="line">            .create()</span><br><span class="line">            .inject(<span class="keyword">module</span>, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    controller.bind(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>RInject</code>é€šè¿‡<code>BuyingRequestPostSucceedView_Rapier</code>æ‰©å±•ç±»æ¥è¿›è¡Œæ³¨å…¥<code>Controller</code>å¯¹è±¡ï¼Œç„¶åè°ƒç”¨<code>Controller</code>çš„<code>bind</code>æ–¹æ³•è¿›è¡Œç”Ÿå‘½å‘¨æœŸçš„ç»‘å®šã€‚</p>
<h3 id="1-1-4-Controller-å±‚"><a href="#1-1-4-Controller-å±‚" class="headerlink" title="1.1.4 Controller å±‚"></a>1.1.4 Controller å±‚</h3><h4 id="1-1-4-1-Controller-æŠ½è±¡"><a href="#1-1-4-1-Controller-æŠ½è±¡" class="headerlink" title="1.1.4.1 Controller æŠ½è±¡"></a>1.1.4.1 Controller æŠ½è±¡</h4><p>å‰é¢è®²è¿‡ï¼Œ<code>Controller</code>æ˜¯éœ€è¦å…³å¿ƒ<code>Viewer</code>ç”Ÿå‘½å‘¨æœŸçš„ï¼Œæ‰€ä»¥éœ€è¦å®ç°<code>OnViewerLifecycleListener</code>æ¥å£ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Controller</span> <span class="keyword">extends</span> <span class="title">OnViewerLifecycleListener</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bind</span><span class="params">(Viewer bindViewer)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆæä¾›ä¸€ä¸ª<code>bind()</code>æ–¹æ³•æ¥è¿›è¡Œå¯¹è‡ªèº«è¿›è¡Œç»‘å®šåˆ°å¯¹åº”çš„<code>Viewer</code>ä¸Šé¢ã€‚</p>
<h4 id="1-1-4-2-Controller-å®ç°"><a href="#1-1-4-2-Controller-å®ç°" class="headerlink" title="1.1.4.2 Controller å®ç°"></a>1.1.4.2 Controller å®ç°</h4><p>è°ƒç”¨<code>Viewer</code>å±‚çš„<code>bind()</code>æ–¹æ³•æ¥è¿›è¡Œç»‘å®šï¼Œå¯¹ç”Ÿå‘½å‘¨æœŸè¿›è¡Œç©ºå®ç°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseController</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bind</span><span class="params">(Viewer bindViewer)</span> </span>&#123;</span><br><span class="line">        bindViewer.bind(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewerResume</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// empty</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewerPause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// empty</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewerDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// empty</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯¥<code>bind()</code>æ–¹æ³•é™¤äº†ç”¨äºç»‘å®š<code>Viewer</code>ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è®©å­ç±»é‡å†™ç”¨äºåšä¸ºControllerçš„åˆå§‹åŒ–æ–¹æ³•,ä½†æ˜¯æ³¨æ„é‡å†™çš„æ—¶å€™å¿…é¡»è¦è°ƒç”¨<code>super.bind()</code>ã€‚</p>
<p><strong>å…·ä½“<code>Controller</code>å®ç°ä¸­ï¼Œåº”è¯¥åªåŒ…å«ç±»ä¼¼<code>onXxxYyyZzz()</code>çš„å›è°ƒæ–¹æ³•ï¼Œå¹¶ä¸”è¿™äº›å›è°ƒæ–¹æ³•åº”è¯¥éƒ½æ˜¯å„ç§äº‹ä»¶å›è°ƒï¼Œæ¯”å¦‚<code>onClick()</code>ç”¨äºViewç‚¹å‡»äº‹ä»¶çš„å›è°ƒï¼Œ<code>onItemClick()</code>è¡¨ç¤ºAdapterView itemç‚¹å‡»äº‹ä»¶çš„å›è°ƒã€‚</strong></p>
<h3 id="1-1-5-Presenter-å±‚"><a href="#1-1-5-Presenter-å±‚" class="headerlink" title="1.1.5 Presenter å±‚"></a>1.1.5 Presenter å±‚</h3><h4 id="1-1-5-1-Presenter-æŠ½è±¡"><a href="#1-1-5-1-Presenter-æŠ½è±¡" class="headerlink" title="1.1.5.1 Presenter æŠ½è±¡"></a>1.1.5.1 Presenter æŠ½è±¡</h4><blockquote>
<p><code>Presenter</code>å±‚ï¼Œä½œä¸ºæ²Ÿé€š <code>View</code> å’Œ <code>Model</code> çš„æ¡¥æ¢ï¼Œå®ƒä» <code>Model</code> å±‚æ£€ç´¢æ•°æ®åï¼Œè¿”å›ç»™ <code>View</code> å±‚ï¼Œå®ƒä¹Ÿå¯ä»¥å†³å®šä¸ <code>View</code> å±‚çš„äº¤äº’æ“ä½œã€‚</p>
</blockquote>
<p>å‰é¢è®²åˆ°è¿‡ï¼Œ<code>View</code>ä¹Ÿæ˜¯ä¸<code>Presenter</code>ç›´æ¥äº¤äº’çš„ï¼ŒPresenterä¸­å¯èƒ½ä¼šè¿›è¡Œå¾ˆå¤šåŒæ­¥ã€å¼‚æ­¥æ“ä½œæ¥è°ƒç”¨Modelå±‚çš„ä»£ç ï¼Œå¹¶ä¸”ä¼šå›è°ƒåˆ°UIæ¥è¿›è¡ŒUIçš„æ›´æ–°ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨Viewerå±‚å¯¹è±¡é”€æ¯æ—¶èƒ½å¤Ÿåœæ­¢Presenterä¸­æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæˆ–è€…æ‰§è¡Œå®Œæˆåæ‹¦æˆªUIçš„ç›¸å…³å›è°ƒã€‚</p>
<p>å› æ­¤ï¼š</p>
<ul>
<li><code>Presenter</code> ä¸­åº”è¯¥ä¹Ÿæœ‰<code>bind()</code>æ–¹æ³•æ¥è¿›è¡Œä¸<code>Viewer</code>å±‚çš„ç”Ÿå‘½å‘¨æœŸçš„ç»‘å®š</li>
<li><code>Presenter</code> ä¸­åº”è¯¥æä¾›ä¸€ä¸ªæ–¹æ³•<code>closeAllTask()</code>æ¥ç»ˆæ­¢æˆ–æ‹¦æˆªæ‰UIç›¸å…³çš„å¼‚æ­¥ä»»åŠ¡ã€‚</li>
</ul>
<p>å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Presenter</span> <span class="keyword">extends</span> <span class="title">OnViewerDestroyListener</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bind</span><span class="params">(Viewer bindViewer)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">closeAllTask</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-1-5-2-Presenter-RxJava-æŠ½è±¡"><a href="#1-1-5-2-Presenter-RxJava-æŠ½è±¡" class="headerlink" title="1.1.5.2 Presenter RxJava æŠ½è±¡"></a>1.1.5.2 Presenter RxJava æŠ½è±¡</h4><p>å› ä¸ºé¡¹ç›®æŠ€æœ¯éœ€æ±‚ï¼Œéœ€è¦å®ç°å¯¹<code>RxJava</code>çš„æ”¯æŒï¼Œå› æ­¤ï¼Œè¿™é‡Œå¯¹<code>Presenter</code>è¿›è¡Œç›¸å…³çš„æ‰©å±•ï¼Œæä¾›ä¸¤ä¸ªæ–¹æ³•ä»¥ä¾¿äº<code>Presenter</code>å¯¹ä»»åŠ¡çš„æ‰©å±•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RxPresenter</span> <span class="keyword">extends</span> <span class="title">Presenter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">goSubscription</span><span class="params">(Subscription subscription)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">removeSubscription</span><span class="params">(Subscription subscription)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>goSubscription()</code>æ–¹æ³•ä¸»è¦ç”¨å¤„æ˜¯ï¼Œè®¢é˜…æ—¶ç¼“å­˜è¯¥è®¢é˜…å¯¹è±¡åˆ°<code>Presenter</code>ä¸­ï¼Œä¾¿äºç®¡ç†ï¼ˆæ€ä¹ˆç®¡ç†ï¼Œä¸‹é¢ä¼šè®²åˆ°ï¼‰ã€‚</p>
<p><code>removeSubscription()</code>æ–¹æ³•å¯ä»¥ä»<code>Presenter</code>ä¸­ç®¡ç†çš„è®¢é˜…ç¼“å­˜ä¸­ç§»é™¤æ‰è¯¥è®¢é˜…ã€‚</p>
<h4 id="1-1-5-3-Presenter-RxJava-å®ç°"><a href="#1-1-5-3-Presenter-RxJava-å®ç°" class="headerlink" title="1.1.5.3 Presenter RxJava å®ç°"></a>1.1.5.3 Presenter RxJava å®ç°</h4><p>åœ¨Presenter RxJava å®ç°ï¼ˆ<code>RxBasePresenter</code>ï¼‰ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>WeakHashMap</code>æ¥æ„å»ºä¸€ä¸ªå¼±å¼•ç”¨çš„<code>Set</code>ï¼Œç”¨å®ƒæ¥ç¼“å­˜æ‰€æœ‰è®¢é˜…ã€‚åœ¨è°ƒç”¨<code>goSubscription()</code>æ–¹æ³•ä¸­ï¼ŒæŠŠå¯¹åº”çš„<code>Subscription</code>åŠ å…¥åˆ°<code>Set</code>ä¸­ï¼Œåœ¨<code>removeSubscription()</code>æ–¹æ³•ä¸­ï¼ŒæŠŠå¯¹åº”çš„<code>Subscription</code>ä»<code>Set</code>ä¸­ç§»é™¤æ‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RxBasePresenter</span> <span class="keyword">implements</span> <span class="title">RxPresenter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = RxBasePresenter.class.getSimpleName();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Set&lt;Subscription&gt; subscriptions = Collections.newSetFromMap(<span class="keyword">new</span> WeakHashMap&lt;Subscription, Boolean&gt;());</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeAllTask</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (subscriptions) &#123;</span><br><span class="line">            Iterator iter = <span class="keyword">this</span>.subscriptions.iterator();</span><br><span class="line">            <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">                Subscription subscription = (Subscription) iter.next();</span><br><span class="line">                XLog.i(TAG, <span class="string">"closeAllTask[subscriptions]: "</span> + subscription);</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != subscription &amp;&amp; !subscription.isUnsubscribed()) &#123;</span><br><span class="line">                    subscription.unsubscribe();</span><br><span class="line">                &#125;</span><br><span class="line">                iter.remove();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">goSubscription</span><span class="params">(Subscription subscription)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (subscriptions) &#123;</span><br><span class="line">            <span class="keyword">this</span>.subscriptions.add(subscription);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeSubscription</span><span class="params">(Subscription subscription)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (subscriptions) &#123;</span><br><span class="line">            XLog.i(TAG, <span class="string">"removeSubscription: "</span> + subscription);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != subscription &amp;&amp; !subscription.isUnsubscribed()) &#123;</span><br><span class="line">                subscription.unsubscribe();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.subscriptions.remove(subscription);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bind</span><span class="params">(Viewer bindViewer)</span> </span>&#123;</span><br><span class="line">        bindViewer.bind(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewerDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        closeAllTask();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šä»£ç ï¼Œåœ¨<code>onViewerDestroy()</code>å›è°ƒæ—¶ï¼ˆå› ä¸ºè·Ÿ<code>Viewer</code>ç”Ÿå‘½å‘¨æœŸè¿›è¡Œäº†ç»‘å®šï¼‰ï¼Œä¼šè°ƒç”¨<code>closeAllTask</code>æŠŠæ‰€æœ‰ç¼“å­˜ä¸­çš„<code>Subscription</code>å–æ¶ˆè®¢é˜…ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šå› ä¸ºç¼“å­˜ä¸­ä½¿ç”¨äº†å¼±å¼•ç”¨ï¼Œæ‰€ä»¥ä¸Šé¢çš„<code>removeSubscription</code>ä¸éœ€è¦å†å»æ‰‹åŠ¨è°ƒç”¨ï¼Œåœ¨è®¢é˜…completedåï¼Œgcè‡ªç„¶ä¼šå›æ”¶æ‰æ²¡æœ‰å¼ºå¼•ç”¨æŒ‡å‘çš„<code>Subscription</code>å¯¹è±¡ã€‚</p>
</blockquote>
<h4 id="1-1-5-4-Presenter-å…·ä½“å®ç°"><a href="#1-1-5-4-Presenter-å…·ä½“å®ç°" class="headerlink" title="1.1.5.4 Presenter å…·ä½“å®ç°"></a>1.1.5.4 Presenter å…·ä½“å®ç°</h4><p>åœ¨<code>Presenter</code>å…·ä½“çš„å®ç°ä¸­ï¼ŒåŒæ ·ä¾èµ–æ³¨å…¥å„ç§æ¥è‡ª<code>Model</code>å±‚çš„<code>Interactor/Api</code>ï¼ˆç½‘ç»œã€æ•°æ®åº“ã€æ–‡ä»¶ç­‰ç­‰ï¼‰ï¼Œç„¶åè®¢é˜…è¿™äº›å¯¹è±¡è¿”å›çš„<code>Observable</code>ï¼Œç„¶åè¿›è¡Œè®¢é˜…ï¼Œå¹¶è°ƒç”¨<code>goSubscription()</code>ç¼“å­˜<code>Subscription</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuyingRequestPostSucceedPresenter</span> <span class="keyword">extends</span> <span class="title">RxBasePresenter</span> <span class="keyword">implements</span> <span class="title">IBuyingRequestPostSucceedPresenter</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> IBuyingRequestPostSucceedView viewer;</span><br><span class="line">	<span class="meta">@RInject</span></span><br><span class="line">    ApiSearcher apiSearcher;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BuyingRequestPostSucceedPresenter</span><span class="params">(IBuyingRequestPostSucceedView viewer, BuyingRequestPostSucceedPresenterModule <span class="keyword">module</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.viewer = viewer;</span><br><span class="line">        <span class="comment">// inject</span></span><br><span class="line">        BuyingRequestPostSucceedPresenter_Rapier</span><br><span class="line">                .create()</span><br><span class="line">                .inject(<span class="keyword">module</span>, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadSomeThing</span><span class="params">(<span class="keyword">final</span> String foo, <span class="keyword">final</span> String bar)</span> </span>&#123;</span><br><span class="line">        goSubscription(</span><br><span class="line">                apiSearcher.searcherSomeThing(foo, bar)</span><br><span class="line">                        .compose(TransformerBridge.&lt;OceanServerResponse&lt;SomeThing&gt;&gt;subscribeOnNet())</span><br><span class="line">                        .map(<span class="keyword">new</span> Func1&lt;OceanServerResponse&lt;SomeThing&gt;, SomeThing&gt;() &#123;</span><br><span class="line">                            <span class="meta">@Override</span></span><br><span class="line">                            <span class="function"><span class="keyword">public</span> SomeThing <span class="title">call</span><span class="params">(OceanServerResponse&lt;SomeThing&gt; response)</span> </span>&#123;</span><br><span class="line">                                <span class="keyword">return</span> response.getBody();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;)</span><br><span class="line">                        .compose(TransformerBridge.&lt;SomeThing&gt;observableOnMain())</span><br><span class="line">                        .subscribe(<span class="keyword">new</span> Subscriber&lt;SomeThing&gt;() &#123;</span><br><span class="line"></span><br><span class="line">                            <span class="meta">@Override</span></span><br><span class="line">                            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">                                XLog.e(TAG, <span class="string">""</span>, e);</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            <span class="meta">@Override</span></span><br><span class="line">                            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(SomeThing someThing)</span> </span>&#123;</span><br><span class="line">                                XLog.d(TAG, <span class="string">"XLog onNext..."</span>);</span><br><span class="line">                                viewer.onLoadSomeThing(someThing);</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                            <span class="meta">@Override</span></span><br><span class="line">                            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                        &#125;)</span><br><span class="line">        );</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// ... </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-1-6-Model-å±‚"><a href="#1-1-6-Model-å±‚" class="headerlink" title="1.1.6 Model å±‚"></a>1.1.6 Model å±‚</h3><p>æš‚ä¸è®¨è®ºã€‚</p>
<h2 id="1-2-é’ˆå¯¹-MVP-è¿›è¡Œä¾èµ–æ³¨å…¥"><a href="#1-2-é’ˆå¯¹-MVP-è¿›è¡Œä¾èµ–æ³¨å…¥" class="headerlink" title="1.2 é’ˆå¯¹ MVP è¿›è¡Œä¾èµ–æ³¨å…¥"></a>1.2 é’ˆå¯¹ MVP è¿›è¡Œä¾èµ–æ³¨å…¥</h2><p>ä¸Šé¢æåˆ°ï¼Œ<code>Viewer</code>ã€<code>Controller</code>å’Œ<code>Presenter</code>ä¸­éƒ½ä½¿ç”¨äº†<code>RInject</code>æ³¨è§£æ¥è¿›è¡Œä¾èµ–çš„æ³¨å…¥ã€‚</p>
<p>è¿™é‡Œå¹¶æ²¡æœ‰ä½¿ç”¨å…¶ä»–ç¬¬ä¸‰æ–¹å®ç°çš„<code>DI</code>æ¡†æ¶ï¼Œæ¯”å¦‚<code>Dagger/Dagger2</code>ç­‰ï¼Œè€Œæ˜¯è‡ªå·±å®ç°çš„<a href="https://github.com/wangjiegulu/Rapier" target="_blank" rel="noopener">Rapier</a>ï¼Œå®ƒçš„åŸç†ä¸<code>Dagger2</code>ç±»ä¼¼ï¼Œä¼šåœ¨ç¼–è¯‘æ—¶æœŸç”Ÿæˆä¸€äº›æ‰©å±•æ‰©å±•ç±»æ¥ç®€åŒ–ä»£ç ï¼Œæ¯”å¦‚å‰é¢çš„<code>BuyingRequestPostSucceedView_Rapier</code>ã€<code>BuyingRequestPostSucceedPresenter_Rapier</code>ã€<code>BuyingRequestPostSucceedController_Rapier</code>ç­‰ã€‚å®ƒä¹Ÿæ”¯æŒ<code>Named</code>ã€<code>Lazy</code>ç­‰åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒæ¯”<code>Dagger2</code>æ›´åŠ è½»é‡ï¼Œ<code>Module</code>çš„ä½¿ç”¨æ–¹å¼æ›´åŠ ç®€å•ï¼Œæ›´åŠ å€¾å‘äºå¯¹<code>Module</code>çš„å¤ç”¨ï¼Œæ›´å¼ºçš„å¯æ§æ€§ï¼Œä½†æ˜¯ç”±äºè¿™æ¬¡çš„é‡æ„ä¸»è¦æ˜¯åŸºäºåœ¨å…¼å®¹æ—§ç‰ˆæœ¬çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œæš‚æ—¶æ²¡æœ‰åŠ ä¸Š<code>Scope</code>çš„æ”¯æŒã€‚</p>
<p>ä¹‹åå†é’ˆå¯¹è¿™ä¸ª<code>Rapier</code>åº“è¿›è¡Œè¯¦ç»†è®¨è®ºã€‚</p>
<h2 id="1-3-é’ˆå¯¹-MVP-è¿›è¡Œå•å…ƒæµ‹è¯•"><a href="#1-3-é’ˆå¯¹-MVP-è¿›è¡Œå•å…ƒæµ‹è¯•" class="headerlink" title="1.3 é’ˆå¯¹ MVP è¿›è¡Œå•å…ƒæµ‹è¯•"></a>1.3 é’ˆå¯¹ MVP è¿›è¡Œå•å…ƒæµ‹è¯•</h2><p>è¿™é‡Œä¸»è¦è¿˜æ˜¯è®¨è®ºé’ˆå¯¹<code>Viewer</code>å’Œ<code>Presenter</code>çš„å•å…ƒæµ‹è¯•ã€‚</p>
<h3 id="1-3-1-é’ˆå¯¹-Viewer-è¿›è¡Œå•å…ƒæµ‹è¯•"><a href="#1-3-1-é’ˆå¯¹-Viewer-è¿›è¡Œå•å…ƒæµ‹è¯•" class="headerlink" title="1.3.1 é’ˆå¯¹ Viewer è¿›è¡Œå•å…ƒæµ‹è¯•"></a>1.3.1 é’ˆå¯¹ Viewer è¿›è¡Œå•å…ƒæµ‹è¯•</h3><p>é’ˆå¯¹<code>Viewer</code>è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œè¿™é‡Œä¸æ¶‰åŠä»»ä½•ä¸šåŠ¡ç›¸å…³çš„é€»è¾‘ï¼Œè€Œä¸”ï¼Œ<code>Viewer</code>å±‚çš„æµ‹è¯•éƒ½æ˜¯UIç›¸å…³ï¼Œå¿…é¡»è¦Androidç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦åœ¨æ‰‹æœºæˆ–è€…æ¨¡æ‹Ÿå™¨å®‰è£…ä¸€ä¸ª<code>test</code> apkï¼Œç„¶åè¿›è¡Œæµ‹è¯•ã€‚</p>
<p>ä¸ºäº†ä¸è¢«<code>Viewer</code>ä¸­çš„<code>Controller</code>å’Œ<code>Presenter</code>çš„é€»è¾‘æ‰€å¹²æ‰°ï¼Œæˆ‘ä»¬å¿…é¡»è¦mockæ‰<code>Viewer</code>ä¸­çš„<code>Controller</code>å’Œ<code>Presenter</code>å¯¹è±¡ï¼Œåˆå› ä¸º<code>Controller</code>å¯¹è±¡æ˜¯é€šè¿‡ä¾èµ–æ³¨å…¥çš„æ–¹å¼æä¾›çš„ï¼Œä¹Ÿå°±æ˜¯æ¥è‡ª<code>Rapier</code>ä¸­çš„<code>Module</code>ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦mockæ‰<code>Viewer</code>å¯¹åº”çš„<code>module</code>ã€‚</p>
<h3 id="1-3-1-1-å¦‚æœ-Viewer-æ˜¯-View"><a href="#1-3-1-1-å¦‚æœ-Viewer-æ˜¯-View" class="headerlink" title="1.3.1.1 å¦‚æœ Viewer æ˜¯ View"></a>1.3.1.1 å¦‚æœ Viewer æ˜¯ View</h3><p>å¦‚æœ<code>Viewer</code>å±‚æ˜¯ç”±<code>View</code>å®ç°çš„ï¼Œæ¯”å¦‚ç»§æ‰¿<code>FrameLayout</code>ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæµ‹è¯•æ—¶ï¼Œå°±å¿…é¡»è¦æ”¾åœ¨ä¸€ä¸ª<code>Activity</code>ä¸­æµ‹è¯•ï¼ˆ<code>Fragment</code>ä¹Ÿä¸€æ ·ï¼Œä¹Ÿå¿…é¡»ä¾èµ–äº<code>Activity</code>ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥æœ‰ä¸€ä¸ªä¸“é—¨ç”¨äºæµ‹è¯•<code>View/Fragment</code>çš„<code>Activity</code> â€”â€” <code>TestContainerActivity</code>ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestContainerActivity</span> <span class="keyword">extends</span> <span class="title">BaseActivity</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è®°å¾—åœ¨<code>AndroidManifest.xml</code>ä¸­æ³¨å†Œã€‚</p>
<p>å‰é¢è¯´è¿‡ï¼Œæˆ‘ä»¬éœ€è¦mockæ‰<code>Module</code>ã€‚</p>
<p>å¦‚æœ<code>Viewer</code>æ˜¯<code>View</code>ï¼Œmockæ‰<code>Module</code>å°±éå¸¸å®¹æ˜“äº†ï¼Œåªè¦åœ¨<code>View</code>ä¸­æä¾›ä¸€ä¸ªä¼ å…¥mockçš„<code>Module</code>çš„æ„é€ æ–¹æ³•å³å¯ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@VisibleForTesting</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">BuyingRequestPostSucceedView</span><span class="params">(Context context, BuyingRequestPostSucceedModule <span class="keyword">module</span>)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">super</span>(context);</span><br><span class="line">	<span class="comment">// inject</span></span><br><span class="line">	BuyingRequestPostSucceedView_Rapier</span><br><span class="line">	        .create()</span><br><span class="line">	        .inject(<span class="keyword">module</span>, <span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šä»£ç ï¼Œè¿™é‡Œä¸ºæµ‹è¯•ä¸“é—¨æä¾›äº†ä¸€ä¸ªæ„é€ æ–¹æ³•æ¥è¿›è¡Œå¯¹<code>Module</code>çš„mockï¼Œä¹‹åçš„æµ‹è¯•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">BuyingRequestPostSucceedView requestPostSucceedView;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Rule</span></span><br><span class="line"><span class="keyword">public</span> ActivityTestRule&lt;TestContainerActivity&gt; mActivityTestRule = <span class="keyword">new</span> ActivityTestRule&lt;TestContainerActivity&gt;(TestContainerActivity.class) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterActivityLaunched</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>.afterActivityLaunched();</span><br><span class="line">            <span class="keyword">final</span> TestContainerActivity activity = getActivity();</span><br><span class="line">            logger(<span class="string">"afterActivityLaunched"</span>);</span><br><span class="line">            activity.runOnUiThread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    BuyingRequestPostSucceedModule <span class="keyword">module</span> = mock(BuyingRequestPostSucceedModule.class);</span><br><span class="line">                    when(<span class="keyword">module</span>.pickController()).thenReturn(mock(IBuyingRequestPostSucceedController.class));</span><br><span class="line">                    requestPostSucceedView = <span class="keyword">new</span> BuyingRequestPostSucceedView(activity, <span class="keyword">module</span>);</span><br><span class="line">                    activity.setContentView(requestPostSucceedView);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOnLoadSomeThings</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> SomeThings products = mock(SomeThings.class);</span><br><span class="line">        ArrayList&lt;SomeThing&gt; list = mock(ArrayList.class);</span><br><span class="line"></span><br><span class="line">        SomeThing product = mock(SomeThing.class);</span><br><span class="line"></span><br><span class="line">        when(list.get(anyInt())).thenReturn(product);</span><br><span class="line">        products.productList = list;</span><br><span class="line"></span><br><span class="line">        TestContainerActivity activity = mActivityTestRule.getActivity();</span><br><span class="line"></span><br><span class="line">        when(list.size()).thenReturn(<span class="number">1</span>);</span><br><span class="line">        when(list.isEmpty()).thenReturn(<span class="keyword">false</span>);</span><br><span class="line">        activity.runOnUiThread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                requestPostSucceedView.onLoadSomeThing(products);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        onView(withId(R.id.id_tips_you_may_also_like_tv)).check(matches(isDisplayed()));</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šä»£ç ï¼Œåœ¨<code>TestContainerActivity</code>å¯åŠ¨åï¼Œæ„é€ ä¸€ä¸ªmockäº†<code>Module</code>çš„å¾…æµ‹è¯•<code>View</code>ï¼Œå¹¶å¢åŠ åˆ°<code>Activity</code>çš„content viewä¸­ã€‚</p>
<h3 id="1-3-1-2-å¦‚æœ-Viewer-æ˜¯-Activity"><a href="#1-3-1-2-å¦‚æœ-Viewer-æ˜¯-Activity" class="headerlink" title="1.3.1.2 å¦‚æœ Viewer æ˜¯ Activity"></a>1.3.1.2 å¦‚æœ Viewer æ˜¯ Activity</h3><p>å¦‚æœ<code>Viewer</code>æ˜¯<code>Activity</code>ï¼Œç”±äºå®ƒæœ¬æ¥å°±æ˜¯Activityï¼Œæ‰€ä»¥å®ƒä¸éœ€è¦å€ŸåŠ©<code>TestContainerActivity</code>æ¥æµ‹è¯•ï¼›mock <code>module</code>æ—¶å°±ä¸èƒ½ä½¿ç”¨æ„é€ æ–¹æ³•çš„æ–¹å¼äº†ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä¸èƒ½ç›´æ¥å¯¹<code>Activity</code>è¿›è¡Œå®ä¾‹åŒ–çš„ï¼Œé‚£åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šåœ¨è°ƒç”¨<code>onCreate</code>æ–¹æ³•çš„æ—¶å€™å»è¿›è¡Œå¯¹ä¾èµ–çš„æ³¨å…¥ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨<code>XxxYyyZzz_Rapier</code>æ‰©å±•ç±»ï¼Œè€Œä¸”ï¼Œå¦‚æœè¿™ä¸ª<code>Activity</code>éœ€è¦åœ¨ä¸€å¯åŠ¨å°±å»è¿›è¡Œä¸€äº›æ•°æ®è¯·æ±‚ï¼Œæˆ‘ä»¬è¦æ‹¦æˆªæ‰è¿™ä¸ªè¯·æ±‚ï¼Œå› ä¸ºè¿™ä¸ªè¯·æ±‚è¿”å›çš„æ•°æ®å¯èƒ½ä¼šå¯¹æˆ‘ä»¬çš„UIæµ‹è¯•é€ æˆå¹²æ‰°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨<code>onCreate</code>åœ¨è¢«è°ƒç”¨ä¹‹å‰æŠŠ<code>module</code> mockæ‰ã€‚</p>
<p>é¦–å…ˆçœ‹test support ä¸­çš„ <code>ActivityTestRule</code>è¿™ä¸ªç±»ï¼Œå®ƒæä¾›äº†ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><p><code>getActivityIntent()</code>ï¼šè¿™ä¸ªæ–¹æ³•åªèƒ½åœ¨Intentä¸­å¢åŠ æºå¸¦çš„å‚æ•°ï¼Œæˆ‘ä»¬è¦mockçš„æ˜¯æ•´ä¸ª<code>Module</code>ï¼Œæ— æ³•åºåˆ—åŒ–ï¼Œæ‰€ä»¥ä¹Ÿæ— æ³•é€šè¿‡è¿™ä¸ªä¼ å…¥ã€‚</p>
</li>
<li><p><code>beforeActivityLaunched()</code>ï¼šè¿™ä¸ªæ–¹æ³•å›è°ƒæ—¶ï¼Œ<code>Activity</code>å®ä¾‹è¿˜æ²¡æœ‰ç”Ÿæˆï¼Œæ‰€ä»¥æ— æ³•æ‹¿åˆ°<code>Activity</code>å®ä¾‹ï¼Œå¹¶è¿›è¡Œ<code>Module</code>çš„æ›¿æ¢ã€‚</p>
</li>
<li><p><code>afterActivityFinished()</code>ï¼šè¿™ä¸ªæ–¹æ³•å°±æ›´ä¸å¯èƒ½äº†-.-</p>
</li>
<li><p><code>afterActivityLaunched()</code>ï¼šè¿™ä¸ªæ–¹æ³•çœ‹å®ƒçš„æºç ï¼ˆæ— å…³ä»£ç å·²çœç•¥ï¼‰ï¼š</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">launchActivity</span><span class="params">(@Nullable Intent startIntent)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        beforeActivityLaunched();</span><br><span class="line">        <span class="comment">// The following cast is correct because the activity we're creating is of the same type as</span></span><br><span class="line">        <span class="comment">// the one passed in</span></span><br><span class="line">        mActivity = mActivityClass.cast(mInstrumentation.startActivitySync(startIntent));</span><br><span class="line"></span><br><span class="line">        mInstrumentation.waitForIdleSync();</span><br><span class="line"></span><br><span class="line">        afterActivityLaunched();</span><br><span class="line">        <span class="keyword">return</span> mActivity;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šä»£ç ï¼Œ<code>afterActivityLaunched()</code>æ–¹æ³•æ˜¯åœ¨çœŸæ­£å¯åŠ¨<code>Activity</code>ï¼ˆ<code>mInstrumentation.startActivitySync(startIntent)</code>ï¼‰åè°ƒç”¨çš„ã€‚ä½†æ˜¯æ˜¾ç„¶è¿™ä¸ªæ–¹æ³•æ˜¯åŒæ­¥çš„ï¼Œä¹‹åå†è¿›å…¥æºç ï¼Œæ¥æŸ¥çœ‹å¯åŠ¨çš„æµç¨‹ï¼Œæ•´ä¸ªæµç¨‹æœ‰äº›å¤æ‚æˆ‘å°±ä¸èµ˜è¿°äº†ï¼Œå¯ä»¥æŸ¥çœ‹æˆ‘ä»¥å‰å†™çš„åˆ†æå¯åŠ¨æµç¨‹çš„åšå®¢ï¼ˆ<strong><a href="http://www.cnblogs.com/tiantianbyconan/p/5017056.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5017056.html</a></strong>ï¼‰ï¼Œæœ€åä¼šè°ƒç”¨<code>mInstrumentation.callActivityOnCreate(...)</code>ã€‚</p>
<p>ä½†æ˜¯å› ä¸ºæµ‹è¯•æ—¶ï¼Œå¯åŠ¨<code>Activity</code>çš„è¿‡ç¨‹ä¹Ÿæ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥æ˜¾ç„¶è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨<code>onCreate()</code>è¢«è°ƒç”¨åæ‰ä¼šè¢«å›è°ƒçš„ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿä¸è¡Œã€‚</p>
<p>æ—¢ç„¶è²Œä¼¼å·²ç»æ‰¾åˆ°äº†mockçš„æ­£ç¡®ä½ç½®ï¼Œé‚£å°±ç»§ç»­åˆ†æä¸‹å»ï¼š</p>
<p>è¿™é‡Œçš„<code>mInstrumentation</code>æ˜¯å“ªä¸ª<code>Instrumentation</code>å®ä¾‹å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å›åˆ°<code>ActivityTestRule</code>ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ActivityTestRule</span><span class="params">(Class&lt;T&gt; activityClass, <span class="keyword">boolean</span> initialTouchMode,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">boolean</span> launchActivity)</span> </span>&#123;</span><br><span class="line">        mActivityClass = activityClass;</span><br><span class="line">        mInitialTouchMode = initialTouchMode;</span><br><span class="line">        mLaunchActivity = launchActivity;</span><br><span class="line">        mInstrumentation = InstrumentationRegistry.getInstrumentation();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>ç»§ç»­è¿›å…¥<code>InstrumentationRegistry.getInstrumentation()</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Instrumentation <span class="title">getInstrumentation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Instrumentation instance = sInstrumentationRef.get();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"No instrumentation registered! "</span></span><br><span class="line">                    + <span class="string">"Must run under a registering instrumentation."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»§ç»­æŸ¥æ‰¾<code>sInstrumentationRef</code>æ˜¯åœ¨å“ªé‡Œ<code>set</code>è¿›å»çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">registerInstance</span><span class="params">(Instrumentation instrumentation, Bundle arguments)</span> </span>&#123;</span><br><span class="line">        sInstrumentationRef.set(instrumentation);</span><br><span class="line">        sArguments.set(<span class="keyword">new</span> Bundle(arguments));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»§ç»­æŸ¥æ‰¾è°ƒç”¨ï¼Œç»ˆäºåœ¨<code>MonitoringInstrumentation</code>ä¸­æ‰¾åˆ°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle arguments)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    InstrumentationRegistry.registerInstance(<span class="keyword">this</span>, arguments);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œæµ‹è¯•ä½¿ç”¨çš„<code>MonitoringInstrumentation</code>ï¼Œç„¶åè¿›å…¥<code>MonitoringInstrumentation</code>çš„<code>callActivityOnCreate()</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">callActivityOnCreate</span><span class="params">(Activity activity, Bundle bundle)</span> </span>&#123;</span><br><span class="line">        mLifecycleMonitor.signalLifecycleChange(Stage.PRE_ON_CREATE, activity);</span><br><span class="line">        <span class="keyword">super</span>.callActivityOnCreate(activity, bundle);</span><br><span class="line">        mLifecycleMonitor.signalLifecycleChange(Stage.CREATED, activity);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æ—¢ç„¶æˆ‘ä»¬éœ€è¦åœ¨<code>Activity</code>çœŸæ­£æ‰§è¡Œ<code>onCreate()</code>æ–¹æ³•æ—¶æ‹¦æˆªæ‰ï¼Œé‚£å¦‚ä¸Šä»£ç ï¼Œåªè¦å…³å¿ƒ<code>signalLifecycleChange()</code>æ–¹æ³•ï¼Œå‘ç°äº†<code>ActivityLifecycleCallback</code>çš„å›è°ƒï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">signalLifecycleChange</span><span class="params">(Stage stage, Activity activity)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	Iterator&lt;WeakReference&lt;ActivityLifecycleCallback&gt;&gt; refIter = mCallbacks.iterator();</span><br><span class="line">    <span class="keyword">while</span> (refIter.hasNext()) &#123;</span><br><span class="line">        ActivityLifecycleCallback callback = refIter.next().get();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == callback) &#123;</span><br><span class="line">            refIter.remove();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        		<span class="comment">// ...</span></span><br><span class="line">        		callback.onActivityLifecycleChanged(activity, stage);</span><br><span class="line">        		<span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œé—®é¢˜è§£å†³äº†ï¼Œæˆ‘ä»¬åªè¦æ·»åŠ ä¸€ä¸ª<code>Activity</code>ç”Ÿå‘½å‘¨æœŸå›è°ƒå°±æå®šäº†ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ActivityLifecycleMonitorRegistry.getInstance().addLifecycleCallback(<span class="keyword">new</span> ActivityLifecycleCallback() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityLifecycleChanged</span><span class="params">(Activity activity, Stage stage)</span> </span>&#123;</span><br><span class="line">        logger(<span class="string">"onActivityLifecycleChanged, activity"</span> + activity + <span class="string">", stage: "</span> + stage);</span><br><span class="line">        <span class="keyword">if</span>(activity <span class="keyword">instanceof</span> SomethingActivity &amp;&amp; Stage.PRE_ON_CREATE == stage)&#123;</span><br><span class="line">            logger(<span class="string">"onActivityLifecycleChanged, got it!!!"</span>);</span><br><span class="line">            ((SomethingActivity)activity).setModule(mock(SomethingModule.class));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼Œ<code>Activity</code>çš„ mock <code>module</code>æˆåŠŸäº†ã€‚</p>
<h3 id="1-3-2-é’ˆå¯¹-Presenter-è¿›è¡Œå•å…ƒæµ‹è¯•"><a href="#1-3-2-é’ˆå¯¹-Presenter-è¿›è¡Œå•å…ƒæµ‹è¯•" class="headerlink" title="1.3.2 é’ˆå¯¹ Presenter è¿›è¡Œå•å…ƒæµ‹è¯•"></a>1.3.2 é’ˆå¯¹ Presenter è¿›è¡Œå•å…ƒæµ‹è¯•</h3><h4 id="1-3-2-1-æµ‹è¯•ä¸-Android-SDK-åˆ†ç¦»"><a href="#1-3-2-1-æµ‹è¯•ä¸-Android-SDK-åˆ†ç¦»" class="headerlink" title="1.3.2.1 æµ‹è¯•ä¸ Android SDK åˆ†ç¦»"></a>1.3.2.1 æµ‹è¯•ä¸ Android SDK åˆ†ç¦»</h4><p><code>Presenter</code> çš„å•å…ƒæµ‹è¯•ä¸ <code>Viewer</code> ä¸ä¸€æ ·ï¼Œåœ¨<code>Presenter</code>ä¸­ä¸åº”è¯¥æœ‰<code>Android SDK</code>ç›¸å…³å­˜åœ¨ï¼Œæ‰€æœ‰çš„<code>Inteactor/Api</code>ç­‰éƒ½æ˜¯ä¸<code>Android</code>è§£è€¦çš„ã€‚æ˜¾ç„¶æ›´åŠ ä¸èƒ½æœ‰<code>TextView</code>ç­‰å­˜åœ¨ã€‚æ­£æ˜¯å› ä¸ºè¿™ä¸ªï¼Œä½¿å¾—å®ƒå¯ä»¥åŸºäºPCä¸Šçš„JVMæ¥è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>Presenter</code>æµ‹è¯•ä¸éœ€è¦Androidç¯å¢ƒï¼Œçœå»äº†å®‰è£…åˆ°æ‰‹æœºæˆ–è€…æ¨¡æ‹Ÿå™¨çš„æ­¥éª¤ã€‚</p>
<p>æ€ä¹ˆå»é¿å…<code>Anroid</code>ç›¸å…³çš„SDKåœ¨<code>Presenter</code>ä¸­å­˜åœ¨ï¼Ÿ</p>
<p>çš„ç¡®æœ‰æä¸ªåˆ«çš„SDKå¾ˆéš¾é¿å…ï¼Œæ¯”å¦‚<code>Log</code>ã€‚</p>
<h5 id="1-3-2-1-1-ä½¿ç”¨-XLog-ä¸-Log-åˆ†ç¦»"><a href="#1-3-2-1-1-ä½¿ç”¨-XLog-ä¸-Log-åˆ†ç¦»" class="headerlink" title="1.3.2.1.1 ä½¿ç”¨ XLog ä¸ Log åˆ†ç¦»"></a>1.3.2.1.1 ä½¿ç”¨ XLog ä¸ Log åˆ†ç¦»</h5><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª<code>XLog</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XLog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> IXLog delegate;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> DEBUG = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setDebug</span><span class="params">(<span class="keyword">boolean</span> debug)</span> </span>&#123;</span><br><span class="line">        XLog.DEBUG = debug;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">setDelegate</span><span class="params">(IXLog delegate)</span> </span>&#123;</span><br><span class="line">        XLog.delegate = delegate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">v</span><span class="params">(String tag, String msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (DEBUG &amp;&amp; <span class="keyword">null</span> != delegate) &#123;</span><br><span class="line">            delegate.v(tag, msg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">v</span><span class="params">(String tag, String msg, Throwable tr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (DEBUG &amp;&amp; <span class="keyword">null</span> != delegate) &#123;</span><br><span class="line">            delegate.v(tag, msg, tr);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">d</span><span class="params">(String tag, String msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (DEBUG &amp;&amp; <span class="keyword">null</span> != delegate) &#123;</span><br><span class="line">            delegate.d(tag, msg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>åœ¨Androidç¯å¢ƒä¸­ä½¿ç”¨çš„ç­–ç•¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XLog.setDelegate(<span class="keyword">new</span> XLogDef());</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>XLogDef</code>ç±»ä¸­çš„å®ç°ä¸ºåŸç”ŸAndrod SDKçš„Logå®ç°ã€‚</p>
<p>åœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨çš„ç­–ç•¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">logDelegateSpy = Mockito.spy(<span class="keyword">new</span> XLogJavaTest());</span><br><span class="line">XLog.setDelegate(logDelegateSpy);</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­<code>XLogJavaTest</code>ä½¿ç”¨çš„æ˜¯çº¯Javaçš„<code>System.out.println()</code></p>
<h4 id="1-3-2-2-å¼‚æ­¥æ“ä½œåŒæ­¥åŒ–"><a href="#1-3-2-2-å¼‚æ­¥æ“ä½œåŒæ­¥åŒ–" class="headerlink" title="1.3.2.2 å¼‚æ­¥æ“ä½œåŒæ­¥åŒ–"></a>1.3.2.2 å¼‚æ­¥æ“ä½œåŒæ­¥åŒ–</h4><p>å› ä¸º<code>Presenter</code>ä¸­ä¼šæœ‰å¾ˆå¤šçš„å¼‚æ­¥ä»»åŠ¡å­˜åœ¨ï¼Œä½†æ˜¯åœ¨ç»†ç²’åº¦çš„å•å…ƒæµ‹è¯•ä¸­ï¼Œæ²¡æœ‰å¼‚æ­¥ä»»åŠ¡å­˜åœ¨çš„å¿…è¦æ€§ï¼Œç›¸åº”åè€Œå¢åŠ äº†æµ‹è¯•å¤æ‚åº¦ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠæ‰€æœ‰å¼‚æ­¥ä»»åŠ¡åˆ‡æ¢æˆåŒæ­¥æ“ä½œã€‚</p>
<p>è°ƒåº¦çš„åˆ‡æ¢ä½¿ç”¨çš„æ˜¯<code>RxJava</code>ï¼Œæ‰€ä»¥æ‰€æœ‰åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹ä¹Ÿæ˜¯ä½¿ç”¨äº†<code>Android SDK</code>ã€‚è¿™é‡Œä¹Ÿè¦é‡‡ç”¨ç­–ç•¥è¿›è¡Œå¤„ç†ã€‚</p>
<p>é¦–å…ˆå®šä¹‰äº†å‡ ç§ä¸åŒçš„<code>ScheduleType</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SchedulerType</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAIN = <span class="number">0x3783</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NET = <span class="number">0x8739</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DB = <span class="number">0x1385</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>Schedule</code>é€‰æ‹©å™¨ä¸­æ ¹æ®<code>ScheduleType</code>è¿›è¡Œå¯¹åº”ç±»å‹çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">SchedulerSelector schedulerSelector = SchedulerSelector.get();</span><br><span class="line"></span><br><span class="line">schedulerSelector.putScheduler(SchedulerType.MAIN, <span class="keyword">new</span> SchedulerSelector.SchedulerCreation&lt;Scheduler&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Scheduler <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> AndroidSchedulers.mainThread();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">schedulerSelector.putScheduler(SchedulerType.NET, <span class="keyword">new</span> SchedulerSelector.SchedulerCreation&lt;Scheduler&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Scheduler <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Schedulers.from(THREAD_POOL_EXECUTOR_NETWORK);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">schedulerSelector.putScheduler(SchedulerType.DB, <span class="keyword">new</span> SchedulerSelector.SchedulerCreation&lt;Scheduler&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Scheduler <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Schedulers.from(THREAD_POOL_EXECUTOR_DATABASE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>å½“æµ‹è¯•æ—¶ï¼Œå¯¹è°ƒåº¦é€‰æ‹©å™¨ä¸­çš„ä¸åŒç±»å‹çš„å®ç°è¿›è¡Œå¦‚ä¸‹æ›¿æ¢ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SchedulerSelector.get().putScheduler(SchedulerType.NET, <span class="keyword">new</span> SchedulerSelector.SchedulerCreation&lt;Scheduler&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Scheduler <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Schedulers.immediate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">SchedulerSelector.get().putScheduler(SchedulerType.MAIN, <span class="keyword">new</span> SchedulerSelector.SchedulerCreation&lt;Scheduler&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Scheduler <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Schedulers.immediate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>æŠŠæ‰€æœ‰è°ƒåº¦éƒ½æ”¹æˆå½“å‰çº¿ç¨‹æ‰§è¡Œå³å¯ã€‚</p>
<p>æœ€å<code>Presenter</code>æµ‹è¯•å‡ ä¸ªèŒƒä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mock</span></span><br><span class="line">    AccountContract.IAccountViewer viewer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mock</span></span><br><span class="line">    UserInteractor userInteractor;</span><br><span class="line"></span><br><span class="line">    AccountPresenter presenter;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        MockitoAnnotations.initMocks(<span class="keyword">this</span>);</span><br><span class="line">        presenter = <span class="keyword">new</span> AccountPresenter(viewer);</span><br><span class="line">        presenter.userInteractor = userInteractor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestEditUserInfo</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// case 1, succeed</span></span><br><span class="line">        reset(viewer);</span><br><span class="line">        resetLog();</span><br><span class="line"></span><br><span class="line">        when(userInteractor.requestEditUserInfo(any(User.class))).thenReturn(Observable.just(anyBoolean()));</span><br><span class="line">        presenter.requestEditUserInfo(<span class="keyword">new</span> User());</span><br><span class="line"></span><br><span class="line">        verifyOnce(viewer).onRequestEditUserInfo();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// case 2, null</span></span><br><span class="line">        reset(viewer);</span><br><span class="line">        resetLog();</span><br><span class="line">        when(userInteractor.requestEditUserInfo(any(User.class))).thenReturn(Observable.just(<span class="keyword">null</span>));</span><br><span class="line">        presenter.requestEditUserInfo(<span class="keyword">new</span> User());</span><br><span class="line"></span><br><span class="line">        verifyOnce(viewer).onRequestEditUserInfo();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// case 3, error</span></span><br><span class="line">        assertFailedAndError(() -&gt; userInteractor.requestEditUserInfo(any(User.class)), () -&gt; presenter.requestEditUserInfo(<span class="keyword">new</span> User()));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SBuyingRequestPostSucceedViewPresenterTest</span> <span class="keyword">extends</span> <span class="title">BaseJavaTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mock</span></span><br><span class="line">    <span class="keyword">public</span> IBuyingRequestPostSucceedView viewer;</span><br><span class="line">    <span class="meta">@Mock</span></span><br><span class="line">    <span class="keyword">public</span> BuyingRequestPostSucceedPresenterModule <span class="keyword">module</span>;</span><br><span class="line">    <span class="meta">@Mock</span></span><br><span class="line">    <span class="keyword">public</span> ApiSearcher apiSearcher;</span><br><span class="line">    <span class="keyword">public</span> IBuyingRequestPostSucceedPresenter presenter;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        MockitoAnnotations.initMocks(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        when(<span class="keyword">module</span>.pickApiSearcher()).thenReturn(apiSearcher);</span><br><span class="line">        presenter = <span class="keyword">new</span> BuyingRequestPostSucceedPresenter(viewer, <span class="keyword">module</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLoadSomethingSuccess</span><span class="params">()</span> <span class="keyword">throws</span> TimeoutException </span>&#123;</span><br><span class="line">        <span class="comment">// Mock success observable</span></span><br><span class="line">        when(apiSearcher.searcherSomething(anyString(), anyString(), anyString()))</span><br><span class="line">                .thenReturn(Observable.create(<span class="keyword">new</span> Observable.OnSubscribe&lt;OceanServerResponse&lt;Something&gt;&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber&lt;? <span class="keyword">super</span> OceanServerResponse&lt;Something&gt;&gt; subscriber)</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            OceanServerResponse&lt;Something&gt; oceanServerResponse = mock(OceanServerResponse.class);</span><br><span class="line">                            when(oceanServerResponse.getBody(any(Class.class))).thenReturn(mock(Something.class));</span><br><span class="line">                            subscriber.onNext(oceanServerResponse);</span><br><span class="line">                            subscriber.onCompleted();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">                            subscriber.onError(throwable);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;I</span><br><span class="line">                &#125;));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> ExecuteStuff executeStuff = <span class="keyword">new</span> ExecuteStuff();</span><br><span class="line">        Answer succeedAnswer = <span class="keyword">new</span> Answer() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">answer</span><span class="params">(InvocationOnMock invocationOnMock)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                loggerMockAnswer(invocationOnMock);</span><br><span class="line">                executeStuff.setSucceed(<span class="keyword">true</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        doAnswer(succeedAnswer).when(viewer).onLoadSomething(Matchers.any(Something.class));</span><br><span class="line"></span><br><span class="line">        presenter.loadSomething(<span class="string">"whatever"</span>, <span class="string">"whatever"</span>);</span><br><span class="line"></span><br><span class="line">        logger(<span class="string">"loadSomething result: "</span> + executeStuff.isSucceed());</span><br><span class="line">        Assert.assertTrue(<span class="string">"testLoadSomethingSuccess result true"</span>, executeStuff.isSucceed());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLoadSomethingFailed</span><span class="params">()</span> <span class="keyword">throws</span> TimeoutException </span>&#123;</span><br><span class="line">        <span class="comment">// Mock error observable</span></span><br><span class="line">        when(apiSearcher.searcherRFQInterestedProductsSuggestion(anyString(), anyString(), anyString()))</span><br><span class="line">                .thenReturn(Observable.&lt;OceanServerResponse&lt;Something&gt;&gt;error(<span class="keyword">new</span> RuntimeException(<span class="string">"mock error observable"</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> ExecuteStuff executeStuff = <span class="keyword">new</span> ExecuteStuff();</span><br><span class="line">        Answer failedAnswer = <span class="keyword">new</span> Answer() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">answer</span><span class="params">(InvocationOnMock invocationOnMock)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                loggerMockAnswer(invocationOnMock);</span><br><span class="line">                executeStuff.setSucceed(<span class="keyword">false</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        doAnswerWhenLogError(failedAnswer);</span><br><span class="line"></span><br><span class="line">        presenter.loadSomething(<span class="string">"whatever"</span>, <span class="string">"whatever"</span>);</span><br><span class="line"></span><br><span class="line">        logger(<span class="string">"testLoadSomethingFailed result: "</span> + executeStuff.isSucceed());</span><br><span class="line">        Assert.assertFalse(<span class="string">"testLoadSomethingFailed result false"</span>, executeStuff.isSucceed());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> dependency injection </tag>
            
            <tag> mvp </tag>
            
            <tag> mvc </tag>
            
            <tag> framework </tag>
            
            <tag> unit test </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä¸€ä¸ªå¹²å‡€çš„æ¶æ„ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2016/03/14/Android-%E4%B8%80%E4%B8%AA%E5%B9%B2%E5%87%80%E7%9A%84%E6%9E%B6%E6%9E%84%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="ä¸€ä¸ªå¹²å‡€çš„æ¶æ„"><a href="#ä¸€ä¸ªå¹²å‡€çš„æ¶æ„" class="headerlink" title="ä¸€ä¸ªå¹²å‡€çš„æ¶æ„"></a>ä¸€ä¸ªå¹²å‡€çš„æ¶æ„</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="https://blog.8thlight.com/uncle-bob/2012/08/13/the-clean-architecture.html" target="_blank" rel="noopener">https://blog.8thlight.com/uncle-bob/2012/08/13/the-clean-architecture.html</a></p>
</blockquote>
<p><img src="https://blog.8thlight.com/assets/posts/2012-08-13-the-clean-architecture/CleanArchitecture-81565aba46f035911a5018e77a0f2d4e.jpg" alt=""></p>
<p>åœ¨è¿‡å»å‡ å¹´ä¸­æˆ‘ä»¬èƒ½çœ‹åˆ°çš„ä¸€ç³»åˆ—å…³äºç³»ç»Ÿæ¶æ„çš„æ€æƒ³ã€‚å®ƒä»¬åŒ…æ‹¬ï¼š</p>
<ul>
<li><p><a href="http://alistair.cockburn.us/Hexagonal+architecture" target="_blank" rel="noopener">Hexagonal Architecture</a>ï¼ˆä¹Ÿç§°ä¸º<code>Ports and Adapters</code>ï¼‰ï¼Œä½œè€…æ˜¯ Alistair Cockburnï¼Œå¹¶è¢« Steve Freeman å’Œ Nat Pryce åœ¨ä»–ä»¬å¾ˆæ£’çš„ <a href="http://www.amazon.com/Growing-Object-Oriented-Software-Guided-Tests/dp/0321503627" target="_blank" rel="noopener">Growing Object Oriented Software</a> è¿™æœ¬ä¹¦ä¸­é‡‡ç”¨ã€‚</p>
</li>
<li><p><a href="http://jeffreypalermo.com/blog/the-onion-architecture-part-1/" target="_blank" rel="noopener">Onion Architecture</a>ï¼Œä½œè€…æ˜¯ Jeffrey Palermoã€‚</p>
</li>
<li><p><a href="http://blog.8thlight.com/uncle-bob/2011/09/30/Screaming-Architecture.html" target="_blank" rel="noopener">Screaming Architecture</a>ï¼Œæ¥è‡ªæˆ‘å»å¹´å†™çš„ä¸€ç¯‡åšå®¢ã€‚</p>
</li>
<li><p><a href="http://www.amazon.com/Lean-Architecture-Agile-Software-Development/dp/0470684208/" target="_blank" rel="noopener">DCI</a>ï¼Œæ¥è‡ª James Coplien å’Œ Trygve Reenskaugã€‚</p>
</li>
<li><p><a href="http://www.amazon.com/Object-Oriented-Software-Engineering-Approach/dp/0201544350" target="_blank" rel="noopener">BCE</a>ï¼Œæ¥è‡ª Ivar Jacobson çš„ä¸€æœ¬ä¹¦ <em>Object Oriented Software Engineering: A Use-Case Driven Approach</em></p>
</li>
</ul>
<p>å°½ç®¡è¿™äº›ä¹¦åœ¨ç»†èŠ‚ä¸Šæœ‰äº›ä¸åŒä¹‹å¤„ï¼Œä½†æ˜¯å®ƒä»¬æ˜¯éå¸¸ç›¸ä¼¼çš„ã€‚ä»åˆ†ç¦»çš„è§‚ç‚¹ä¸Šæ¥è®²å®ƒä»¬éƒ½æœ‰ç€åŒæ ·çš„ç›®æ ‡ã€‚å®ƒä»¬éƒ½æ˜¯é€šè¿‡è½¯ä»¶åˆ†å±‚æ¥å®ç°åˆ†ç¦»çš„ã€‚æ¯ä¸€ä¸ªéƒ½è‡³å°‘æœ‰ä¸€å±‚æ˜¯ç”¨äºä¸šåŠ¡è§„åˆ™ï¼Œå¦å¤–ä¸€å±‚ç”¨äºæ¥å£ã€‚</p>
<p>è¿™äº›æ¶æ„ç”Ÿäº§ç³»ç»Ÿï¼š</p>
<p>1. <strong>æ¡†æ¶ç‹¬ç«‹æ€§</strong>ã€‚æ¶æ„å¹¶ä¸ä¾èµ–äºå·²ç»å­˜åœ¨çš„æŸäº›åº“çš„æœ‰è´Ÿè½½çš„ç‰¹æ€§ã€‚è¿™å…è®¸ä½ ä½œä¸ºå·¥å…·å»ä½¿ç”¨æ¡†æ¶ï¼Œè€Œä¸æ˜¯æŠŠä½ çš„ç³»ç»Ÿå¼ºå¡åˆ°é™åˆ¶å’Œçº¦æŸä¸­ã€‚</p>
<p>2. <strong>å¯æµ‹è¯•æ€§</strong>ã€‚ä¸šåŠ¡è§„åˆ™å¯ä»¥è„±ç¦»UIã€æ•°æ®åº“ã€webæœåŠ¡å™¨å’Œå…¶å®ƒå¤–éƒ¨å…ƒç´ å»è¿›è¡Œæµ‹è¯•ã€‚</p>
<p>3. <strong>UIçš„ç‹¬ç«‹æ€§</strong>ã€‚UIå¯ä»¥åœ¨ä¸ä¿®æ”¹ç³»ç»Ÿå…¶å®ƒåœ°æ–¹çš„æƒ…å†µä¸‹å¾ˆå®¹æ˜“åœ°è¢«æ”¹å˜ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªWeb UIå¯ä»¥ä½¿ç”¨console UIæ›¿æ¢ï¼Œè€Œä¸æ”¹å˜ä»»ä½•ä¸šåŠ¡è§„åˆ™ã€‚</p>
<p>4. <strong>æ•°æ®åº“ç‹¬ç«‹</strong>ã€‚ä½ å¯ä»¥ä½¿ç”¨Mongoã€BitTableã€CouchDBæˆ–è€…å…¶å®ƒæ¥ç½®æ¢Oracleæˆ–SQL Serverã€‚ä½ çš„ä¸šåŠ¡è§„åˆ™ä¸ä¼šè¢«æ•°æ®åº“æŸç¼šã€‚</p>
<p>5. <strong>å¤–éƒ¨ä»£ç†çš„ç‹¬ç«‹æ€§</strong>ã€‚äº‹å®ä¸Šï¼Œä½ çš„ä¸šåŠ¡è§„åˆ™æ ¹æœ¬ä¸çŸ¥é“å¤–é¢çš„ä¸–ç•Œã€‚</p>
<p>è¿™ç¯‡æ–‡ç« é¡¶éƒ¨çš„å›¾è¡¨å°±æ˜¯å°è¯•æ‰€æœ‰è¿™äº›ç»“æ„åˆ°å•ä¸ªå¯æ“ä½œçš„æ€æƒ³ä¸­å»ã€‚</p>
<h2 id="ä¾èµ–å‡†åˆ™"><a href="#ä¾èµ–å‡†åˆ™" class="headerlink" title="ä¾èµ–å‡†åˆ™"></a>ä¾èµ–å‡†åˆ™</h2><p>åŒå¿ƒåœ†è¡¨ç¤ºä¸åŒè½¯ä»¶çš„åŒºåŸŸã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œèµ°å¾—è¶Šè¿œï¼Œè½¯ä»¶æ°´å¹³ä¹Ÿä¼šå˜å¾—è¶Šé«˜ã€‚å¤–é¢çš„åœ†æ˜¯æœºåˆ¶ï¼Œè€Œå†…éƒ¨çš„åœ†æ˜¯æ”¿ç­–ã€‚</p>
<p>ä½¿å¾—è¿™ä¸ªæ¶æ„å¯è¡Œçš„æœ€é‡è¦çš„è§„åˆ™æ˜¯ <em>ä¾èµ–å‡†åˆ™</em> ã€‚è¿™ä¸ªå‡†åˆ™æŒ‡ <em>ä»£ç çš„ä¾èµ–</em> åªèƒ½ <em>å‘å†…</em> ã€‚æ²¡æœ‰ä¸€ä¸ªå†…éƒ¨åœ†å¯ä»¥çŸ¥é“å¤–éƒ¨åœ†çš„ä»»ä½•ä¸œè¥¿ã€‚å°¤å…¶æ˜¯åœ¨å†…éƒ¨åœ†å£°æ˜çš„ä¸œè¥¿åå­—ä¸èƒ½è¢«å†…éƒ¨åœ†ä¸­çš„ä»£ç æåˆ°ã€‚è¿™é‡ŒåŒ…æ‹¬æ–¹æ³•ã€ç±»ã€å˜é‡ã€æˆ–è€…å…¶å®ƒè½¯ä»¶å®ä½“çš„åå­—ã€‚</p>
<p>åŒæ ·çš„åŸå› ï¼Œå¤–éƒ¨åœ†ä¸­ç”¨åˆ°çš„æ•°æ®æ ¼å¼ä¸èƒ½è¢«å†…éƒ¨åœ†ä½¿ç”¨ï¼Œå°¤å…¶æ˜¯è¿™äº›æ ¼å¼æ˜¯è¢«å¤–éƒ¨åœ†ä¸­çš„æ¡†æ¶ç”Ÿæˆçš„ã€‚æˆ‘ä»¬ä¸å¸Œæœ›ä»»ä½•åœ¨å¤–éƒ¨åœ†ä¸­çš„ä¸œè¥¿å½±å“åˆ°å†…éƒ¨åœ†ã€‚</p>
<h3 id="Entities"><a href="#Entities" class="headerlink" title="Entities"></a><em>Entities</em></h3><p>å®ä½“å°è£…äº† <em>ä¼ä¸šçº§</em> ä¸šåŠ¡è§„åˆ™ã€‚ä¸€ä¸ªå®ä½“å¯ä»¥æ˜¯ä¸€ä¸ªæœ‰æ–¹æ³•çš„å¯¹è±¡ï¼Œæˆ–è€…æœ‰ä¸€ç³»åˆ—çš„æ•°æ®ç»“æ„å’Œå‡½æ•°ã€‚åªè¦è¿™ä¸ªå®ä½“å¯ä»¥è¢«å¾ˆå¤šä¸åŒä¼ä¸šä¸­çš„åº”ç”¨ä½¿ç”¨å°±æ²¡å…³ç³»ã€‚</p>
<p>å¦‚æœä½ æ²¡æœ‰ä¸€ä¸ªä¼ä¸šï¼Œå¹¶ä¸”åªæ˜¯ç¼–å†™å•ä¸ªçš„åº”ç”¨ç¨‹åºï¼Œé‚£ä¹ˆè¿™äº›å®ä½“å°±æ˜¯åº”ç”¨ç¨‹åºä¸­çš„ä¸šåŠ¡å¯¹è±¡ã€‚å®ƒå°è£…äº†å¤§éƒ¨åˆ†ä¸€èˆ¬çš„å’Œé«˜çº§åˆ«çš„è§„åˆ™ã€‚å®ƒä»¬æœ€ä¸å¯èƒ½åœ¨å¤–éƒ¨æ”¹å˜çš„æ—¶å€™è¢«æ”¹å˜ã€‚æ¯”å¦‚ï¼Œç”±äºå®‰å…¨ä½ ä¸å¸Œæœ›è¿™äº›å¯¹è±¡è¢«å¯¼èˆªé¡µé¢æ”¹å˜è€Œå½±å“ã€‚æ²¡æœ‰ç‰¹åˆ«çš„å¯æ“ä½œçš„æ”¹å˜å¯ä»¥å½±å“å®ä½“å±‚ã€‚</p>
<h2 id="ç”¨ä¾‹"><a href="#ç”¨ä¾‹" class="headerlink" title="ç”¨ä¾‹"></a>ç”¨ä¾‹</h2><p>è½¯ä»¶åœ¨è¿™ä¸€å±‚åŒ…å«åº”ç”¨ç¨‹åºæŒ‡å®šçš„ä¸šåŠ¡è§„åˆ™ã€‚å®ƒå°è£…å’Œå®ç°äº†è¿™ä¸ªç³»ç»Ÿçš„æ‰€æœ‰ç”¨ä¾‹ã€‚è¿™äº›ç”¨ä¾‹è½¬åŒ–æ•°æ®æµåˆ°å®ä½“å’Œä»å®ä½“è½¬åŒ–åˆ°æ•°æ®æµï¼Œç„¶åè¿™äº›å®ä½“ç›´æ¥ä½¿ç”¨å®ƒä»¬ä¼ä¸šèŒƒå›´çš„ä¸šåŠ¡è§„åˆ™æ¥è¾¾åˆ°ç”¨ä¾‹çš„ç›®çš„ã€‚</p>
<p>æˆ‘ä»¬ä¸æœŸæœ›æ”¹å˜è¿™ä¸€å±‚æ¥å½±å“åˆ°å®ä½“ã€‚æˆ‘ä»¬ä¹Ÿä¸å¸Œæœ›è¿™ä¸€å±‚è¢«å¤–éƒ¨çš„æ”¹å˜ï¼Œæ¯”å¦‚æ•°æ®åº“ã€UIã€ä»»ä½•å¸¸è§çš„æ¡†æ¶ç­‰å½±å“ã€‚åœ¨è¿™ä¸€å±‚åœ¨è¿™çš„è§‚ç‚¹ä¸Šæ˜¯è¢«å­¤ç«‹çš„ã€‚</p>
<p>ç„¶è€Œï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯å¸Œæœ›åº”ç”¨ç¨‹åºæ“ä½œçš„æ”¹å˜ä¼šå½±å“åˆ°è½¯ä»¶çš„ç”¨ä¾‹ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯åœ¨è¿™ä¸€å±‚ã€‚å¦‚æœç”¨ä¾‹çš„ç»†èŠ‚æ”¹å˜äº†ï¼Œé‚£ä¹ˆè¿™ä¸€å±‚çš„æŸäº›ä»£ç å½“ç„¶ä¹Ÿä¼šå—åˆ°å½±å“ã€‚</p>
<h2 id="æ¥å£é€‚é…å™¨"><a href="#æ¥å£é€‚é…å™¨" class="headerlink" title="æ¥å£é€‚é…å™¨"></a>æ¥å£é€‚é…å™¨</h2><p>åœ¨è½¯ä»¶çš„è¿™ä¸€å±‚æ˜¯ä¸€ç³»åˆ—çš„é€‚é…å™¨ï¼Œé€šè¿‡æœ€æ–¹ä¾¿çš„ç”¨ä¾‹å’Œå®ä½“è½¬æ¢æ•°æ®æ ¼å¼ï¼Œæœ€æ–¹ä¾¿çš„å¤–éƒ¨ä»£ç†æ ¼å¼æœ‰æ•°æ®åº“æˆ–è€…Webç­‰ã€‚åœ¨è¿™ä¸€å±‚ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå°†ä¼šå®Œæ•´åŒ…å« GUI çš„ MVC æ¶æ„ã€‚Presentersã€Viewsã€ Controllers éƒ½å±äºè¿™é‡Œã€‚Modelsæœ‰å¯èƒ½ä»…ä»…æ˜¯æ•°æ®ç»“æ„ï¼Œå®ƒä»¬ä» contrllers è¢«ä¼ å…¥åˆ°ç”¨ä¾‹ä¸­ï¼Œç„¶åä»ç”¨ä¾‹åˆ° presenters å’Œ viewsã€‚</p>
<p>åŒæ ·çš„ï¼Œåœ¨è¿™ä¸€å±‚ï¼Œæ•°æ®ä¼šè¢«è½¬æ¢ï¼Œä»æœ€æ–¹ä¾¿çš„æ–¹å¼å¦‚å®ä½“å’Œç”¨ä¾‹ï¼Œè½¬æ¢åˆ°ä½¿ç”¨çš„ç”¨äºæŒä¹…æ¡†æ¶çš„æœ€æ–¹ä¾¿çš„æ–¹å¼ï¼Œå³æ•°æ®åº“ã€‚<br>è¿™ä¸ªåœ†ä¸­æ²¡æœ‰ä»£ç å¯ä»¥å‘å†…çŸ¥é“ä»»ä½•å…³äºæ•°æ®åº“çš„ä¸œè¥¿ã€‚å¦‚æœæ•°æ®åº“æ˜¯ä¸€ä¸ª SQL databaseï¼Œé‚£ä¹ˆæ‰€æœ‰ SQL åº”è¯¥åœ¨è¿™ä¸€å±‚è¢«é™åˆ¶ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿™ä¸€å±‚éœ€è¦è¿›è¡Œæ•°æ®åº“æ“ä½œçš„éƒ¨åˆ†ã€‚</p>
<p>åœ¨è¿™ä¸€å±‚ä¹Ÿæœ‰å¿…è¦ä»ä¸€äº›å¤–éƒ¨å½¢å¼å»è½¬æ¢æ•°æ®ï¼Œæ¯”å¦‚ä¸€ä¸ªå¤–éƒ¨æœåŠ¡ï¼Œè½¬åŒ–ä¸ºå†…éƒ¨ç”¨ä¾‹å’Œå®ä½“ä½¿ç”¨çš„å½¢å¼ã€‚</p>
<h2 id="æ¡†æ¶å’Œé©±åŠ¨"><a href="#æ¡†æ¶å’Œé©±åŠ¨" class="headerlink" title="æ¡†æ¶å’Œé©±åŠ¨"></a>æ¡†æ¶å’Œé©±åŠ¨</h2><p>æœ€å¤–å±‚é€šå¸¸æ˜¯æ¡†æ¶å’Œå·¥å…·ï¼Œé€šå¸¸æ˜¯æ•°æ®åº“ã€Web æ¡†æ¶ç­‰çš„ç»„åˆã€‚é€šå¸¸ä½ ä¸éœ€è¦åœ¨è¿™ä¸€å±‚ç¼–å†™å¤ªå¤šçš„ä»£ç ï¼Œé™¤äº†ä¸€äº›ç”¨äºå‘å†…åœˆè¿›è¡Œé€šä¿¡çš„å›ºå®šä»£ç ã€‚</p>
<p>è¿™ä¸€å±‚æ˜¯æ‰€æœ‰ç»†èŠ‚èµ°å‘çš„åœ°æ–¹ã€‚Webæ˜¯ä¸€ä¸ªç»†èŠ‚ã€‚æ•°æ®åº“æ˜¯ä¸€ä¸ªç»†èŠ‚ã€‚æˆ‘ä»¬æŠŠè¿™äº›ä¸œè¥¿æ”¾ç½®åœ¨å¤–éƒ¨ï¼Œè¿™æ ·å®ƒä»¬å°±éš¾ä»¥é€ æˆä¼¤å®³ã€‚</p>
<h2 id="åªæœ‰å››ä¸ªåœ†ï¼Ÿ"><a href="#åªæœ‰å››ä¸ªåœ†ï¼Ÿ" class="headerlink" title="åªæœ‰å››ä¸ªåœ†ï¼Ÿ"></a>åªæœ‰å››ä¸ªåœ†ï¼Ÿ</h2><p>ä¸ï¼Œè¿™äº›åœ†åªæ˜¯ç®€å›¾ã€‚ä½ å¯èƒ½ä¼šéœ€è¦å¤šäºè¿™å››ä¸ªåœ†ã€‚è¿™é‡Œå¹¶æ²¡æœ‰ä¸€ä¸ªè§„åˆ™æ¥è®©ä½ å¿…é¡»è¦ä½¿ç”¨è¿™å››ä¸ªåœ†ã€‚ç„¶è€Œï¼Œ<em>ä¾èµ–è§„åˆ™</em> æ€»æ˜¯é€‚ç”¨çš„ã€‚ä»£ç ä¾èµ–æ€»æ˜¯æŒ‡å‘å†…éƒ¨ã€‚å½“ä½ å‘å†…ç§»åŠ¨æ—¶ï¼ŒæŠ½è±¡çº§åˆ«å¢åŠ ã€‚æœ€å¤–å±‚çš„åœ†æ˜¯æœ€ä½çº§åˆ«çš„å…·ä½“ç»†èŠ‚ã€‚å½“ä½ å‘å†…ç§»åŠ¨ï¼Œå°±ä¼šå˜å¾—æ›´åŠ æŠ½è±¡å’Œæ›´é«˜çº§åˆ«ç­–ç•¥çš„å°è£…ã€‚æœ€å†…éƒ¨çš„åœ†æ˜¯æœ€é€šç”¨çš„ã€‚</p>
<h2 id="è·¨è¶Šè¾¹ç•Œ"><a href="#è·¨è¶Šè¾¹ç•Œ" class="headerlink" title="è·¨è¶Šè¾¹ç•Œ"></a>è·¨è¶Šè¾¹ç•Œ</h2><p>å³ä¸‹æ–¹çš„å›¾æ˜¯ä¸€ä¸ªæˆ‘ä»¬æ€ä¹ˆå»è·¨è¶Šåœ†çš„è¾¹ç•Œçš„ä¾‹å­ã€‚å®ƒå±•ç¤ºäº† Controllers å’Œ Presenters é€šè¿‡ä¸‹ä¸€å±‚ä½¿ç”¨ç”¨ä¾‹è¿›è¡Œé€šä¿¡ã€‚æ³¨æ„æ§åˆ¶æµã€‚å®ƒåœ¨controllerä¸­å¼€å§‹ï¼Œé€šè¿‡ç”¨ä¾‹ï¼Œç„¶åå†Presenterä¸­æ‰§è¡Œã€‚ä¹Ÿè¦æ³¨æ„ä»£ç çš„ä¾èµ–ã€‚å®ƒä»¬æ¯ä¸€ä¸ªéƒ½æ˜¯å‘å†…æŒ‡å‘ç”¨ä¾‹ã€‚</p>
<p>æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ <a href="http://en.wikipedia.org/wiki/Dependency_inversion_principle" target="_blank" rel="noopener">ä¾èµ–åè½¬å‡†åˆ™</a> æ¥è§£å†³è¿™ä¸ªæ˜æ˜¾çš„çŸ›ç›¾ã€‚åœ¨åƒJavaçš„è¯­è¨€ä¸­ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†interfaceså’Œç»§æ‰¿å…³ç³»ï¼Œè¿™æ ·ä»£ç ä¾èµ–å…³ç³»æ§åˆ¶æƒè¢«åè½¬ï¼Œè¾¾åˆ°è·¨è¶Šè¾¹ç•Œçš„ç›®çš„ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œè€ƒè™‘åˆ°ç”¨ä¾‹éœ€è¦è°ƒç”¨Presenterã€‚ç„¶è€Œï¼Œè¿™äº›è°ƒç”¨å¿…é¡»ä¸èƒ½æ˜¯ç›´æ¥çš„ï¼Œå› ä¸ºå®ƒä¼šè¿å<em>ä¾èµ–å‡†åˆ™</em>ï¼šå†…éƒ¨åœ†ä¸èƒ½æåˆ°å¤–éƒ¨åœ†ä¸­çš„ä»»ä½•åå­—ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™ç§æƒ…å†µæˆ‘ä»¬ä¼šè°ƒç”¨åœ¨å†…éƒ¨åœ†ä¸­çš„æ¥å£ï¼ˆå°±åƒè¿™é‡Œå±•ç¤ºçš„ Use Case Output Port)ï¼‰ï¼Œç„¶ååœ¨å¤–éƒ¨åœ†ä¸­çš„Presenterå»å®ç°å®ƒã€‚</p>
<p>åŒæ ·çš„æŠ€æœ¯åœ¨æ¶æ„çš„æ‰€æœ‰è·¨è¶Šè¾¹ç•Œçš„åœ°æ–¹è¢«ä½¿ç”¨åˆ°ã€‚æˆ‘ä»¬åˆ©ç”¨åŠ¨æ€ä»£ç†çš„ä¼˜åŠ¿å»åˆ›å»ºä»£ç ä¾èµ–æ¥è¾¾åˆ°æ§åˆ¶åè½¬ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¡®ä¿æ— è®ºä»€ä¹ˆæ–¹å‘çš„ <em>ä¾èµ–å‡†åˆ™</em> æ§åˆ¶æµéƒ½èƒ½æœ‰æ•ˆã€‚</p>
<h2 id="ä»€ä¹ˆæ•°æ®è·¨è¶Šè¾¹ç•Œã€‚"><a href="#ä»€ä¹ˆæ•°æ®è·¨è¶Šè¾¹ç•Œã€‚" class="headerlink" title="ä»€ä¹ˆæ•°æ®è·¨è¶Šè¾¹ç•Œã€‚"></a>ä»€ä¹ˆæ•°æ®è·¨è¶Šè¾¹ç•Œã€‚</h2><p>å…¸å‹çš„è·¨è¶Šè¾¹ç•Œçš„æ•°æ®å°±æ˜¯ç®€å•çš„æ•°æ®ç»“æ„ã€‚å¦‚æœä½ å–œæ¬¢ä½ å¯ä»¥ä½¿ç”¨åŸºæœ¬ç»“æ„æˆ–è€…ç®€å•çš„æ•°æ®ä¼ è¾“å¯¹è±¡ã€‚æˆ–è€…æ˜¯æ–¹æ³•è°ƒç”¨æ—¶çš„ç®€å•çš„å‚æ•°æ•°æ®ã€‚æˆ–è€…ä½ å¯ä»¥æŠŠå®ƒæ”¾è¿›ä¸€ä¸ªHashMapï¼Œæˆ–è€…æ„å»ºå®ƒåˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚é‡è¦çš„æ˜¯åˆ†ç¦»çš„ã€ç®€å•çš„æ•°æ®ç»“æ„è·¨è¶Šè¿‡è¾¹ç•Œã€‚æˆ‘ä»¬ä¸å¸Œæœ›å»æ¬ºéª—å¹¶ä¼ é€’ <em>Entities</em> æˆ–è€…æ•°æ®åº“çš„è¡Œã€‚æˆ‘ä»¬ä¸å¸Œæœ›æ•°æ®ç»“æ„æœ‰ä»»ä½•çš„è¿å <em>ä¾èµ–å‡†åˆ™</em> çš„ä¾èµ–ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¾ˆå¤šæ•°æ®åº“æ¡†æ¶é€šè¿‡ä¸€ä¸ªæŸ¥è¯¢è¿”å›ä¸€ä¸ªæ–¹ä¾¿çš„æ•°æ®å½¢å¼çš„å“åº”ã€‚æˆ‘ä»¬å¯èƒ½ç§°å®ƒä¸ºä¸€ä¸ªRowStructureã€‚æˆ‘ä»¬ä¸å¸Œæœ›è¿™ä¸ªè¡Œç»“æ„å‘å†…è·¨è¶Šè¾¹ç•Œã€‚è¿™å°†è¿å <em>ä¾èµ–å‡†åˆ™</em> å› ä¸ºè¿™å°†å¼ºåˆ¶ä¸€ä¸ªå†…éƒ¨åœ†å»çŸ¥é“å¤–éƒ¨åœ†çš„ä¸€äº›ä¸œè¥¿ã€‚</p>
<p>æ‰€ä»¥å½“æˆ‘ä»¬è·¨è¶Šè¾¹ç•Œä¼ é€’æ•°æ®æ—¶ï¼Œå®ƒå¯¹äºå†…åœ†æ¥è¯´æ€»æ˜¯ä»¥æœ€æ–¹ä¾¿çš„å½¢å¼çš„ã€‚</p>
<p>éµå®ˆè¿™äº›ç®€å•çš„è§„åˆ™å¹¶ä¸éš¾ï¼Œå‰è¿›çš„é“è·¯ä¸Šä¼šè§£å†³å¾ˆå¤šå¤´ç–¼çš„äº‹æƒ…ã€‚é€šè¿‡åˆ†ç¦»è½¯ä»¶åˆ°ä¸åŒå±‚æ¬¡ï¼Œå¹¶éµå®ˆ <em>ä¾èµ–å‡†åˆ™</em> ï¼Œä½ å°†ä¼šåˆ›å»ºä¸€ä¸ªæœ¬è´¨ä¸Šå¯æµ‹è¯•çš„ç³»ç»Ÿï¼Œè¿™æ„å‘³è¿™æ‰€æœ‰çš„å¥½å¤„ã€‚å½“ä»»ä½•ç³»ç»Ÿå¤–ç½®çš„éƒ¨åˆ†å˜å¾—è¿‡æ—¶ï¼Œå°±åƒæ•°æ®åº“ï¼Œæˆ–è€…webæ¡†æ¶ï¼Œä½ å¯ä»¥åœ¨æœ€å°çš„æ”¹åŠ¨ä¸‹æ›¿æ¢è¿™äº›å¤–ç½®å…ƒç´ ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> best practices </tag>
            
            <tag> framework </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2016/02/16/Android-Dagger2Metrics-%E6%B5%8B%E9%87%8FDI%E5%9B%BE%E8%A1%A8%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E6%80%A7%E8%83%BD%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="Dagger2Metrics-æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½"><a href="#Dagger2Metrics-æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½" class="headerlink" title="Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½"></a>Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="http://frogermcs.github.io/dagger2metrics-measure-performance-of-graph-initialization/" target="_blank" rel="noopener">http://frogermcs.github.io/dagger2metrics-measure-performance-of-graph-initialization/</a></p>
</blockquote>
<p>å‡ ä¸ªæœˆå‰æˆ‘ä»¬é€šè¿‡ <a href="http://frogermcs.github.io/dagger-graph-creation-performance/" target="_blank" rel="noopener">Dagger 2 - graph creation performance</a> ç»å†äº†ä¸€äº›å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ã€‚å¤šäº <a href="http://tools.android.com/tips/traceview" target="_blank" rel="noopener">TraceView</a> è¿™ä¸ªå·¥å…·æˆ‘ä»¬å¯ä»¥å¾ˆç¡®åˆ‡åœ°çœ‹åˆ°åˆå§‹åŒ–æ‰€æœ‰éœ€è¦çš„ä¾èµ–éœ€è¦å¤šå°‘æ—¶é—´ã€‚ä½†æ˜¯è¿™å¹¶ä¸ç®€å• - æˆ‘ä»¬å¿…é¡»è¦åœ¨æˆ‘ä»¬ä»£ç ä¸­æ‰¾å‡ºéœ€è¦å¼€å§‹å’Œåœæ­¢æµ‹é‡çš„åœ°æ–¹ï¼Œç„¶ååœ¨Android Studioä¸­dumpå’Œåˆ†æå®ƒä»¬ã€‚ä¸ºäº†è®©å®ƒå˜å¾—æ›´ç®€å•ï¼Œæˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªç®€å•çš„åº“ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ•æ‰æ½œåœ¨çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<h2 id="Dagger2Metrics"><a href="#Dagger2Metrics" class="headerlink" title="Dagger2Metrics"></a>Dagger2Metrics</h2><h3 id="Dagger-2-åˆå§‹åŒ–è¿‡ç¨‹çš„æ€§èƒ½æµ‹é‡åº“"><a href="#Dagger-2-åˆå§‹åŒ–è¿‡ç¨‹çš„æ€§èƒ½æµ‹é‡åº“" class="headerlink" title="Dagger 2 åˆå§‹åŒ–è¿‡ç¨‹çš„æ€§èƒ½æµ‹é‡åº“"></a>Dagger 2 åˆå§‹åŒ–è¿‡ç¨‹çš„æ€§èƒ½æµ‹é‡åº“</h3><p><em>ä¸‹é¢çš„æè¿°å†…å®¹æ˜¯ä» Dagger2Metrics Github <a href="https://github.com/frogermcs/dagger2metrics" target="_blank" rel="noopener">é¡¹ç›®ç½‘ç«™</a>æ‹·è´è¿‡æ¥çš„ã€‚</em></p>
<p>å¦‚æœä½ åœ¨Androidåº”ç”¨ä¸­ä½¿ç”¨Dagger 2æ¥è¿›è¡Œä¾èµ–æ³¨å…¥ï¼Œä½ å¯èƒ½çŸ¥é“å®ƒæœ€å¤§çš„ä¸€å¤„ä¼˜åŒ–å°±æ˜¯Googleï¼ˆåŸæ¥æ˜¯Squareï¼‰çš„ä¼˜ç§€å·¥ç¨‹å¸ˆé€šè¿‡ä½¿ç”¨éåå°„ä»£ç å®ç°ã€‚</p>
<p>å³ä½¿æœ‰äº†æ‰€æœ‰çš„è¿™äº›ä¼˜åŒ–ä»¥åŠå®Œå…¨çš„éåŠ¨æ€ä»£ç ç”Ÿæˆï¼Œä½†æ˜¯ä»ç„¶æœ‰æ½œåœ¨çš„æ€§èƒ½é—®é¢˜éšè—åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­å’Œæ‰€æœ‰é€šè¿‡Dagger 2æ³¨å…¥çš„ç¬¬ä¸‰æ–¹ä»£ç ä¸­ã€‚</p>
<p>æ€§èƒ½çš„é—®é¢˜é€šå¸¸æ˜¯æ…¢æ…¢åœ°å˜æ…¢çš„ï¼Œæ‰€ä»¥åœ¨æ¯å¤©çš„å¼€å‘ä¸­æ˜¯å¾ˆéš¾æ„è¯†åˆ°æˆ‘ä»¬çš„appï¼ˆæˆ–è€…Activityã€æˆ–è€…å…¶ä»–Viewï¼‰å¯åŠ¨50msæˆ–è€…æ›´é•¿ã€‚åˆä¸€æ¬¡å˜æˆ150msï¼Œåˆä¸€æ¬¡å˜æˆ100msâ€¦</p>
<p>ä½¿ç”¨Dagger2Metricsï¼Œä½ å°†å¯ä»¥çœ‹åˆ°åˆå§‹åŒ–æ‰€æœ‰éœ€è¦çš„ä¾èµ–éœ€è¦å¤šå°‘æ—¶é—´ï¼ˆä»¥åŠè¿™äº›ä¾èµ–ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼‰ã€‚</p>
<p><img src="https://raw.githubusercontent.com/frogermcs/dagger2metrics/master/art/dagger2metrics.png" alt=""></p>
<h3 id="å‡†å¤‡å¼€å§‹"><a href="#å‡†å¤‡å¼€å§‹" class="headerlink" title="å‡†å¤‡å¼€å§‹"></a>å‡†å¤‡å¼€å§‹</h3><p>åœ¨ä½ çš„<code>build.gradle</code>ä¸­ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">  repositories &#123;</span><br><span class="line">    jcenter()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  dependencies &#123;</span><br><span class="line">    classpath <span class="string">'com.frogermcs.dagger2metrics:dagger2metrics-plugin:0.2'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.android.application'</span></span><br><span class="line">apply <span class="string">plugin:</span> <span class="string">'com.frogermcs.dagger2metrics'</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ä½ çš„<code>Application</code>ç±»ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleApplication</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     <span class="keyword">super</span>.onCreate();</span><br><span class="line">     <span class="comment">//Use it only in debug builds</span></span><br><span class="line">     <span class="keyword">if</span> (BuildConfig.DEBUG) &#123;</span><br><span class="line">         Dagger2Metrics.enableCapturing(<span class="keyword">this</span>);</span><br><span class="line">     &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å®Œæˆäº†ã€‚åœ¨ä½ çš„appä¸­ï¼Œä½ å°†ä¼šçœ‹åˆ°notificationï¼Œå®ƒå¯ä»¥æ‰“å¼€æ‰€æœ‰å·²å®Œæˆçš„åˆå§‹åŒ–çš„ä¸€ä¸ªç®€å•çš„æ¦‚è¿°ã€‚</p>
<p><img src="https://raw.githubusercontent.com/frogermcs/dagger2metrics/master/art/dagger2metrics-notification.png" alt=""></p>
<h3 id="å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ"><a href="#å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ" class="headerlink" title="å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ"></a>å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</h3><p>Dagger2Metricsä¼šæ•æ‰æ‰€æœ‰çš„åˆå§‹åŒ–ï¼Œé€šè¿‡ - æ‰€æœ‰å¸¦æœ‰ <code>@Module</code> -&gt; <code>@Provides</code> æ³¨è§£çš„æ–¹æ³•å’Œ<code>@Inject</code>æ³¨è§£çš„æ„é€ æ–¹æ³•ã€‚</p>
<p>æ€»ä¹‹ï¼Œä½ ä¼šçœ‹åˆ°å¤§å¤šæ•°é¡¶çº§æ³¨å…¥ä¾èµ–åœ°ä¾èµ–å…³ç³»æ ‘ã€‚æ¯ä¸€ä¸ªä¾èµ–æ˜¾ç¤ºäº†æä¾›è¿™äº›å¯¹è±¡åˆ°Dagger 2å¯¹è±¡å›¾è¡¨éœ€è¦å¤šå°‘æ—¶é—´ï¼ˆæ„å»ºæœ¬èº«æ‰€ç”¨æ—¶é—´ä»¥åŠæ‰€æœ‰çš„ä¾èµ–ï¼‰ã€‚</p>
<p><img src="https://raw.githubusercontent.com/frogermcs/dagger2metrics/master/art/dagger2metrics.png" alt=""></p>
<h3 id="ä¸ºä»€ä¹ˆæˆ‘çœ‹ä¸åˆ°æ‰€æœ‰ï¼ˆå­ï¼‰ä¾èµ–ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæˆ‘çœ‹ä¸åˆ°æ‰€æœ‰ï¼ˆå­ï¼‰ä¾èµ–ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæˆ‘çœ‹ä¸åˆ°æ‰€æœ‰ï¼ˆå­ï¼‰ä¾èµ–ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæˆ‘çœ‹ä¸åˆ°æ‰€æœ‰ï¼ˆå­ï¼‰ä¾èµ–ï¼Ÿ</h3><p>æµ‹é‡æ ‘ä¸ä¼šæ˜¾ç¤ºé‚£äº›å·²ç»æä¾›ç»™Daggerå›¾è¡¨çš„ä¾èµ–ï¼Œæ‰€ä»¥åªæœ‰ä»å¤´å¼€å§‹æ„å»ºçš„æ‰ä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚ä¸»è¦æ˜¯å› ä¸ºå¯è¯»æ€§ä»¥åŠå¦å¤–ä¸€ä¸ªç®€å•çš„ç†ç”±å°±æ˜¯ - æˆ‘ä»¬ä¸æƒ³åœ¨å¤§å¤šæ•°æ²¡æœ‰é”™è¯¯çš„æƒ…å†µä¸‹å»æµ‹é‡Dagger 2çš„æ€§èƒ½ã€‚æˆ‘ä»¬åº”è¯¥ç¡®ä¿æˆ‘ä»¬çš„ä»£ç å°½å¯èƒ½å¿«åœ°æä¾›ä¾èµ–ã€‚</p>
<h3 id="è‡ªå®šä¹‰"><a href="#è‡ªå®šä¹‰" class="headerlink" title="è‡ªå®šä¹‰"></a>è‡ªå®šä¹‰</h3><p>Dagger2Metrics æœ‰3ç§é»˜è®¤çº§åˆ«çš„è­¦å‘Šï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Dagger2Metrics.WARNING_1_LIMIT_MILLIS // 30ms</span><br><span class="line">Dagger2Metrics.WARNING_2_LIMIT_MILLIS // 50ms</span><br><span class="line">Dagger2Metrics.WARNING_3_LIMIT_MILLIS // 100ms</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥æ ¹æ®ä½ çš„éœ€è¦å¯¹å®ƒä»¬è¿›è¡Œè°ƒæ•´ã€‚</p>
<h3 id="ä¾‹å­app"><a href="#ä¾‹å­app" class="headerlink" title="ä¾‹å­app"></a>ä¾‹å­app</h3><p>ä½ å¯ä»¥æŸ¥çœ‹ <a href="https://github.com/frogermcs/githubclient" target="_blank" rel="noopener">GithubClient</a> é¡¹ç›® - ä¸€ä¸ªå±•ç¤ºæ€ä¹ˆä½¿ç”¨Dagger 2çš„Android appçš„ä¾‹å­ã€‚æœ€è¿‘çš„ç‰ˆæœ¬åœ¨debug buildä¸­ä½¿ç”¨äº†Dagger2Metricsã€‚</p>
<h3 id="æ›´å¤šå…³äºDagger-2"><a href="#æ›´å¤šå…³äºDagger-2" class="headerlink" title="æ›´å¤šå…³äºDagger 2"></a>æ›´å¤šå…³äºDagger 2</h3><p>å¦‚æœä½ åˆšå¼€å§‹æ¥è§¦Dagger 2ï¼Œä¸‹é¢çš„èµ„æºåˆ—è¡¨å¯ä»¥å¸®åŠ©ä½ ï¼š</p>
<p><a href="https://github.com/frogermcs/githubclient" target="_blank" rel="noopener">GithubClient</a> - åŸºäºDagger 2ä¾èµ–æ³¨å…¥æ¡†æ¶çš„Github API å®¢æˆ·ç«¯å®ç°çš„ä¾‹å­ã€‚</p>
<p>Blog postsï¼š</p>
<ul>
<li><a href="http://frogermcs.github.io/dagger-1-to-2-migration/" target="_blank" rel="noopener">Dagger 1 to 2 migration process</a></li>
<li><a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-introdution-to-di/" target="_blank" rel="noopener">Introdution to Dependency Injection</a></li>
<li><a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-the-api/" target="_blank" rel="noopener">Dagger 2 API</a></li>
<li><a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-custom-scopes/" target="_blank" rel="noopener">Dagger 2 - custom scopes</a></li>
<li><a href="http://frogermcs.github.io/dagger-graph-creation-performance/" target="_blank" rel="noopener">Dagger 2 - graph creation performance</a></li>
</ul>
<h3 id="ä»£ç ï¼š"><a href="#ä»£ç ï¼š" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h3><p>ä»¥ä¸Šæè¿°çš„å®Œæ•´ä»£ç å¯è§Github <a href="https://github.com/frogermcs/GithubClient" target="_blank" rel="noopener">repository</a>ã€‚</p>
<h2 id="ä½œè€…"><a href="#ä½œè€…" class="headerlink" title="ä½œè€…"></a>ä½œè€…</h2><p><a href="http://about.me/froger_mcs" target="_blank" rel="noopener">Miroslaw Stanek</a></p>
<p>Head of Mobile Development @ <a href="https://azimo.com/" target="_blank" rel="noopener">Azimo</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092083.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092083.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - APIï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092525.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092525.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5095426.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5095426.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5098943.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5098943.html</a></p>
<blockquote>
<p><strong>[Android]Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5193437.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5193437.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producersï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6234811.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6234811.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6236646.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6236646.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6237731.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6237731.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®šï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6266442.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6266442.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> dagger2 </tag>
            
            <tag> memory </tag>
            
            <tag> DI </tag>
            
            <tag> dependency injection </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2016/01/04/Android-%E4%BD%BF%E7%94%A8Dagger-2%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-%E5%9B%BE%E8%A1%A8%E5%88%9B%E5%BB%BA%E7%9A%84%E6%80%A7%E8%83%BD%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="ä½¿ç”¨Dagger-2ä¾èµ–æ³¨å…¥-å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½"><a href="#ä½¿ç”¨Dagger-2ä¾èµ–æ³¨å…¥-å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½" class="headerlink" title="ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½"></a>ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="http://frogermcs.github.io/dagger-graph-creation-performance/" target="_blank" rel="noopener">http://frogermcs.github.io/dagger-graph-creation-performance/</a></p>
</blockquote>
<p><a href="https://twitter.com/search?q=%23perfmatters" target="_blank" rel="noopener">#PerfMatters</a> - æœ€è¿‘éå¸¸æµè¡Œæ ‡ç­¾ï¼Œå°¤å…¶åœ¨Androidä¸–ç•Œä¸­ã€‚ä¸ç®¡æ€æ ·ï¼Œappsåªéœ€è¦æ­£å¸¸å·¥ä½œå°±å¯ä»¥çš„æ—¶ä»£å·²ç»è¿‡å»äº†ã€‚ç°åœ¨æ‰€æœ‰çš„ä¸€åˆ‡éƒ½åº”è¯¥æ˜¯ä»¤äººæ„‰æ‚¦çš„ï¼Œæµç•…å¹¶ä¸”å¿«é€Ÿã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒInstagram <a href="http://instagram-engineering.tumblr.com/post/97740520316/betterandroid" target="_blank" rel="noopener">èŠ±è´¹äº†åŠå¹´çš„æ—¶é—´</a> åªæ˜¯è®©appæ›´åŠ å¿«é€Ÿï¼Œæ›´åŠ ç¾è§‚ï¼Œå’Œæ›´å¥½çš„å±å¹•é€‚é…æ€§ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä»Šå¤©æˆ‘æƒ³å»åˆ†äº«ç»™ä½ ä¸€äº›å°çš„å»ºè®®ï¼Œå®ƒä¼šåœ¨ä½ appå¯åŠ¨æ—¶é—´ä¸Šæœ‰å¾ˆå¤§çš„å½±å“ï¼ˆå°¤å…¶æ˜¯å½“appä½¿ç”¨äº†ä¸€äº›é¢å¤–åº“çš„æ—¶å€™ï¼‰ã€‚</p>
<h2 id="å¯¹è±¡å›¾è¡¨çš„åˆ›å»º"><a href="#å¯¹è±¡å›¾è¡¨çš„åˆ›å»º" class="headerlink" title="å¯¹è±¡å›¾è¡¨çš„åˆ›å»º"></a>å¯¹è±¡å›¾è¡¨çš„åˆ›å»º</h2><p>å¤§å¤šæƒ…å†µä¸‹ï¼Œåœ¨appå¼€å‘è¿‡ç¨‹ä¸­ï¼Œå®ƒçš„å¯åŠ¨æ—¶é—´æˆ–å¤šæˆ–å°‘ä¼šå¢åŠ ã€‚æœ‰æ—¶éšç€ä¸€å¤©å¤©åœ°å¼€å‘å®ƒæ˜¯å¾ˆéš¾è¢«æ³¨æ„åˆ°çš„ï¼Œä½†æ˜¯å½“ä½ æŠŠç¬¬ä¸€ä¸ªç‰ˆæœ¬å’Œä½ èƒ½æ‰¾åˆ°çš„æœ€è¿‘çš„ç‰ˆæœ¬æ¯”è¾ƒæ—¶åŒºåˆ«å°±ä¼šç›¸å¯¹æ¯”è¾ƒå¤§äº†ã€‚</p>
<p>åŸå› å¾ˆå¯èƒ½å°±åœ¨äºdaggerå¯¹è±¡å›¾è¡¨çš„åˆ›å»ºè¿‡ç¨‹ã€‚</p>
<p>Dagger 2ï¼Ÿä½ å¯èƒ½ä¼šé—®ï¼Œç¡®åˆ‡åœ°è¯´ - å°±ç®—ä½ ç§»é™¤äº†é‚£äº›åŸºäºåå°„çš„å®ç°æ–¹æ¡ˆï¼Œå¹¶ä¸”ä½ çš„ä»£ç æ˜¯åœ¨ç¼–è¯‘æ—¶æœŸç”Ÿæˆçš„ï¼Œä½†æ˜¯åˆ«å¿˜äº†å¯¹è±¡çš„åˆ›å»ºä»ç„¶å‘ç”Ÿæ˜¯åœ¨è¿è¡Œæ—¶ã€‚</p>
<p>å¯¹è±¡ï¼ˆè¿˜æœ‰å®ƒçš„ä¾èµ–ï¼‰ä¼šåœ¨ç¬¬ä¸€æ¬¡è¢«æ³¨å…¥æ—¶åˆ›å»ºã€‚Jake Wharton åœ¨Dagger 2æ¼”ç¤ºä¸­çš„ä¸€äº›å¹»ç¯ç‰‡å¾ˆæ¸…æ¥šåœ°å±•ç¤ºäº†è¿™ä¸€ç‚¹ï¼š</p>
<p>ä»¥ä¸‹è¡¨ç¤ºåœ¨æˆ‘ä»¬çš„ <a href="https://github.com/frogermcs/GithubClient" target="_blank" rel="noopener">GithubClient</a> ä¾‹å­appä¸­å®ƒæ˜¯æ€æ ·çš„ï¼š</p>
<p>1. Appç¬¬ä¸€æ¬¡ï¼ˆè¢«killä¹‹åï¼‰è¢«å¯åŠ¨ã€‚Applicationå¯¹è±¡å¹¶æ²¡æœ‰<code>@Inject</code>å±æ€§ï¼Œæ‰€ä»¥åªæœ‰<code>AppComponent</code>å¯¹è±¡è¢«åˆ›å»ºã€‚<br>2. Appåˆ›å»ºäº†<code>SplashActivity</code> - å®ƒæœ‰ä¸¤ä¸ª<code>@Inject</code>å±æ€§ï¼š<code>AnalyticsManager</code>å’Œ<code>SplashActivityPresenter</code>ã€‚<br>3. <code>AnalyticsManager</code>ä¾èµ–å·²è¢«åˆ›å»ºçš„<code>Application</code>å¯¹è±¡ã€‚æ‰€ä»¥åªæœ‰<code>AnalyticsManager</code>æ„é€ æ–¹æ³•è¢«è°ƒç”¨ã€‚<br>4. <code>SplashSctivityPresenter</code>ä¾èµ–ï¼š<code>SplashActivity</code>ï¼Œ<code>Validator</code>å’Œ<code>UserManager</code>ã€‚<code>SplashActivity</code>å·²è¢«æä¾›ï¼Œ<code>Validator</code>å’Œ<code>UserManager</code>åº”è¯¥è¢«åˆ›å»ºã€‚<br>5. <code>UserManager</code>ä¾èµ–éœ€è¦è¢«åˆ›å»ºçš„<code>GithubApiService</code>ã€‚ä¹‹å<code>UserManager</code>è¢«åˆ›å»ºã€‚<br>6. ç°åœ¨æˆ‘ä»¬æ‹¥æœ‰äº†æ‰€æœ‰ä¾èµ–ï¼Œ<code>SplashActivityPresenter</code>è¢«åˆ›å»ºã€‚</p>
<p><img src="http://frogermcs.github.io/images/18/graph.png" alt=""></p>
<p>æœ‰ç‚¹æ··ä¹±ï¼Œä½†æ˜¯å°±ç»“æœæ¥è¯´ï¼Œåœ¨<code>SplashActivity</code>è¢«åˆ›å»ºä¹‹å‰ï¼ˆæˆ‘ä»¬å‡è®¾å¯¹è±¡æ³¨å…¥çš„æ“ä½œåªä¼šåœ¨<code>onCreate()</code>æ–¹æ³•ä¸­æ‰§è¡Œï¼‰æˆ‘ä»¬å¿…é¡»è¦ç­‰å¾…ä»¥ä¸‹æ„é€ æ–¹æ³•ï¼ˆå¯é€‰é…ç½®ï¼‰ï¼š</p>
<ul>
<li><code>GithubApiService</code>ï¼ˆå®ƒä¹Ÿä½¿ç”¨äº†ä¸€äº›ä¾èµ–ï¼Œå¦‚<code>OkHttpClient</code>ï¼Œä¸€ä¸ª<code>RestAdapter</code>ï¼‰</li>
<li><code>UserManager</code></li>
<li><code>Validator</code></li>
<li><code>SplashActivityPresenter</code></li>
<li><code>AnalyticsManager</code></li>
</ul>
<p>ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¢«åˆ›å»ºã€‚</p>
<p>å˜¿ï¼Œåˆ«æ‹…å¿ƒï¼Œæ›´å¤æ‚åœ°å›¾è¡¨ä¹Ÿå‡ ä¹è¢«ç«‹å³åˆ›å»ºã€‚</p>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>ç°åœ¨è®©æˆ‘ä»¬æƒ³è±¡ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå¤–éƒ¨çš„åº“éœ€è¦åœ¨appå¯åŠ¨æ—¶è¢«åˆå§‹åŒ–ï¼ˆæ¯”å¦‚ï¼ŒCrashlytics, Mixpanel, Google Analytics, Parseç­‰ç­‰ï¼‰ã€‚æƒ³è±¡ä¸‹æˆ‘ä»¬çš„<code>HeavyExternalLibrary</code>çœ‹èµ·æ¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeavyExternalLibrary</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> initialized = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HeavyExternalLibrary</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">500</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        initialized = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">callMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!initialized) <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Call init() before you use this library"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç®€å•è¯´ - æ„é€ æ–¹æ³•æ˜¯ç©ºçš„ï¼Œå¹¶ä¸”è°ƒç”¨å‡ ä¹ä¸èŠ±è´¹ä»»ä½•ä¸œè¥¿ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ª<code>init()</code>æ–¹æ³•ï¼Œå®ƒè€—æ—¶500mså¹¶ä¸”åœ¨æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªåº“ä¹‹å‰å¿…é¡»è¦è¢«è°ƒç”¨ã€‚ç¡®ä¿åœ¨æˆ‘ä»¬moduleçš„æŸå¤„çš„æŸä¸€æ—¶åˆ»è°ƒç”¨äº†<code>init()</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//AppModule</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Provides</span></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="function">HeavyExternalLibrary <span class="title">provideHeavyExternalLibrary</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    HeavyExternalLibrary heavyExternalLibrary = <span class="keyword">new</span> HeavyExternalLibrary();</span><br><span class="line">    heavyExternalLibrary.init();</span><br><span class="line">    <span class="keyword">return</span> heavyExternalLibrary;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬çš„<code>HeavyExternalLibrary</code>æˆä¸ºäº†<code>SplashActivityPresenter</code>çš„ä¸€éƒ¨åˆ†ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Provides</span></span><br><span class="line"><span class="meta">@ActivityScope</span></span><br><span class="line">SplashActivityPresenter</span><br><span class="line">provideSplashActivityPresenter(Validator validator, UserManager userManager, HeavyExternalLibrary heavyExternalLibrary) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SplashActivityPresenter(splashActivity, validator, userManager, heavyExternalLibrary);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæˆ‘ä»¬appå¯åŠ¨æ—¶é—´éœ€è¦500msè¿˜å¤šï¼Œåªæ˜¯å› ä¸º<code>HeavyExternalLibrary</code>çš„åˆå§‹åŒ–ï¼Œè¿™è¿‡ç¨‹ä¼šåœ¨SplashActivityPresenterä¾èµ–å›¾è¡¨åˆ›å»ºä¸­æ‰§è¡Œã€‚</p>
<h2 id="æµ‹é‡"><a href="#æµ‹é‡" class="headerlink" title="æµ‹é‡"></a>æµ‹é‡</h2><p>Android SDKï¼ˆAndroid Studioæœ¬èº«ï¼‰ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªéšç€åº”ç”¨æ‰§è¡Œçš„æ—¶é—´çš„å¯è§†åŒ–çš„å·¥å…· - <a href="http://tools.android.com/tips/traceview" target="_blank" rel="noopener">Traceview</a>ã€‚å¤šäºè¿™ä¸ªæˆ‘ä»¬å¯ä»¥çœ‹è§æ¯ä¸ªæ–¹æ³•èŠ±äº†å¤šå°‘æ—¶é—´ï¼Œå¹¶ä¸”æ‰¾å‡ºæ³¨å…¥è¿‡ç¨‹ä¸­çš„ç“¶é¢ˆã€‚</p>
<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå¦‚æœä½ ä»¥å‰æ²¡æœ‰è§è¿‡å®ƒï¼Œå¯ä»¥åœ¨<a href="http://blog.udinic.com/2015/09/15/speed-up-your-app/" target="_blank" rel="noopener">Udi Cohençš„åšå®¢</a>çœ‹ä¸‹è¿™ç¯‡Androidæ€§èƒ½ä¼˜åŒ–ç›¸å…³çš„æ–‡ç« ã€‚</p>
<p>Traceviewå¯ä»¥ç›´æ¥ä»Android Studioï¼ˆAndroid Monitor tab -&gt; CPU -&gt; Start/Stop Method Tracingï¼‰å¯åŠ¨ï¼Œå®ƒæœ‰æ—¶å¹¶ä¸æ˜¯é‚£ä¹ˆç²¾ç¡®çš„ï¼Œå°¤å…¶æ˜¯å½“æˆ‘ä»¬å°è¯•åœ¨appå¯åŠ¨æ—¶ç‚¹å‡»<code>Start</code>ã€‚</p>
<p>å¯¹äºæˆ‘ä»¬è€Œè¨€ï¼Œå¹¸è¿çš„æ˜¯å½“æˆ‘ä»¬çŸ¥é“ç¡®åˆ‡çš„éœ€è¦è¢«æµ‹é‡çš„ä»£ç ä½ç½®æ—¶ï¼Œæœ‰ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„æ–¹æ³•ã€‚<a href="http://developer.android.com/reference/android/os/Debug.html#startMethodTracing(java.lang.String)" target="_blank" rel="noopener">Debug.startMethodTracing()</a>å¯ä»¥ç”¨æ¥æŒ‡å®šæˆ‘ä»¬ä»£ç ä¸­éœ€è¦è¢«å¯åŠ¨æµ‹é‡çš„ä½ç½®ã€‚<code>Debug.stopMethodTracing()</code>åœæ­¢è¿½è¸ªå¹¶ä¸”åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚</p>
<p>ä¸ºäº†å®è·µï¼Œæˆ‘ä»¬æµ‹é‡äº†SplashActivityçš„æ³¨å…¥è¿‡ç¨‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setupActivityComponent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Debug.startMethodTracing(<span class="string">"SplashTrace"</span>);</span><br><span class="line">    GithubClientApplication.get(<span class="keyword">this</span>)</span><br><span class="line">            .getAppComponent()</span><br><span class="line">            .plus(<span class="keyword">new</span> SplashActivityModule(<span class="keyword">this</span>))</span><br><span class="line">            .inject(<span class="keyword">this</span>);</span><br><span class="line">    Debug.stopMethodTracing();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>setupActivityComponent()</code>æ˜¯åœ¨<code>onCreate()</code>ä¸­è°ƒç”¨çš„ã€‚</p>
<p>æ–‡æ¡£ç»“æœè¢«ä¿å­˜åœ¨<code>/sdcard/SplashTrace.trace</code>ä¸­ã€‚</p>
<p>åœ¨ä½ çš„terminalä¸­æŠŠå®ƒpullå‡ºæ¥ï¼š</p>
<p><code>$ adb pull /sdcard/SplashTrace.trace</code></p>
<p>ç°åœ¨é˜…è¯»è¿™ä¸ªæ–‡ä»¶æ‰€è¦åšçš„å…¨éƒ¨äº‹æƒ…åªæ˜¯æŠŠå®ƒæ‹–æ‹½åˆ°Android Studioï¼š</p>
<p><img src="http://frogermcs.github.io/images/18/trace.png" alt=""></p>
<p>ä½ åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„ä¸œè¥¿ï¼š</p>
<p><img src="http://frogermcs.github.io/images/18/traceview.png" alt=""></p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­çš„ç»“æœæ˜¯éå¸¸æ¸…æ™°çš„ï¼š<code>AppModule_ProvideHeavyExternalLibraryFactory.get()</code>ï¼ˆHeavyExternalLibraryè¢«åˆ›å»ºçš„åœ°æ–¹ï¼‰èŠ±è´¹äº†500msã€‚</p>
<p>çœŸæ­£å¥½ç©çš„åœ°æ–¹æ˜¯ï¼Œç¼©æ”¾traceå°¾éƒ¨çš„é‚£ä¸€å°å—åœ°æ–¹ï¼š</p>
<p><img src="http://frogermcs.github.io/images/18/traceview2.png" alt=""></p>
<p>çœ‹åˆ°ä¸åŒä¹‹å¤„äº†å—ï¼Ÿæ¯”å¦‚æ„å»ºç±»ï¼š<code>AnalyticsManager</code>èŠ±äº†å°äº1msã€‚</p>
<p>å¦‚æœä½ æƒ³çœ‹åˆ°å®ƒï¼Œè¿™é‡Œæœ‰è¿™ä¸ªä¾‹å­ä¸­çš„<a href="https://github.com/frogermcs/frogermcs.github.io/raw/master/files/18/SplashTrace.trace" target="_blank" rel="noopener">SplashTrace.trace</a>æ–‡ä»¶ã€‚</p>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>ä¸å¹¸çš„æ˜¯ï¼Œå¯¹äºè¿™ç±»æ€§èƒ½é—®é¢˜ï¼Œæœ‰æ—¶å¹¶æ²¡æœ‰æ˜ç¡®çš„å›ç­”ã€‚è¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼ä¼šç»™æˆ‘ä»¬å¾ˆå¤§çš„å¸®åŠ©ã€‚</p>
<h3 id="æ‡’åŠ è½½ï¼ˆä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆï¼‰"><a href="#æ‡’åŠ è½½ï¼ˆä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆï¼‰" class="headerlink" title="æ‡’åŠ è½½ï¼ˆä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆï¼‰"></a>æ‡’åŠ è½½ï¼ˆä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆï¼‰</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æ€è€ƒæ˜¯å¦ä½ éœ€è¦æ‰€æœ‰çš„æ³¨å…¥ä¾èµ–ã€‚ä¹Ÿè®¸å…¶ä¸­ä¸€éƒ¨åˆ†å¯ä»¥å»¶è¿Ÿä¸€å®šæ—¶é—´åå†åŠ è½½ï¼Ÿå½“ç„¶è¿™å¹¶ä¸è§£å†³çœŸæ­£çš„é—®é¢˜ï¼ˆUIçº¿ç¨‹å°†ä¼šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨Lazy&lt;&gt;.get()æ–¹æ³•çš„æ—¶å€™é˜»å¡ï¼‰ã€‚ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹å¯¹å¯åŠ¨è€—æ—¶æœ‰å¸®åŠ©ï¼ˆå°¤å…¶æ˜¯å¾ˆå°‘åœ°æ–¹ä¼šä½¿ç”¨åˆ°çš„ä¸€äº›å¯¹è±¡ï¼‰ã€‚æŸ¥çœ‹<a href="http://google.github.io/dagger/api/2.0/dagger/Lazy.html" target="_blank" rel="noopener">Lazy&lt;&gt;</a>æ¥å£æ–‡æ¡£è·å–æ›´å¤šçš„ä¿¡æ¯å’Œä¾‹å­ä»£ç ã€‚</p>
<p>ç®€å•è¯´ï¼Œæ¯ä¸€ä¸ªä½ ä½¿ç”¨<code>@Inject SomeClass someClass</code>çš„åœ°æ–¹éƒ½å¯ä»¥æ›¿æ¢æˆ<code>@Inject Lazy&lt;SomeClass&gt; someClassLazy</code>ï¼ˆæ„é€ æ–¹æ³•æ³¨å…¥ä¹Ÿæ˜¯ï¼‰ã€‚ç„¶åè·å–æŸä¸ªç±»çš„å®ä¾‹æ—¶å¿…é¡»è¦è°ƒç”¨<code>someClassLazy.get()</code>ã€‚</p>
<h3 id="å¼‚æ­¥å¯¹è±¡åˆ›å»º"><a href="#å¼‚æ­¥å¯¹è±¡åˆ›å»º" class="headerlink" title="å¼‚æ­¥å¯¹è±¡åˆ›å»º"></a>å¼‚æ­¥å¯¹è±¡åˆ›å»º</h3><p>ç¬¬äºŒç§é€‰æ‹©ï¼ˆå®ƒä»ç„¶åªæ˜¯æ›´å¤šçš„æƒ³æ³•è€Œä¸æ˜¯æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆï¼‰æ˜¯åœ¨åå°çº¿ç¨‹ä¸­çš„æŸå¤„è¿›è¡Œå¯¹è±¡çš„åˆå§‹åŒ–ï¼Œç¼“å­˜æ‰€æœ‰æ–¹æ³•çš„è°ƒç”¨å¹¶åœ¨åˆå§‹åŒ–ä¹‹åå†å›è°ƒå®ƒä»¬ã€‚</p>
<p>è¿™ç§æ–¹æ¡ˆçš„ç¼ºç‚¹æ˜¯å®ƒå¿…é¡»è¦å•ç‹¬åœ°å‡†å¤‡æˆ‘ä»¬è¦åŒ…å«çš„æ‰€æœ‰ç±»ã€‚å¹¶ä¸”å®ƒåªæœ‰åœ¨æ–¹æ³•è°ƒç”¨å¯ä»¥è¢«æ‰§è¡Œçš„å°†æ¥ï¼ˆå°±åƒä»»ä½•çš„analytics - åœ¨ä¸€äº›äº‹ä»¶è¢«å‘ç”Ÿä¹‹åæ‰å¯ä»¥ï¼‰ï¼Œè¿™äº›å¯¹è±¡æ‰å¯èƒ½æ­£å¸¸å·¥ä½œã€‚</p>
<p>ä»¥ä¸‹å°±æ˜¯æˆ‘ä»¬çš„<code>HeavyExternalLibrary</code>ä½¿ç”¨è¿™ç§è§£å†³æ–¹æ¡ˆåçš„æ ·å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeavyLibraryWrapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> HeavyExternalLibrary heavyExternalLibrary;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isInitialized = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    ConnectableObservable&lt;HeavyExternalLibrary&gt; initObservable;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HeavyLibraryWrapper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        initObservable = Observable.create(<span class="keyword">new</span> Observable.OnSubscribe&lt;HeavyExternalLibrary&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber&lt;? <span class="keyword">super</span> HeavyExternalLibrary&gt; subscriber)</span> </span>&#123;</span><br><span class="line">                HeavyLibraryWrapper.<span class="keyword">this</span>.heavyExternalLibrary = <span class="keyword">new</span> HeavyExternalLibrary();</span><br><span class="line">                HeavyLibraryWrapper.<span class="keyword">this</span>.heavyExternalLibrary.init();</span><br><span class="line">                subscriber.onNext(heavyExternalLibrary);</span><br><span class="line">                subscriber.onCompleted();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).subscribeOn(Schedulers.io()).observeOn(AndroidSchedulers.mainThread()).publish();</span><br><span class="line"></span><br><span class="line">        initObservable.subscribe(<span class="keyword">new</span> SimpleObserver&lt;HeavyExternalLibrary&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(HeavyExternalLibrary heavyExternalLibrary)</span> </span>&#123;</span><br><span class="line">                isInitialized = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        initObservable.connect();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">callMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isInitialized) &#123;</span><br><span class="line">            HeavyExternalLibrary.callMethod();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            initObservable.subscribe(<span class="keyword">new</span> SimpleObserver&lt;HeavyExternalLibrary&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(HeavyExternalLibrary heavyExternalLibrary)</span> </span>&#123;</span><br><span class="line">                    heavyExternalLibrary.callMethod();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“<code>HeavyLibraryWrapper</code>æ„é€ æ–¹æ³•è¢«è°ƒç”¨ï¼Œåº“çš„åˆå§‹åŒ–ä¼šåœ¨åå°çº¿ç¨‹ï¼ˆè¿™é‡Œçš„<code>Schedulers.io()</code>ï¼‰ä¸­æ‰§è¡Œã€‚åœ¨æ­¤æœŸé—´ï¼Œå½“ç”¨æˆ·è°ƒç”¨<code>callMethod()</code>ï¼Œå®ƒä¼šå¢åŠ ä¸€ä¸ªæ–°çš„subscriptionåˆ°æˆ‘ä»¬çš„åˆå§‹åŒ–è¿‡ç¨‹ä¸­ã€‚å½“å®ƒå®Œæˆæ—¶ï¼ˆonNext()æ–¹æ³•è¿”å›ä¸€ä¸ªå·²åˆå§‹åŒ–çš„HeavyExternalLibraryå¯¹è±¡ï¼‰è¢«ç¼“å­˜çš„å›è°ƒä¼šè¢«ä¼ é€åˆ°è¿™ä¸ªå¯¹è±¡ã€‚</p>
<p>ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªæƒ³æ³•è¿˜æ˜¯éå¸¸ç®€å•å¹¶ä¸”ä»ç„¶æ˜¯åœ¨å¼€å‘ä¹‹ä¸­ã€‚è¿™é‡Œå¯èƒ½ä¼šå¼•èµ·å†…å­˜æ³„æ¼ï¼ˆæ¯”å¦‚ï¼Œæˆ‘ä»¬ä¸å¾—ä¸åœ¨callMethod()æ–¹æ³•ä¸­ä¼ å…¥ä¸€äº›å‚æ•°ï¼‰ï¼Œä½†ä¸€èˆ¬è¿˜æ˜¯é€‚ç”¨äºç®€å•çš„æƒ…å†µä¸‹çš„ã€‚</p>
<h3 id="è¿˜æœ‰å…¶å®ƒæ–¹æ¡ˆï¼Ÿ"><a href="#è¿˜æœ‰å…¶å®ƒæ–¹æ¡ˆï¼Ÿ" class="headerlink" title="è¿˜æœ‰å…¶å®ƒæ–¹æ¡ˆï¼Ÿ"></a>è¿˜æœ‰å…¶å®ƒæ–¹æ¡ˆï¼Ÿ</h3><p>æ€§èƒ½ä¼˜åŒ–çš„è¿‡ç¨‹æ˜¯éå¸¸å­¤ç‹¬çš„ã€‚ä½†æ˜¯å¦‚æœä½ æƒ³è¦åˆ†äº«ä½ çš„ideasï¼Œè¯·åœ¨è¿™é‡Œåˆ†äº«å§ã€‚</p>
<p>æ„Ÿè°¢ä½ çš„é˜…è¯»ï¼</p>
<h3 id="ä»£ç ï¼š"><a href="#ä»£ç ï¼š" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h3><p>ä»¥ä¸Šæè¿°çš„å®Œæ•´ä»£ç å¯è§Github <a href="https://github.com/frogermcs/GithubClient" target="_blank" rel="noopener">repository</a>ã€‚</p>
<h2 id="ä½œè€…"><a href="#ä½œè€…" class="headerlink" title="ä½œè€…"></a>ä½œè€…</h2><p><a href="http://about.me/froger_mcs" target="_blank" rel="noopener">Miroslaw Stanek</a></p>
<p>Head of Mobile Development @ <a href="https://azimo.com/" target="_blank" rel="noopener">Azimo</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092083.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092083.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - APIï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092525.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092525.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5095426.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5095426.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5098943.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5098943.html</a></p>
<blockquote>
<p><strong>[Android]Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5193437.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5193437.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producersï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6234811.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6234811.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6236646.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6236646.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6237731.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6237731.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®šï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6266442.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6266442.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> google </tag>
            
            <tag> dagger2 </tag>
            
            <tag> DI </tag>
            
            <tag> dependency injection </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scopeï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2016/01/02/Android-%E4%BD%BF%E7%94%A8Dagger-2%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-%E8%87%AA%E5%AE%9A%E4%B9%89Scope%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="ä½¿ç”¨Dagger-2ä¾èµ–æ³¨å…¥-è‡ªå®šä¹‰Scope"><a href="#ä½¿ç”¨Dagger-2ä¾èµ–æ³¨å…¥-è‡ªå®šä¹‰Scope" class="headerlink" title="ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scope"></a>ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scope</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-custom-scopes/" target="_blank" rel="noopener">http://frogermcs.github.io/dependency-injection-with-dagger-2-custom-scopes/</a></p>
</blockquote>
<p>è¿™ç« æ˜¯å±•ç¤ºä½¿ç”¨Dagger 2åœ¨Androidç«¯å®ç°ä¾èµ–æ³¨å…¥çš„ç³»åˆ—ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ä»Šå¤©æˆ‘ä¼šèŠ±ç‚¹æ—¶é—´åœ¨è‡ªå®šä¹‰Scopeï¼ˆä½œç”¨åŸŸï¼‰ä¸Šé¢ - å®ƒæ˜¯å¾ˆå®ç”¨ï¼Œä½†æ˜¯å¯¹äºåˆšæ¥è§¦ä¾èµ–æ³¨å…¥çš„äººä¼šæœ‰ä¸€ç‚¹å›°éš¾ã€‚</p>
<h2 id="Scope-å®ƒç»™æˆ‘ä»¬å¸¦æ¥äº†ä»€ä¹ˆï¼Ÿ"><a href="#Scope-å®ƒç»™æˆ‘ä»¬å¸¦æ¥äº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Scope - å®ƒç»™æˆ‘ä»¬å¸¦æ¥äº†ä»€ä¹ˆï¼Ÿ"></a>Scope - å®ƒç»™æˆ‘ä»¬å¸¦æ¥äº†ä»€ä¹ˆï¼Ÿ</h2><p>å‡ ä¹æ‰€æœ‰çš„é¡¹ç›®éƒ½ä¼šç”¨åˆ°å•ä¾‹ - æ¯”å¦‚API clientsï¼Œdatabase helpersï¼Œanalytics managersç­‰ã€‚å› ä¸ºæˆ‘ä»¬ä¸éœ€è¦å»å…³å¿ƒå®ä¾‹åŒ–ï¼ˆç”±äºä¾èµ–æ³¨å…¥ï¼‰ï¼Œæˆ‘ä»¬ä¸åº”è¯¥åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­è€ƒè™‘å…³äºæ€ä¹ˆå¾—åˆ°è¿™äº›å¯¹è±¡ã€‚å–è€Œä»£ä¹‹çš„æ˜¯<code>@Inject</code>æ³¨è§£åº”è¯¥æä¾›ç»™æˆ‘ä»¬é€‚åˆçš„å®ä¾‹ã€‚</p>
<p>åœ¨Dagger 2ä¸­ï¼ŒScopeæœºåˆ¶å¯ä»¥ä½¿å¾—åœ¨scopeå­˜åœ¨æ—¶ä¿æŒç±»çš„å•ä¾‹ã€‚åœ¨å®è·µä¸­ï¼Œè¿™æ„å‘³ç€è¢«é™å®šèŒƒå›´ä¸º<code>@ApplicationScope</code>çš„å®ä¾‹ä¸Applicaitonå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ã€‚<code>@ActivityScope</code>ä¿è¯å¼•ç”¨ä¸Activityçš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼ˆä¸¾ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªActivityä¸­æŒæœ‰çš„æ‰€æœ‰fragmentä¹‹é—´åˆ†äº«ä¸€ä¸ªä»»ä½•ç±»çš„å•ä¾‹ï¼‰ã€‚</p>
<p>ç®€å•æ¥è¯´ - scopeç»™æˆ‘ä»¬å¸¦æ¥äº†â€œå±€éƒ¨å•ä¾‹â€ï¼Œç”Ÿå‘½å‘¨æœŸå–å†³äºscopeè‡ªå·±ã€‚</p>
<p>ä½†æ˜¯éœ€è¦å¼„æ¸…æ¥šçš„æ˜¯ - Dagger 2é»˜è®¤å¹¶ä¸æä¾›<code>@ActivityScope</code> æˆ–è€…/å¹¶ä¸” <code>@ApplicationScope</code> è¿™äº›æ³¨è§£ã€‚è¿™äº›åªæ˜¯æœ€å¸¸ç”¨çš„è‡ªå®šä¹‰Scopeã€‚åªæœ‰<code>@Singleton</code> scopeæ˜¯é»˜è®¤æä¾›çš„ï¼ˆç”±Javaè‡ªå·±æä¾›ï¼‰ã€‚</p>
<h2 id="Scope-å®è·µæ¡ˆä¾‹"><a href="#Scope-å®è·µæ¡ˆä¾‹" class="headerlink" title="Scope - å®è·µæ¡ˆä¾‹"></a>Scope - å®è·µæ¡ˆä¾‹</h2><p>ä¸ºäº†æ›´å¥½åœ°å»ç†è§£Dagger 2ä¸­çš„scopeï¼Œæˆ‘ä»¬ç›´æ¥è¿›å…¥å®è·µæ¡ˆä¾‹ã€‚æˆ‘ä»¬å°†è¦å»å®ç°æ¯”Application/Activity scopeæ›´åŠ å¤æ‚ä¸€ç‚¹çš„scopeã€‚ä¸ºæ­¤æˆ‘ä»¬å°†ä½¿ç”¨ <a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-the-api/" target="_blank" rel="noopener">ä¸Šä¸€æ–‡ç« </a> ä¸­çš„ <a href="https://github.com/frogermcs/GithubClient" target="_blank" rel="noopener">GithubClient</a> ä¾‹å­ã€‚æˆ‘ä»¬çš„appåº”éœ€è¦ä¸‰ç§scopeï¼š</p>
<ul>
<li><strong>@Sigleton</strong> - application scope</li>
<li><strong>@UserScope</strong> - ç”¨äºä¸è¢«é€‰ä¸­çš„ç”¨æˆ·è”ç³»èµ·æ¥çš„ç±»å®ä¾‹çš„scopeï¼ˆåœ¨çœŸå®çš„appä¸­å¯ä»¥æ˜¯å½“å‰ç™»å½•çš„ç”¨æˆ·ï¼‰ã€‚</li>
<li><strong>@ActivityScope</strong> - ç”Ÿå‘½å‘¨æœŸä¸Activityï¼ˆåœ¨æˆ‘ä»¬ä¾‹å­ä¸­çš„å‘ˆç°è€…ï¼‰ä¸€è‡´çš„å®ä¾‹çš„scope</li>
</ul>
<p>è®²è§£çš„<code>@UserScope</code>æ˜¯ä»Šå¤©æ–¹æ¡ˆä¸ä»¥å‰æ–‡ç« ä¹‹é—´çš„ä¸»è¦çš„ä¸åŒä¹‹å¤„ã€‚ä»ç”¨æˆ·ä½“éªŒçš„è§’åº¦æ¥è¯´å®ƒæ²¡æœ‰å¸¦ç»™æˆ‘ä»¬ä»»ä½•ä¸œè¥¿ï¼Œä½†æ˜¯ä»æ¶æ„çš„è§‚ç‚¹æ¥è¯´å®ƒå¸®åŠ©æˆ‘ä»¬åœ¨ä¸ä¼ å…¥ä»»ä½•æ„å›¾å‚æ•°çš„æƒ…å†µä¸‹æä¾›äº†Userå®ä¾‹ã€‚ä½¿ç”¨æ–¹æ³•å‚æ•°è·å–ç”¨æˆ·æ•°æ®çš„ç±»ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯<code>RepositoriesManager</code>ï¼‰ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ å‚æ•°ï¼ˆå®ƒå°†é€šè¿‡ä¾èµ–å›¾è¡¨æä¾›ï¼‰çš„æ–¹å¼æ¥è·å–Userå®ä¾‹å¹¶åœ¨éœ€è¦çš„æ—¶å€™è¢«åˆå§‹åŒ–ï¼Œè€Œä¸æ˜¯åœ¨appå¯åŠ¨çš„æ—¶å€™åˆ›å»ºå®ƒã€‚è¿™æ„å‘³ç€<code>RepositoriesManager</code>å¯ä»¥åœ¨æˆ‘ä»¬ä»Github APIè·å–åˆ°ç”¨æˆ·ä¿¡æ¯ï¼ˆåœ¨<code>RepositoriesListActivity</code>å‘ˆç°ä¹‹å‰ï¼‰ä¹‹åè¢«åˆ›å»ºã€‚</p>
<p>è¿™é‡Œæœ‰ä¸ªæˆ‘ä»¬appä¸­scopeså’Œcomponentså‘ˆç°çš„ç®€å•å›¾è¡¨ã€‚</p>
<p><img src="http://frogermcs.github.io/images/15/dagger-scopes.png" alt=""></p>
<p>å•ä¾‹ï¼ˆApplication scopeï¼‰æ˜¯æœ€é•¿çš„scopeï¼ˆåœ¨å®è·µä¸­æ˜¯ä¸applicationä¸€æ ·é•¿ï¼‰ã€‚UserScopeä½œä¸ºApplication scopeçš„ä¸€ä¸ªå­é›†scopeï¼Œå®ƒå¯ä»¥è®¿é—®å®ƒçš„å¯¹è±¡ï¼ˆæˆ‘ä»¬å¯ä»¥ä»çˆ¶scopeä¸­å¾—åˆ°å¯¹è±¡ï¼‰ã€‚ActivityScopeï¼ˆç”Ÿå‘½å‘¨æœŸä¸Activityä¸€è‡´ï¼‰ä¹Ÿæ˜¯å¦‚æ­¤ - å®ƒå¯ä»¥ä»UserScopeå’ŒApplicationScopeä¸­å¾—åˆ°å¯¹è±¡ã€‚</p>
<h2 id="Scopeç”Ÿå‘½å‘¨æœŸçš„ä¾‹å­"><a href="#Scopeç”Ÿå‘½å‘¨æœŸçš„ä¾‹å­" class="headerlink" title="Scopeç”Ÿå‘½å‘¨æœŸçš„ä¾‹å­"></a>Scopeç”Ÿå‘½å‘¨æœŸçš„ä¾‹å­</h2><p>è¿™é‡Œæœ‰ä¸€ä¸ªæˆ‘ä»¬appä¸­scopeç”Ÿå‘½å‘¨æœŸçš„æ¡ˆä¾‹ï¼š</p>
<p><img src="http://frogermcs.github.io/images/15/scopes-lifecycle.png" alt=""></p>
<p>å•ä¾‹çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä»appå¯åŠ¨åçš„æ‰€æœ‰çš„æ—¶æœŸï¼Œå½“æˆ‘ä»¬ä»Github APIï¼ˆåœ¨çœŸå®appä¸­æ˜¯ç”¨æˆ·ç™»å½•ä¹‹åï¼‰å¾—åˆ°äº†<code>User</code>å®ä¾‹æ—¶UserScopeè¢«åˆ›å»ºäº†ï¼Œç„¶åå½“æˆ‘ä»¬å›é€€åˆ°SplashActivityï¼ˆåœ¨çœŸå®appä¸­æ˜¯ç”¨æˆ·é€€å‡ºä¹‹åï¼‰æ—¶è¢«é”€æ¯ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>åœ¨Dagger 2ä¸­ï¼ŒScopeçš„å®ç°å½’ç»“äºå¯¹Componentsçš„ä¸€ä¸ªæ­£ç¡®çš„è®¾ç½®ã€‚ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼ - ä½¿ç”¨<code>Subcomponent</code>æ³¨è§£æˆ–è€…ä½¿ç”¨Componentsä¾èµ–ã€‚å®ƒä»¬ä¸¤è€…æœ€å¤§çš„åŒºåˆ«å°±æ˜¯å¯¹è±¡å›¾è¡¨çš„å…±äº«ã€‚Subcomponentså¯ä»¥è®¿é—®å®ƒä»¬parentçš„æ‰€æœ‰å¯¹è±¡å›¾è¡¨ï¼Œè€ŒComponentä¾èµ–åªèƒ½è®¿é—®é€šè¿‡Componentæ¥å£æš´éœ²çš„å¯¹è±¡ã€‚</p>
<p>æˆ‘é€‰æ‹©ç¬¬ä¸€ç§ä½¿ç”¨ <code>@Subcomponent</code> æ³¨è§£ï¼Œå¦‚æœä½ ä¹‹å‰ä½¿ç”¨è¿‡Dagger 1ï¼Œå®ƒå‡ ä¹ä¸ä»<code>ObjectGraph</code>åˆ›å»ºä¸€ä¸ªsubgraphsï¼ˆå­å›¾è¡¨ï¼‰æ˜¯ä¸€æ ·çš„ã€‚æ­¤å¤–ï¼Œå¯¹äºåˆ›å»ºä¸€ä¸ªsubgraphsçš„æ–¹æ³•æˆ‘ä»¬ä¼šä½¿ç”¨ç±»ä¼¼çš„å‘½åæ³•åˆ™ï¼ˆä½†è¿™ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼‰ã€‚</p>
<p>æˆ‘ä»¬ä»<code>AppComponent</code>çš„å®ç°å¼€å§‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Component</span>(</span><br><span class="line">        modules = &#123;</span><br><span class="line">                AppModule.class,</span><br><span class="line">                GithubApiModule.class</span><br><span class="line">        &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">UserComponent <span class="title">plus</span><span class="params">(UserModule userModule)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">SplashActivityComponent <span class="title">plus</span><span class="params">(SplashActivityModule splashActivityModule)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒå°†ä¼šæ˜¯å…¶å®ƒsubcomponentsçš„æ ¹Componentsï¼š<code>UserComponent</code>å’ŒActivities Componentsã€‚æ­£å¦‚ä½ æ³¨æ„åˆ°çš„é‚£æ ·ï¼ˆå°¤å…¶å¦‚æœä½ åœ¨å‰é¢çš„æ–‡ç« ä¸­çœ‹è¿‡çš„<a href="https://github.com/frogermcs/GithubClient/blob/1bf53a2a36c8a85435e877847b987395e482ab4a/app/src/main/java/frogermcs/io/githubclient/AppComponent.java" target="_blank" rel="noopener">AppComponent å®ç°</a>ï¼‰æ‰€æœ‰çš„è¿”å›ä¾èµ–å›¾è¡¨å¯¹è±¡çš„å…¬å¼€æ–¹æ³•å…¨éƒ¨æ¶ˆå¤±äº†ã€‚å› ä¸ºæˆ‘ä»¬æœ‰subcomponentsäº†ï¼Œæˆ‘ä»¬ä¸éœ€è¦å»å…¬å¼€å»æš´éœ²ä¾èµ–äº† - æ— è®ºå¦‚ä½•subgraphséƒ½å¯ä»¥è®¿é—®å®ƒä»¬å…¨éƒ¨äº†ã€‚</p>
<p>ä½œä¸ºæ›¿ä»£ï¼Œæˆ‘ä»¬æ–°å¢äº†ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><code>UserComponent plus(UserModule userModule);</code></li>
<li><code>SplashActivityComponent plus(SplashActivityModule splashActivityModule);</code></li>
</ul>
<p>è¿™è¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥ä»<code>AppComponent</code>åˆ›å»ºä¸¤ä¸ªå­Componentsï¼ˆsubcomponentsï¼‰ï¼š<code>UserComponent</code>å’Œ<code>SplashActivityComponent</code>ã€‚å› ä¸ºå®ƒä»¬éƒ½æ˜¯AppComponentçš„subcomponentsï¼Œæ‰€ä»¥å®ƒä»¬ä¸¤è€…éƒ½å¯ä»¥è®¿é—®<code>AppModule</code>å’Œ<code>GithubApiModule</code>åˆ›å»ºçš„å®ä¾‹ã€‚</p>
<p><em>è¿™äº›æ–¹æ³•çš„å‘½åæ³•åˆ™æ˜¯ï¼šè¿”å›ç±»å‹æ˜¯subcomponentç±»ï¼Œæ–¹æ³•åå­—éšæ„ï¼Œå‚æ•°æ˜¯è¿™ä¸ªsubcomponentéœ€è¦çš„modulesã€‚</em></p>
<p>å¦‚ä½ æ‰€è§ï¼Œ<code>UserComponent</code>éœ€è¦å¦ä¸€ä¸ªmoduleï¼ˆå®ƒé€šè¿‡<code>plus()</code>æ–¹æ³•çš„å‚æ•°ä¼ å…¥ï¼‰ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬é€šè¿‡å¢åŠ ä¸€ä¸ªæ–°çš„ç”¨äºç”Ÿæˆå¯¹è±¡çš„moduleï¼Œç»§æ‰¿<code>AppComponent</code>å›¾è¡¨ã€‚<code>UserComponent</code>ç±»çœ‹èµ·æ¥è¿™æ ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@UserScope</span></span><br><span class="line"><span class="meta">@Subcomponent</span>(</span><br><span class="line">        modules = &#123;</span><br><span class="line">                UserModule.class</span><br><span class="line">        &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserComponent</span> </span>&#123;</span><br><span class="line">    <span class="function">RepositoriesListActivityComponent <span class="title">plus</span><span class="params">(RepositoriesListActivityModule repositoriesListActivityModule)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">RepositoryDetailsActivityComponent <span class="title">plus</span><span class="params">(RepositoryDetailsActivityModule repositoryDetailsActivityModule)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶<code>@UserScope</code>æ³¨è§£æ˜¯æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scope</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> UserScope &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥ä»<code>UserComponent</code>åˆ›å»ºå¦å¤–ä¸¤ä¸ªsubcomponentsï¼š<code>RepositoriesListActivityComponent</code>å’Œ<code>RepositoryDetailsActivityComponent</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@UserScope</span></span><br><span class="line"><span class="meta">@Subcomponent</span>(</span><br><span class="line">        modules = &#123;</span><br><span class="line">                UserModule.class</span><br><span class="line">        &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserComponent</span> </span>&#123;</span><br><span class="line">    <span class="function">RepositoriesListActivityComponent <span class="title">plus</span><span class="params">(RepositoriesListActivityModule repositoriesListActivityModule)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">RepositoryDetailsActivityComponent <span class="title">plus</span><span class="params">(RepositoryDetailsActivityModule repositoryDetailsActivityModule)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¹¶ä¸”æ›´é‡è¦çš„æ˜¯æ‰€æœ‰scopeçš„ä¸œè¥¿éƒ½å‘ç”Ÿåœ¨è¿™é‡Œã€‚æ‰€æœ‰<code>UserComponent</code>ä¸­ä»<code>AppComponent</code>ç»§æ‰¿è¿‡æ¥çš„ä»ç„¶shiæ˜¯å•ä¾‹çš„ï¼ˆæ˜¯ Applicaton scopeï¼‰ã€‚ä½†æ˜¯<code>UserModule</code>ï¼ˆ<code>UserComponent</code>çš„é‚£éƒ¨åˆ†ï¼‰åˆ›å»ºçš„å¯¹è±¡å°†ä¼šæ˜¯â€œå±€éƒ¨å•ä¾‹â€ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸè·Ÿ<code>UserComponent</code>å®ä¾‹æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ¯æ¬¡ä¸€åˆ›å»ºå¦ä¸€ä¸ª<code>UserComponent</code>å®ä¾‹å°†ä¼šè°ƒç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UserComponent appComponent = appComponent.plus(<span class="keyword">new</span> UserModule(user))</span><br></pre></td></tr></table></figure>
<p>ä»<code>UserModule</code>ä¸­è·å–çš„å¯¹è±¡å°†æ˜¯ä¸åŒçš„å®ä¾‹ã€‚</p>
<p>ä½†æ˜¯è¿™é‡Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯ - æˆ‘ä»¬è¦è´Ÿè´£<code>UserComponent</code>çš„ç”Ÿå‘½å‘¨æœŸã€‚æ‰€ä»¥æˆ‘ä»¬åº”è¯¥å…³å¿ƒå®ƒçš„åˆå§‹åŒ–å’Œé‡Šæ”¾ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä¸ºå®ƒå¢åŠ äº†ä¸¤ä¸ªé¢å¤–çš„æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GithubClientApplication</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> AppComponent appComponent;</span><br><span class="line">    <span class="keyword">private</span> UserComponent userComponent;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserComponent <span class="title">createUserComponent</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        userComponent = appComponent.plus(<span class="keyword">new</span> UserModule(user));</span><br><span class="line">        <span class="keyword">return</span> userComponent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">releaseUserComponent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        userComponent = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>createUserComponent()</code>æ–¹æ³•ä¼šåœ¨æˆ‘ä»¬ä»Github APIï¼ˆåœ¨<code>SplashActivity</code>ä¸­ï¼‰è·å–åˆ°<code>User</code>å¯¹è±¡æ—¶è°ƒç”¨ã€‚<code>releaseUserComponent()</code>æ–¹æ³•ä¼šåœ¨æˆ‘ä»¬ä»<code>RepositoriesListActivity</code>ï¼ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¸å†éœ€è¦user scopeäº†ï¼‰ä¸­è¿”å›æ—¶è°ƒç”¨ã€‚</p>
<h2 id="Dagger-2ä¸­çš„Scope-å†…éƒ¨å®ç°"><a href="#Dagger-2ä¸­çš„Scope-å†…éƒ¨å®ç°" class="headerlink" title="Dagger 2ä¸­çš„Scope - å†…éƒ¨å®ç°"></a>Dagger 2ä¸­çš„Scope - å†…éƒ¨å®ç°</h2><p>æŸ¥çœ‹å®ƒçš„å†…éƒ¨çš„å·¥ä½œåŸç†æ˜¯å¾ˆä¸é”™çš„ã€‚é€šå¸¸åœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥ç¡®å®šï¼Œåœ¨Dagger 2çš„scopeæœºåˆ¶ä¸‹å¹¶ä¸å­˜åœ¨ä»€ä¹ˆé­”æ³•ã€‚</p>
<p>æˆ‘ä»¬ä»<code>UserModule.provideRepositoriesManager()</code>æ–¹æ³•å¼€å§‹ç ”ç©¶ã€‚å®ƒæä¾›äº†<code>RepositoriesManager</code>å®ä¾‹ï¼Œå®ƒåº”è¯¥ä½¿ç”¨<code>@UserScope</code>Scopeã€‚æˆ‘ä»¬æ¥æ£€éªŒè¿™ä¸ªæ–¹æ³•å“ªé‡Œè¢«è°ƒç”¨ï¼ˆç¬¬8è¡Œï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Generated</span>(<span class="string">"dagger.internal.codegen.ComponentProcessor"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">UserModule_ProvideRepositoriesManagerFactory</span> <span class="keyword">implements</span> <span class="title">Factory</span>&lt;<span class="title">RepositoriesManager</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> RepositoriesManager <span class="title">get</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    RepositoriesManager provided = <span class="keyword">module</span>.provideRepositoriesManager(userProvider.get(), githubApiServiceProvider.get());</span><br><span class="line">    <span class="keyword">if</span> (provided == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">"Cannot return null from a non-@Nullable @Provides method"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> provided;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Factory&lt;RepositoriesManager&gt; <span class="title">create</span><span class="params">(UserModule <span class="keyword">module</span>, Provider&lt;User&gt; userProvider, Provider&lt;GithubApiService&gt; githubApiServiceProvider)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> UserModule_ProvideRepositoriesManagerFactory(<span class="keyword">module</span>, userProvider, githubApiServiceProvider);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>UserModule_ProvideRepositoriesManagerFactory</code>ä»…ä»…æ˜¯ä¸€ä¸ªå·¥å‚æ¨¡å¼çš„ç°å®ï¼Œå®ƒä»<code>UserModule</code>ä¸­è·å–åˆ°<code>RepositoriesManager</code>å®ä¾‹ã€‚æˆ‘ä»¬åº”è¯¥å¾€æ›´æ·±å±‚æ¬¡æŒ–æ˜ã€‚</p>
<p><code>UserModule_ProvideRepositoriesManagerFactory</code>åœ¨<code>UserComponentImpl</code>ä¸­è¢«ä½¿ç”¨ - æˆ‘ä»¬componentçš„å®ç°ï¼ˆline 15ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">UserComponentImpl</span> <span class="keyword">implements</span> <span class="title">UserComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">UserComponentImpl</span><span class="params">(UserModule userModule)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (userModule == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">this</span>.userModule = userModule;</span><br><span class="line">      initialize();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.provideUserProvider = ScopedProvider.create(UserModule_ProvideUserFactory.create(userModule));</span><br><span class="line">      <span class="keyword">this</span>.provideRepositoriesManagerProvider = ScopedProvider.create(UserModule_ProvideRepositoriesManagerFactory.create(userModule, provideUserProvider, DaggerAppComponent.<span class="keyword">this</span>.provideGithubApiServiceProvider));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>provideRepositoriesManagerProvider</code>å¯¹è±¡åœ¨æˆ‘ä»¬æ¯æ¬¡è¯·æ±‚å®ƒæ—¶è´Ÿè´£æä¾›<code>RepositoriesManager</code>å®ä¾‹ã€‚å¦‚æˆ‘ä»¬æ‰€è§ï¼Œprovideræ˜¯é€šè¿‡<code>ScopedProvider</code>å®ç°çš„ã€‚æ¥çœ‹ä¸‹å®ƒçš„éƒ¨åˆ†ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ScopedProvider</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Provider</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">ScopedProvider</span><span class="params">(Factory&lt;T&gt; factory)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">assert</span> factory != <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">this</span>.factory = factory;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>) <span class="comment">// cast only happens when result comes from the factory</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// double-check idiom from EJ2: Item 71</span></span><br><span class="line">    Object result = instance;</span><br><span class="line">    <span class="keyword">if</span> (result == UNINITIALIZED) &#123;</span><br><span class="line">      <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">        result = instance;</span><br><span class="line">        <span class="keyword">if</span> (result == UNINITIALIZED) &#123;</span><br><span class="line">          instance = result = factory.get();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (T) result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†ç®€å•ä¸è¿‡äº†å§ï¼Ÿç¬¬ä¸€æ¬¡è°ƒç”¨<code>ScopedProvider</code>ä»factoryï¼ˆæˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯<code>UserModule_ProvideRepositoriesManagerFactory</code>ï¼‰ä¸­è·å–å®ä¾‹å¹¶åƒå•ä¾‹æ¨¡å¼ä¸€æ ·å­˜å‚¨èµ·æ¥ã€‚æˆ‘ä»¬çš„scoped provideråªæ˜¯<code>UserComponentImpl</code>ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œæ‰€ä»¥ç®€å•è¯´å°±æ˜¯<code>ScopedProvider</code>è¿”å›ä¸€ä¸ªä¸ä¾èµ–äºComponentçš„å•ä¾‹ã€‚</p>
<p>åœ¨è¿™é‡Œä½ å¯ä»¥æŸ¥çœ‹ <a href="https://github.com/google/dagger/blob/master/core/src/main/java/dagger/internal/ScopedProvider.java" target="_blank" rel="noopener">ScopedProvider</a> çš„æ‰€æœ‰çš„å®ç°ã€‚</p>
<p>å°±æ˜¯è¿™æ ·ã€‚æˆ‘ä»¬å¼„æ¸…æ¥šäº†Dagger 2ä¸­Scopeåº•å±‚æ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚ç°åœ¨æˆ‘ä»¬çŸ¥é“ï¼Œå®ƒä»¬æ²¡æœ‰ä»¥ä»»ä½•æ–¹å¼äºScopeæ³¨è§£è¿æ¥ã€‚è‡ªå®šä¹‰æ³¨è§£åªæ˜¯ç»™äº†æˆ‘ä»¬ä¸€ä¸ªç®€å•çš„æ–¹å¼æ¥è¿›è¡Œç¼–è¯‘æ—¶ä»£ç æ ¡éªŒå’Œæ ‡è®°ä¸€ä¸ªç±»æ˜¯å•ä¾‹/éå•ä¾‹ã€‚æ‰€æœ‰çš„scopeç›¸å…³ä¸œè¥¿éƒ½æ˜¯ä¸Componentçš„ç”Ÿå‘½å‘¨æœŸç›¸å…³è”ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯ä»Šå¤©çš„å…¨éƒ¨å†…å®¹ã€‚æˆ‘å¸Œæœ›ä»ç°åœ¨å¼€å§‹scopesä¼šå˜å¾—æ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚æ„Ÿè°¢é˜…è¯»ï¼</p>
<h3 id="ä»£ç ï¼š"><a href="#ä»£ç ï¼š" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h3><p>ä»¥ä¸Šæè¿°çš„å®Œæ•´ä»£ç å¯è§Github <a href="https://github.com/frogermcs/GithubClient" target="_blank" rel="noopener">repository</a>ã€‚</p>
<h2 id="ä½œè€…"><a href="#ä½œè€…" class="headerlink" title="ä½œè€…"></a>ä½œè€…</h2><p><a href="http://about.me/froger_mcs" target="_blank" rel="noopener">Miroslaw Stanek</a></p>
<p>Head of Mobile Development @ <a href="https://azimo.com/" target="_blank" rel="noopener">Azimo</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092083.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092083.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - APIï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092525.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092525.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5095426.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5095426.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5098943.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5098943.html</a></p>
<blockquote>
<p><strong>[Android]Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5193437.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5193437.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producersï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6234811.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6234811.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6236646.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6236646.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6237731.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6237731.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®šï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6266442.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6266442.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> google </tag>
            
            <tag> dagger2 </tag>
            
            <tag> DI </tag>
            
            <tag> dependency injection </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - APIï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2015/12/31/Android-%E4%BD%BF%E7%94%A8Dagger-2%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-API%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="ä½¿ç”¨Dagger-2ä¾èµ–æ³¨å…¥-API"><a href="#ä½¿ç”¨Dagger-2ä¾èµ–æ³¨å…¥-API" class="headerlink" title="ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - API"></a>ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - API</h1><blockquote>
<p>åŸæ–‡ï¼š<a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-the-api/" target="_blank" rel="noopener">http://frogermcs.github.io/dependency-injection-with-dagger-2-the-api/</a></p>
</blockquote>
<p>è¿™ç« æ˜¯å±•ç¤ºä½¿ç”¨Dagger 2åœ¨Androidç«¯å®ç°ä¾èµ–æ³¨å…¥çš„ç³»åˆ—ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ä»Šå¤©æˆ‘ä¼šæ¢ç´¢Dagger 2çš„åŸºç¡€å¹¶ä¸”å­¦ä¹ è¿™ä¸ªä¾èµ–æ³¨å…¥æ¡†æ¶çš„æ‰€æœ‰çš„APIã€‚</p>
<h2 id="Dagger-2"><a href="#Dagger-2" class="headerlink" title="Dagger 2"></a>Dagger 2</h2><p>åœ¨æˆ‘ä¸Šä¸€ç« ä¸­æˆ‘æåˆ°äº†DIæ¡†æ¶ç»™æˆ‘ä»¬å¸¦æ¥äº†ä»€ä¹ˆ - å®ƒè®©åªå†™ä¸€å°éƒ¨åˆ†ä»£ç å°±å¯ä»¥ä½¿ä¸€åˆ‡è”ç³»åœ¨ä¸€èµ·æˆä¸ºå¯èƒ½ã€‚Dagger 2å°±æ˜¯DIæ¡†æ¶çš„ä¸€ä¸ªä¾‹å­ï¼Œå®ƒå¯ä»¥ä¸ºæˆ‘ä»¬ç”Ÿæˆå¾ˆå¤šæ¨¡ç‰ˆä»£ç ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆå®ƒæ¯”å…¶å®ƒçš„è¦æ›´å¥½å‘¢ï¼Ÿç›®å‰ä¸ºæ­¢å®ƒæ˜¯å”¯ä¸€ä¸€ä¸ªå¯ä»¥ç”Ÿæˆå®Œæ•´æ¨¡ä»¿ç”¨æˆ·æ‰‹å†™çš„å¯è¿½è¸ªçš„ä»£ç çš„DIæ¡†æ¶ã€‚è¿™æ„å‘³ç€è®©ä¾èµ–å›¾è¡¨æ„å»ºè¿‡ç¨‹ä¸å†å……æ»¡é­”å¹»ã€‚Dagger 2ç›¸æ¯”å…¶å®ƒæ˜¯ä¸å…·æœ‰åŠ¨æ€æ€§çš„ï¼ˆä½¿ç”¨æ—¶å®Œå…¨ä¸ä½¿ç”¨åå°„ï¼‰ä½†æ˜¯ç”Ÿæˆçš„ä»£ç çš„ç®€æ´æ€§å’Œæ€§èƒ½éƒ½æ˜¯ä¸æ‰‹å†™çš„ä»£ç åŒæ°´å‡†çš„ã€‚</p>
<h3 id="Dagger-2-åŸºç¡€"><a href="#Dagger-2-åŸºç¡€" class="headerlink" title="Dagger 2 åŸºç¡€"></a>Dagger 2 åŸºç¡€</h3><p>ä¸‹é¢æ˜¯Dagger 2çš„APIï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Component &#123;</span><br><span class="line">    Class&lt;?&gt;[] modules() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    Class&lt;?&gt;[] dependencies() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Subcomponent &#123;</span><br><span class="line">    Class&lt;?&gt;[] modules() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Module &#123;</span><br><span class="line">    Class&lt;?&gt;[] includes() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Provides &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MapKey &#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">unwrapValue</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Lazy</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">T <span class="title">get</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰åœ¨Dagger 2ä¸­ç”¨åˆ°çš„å®šä¹‰åœ¨ <a href="https://jcp.org/en/jsr/detail?id=330" target="_blank" rel="noopener">JSR-330</a> ï¼ˆJavaä¸­ä¾èµ–æ³¨å…¥çš„æ ‡å‡†ï¼‰ä¸­çš„å…¶å®ƒå…ƒç´ ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Inject &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Scope &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Qualifier &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è®©æˆ‘ä»¬æ¥å­¦ä¹ å®ƒä»¬ã€‚</p>
<h4 id="Inject-æ³¨è§£"><a href="#Inject-æ³¨è§£" class="headerlink" title="@Inject æ³¨è§£"></a>@Inject æ³¨è§£</h4><p>DIä¸­ç¬¬ä¸€ä¸ªå¹¶ä¸”æ˜¯æœ€é‡è¦çš„å°±æ˜¯<code>@Inject</code>æ³¨è§£ã€‚JSR-330æ ‡å‡†ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæ ‡è®°é‚£äº›åº”è¯¥è¢«ä¾èµ–æ³¨å…¥æ¡†æ¶æä¾›çš„ä¾èµ–ã€‚åœ¨Dagger 2ä¸­æœ‰3ç§ä¸åŒçš„æ–¹å¼æ¥æä¾›ä¾èµ–ï¼š</p>
<h5 id="æ„é€ å™¨æ³¨å…¥ï¼š"><a href="#æ„é€ å™¨æ³¨å…¥ï¼š" class="headerlink" title="æ„é€ å™¨æ³¨å…¥ï¼š"></a>æ„é€ å™¨æ³¨å…¥ï¼š</h5><p><code>@Inject</code>ä½¿ç”¨åœ¨ç±»çš„æ„é€ å™¨ä¸Šï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginActivityPresenter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LoginActivity loginActivity;</span><br><span class="line">    <span class="keyword">private</span> UserDataStore userDataStore;</span><br><span class="line">    <span class="keyword">private</span> UserManager userManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoginActivityPresenter</span><span class="params">(LoginActivity loginActivity,</span></span></span><br><span class="line"><span class="function"><span class="params">                                  UserDataStore userDataStore,</span></span></span><br><span class="line"><span class="function"><span class="params">                                  UserManager userManager)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.loginActivity = loginActivity;</span><br><span class="line">        <span class="keyword">this</span>.userDataStore = userDataStore;</span><br><span class="line">        <span class="keyword">this</span>.userManager = userManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€æœ‰çš„å‚æ•°éƒ½æ˜¯é€šè¿‡ä¾èµ–å›¾è¡¨ä¸­è·å–ã€‚<code>@Inject</code>æ³¨è§£è¢«ä½¿ç”¨åœ¨æ„é€ å™¨ä¸­ä¹Ÿä¼šæ ‡è®°è¿™ä¸ªç±»ä¸ºä¾èµ–å›¾è¡¨çš„ä¸€éƒ¨åˆ†ã€‚è¿™æ„å‘³ç€å®ƒä¹Ÿå¯ä»¥åœ¨æˆ‘ä»¬éœ€è¦çš„æ—¶å€™è¢«æ³¨å…¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginActivity</span> <span class="keyword">extends</span> <span class="title">BaseActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    LoginActivityPresenter presenter;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ä¸­çš„å±€é™æ€§æ˜¯æˆ‘ä»¬ä¸èƒ½ç»™è¿™ä¸ªç±»ä¸­çš„å¤šä¸ªæ„é€ å™¨ä½œ<code>@Inject</code>æ³¨è§£ã€‚</p>
<h5 id="å±æ€§æ³¨å…¥"><a href="#å±æ€§æ³¨å…¥" class="headerlink" title="å±æ€§æ³¨å…¥"></a>å±æ€§æ³¨å…¥</h5><p>å¦ä¸€ç§é€‰æ‹©æ˜¯ç»™æŒ‡å®šçš„å±æ€§ä½œ<code>@Inject</code>æ³¨è§£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SplashActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    LoginActivityPresenter presenter;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    AnalyticsManager analyticsManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle bundle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(bundle);</span><br><span class="line">        getAppComponent().inject(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ³¨å…¥è¿‡ç¨‹å¿…é¡»è¦åœ¨æˆ‘ä»¬ç±»çš„æŸå¤„â€œæ‰‹åŠ¨â€è°ƒç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SplashActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle bundle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(bundle);</span><br><span class="line">        getAppComponent().inject(<span class="keyword">this</span>);    <span class="comment">//Requested depenencies are injected in this moment</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªè°ƒç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬çš„ä¾èµ–æ˜¯nullå€¼ã€‚</p>
<p>å±æ€§æ³¨å…¥çš„å±€é™æ€§æ˜¯æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨<code>private</code>ã€‚ä¸ºä»€ä¹ˆï¼Ÿç®€å•è¯´ï¼Œç”Ÿæˆçš„ä»£ç ä¼šç›´æ¥åœ°è°ƒç”¨å®ƒä»¬æ¥è®¾ç½®å±æ€§ï¼Œå°±åƒè¿™é‡Œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//This class is generated automatically by Dagger 2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">SplashActivity_MembersInjector</span> <span class="keyword">implements</span> <span class="title">MembersInjector</span>&lt;<span class="title">SplashActivity</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">injectMembers</span><span class="params">(SplashActivity splashActivity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (splashActivity == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">"Cannot inject members into a null reference"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        supertypeInjector.injectMembers(splashActivity);</span><br><span class="line">        splashActivity.presenter = presenterProvider.get();</span><br><span class="line">        splashActivity.analyticsManager = analyticsManagerProvider.get();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="æ–¹æ³•æ³¨å…¥"><a href="#æ–¹æ³•æ³¨å…¥" class="headerlink" title="æ–¹æ³•æ³¨å…¥"></a>æ–¹æ³•æ³¨å…¥</h5><p>æœ€åä¸€ç§æ–¹æ³•ä½¿ç”¨<code>@Inject</code>æ³¨è§£æä¾›ä¾èµ–çš„æ–¹å¼æ˜¯åœ¨è¿™ä¸ªç±»çš„<code>public</code>æ–¹æ³•ä¸­ä½œæ³¨è§£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginActivityPresenter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LoginActivity loginActivity;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoginActivityPresenter</span><span class="params">(LoginActivity loginActivity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.loginActivity = loginActivity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">enableWatches</span><span class="params">(Watches watches)</span> </span>&#123;</span><br><span class="line">        watches.register(<span class="keyword">this</span>);    <span class="comment">//Watches instance required fully constructed LoginActivityPresenter</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ–¹æ³•çš„æ‰€æœ‰å‚æ•°éƒ½æ˜¯é€šè¿‡ä¾èµ–å›¾è¡¨æä¾›çš„ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æ–¹æ³•æ³¨å…¥å‘¢ï¼Ÿåœ¨æŸäº›æƒ…å†µä¸‹ä¼šç”¨åˆ°ï¼Œå¦‚å½“æˆ‘ä»¬å¸Œæœ›ä¼ å…¥ç±»çš„å½“å‰å®ä¾‹ï¼ˆ<code>this</code>å¼•ç”¨ï¼‰åˆ°è¢«æ³¨å…¥çš„ä¾èµ–ä¸­ã€‚æ–¹æ³•æ³¨å…¥ä¼šåœ¨æ„é€ å™¨è°ƒç”¨åé©¬ä¸Šè¢«è°ƒç”¨ï¼Œæ‰€ä»¥è¿™è¡¨ç¤ºæˆ‘ä»¬å¯ä»¥ä¼ å…¥å®Œå…¨è¢«æ„é€ çš„<code>this</code>ã€‚</p>
<h4 id="Module-æ³¨è§£"><a href="#Module-æ³¨è§£" class="headerlink" title="@Module æ³¨è§£"></a>@Module æ³¨è§£</h4><p><code>@Module</code>æ˜¯Dagger 2 APIçš„ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ªæ³¨è§£ç”¨äºæ ‡è®°æä¾›ä¾èµ–çš„ç±» - å¤šäºå®ƒDaggeræ‰ä¼šçŸ¥é“æŸäº›åœ°æ–¹éœ€è¦çš„å¯¹è±¡è¢«æ„å»ºã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GithubApiModule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    <span class="function">OkHttpClient <span class="title">provideOkHttpClient</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">        okHttpClient.setConnectTimeout(<span class="number">60</span> * <span class="number">1000</span>, TimeUnit.MILLISECONDS);</span><br><span class="line">        okHttpClient.setReadTimeout(<span class="number">60</span> * <span class="number">1000</span>, TimeUnit.MILLISECONDS);</span><br><span class="line">        <span class="keyword">return</span> okHttpClient;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    <span class="function">RestAdapter <span class="title">provideRestAdapter</span><span class="params">(Application application, OkHttpClient okHttpClient)</span> </span>&#123;</span><br><span class="line">        RestAdapter.Builder builder = <span class="keyword">new</span> RestAdapter.Builder();</span><br><span class="line">        builder.setClient(<span class="keyword">new</span> OkClient(okHttpClient))</span><br><span class="line">               .setEndpoint(application.getString(R.string.endpoint));</span><br><span class="line">        <span class="keyword">return</span> builder.build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">view rawGithubApiModule.java hosted with â¤ by GitHub</span><br></pre></td></tr></table></figure>
<h4 id="Provides-æ³¨è§£"><a href="#Provides-æ³¨è§£" class="headerlink" title="@Provides æ³¨è§£"></a>@Provides æ³¨è§£</h4><p>è¿™ä¸ªæ³¨è§£ç”¨åœ¨<code>@Module</code>ç±»ä¸­ã€‚<code>@Provides</code>ä¼šæ ‡è®°Moduleä¸­é‚£äº›è¿”å›ä¾èµ–çš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GithubApiModule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span>   <span class="comment">//This annotation means that method below provides dependency</span></span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    <span class="function">RestAdapter <span class="title">provideRestAdapter</span><span class="params">(Application application, OkHttpClient okHttpClient)</span> </span>&#123;</span><br><span class="line">        RestAdapter.Builder builder = <span class="keyword">new</span> RestAdapter.Builder();</span><br><span class="line">        builder.setClient(<span class="keyword">new</span> OkClient(okHttpClient))</span><br><span class="line">               .setEndpoint(application.getString(R.string.endpoint));</span><br><span class="line">        <span class="keyword">return</span> builder.build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Component-æ³¨è§£"><a href="#Component-æ³¨è§£" class="headerlink" title="@Component æ³¨è§£"></a>@Component æ³¨è§£</h4><p>è¿™ä¸ªæ³¨è§£ç”¨åœ¨æŠŠä¸€åˆ‡è”ç³»åœ¨ä¸€èµ·çš„æ¥å£ä¸Šé¢ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä»å“ªäº›moduleï¼ˆæˆ–è€…å“ªäº›Componentsï¼‰ä¸­è·å–ä¾èµ–ã€‚è¿™é‡Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å“ªäº›å›¾è¡¨ä¾èµ–åº”è¯¥å…¬å¼€å¯è§ï¼ˆå¯ä»¥è¢«æ³¨å…¥ï¼‰å’Œå“ªé‡Œæˆ‘ä»¬çš„componentå¯ä»¥æ³¨å…¥å¯¹è±¡ã€‚<code>@Component</code>é€šå¸¸æ˜¯<code>@Module</code>å’Œ<code>@Inject</code>ä¹‹é—´çš„æ¡¥æ¢ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸ªä½¿ç”¨äº†ä¸¤ä¸ªmoduleçš„<code>@Component</code>ä¾‹å­ä»£ç ï¼Œå¯ä»¥æ³¨å…¥ä¾èµ–åˆ°<code>GithubClientApplication</code>ï¼Œå¹¶ä¸”æ ‡è®°äº†ä¸‰ä¸ªä¾èµ–å…¬å¼€å¯è§ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Component</span>(</span><br><span class="line">    modules = &#123;</span><br><span class="line">        AppModule.class,</span><br><span class="line">        GithubApiModule.class</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AppComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inject</span><span class="params">(GithubClientApplication githubClientApplication)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Application <span class="title">getApplication</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">AnalyticsManager <span class="title">getAnalyticsManager</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">UserManager <span class="title">getUserManager</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@Component</code>ä¹Ÿå¯ä»¥ä¾èµ–å…¶å®ƒçš„componentï¼Œå¹¶ä¸”å®šä¹‰äº†ç”Ÿå‘½å‘¨æœŸï¼ˆæˆ‘ä¼šåœ¨ä»¥åçš„æ–‡ç« ä¸­è®²è§£Scopeï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ActivityScope</span></span><br><span class="line"><span class="meta">@Component</span>(      </span><br><span class="line">    modules = SplashActivityModule.class,</span><br><span class="line">    dependencies = AppComponent.class</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SplashActivityComponent</span> </span>&#123;</span><br><span class="line">    <span class="function">SplashActivity <span class="title">inject</span><span class="params">(SplashActivity splashActivity)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">SplashActivityPresenter <span class="title">presenter</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Scope-æ³¨è§£"><a href="#Scope-æ³¨è§£" class="headerlink" title="@Scope æ³¨è§£"></a>@Scope æ³¨è§£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scope</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> ActivityScope &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>JSR-330æ ‡å‡†çš„åˆä¸€éƒ¨åˆ†ã€‚åœ¨Dagger 2ä¸­ï¼Œ<code>@Scope</code>è¢«ç”¨äºæ ‡è®°è‡ªå®šä¹‰çš„scopeæ³¨è§£ã€‚ç®€å•è¯´å®ƒä»¬å¯ä»¥ç±»ä¼¼å•ä¾‹åœ°æ ‡è®°ä¾èµ–ã€‚è¢«ä½œæ³¨è§£çš„ä¾èµ–ä¼šå˜æˆå•ä¾‹ï¼Œä½†æ˜¯è¿™ä¼šä¸componentçš„ç”Ÿå‘½å‘¨æœŸï¼ˆä¸æ˜¯æ•´ä¸ªåº”ç”¨ï¼‰å…³è”ã€‚ä½†æ˜¯æ­£å¦‚æˆ‘åˆšæ‰æ‰€è¯´ - æˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­æ·±å…¥scopeã€‚ç°åœ¨å€¼å¾—ä¸€æçš„æ˜¯æ‰€æœ‰è‡ªå®šä¹‰scopeåšçš„æ˜¯åŒæ ·çš„äº‹æƒ…ï¼ˆä»ä»£ç è§’åº¦ï¼‰- å®ƒä»¬ä¸ºå¯¹è±¡ä¿æŒå•ä¾‹ã€‚ä½†æ˜¯ä»–ä»¬ä¹Ÿä¼šè¢«åœ¨å›¾è¡¨è®¤è¯å¤„ç†ä¸­ä½¿ç”¨ï¼Œè¿™å¯¹å°½å¯èƒ½åœ°æ•æ‰å›¾è¡¨ç»“æ„é—®é¢˜æ˜¯æœ‰å¸®åŠ©çš„ã€‚</p>
<hr>
<p>æ¥ä¸‹æ¥æ˜¯ä¸€äº›ä¸å¤ªé‡è¦ï¼Œä¸ä¼šç»å¸¸ç”¨åˆ°çš„ä¸œè¥¿ï¼š</p>
<h4 id="MapKey"><a href="#MapKey" class="headerlink" title="MapKey"></a>MapKey</h4><p>è¿™ä¸ªæ³¨è§£ç”¨åœ¨å®šä¹‰ä¸€äº›ä¾èµ–é›†åˆï¼ˆç›®å‰ä¸ºæ­¢ï¼ŒMapså’ŒSetsï¼‰ã€‚è®©ä¾‹å­ä»£ç è‡ªå·±æ¥è§£é‡Šå§ï¼š</p>
<p>å®šä¹‰ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapKey</span>(unwrapValue = <span class="keyword">true</span>)</span><br><span class="line"><span class="meta">@interface</span> TestKey &#123;</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æä¾›ä¾èµ–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Provides</span>(type = Type.MAP)</span><br><span class="line"><span class="meta">@TestKey</span>(<span class="string">"foo"</span>)</span><br><span class="line"><span class="function">String <span class="title">provideFooKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"foo value"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Provides</span>(type = Type.MAP)</span><br><span class="line"><span class="meta">@TestKey</span>(<span class="string">"bar"</span>)</span><br><span class="line"><span class="function">String <span class="title">provideBarKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"bar value"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inject</span></span><br><span class="line">Map&lt;String, String&gt; map;</span><br><span class="line"></span><br><span class="line">map.toString() <span class="comment">// =&gt; â€&#123;foo=foo value, bar=bar value&#125;â€</span></span><br></pre></td></tr></table></figure>
<p><code>@MapKey</code>æ³¨è§£ç›®å‰åªæä¾›ä¸¤ç§ç±»å‹ - Stringå’ŒEnumã€‚</p>
<h4 id="Qualifier"><a href="#Qualifier" class="headerlink" title="@Qualifier"></a>@Qualifier</h4><p><code>@Qualifier</code>æ³¨è§£å¸®åŠ©æˆ‘ä»¬å»ä¸ºç›¸åŒæ¥å£çš„ä¾èµ–åˆ›å»ºâ€œtagsâ€ã€‚æƒ³è±¡ä¸‹ä½ éœ€è¦æä¾›ä¸¤ä¸ª<code>RestAdapter</code>å¯¹è±¡ - ä¸€ä¸ªç”¨äºGithub APIï¼Œå¦ä¸€ä¸ªç”¨äºFackbook APIã€‚<code>Qualifier</code>ä¼šå¸®åŠ©ä½ åŒºåˆ†å¯¹åº”çš„ä¸€ä¸ªï¼š</p>
<p>å‘½åä¾èµ–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Provides</span></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@GithubRestAdapter</span>  <span class="comment">//Qualifier</span></span><br><span class="line"><span class="function">RestAdapter <span class="title">provideRestAdapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> RestAdapter.Builder()</span><br><span class="line">        .setEndpoint(<span class="string">"https://api.github.com"</span>)</span><br><span class="line">        .build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Provides</span></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@FacebookRestAdapter</span>  <span class="comment">//Qualifier</span></span><br><span class="line"><span class="function">RestAdapter <span class="title">provideRestAdapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> RestAdapter.Builder()</span><br><span class="line">        .setEndpoint(<span class="string">"https://api.facebook.com"</span>)</span><br><span class="line">        .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨å…¥ä¾èµ–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inject</span></span><br><span class="line"><span class="meta">@GithubRestAdapter</span></span><br><span class="line">RestAdapter githubRestAdapter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Inject</span></span><br><span class="line"><span class="meta">@FacebookRestAdapter</span></span><br><span class="line">RestAdapter facebookRestAdapter;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå°±æ˜¯å…¨éƒ¨äº†ã€‚æˆ‘ä»¬åˆšåˆšå·²ç»äº†è§£äº†æ‰€æœ‰Dagger 2 APIä¸­é‡è¦çš„å…ƒç´ äº†ã€‚</p>
<h3 id="App-example"><a href="#App-example" class="headerlink" title="App example"></a>App example</h3><p>ç°åœ¨æ˜¯æ—¶å€™è®©æˆ‘ä»¬åœ¨å®è·µä¸­æ£€éªŒæˆ‘ä»¬çš„çŸ¥è¯†äº†ã€‚æˆ‘ä»¬ä¼šåŸºäºDagger 2æ¥å®ç°ä¸€ä¸ªç®€å•çš„Githubå®¢æˆ·ç«¯appã€‚</p>
<h4 id="æƒ³æ³•"><a href="#æƒ³æ³•" class="headerlink" title="æƒ³æ³•"></a>æƒ³æ³•</h4><p>æˆ‘ä»¬çš„Githubå®¢æˆ·ç«¯æœ‰ä¸‰ä¸ªActivityå’Œéå¸¸ç®€å•çš„ä½¿ç”¨caseã€‚å®ƒçš„å…¨éƒ¨æµç¨‹ï¼š</p>
<p>1. è¾“å…¥Githubç”¨æˆ·å<br>2. å¦‚æœç”¨æˆ·å­˜åœ¨åˆ™æ˜¾ç¤ºå®ƒæ‰€æœ‰å…¬å¼€çš„åº“ã€‚<br>3. å½“ç”¨æˆ·æŒ‰ä¸‹listçš„itemåæ˜¾ç¤ºåº“çš„è¯¦æƒ…ã€‚</p>
<p>è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„appçœ‹èµ·æ¥çš„æ ·å­ï¼š</p>
<p><img src="http://frogermcs.github.io/images/14/app_flow.png" alt=""></p>
<p>åœ¨å†…éƒ¨ï¼Œä»DIè§’åº¦æˆ‘ä»¬çš„appç»“æ„çœ‹èµ·æ¥å¦‚ä¸‹ï¼š</p>
<p><img src="http://frogermcs.github.io/images/14/local_components.png" alt=""></p>
<p>ç®€å•è¯´ - æ¯ä¸€ä¸ªActivityéƒ½æœ‰å®ƒè‡ªå·±çš„ä¾èµ–å›¾è¡¨ã€‚æ¯ä¸ªå›¾è¡¨ï¼ˆ_Componentç±»ï¼‰æœ‰ä¸¤ä¸ªå¯¹è±¡ - <code>_Prresenter</code>å’Œ<code>_Activity</code>ã€‚æ¯ä¸ªcomponentä¹Ÿä¼šä»å…¨å±€çš„componentï¼ˆ<code>AppComponent</code>ï¼ŒåŒ…å«äº†<code>Application</code>, <code>UserManager</code>, <code>RepositoriesManager</code>ç­‰ï¼‰ä¸­è·å–ä¾èµ–ã€‚</p>
<p><img src="http://frogermcs.github.io/images/14/app_component.png" alt=""></p>
<p>è®²è®²<code>AppComponent</code> - çœ‹ä¸Šé¢æœ€è¿‘çš„å›¾è¡¨ã€‚å®ƒåŒ…å«äº†ä¸¤ä¸ªmodulesï¼š<code>AppModule</code>å’Œ<code>GithubApiModule</code>ã€‚</p>
<p><code>GithubApiModule</code>æä¾›äº†ä¸€äº›ä¾èµ–ï¼Œæ¯”å¦‚<code>OkHttpClient</code>æˆ–<code>RestAdapter</code>ï¼Œä»–ä»¬åªä¼šåœ¨è¿™ä¸ªmoduleçš„å…¶å®ƒä¾èµ–ä½¿ç”¨ã€‚åœ¨Dagger 2ä¸­æˆ‘ä»¬å¯ä»¥æ§åˆ¶å“ªäº›å¯¹è±¡å¯¹å¤–éƒ¨çš„componentå¯è§ã€‚åœ¨æˆ‘ä»¬ä¾‹å­ä¸­æˆ‘ä»¬ä¸å¸Œæœ›æš´éœ²è¿™äº›è¢«ä½¿ç”¨äº†çš„å¯¹è±¡ã€‚æ‰€ä»¥æˆ‘ä»¬åªæ˜¯æš´éœ²äº†<code>UserManager</code>å’Œ<code>RepositoriesManager</code>ï¼Œå› ä¸ºè¿™æœ‰è¿™äº›å¯¹è±¡æ‰ä¼šè¢«æˆ‘ä»¬çš„Activityç”¨åˆ°ã€‚æ‰€æœ‰éƒ½é€šè¿‡publicã€è¿”å›évoidç±»å‹å¹¶æ— å‚æ•°çš„æ–¹æ³•è¢«å®šä¹‰ã€‚</p>
<p>æ–‡æ¡£ä¸­çš„ä¾‹å­ï¼š</p>
<p><strong>æä¾›ä¾èµ–çš„æ–¹æ³•</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">SomeType <span class="title">getSomeType</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">Set&lt;SomeType&gt; <span class="title">getSomeTypes</span><span class="params">()</span></span>;</span><br><span class="line"><span class="meta">@PortNumber</span> <span class="function"><span class="keyword">int</span> <span class="title">getPortNumber</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤–ï¼Œæˆ‘ä»¬å¿…é¡»è¦å®šä¹‰å“ªé‡Œæˆ‘ä»¬å¸Œæœ›è¦å»æ³¨å…¥ä¾èµ–ï¼ˆé€šè¿‡æˆå‘˜æ³¨å…¥ï¼‰ã€‚åœ¨æˆ‘ä»¬ä¾‹å­ä¸­<code>AppComponent</code>æ²¡æœ‰ä»»ä½•åœ°æ–¹å¯ä»¥å»æ³¨å…¥ï¼Œå› ä¸ºå®ƒåªæ˜¯ä½œä¸ºæˆ‘ä»¬Componentsçš„ä¾èµ–ã€‚æ‰€ä»¥å®ƒä»¬æ¯ä¸€ä¸ªéƒ½è¢«å®šä¹‰äº† ä¸€ä¸ª<code>inject(_Activity activity)</code>æ–¹æ³•ã€‚è¿™é‡Œæˆ‘ä»¬ä¹Ÿæœ‰ä¸€äº›ç®€å•çš„è§„åˆ™ - æ³¨å…¥é€šè¿‡ä¸€ä¸ªå•ä¸ªå‚æ•°çš„æ–¹æ³•è¢«å®šä¹‰ï¼ˆå®šä¹‰ä¸€ä¸ªå®ä¾‹ï¼Œå®ƒä»£è¡¨æˆ‘ä»¬éœ€è¦å¾€è¿™ä¸ªå®ä¾‹ä¸­æ³¨å…¥ä¾èµ–ï¼‰ï¼Œå®ƒå¯ä»¥æœ‰ä»»æ„çš„åå­—ï¼Œä½†æ˜¯å¿…é¡»è¦è¿”å›ç±»å‹æ˜¯voidæˆ–è€…è¿”å›è¢«ä¼ å…¥çš„å‚æ•°ç±»å‹ã€‚</p>
<p>æ–‡æ¡£ä¸­çš„ä¾‹å­ï¼š</p>
<p><strong>æˆå‘˜æ³¨å…¥çš„æ–¹æ³•</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">SomeType <span class="title">getSomeType</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">Provider&lt;SomeType&gt; <span class="title">getSomeTypeProvider</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">Lazy&lt;SomeType&gt; <span class="title">getLazySomeType</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<h4 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h4><p>æˆ‘ä¸æƒ³æ·±å…¥å¤ªå¤šçš„ä»£ç ã€‚clone <a href="https://github.com/frogermcs/GithubClient" target="_blank" rel="noopener">GithubClient</a> ä»£ç å¹¶å¯¼å…¥åˆ°æœ€æ–°çš„Android Studioã€‚è¿™é‡Œç»™å‡ºä¸€äº›å¼€å§‹çš„æç¤ºï¼š</p>
<h4 id="Dagger-2-å®‰è£…"><a href="#Dagger-2-å®‰è£…" class="headerlink" title="Dagger 2 å®‰è£…"></a>Dagger 2 å®‰è£…</h4><p>åªéœ€è¦è·å¾—<code>/app/build.gradle</code>æ–‡ä»¶ã€‚æˆ‘ä»¬éœ€è¦å¢åŠ Dagger 2ä¾èµ–å’Œä½¿ç”¨ <a href="https://bitbucket.org/hvisser/android-apt" target="_blank" rel="noopener">android-apt</a> æ’ä»¶æ¥å¯¹ç”Ÿæˆçš„ä»£ç å’ŒAndroid Studio IDEä¹‹é—´è¿›è¡Œç»‘å®šã€‚</p>
<h5 id="AppComponent"><a href="#AppComponent" class="headerlink" title="AppComponent"></a>AppComponent</h5><p>ä»<code>GithubClientApplication</code>ç±»å¼€å§‹æ¢ç´¢ã€‚åœ¨è¿™é‡Œ<code>AppComponent</code>ä¼šè¢«åˆ›å»ºå’Œå­˜å‚¨ã€‚è¿™æ„å‘³ç€æ‰€æœ‰å•ä¾‹çš„å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸéƒ½ä¼šä¸Applicaitonä¸€è‡´ï¼ˆæ‰€ä»¥æ¯æ—¶æ¯åˆ»éƒ½æ˜¯å¦‚æ­¤ï¼‰ã€‚</p>
<p><code>AppComponent</code>çš„å®ç°ç”±Dagger 2ï¼ˆå¯¹è±¡å¯ä»¥é€šè¿‡builderæ¨¡å¼è¢«åˆ›å»ºï¼‰ç”Ÿæˆçš„ä»£ç æä¾›ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ”¾å…¥æ‰€æœ‰çš„Componentçš„ä¾èµ–ï¼ˆmoduleå’Œå…¶ä»–componentsï¼‰ã€‚</p>
<h5 id="é™å®šçš„component"><a href="#é™å®šçš„component" class="headerlink" title="é™å®šçš„component"></a>é™å®šçš„component</h5><p>å¯ä»¥é€šè¿‡<code>SplashActivity</code>æ¥æ¢ç´¢Activities Componentsæ˜¯æ€ä¹ˆåˆ›å»ºçš„ã€‚å®ƒé‡å†™äº†<code>setupActivityComponent(AppComponent)</code>ï¼Œåœ¨è¿™é‡Œå®ƒåˆ›å»ºå®ƒè‡ªå·±çš„Componentï¼ˆ<code>SplashActivityComponent</code>ï¼‰ï¼Œç„¶åæ³¨å…¥æ‰€æœ‰è¢«åš<code>@Inject</code>æ³¨è§£çš„ä¾èµ–ï¼ˆè¿™ä¸ªä¾‹å­ä¸­çš„<code>SplashActivityPresenter</code>å’Œ<code>AnalyticsManager</code>ï¼‰ã€‚</p>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬ä¹Ÿä¼šæä¾›AppComponentå®ä¾‹ï¼ˆå› ä¸º<code>SplashActivityComponent</code>æ˜¯ä¾èµ–å®ƒçš„ï¼‰ä»¥åŠ<code>SplashActivityModule</code>ï¼ˆå®ƒæä¾›äº†Presenterå’ŒActivityå®ä¾‹ï¼‰ã€‚</p>
<p>å‰©ä¸‹çš„å°±é ä½ è‡ªå·±äº†ã€‚è®¤çœŸçš„è¯´ - å°è¯•å¼„æ¸…æ¥šä¸€åˆ‡æ˜¯æ€ä¹ˆåˆé€‚åœ°è”ç³»åœ¨ä¸€èµ·çš„ã€‚ä¸‹ä¸€ç« èŠ‚æˆ‘ä»¬å°è¯•æ·±å…¥Dagger 2çš„é‚£äº›ç´§å¯†çš„å…ƒç´ ï¼ˆåœ¨åº•å±‚å®ƒä»¬æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼‰ã€‚</p>
<h3 id="ä»£ç ï¼š"><a href="#ä»£ç ï¼š" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h3><p>ä»¥ä¸Šæè¿°çš„å®Œæ•´ä»£ç å¯è§Github <a href="https://github.com/frogermcs/GithubClient/tree/1bf53a2a36c8a85435e877847b987395e482ab4a" target="_blank" rel="noopener">repository</a>ã€‚</p>
<h2 id="ä½œè€…"><a href="#ä½œè€…" class="headerlink" title="ä½œè€…"></a>ä½œè€…</h2><p><a href="http://about.me/froger_mcs" target="_blank" rel="noopener">Miroslaw Stanek</a></p>
<p>Head of Mobile Development @ <a href="https://azimo.com/" target="_blank" rel="noopener">Azimo</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092083.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092083.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - APIï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092525.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092525.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5095426.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5095426.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5098943.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5098943.html</a></p>
<blockquote>
<p><strong>[Android]Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5193437.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5193437.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producersï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6234811.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6234811.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6236646.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6236646.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6237731.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6237731.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®šï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6266442.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6266442.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> google </tag>
            
            <tag> dagger2 </tag>
            
            <tag> DI </tag>
            
            <tag> dependency injection </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»ï¼ˆç¿»è¯‘ï¼‰]]></title>
      <url>/2015/12/31/Android-%E4%BD%BF%E7%94%A8Dagger-2%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-DI%E4%BB%8B%E7%BB%8D%EF%BC%88%E7%BF%BB%E8%AF%91%EF%BC%89/</url>
      <content type="html"><![CDATA[<h2 id="ä½¿ç”¨Dagger-2ä¾èµ–æ³¨å…¥-DIä»‹ç»"><a href="#ä½¿ç”¨Dagger-2ä¾èµ–æ³¨å…¥-DIä»‹ç»" class="headerlink" title="ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»"></a>ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»</h2><blockquote>
<p>åŸæ–‡ï¼š<a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-introdution-to-di/" target="_blank" rel="noopener">http://frogermcs.github.io/dependency-injection-with-dagger-2-introdution-to-di/</a></p>
</blockquote>
<p>ä¸ä¹…ä¹‹å‰ï¼Œåœ¨å…‹æ‹‰ç§‘å¤«çš„ <a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-introdution-to-di/" target="_blank" rel="noopener">Tech Space</a> çš„ Google I/O æ‰©å±•ä¸­ï¼Œæˆ‘ <a href="https://speakerdeck.com/frogermcs/dependency-injection-with-dagger-2" target="_blank" rel="noopener">å±•ç¤º</a> äº†ä¸€äº›å…³äºä½¿ç”¨Dagger 2æ¥è¿›è¡Œä¾èµ–æ³¨å…¥ã€‚åœ¨å‡†å¤‡æœŸé—´æˆ‘è®¤è¯†åˆ°æœ‰å¤ªå¤šç›¸å…³çš„ä¸œè¥¿éœ€è¦å»è®²ï¼Œæ— æ³•ç”¨ä¸€æ‰“å¹»ç¯ç‰‡å°±èƒ½è¦†ç›–åˆ°å…¨éƒ¨ã€‚ä½†æ˜¯å®ƒå¯ä»¥ä½œä¸ºä¸€ä¸ªå¾ˆå¥½çš„è¿›å…¥ç‚¹æ¥å¼€å±•æ›´å¤šè¿™ä¸€ç³»åˆ—ä¸»é¢˜ï¼Androidç«¯çš„ä¾èµ–æ³¨å…¥ã€‚</p>
<p>åœ¨è¿™ä¸€ç« ä¸­æˆ‘ä¼šå»é€šè¿‡ä¹‹å‰æ‰€å±•ç¤ºçš„æ¥è¿›è¡Œä¸€ä¸ªæ€»ç»“ã€‚å¯èƒ½å¹¶ä¸æ˜¯æŒ‰éƒ¨å°±ç­çš„ - æˆ‘è®¤ä¸ºç°åœ¨æ˜¯æ—¶å€™æ‰“ç ´è¿‡å»ï¼Œä½¿ç”¨ä¸€äº›åŸæœ¬æˆ‘ä»¬ä¸ä¼šä½¿ç”¨æˆ–è€…ä¸åº”è¯¥ä½¿ç”¨çš„æ–¹æ³•æ¥è§£å†³é—®é¢˜äº†ã€‚<strong>Jake Wharton</strong> <a href="https://www.parleys.com/tutorial/5471cdd1e4b065ebcfa1d557/" target="_blank" rel="noopener">è®²è¿°</a> äº†ç›¸å…³å†å²ï¼ˆGuice, Dagger 1ï¼‰ï¼Œ<strong>Gregory Kick</strong> <a href="https://www.youtube.com/watch?v=oK_XtfXPkqw" target="_blank" rel="noopener">ä¹Ÿæ˜¯</a>ï¼ˆå‡ ä¹æœ‰ä¸€åŠæ˜¯å…³äºSpring, Guice, Dagger 1ï¼‰ã€‚æˆ‘ä¹Ÿä¼šèŠ±å‡ åˆ†é’Ÿçš„æ—¶é—´è®²è¿°ä»¥å‰çš„è§£å†³æ–¹å¼ã€‚ä½†æ˜¯æ­¤åˆ»æ˜¯æ—¶å€™å¼€å§‹äº†ã€‚</p>
<h3 id="ä¾èµ–æ³¨å…¥"><a href="#ä¾èµ–æ³¨å…¥" class="headerlink" title="ä¾èµ–æ³¨å…¥"></a>ä¾èµ–æ³¨å…¥</h3><p>ä¾èµ–æ³¨å…¥çš„å…¨éƒ¨å°±æ˜¯æ„å»ºå¯¹è±¡å¹¶åœ¨æˆ‘ä»¬éœ€è¦æ—¶æŠŠå®ƒä»¬ä¼ å…¥ã€‚æˆ‘ä¸ä¼šæ·±å…¥åˆ°å®ƒçš„å­¦è¯´ï¼ˆæŸ¥çœ‹ç»´åŸºç™¾ç§‘å¯¹<a href="http://en.wikipedia.org/wiki/Dependency_injection" target="_blank" rel="noopener">DIçš„å®šä¹‰</a>ï¼‰ã€‚æƒ³è±¡ä¸€ä¸ªç®€å•çš„ç±»ï¼š<code>UserManager</code>ï¼Œå®ƒä¾èµ–<code>UserStore</code>å’Œ<code>ApiService</code>ã€‚å¦‚æœæ²¡æœ‰ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼Œè¿™ä¸ªç±»ä¼šçœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<p><img src="http://frogermcs.github.io/images/13/user_manager_no_di.png" alt=""></p>
<p><code>UserStore</code> å’Œ <code>ApiService</code> ä¸¤è€…éƒ½æ˜¯åœ¨<code>UserManager</code>ç±»ä¸­æ„é€ å’Œæä¾›çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApiService apiService;</span><br><span class="line">    <span class="keyword">private</span> UserStore userStore;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//No-args constructor. Dependencies are created inside.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.apiService = <span class="keyword">new</span> ApiSerivce();</span><br><span class="line">        <span class="keyword">this</span>.userStore = <span class="keyword">new</span> UserStore();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">registerUser</span><span class="params">()</span> </span>&#123;<span class="comment">/*  */</span>&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegisterActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserManager userManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(b);</span><br><span class="line">        <span class="keyword">this</span>.userManager = <span class="keyword">new</span> UserManager();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRegisterClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        userManager.registerUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆè¿™äº›ä»£ç ä¼šç»™æˆ‘ä»¬åˆ¶é€ ä¸€äº›é—®é¢˜å‘¢ï¼Ÿè®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å¸Œæœ›å»æ”¹å˜<code>UserStore</code>çš„å®ç°ï¼Œç”¨<code>SharedPreferences</code>æ¥ä½œä¸ºå®ƒçš„å­˜å‚¨æœºåˆ¶ã€‚å®ƒéœ€è¦è‡³å°‘ä¸€ä¸ª<code>Context</code>å¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠå®ƒé€šè¿‡æ„é€ å™¨ä¼ å…¥åˆ°<code>UserStore</code>ã€‚å®ƒæ„å‘³ç€<code>UserManager</code>ç±»ä¸­ä¹Ÿéœ€è¦è¢«ä¿®æ”¹æ¥ä½¿ç”¨æ–°çš„<code>UserStore</code>æ„é€ å™¨ã€‚ç°åœ¨æƒ³è±¡ä¸‹æœ‰å¾ˆå¤šç±»ä½¿ç”¨äº†<code>UserStore</code> - å®ƒä»¬å…¨éƒ¨éƒ½éœ€è¦è¢«ä¿®æ”¹ã€‚</p>
<p>ç°åœ¨å†æ¥çœ‹ä¸‹æˆ‘ä»¬ä½¿ç”¨äº†ä¾èµ–æ³¨å…¥çš„<code>UserManager</code>ç±»ï¼š</p>
<p><img src="http://frogermcs.github.io/images/13/user_manager_di.png" alt=""></p>
<p>å®ƒçš„ä¾èµ–æ˜¯åœ¨ç±»çš„å¤–é¢åˆ›å»ºå’Œæä¾›çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApiService apiService;</span><br><span class="line">    <span class="keyword">private</span> UserStore userStore;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Dependencies are passed as arguments</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserManager</span><span class="params">(ApiService apiService, UserStore userStore)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.apiService = apiService;</span><br><span class="line">        <span class="keyword">this</span>.userStore = userStore;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">registerUser</span><span class="params">()</span> </span>&#123;<span class="comment">/*  */</span>&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegisterActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserManager userManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(b);</span><br><span class="line">        ApiService api = ApiService.getInstance();</span><br><span class="line">        UserStore store = UserStore.getInstance();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.userManager = <span class="keyword">new</span> UserManager(api, store);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRegisterClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        userManager.registerUser();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨åœ¨ç›¸ä¼¼çš„æƒ…å†µä¸‹ - æˆ‘ä»¬æ”¹å˜å®ƒå…¶ä¸­ä¸€ä¸ªä¾èµ–çš„å®ç°æ–¹å¼ - æˆ‘ä»¬ä¸éœ€è¦ä¿®æ”¹<code>UserManager</code>æºä»£ç ã€‚æ‰€æœ‰å®ƒçš„ä¾èµ–éƒ½æ˜¯ä»å¤–é¢æä¾›çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å”¯ä¸€ä¸€ä¸ªéœ€è¦ä¿®æ”¹çš„åœ°æ–¹å°±æ˜¯æˆ‘ä»¬æ„é€ çš„<code>UserStore</code>å¯¹è±¡ã€‚</p>
<p>æ‰€ä»¥ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<h4 id="æ„é€ -ä½¿ç”¨-çš„åˆ†ç¦»"><a href="#æ„é€ -ä½¿ç”¨-çš„åˆ†ç¦»" class="headerlink" title="æ„é€ /ä½¿ç”¨ çš„åˆ†ç¦»"></a>æ„é€ /ä½¿ç”¨ çš„åˆ†ç¦»</h4><p>å½“æˆ‘ä»¬æ„é€ ç±»çš„å®ä¾‹ - é€šå¸¸è¿™äº›å¯¹è±¡ä¼šåœ¨å…¶å®ƒçš„åœ°æ–¹è¢«ä½¿ç”¨åˆ°ï¼Œå¤šäºè¿™ä¸ªæ–¹æ³•è®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ æ¨¡å—åŒ– - æ‰€æœ‰çš„ä¾èµ–éƒ½å¯ä»¥è¢«å¾ˆç®€å•åœ°æ›¿æ¢æ‰ï¼ˆåªè¦ä»–ä»¬å®ç°äº†ç›¸åŒçš„æ¥å£ï¼‰ï¼Œå¹¶ä¸”ä¸ä¼šä¸æˆ‘ä»¬åº”ç”¨çš„é€»è¾‘äº§ç”Ÿå†²çªã€‚æƒ³è¦æ”¹å˜<code>DatabaseUserStore</code>ä¸º<code>SharedPrefsUserStore</code> ï¼Ÿå¥½çš„ï¼Œåªéœ€è¦å…³å¿ƒå…¬å¼€çš„APIï¼ˆä¸<code>DatabaseUserStore</code>ç›¸åŒçš„ï¼‰æˆ–è€…å®ç°ç›¸åŒçš„æ¥å£ã€‚</p>
<h4 id="å•å…ƒæµ‹è¯•ï¼ˆUnit-testingï¼‰"><a href="#å•å…ƒæµ‹è¯•ï¼ˆUnit-testingï¼‰" class="headerlink" title="å•å…ƒæµ‹è¯•ï¼ˆUnit testingï¼‰"></a>å•å…ƒæµ‹è¯•ï¼ˆUnit testingï¼‰</h4><p>çœŸæ­£çš„å•å…ƒæµ‹è¯•å‡è®¾ä¸€ä¸ªç±»æ˜¯å¯ä»¥å®Œå…¨è¢«éš”ç¦»è¿›è¡Œæµ‹è¯•çš„ - ä¸éœ€è¦äº†è§£å®ƒçš„ç›¸å…³ä¾èµ–ã€‚åœ¨å®è·µä¸­ï¼ŒåŸºäºæˆ‘ä»¬çš„<code>UserManager</code>ç±»ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæˆ‘ä»¬åº”è¯¥ç¼–å†™çš„å•å…ƒæµ‹è¯•çš„ä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserManagerTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    UserManager userManager;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mock</span></span><br><span class="line">    ApiService apiServiceMock;</span><br><span class="line">    <span class="meta">@Mock</span></span><br><span class="line">    UserStore userStoreMock;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        MockitoAnnotations.initMocks(<span class="keyword">this</span>);</span><br><span class="line">        userManager = <span class="keyword">new</span> UserManager(apiServiceMock, userStoreMock);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSomething</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//Test our userManager here - all its dependencies are satisfied</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒå¯èƒ½åªèƒ½ä½¿ç”¨DI - å¤šäº<code>UserManager</code>æ˜¯å®Œå…¨ç‹¬ç«‹äº<code>UserStore</code>å’Œ<code>ApiService</code>å®ç°çš„ã€‚æˆ‘ä»¬å¯ä»¥æä¾›è¿™äº›ç±»çš„mockï¼ˆç®€å•åœ°è¯´ - mocksæ˜¯ä¸€äº›æ‹¥æœ‰ç›¸åŒå…¬å¼€APIçš„ç±»ï¼Œå®ƒåœ¨æ–¹æ³•ä¸­ä¸åšä»»ä½•äº‹æƒ…å¹¶ä¸”/æˆ–è€…è¿”å›æˆ‘ä»¬æœŸæœ›çš„å€¼ï¼‰ï¼Œç„¶ååœ¨ä¸€ä¸ªä¸æ‰€ä¾èµ–çš„çœŸå®å®ç°åˆ†ç¦»å‡ºæ¥çš„ç¯å¢ƒä¸‹è¿›è¡Œå¯¹<code>UserManager</code>çš„æµ‹è¯•ã€‚</p>
<h4 id="ç‹¬ç«‹-å¹¶è¡Œå¼€å‘"><a href="#ç‹¬ç«‹-å¹¶è¡Œå¼€å‘" class="headerlink" title="ç‹¬ç«‹/å¹¶è¡Œå¼€å‘"></a>ç‹¬ç«‹/å¹¶è¡Œå¼€å‘</h4><p>å¤šäºæ¨¡å—åŒ–çš„ä»£ç ï¼ˆ<code>UserStore</code>å¯ä»¥ä»<code>UserManager</code>ä¸­ç‹¬ç«‹å‡ºæ¥è¿›è¡Œå®ç°ï¼‰ï¼Œå®ƒä¹Ÿå¯ä»¥éå¸¸æ–¹ä¾¿åœ¨ç¨‹åºå‘˜é—´è¿›è¡Œä»£ç çš„åˆ†ç¦»ã€‚åªéœ€è¦<code>UserStore</code>ç›¸å…³çš„æ¥å£è¢«æ¯ä¸ªäººçŸ¥é“ï¼ˆå°¤å…¶æ˜¯åœ¨<code>UserManager</code>ä¸­ä½¿ç”¨åˆ°çš„<code>UserStore</code>ä¸­çš„å…¬å¼€æ–¹æ³•ï¼‰å³å¯ã€‚å‰©ä¸‹çš„ï¼ˆå®ç°ï¼Œé€»è¾‘ï¼‰å¯ä»¥é€šè¿‡å•å…ƒæµ‹è¯•æ¥æµ‹è¯•ã€‚</p>
<h3 id="ä¾èµ–æ³¨å…¥æ¡†æ¶"><a href="#ä¾èµ–æ³¨å…¥æ¡†æ¶" class="headerlink" title="ä¾èµ–æ³¨å…¥æ¡†æ¶"></a>ä¾èµ–æ³¨å…¥æ¡†æ¶</h3><p>ä¾èµ–æ³¨å…¥é™¤äº†è¿™äº›ä¼˜ç‚¹ä¹‹å¤–è¿˜æœ‰ä¸€äº›ç¼ºç‚¹ã€‚å…¶ä¸­ä¸€ä¸ªç¼ºç‚¹æ˜¯ä¼šäº§ç”Ÿå¾ˆå¤§çš„æ¨¡ç‰ˆä»£ç ã€‚æƒ³è±¡ä¸€ä¸ªç®€å•çš„<code>LoginActivity</code>ç±»ï¼Œå®ƒåœ¨MVPï¼ˆmodel-view-presenterï¼‰æ¨¡å¼ä¸­è¢«å®ç°ã€‚è¿™ä¸ªç±»çœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š</p>
<p><img src="http://frogermcs.github.io/images/13/login_activity_diagram.png" alt=""></p>
<p>å”¯ä¸€æœ‰é—®é¢˜çš„éƒ¨åˆ†ä»£ç å°±æ˜¯<code>LoginActivityPresenter</code>çš„åˆå§‹åŒ–ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    LoginActivityPresenter presenter;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">        OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">        RestAdapter.Builder builder = <span class="keyword">new</span> RestAdapter.Builder();</span><br><span class="line">        builder.setClient(<span class="keyword">new</span> OkClient(okHttpClient));</span><br><span class="line">        RestAdapter restAdapter = builder.build();</span><br><span class="line">        ApiService apiService = restAdapter.create(ApiService.class);</span><br><span class="line">        UserManager userManager = UserManager.getInstance(apiService);</span><br><span class="line"></span><br><span class="line">        UserDataStore userDataStore = UserDataStore.getInstance(</span><br><span class="line">                getSharedPreferences(<span class="string">"prefs"</span>, MODE_PRIVATE)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Presenter is initialized here</span></span><br><span class="line">        presenter = <span class="keyword">new</span> LoginActivityPresenter(<span class="keyword">this</span>, userManager, userDataStore);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒçœ‹èµ·æ¥ä¸å¤ªå‹å¥½ï¼Œä¸æ˜¯å—ï¼Ÿ</p>
<p>è¿™å°±æ˜¯DIæ¡†æ¶éœ€è¦è§£å†³çš„é—®é¢˜ã€‚ç›¸åŒåŠŸèƒ½çš„ä»£ç çœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    LoginActivityPresenter presenter;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Satisfy all dependencies requested by @Inject annotation</span></span><br><span class="line">        getDependenciesGraph().inject(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç®€å•å¤šäº†ï¼Œå¯¹å§ï¼Ÿå½“ç„¶DIæ¡†æ¶æ²¡æœ‰åœ°æ–¹å¯ä»¥è·å–åˆ°å¯¹è±¡ - ä»–ä»¬ä»ç„¶éœ€è¦åœ¨æˆ‘ä»¬ä»£ç çš„æŸä¸ªåœ°æ–¹è¿›è¡Œåˆå§‹åŒ–å’Œé…ç½®ã€‚ä½†æ˜¯å¯¹è±¡æ„å»ºä»ä½¿ç”¨ä¸­åˆ†ç¦»å‡ºæ¥äº†ï¼ˆå®è´¨ä¸Šè¿™æ˜¯DIæ¨¡å¼çš„å‡†åˆ™ï¼‰ã€‚DIæ¡†æ¶å…³å¿ƒæ€ä¹ˆæ ·å»æŠŠå®ƒä»¬è”ç³»åœ¨ä¸€èµ·ï¼ˆæ€ä¹ˆåœ¨å¯¹è±¡è¢«éœ€è¦æ—¶åˆ†é…ç»™å®ƒä»¬ï¼‰ã€‚</p>
<h3 id="æœªå®Œå¾…ç»­"><a href="#æœªå®Œå¾…ç»­" class="headerlink" title="æœªå®Œå¾…ç»­"></a>æœªå®Œå¾…ç»­</h3><p>æˆ‘ä¸Šé¢æ‰€æœ‰æè¿°çš„ä¸œè¥¿éƒ½æ˜¯ä½¿ç”¨Dagger 2çš„ç®€å•çš„èƒŒæ™¯ - ç”¨äºAndroidå’ŒJavaå¼€å‘çš„ä¾èµ–æ³¨å…¥æ¡†æ¶ã€‚åœ¨ä¸‹ä¸€ç« æˆ‘å°†å°è¯•è®²è§£æ‰€æœ‰Dagger 2çš„APIã€‚å¦‚æœä½ ç­‰ä¸æ€¥å¯ä»¥å°è¯•æˆ‘çš„<a href="https://github.com/frogermcs/GithubClient" target="_blank" rel="noopener">Github client example</a>ï¼Œå®ƒå»ºç«‹åœ¨Dagger 2ä¹‹ä¸Šå¹¶ä¸”ä¼šç”¨åœ¨æˆ‘çš„å±•ç¤ºä¸­ã€‚ä¸€ä¸ªå°æç¤º - <code>@Module</code>å’Œ<code>@Component</code>å°±æ˜¯æ„å»º/æä¾›å¯¹è±¡çš„åœ°æ–¹ã€‚<code>@Inject</code>æ˜¯æˆ‘ä»¬å¯¹è±¡ä½¿ç”¨åˆ°çš„åœ°æ–¹ã€‚</p>
<p>More detailed description - soon.</p>
<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul>
<li><a href="https://www.youtube.com/watch?v=oK_XtfXPkqw" target="_blank" rel="noopener">DAGGER 2 - A New Type of dependency injection</a> by Gregory Kick</li>
<li><a href="https://www.parleys.com/tutorial/the-future-dependency-injection-dagger-2" target="_blank" rel="noopener">The Future of Dependency Injection with Dagger 2</a> by Jake Wharton</li>
<li><a href="http://frogermcs.github.io/dagger-1-to-2-migration/" target="_blank" rel="noopener">Dagger 1 to 2 migration process</a></li>
</ul>
<h2 id="ä½œè€…"><a href="#ä½œè€…" class="headerlink" title="ä½œè€…"></a>ä½œè€…</h2><p><a href="http://about.me/froger_mcs" target="_blank" rel="noopener">Miroslaw Stanek</a></p>
<p>Head of Mobile Development @ <a href="https://azimo.com/" target="_blank" rel="noopener">Azimo</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - DIä»‹ç»ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092083.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092083.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - APIï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5092525.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5092525.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - è‡ªå®šä¹‰Scopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5095426.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5095426.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2ä¾èµ–æ³¨å…¥ - å›¾è¡¨åˆ›å»ºçš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5098943.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5098943.html</a></p>
<blockquote>
<p><strong>[Android]Dagger2Metrics - æµ‹é‡DIå›¾è¡¨åˆå§‹åŒ–çš„æ€§èƒ½ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/5193437.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/5193437.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2è¿›è¡Œä¾èµ–æ³¨å…¥ - Producersï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6234811.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6234811.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­ä½¿ç”¨RxJavaæ¥è¿›è¡Œå¼‚æ­¥æ³¨å…¥ï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6236646.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6236646.html</a></p>
<blockquote>
<p><strong>[Android]ä½¿ç”¨Dagger 2æ¥æ„å»ºUserScopeï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6237731.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6237731.html</a></p>
<blockquote>
<p><strong>[Android]åœ¨Dagger 2ä¸­Activitieså’ŒSubcomponentsçš„å¤šç»‘å®šï¼ˆç¿»è¯‘ï¼‰:</strong></p>
</blockquote>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/6266442.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/6266442.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> google </tag>
            
            <tag> dagger2 </tag>
            
            <tag> DI </tag>
            
            <tag> dependency injection </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]å®˜ç½‘ã€Šmonkeyrunnerã€‹ä¸­æ–‡ç¿»è¯‘]]></title>
      <url>/2015/12/16/Android-%E5%AE%98%E7%BD%91%E3%80%8Amonkeyrunner%E3%80%8B%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91/</url>
      <content type="html"><![CDATA[<p>ç¿»è¯‘è‡ª Android Developer å®˜ç½‘ï¼š<a href="http://developer.android.com/tools/help/monkeyrunner_concepts.html" target="_blank" rel="noopener">http://developer.android.com/tools/help/monkeyrunner_concepts.html</a></p>
<h1 id="monkeyrunner"><a href="#monkeyrunner" class="headerlink" title="monkeyrunner"></a>monkeyrunner</h1><p>monkeyrunnerå·¥å…·æä¾›äº†ä¸€å¥—APIï¼Œåœ¨ä¸é€šè¿‡Androidä»£ç çš„æƒ…å†µä¸‹ç¼–å†™ç¨‹åºæ¥æ§åˆ¶ä¸€ä¸ªAndroidè®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨ã€‚ä½¿ç”¨monkeyrunnerï¼Œä½ å¯ä»¥ç¼–å†™ä¸€ä¸ª<code>Python</code>ç¨‹åºæ¥å®‰è£…ä¸€ä¸ªAndroidåº”ç”¨ç¨‹åºæˆ–è€…æµ‹è¯•åŒ…ï¼Œè¿è¡Œå®ƒï¼Œç»™å®ƒå‘é€æŒ‰é”®ï¼Œä½¿ç”¨å®ƒçš„interfaceæ¥åˆ›å»ºä¸€ä¸ªæˆªå›¾ï¼Œå¹¶ä¿å­˜åœ¨å·¥ä½œç«™ä¸Šã€‚monkeytunnerå·¥å…·ä¸»è¦æ˜¯è¢«è®¾è®¡ç”¨æ¥åœ¨åŠŸèƒ½/æ¡†æ¶çº§åˆ«æµ‹è¯•åº”ç”¨ç¨‹åºå’Œè®¾å¤‡ï¼Œå¹¶è¿è¡Œå•å…ƒæµ‹è¯•å¥—ä»¶ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒæ¥è¾¾åˆ°å…¶å®ƒçš„ç›®çš„ã€‚</p>
<p>Monkeyrunnerå·¥å…·ä¸ä¹Ÿè¢«ç§°ä¸º<code>monkey</code>çš„<a href="http://developer.android.com/tools/help/monkey.html" target="_blank" rel="noopener">UI/Application Exerciser Monkey</a>æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚<code>Monkey</code>å·¥å…·æ˜¯ç›´æ¥åœ¨<code>adb</code> shellä¸­è¿è¡Œï¼Œé€šè¿‡åœ¨è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨ä¸­äº§ç”Ÿä¼ªéšæœºæµçš„ç”¨æˆ·å’Œç³»ç»Ÿäº‹ä»¶çš„æ–¹å¼ã€‚æ¯”è¾ƒä¹‹ä¸‹ï¼Œmonkeyrunnerå·¥å…·åœ¨ä¸€ä¸ªå·¥ä½œç«™ä¸­é€šè¿‡APIå‘é€æŒ‡å®šçš„å‘½ä»¤å’Œäº‹ä»¶æ¥æ§åˆ¶è®¾å¤‡å’Œæ¨¡æ‹Ÿå™¨ã€‚</p>
<p>monkeyrunnerå·¥å…·æä¾›äº†ä»¥ä¸‹è¿™äº›åœ¨Androidæµ‹è¯•ä¸­ç‹¬ä¸€æ— äºŒçš„ç‰¹æ€§ï¼š</p>
<ul>
<li><p>å¤šè®¾å¤‡æ§åˆ¶ï¼šmonkeyrunnerå¯ä»¥åº”ç”¨åœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªæµ‹è¯•å¥—ä»¶è·¨è¶Šå¤šä¸ªè®¾å¤‡å’Œæ¨¡æ‹Ÿå™¨ã€‚ä½ å¯ä»¥åœ¨ç‰©ç†å±‚é¢ä¸Šä¸€æ¬¡æ€§attachæ‰€æœ‰çš„è®¾å¤‡æˆ–è€…å¯åŠ¨æ‰€æœ‰çš„æ¨¡æ‹Ÿå™¨ï¼ˆæˆ–è€…ä¸¤è€…éƒ½æœ‰ï¼‰ï¼ŒæŒ‰ç…§ç¨‹åºä¾æ¬¡è¿æ¥ä¸Šæ¯ä¸€ä¸ªï¼Œç„¶åè¿è¡Œä¸€ä¸ªæˆ–è€…å¤šä¸ªæµ‹è¯•ã€‚</p>
</li>
<li><p>åŠŸèƒ½æ€§æµ‹è¯•ï¼šmonkeyrunnerå¯ä»¥è¿è¡Œä»å¤´è‡³å°¾å…¨è‡ªåŠ¨åŒ–åœ°æµ‹è¯•Androidåº”ç”¨ç¨‹åºã€‚ç”±ä½ æä¾›è¾“å…¥çš„æŒ‰é”®æˆ–è€…è§¦æ‘¸äº‹ä»¶ï¼Œå¹¶ä¸”æŸ¥çœ‹ç»“æœæˆªå›¾ã€‚</p>
</li>
<li><p>å›å½’æµ‹è¯•ï¼šmonkeyrunnerå¯ä»¥é€šè¿‡è¿è¡Œä¸€ä¸ªåº”ç”¨ç¨‹åºå¹¶ä¸”æŠŠå®ƒè¾“å‡ºçš„ç»“æœæˆªå›¾ä¸å·²çŸ¥æ­£ç¡®çš„æˆªå›¾æ¯”è¾ƒçš„æ–¹å¼æµ‹è¯•åº”ç”¨ç¨‹åºçš„ç¨³å®šæ€§ã€‚</p>
</li>
<li><p>å¯æ‰©å±•çš„è‡ªåŠ¨åŒ–ï¼šå› ä¸ºmonkeyrunneræ˜¯ä¸€å¥—APIå·¥å…·åŒ…ï¼Œä½ å¯ä»¥åŸºäº<code>Python</code>æ¨¡å—å’Œç¨‹åºçš„å¼€å‘ä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿæ¥æ§åˆ¶Androidè®¾å¤‡ã€‚é™¤äº†ä½¿ç”¨monkeyrunnerè‡ªå·±çš„APIï¼Œä½ å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„Python <code>os</code>å’Œ<code>subprocess</code>æ¨¡å—æ¥è°ƒç”¨ <a href="http://developer.android.com/tools/help/adb.html" target="_blank" rel="noopener">Android Debug Bridge</a> ç­‰Androidå·¥å…·ã€‚ä½ ä¹Ÿå¯ä»¥ä¸ºmonkeyrunner APIå¢åŠ è‡ªå·±çš„ç±»ã€‚è¿™ä¸ªæˆ‘ä»¬ä¼šåœ¨ <a href="http://developer.android.com/tools/help/monkeyrunner_concepts.html#Plugins" target="_blank" rel="noopener">Extending monkeyrunner with plugins</a> æ ä¸­è®¨è®ºåˆ°æ›´å¤šçš„ç»†èŠ‚ã€‚</p>
</li>
</ul>
<p>monkeyrunnerå·¥å…·ä½¿ç”¨äº†<a href="http://www.jython.org/" target="_blank" rel="noopener">Jython</a>ï¼Œä¸€ä¸ªä½¿ç”¨Javaç¼–ç¨‹è¯­è¨€çš„Pythonå®ç°ã€‚Jythonå…è®¸monkeyrunner APIå¾ˆå®¹æ˜“åœ°ä¸Android frameworkäº¤äº’ã€‚ä½¿ç”¨Jythonï¼Œä½ å¯ä»¥ä½¿ç”¨Pythonè¯­æ³•å»è®¿é—®APIå¸¸é‡ã€ç±»å’Œæ–¹æ³•ã€‚</p>
<h2 id="ä¸€ä¸ªç®€å•çš„monkeyrunnerç¨‹åº"><a href="#ä¸€ä¸ªç®€å•çš„monkeyrunnerç¨‹åº" class="headerlink" title="ä¸€ä¸ªç®€å•çš„monkeyrunnerç¨‹åº"></a>ä¸€ä¸ªç®€å•çš„monkeyrunnerç¨‹åº</h2><p>è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„monkeyrunnerç¨‹åºï¼Œå®ƒå¯ä»¥è¿æ¥åˆ°ä¸€ä¸ªè®¾å¤‡ï¼Œåˆ›å»ºä¸€ä¸ª <a href="http://developer.android.com/tools/help/MonkeyDevice.html" target="_blank" rel="noopener"><code>MonkeyDevice</code></a> å¯¹è±¡ã€‚ç¨‹åºä¸­ä½¿ç”¨ <code>MonkeyDevice</code> å¯¹è±¡å®‰è£…ä¸€ä¸ªAndroidåº”ç”¨ç¨‹åºï¼Œè¿è¡Œå®ƒå…¶ä¸­çš„ä¸€ä¸ªActivityï¼Œå¹¶ä¸”å‘é€ä¸€ä¸ªæŒ‰é”®çš„äº‹ä»¶ç»™è¿™ä¸ªActivityã€‚ç„¶åç¨‹åºæŠŠç»“æœæˆªå›¾ï¼Œåˆ›å»ºäº†ä¸€ä¸ª <a href="http://developer.android.com/tools/help/MonkeyImage.html" target="_blank" rel="noopener"><code>MonkeyImage</code></a> å¯¹è±¡ã€‚é€šè¿‡è¿™ä¸ªå¯¹è±¡ï¼Œç¨‹åºæŠŠæˆªå›¾è¾“å‡ºåˆ°ä¸€ä¸ª<code>.png</code>æ–‡ä»¶ä¸­ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Import ç¨‹åºæ‰€æœ‰ä½¿ç”¨åˆ°çš„monkeyrunneræ¨¡å—</span></span><br><span class="line"><span class="keyword">from</span> com.android.monkeyrunner <span class="keyword">import</span> MonkeyRunner, MonkeyDevice</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿æ¥å½“å‰çš„è®¾å¤‡ï¼Œè¿”å›ä¸€ä¸ªMonkeyDeviceå¯¹è±¡</span></span><br><span class="line">device = MonkeyRunner.waitForConnection()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…Androidåº”ç”¨ã€‚æ³¨æ„è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªbooleanï¼Œæ‰€ä»¥ä½ éœ€è¦æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</span></span><br><span class="line">device.installPackage(<span class="string">'myproject/bin/MyApplication.apk'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠå®‰è£…æ–‡ä»¶çš„å†…éƒ¨åŒ…åè®¾ç½®åˆ°ä¸€ä¸ªå˜é‡ä¸­</span></span><br><span class="line">package = <span class="string">'com.example.android.myapplication'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠActivityçš„å®Œæ•´ç±»åè®¾ç½®åˆ°ä¸€ä¸ªå˜é‡ä¸­</span></span><br><span class="line">activity = <span class="string">'com.example.android.myapplication.MainActivity'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®è¦å¯åŠ¨çš„componentåå­—</span></span><br><span class="line">runComponent = package + <span class="string">'/'</span> + activity</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œè¯¥component</span></span><br><span class="line">device.startActivity(component=runComponent)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‰ä¸‹èœå•æŒ‰é’®</span></span><br><span class="line">device.press(<span class="string">'KEYCODE_MENU'</span>, MonkeyDevice.DOWN_AND_UP)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆªå›¾</span></span><br><span class="line">result = device.takeSnapshot()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠæˆªå›¾å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­</span></span><br><span class="line">result.writeToFile(<span class="string">'myproject/shot1.png'</span>,<span class="string">'png'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="The-monkeyrunner-API"><a href="#The-monkeyrunner-API" class="headerlink" title="The monkeyrunner API"></a>The monkeyrunner API</h2><p>monkeyrunnerçš„APIå¤„äº<code>com.android.monkeyrunner</code>ä¸­ï¼ŒåŒ…æ‹¬ä¸‰ä¸ªæ¨¡å—ï¼š</p>
<ul>
<li><p><a href="http://developer.android.com/tools/help/MonkeyRunner.html" target="_blank" rel="noopener"><code>MonkeyRunner</code></a>ï¼šä¸€ä¸ªåŒ…å«monkeyrunnerç¨‹åºå®ç”¨æ–¹æ³•çš„ç±»ã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€ä¸ªæ–¹æ³•ç”¨æ¥æŠŠmonkeyrunnerè¿æ¥åˆ°ä¸€ä¸ªè®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨ã€‚å®ƒä¹Ÿæä¾›äº†æ–¹æ³•ä¸ºmonkeyrunnerç¨‹åºåˆ›å»ºUIï¼Œè¿˜æœ‰æ˜¾ç¤ºå†…ç½®çš„helpç•Œé¢ã€‚</p>
</li>
<li><p><a href="http://developer.android.com/tools/help/MonkeyDevice.html" target="_blank" rel="noopener"><code>MonkeyDevice</code></a>ï¼šä»£è¡¨ä¸€ä¸ªè®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨ã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€äº›æ–¹æ³•ç”¨äºå®‰è£…å’Œå¸è½½åº”ç”¨ã€å¯åŠ¨ä¸€ä¸ªActivityã€å‘é€é”®ç›˜æ´»ç€è§¦æ‘¸äº‹ä»¶åˆ°ä¸€ä¸ªåº”ç”¨ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªç±»æ¥è¿è¡Œä¸€ä¸ªæµ‹è¯•åº”ç”¨ã€‚</p>
</li>
<li><p><a href="http://developer.android.com/tools/help/MonkeyImage.html" target="_blank" rel="noopener"><code>MonkeyImage</code></a>ï¼šä»£è¡¨ä¸€ä¸ªå±å¹•æˆªå›¾å›¾ç‰‡ã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€äº›æ–¹æ³•ç”¨äºæˆªå›¾ã€æŠŠbitmapå›¾ç‰‡è½¬æ¢æˆå„ç§æ ¼å¼ï¼Œå¯¹æ¯”ä¸¤ä¸ªMonkeyImageå¯¹è±¡ã€è¿˜æœ‰æŠŠå›¾ç‰‡å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚</p>
</li>
</ul>
<p>åœ¨ä¸€ä¸ªPythonç¨‹åºä¸­ï¼Œä½ å¯ä»¥åƒä¸€ä¸ªPythonæ¨¡å—ä¸€æ ·è®¿é—®æ¯ä¸€ä¸ªç±»ã€‚monkeyrunnerå·¥å…·ä¸ä¼šè‡ªåŠ¨å¸®ä½ importè¿™äº›æ¨¡å—ã€‚importæ¨¡å—çš„æ–¹å¼æ˜¯ä½¿ç”¨Pythonçš„<code>from</code>è¯­å¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> com.android.monkeyrunner <span class="keyword">import</span> &lt;module&gt;</span><br></pre></td></tr></table></figure>
<p><code>&lt;module&gt;</code>å°±æ˜¯ä½ å¸Œæœ›importçš„ç±»åã€‚ä½ å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªçš„<code>from</code>è¯­å¥é€šè¿‡é€—å·åˆ†éš”çš„æ–¹å¼importå¤šä¸ªæ¨¡å—ã€‚</p>
<h2 id="è¿è¡Œmonkeyrunner"><a href="#è¿è¡Œmonkeyrunner" class="headerlink" title="è¿è¡Œmonkeyrunner"></a>è¿è¡Œmonkeyrunner</h2><p>ä½ å¯ä»¥ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¿è¡Œmonkeyrunnerç¨‹åºï¼Œä¹Ÿå¯ä»¥åœ¨äº¤äº’ä¼šè¯æ¨¡å¼ä¸­è¾“å…¥monkeyrunnerè¯­å¥æ¥è¿è¡Œã€‚ä¸¤è€…éƒ½éœ€è¦é€šè¿‡è°ƒç”¨<code>monkeyrunner</code>å‘½ä»¤è¿›è¡Œï¼Œä½ å¯ä»¥åœ¨SDKç›®å½•ä¸‹çš„<code>tools/</code>å­ç›®å½•ä¸‹å¯ä»¥æ‰¾åˆ°è¿™äº›å‘½ä»¤ã€‚å¦‚æœä½ æä¾›äº†ä¸€ä¸ªæ–‡ä»¶åä½œä¸ºè‰ä¹¦ï¼Œmonkeyrunnerå‘½ä»¤ä¼šæŠŠè¿™ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹ä½œä¸ºPythonç¨‹åºæ¥è¿è¡Œï¼Œå¦åˆ™ï¼Œå®ƒå°±æ˜¯ä»¥äº¤äº’ä¼šè¯çš„æ–¹å¼è¿è¡Œã€‚</p>
<p>monkeyrunnerå‘½ä»¤çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">monkeyrunner -plugin &lt;plugin_jar&gt; &lt;program_filename&gt; &lt;program_options&gt;</span><br></pre></td></tr></table></figure>
<p>è¡¨1è§£é‡Šäº†flagså’Œå‚æ•°ã€‚</p>
<p><strong>Table 1</strong>. <code>monkeyrunner</code> flagså’Œå‚æ•°ã€‚</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-plugin &lt;plugin_jar&gt;</code></td>
<td>ï¼ˆå¯é€‰ï¼‰æŒ‡å®šä¸€ä¸ª<code>.jar</code>æ–‡ä»¶ä½œä¸ºmonkeyrunnerçš„æ’ä»¶ã€‚æ›´å¤šmonkeyrunneræ’ä»¶å­¦ä¹ ï¼Œè§<a href="http://developer.android.com/tools/help/monkeyrunner_concepts.html#Plugins" target="_blank" rel="noopener">ä½¿ç”¨æ’ä»¶æ‰©å±•monkeyrunner</a>ã€‚è¦æŒ‡å®šå¤šä¸ªæ–‡ä»¶ï¼Œé‚£å°±å¤šæ¬¡ä½¿ç”¨è¿™ä¸ªå‚æ•°ã€‚</td>
</tr>
<tr>
<td><code>&lt;program_filename&gt;</code></td>
<td>å¦‚æœä½ æä¾›äº†è¿™ä¸ªå‚æ•°ï¼Œ<code>monkeyrunner</code>å‘½ä»¤å°±ä¼šæŠŠè¿™ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹ä½œä¸ºPythonç¨‹åºè¿è¡Œã€‚å¦‚æœè¯¥å‚æ•°æ²¡æœ‰è¢«æä¾›ï¼Œåˆ™å®ƒå°±æ˜¯ä»¥äº¤äº’ä¼šè¯çš„æ–¹å¼è¿è¡Œã€‚</td>
</tr>
<tr>
<td><code>&lt;program_options&gt;</code></td>
<td>ï¼ˆå¯é€‰ï¼‰<program_file>ä¸­è¯¥ç¨‹åºçš„flagså’Œå‚æ•°ã€‚</program_file></td>
</tr>
</tbody>
</table>
<h2 id="monkeyrunnerå†…ç½®çš„Help"><a href="#monkeyrunnerå†…ç½®çš„Help" class="headerlink" title="monkeyrunnerå†…ç½®çš„Help"></a>monkeyrunnerå†…ç½®çš„Help</h2><p>ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆmonkeyrunnerçš„API referenceï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">monkeyrunner help.py &lt;format&gt; &lt;outfile&gt;</span><br></pre></td></tr></table></figure>
<p>å‚æ•°æ˜¯ï¼š</p>
<ul>
<li><p><code>&lt;format&gt;</code>ï¼š<code>text</code>è¡¨ç¤ºçº¯æ–‡æœ¬è¾“å‡ºï¼Œæˆ–è€…<code>html</code>è¡¨ç¤ºHTMLè¾“å‡ºã€‚</p>
</li>
<li><p><code>&lt;outfile&gt;</code>ï¼šè¾“å‡ºæ–‡ä»¶çš„è·¯å¾„ã€‚</p>
</li>
</ul>
<h2 id="ä½¿ç”¨æ’ä»¶æ‰©å±•monkeyrunner"><a href="#ä½¿ç”¨æ’ä»¶æ‰©å±•monkeyrunner" class="headerlink" title="ä½¿ç”¨æ’ä»¶æ‰©å±•monkeyrunner"></a>ä½¿ç”¨æ’ä»¶æ‰©å±•monkeyrunner</h2><p>ä½ å¯ä»¥ä½¿ç”¨Javaç¼–ç¨‹è¯­è¨€ç¼–å†™ä½ çš„ç±»å¹¶æ„å»ºåˆ°ä¸€ä¸ªæˆ–è€…å¤šä¸ª<code>.jar</code>ä¸­æ¥æ‰©å±•monkeyrunnerçš„APIã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªç‰¹æ€§é€šè¿‡ä½¿ç”¨ä½ è‡ªå·±çš„ç±»æˆ–è€…ç»§æ‰¿å·²æœ‰çš„ç±»æ¥æ‰©å±•monkeyrunner APIã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªç‰¹æ€§æ¥åˆå§‹åŒ–monkeyrunnerç¯å¢ƒã€‚</p>
<p>è¦æä¾›ä¸€ä¸ªæ’ä»¶ç»™monkeyrunnerï¼Œå°±è¦è°ƒç”¨åœ¨<code>monkeyrunner</code>å‘½ä»¤çš„æ—¶å€™åŠ ä¸Š<a href="http://developer.android.com/tools/help/monkeyrunner_concepts.html#table1" target="_blank" rel="noopener">è¡¨1</a>ä¸­æ‰€æè¿°çš„<code>-plugin &lt;plugin_jar&gt;</code>å‚æ•°ã€‚</p>
<p>åœ¨ä½ çš„æ’ä»¶ä»£ç ä¸­ï¼Œä½ å¯ä»¥importå’Œç»§æ‰¿monkeyrunneråœ¨<code>com.android.monkeyrunner</code>ä¸­çš„ä¸»è¦ç±»<code>MonkeyDevice</code>ã€<code>MonkeyImage</code>ã€å’Œ<code>MonkeyRunner</code>ï¼ˆè§<a href="http://developer.android.com/tools/help/monkeyrunner_concepts.html#APIClasses" target="_blank" rel="noopener">The monkeyrunner API</a>ï¼‰ã€‚</p>
<p>æ³¨æ„æ’ä»¶ä¸èƒ½è®©ä½ å»è®¿é—®Android SDKã€‚ä½ ä¸èƒ½importåƒ<code>com.android.app</code>ç±»ä¼¼çš„åŒ…ã€‚å› ä¸ºmonkeyrunneræ˜¯åœ¨framework APIsä¹‹å¤–ä¸è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨äº¤äº’çš„ã€‚</p>
<h3 id="æ’ä»¶å¯åŠ¨ç±»"><a href="#æ’ä»¶å¯åŠ¨ç±»" class="headerlink" title="æ’ä»¶å¯åŠ¨ç±»"></a>æ’ä»¶å¯åŠ¨ç±»</h3><p><code>.jar</code>æ’ä»¶æ–‡ä»¶å¯ä»¥æŒ‡å®šä¸€ä¸ªç±»ä¼šåœ¨è„šæœ¬è¿è¡Œä¹‹å‰è¢«åˆå§‹åŒ–ã€‚è¦æŒ‡å®šè¿™ä¸ªç±»ï¼Œå°±è¦åœ¨<code>.jar</code>æ–‡ä»¶çš„manifestä¸­å¢åŠ ä¸€ä¸ª<code>MonkeyRunnerStartupRunner</code>å±æ€§ã€‚å®ƒçš„å€¼åº”è¯¥å°±æ˜¯å¯åŠ¨æ—¶è¦è¿è¡Œçš„ç±»çš„åå­—ã€‚è¿™é¢è¿™ä¸ªç‰‡æ®µå±•ç¤ºäº†ä½ æ€ä¹ˆåœ¨<code>ant</code> buildè„šæœ¬ä¸­å»è®¾ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">jar</span> <span class="attr">jarfile</span>=<span class="string">"myplugin"</span> <span class="attr">basedir</span>=<span class="string">"$&#123;build.dir&#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">attribute</span> <span class="attr">name</span>=<span class="string">"MonkeyRunnerStartupRunner"</span> <span class="attr">value</span>=<span class="string">"com.myapp.myplugin"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">jar</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¦å»è®¿é—®monkeyrunnerçš„è¿è¡Œæ—¶ç¯å¢ƒï¼Œå¯åŠ¨ç±»å¯ä»¥å®ç°<code>com.google.common.base.Predicate&lt;PythonInterpreter&gt;</code>æ¥å£ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè¿™ä¸ªç±»åœ¨é»˜è®¤çš„å‘½åç©ºé—´ä¸­è®¾ç½®äº†ä¸€äº›å˜é‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.android.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.google.common.base.Predicate;</span><br><span class="line"><span class="keyword">import</span> org.python.util.PythonInterpreter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> <span class="keyword">implements</span> <span class="title">Predicate</span>&lt;<span class="title">PythonInterpreter</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">apply</span><span class="params">(PythonInterpreter anInterpreter)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * ä¸€ä¸ªä¾‹å­ä½¿ç”¨æ¥åœ¨monkeyrunnerç¯å¢ƒçš„å‘½åç©ºé—´ä¸­åˆå§‹åŒ–ä¸€äº›å˜é‡ã€‚</span></span><br><span class="line"><span class="comment">        * åœ¨æ‰§è¡ŒæœŸé—´ï¼Œmonkeyrunnerç¨‹åºå¯ä»¥ä½¿ç”¨â€œnewtestâ€å’Œâ€œuse_emulatorâ€è¿™äº›å˜é‡</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        anInterpreter.set(<span class="string">"newtest"</span>, <span class="string">"enabled"</span>);</span><br><span class="line">        anInterpreter.set(<span class="string">"use_emulator"</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> testing </tag>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> monkey </tag>
            
            <tag> MonkeyRunner </tag>
            
            <tag> autemate </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]å®˜ç½‘ã€ŠUI/Application Exerciser Monkeyã€‹ä¸­æ–‡ç¿»è¯‘]]></title>
      <url>/2015/12/15/Android-%E5%AE%98%E7%BD%91%E3%80%8AUI-Application-Exerciser-Monkey%E3%80%8B%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91/</url>
      <content type="html"><![CDATA[<p>ç¿»è¯‘è‡ª Android Developer å®˜ç½‘ï¼š<a href="http://developer.android.com/tools/help/monkey.html" target="_blank" rel="noopener">http://developer.android.com/tools/help/monkey.html</a></p>
<h1 id="UI-Application-Exerciser-Monkey"><a href="#UI-Application-Exerciser-Monkey" class="headerlink" title="UI/Application Exerciser Monkey"></a>UI/Application Exerciser Monkey</h1><p>Monkeyæ˜¯ä¸€ä¸ªç¨‹åºï¼Œå®ƒä¼šè¿è¡Œåœ¨ä½ çš„<a href="http://developer.android.com/tools/help/emulator.html" target="_blank" rel="noopener">æ¨¡æ‹Ÿå™¨</a>æˆ–è€…è®¾å¤‡ä¸Šå¹¶ä¸”ä¼šäº§ç”Ÿä¼ªéšæœºçš„ç”¨æˆ·äº‹ä»¶æµï¼Œæ¯”å¦‚ç‚¹å‡»ã€è§¦æ‘¸æˆ–æ‰‹åŠ¿ï¼Œä»¥åŠå¤§é‡çš„ç³»ç»Ÿçº§çš„äº‹ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨Monkeyæ¥å¯¹ä½ å¼€å‘çš„åº”ç”¨ç¨‹åºä»¥éšæœºå’Œé‡å¤çš„æ–¹å¼æ¥è¿›è¡Œå‹åŠ›æµ‹è¯•ã€‚</p>
<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>Monkeyæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œä½ å¯ä»¥åœ¨æ¨¡æ‹Ÿå™¨æˆ–è€…è®¾å¤‡ä¸Šè¿è¡Œå®ƒã€‚å®ƒå‘é€ä¼ªéšæœºçš„ç”¨æˆ·äº‹ä»¶æµåˆ°ç³»ç»Ÿï¼Œå®ƒå¯ä»¥ä½œä¸ºä½ å¼€å‘çš„åº”ç”¨ç¨‹åºçš„å‹åŠ›æµ‹è¯•ã€‚</p>
<p>MonkeyåŒ…å«å¾ˆå¤šçš„é€‰é¡¹ï¼Œä½†æ˜¯æ€»ç»“æˆå››ç§ä¸»è¦çš„ç§ç±»ï¼š</p>
<ul>
<li><p>åŸºç¡€é…ç½®é€‰é¡¹ï¼Œæ¯”å¦‚è®¾ç½®è¯•å›¾å°è¯•çš„äº‹ä»¶æ•°é‡ã€‚</p>
</li>
<li><p>æ“ä½œé™åˆ¶ï¼Œæ¯”å¦‚é™åˆ¶åœ¨å•ä¸ªåŒ…ä¸­æµ‹è¯•ã€‚</p>
</li>
<li><p>äº‹ä»¶ç±»å‹å’Œé¢‘ç‡ã€‚</p>
</li>
<li><p>debuggingé€‰é¡¹ã€‚</p>
</li>
</ul>
<p>å½“Monkeyè¿è¡Œæ—¶ï¼Œå®ƒä¼šäº§ç”Ÿäº‹ä»¶å¹¶æŠŠå®ƒä»¬å‘é€åˆ°ç³»ç»Ÿã€‚å®ƒä¹Ÿéœ€è¦åœ¨æµ‹è¯•ä¸‹è§‚å¯Ÿç³»ç»Ÿå¹¶å¯»æ‰¾éœ€è¦å®ƒç‰¹åˆ«å¤„ç†çš„ä¸‰ç§æƒ…å†µï¼š</p>
<ul>
<li><p>å¦‚æœä½ é™åˆ¶Monkeyè¿è¡Œåœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªæŒ‡å®šçš„åŒ…ä¸‹ï¼Œå®ƒä¼šè§‚å¯Ÿå¯¼èˆªåˆ°å…¶ä»–åŒ…çš„äº‹ä»¶ï¼Œå¹¶ä¸”æ‹¦æˆªå®ƒä»¬ã€‚</p>
</li>
<li><p>å¦‚æœä½ çš„åº”ç”¨ç¨‹åºå´©æºƒæˆ–è€…æ¥æ”¶åˆ°äº†ä»»ä½•å½¢å¼çš„æœªå¤„ç†çš„å¼‚å¸¸ï¼ŒMonkeyä¼šåœæ­¢å¹¶ä¸”æŠ¥å‘Šé”™è¯¯ã€‚</p>
</li>
<li><p>å¦‚æœä½ çš„åº”ç”¨ç¨‹åºäº§ç”Ÿäº†applicaiton not respondingï¼ˆANRï¼‰é”™è¯¯ï¼ŒMonkeyä¼šåœæ­¢å¹¶ä¸”æŠ¥å‘Šé”™è¯¯ã€‚</p>
</li>
</ul>
<p>æ ¹æ®ä½ æ‰€é€‰æ‹©çš„è¯¦ç»†ç¨‹åº¦ï¼Œä½ è¿˜å¯ä»¥çœ‹åˆ°Monkeyçš„è¿›åº¦æŠ¥å‘Šå’Œæ­£åœ¨ç”Ÿæˆçš„äº‹ä»¶ã€‚</p>
<h2 id="Monkeyçš„åŸºæœ¬ä½¿ç”¨"><a href="#Monkeyçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="Monkeyçš„åŸºæœ¬ä½¿ç”¨"></a>Monkeyçš„åŸºæœ¬ä½¿ç”¨</h2><p>ä½ å¯ä»¥ä½¿ç”¨ä½ å¼€å‘æœºå™¨ä¸Šçš„å‘½ä»¤è¡Œæˆ–è€…é€‰æ‹©ä¸€ä¸ªè„šæœ¬æ¥å¯åŠ¨Monkeyã€‚å› ä¸ºMonkeyè¿è¡Œåœ¨æ¨¡æ‹Ÿå™¨/è®¾å¤‡ç¯å¢ƒï¼Œä½ å¿…é¡»é€šè¿‡è¿™ä¸ªç¯å¢ƒçš„shellæ¥å¯åŠ¨å®ƒã€‚ä½ å¯ä»¥åœ¨æ¯å¥å‘½ä»¤å‰åŠ ä¸Š<code>adb shell</code>ï¼Œæˆ–è€…è¿›å…¥shellå¹¶ç›´æ¥ä½¿ç”¨Monkeyå‘½ä»¤ã€‚</p>
<p>åŸºæœ¬çš„è¯­æ³•æ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ adb shell monkey [options] &lt;event-count&gt;</span><br></pre></td></tr></table></figure>
<p>ä¸ä½¿ç”¨ä»»ä½•é€‰é¡¹æŒ‡å®šï¼ŒMonkeyä¼šä»¥ä¸€ç§å®‰é™çš„æ¨¡å¼å¯åŠ¨ï¼Œç„¶åå‘é€äº‹ä»¶åˆ°ä»»ä½•ï¼ˆæ‰€æœ‰ï¼‰ä½ ç›®æ ‡è®¾å¤‡ä¸Šå®‰è£…çš„åŒ…ä¸­ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªæ›´åŠ å…¸å‹çš„å‘½ä»¤è¡Œï¼Œå®ƒä¼šå¯åŠ¨ä½ çš„åº”ç”¨ç¨‹åºï¼Œç„¶åå‘é€500ä¸ªä¼ªéšæœºçš„äº‹ä»¶ç»™å®ƒï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ adb shell monkey -p your.package.name -v 500</span><br></pre></td></tr></table></figure>
<h2 id="å‘½ä»¤é€‰é¡¹å‚è€ƒ"><a href="#å‘½ä»¤é€‰é¡¹å‚è€ƒ" class="headerlink" title="å‘½ä»¤é€‰é¡¹å‚è€ƒ"></a>å‘½ä»¤é€‰é¡¹å‚è€ƒ</h2><table>
<thead>
<tr>
<th>åˆ†ç±»</th>
<th>é€‰é¡¹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ™®é€š</td>
<td><code>--help</code></td>
<td>æ‰“å°å‡ºä¸€ä¸ªç®€å•çš„ä½¿ç”¨æŒ‡å—</td>
</tr>
<tr>
<td></td>
<td><code>-v</code></td>
<td>å‘½ä»¤è¡Œä¸­çš„æ¯ä¸€ä¸ª-véƒ½ä¼šå¢åŠ è¯¦ç»†ç¨‹åº¦ã€‚Level 0ï¼ˆé»˜è®¤ï¼‰ä¼šåœ¨å¯åŠ¨é€šçŸ¥ã€æµ‹è¯•å®Œæˆã€æœ€åç»“æœæ—¶æä¾›å°‘é‡çš„ä¿¡æ¯ã€‚Level 1æä¾›æ›´å¤šæµ‹è¯•è¿è¡Œæ—¶çš„ç»†èŠ‚ï¼Œæ¯”å¦‚æ¯ä¸ªå‘é€åˆ°ä½ activitiesçš„äº‹ä»¶ã€‚Level 2æä¾›æ›´è¯¦ç»†çš„è®¾ç½®ä¿¡æ¯ï¼Œæ¯”å¦‚æµ‹è¯•æ—¶activituesé€‰æ‹©çš„æˆ–è€…æœªé€‰æ‹©çš„ã€‚</td>
</tr>
<tr>
<td>äº‹ä»¶</td>
<td><code>-s &lt;seed&gt;</code></td>
<td>ä¼ªéšæœºæ•°å­—ç”Ÿæˆå™¨ç§å­ã€‚å¦‚æœä½ ä½¿ç”¨ç›¸åŒçš„seedå€¼é‡æ–°è¿è¡ŒMonkeyï¼Œå®ƒä¼šäº§ç”Ÿç›¸åŒåºåˆ—çš„äº‹ä»¶</td>
</tr>
<tr>
<td></td>
<td><code>--throttle &lt;milliseconds&gt;</code></td>
<td>åœ¨äº‹ä»¶ä¹‹é—´æ’å…¥ä¸€ä¸ªå›ºå®šçš„å»¶è¿Ÿã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªé€‰é¡¹æ¥è®©Monkeyå‡é€Ÿã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œäº‹ä»¶å°±æ²¡æœ‰ä»»ä½•å»¶è¿Ÿï¼Œäº‹ä»¶ä¼šå°½å¯èƒ½å¿«åœ°ç”Ÿæˆã€‚</td>
</tr>
<tr>
<td></td>
<td><code>--pct-touch &lt;percent&gt;</code></td>
<td>è°ƒæ•´è§¦æ‘¸äº‹ä»¶çš„ç™¾åˆ†æ¯”ã€‚ï¼ˆè§¦æ‘¸äº‹ä»¶æ˜¯ä¸€ä¸ªåœ¨å±å¹•å•ä¸ªä½ç½®çš„down-upäº‹ä»¶ã€‚ï¼‰</td>
</tr>
<tr>
<td></td>
<td><code>--pct-motion &lt;percent&gt;</code></td>
<td>è°ƒæ•´ç§»åŠ¨äº‹ä»¶çš„ç™¾åˆ†æ¯”ã€‚ï¼ˆç§»åŠ¨äº‹ä»¶ç»„æˆï¼šå±å¹•ä¸Šçš„ä¸€ä¸ªdownäº‹ä»¶ï¼Œä¸€ç³»åˆ—çš„ä¼ªéšæœºç§»åŠ¨äº‹ä»¶ï¼Œå’Œä¸€ä¸ªupäº‹ä»¶ã€‚ï¼‰</td>
</tr>
<tr>
<td></td>
<td><code>--pct-trackball &lt;percent&gt;</code></td>
<td>è°ƒæ•´è½¨è¿¹çƒäº‹ä»¶çš„ç™¾åˆ†æ¯”ã€‚ï¼ˆè½¨è¿¹çƒäº‹ä»¶ç»„æˆï¼šä¸€ä¸ªæˆ–è€…å¤šä¸ªéšæœºç§»åŠ¨ï¼Œæœ‰æ—¶è·Ÿéšä¸€ä¸ªç‚¹å‡»äº‹ä»¶ã€‚ï¼‰</td>
</tr>
<tr>
<td></td>
<td><code>--pct-nav &lt;percent&gt;</code></td>
<td>è°ƒæ•´â€œbasicâ€å¯¼èˆªäº‹ä»¶çš„ç™¾åˆ†æ¯”ã€‚ï¼ˆå¯¼èˆªäº‹ä»¶ç»„æˆï¼šup/down/left/rightï¼Œä½œä¸ºä¸€ä¸ªæ–¹å‘è¾“å…¥è®¾å¤‡è¾“å…¥ã€‚ï¼‰</td>
</tr>
<tr>
<td></td>
<td><code>--pct-majornav &lt;percent&gt;</code></td>
<td>è°ƒæ•´â€œmajorâ€å¯¼èˆªäº‹ä»¶çš„ç™¾åˆ†æ¯”ã€‚ï¼ˆè¿™äº›å¯¼èˆªäº‹ä»¶æ¯”è¾ƒå…¸å‹çš„æ˜¯ç”±ä½ çš„UIå¼•å‘çš„è¡Œä¸ºï¼Œæ¯”å¦‚5-way padä¸­é—´æŒ‰é’®ã€è¿”å›é”®æˆ–è€…èœå•é”®ã€‚ï¼‰</td>
</tr>
<tr>
<td></td>
<td><code>--pct-syskeys &lt;percent&gt;</code></td>
<td>è°ƒæ•´â€œsystemâ€æŒ‰é”®äº‹ä»¶çš„ç™¾åˆ†æ¯”ã€‚ï¼ˆè¿™äº›æŒ‰é”®ä¸€èˆ¬éƒ½æ˜¯è¢«ç³»ç»Ÿä¿ç•™çš„ï¼Œæ¯”å¦‚Homeã€è¿”å›ã€æ‹¨æ‰“ç”µè¯ã€æŒ‚ç”µè¯ã€éŸ³é‡æ§åˆ¶ã€‚ï¼‰</td>
</tr>
<tr>
<td></td>
<td><code>--pct-appswitch &lt;percent&gt;</code></td>
<td>è°ƒæ•´Activityå¯åŠ¨çš„ç™¾åˆ†æ¯”ã€‚åœ¨ä¸€ä¸ªéšæœºçš„é—´éš”ï¼ŒMonkeyä¼šè°ƒç”¨startActivity()æ–¹æ³•ï¼Œæœ€å¤§é™åº¦åœ°è¦†ç›–åˆ°ä½ åŒ…é‡Œçš„æ‰€æœ‰Activityã€‚</td>
</tr>
<tr>
<td></td>
<td><code>--pct-anyevent &lt;percent&gt;</code></td>
<td>è°ƒæ•´å…¶å®ƒäº‹ä»¶ç±»å‹çš„ç™¾åˆ†æ¯”ã€‚å®ƒä¼šåŒ…å«æ‰€æœ‰ç±»å‹çš„äº‹ä»¶ï¼Œæ¯”å¦‚æŒ‰é”®ï¼Œå…¶å®ƒå¾ˆå°‘ä½¿ç”¨çš„è®¾å¤‡æŒ‰é’®ç­‰ç­‰ã€‚</td>
</tr>
<tr>
<td>é™åˆ¶</td>
<td><code>-p &lt;allowed-package-name&gt;</code></td>
<td>å¦‚æœä½ ä½¿ç”¨è¿™ä¸ªæ–¹å¼æŒ‡å®šäº†ä¸€ä¸ªæˆ–è€…å¤šä¸ªåŒ…ï¼ŒMonkeyå°†ä¼šåªå…è®¸ç³»ç»Ÿè®¿é—®è¿™äº›åŒ…ä¸­çš„Activitiesï¼Œå¦‚æœä½ çš„åº”ç”¨ç¨‹åºéœ€è¦è®¿é—®å…¶å®ƒåŒ…ï¼ˆæ¯”å¦‚ï¼Œé€‰æ‹©ä¸€ä¸ªè”ç³»äººï¼‰ï¼Œä½ ä¹ŸåŒæ ·éœ€è¦æŒ‡å®šè¿™äº›åŒ…ã€‚å¦‚æœä½ ä¸æŒ‡å®šä»»ä½•åŒ…ï¼ŒMonkeyä¼šå…è®¸ç³»ç»Ÿå¯åŠ¨æ‰€æœ‰åŒ…ä¸­çš„activitiesã€‚è¦æŒ‡å®šå¤šä¸ªåŒ…ï¼Œå°±å¤šæ¬¡ä½¿ç”¨<code>-p</code>â€”â€” æ¯ä¸€ä¸ªåŒ…ä½¿ç”¨ä¸€ä¸ª<code>-p</code>ã€‚</td>
</tr>
<tr>
<td></td>
<td><code>-c &lt;main-category&gt;</code></td>
<td>å¦‚æœä½¿ç”¨è¿™ä¸ªæ–¹å¼æŒ‡å®šäº†ä¸€ä¸ªæˆ–è€…å¤šä¸ª<code>categories</code>ï¼ŒMonkeyä¼šåªå…è®¸ç³»ç»Ÿè®¿é—®æŒ‡å®š<code>categories</code>åˆ—è¡¨ä¸­ä»»æ„ä¸€ä¸ª<code>category</code>çš„Activitiesã€‚å¦‚æœä½ æ²¡æœ‰æŒ‡å®šä»»ä½•<code>categories</code>ï¼ŒMonkeyä¼šæŸ¥è¯¢<code>Intent.CATEGORY_LAUNCHER</code>æˆ–è€…<code>Intent.CATEGORY_MONKEY</code>ã€‚è¦æŒ‡å®šå¤šä¸ª<code>category</code>ï¼Œå°±å¤šæ¬¡ä½¿ç”¨<code>-c</code>â€”â€” æ¯ä¸€ä¸ª<code>category</code>ä½¿ç”¨ä¸€ä¸ª<code>-c</code>ã€‚</td>
</tr>
<tr>
<td>è°ƒè¯•</td>
<td><code>--dbg-no-events</code></td>
<td>å½“è¿™ä¸ªè¢«æŒ‡å®šæ—¶ï¼ŒMonkeyä¼šæ‰§è¡Œåˆå§‹åŒ–å¯åŠ¨ä¸€ä¸ªæµ‹è¯•activityï¼Œä½†æ˜¯ä¸ä¼šå†è¿›ä¸€æ­¥äº§ç”Ÿä»»ä½•äº‹ä»¶äº†ã€‚æœ€å¥½çš„æ–¹å¼æ˜¯ç»“åˆ<code>-v</code>ï¼Œä¸€ä¸ªæˆ–è€…å¤šä¸ªåŒ…é™åˆ¶å’Œéé›¶çš„é—´éš”æ¥ä¿æŒMonkeyè¿è¡Œ30ç§’æˆ–è€…æ›´é«˜ã€‚è¿™æ ·å®ƒå°±æä¾›äº†ä¸€ä¸ªå¯ä»¥ç›‘è§†åº”ç”¨ç¨‹åºè°ƒç”¨åŒ…ä¹‹é—´çš„è½¬æ¢è¿‡ç¨‹çš„ç¯å¢ƒã€‚</td>
</tr>
<tr>
<td></td>
<td><code>--hprof</code></td>
<td>å¦‚æœè®¾ç½®ï¼Œè¿™ä¸ªé€‰æ‹©ä¼šåœ¨Monkeyäº‹ä»¶åºåˆ—ä¹‹å‰å’Œä¹‹åéƒ½ä¼šç”Ÿæˆåˆ†ææŠ¥å‘Šã€‚è¿™ä¸ªä¼šç”Ÿæˆä¸€ä¸ªå¤§æ–‡ä»¶ï¼ˆ~5Mbï¼‰åœ¨<code>/data/misc</code>ç›®å½•ä¸‹ï¼Œæ‰€ä»¥éœ€è¦å°å¿ƒä½¿ç”¨ã€‚æ›´å¤šè¿½è¸ªæ–‡ä»¶ä¿¡æ¯è§<a href="http://developer.android.com/tools/debugging/debugging-tracing.html" target="_blank" rel="noopener">Traceview</a>ã€‚</td>
</tr>
<tr>
<td></td>
<td><code>--ignore-crashes</code></td>
<td>é€šå¸¸æƒ…å†µä¸‹ï¼ŒMonkeyä¼šåœ¨åº”ç”¨ç¨‹åºå´©æºƒæˆ–è€…é­é‡åˆ°æœªå¤„ç†çš„å¼‚å¸¸æ—¶åœæ­¢è¿è¡Œã€‚å¦‚æœä½ è®¾ç½®äº†è®¾ä¸ªé€‰é¡¹ï¼ŒMonkeyå°†ä¼šç»§ç»­å‘é€äº‹ä»¶åˆ°ç³»ç»Ÿï¼Œç›´åˆ°å®Œæˆæ‰€æœ‰ã€‚</td>
</tr>
<tr>
<td></td>
<td><code>--ignore-timeouts</code></td>
<td>é€šå¸¸æƒ…å†µä¸‹ï¼ŒMonkeyä¼šåœ¨åº”ç”¨ç¨‹åºå´©æºƒæˆ–è€…é­é‡åˆ°ç±»å‹ä¸ºè¶…æ—¶çš„å¼‚å¸¸å¦‚â€Application Not Respondingâ€å¯¹è¯æ¡†æ—¶åœæ­¢è¿è¡Œã€‚å¦‚æœä½ æŒ‡å®šäº†è¿™ä¸ªé€‰é¡¹ï¼ŒMonkeyå°†ä¼šç»§ç»­å‘é€äº‹ä»¶åˆ°ç³»ç»Ÿï¼Œç›´åˆ°å®Œæˆæ‰€æœ‰ã€‚</td>
</tr>
<tr>
<td></td>
<td><code>--ignore-security-exceptions</code></td>
<td>é€šå¸¸æƒ…å†µä¸‹ï¼ŒMonkeyä¼šåœ¨åº”ç”¨ç¨‹åºå´©æºƒæˆ–è€…é­é‡åˆ°ç±»å‹ä¸ºæƒé™é”™è¯¯çš„å¼‚å¸¸æ—¶åœæ­¢è¿è¡Œï¼Œå¦‚è¯•å›¾å»å¯åŠ¨ä¸€ä¸ªéœ€è¦ç¡®å®šæƒé™çš„Activityæ—¶ã€‚å¦‚æœä½ æŒ‡å®šäº†è¿™ä¸ªé€‰é¡¹ï¼ŒMonkeyå°†ä¼šç»§ç»­å‘é€äº‹ä»¶åˆ°ç³»ç»Ÿï¼Œç›´åˆ°å®Œæˆæ‰€æœ‰ã€‚</td>
</tr>
<tr>
<td></td>
<td><code>--kill-process-after-error</code></td>
<td>é€šå¸¸æƒ…å†µä¸‹ï¼Œå½“Monkeyç”±äºä¸€ä¸ªé”™è¯¯è€Œåœæ­¢è¿è¡Œï¼Œå‡ºé”™çš„åº”ç”¨ç¨‹åºè¿˜ä¼šç»§ç»­è¿è¡Œï¼Œå¦‚æœä½ æŒ‡å®šäº†è¿™ä¸ªé€‰é¡¹ï¼Œå®ƒä¼šå‘ä¸€ä¸ªä¿¡å·æ¥åœæ­¢è¿™ä¸ªå‘ç”Ÿé”™è¯¯çš„è¿›ç¨‹ã€‚æ³¨æ„ï¼Œåœ¨æ­£å¸¸ï¼ˆæˆåŠŸï¼‰å®Œæˆæ—¶ï¼Œå¯åŠ¨äº†çš„è¿›ç¨‹ä¸ä¼šè¢«å…³é—­ï¼Œè®¾å¤‡åªæ˜¯åœ¨äº‹ä»¶å®Œæˆåç®€å•åœ°ä¿æŒæœ€åçš„çŠ¶æ€ã€‚</td>
</tr>
<tr>
<td></td>
<td><code>--monitor-native-crashes</code></td>
<td>è§‚å¯Ÿå’ŒæŠ¥å‘ŠAndroidç³»ç»Ÿnativeä»£ç å¼•å‘çš„å´©æºƒã€‚å¦‚æœ<code>If --kill-process-after-error</code>è¢«è®¾ç½®äº†ï¼Œåˆ™æ•´ä¸ªç³»ç»Ÿå°±ä¼šè¢«åœæ­¢ã€‚</td>
</tr>
<tr>
<td></td>
<td><code>--wait-dbg</code></td>
<td>åœæ­¢Monkeyçš„æ‰§è¡Œï¼Œç›´åˆ°æœ‰è°ƒè¯•å™¨è·Ÿå®ƒè¿æ¥åˆ°ã€‚</td>
</tr>
</tbody>
</table>
]]></content>
      
        
        <tags>
            
            <tag> testing </tag>
            
            <tag> android </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> monkey </tag>
            
            <tag> adb </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]å®˜ç½‘ã€ŠTesting Support Libraryã€‹ä¸­æ–‡ç¿»è¯‘]]></title>
      <url>/2015/12/15/Android-%E5%AE%98%E7%BD%91%E3%80%8ATesting-Support-Library%E3%80%8B%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91/</url>
      <content type="html"><![CDATA[<p>ç¿»è¯‘è‡ª Android Developer å®˜ç½‘ï¼š<a href="http://developer.android.com/tools/testing-support-library/index.html" target="_blank" rel="noopener">http://developer.android.com/tools/testing-support-library/index.html</a></p>
<h1 id="Testing-Support-Library"><a href="#Testing-Support-Library" class="headerlink" title="Testing Support Library"></a>Testing Support Library</h1><p><code>Android Testing Support Library</code>ä¸ºAndroid appçš„æµ‹è¯•æä¾›äº†ä¸€ä¸ªå¹¿æ³›çš„æ¡†æ¶ã€‚ è¿™ä¸ªåº“æä¾›äº†ä¸€ç³»åˆ—çš„APIå¯ä»¥è®©ä½ å¿«é€Ÿbuildå’Œrunä½ appçš„ä»£ç ï¼Œå®ƒåŒ…æ‹¬äº†<code>JUnit 4</code>å’ŒåŠŸèƒ½æ€§çš„ç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰æµ‹è¯•ã€‚ä½ å¯ä»¥é€šè¿‡<a href="http://developer.android.com/tools/studio/index.html" target="_blank" rel="noopener">Android Studio IDE</a>æˆ–è€…å‘½ä»¤è¡Œçš„æ–¹å¼è¿è¡Œä½ ä½¿ç”¨è¿™äº›APIåˆ›å»ºçš„æµ‹è¯•ã€‚</p>
<p><code>Android Testing Support Library</code>å·²ç»å¯ä»¥é€šè¿‡<code>Android SDK Manager</code>ä¸‹è½½ä½¿ç”¨äº†ã€‚è¯¦æƒ…å¯è§<a href="http://developer.android.com/tools/testing-support-library/index.html#setup" target="_blank" rel="noopener">Testing Support Library Setup</a></p>
<p>è¿™é¡µä¸­ä¼šæä¾›ä¸€äº›å…³äº<code>Android Testing Support Library</code>ä¸­æ‰€æä¾›çš„å·¥å…·çš„ä¿¡æ¯ï¼Œæ€æ ·åœ¨ä½ çš„æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨å®ƒä»¬ï¼Œè¿˜æœ‰åº“å‘å¸ƒçš„ç›¸å…³ä¿¡æ¯ã€‚</p>
<h2 id="Testing-Support-Libraryçš„ç‰¹æ€§"><a href="#Testing-Support-Libraryçš„ç‰¹æ€§" class="headerlink" title="Testing Support Libraryçš„ç‰¹æ€§"></a>Testing Support Libraryçš„ç‰¹æ€§</h2><p><code>Android Testing Support Library</code>æä¾›åŒ…æ‹¬äº†ä»¥ä¸‹è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼š</p>
<ul>
<li><p><a href="http://developer.android.com/reference/android/support/test/runner/AndroidJUnitRunner.html" target="_blank" rel="noopener">AndroidJUnitRunner</a>ï¼šå…¼å®¹Androidçš„JUnit 4ã€‚</p>
</li>
<li><p><a href="http://developer.android.com/tools/testing-support-library/index.html#Espresso" target="_blank" rel="noopener">Espresso</a>ï¼šUIæµ‹è¯•æ¡†æ¶ï¼Œé€‚ç”¨äºappå†…çš„åŠŸèƒ½æ€§UIæµ‹è¯•ã€‚</p>
</li>
<li><p><a href="http://developer.android.com/tools/testing-support-library/index.html#UIAutomator" target="_blank" rel="noopener">UI Automator</a>ï¼šUIæµ‹è¯•æ¡†æ¶ï¼Œé€‚ç”¨äºç³»ç»Ÿå’Œå®‰è£…appé—´è·¨appçš„åŠŸèƒ½æ€§UIæµ‹è¯•ã€‚</p>
</li>
</ul>
<h3 id="AndroidJUnitRunner"><a href="#AndroidJUnitRunner" class="headerlink" title="AndroidJUnitRunner"></a>AndroidJUnitRunner</h3><p><a href="http://developer.android.com/reference/android/support/test/runner/AndroidJUnitRunner.html" target="_blank" rel="noopener">AndroidJUnitRunner</a> ç±»æ˜¯ä¸€ä¸ª <a href="http://junit.org/" target="_blank" rel="noopener">JUnit</a> æµ‹è¯•runnerï¼Œå®ƒå¯ä»¥è®©ä½ åœ¨Androidè®¾å¤‡ä¸Šè¿è¡Œ<code>JUnit 3</code>æˆ–è€…<code>JUnit 4-style</code>çš„æµ‹è¯•ç±»ï¼ŒåŒ…æ‹¬ä½¿ç”¨äº† <a href="http://developer.android.com/tools/testing-support-library/index.html#Espresso" target="_blank" rel="noopener">Espresso</a> å’Œ <a href="http://developer.android.com/tools/testing-support-library/index.html#UIAutomator" target="_blank" rel="noopener">UI Automator</a> æµ‹è¯•æ¡†æ¶çš„ã€‚<code>test runner</code>å¤„ç†çš„äº‹æƒ…æœ‰ åŠ è½½ä½ çš„æµ‹è¯•packageå’Œéœ€è¦åœ¨è®¾å¤‡ä¸Šæµ‹è¯•çš„appï¼Œè¿è¡Œä½ çš„æµ‹è¯•ï¼Œè¿˜æœ‰æŠ¥å‘Šæµ‹è¯•ç»“æœã€‚è¿™ä¸ªç±»ä¼šæ›¿æ¢æ‰åªæ”¯æŒ<code>JUnit 3</code>æµ‹è¯•çš„<a href="http://developer.android.com/reference/android/test/InstrumentationTestRunner.html" target="_blank" rel="noopener">InstrumentationTestRunner</a>ç±»ã€‚</p>
<p>è¿™ä¸ª<code>test runner</code>çš„å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li><p><a href="http://developer.android.com/tools/testing-support-library/index.html#ajur-junit" target="_blank" rel="noopener">JUnitçš„æ”¯æŒ</a></p>
</li>
<li><p><a href="http://developer.android.com/tools/testing-support-library/index.html#ajur-instrumentation" target="_blank" rel="noopener">è®¿é—®instrumentationä¿¡æ¯</a></p>
</li>
<li><p><a href="http://developer.android.com/tools/testing-support-library/index.html#ajur-filtering" target="_blank" rel="noopener">æµ‹è¯•è¿‡æ»¤</a></p>
</li>
<li><p><a href="http://developer.android.com/tools/testing-support-library/index.html#ajur-sharding" target="_blank" rel="noopener">æµ‹è¯•æ‹†åˆ†</a></p>
</li>
</ul>
<p>éœ€è¦ Android2.2(API level 8) æˆ–è€…æ›´é«˜ã€‚</p>
<h4 id="JUnitçš„æ”¯æŒ"><a href="#JUnitçš„æ”¯æŒ" class="headerlink" title="JUnitçš„æ”¯æŒ"></a>JUnitçš„æ”¯æŒ</h4><p><code>Rest runner</code>å…¼å®¹<code>JUnit 3</code>å’Œ<code>JUnit 4</code>ï¼ˆæœ€é«˜åˆ°<code>JUnit 4.10</code>ï¼‰çš„æµ‹è¯•ã€‚ä¸ç®¡æ€æ ·ï¼Œä½ åº”è¯¥é¿å…åœ¨ä¸€ä¸ªpackageä¸­æ··åˆä½¿ç”¨JUnit 3å’Œ JUnit 4çš„ä»£ç ï¼Œå› ä¸ºè¿™æ ·åšå¯èƒ½ä¼šå¼•å‘ä¸€äº›é¢„æ–™ä¹‹å¤–çš„é—®é¢˜ã€‚å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªJUnit 4çš„æµ‹è¯•ç±»åœ¨è®¾å¤‡æˆ–è€…æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œæ—¶ï¼Œä½ çš„æµ‹è¯•ç±»å¿…é¡»è¦åŠ ä¸Š<code>@RunWith(AndroidJUnit4.class)</code>æ³¨è§£ä½œä¸ºå‰ç¼€ã€‚</p>
<p>ä¸‹é¢çš„ä»£ç ç‰‡æ®µå±•ç¤ºäº†ä½ åº”è¯¥æ€ä¹ˆå»ç¼–å†™ä¸€ä¸ªJUnit 4æµ‹è¯•æ¥éªŒè¯<code>CalculatorActivity</code>ç±»ä¸­çš„<code>add</code>æ“ä½œæ˜¯æ­£ç¡®æ‰§è¡Œçš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.support.test.runner.AndroidJUnit4;</span><br><span class="line"><span class="keyword">import</span> android.support.test.runner.AndroidJUnitRunner;</span><br><span class="line"><span class="keyword">import</span> android.test.ActivityInstrumentationTestCase2;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(AndroidJUnit4.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CalculatorInstrumentationTest</span></span></span><br><span class="line"><span class="class">        <span class="keyword">extends</span> <span class="title">ActivityInstrumentationTestCase2</span>&lt;<span class="title">CalculatorActivity</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.setUp();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å½“ä½ ä½¿ç”¨`AndroidJUnitRunner`è¿è¡Œæµ‹è¯•æ—¶ï¼Œ</span></span><br><span class="line">        <span class="comment">// æ³¨å…¥Instrumentationå®ä¾‹æ˜¯å¿…è¦çš„ã€‚</span></span><br><span class="line">        injectInstrumentation(InstrumentationRegistry.getInstrumentation());</span><br><span class="line">        mActivity = getActivity();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">typeOperandsAndPerformAddOperation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨CalculatorActivity add()æ–¹æ³•å¹¶ä¼ å…¥ä¸€äº›æ“ä½œæ•°æ®ï¼Œ</span></span><br><span class="line">        <span class="comment">// ç„¶åæ£€æŸ¥è¿”å›å€¼æ˜¯å¦æ˜¯æœŸæœ›å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.tearDown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è®¿é—®instrumentationä¿¡æ¯"><a href="#è®¿é—®instrumentationä¿¡æ¯" class="headerlink" title="è®¿é—®instrumentationä¿¡æ¯"></a>è®¿é—®instrumentationä¿¡æ¯</h4><p>ä½ å¯ä»¥ä½¿ç”¨ <a href="http://developer.android.com/reference/android/support/test/InstrumentationRegistry.html" target="_blank" rel="noopener"><code>InstrumentationRegistry</code></a> ç±»æ¥è®¿é—®ä½ æµ‹è¯•çš„appçš„ç›¸å…³ä¿¡æ¯ã€‚è¿™ä¸ªç±»åŒ…å«ä¸€ä¸ª <a href="http://developer.android.com/reference/android/app/Instrumentation.html" target="_blank" rel="noopener"><code>Instrumentation</code></a> å¯¹è±¡ï¼Œç›®æ ‡appçš„ <a href="http://developer.android.com/reference/android/content/Context.html" target="_blank" rel="noopener"><code>Context</code></a> å¯¹è±¡ï¼Œè¿˜æœ‰ä½ é€šè¿‡å‘½ä»¤è¡Œä¼ å…¥åˆ°è¯¥æµ‹è¯•çš„å‚æ•°ã€‚è¿™ä¸ªæ•°æ®åœ¨ä½ ä½¿ç”¨UI Automatoræ¡†æ¶ç¼–å†™æµ‹è¯•æˆ–è€…ç¼–å†™ä¸€äº›ä¾èµ– <a href="http://developer.android.com/reference/android/app/Instrumentation.html" target="_blank" rel="noopener"><code>Instrumentation</code></a> æˆ–è€… <a href="http://developer.android.com/reference/android/content/Context.html" target="_blank" rel="noopener"><code>Context</code></a> å¯¹è±¡çš„æµ‹è¯•çš„æ—¶å€™æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚</p>
<h4 id="æµ‹è¯•è¿‡æ»¤"><a href="#æµ‹è¯•è¿‡æ»¤" class="headerlink" title="æµ‹è¯•è¿‡æ»¤"></a>æµ‹è¯•è¿‡æ»¤</h4><p>åœ¨ä½ çš„ JUnit 4 æµ‹è¯•ä¸­ï¼Œ ä½ å¯ä»¥ä½¿ç”¨æ³¨è§£æ¥é…ç½®ä½ çš„æµ‹è¯•çš„è¿è¡Œã€‚è¿™ä¼šæœ€å¤§é™åº¦åœ°å‡å°‘ä½ æµ‹è¯•ä¸­éœ€è¦çš„æ¨¡ç‰ˆä»£ç å’Œæœ‰æ¡ä»¶çš„ä»£ç ã€‚é™¤äº† JUnit 4 æ”¯æŒçš„æ ‡å‡†æ³¨è§£ï¼Œ<code>test runner</code>ä¹Ÿæ”¯æŒä¸€äº›é’ˆå¯¹Androidçš„ç‰¹æ®Šçš„æ³¨è§£ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><p><a href="http://developer.android.com/reference/android/support/test/filters/RequiresDevice.html" target="_blank" rel="noopener"><code>@RequiresDevice</code></a>ï¼šæŒ‡æ˜è¿™ä¸ªæµ‹è¯•åªèƒ½è¿è¡Œçš„ç‰©ç†è®¾å¤‡ä¸Šé¢ï¼Œè€Œä¸æ˜¯æ¨¡æ‹Ÿå™¨ä¸Šé¢ã€‚</p>
</li>
<li><p><a href="http://developer.android.com/reference/android/support/test/filters/SdkSuppress.html" target="_blank" rel="noopener"><code>@SdkSupress</code></a>ï¼šé™åˆ¶è¿™ä¸ªæµ‹è¯•è¿è¡Œåœ¨ä½äºç»™å®šçš„Android API levelã€‚ä¸¾ä¸ªä¾‹å­ï¼Œé™åˆ¶æµ‹è¯•è¿è¡Œåœ¨API levelä½äº18çš„ç¯å¢ƒä¸‹ï¼Œä½¿ç”¨æ³¨è§£ <code>@SDKSupress(minSdkVersion=18)</code>ã€‚</p>
</li>
<li><p><a href="http://developer.android.com/reference/android/test/suitebuilder/annotation/SmallTest.html" target="_blank" rel="noopener"><code>@SmallTest</code></a>ï¼Œ<a href="http://developer.android.com/reference/android/test/suitebuilder/annotation/MediumTest.html" target="_blank" rel="noopener"><code>@MediumTest</code></a>ï¼Œå’Œ<a href="http://developer.android.com/reference/android/test/suitebuilder/annotation/LargeTest.html" target="_blank" rel="noopener"><code>@LargeTest</code></a>ï¼šå¯¹æµ‹è¯•éœ€è¦çš„æ—¶é—´è¿è¡Œæ¥åˆ†ç±»ï¼Œå› æ­¤ï¼Œå¯ä»¥å†³å®šæ˜¯å¦å¯ä»¥ç»å¸¸è¿è¡Œè¯¥æµ‹è¯•ã€‚</p>
</li>
</ul>
<h4 id="æµ‹è¯•æ‹†åˆ†"><a href="#æµ‹è¯•æ‹†åˆ†" class="headerlink" title="æµ‹è¯•æ‹†åˆ†"></a>æµ‹è¯•æ‹†åˆ†</h4><p><code>Test runner</code> æ”¯æŒæŠŠä¸€ä¸ªæµ‹è¯•å¥—ä»¶åˆ†å‰²æˆå¤šä¸ªç¢ç‰‡ï¼Œæ‰€ä»¥ä½ å¯ä»¥å¾ˆç®€å•åœ°è¿è¡Œå±äºé€šè¿‡ç¢ç‰‡åˆ†ç»„çš„æ‰€æœ‰æµ‹è¯•ï¼Œå¹¶ä¸”å®ƒä»¬ä½¿ç”¨åŒä¸€ä¸ª <a href="http://developer.android.com/reference/android/app/Instrumentation.html" target="_blank" rel="noopener"><code>Instrumentation</code></a> å®ä¾‹ã€‚æ¯ä¸€ä¸ªç¢ç‰‡éƒ½æœ‰ä¸€ä¸ªç´¢å¼•ç¼–å·ï¼ˆindex numberï¼‰ä½œä¸ºå®ƒçš„å”¯ä¸€è¯†åˆ«ã€‚å½“è¿è¡Œæµ‹è¯•æ—¶ï¼Œä½¿ç”¨ <code>-e numShards</code> é€‰é¡¹æ¥æŒ‡å®šè¦åˆ›å»ºçš„ç¢ç‰‡çš„æ•°é‡å’Œ <code>-e shardIndex</code> é€‰é¡¹æ¥æŒ‡å®šå“ªäº›ç¢ç‰‡è¿è¡Œã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼ŒæŠŠä¸€ä¸ªæµ‹è¯•å¥—ä»¶åˆ†å‰²æˆ10ä¸ªç¢ç‰‡ï¼Œå¹¶ä¸”åªè¿è¡Œè¢«åˆ†ç»„çš„æµ‹è¯•ä¸­çš„ç¬¬äºŒä¸ªç¢ç‰‡ï¼Œä½¿ç”¨ä»¥ä¸‹çš„å‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell am instrument -w -e numShards 10 -e shardIndex 2</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ª <code>test runner</code> çš„æ›´å¤šç›¸å…³å­¦ä¹ ï¼Œè§ <a href="http://developer.android.com/reference/android/support/test/package-summary.html" target="_blank" rel="noopener">API reference</a>ã€‚</p>
<h3 id="Espresso"><a href="#Espresso" class="headerlink" title="Espresso"></a>Espresso</h3><p>Espresso æµ‹è¯•æ¡†æ¶æä¾›äº†ä¸€ç³»åˆ—çš„APIç”¨äºæ„å»ºUIæµ‹è¯•æ¥æµ‹è¯•appå†…ç”¨æˆ·æµæ“ä½œã€‚è¿™äº›APIè®©ä½ å¯ä»¥ç¼–å†™ç®€æ´å¯é çš„è‡ªåŠ¨åŒ–UIæµ‹è¯•ã€‚<strong>Espressoéå¸¸é€‚åˆç”¨æ¥ç¼–å†™ç™½ç›’æµ‹è¯•</strong>ï¼Œå…¶ä¸­æµ‹è¯•ä»£ç çš„ç¼–å†™æ˜¯åˆ©ç”¨äº†è¢«æµ‹è¯•appä¸­ç¨‹åºä»£ç å®ç°ç»†èŠ‚ã€‚</p>
<p>Espressoæµ‹è¯•æ¡†æ¶çš„å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li><p>æä¾›äº†çµæ´»çš„APIç”¨äºåŒ¹é…ç›®æ ‡appä¸­<code>view</code>å’Œ<code>adapter</code>ã€‚æ›´å¤šçš„ä¿¡æ¯ï¼Œè§ <a href="http://developer.android.com/tools/testing-support-library/index.html#espresso-matching" target="_blank" rel="noopener">View åŒ¹é…</a></p>
</li>
<li><p>å¤§è€Œå…¨çš„ <code>è¡Œä¸º api</code>ï¼ˆaction APIsï¼‰ ç”¨äºè‡ªåŠ¨åŒ–UIäº¤äº’ã€‚æ›´å¤šçš„ä¿¡æ¯ï¼Œè§ <a href="http://developer.android.com/tools/testing-support-library/index.html#espresso-actions" target="_blank" rel="noopener">è¡Œä¸º APIs</a></p>
</li>
<li><p>UIçº¿ç¨‹åŒæ­¥æ¥æé«˜æµ‹è¯•å¯é æ€§ã€‚æ›´å¤šä¿¡æ¯ï¼Œè§ <a href="http://developer.android.com/tools/testing-support-library/index.html#espresso-thread-sync" target="_blank" rel="noopener">UI çº¿ç¨‹åŒæ­¥</a></p>
</li>
</ul>
<p>éœ€è¦ Android2.2(API level 8) æˆ–è€…æ›´é«˜ã€‚</p>
<h4 id="View-åŒ¹é…"><a href="#View-åŒ¹é…" class="headerlink" title="View åŒ¹é…"></a>View åŒ¹é…</h4><p><a href="http://developer.android.com/reference/android/support/test/espresso/Espresso.html#onView" target="_blank" rel="noopener"><code>Espresso.onView()</code></a> æ–¹æ³•å¯ä»¥è®©ä½ è®¿é—®ç›®æ ‡appä¸­çš„ä¸€ä¸ªUIç»„ä»¶å¹¶ä¸å®ƒäº¤äº’ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ª <a href="http://hamcrest.org/JavaHamcrest/javadoc/1.3/org/hamcrest/Matcher.html" target="_blank" rel="noopener"><code>Matcher</code></a> ä½œä¸ºå‚æ•°ï¼Œç„¶åæ ¹æ®æˆ‘ä»¬ç»™å®šçš„æ¡ä»¶åœ¨viewçš„å±‚æ¬¡ç»“æ„ä¸­æœç´¢å‡ºå¯¹åº”ç›¸ç¬¦çš„<a href="http://developer.android.com/reference/android/view/View.html" target="_blank" rel="noopener"><code>View</code></a>å®ä¾‹ã€‚ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ¡ä»¶æ¥ä¼˜åŒ–ä½ çš„æœç´¢ç»“æœï¼š</p>
<ul>
<li>Viewçš„ç±»å</li>
<li>Viewå†…å®¹çš„æè¿°ï¼ˆ<code>content description</code>ï¼‰</li>
<li>Viewçš„<code>R.id</code></li>
<li>Viewæ˜¾ç¤ºçš„æ–‡æœ¬</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¯»æ‰¾ä¸€ä¸ªIDä¸º<code>my_button</code>çš„ç›®æ ‡buttonï¼Œä½ å¯ä»¥å¦‚ä»¥ä¸‹ä¸€æ ·æŒ‡å®šä¸€ä¸ªmatcherï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onView(withId(R.id.my_button));</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæœç´¢æ˜¯æˆåŠŸçš„ï¼Œ<a href="http://developer.android.com/reference/android/support/test/espresso/Espresso.html#onView" target="_blank" rel="noopener"><code>onView()</code></a> æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå¯ä»¥è®©ä½ æ‰§è¡Œç”¨æˆ·è¡Œä¸ºå’Œæµ‹è¯•ç›®æ ‡ä¸­å¯¹viewæ–­è¨€çš„å¼•ç”¨ã€‚</p>
<h4 id="Adapter-åŒ¹é…"><a href="#Adapter-åŒ¹é…" class="headerlink" title="Adapter åŒ¹é…"></a>Adapter åŒ¹é…</h4><p>åœ¨ä¸€ä¸ª <a href="http://developer.android.com/reference/android/widget/AdapterView.html" target="_blank" rel="noopener"><code>AdapterView</code></a> çš„å¸ƒå±€ä¸­ï¼Œå¸ƒå±€æ˜¯åœ¨è¿è¡Œæ—¶æ ¹æ®childrenåŠ¨æ€å¡«å……çš„ã€‚å¦‚æœç›®æ ‡viewæ˜¯åœ¨ <a href="http://developer.android.com/reference/android/widget/AdapterView.html" target="_blank" rel="noopener"><code>AdapterView</code></a> å­ç±»ï¼ˆæ¯”å¦‚<a href="http://developer.android.com/reference/android/widget/ListView.html" target="_blank" rel="noopener"><code>ListView</code></a> æˆ–è€… <a href="http://developer.android.com/reference/android/widget/GridView.html" target="_blank" rel="noopener"><code>GridView</code></a>ï¼‰çš„å¸ƒå±€ä¸­çš„ï¼Œ<a href="http://developer.android.com/reference/android/support/test/espresso/Espresso.html#onView" target="_blank" rel="noopener"><code>onView()</code></a> æ–¹æ³•å¯èƒ½å°±ä¸èµ·ä½œç”¨äº†ï¼Œå› ä¸ºå½“å‰åŠ è½½çš„viewå±‚æ¬¡ç»“æ„å¯èƒ½åªæ˜¯layoutçš„ä¸€ä¸ªå­é›†ã€‚</p>
<p>æ›¿ä»£æ–¹æ¡ˆæ˜¯ä½¿ç”¨ <a href="http://developer.android.com/reference/android/support/test/espresso/Espresso.html#onData)" target="_blank" rel="noopener"><code>Espresso.onData()</code></a> æ–¹æ³•å»è®¿é—®ä¸€ä¸ªç›®æ ‡viewå…ƒç´ ã€‚<a href="http://developer.android.com/reference/android/support/test/espresso/Espresso.html#onData)" target="_blank" rel="noopener"><code>Espresso.onData()</code></a> æ–¹æ³•è¿”å›ä¸€ä¸ªå¯ä»¥è®©ä½ æ‰§è¡Œç”¨æˆ·è¡Œä¸ºå’Œæµ‹è¯•ç›®æ ‡ <a href="http://developer.android.com/reference/android/widget/AdapterView.html" target="_blank" rel="noopener"><code>AdapterView</code></a> ä¸­å¯¹å…ƒç´ æ–­è¨€çš„å¼•ç”¨ã€‚</p>
<h4 id="è¡Œä¸º-APIs"><a href="#è¡Œä¸º-APIs" class="headerlink" title="è¡Œä¸º APIs"></a>è¡Œä¸º APIs</h4><p>å…¸å‹çš„ï¼Œä½ å¯ä»¥é€šè¿‡å¯¹appçš„ç”¨æˆ·ç•Œé¢æ‰§è¡Œä¸€äº›ç”¨æˆ·äº¤äº’æ¥æµ‹è¯•appã€‚åœ¨ä½ çš„æµ‹è¯•ä¸­ä½¿ç”¨ <a href="http://developer.android.com/reference/android/support/test/espresso/action/ViewActions.html" target="_blank" rel="noopener"><code>ViewActions</code></a> API å¯ä»¥è®©ä½ å¾ˆå®¹æ˜“åœ°è‡ªåŠ¨åŒ–è¿™äº›è¡Œä¸ºã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ‰§è¡Œè¿™äº›UIäº¤äº’ï¼š</p>
<ul>
<li><p>Viewçš„ç‚¹å‡»</p>
</li>
<li><p>æ»‘åŠ¨</p>
</li>
<li><p>æŒ‰é”®å’ŒæŒ‰é’®çš„æŒ‰ä¸‹</p>
</li>
<li><p>è¾“å…¥æ–‡æœ¬</p>
</li>
<li><p>æ‰“å¼€ä¸€ä¸ªé“¾æ¥</p>
</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¨¡æ‹Ÿè¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²æ•°æ®å¹¶æŒ‰ä¸‹æŒ‰é’®æ¥æäº¤è¿™ä¸ªå€¼ï¼Œä½ å¯ä»¥åƒè¿™æ ·ç¼–å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬ã€‚ <a href="http://developer.android.com/reference/android/support/test/espresso/ViewInteraction.html#perform(android.support.test.espresso.ViewAction..." target="_blank" rel="noopener"><code>ViewInteraction.preform()</code></a>) å’Œ <a href="http://developer.android.com/reference/android/support/test/espresso/DataInteraction.html#perform(android.support.test.espresso.ViewAction..." target="_blank" rel="noopener"><code>DataInteraction.perform()</code></a>) æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæˆ–è€…å¤šä¸ª<a href="http://developer.android.com/reference/android/support/test/espresso/ViewAction.html" target="_blank" rel="noopener"><code>ViewAction</code></a> å‚æ•°å¹¶ä¸”æŒ‰ç…§æä¾›çš„é¡ºåºæ‰§è¡Œè¿™äº›<code>actions</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ä¸€ä¸ªEditTextä¸­è¾“å…¥æ–‡æœ¬ä¿¡æ¯ï¼Œç„¶åå…³é—­è½¯é”®ç›˜</span></span><br><span class="line">onView(withId(R.id.editTextUserInput))</span><br><span class="line">    .perform(typeText(STRING_TO_BE_TYPED), closeSoftKeyboard());</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‰ä¸‹æŒ‰é’®æ¥æäº¤æ”¹å˜çš„æ–‡æœ¬</span></span><br><span class="line">onView(withId(R.id.changeTextBt)).perform(click());</span><br></pre></td></tr></table></figure>
<h4 id="UIçº¿ç¨‹åŒæ­¥"><a href="#UIçº¿ç¨‹åŒæ­¥" class="headerlink" title="UIçº¿ç¨‹åŒæ­¥"></a>UIçº¿ç¨‹åŒæ­¥</h4><p>åœ¨Androidè®¾å¤‡ä¸Šæµ‹è¯•å¯èƒ½ç”±äºæ—¶é—´çš„å…³ç³»ä¼šéšæœºæ€§åœ°å¤±è´¥ã€‚è¿™ä¸ªæµ‹è¯•é—®é¢˜ç§°ä¸ºtest flakinessï¼ˆæµ‹è¯•ç‰‡çŠ¶ï¼‰ã€‚åœ¨Espressoä¹‹å‰ï¼Œå˜é€šçš„åŠæ³•æ˜¯åœ¨æµ‹è¯•ä¸­æ’å…¥è¶³å¤Ÿé•¿çš„ç¡çœ æˆ–è€…ä¸€æ®µæ—¶é—´åè¶…æ—¶ï¼Œæˆ–è€…å¢åŠ åœ¨æ“ä½œå¤±è´¥ä¹‹åä¿æŒé‡è¯•çš„ä»£ç ã€‚Espressoæµ‹è¯•æ¡†æ¶ä¼šåœ¨<a href="http://developer.android.com/reference/android/app/Instrumentation.html" target="_blank" rel="noopener"><code>Instrumentation</code></a>å’ŒUIçº¿ç¨‹ä¹‹é—´ä¿æŒåŒæ­¥ï¼›è¿™æ ·å°±å¯ä»¥å»æ‰ä¹‹å‰å› ä¸ºæ—¶é—´é—®é¢˜ä½¿ç”¨çš„å˜é€šçš„æ–¹æ³•ï¼Œå¹¶ä¸”ç¡®ä¿ä½ æµ‹è¯•çš„è¡Œä¸ºå’Œæ–­è¨€è¿è¡Œæ›´åŠ å¯é ã€‚</p>
<p>æ›´å¤šEspressoçš„ç›¸å…³å­¦ä¹ ï¼Œè§ <a href="http://developer.android.com/reference/android/support/test/package-summary.html" target="_blank" rel="noopener">API reference</a> å’Œ <a href="http://developer.android.com/training/testing/ui-testing/espresso-testing.html" target="_blank" rel="noopener">é’ˆå¯¹å•ä¸ªAppçš„UIæµ‹è¯•</a> ç»ƒä¹ ã€‚</p>
<h3 id="UI-Automator"><a href="#UI-Automator" class="headerlink" title="UI Automator"></a>UI Automator</h3><p>UI Automatoræµ‹è¯•æ¡†æ¶æä¾›äº†ä¸€ç³»åˆ—çš„APIæ¥æ„å»ºåœ¨ç”¨æˆ·appå’Œç³»ç»Ÿappä¹‹é—´çš„UIæµ‹è¯•ã€‚UI Automator APIs  å…è®¸ä½ åœ¨æµ‹è¯•è®¾å¤‡ä¸­æ‰§è¡Œä¾‹å¦‚æ‰“å¼€è®¾ç½®èœå•æˆ–è€…launcherç­‰æ“ä½œã€‚<strong>UI Automator æµ‹è¯•æ¡†æ¶éå¸¸é€‚åˆç”¨æ¥å†™é»‘ç›’æµ‹è¯•</strong>ï¼Œå…¶ä¸­æµ‹è¯•ä»£ç çš„ç¼–å†™ä¸éœ€è¦ä¾èµ–äºç›®æ ‡appçš„å†…éƒ¨å®ç°ç»†èŠ‚ã€‚</p>
<p>UI Automatoræµ‹è¯•æ¡†æ¶çš„å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li><p>æ£€æŸ¥layoutå±‚æ¬¡ç»“æ„çš„Viewerã€‚æ›´å¤šä¿¡æ¯ï¼Œè§ <a href="http://developer.android.com/tools/testing-support-library/index.html#uia-viewer" target="_blank" rel="noopener"><code>UI Automator Viewer</code></a>ã€‚</p>
</li>
<li><p>ä¸€ä¸ªç”¨äºåœ¨ç›®æ ‡è®¾å¤‡ä¸Šè·å–çŠ¶æ€ä¿¡æ¯å’Œæ‰§è¡Œæ“ä½œçš„APIã€‚æ›´å¤šä¿¡æ¯ï¼Œè§ <a href="http://developer.android.com/tools/testing-support-library/index.html#uia-device-state" target="_blank" rel="noopener"><code>è®¿é—®è®¾å¤‡çŠ¶æ€</code></a></p>
</li>
<li><p>è·¨appçš„UIæµ‹è¯•APIsã€‚æ›´å¤šä¿¡æ¯ï¼Œè§ <a href="http://developer.android.com/tools/testing-support-library/index.html#uia-apis" target="_blank" rel="noopener"><code>UI automator APIS</code></a></p>
</li>
</ul>
<p>éœ€è¦ Android4.3(API level 18) æˆ–è€…æ›´é«˜ã€‚</p>
<h4 id="UI-Automator-Viewer"><a href="#UI-Automator-Viewer" class="headerlink" title="UI Automator Viewer"></a>UI Automator Viewer</h4><p><code>uiautomatorviewer</code> å·¥å…·æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„GUIæ¥æ‰«æå’Œåˆ†æå½“å‰åœ¨Androidè®¾å¤‡ä¸Šæ˜¾ç¤ºçš„UIç»„ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™äº›å·¥å…·æ¥æ£€æŸ¥layoutå±‚æ¬¡ç»“æ„å’ŒæŸ¥çœ‹åœ¨è®¾å¤‡å‰å°å¯è§çš„ç»„ä»¶çš„å±æ€§ã€‚è¿™ä¸ªä¿¡æ¯å¯ä»¥è®©ä½ ä½¿ç”¨UI Automatoråˆ›å»ºæ›´åŠ ç»†ç²’åº¦çš„æµ‹è¯•ï¼Œæ¯”å¦‚åˆ›å»ºä¸€ä¸ªåŒ¹é…æŒ‡å®šçš„å¯è§æ€§å±æ€§çš„UIé€‰æ‹©å™¨ã€‚</p>
<p><code>uiautomatorviewer</code> å·¥å…·åœ¨ <code>&lt;android-sdk&gt;/tools/</code> ç›®å½•ä¸‹ã€‚</p>
<h4 id="è®¿é—®è®¾å¤‡çŠ¶æ€"><a href="#è®¿é—®è®¾å¤‡çŠ¶æ€" class="headerlink" title="è®¿é—®è®¾å¤‡çŠ¶æ€"></a>è®¿é—®è®¾å¤‡çŠ¶æ€</h4><p>UI Automatoræµ‹è¯•æ¡†æ¶æä¾›äº†ä¸€ä¸ª <a href="http://developer.android.com/reference/android/support/test/uiautomator/UiDevice.html" target="_blank" rel="noopener"><code>UIDevice</code></a> ç±»åœ¨ç›®æ ‡appè¿è¡Œçš„è®¾å¤‡ä¸Šè®¿é—®å’Œæ‰§è¡Œæ“ä½œã€‚ä½ å¯ä»¥è°ƒç”¨å®ƒçš„æ–¹æ³•æ¥è®¿é—®å¦‚å½“å‰çš„è®¾å¤‡å®šå‘æ´»ç€æ˜¾ç¤ºå°ºå¯¸ç­‰è®¾å¤‡å±æ€§ã€‚ <a href="http://developer.android.com/reference/android/support/test/uiautomator/UiDevice.html" target="_blank" rel="noopener"><code>UIDevice</code></a> ç±»ä¹Ÿå¯ä»¥è®©ä½ æ‰§è¡Œä¸€äº›å¦‚ä¸‹çš„è¡Œä¸ºï¼š</p>
<ul>
<li><p>æ—‹è½¬è®¾å¤‡</p>
</li>
<li><p>æŒ‰ä¸‹ <code>D-pad</code> é”®</p>
</li>
<li><p>æŒ‰ä¸‹è¿”å›é”®ã€Homeé”®ã€èœå•é”®</p>
</li>
<li><p>æ‰“å¼€é€šçŸ¥æ </p>
</li>
<li><p>å½“å‰çš„çª—å£æˆªå›¾</p>
</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¨¡æ‹ŸæŒ‰ä¸‹HomeæŒ‰é’®ï¼Œè°ƒç”¨ <code>UiDevice.pressHome()</code> æ–¹æ³•ã€‚</p>
<h4 id="UI-Automator-APIs"><a href="#UI-Automator-APIs" class="headerlink" title="UI Automator APIs"></a>UI Automator APIs</h4><p>UI Automator APIs å…è®¸ä½ åœ¨ä¸éœ€è¦çŸ¥é“ç›®æ ‡appå®ç°ç»†èŠ‚çš„æƒ…å†µä¸‹å»ç¼–å†™å¼ºå¤§çš„æµ‹è¯•ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™äº›APIsæ¥æ•è·å’Œæ“ä½œè·¨è¶Šå¤šä¸ªappçš„UIç»„ä»¶ï¼š</p>
<ul>
<li><p><a href="http://developer.android.com/reference/android/support/test/uiautomator/UiCollection.html" target="_blank" rel="noopener"><code>UiCollection</code></a>ï¼šæšä¸¾å®¹å™¨ä¸­çš„UIå…ƒç´ æ¥è®¡æ•°ï¼Œæˆ–è€…é€šè¿‡å­å…ƒç´ çš„å¯è§textæˆ–<code>content-description</code>å±æ€§æ¥ä½œä¸ºä¸€ä¸ªç›®æ ‡ã€‚</p>
</li>
<li><p><a href="http://developer.android.com/reference/android/support/test/uiautomator/UiObject.html" target="_blank" rel="noopener"><code>UiObject</code></a>ï¼šä»£è¡¨åœ¨è®¾å¤‡ä¸Šä¸€ä¸ªå¯è§çš„UIå…ƒç´ ã€‚</p>
</li>
<li><p><a href="http://developer.android.com/reference/android/support/test/uiautomator/UiScrollable.html" target="_blank" rel="noopener"><code>UiScrollable</code></a>ï¼šå¯¹å¯æ»šåŠ¨çš„UIå®¹å™¨ä¸­æœç´¢UIå…ƒç´ æä¾›æ”¯æŒã€‚</p>
</li>
<li><p><a href="http://developer.android.com/reference/android/support/test/uiautomator/UiSelector.html" target="_blank" rel="noopener"><code>UiSelector</code></a>ï¼šä»£è¡¨ä¸€ä¸ªè®¾å¤‡ä¸Šå¯¹ä¸€ä¸ªæˆ–è€…å¤šä¸ªç›®æ ‡UIå…ƒç´ çš„æŸ¥è¯¢ã€‚</p>
</li>
<li><p><a href="http://developer.android.com/reference/android/support/test/uiautomator/Configurator.html" target="_blank" rel="noopener"><code>Configurator</code></a>ï¼šå…è®¸ä½ è®¾ç½®UI Automatoræµ‹è¯•çš„å…³é”®å‚æ•°ã€‚</p>
</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç å±•ç¤ºäº†æ€ä¹ˆæ ·å»ç¼–å†™ä¸€ä¸ªæµ‹è¯•è„šæœ¬æ¥è·å–é»˜è®¤çš„app launcherï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ– UiDevice å®ä¾‹</span></span><br><span class="line">mDevice = UiDevice.getInstance(getInstrumentation());</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ HOME æŒ‰é’®ä¸Šæ‰§è¡Œä¸€ä¸ªçŸ­æš‚çš„æŒ‰å‹</span></span><br><span class="line">mDevice().pressHome();</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡åŒ¹é…å¯åŠ¨æŒ‰é’®çš„content-descriptionæ¥æœç´¢ä¸€ä¸ªUIç»„ä»¶</span></span><br><span class="line"><span class="comment">// å¾—åˆ°é»˜è®¤çš„launcher</span></span><br><span class="line">UiObject allAppsButton = mDevice</span><br><span class="line">        .findObject(<span class="keyword">new</span> UiSelector().description(<span class="string">"Apps"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨å¾—åˆ°çš„launcher æŒ‰é’®ä¸Šé¢æ‰§è¡Œä¸€ä¸ªç‚¹å‡»</span></span><br><span class="line">allAppsButton.clickAndWaitForNewWindow();</span><br></pre></td></tr></table></figure>
<p>æ›´å¤šUI Automatorç›¸å…³å­¦ä¹ ï¼Œè§ <a href="http://developer.android.com/reference/android/support/test/package-summary.html" target="_blank" rel="noopener">API reference</a> å’Œ <a href="http://developer.android.com/training/testing/ui-testing/uiautomator-testing.html" target="_blank" rel="noopener">å¤šAppçš„UIæµ‹è¯•</a> ç»ƒä¹ ã€‚</p>
<h2 id="Testing-Support-Library-Setup"><a href="#Testing-Support-Library-Setup" class="headerlink" title="Testing Support Library Setup"></a>Testing Support Library Setup</h2><p>Android Testing Support Library packageå·²ç»åŒ…å«åœ¨æœ€æ–°ç‰ˆæœ¬çš„ä½œä¸ºè¡¥å……åº“ã€å¯åœ¨SDK Managerä¸­ä¸‹è½½çš„Android Support Repositoryä¸­ã€‚</p>
<p>é€šè¿‡SDK Managerä¸‹è½½Android Support Repositoryï¼š</p>
<p>1. å¯åŠ¨ <a href="http://developer.android.com/tools/help/sdk-manager.html" target="_blank" rel="noopener">Android SDK Manager</a>ã€‚</p>
<p>2. åœ¨SDK Managerçª—å£ï¼Œæ»šåŠ¨åˆ°Packagesåˆ—è¡¨çš„æœ€åº•éƒ¨ï¼Œæ‰¾åˆ°<code>Extras</code>ç›®å½•ï¼Œå¦‚æœéœ€è¦ï¼ŒæŠŠå®ƒå±•å¼€æ˜¾ç¤ºå®ƒçš„å†…å®¹ã€‚</p>
<p>3. æ‰¾åˆ° <strong>Android Support Repository</strong> é¡¹ã€‚</p>
<p>4. ç‚¹å‡» <strong>Install packagesâ€¦</strong> æŒ‰é’®ã€‚</p>
<p>ä¸‹è½½å®Œä¹‹åï¼Œå·¥å…·æŠŠSupport Repositoryæ–‡ä»¶å®‰è£…åœ¨å­˜åœ¨çš„Android SDKç›®å½•ã€‚åº“æ–‡ä»¶ä¼šè¢«æ”¾ç½®åœ¨ä½ SDKç›®å½•çš„å­ç›®å½•ä¸­ï¼š<code>&lt;sdk&gt;/extras/android/m2respository</code> ç›®å½•ã€‚</p>
<p>Android Testing Support Library ç±»è¢«æ”¾ç½®åœ¨<code>android.support.test</code>åŒ…ä¸‹é¢ã€‚</p>
<p>ä¸ºäº†åœ¨ä½ çš„Gradleé¡¹ç›®ä¸­ä½¿ç”¨Android Testing Support Libraryï¼Œåœ¨ä½ çš„<code>build.gradle</code>æ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹ä¾èµ–ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">  androidTestCompile <span class="string">'com.android.support.test:runner:0.4'</span></span><br><span class="line">  <span class="comment">// Set this dependency to use JUnit 4 rules</span></span><br><span class="line">  androidTestCompile <span class="string">'com.android.support.test:rules:0.4'</span></span><br><span class="line">  <span class="comment">// Set this dependency to build and run Espresso tests</span></span><br><span class="line">  androidTestCompile <span class="string">'com.android.support.test.espresso:espresso-core:2.2.1'</span></span><br><span class="line">  <span class="comment">// Set this dependency to build and run UI Automator tests</span></span><br><span class="line">  androidTestCompile <span class="string">'com.android.support.test.uiautomator:uiautomator-v18:2.1.2'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†åœ¨ä½ çš„Gradleé¡¹ç›®ä¸­é»˜è®¤ä½¿ç”¨<a href="http://developer.android.com/reference/android/support/test/runner/AndroidJUnitRunner.html" target="_blank" rel="noopener">AndroidJUnitRunner</a>ä½œä¸ºé»˜è®¤çš„instrumentation runnerï¼Œåœ¨ä½ çš„<code>build.gradle</code>æ–‡ä»¶ä¸­æŒ‡å®šè¿™ä¸ªä¾èµ–ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        testInstrumentationRunner <span class="string">"android.support.test.runner.AndroidJUnitRunner"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¼ºçƒˆæ¨èä½ ä¸Android Studio IDEä¸€èµ·ä½¿ç”¨Android Testing Support Libraryã€‚Android Studioæä¾›äº†æ”¯æŒæµ‹è¯•å¼€å‘çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li><p>çµæ´»å¹¶åŸºäºGradleæ„å»ºç³»ç»Ÿï¼Œæ”¯æŒå¯¹ä½ æµ‹è¯•ä»£ç çš„ä¾èµ–ç®¡ç†ã€‚</p>
</li>
<li><p>å•å…ƒå’Œinstrumentedæµ‹è¯•ä»£ç ä¸ä½ çš„appçš„æºä»£ç æ”¾ç½®åœ¨å•ä¸ªé¡¹ç›®ç»“æ„ä¸­ã€‚</p>
</li>
<li><p>æ”¯æŒä»å‘½ä»¤è¡Œæˆ–è€…GUIæ¥éƒ¨ç½²å’Œè¿è¡Œä½ çš„æµ‹è¯•åœ¨è™šæ‹Ÿæˆ–è€…ç‰©ç†è®¾å¤‡ä¸­ã€‚</p>
</li>
</ul>
<p>æ›´å¤šAndroid Studioç›¸å…³å’Œä¸‹è½½ï¼Œè§ <a href="http://developer.android.com/sdk/index.html" target="_blank" rel="noopener">ä¸‹è½½Android Studioå’ŒSDK Tools</a>ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> testing </tag>
            
            <tag> android </tag>
            
            <tag> google </tag>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> support </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]å¯¹MVCå’ŒMVPçš„æ€»ç»“]]></title>
      <url>/2015/12/10/Android-%E5%AF%B9MVC%E5%92%8CMVP%E7%9A%84%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>ç»å†è¿‡çš„å®¢æˆ·ç«¯çš„æ¶æ„åˆ†ä¸ºè¿™ä¹ˆå‡ ä¸ªé˜¶æ®µï¼š</p>
<h3 id="ç¬¬ä¸€é˜¶æ®µ"><a href="#ç¬¬ä¸€é˜¶æ®µ" class="headerlink" title="ç¬¬ä¸€é˜¶æ®µ"></a>ç¬¬ä¸€é˜¶æ®µ</h3><p>ä½¿ç”¨ä¼ ç»Ÿçš„MVCï¼Œå…¶ä¸­çš„Viewï¼Œå¯¹åº”çš„æ˜¯å„ç§Layoutå¸ƒå±€æ–‡ä»¶ï¼Œä½†æ˜¯è¿™äº›å¸ƒå±€æ–‡ä»¶ä¸­å¹¶ä¸åƒWebç«¯é‚£æ ·å¼ºå¤§ï¼Œèƒ½åšçš„äº‹æƒ…éå¸¸æœ‰é™ï¼›Controllerå¯¹åº”çš„æ˜¯Activityï¼Œè€ŒActivityä¸­å´åˆå…·æœ‰æ“ä½œUIçš„åŠŸèƒ½ï¼Œæˆ‘ä»¬åœ¨å®é™…çš„é¡¹ç›®ä¸­ä¹Ÿä¼šæœ‰å¾ˆå¤šUIæ“ä½œåœ¨è¿™ä¸€å±‚ï¼Œä¹Ÿåšäº†å¾ˆå¤šViewä¸­åº”è¯¥åšçš„äº‹æƒ…ï¼Œå½“ç„¶Controllerä¸­ä¹ŸåŒ…å«Controlleråº”è¯¥åšçš„äº‹æƒ…ï¼Œæ¯”å¦‚å„ç§äº‹ä»¶çš„æ´¾å‘å›è°ƒï¼Œè€Œä¸”åœ¨ä¸€å±‚ä¸­æˆ‘ä»¬ä¼šæ ¹æ®äº‹ä»¶å†å»è°ƒç”¨Modelå±‚æ“ä½œæ•°æ®ï¼Œæ‰€ä»¥è¿™ç§MVCçš„æ–¹å¼åœ¨å®é™…é¡¹ç›®ä¸­ï¼ŒActivityæ‰€åœ¨çš„Controlleræ˜¯éå¸¸é‡çš„ï¼Œå„å±‚æ¬¡ä¹‹é—´çš„è€¦åˆæƒ…å†µä¹Ÿæ¯”è¾ƒä¸¥é‡ï¼Œä¸æ–¹ä¾¿å•å…ƒæµ‹è¯•ã€‚</p>
<h3 id="ç¬¬äºŒé˜¶æ®µ"><a href="#ç¬¬äºŒé˜¶æ®µ" class="headerlink" title="ç¬¬äºŒé˜¶æ®µ"></a>ç¬¬äºŒé˜¶æ®µ</h3><p>ä½¿ç”¨MVCçš„è¿›åŒ–ç‰ˆâ€”â€”MVPï¼ŒMVPä¸­æŠŠLayoutå¸ƒå±€å’ŒActivityä½œä¸ºViewå±‚ï¼Œå¢åŠ äº†Presenterï¼ŒPresenterå±‚ä¸Modelå±‚è¿›è¡Œä¸šåŠ¡çš„äº¤äº’ï¼Œå®Œæˆåå†ä¸Viewå±‚äº¤äº’ï¼ˆä¹Ÿå°±æ˜¯Activityï¼‰è¿›è¡Œå›è°ƒæ¥åˆ·æ–°UIã€‚è¿™æ ·ä¸€æ¥ï¼Œæ‰€æœ‰ä¸šåŠ¡é€»è¾‘çš„å·¥ä½œéƒ½äº¤ç»™äº†Presenterä¸­è¿›è¡Œï¼Œä½¿å¾—Viewå±‚ä¸Modelå±‚çš„è€¦åˆåº¦é™ä½ï¼ŒActivityä¸­çš„å·¥ä½œä¹Ÿè¿›è¡Œäº†ç®€åŒ–ã€‚ä½†æ˜¯åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œéšç€é€»è¾‘çš„å¤æ‚åº¦è¶Šæ¥è¶Šå¤§ï¼ŒActivityè‡ƒè‚¿çš„ç¼ºç‚¹ä»ç„¶ä½“ç°å‡ºæ¥äº†ï¼Œå› ä¸ºActivityä¸­è¿˜æ˜¯å……æ»¡äº†å¤§é‡ä¸Viewå±‚æ— å…³çš„ä»£ç ï¼Œæ¯”å¦‚å„ç§äº‹ä»¶çš„å¤„ç†æ´¾å‘ï¼Œå°±å¦‚MVCä¸­çš„é‚£æ ·Viewå±‚å’ŒControllerä»£ç è€¦åˆåœ¨ä¸€èµ·æ— æ³•è‡ªæ‹”ã€‚</p>
<h3 id="ç¬¬ä¸‰é˜¶æ®µ"><a href="#ç¬¬ä¸‰é˜¶æ®µ" class="headerlink" title="ç¬¬ä¸‰é˜¶æ®µ"></a>ç¬¬ä¸‰é˜¶æ®µ</h3><p>ä¹Ÿæ˜¯ç°åœ¨æ­£åœ¨ä½¿ç”¨çš„æ¶æ„ï¼Œé’ˆå¯¹ç¬¬äºŒé˜¶æ®µè¿›è¡Œä¼˜åŒ–ï¼Œä¸ºäº†æŠŠViewå†æ¬¡ç®€åŒ–ï¼Œæƒ³åˆ°ä¸¤ç§æ–¹å¼ï¼š</p>
<p>1. é€šè¿‡ä½¿ç”¨ä¸€ä¸ªPresenterä»£ç†çš„æ–¹å¼ï¼Œåœ¨PresenterProxyä¸­å¤„ç†å„ç§äº‹ä»¶æœºåˆ¶ï¼ŒViewä¸­ç»´æŠ¤ä¸€ä¸ªPresenterProxyå¯¹è±¡å½“ç„¶Presenterä¸­åŒæ ·å®ç°äº†çœŸå®å¯¹è±¡Presnteræ‰€å®ç°çš„æ¥å£ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬åŒæ ·åœ¨Viewä¸­é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨çœŸå®å¯¹è±¡çš„ä»£ç ï¼Œç»“æ„å›¾å¦‚ä¸‹ï¼š<br><img src="https://raw.githubusercontent.com/wangjiegulu/wangjiegulu.github.com/master/images/mvp/MVP_PresenterProxy.jpg" alt=""></p>
<p>2. ä¸ºMVPå¢åŠ ä¸€å±‚ä¸“é—¨ç”¨äºå¤„ç†å„ç§çš„äº‹ä»¶æ´¾å‘Controllerå±‚ï¼ŒControllerçš„ä½œç”¨ä»…ä»…æ˜¯å¤„ç†äº‹ä»¶å¹¶æ ¹æ®äº‹ä»¶é€šè¿‡ç»´æŠ¤çš„Presenterå¯¹è±¡æ´¾å‘åˆ°å¯¹åº”çš„ä¸šåŠ¡ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´Viewå±‚åªæœ‰ä¸€ä¸ªControllerçš„å¯¹è±¡ï¼ŒViewå±‚ä¸ä¼šä¸»åŠ¨å»è°ƒç”¨Presenterå±‚ï¼Œä½†æ˜¯Controllerå±‚å’ŒPresenteréƒ½å¯èƒ½ä¼šå›è°ƒåˆ°Viewå±‚æ¥åˆ·æ–°UIï¼Œæ‰€ä»¥å±‚æ¬¡ç»“æ„å°±å˜æˆäº†å¦‚ä¸‹ï¼š<br><img src="https://raw.githubusercontent.com/wangjiegulu/wangjiegulu.github.com/master/images/mvp/MVP_Controller.jpg" alt=""></p>
<p>ç°åœ¨ä½¿ç”¨çš„æ˜¯ç¬¬2ç§æ–¹å¼ï¼Œä½¿ç”¨Controlleræ¥è¿›è¡Œå¯¹Activityä¸­äº‹ä»¶ä»£ç çš„åˆ†ç¦»ï¼Œä¸‹é¢ä½¿ç”¨ç™»å½•çš„ä¾‹å­æ¥è®²è§£ï¼Œå…¶ä¸­ä»£ç ä½¿ç”¨çš„å¹¶ä¸æ˜¯Javaï¼Œè€Œæ˜¯Kotlinã€‚</p>
<p>åœ¨æ¼”ç¤ºä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸‹å®ç°MVPçš„å‡ ä¸ªåŸºç¡€çš„æ¥å£å’Œç±»ï¼ˆ<a href="https://github.com/wangjiegulu/AndroidKotlinBucket/blob/master/library/src/main/kotlin/com/wangjie/androidkotlinbucket/library/AKBMVPExt.kt" target="_blank" rel="noopener">ç‚¹è¿™é‡ŒæŸ¥çœ‹AKBMVPExt.kt</a>ï¼‰ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * MVPçš„Viewå±‚ï¼ŒUIç›¸å…³ï¼ŒActivityéœ€è¦å®ç°è¯¥interface</span></span><br><span class="line"><span class="comment"> * å®ƒä¼šåŒ…å«ä¸€ä¸ªPresenterçš„å¼•ç”¨ï¼Œå½“æœ‰äº‹ä»¶å‘ç”Ÿï¼ˆæ¯”å¦‚æŒ‰é’®ç‚¹å‡»åï¼‰ï¼Œä¼šè°ƒç”¨Presenterå±‚çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">KViewer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//    val onClickListener: ((view: View) -&gt; Unit)?</span></span><br><span class="line">    <span class="keyword">val</span> context: Context?;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">toast</span><span class="params">(message: <span class="type">String</span>, duration: <span class="type">Int</span> = Toast.LENGTH_SHORT)</span></span> &#123;</span><br><span class="line">        context?.lets &#123; Toast.makeText(<span class="keyword">this</span>, message, duration).show() &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">dialog</span><span class="params">(title: <span class="type">String</span>? = <span class="literal">null</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">               message: <span class="type">String</span>?,</span></span></span><br><span class="line"><span class="function"><span class="params">               okText: <span class="type">String</span>? = <span class="string">"OK"</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">               cancelText: <span class="type">String</span>? = <span class="literal">null</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">               positiveClickListener: ((<span class="type">DialogInterface</span>, <span class="built_in">Int</span>)</span></span> -&gt; <span class="built_in">Unit</span>)? = <span class="literal">null</span>,</span><br><span class="line">               negativeClickListener: ((DialogInterface, <span class="built_in">Int</span>) -&gt; <span class="built_in">Unit</span>)? = <span class="literal">null</span></span><br><span class="line">    ) &#123;</span><br><span class="line">        context?.lets &#123;</span><br><span class="line">            AlertDialog.Builder(<span class="keyword">this</span>)</span><br><span class="line">                    .setTitle(title)</span><br><span class="line">                    .setMessage(message)</span><br><span class="line">                    .setPositiveButton(okText, positiveClickListener)</span><br><span class="line">                    .setNegativeButton(cancelText, negativeClickListener)</span><br><span class="line">                    .show()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">showLoading</span><span class="params">(message: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        Log.w(KViewer::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>.<span class="title">simpleName</span>, <span class="type">"loadingDialog should impl by subclass")</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">cancelLoading</span><span class="params">()</span></span> &#123;</span><br><span class="line">        Log.w(KViewer::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>.<span class="title">simpleName</span>, <span class="type">"cancelLoadingDialog should impl by subclass")</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T : View&gt;</span> <span class="title">findView</span><span class="params">(resId: <span class="type">Int</span>)</span></span>: T;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€æœ‰<code>View</code>å±‚çš„Activityã€Fragmentæˆ–è€…Viewéƒ½è¦å®ç°<code>KViewer</code>æ¥å£ï¼Œè¯¥æ¥å£ä¸­æœ‰ä¸€ä¸ªå±æ€§å’Œä¸€ä¸ªå‡½æ•°éœ€è¦è¢«å­ç±»çš„Activityå®ç°ï¼š</p>
<ul>
<li><p><code>context</code>å±æ€§ï¼šè¯¥å±æ€§éœ€è¦è¢«å­ç±»overrideï¼Œè¯¥å±æ€§ç”¨äºä¸€äº›æ¥å£å…¬ç”¨çš„UIç›¸å…³æ“ä½œçš„æ–¹æ³•ï¼Œå¦‚<code>toast</code>ã€<code>dialog</code>ã€<code>cancelDialog</code>ç­‰ã€‚</p>
</li>
<li><p><code>fun &lt;T : View&gt; findView(resId: Int): T</code>å‡½æ•°ï¼šè¯¥å‡½æ•°éœ€è¦è¢«å­ç±»Activityã€Fragmentæˆ–è€…Viewå®ç°ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºä»å½“å‰Viewå±‚ä¸­æ ¹æ®idè·å–åˆ°å¯¹åº”çš„Viewï¼Œè¯¥æ–¹æ³•åœ¨Activityã€Fragmentæˆ–è€…Viewä¸­å¹¶ä¸ä¸€è‡´ã€‚</p>
</li>
</ul>
<p>å½“ç„¶æ‰€æœ‰çš„é‡å†™éƒ½å¯ä»¥åœ¨BaseActivityã€BaseFragmentã€BaseFrameLayoutç­‰ä¸­é‡å†™ï¼Œä¹‹åä½¿ç”¨å®ƒä»¬çš„å­ç±»å³å¯ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * MVPçš„Presenterå±‚ï¼Œä½œä¸ºæ²Ÿé€šViewå’ŒModelçš„æ¡¥æ¢ï¼Œå®ƒä»Modelå±‚æ£€ç´¢æ•°æ®åï¼Œè¿”å›ç»™Viewå±‚ï¼Œå®ƒä¹Ÿå¯ä»¥å†³å®šä¸Viewå±‚çš„äº¤äº’æ“ä½œã€‚</span></span><br><span class="line"><span class="comment"> * å®ƒåŒ…å«ä¸€ä¸ªViewå±‚çš„å¼•ç”¨å’Œä¸€ä¸ªModelå±‚çš„å¼•ç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">KPresenter</span>&lt;<span class="type">V : KViewer</span>&gt;</span>(<span class="keyword">var</span> viewer: V) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">open</span> <span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="title">closeAll</span><span class="params">()</span></span> &#123;</span><br><span class="line">        Log.w(KViewer::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>.<span class="title">simpleName</span>, <span class="type">"closeAll in KPresenter should impl by subclass")</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>KPresenter</code>ç±»æ˜¯ä½œä¸ºæ‰€æœ‰Presenterå±‚çš„å®ç°çš„åŸºç±»çš„ï¼Œå®ƒåªæœ‰ä¸€ä¸ª<code>closeAll</code>å‡½æ•°éœ€è¦è¢«é‡å†™ï¼Œå½“Activityåœ¨è¢«destoryæ—¶ï¼Œéœ€è¦è°ƒç”¨closeå‡½æ•°åœæ­¢åˆ°å­çº¿ç¨‹çš„ä»»åŠ¡ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Controllerï¼Œç”¨äºæ´¾å‘Viewä¸­çš„äº‹ä»¶ï¼Œå®ƒåœ¨æ ¹æ®ä¸åŒçš„äº‹ä»¶è°ƒç”¨Presenter</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">KController</span>&lt;<span class="type">KV : KViewer, KP : KPresenter&lt;*</span>&gt;&gt;</span>(<span class="keyword">val</span> viewer: KV, presenterCreate: () -&gt; KP) &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">val</span> presenter: KP <span class="keyword">by</span> lazy &#123; presenterCreate() &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> viewCache: SparseArray&lt;View&gt; = SparseArray();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ³¨å†Œäº‹ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">bindEvents</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T : View&gt;</span> <span class="title">getView</span><span class="params">(resId: <span class="type">Int</span>)</span></span>: T &#123;</span><br><span class="line">        <span class="keyword">val</span> view: View? = viewCache.<span class="keyword">get</span>(resId)</span><br><span class="line">        <span class="keyword">return</span> view <span class="keyword">as</span> T? ?: viewer.findView&lt;T&gt;(resId).apply &#123;</span><br><span class="line">            viewCache.put(resId, <span class="keyword">this</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="title">closeAll</span><span class="params">()</span></span> = presenter.closeAll()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åŒæ ·<code>KController</code>æ˜¯æ‰€æœ‰<code>Controller</code>ç±»çš„åŸºç±»ï¼Œéœ€è¦å­ç±»å®ç°<code>bindEvents()</code>å‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œå¯ä»¥ç»‘å®šå„ç§Viewçš„äº‹ä»¶ã€‚è¿˜æä¾›äº†<code>getView()</code>æ–¹æ³•æ¥ä»Viewerä¸­è·å–åˆ°å¯¹åº”çš„æ§ä»¶ï¼Œå¹¶ä¸”ä¼šç¼“å­˜æ‰¾åˆ°çš„æ§ä»¶ã€‚</p>
<h4 id="ä¸€ã€åˆ›å»ºBaseActivityå¹¶å®ç°KViewer"><a href="#ä¸€ã€åˆ›å»ºBaseActivityå¹¶å®ç°KViewer" class="headerlink" title="ä¸€ã€åˆ›å»ºBaseActivityå¹¶å®ç°KViewer"></a>ä¸€ã€åˆ›å»º<code>BaseActivity</code>å¹¶å®ç°<code>KViewer</code></h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseActivity</span> : <span class="type">AppCompatActivity</span></span>(), KViewer &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T : View&gt;</span> <span class="title">findView</span><span class="params">(resId: <span class="type">Int</span>)</span></span>: T = findViewById(resId) <span class="keyword">as</span> T</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">val</span> context: Context = <span class="keyword">this</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">open</span> <span class="keyword">val</span> controller: KController&lt;*, *&gt;? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> loadingDialog: ProgressDialog <span class="keyword">by</span> lazy &#123; ProgressDialog(<span class="keyword">this</span>) &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        <span class="comment">// å¼ºåˆ¶ç«–å±</span></span><br><span class="line">        requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">showLoading</span><span class="params">(message: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        loadingDialog.setMessage(message)</span><br><span class="line">        loadingDialog.show()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">cancelLoading</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (loadingDialog.isShowing) &#123;</span><br><span class="line">            loadingDialog.cancel()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDestroy</span><span class="params">()</span></span> &#123;</span><br><span class="line">        controller?.closeAll()</span><br><span class="line">        <span class="keyword">super</span>.onDestroy()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘é‡å†™äº†<code>KViewer</code>ä¸­çš„<code>findView()</code>å‡½æ•°ï¼Œå‡½æ•°å®ç°æ˜¯é€šè¿‡<code>Activity::findViewById()</code>çš„æ–¹å¼ã€‚</p>
<p>åˆå®ç°äº†<code>controller</code>å±æ€§ï¼Œè®¾ç½®ä¸ºnullï¼Œè¿™ä¸ª<code>controller</code>è¿˜éœ€è¦å­ç±»å†æ¥é‡å†™ã€‚</p>
<p>ç„¶åé‡å†™äº†<code>showLoading</code>å’Œ<code>cancelLoading</code>ï¼Œåœ¨<code>onDestory</code>ä¸­é€šè¿‡<code>controller</code>è°ƒç”¨<code>presenter</code>ä¸­çš„<code>closeAll</code>å‡½æ•°ã€‚</p>
<h4 id="äºŒã€å®ç°LoginActivity"><a href="#äºŒã€å®ç°LoginActivity" class="headerlink" title="äºŒã€å®ç°LoginActivity"></a>äºŒã€å®ç°<code>LoginActivity</code></h4><p>æ–°å»º<code>LoginViewer</code>æ¥å£ï¼Œç»§æ‰¿<code>KViewer</code>ï¼Œå¹¶å®šä¹‰å„ç§é€»è¾‘å›è°ƒï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">LoginViewer</span> : <span class="type">KViewer &#123;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onLogin</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‡Œé¢æ‰€æœ‰çš„å‡½æ•°åº”è¯¥éƒ½æ˜¯åå­—<code>onXXX</code>çš„å‡½æ•°ï¼Œéƒ½æ˜¯éœ€è¦å»æ“ä½œUIçš„ï¼Œè¿™é‡Œå®šä¹‰çš„æ˜¯ä¸€ä¸ª<code>onLogin()</code>å‡½æ•°ï¼Œè¡¨ç¤ºç™»å½•æˆåŠŸåï¼Œæˆ‘ä»¬ç°åœ¨æ˜¯å¦‚æœç™»å½•æˆåŠŸåï¼Œåˆ™è·³è½¬åˆ°ä¸»ç•Œé¢<code>MainActivity</code>ã€‚</p>
<p>ç„¶ååˆ›å»º<code>LoginActivity</code>ï¼Œå®ç°æˆ‘ä»¬çš„<code>LoginViewer</code>ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginActivity</span> : <span class="type">BaseActivity</span></span>(), LoginViewer &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">val</span> controller: LoginController <span class="keyword">by</span> lazy &#123; LoginController(<span class="keyword">this</span>) &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_login)</span><br><span class="line"></span><br><span class="line">        controller.bindEvents()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onLogin</span><span class="params">()</span></span> &#123;</span><br><span class="line">        toActivity&lt;MainActivity&gt; &#123; &#125;</span><br><span class="line">        finish()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬é¦–å…ˆé‡å†™çˆ¶ç±»ä¸­çš„<code>controller</code>å±æ€§ï¼Œé€šè¿‡<code>lazy</code>æ‡’åˆå§‹åŒ–<code>LoginController</code>ï¼Œç„¶ååœ¨<code>onCreate</code>ä¸­è°ƒç”¨<code>controller</code>çš„<code>bindEvents()</code>ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬åœ¨<code>controller</code>ä¸­çš„<code>bindEvents()</code>å‡½æ•°ä¸­å°±å¯ä»¥å¯¹å„ç§Viewè¿›è¡Œäº‹ä»¶çš„ç»‘å®šï¼Œç”šè‡³åŒ…æ‹¬è‡ªå®šä¹‰çš„Dialogã€PopupWindowç­‰ç»„ä»¶çš„å›è°ƒã€‚</p>
<p>ç„¶åå®ç°<code>onLogin</code>å‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­è¿›è¡Œç•Œé¢çš„è·³è½¬ã€‚</p>
<h4 id="ä¸‰ã€å®ç°LoginController"><a href="#ä¸‰ã€å®ç°LoginController" class="headerlink" title="ä¸‰ã€å®ç°LoginController"></a>ä¸‰ã€å®ç°LoginController</h4><p>åˆ›å»º<code>LoginController</code>ï¼Œç»§æ‰¿<code>KController</code>ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginController</span></span>(viewer: LoginViewer) : KController&lt;LoginViewer, LoginPresenter&gt;(viewer, &#123; LoginPresenter(viewer) &#125;),</span><br><span class="line">        View.OnClickListener &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">bindEvents</span><span class="params">()</span></span> &#123;</span><br><span class="line">        getView&lt;Button&gt;(R.id.activity_login_submit_btn).setOnClickListener(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(v: <span class="type">View</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">when</span> (v?.id) &#123;</span><br><span class="line">            R.id.activity_login_submit_btn -&gt; presenter.login(getView&lt;EditText&gt;(R.id.activity_login_username_et).text.toString(), getView&lt;EditText&gt;(R.id.activity_login_password_et).text.toString())</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ç°<code>KController</code>ä¸­çš„<code>bindEvents</code>å‡½æ•°ï¼Œåœ¨<code>bindEvents</code>ä¸­æˆ‘ä»¬é€šè¿‡<code>KController</code>ä¸­<code>getView()</code>å‡½æ•°è·å–åˆ°Idä¸º<code>R.id.activity_login_submit_btn</code>çš„æŒ‰é’®ï¼Œç„¶åè®¾ç½®<code>OnClickListener</code>ï¼Œåœ¨onClickå›è°ƒæ–¹æ³•ä¸­ï¼Œ<code>Controller</code>ä¼šæ ¹æ®äº‹ä»¶æ´¾å‘åˆ°<code>Presenter</code>æ¥è¿›è¡ŒçœŸæ­£çš„ç™»å½•æ“ä½œã€‚</p>
<h4 id="å››ã€å®ç°Presenter"><a href="#å››ã€å®ç°Presenter" class="headerlink" title="å››ã€å®ç°Presenter"></a>å››ã€å®ç°Presenter</h4><p>åˆ›å»º<code>Presenter</code>ï¼Œç»§æ‰¿<code>KPresenter</code>ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoginPresenter</span></span>(viewer: LoginViewer) : KPresenter&lt;LoginViewer&gt;(viewer) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">login</span><span class="params">(username: <span class="type">String</span>, password: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        viewer.showLoading(_resString(R.string.xr_hint_logging_in))</span><br><span class="line"></span><br><span class="line">        HttpsUrl(HttpWebApi.System.LOGIN).rxRequest &#123;</span><br><span class="line">            it.posts(</span><br><span class="line">                    <span class="string">"username"</span> to username,</span><br><span class="line">                    <span class="string">"password"</span> to password</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">                .map &#123;</span><br><span class="line">                    _gson._fromJson&lt;LoginHttpResponse&gt;(it.body().string()) </span><br><span class="line">                &#125;</span><br><span class="line">                .observeOnMain()</span><br><span class="line">                .doOnNextOrError &#123; viewer.cancelLoading() &#125;</span><br><span class="line">                .subscribe (&#123;</span><br><span class="line">                    <span class="keyword">if</span> (it.success) &#123;</span><br><span class="line">                        viewer.onLogin()</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        showHint(it.msg)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    Log.e(<span class="string">"Login"</span>, <span class="string">""</span>, it)</span><br><span class="line">                    viewer.toast(_resString(R.string.xr_error_default))</span><br><span class="line">                &#125;</span><br><span class="line">                .bindPresenter(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–å†™<code>login()</code>å‡½æ•°ï¼Œç„¶åæ‰§è¡Œç™»å½•è¯·æ±‚ï¼Œç™»å½•æˆåŠŸåï¼Œé€šè¿‡<code>viewer</code>å›è°ƒåˆ°<code>View</code>å±‚çš„<code>onLogin()</code>å‡½æ•°ã€‚</p>
<p>å¦‚æ­¤ä¸€æ¥ï¼Œ<code>View</code>å±‚ä¸­åªè´Ÿè´£UIéƒ¨åˆ†çš„å·¥ä½œï¼ŒUIæ‰€äº§ç”Ÿçš„å„ç§äº‹ä»¶ç»‘å®šã€æ´¾å‘ç­‰èŒè´£æ”¾åœ¨<code>Controller</code>ä¸­ï¼Œ<code>Presenter</code>å’Œ<code>Model</code>è¿˜æ˜¯ä¸ä¹‹å‰ä¸€æ ·çš„èŒè´£ã€‚</p>
<p>å…³äº<code>Presenter</code>çš„æµ‹è¯•ï¼Œåªéœ€mockä¸€ä¸ª<code>LoginViewer</code>å®ç°ç±»å³å¯ã€‚</p>
<h3 id="ç¬¬å››é˜¶æ®µï¼š"><a href="#ç¬¬å››é˜¶æ®µï¼š" class="headerlink" title="ç¬¬å››é˜¶æ®µï¼š"></a>ç¬¬å››é˜¶æ®µï¼š</h3><p>MVVMï¼ŒæŠŠ<code>Presenter</code>æ”¹æˆ<code>ViewModel</code>ï¼Œå®ƒä¸<code>View</code>ä¹‹é—´çš„äº¤äº’å¯ä»¥ä½¿ç”¨<code>Data Binding</code>çš„æ–¹å¼åŒå‘è¿›è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´<code>View</code>å’Œ<code>ViewModel</code>ä»»æ„ä¸€æ–¹çš„æ”¹å˜éƒ½ä¼šä½“ç°åœ¨å¦ä¸€æ–¹ä¸­ï¼ŒGoogle IOä¸Šæä¾›çš„æ¡†æ¶æš‚æ—¶è¿˜ä¸æˆç†Ÿï¼Œåªæ”¯æŒå•å‘ï¼Œæ‰€ä»¥æš‚æ—¶è¿˜æ²¡æœ‰åœ¨æ­£å¼çš„é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</p>
<p>å®è´¨ä¸ŠMV*çš„æ€æƒ³éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè§£è€¦éš”ç¦»è§†å›¾ï¼ˆViewï¼‰å’Œæ¨¡å‹ï¼ˆModelï¼‰ï¼Œåœ¨å®é™…çš„åº”ç”¨ä¸­ä¸éœ€è¦ç»™<code>MVC</code>ã€<code>MVP</code>å’Œ<code>MVVM</code>ä¸€ä¸ªæ˜ç¡®çš„ç•Œé™ï¼Œç”šè‡³å¯ä»¥æŠŠå‡ è€…èåˆåœ¨ä¸€èµ·ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> best practices </tag>
            
            <tag> mvp </tag>
            
            <tag> mvc </tag>
            
            <tag> framework </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä»Launcherå¼€å§‹å¯åŠ¨Appæµç¨‹æºç åˆ†æ]]></title>
      <url>/2015/12/03/Android-%E4%BB%8ELauncher%E5%BC%80%E5%A7%8B%E5%90%AF%E5%8A%A8App%E6%B5%81%E7%A8%8B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</url>
      <content type="html"><![CDATA[<h2 id="ä»Launcherå¼€å§‹å¯åŠ¨Appæµç¨‹æºç åˆ†æ"><a href="#ä»Launcherå¼€å§‹å¯åŠ¨Appæµç¨‹æºç åˆ†æ" class="headerlink" title="ä»Launcherå¼€å§‹å¯åŠ¨Appæµç¨‹æºç åˆ†æ"></a>ä»Launcherå¼€å§‹å¯åŠ¨Appæµç¨‹æºç åˆ†æ</h2><p><code>com.android.launcher.Launcher</code>å°±æ˜¯æˆ‘ä»¬çš„Launcheré¡µé¢äº†ï¼Œå¯ä»¥çœ‹åˆ°Launcherå…¶å®ä¹Ÿæ˜¯ä¸€ä¸ª<code>Activity</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Launcher</span> <span class="keyword">extends</span> <span class="title">Activity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span>, <span class="title">OnLongClickListener</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ—¢ç„¶æ˜¯<code>Activity</code>ï¼Œé‚£å½“ç„¶ä¹Ÿä¼šæœ‰<code>onCreate</code>ã€<code>onResume</code>ç­‰ç”Ÿå‘½å‘¨æœŸäº†ï¼ŒæŒ‰ç…§é€»è¾‘ï¼Œåº”è¯¥ä¼šå»åŠ è½½æ‰€æœ‰Appï¼Œä»¥ç½‘æ ¼çš„å¸ƒå±€æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œæœç„¶ï¼Œåœ¨<code>onResume</code>çœ‹åˆ°äº†è¿™ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onResume();</span><br><span class="line">    <span class="keyword">if</span> (mRestoring) &#123;</span><br><span class="line">        startLoaders();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹æ–¹æ³•åå°±å¯ä»¥çŒœåˆ°è¿™ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æ¥åŠ è½½æ‰€æœ‰Appä¿¡æ¯çš„ï¼Œè¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startLoaders</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">boolean</span> loadApplications = sModel.loadApplications(<span class="keyword">true</span>, <span class="keyword">this</span>, mLocaleChanged);</span><br><span class="line">	sModel.loadUserItems(!mLocaleChanged, <span class="keyword">this</span>, mLocaleChanged, loadApplications);</span><br><span class="line">	mRestoring = <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè°ƒç”¨<code>sModel</code>ï¼ˆ<code>LauncherModel</code>ç±»å‹ï¼‰çš„<code>loadUserItems</code>æ–¹æ³•å»åŠ è½½æ•°æ®äº†ï¼Œ<code>sModel</code>æ˜æ˜¾å±äº<code>Model</code>å±‚ï¼Œè¿›å…¥<code>loadUserItems</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loadUserItems</span><span class="params">(<span class="keyword">boolean</span> isLaunching, Launcher launcher, <span class="keyword">boolean</span> localeChanged,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">boolean</span> loadApplications)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">		mDesktopItemsLoaded = <span class="keyword">false</span>;</span><br><span class="line">        mDesktopItemsLoader = <span class="keyword">new</span> DesktopItemsLoader(launcher, localeChanged, loadApplications,</span><br><span class="line">                isLaunching);</span><br><span class="line">        mDesktopLoaderThread = <span class="keyword">new</span> Thread(mDesktopItemsLoader, <span class="string">"Desktop Items Loader"</span>);</span><br><span class="line">        mDesktopLoaderThread.start();</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åä½¿ç”¨<code>DesktopItemsLoader</code>åœ¨<code>mDesktopLoaderThread</code>çº¿ç¨‹ä¸­åŠ è½½ï¼Œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">DesktopItemsLoader</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		<span class="keyword">final</span> Cursor c = contentResolver.query(LauncherSettings.Favorites.CONTENT_URI, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> idIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites._ID);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> intentIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.INTENT);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> titleIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.TITLE);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> iconTypeIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_TYPE);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> iconIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> iconPackageIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_PACKAGE);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> iconResourceIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ICON_RESOURCE);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> containerIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CONTAINER);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> itemTypeIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.ITEM_TYPE);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> appWidgetIdIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.APPWIDGET_ID);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> screenIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.SCREEN);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> cellXIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLX);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> cellYIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.CELLY);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> spanXIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.SPANX);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> spanYIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.SPANY);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> uriIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.URI);</span><br><span class="line">		<span class="keyword">final</span> <span class="keyword">int</span> displayModeIndex = c.getColumnIndexOrThrow(LauncherSettings.Favorites.DISPLAY_MODE);</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		<span class="comment">// é€šè¿‡launcherå›è°ƒè¿”å›æ•°æ®</span></span><br><span class="line">		launcher.onDesktopItemsLoaded(uiDesktopItems, uiDesktopWidgets);</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬å›åˆ°<code>Launcher</code>çš„<code>onDesktopItemsLoaded</code>æ–¹æ³•ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">onDesktopItemsLoaded</span><span class="params">(ArrayList&lt;ItemInfo&gt; shortcuts, ArrayList&lt;LauncherAppWidgetInfo&gt; appWidgets)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	bindDesktopItems(shortcuts, appWidgets);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç»§ç»­è¿›å…¥<code>bindDesktopItems</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">bindDesktopItems</span><span class="params">(ArrayList&lt;ItemInfo&gt; shortcuts, ArrayList&lt;LauncherAppWidgetInfo&gt; appWidgets)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	mBinder = <span class="keyword">new</span> DesktopBinder(<span class="keyword">this</span>, shortcuts, appWidgets, drawerAdapter);</span><br><span class="line">    mBinder.startBindingItems();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥<code>startBindingItems</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startBindingItems</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	obtainMessage(MESSAGE_BIND_ITEMS, <span class="number">0</span>, mShortcuts.size()).sendToTarget();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä½¿ç”¨äº†<code>Handler</code>å‘é€æ¶ˆæ¯ï¼Œè¿›å…¥<code>Handler</code>çš„<code>handleMessage</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">switch</span> (msg.what) &#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		<span class="keyword">case</span> MESSAGE_BIND_ITEMS: &#123;</span><br><span class="line">			launcher.bindItems(<span class="keyword">this</span>, mShortcuts, msg.arg1, msg.arg2);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹åè°ƒç”¨<code>bindItems</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">bindItems</span><span class="params">(Launcher.DesktopBinder binder, ArrayList&lt;ItemInfo&gt; shortcuts, <span class="keyword">int</span> start, <span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">case</span> LauncherSettings.Favorites.ITEM_TYPE_APPLICATION:</span><br><span class="line">	<span class="keyword">case</span> LauncherSettings.Favorites.ITEM_TYPE_SHORTCUT:</span><br><span class="line">		<span class="keyword">final</span> View shortcut = createShortcut((ApplicationInfo) item);</span><br><span class="line">		workspace.addInScreen(shortcut, item.screen, item.cellX, item.cellY, <span class="number">1</span>, <span class="number">1</span>, !desktopLocked);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬åªè€ƒè™‘appæˆ–è€…appå¿«æ·æ–¹å¼çš„æƒ…å†µï¼Œæ–‡ä»¶å¤¹å’Œwidgetsæš‚æ—¶ä¸è€ƒè™‘ã€‚appæˆ–è€…appå¿«æ·æ–¹å¼å®è´¨ä¸Šéƒ½æ˜¯è¿›å…¥äº†è¿™ä¸ªé€»è¾‘ä¸­ï¼Œè°ƒç”¨<code>createShortcut</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é‡è½½æ–¹æ³•ï¼Œæœ€ç»ˆéƒ½ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="function">View <span class="title">createShortcut</span><span class="params">(<span class="keyword">int</span> layoutResId, ViewGroup parent, ApplicationInfo info)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	TextView favorite = (TextView) mInflater.inflate(layoutResId, parent, <span class="keyword">false</span>);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	favorite.setCompoundDrawablesWithIntrinsicBounds(<span class="keyword">null</span>, info.icon, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">	favorite.setText(info.title);</span><br><span class="line">	favorite.setTag(info);</span><br><span class="line">	favorite.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé¦–å…ˆinflaterå‡ºitemçš„å¸ƒå±€ï¼Œç„¶åè®¾ç½®<code>text</code>å’Œ<code>OnClickListener</code>ï¼Œè¿˜æœ‰tagï¼Œè¿™ä¸ªtagæ˜¯<code>ApplicationInfo</code>ï¼Œé‡Œé¢åŒ…å«äº†å„ç§Appä¿¡æ¯ï¼Œæ˜¯ä»Appçš„<code>AndroidManifest.xml</code>çš„<code>&lt;application&gt;</code>æ ‡ç­¾ä¸­è§£æå‡ºæ¥çš„ã€‚æ—¢ç„¶è®¾ç½®äº†ç‚¹å‡»äº‹ä»¶ï¼Œæ˜¾ç„¶ï¼Œç‚¹å‡»ååº”è¯¥ä¼šæ‰“å¼€å¯¹åº”çš„Appæ‰å¯¹ã€‚æ‰€ä»¥ç»§ç»­çœ‹<code>onClick</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">    Object tag = v.getTag();</span><br><span class="line">    <span class="keyword">if</span> (tag <span class="keyword">instanceof</span> ApplicationInfo) &#123;</span><br><span class="line">        <span class="comment">// Open shortcut</span></span><br><span class="line">        <span class="keyword">final</span> Intent intent = ((ApplicationInfo) tag).intent;</span><br><span class="line">        startActivitySafely(intent);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tag <span class="keyword">instanceof</span> FolderInfo) &#123;</span><br><span class="line">        handleFolderClick((FolderInfo) tag);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç‚¹å‡»Appå°±ä¼šé€šè¿‡<code>startActivitySafely</code>æ–¹æ³•ä½¿ç”¨åˆšæ‰è®¾ç½®çš„tagï¼Œä¹Ÿå°±æ˜¯<code>ApplicationInfo</code>ä¸­çš„intentè¿›è¡Œè·³è½¬ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">startActivitySafely</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">	intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	startActivity(intent);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬æ¥çœ‹çœ‹æ‰“å¼€æŸä¸ªappçš„æ—¶å€™æ•´ä¸ªæµç¨‹æ˜¯æ€ä¹ˆèµ°çš„ã€‚æ¥ç€ä¸Šé¢çš„çš„<code>startActivity()</code>æ–¹æ³•èµ°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startActivity</span><span class="params">(Intent intent, @Nullable Bundle options)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">if</span> (options != <span class="keyword">null</span>) &#123;</span><br><span class="line">		startActivityForResult(intent, -<span class="number">1</span>, options);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	    startActivityForResult(intent, -<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸ç®¡ä½ æ˜¯è°ƒç”¨äº†<code>startActivity</code>è¿˜æ˜¯<code>startActivityForResult</code>æ–¹æ³•ï¼Œ<code>startActivityForResult</code>æ–¹æ³•ï¼Œå¹¶ä¸”å¦‚æœæ˜¯è°ƒç”¨çš„<code>startActivity</code>ï¼Œåˆ™é»˜è®¤<code>requestCode</code>å°±æ˜¯-1ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³è°ƒç”¨<code>startActivityForResult</code>çš„æ—¶å€™ï¼Œæ³¨æ„ä¸èƒ½æŠŠ<code>requestCode</code>è®¾ç½®ä¸º-1ï¼Œå¦åˆ™å®ƒçš„æ•ˆæœå°±è·Ÿ<code>startActivity</code>ä¸€æ ·äº†ï¼Œä¸ä¼šå†å›è°ƒ<code>onActivityResult</code>ï¼ï¼Œå†çœ‹çœ‹<code>startActivityForResult</code>çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startActivityForResult</span><span class="params">(Intent intent, <span class="keyword">int</span> requestCode, @Nullable Bundle options)</span> </span>&#123;</span><br><span class="line">	Instrumentation.ActivityResult ar = mInstrumentation.execStartActivity(</span><br><span class="line">            <span class="keyword">this</span>, mMainThread.getApplicationThread(), mToken, <span class="keyword">this</span>,</span><br><span class="line">            intent, requestCode, options);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒActivityå†…éƒ¨æ˜¯ä½¿ç”¨<code>mInstrumentation</code>ï¼ˆ<code>Instrumentation</code>ç±»å‹ï¼‰æ‰§è¡Œ<code>execStartActivity</code>æ–¹æ³•æ¥å®ç°<code>Activity</code>è·³è½¬çš„ï¼Œæ‰§è¡Œå®Œæ¯•åä¼šè¿”å›ä¸€ä¸ª<code>Instrumentation.ActivityResult</code>ã€‚</p>
<p>ç„¶åæŸ¥çœ‹<code>Instrumentation::execStartActivity</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ActivityResult <span class="title">execStartActivity</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">	// ...</span></span></span><br><span class="line"><span class="function"><span class="params">	<span class="keyword">int</span> result = ActivityManagerNative.getDefault()</span></span></span><br><span class="line"><span class="function">        .<span class="title">startActivity</span><span class="params">(whoThread, who.getBasePackageName()</span>, intent,</span></span><br><span class="line"><span class="function">                intent.<span class="title">resolveTypeIfNeeded</span><span class="params">(who.getContentResolver()</span>),</span></span><br><span class="line"><span class="function">                token, target !</span>= <span class="keyword">null</span> ? target.mEmbeddedID : <span class="keyword">null</span>,</span><br><span class="line">                requestCode, <span class="number">0</span>, <span class="keyword">null</span>, options);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆé€šè¿‡<code>ActivityManagerNative.getDefault()</code>è·å¾—ä¸€ä¸ª<code>IActivityManager</code>çš„å®ç°ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">public</span> IActivityManager <span class="title">getDefault</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> gDefault.get();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton&lt;IActivityManager&gt; gDefault = <span class="keyword">new</span> Singleton&lt;IActivityManager&gt;() &#123;</span><br><span class="line">	<span class="function"><span class="keyword">protected</span> IActivityManager <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// é€šè¿‡Binder IPCè·å–ActivityManagerï¼ˆIBinderï¼‰</span></span><br><span class="line">        IBinder b = ServiceManager.getService(<span class="string">"activity"</span>);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        IActivityManager am = asInterface(b);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="keyword">return</span> am;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">public</span> IActivityManager <span class="title">asInterface</span><span class="params">(IBinder obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (obj == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    IActivityManager in =</span><br><span class="line">        (IActivityManager)obj.queryLocalInterface(descriptor);</span><br><span class="line">    <span class="keyword">if</span> (in != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> in;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ActivityManagerProxy(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…ˆé€šè¿‡Binder IPCçš„æ–¹å¼ä»æœåŠ¡ç«¯è·å–ä¸€ä¸ª<code>Activity Manager</code>ï¼Œç„¶åé€šè¿‡<code>ActivityManagernative</code>å°è£…æˆä¸€ä¸ªä»£ç†<code>ActivityManagerProxy</code>å¯¹è±¡ï¼Œç„¶åè°ƒç”¨<code>startActivity</code>ä¹Ÿæ˜¯ä½¿ç”¨äº†Binder IPCè¿›è¡Œä¸æœåŠ¡å™¨ç«¯çš„é€šä¿¡ï¼Œï¼ˆæ•´ä¸ªAndroidç³»ç»Ÿçš„é€šä¿¡æœºåˆ¶ä½¿ç”¨äº†å¤§é‡çš„Binder IPCï¼Œè¿™ä¸ªä»¥åå†ä¸“é—¨è®¨è®ºè¿™ä¸ªå§ï¼‰ï¼Œæ¥ç€ï¼Œæˆ‘ä»¬è¿›å…¥åˆ°äº†<code>com.android.server.am.ActivityManagerService</code>çš„<code>startActivity</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">startActivity</span><span class="params">(IApplicationThread caller, String callingPackage, Intent intent, String resolvedType, IBinder resultTo, String resultWho, <span class="keyword">int</span> requestCode, <span class="keyword">int</span> startFlags, ProfilerInfo profilerInfo, Bundle options)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> startActivityAsUser(caller, callingPackage, intent, resolvedType, resultTo, resultWho, requestCode, startFlags, profilerInfo, options, UserHandle.getCallingUserId());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥çš„è°ƒç”¨é“¾ï¼š</p>
<p>-&gt; <code>startActivityAsUser</code><br>-&gt; <code>startActivityMayWait</code><br>-&gt; <code>startActivityLocked</code><br>-&gt; <code>startActivityUncheckedLocked</code><br>-&gt; <code>targetStack.startActivityLocked(r, newTask, doResume, keepCurTransition, options)</code><br>-&gt; <code>mStackSupervisor.resumeTopActivitiesLocked(this, r, options)</code><br>-&gt; <code>resumeTopActivityInnerLocked(prev, options);</code><br>-&gt; <code>mStackSupervisor.startSpecificActivityLocked(next, true, true)</code></p>
<p><code>startSpecificActivityLocked</code>æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">startSpecificActivityLocked</span><span class="params">(ActivityRecord r, <span class="keyword">boolean</span> andResume, <span class="keyword">boolean</span> checkConfig)</span> </span>&#123;</span><br><span class="line">    ProcessRecord app = mService.getProcessRecordLocked(r.processName,</span><br><span class="line">            r.info.applicationInfo.uid, <span class="keyword">true</span>);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">if</span> (app != <span class="keyword">null</span> &amp;&amp; app.thread != <span class="keyword">null</span>) &#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		realStartActivityLocked(r, app, andResume, checkConfig);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	mService.startProcessLocked(r.processName, r.info.applicationInfo, <span class="keyword">true</span>, <span class="number">0</span>, <span class="string">"activity"</span>, r.intent.getComponent(), <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆä»<code>mService</code>æ‰¾å‡ºå¯¹åº”éœ€è¦å¯åŠ¨Activityçš„è¿›ç¨‹ï¼ˆé€šè¿‡è¿›ç¨‹åå­—å’Œuidï¼Œè¿›ç¨‹åå­—å¯ä»¥åœ¨<code>AndroidManifest.xml</code>ä¸­é…ç½®ï¼‰å¦‚æœå¯ä»¥è·å–åˆ°ï¼Œè¯´æ˜è¿™ä¸ªActivityæ‰€å±çš„è¿›ç¨‹å·²ç»å­˜åœ¨äº†ï¼Œä¹Ÿå°±æ˜¯è¯´appå·²ç»åœ¨è¿è¡Œäº†ï¼Œé‚£å°±ä¼šè°ƒç”¨<code>realStartActivityLocked</code>ï¼Œå¦åˆ™ï¼Œå¦‚æœè¯¥Activityæ‰€åœ¨çš„Appæ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨ï¼Œåˆ™ä¼šè°ƒç”¨<code>mService.startProcessLocked</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> ProcessRecord <span class="title">startProcessLocked</span><span class="params">(<span class="comment">/*...*/</span>)</span></span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	startProcessLocked(app, hostingType, hostingNameStr, abiOverride, entryPoint, entryPointArgs);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> ProcessRecord <span class="title">startProcessLocked</span><span class="params">(String processName, ApplicationInfo info, <span class="keyword">boolean</span> knownToBeDead, <span class="keyword">int</span> intentFlags, String hostingType, ComponentName hostingName, <span class="keyword">boolean</span> allowWhileBooting, <span class="keyword">boolean</span> isolated, <span class="keyword">int</span> isolatedUid, <span class="keyword">boolean</span> keepIfLarge, String abiOverride, String entryPoint, String[] entryPointArgs, Runnable crashHandler)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	app = getProcessRecordLocked(processName, info.uid, keepIfLarge);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">if</span> (app == <span class="keyword">null</span>) &#123;</span><br><span class="line">		app = newProcessRecordLocked(info, processName, isolated, isolatedUid);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">startProcessLocked</span><span class="params">(ProcessRecord app, String hostingType, String hostingNameStr, String abiOverride, String entryPoint, String[] entryPointArgs)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="comment">// entryPointè¡¨ç¤ºä¸€ä¸ªç±»ï¼Œå®ƒç”¨æ¥ä½œä¸ºæ–°åˆ›å»ºçš„è¿›ç¨‹çš„ä¸»å…¥å£ï¼Œä¼šè°ƒç”¨è¿™ä¸ªç±»çš„é™æ€mainæ–¹æ³•ï¼Œè¿™ä¸ªå‚æ•°åœ¨startProcessLockedæ–¹æ³•ä¸­ä¼šè¢«æ£€æŸ¥é‡ç½®ï¼Œå¦‚æœæ˜¯nullçš„è¯ï¼Œå°±é»˜è®¤æ˜¯android.app.ActivityThreadã€‚</span></span><br><span class="line">	<span class="keyword">if</span> (entryPoint == <span class="keyword">null</span>) entryPoint = <span class="string">"android.app.ActivityThread"</span>;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	Process.ProcessStartResult startResult = Process.start(entryPoint,</span><br><span class="line">            app.processName, uid, uid, gids, debugFlags, mountExternal,</span><br><span class="line">            app.info.targetSdkVersion, app.info.seinfo, requiredAbi, </span><br><span class="line">            instructionSet, app.info.dataDir, entryPointArgs);</span><br><span class="line">	<span class="comment">// ...	</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™3ä¸ªé‡è½½æ–¹æ³•åšçš„äº‹æƒ…å°±æ˜¯ï¼Œå…ˆæ ¹æ®è¿›ç¨‹åå­—è°ƒç”¨<code>getProcessRecordLocked()</code>è·å–<code>ProcessRecord</code>ï¼Œå¦‚æœ<code>ProcessRecord</code>ä¸å­˜åœ¨ï¼Œåˆ™è°ƒç”¨<code>newProcessRecordLocked()</code>æ–¹æ³•å»ºç«‹ä¸€ä¸ª<code>ProcessRecord</code>ï¼Œå¹¶ä¸”æ–°çš„<code>ProcessRecord</code>ç»‘å®šäº†<code>ApplicationInfo</code>ï¼Œ<code>uid</code>ç­‰ä¿¡æ¯ï¼Œä½†åè¿›å…¥ç¬¬ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼Œæ‰§è¡Œæ–°å»ºã€å¯åŠ¨è¿›ç¨‹ã€‚</p>
<p>å†çœ‹<code>Process::start</code>çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> ProcessStartResult <span class="title">start</span><span class="params">(<span class="comment">/*...*/</span>)</span></span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">return</span> startViaZygote(processClass, niceName, uid, gid, gids,</span><br><span class="line">              debugFlags, mountExternal, targetSdkVersion, seInfo,</span><br><span class="line">              abi, instructionSet, appDataDir, zygoteArgs);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥å°±æ˜¯é€šè¿‡<code>Zygote</code>è¿›ç¨‹<code>fork</code>ä¸€ä¸ªæ–°çš„è¿›ç¨‹ä½œä¸ºappçš„è¿›ç¨‹ã€‚è¿™é‡Œè¦éœ€è¦è®²çš„ä¸€ä¸ªå‚æ•°æ˜¯<code>processClass</code>ï¼Œè¿™ä¸ªå‚æ•°è¡¨ç¤ºä¸€ä¸ªç±»ï¼Œå®ƒç”¨æ¥ä½œä¸ºæ–°åˆ›å»ºçš„è¿›ç¨‹çš„ä¸»å…¥å£ï¼Œä¼šè°ƒç”¨è¿™ä¸ªç±»çš„é™æ€<code>main</code>æ–¹æ³•ï¼Œè¿™ä¸ªå‚æ•°åœ¨<code>startProcessLocked</code>æ–¹æ³•ä¸­ä¼šè¢«æ£€æŸ¥é‡ç½®ï¼Œå¦‚æœæ˜¯nullçš„è¯ï¼Œå°±é»˜è®¤æ˜¯<code>android.app.ActivityThread</code>ã€‚</p>
<p>ç°åœ¨Appçš„è¿›ç¨‹ä¹Ÿåˆ›å»ºæˆåŠŸäº†ï¼Œå°±ä¼šè¿›å…¥<code>android.app.ActivityThread</code>çš„é™æ€çš„<code>main</code>ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="comment">// åˆå§‹åŒ–ä¸»çº¿ç¨‹Looper</span></span><br><span class="line">	Looper.prepareMainLooper();</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	ActivityThread thread = <span class="keyword">new</span> ActivityThread();</span><br><span class="line">    thread.attach(<span class="keyword">false</span>);	</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="comment">// å¯åŠ¨æ¶ˆæ¯å¾ªç¯</span></span><br><span class="line">	Looper.loop()</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶ååˆ›å»ºäº†ä¸€ä¸ª<code>ActivityThread</code>ï¼Œè¯´æ˜æ¯å½“ä¸€ä¸ªæ–°çš„appè¿›ç¨‹è¢«åˆ›å»ºï¼Œéƒ½ä¼šå¯¹åº”ä¸€ä¸ªæ–°çš„<code>ActivityThread</code>å®ä¾‹ï¼Œç„¶åè°ƒç”¨å®ƒçš„<code>attach</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(<span class="keyword">boolean</span> system)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">if</span> (!system) &#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		<span class="keyword">final</span> IActivityManager mgr = ActivityManagerNative.getDefault();</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		mgr.attachApplication(mAppThread);</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå†æ¬¡é€šè¿‡Binder IPCè°ƒç”¨<code>ActivityManagerProxy</code>çš„<code>attachApplication</code>ï¼Œä¼ å…¥çš„<code>ApplicationThread</code>ï¼ˆBinderï¼‰å‚æ•°ç”¨äºåœ¨æœåŠ¡ç«¯è¿›è¡Œå›è°ƒé€šä¿¡ã€‚æœ€åè¿›å…¥<code>ActivityManagerService::attachApplication</code>ï¼Œå†è°ƒç”¨<code>attachApplicationLocked(thread, callingPid)</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">attachApplicationLocked</span><span class="params">(IApplicationThread thread, <span class="keyword">int</span> pid)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	app = mPidsSelfLocked.get(pid);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	app.makeActive(thread, mProcessStats);</span><br><span class="line">    app.curAdj = app.setAdj= -<span class="number">100</span>;</span><br><span class="line">    app.curSchedGroup = app.setSchedGroup = Process.THREAD_GROUP_DEFAULT;</span><br><span class="line">    app.forcingToForeground = <span class="keyword">null</span>;</span><br><span class="line">    updateProcessForegroundLocked(app, <span class="keyword">false</span>, <span class="keyword">false</span>);</span><br><span class="line">    app.hasShownUi = <span class="keyword">false</span>;</span><br><span class="line">    app.debugging = <span class="keyword">false</span>;</span><br><span class="line">    app.cached = <span class="keyword">false</span>;</span><br><span class="line">    app.killedByAm = <span class="keyword">false</span>;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	thread.bindApplication(processName, appInfo, providers, app.instrumentationClass, profilerInfo, app.instrumentationArguments, app.instrumentationWatcher, app.instrumentationUiAutomationConnection, testMode, enableOpenGlTrace, enableTrackAllocation, isRestrictedBackupMode || !normalMode, app.persistent, <span class="keyword">new</span> Configuration(mConfiguration), app.compat, getCommonServicesLocked(app.isolated), mCoreSettingsObserver.getCoreSettingsLocked());</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">if</span> (normalMode) &#123;</span><br><span class="line">	    <span class="keyword">try</span> &#123;</span><br><span class="line">	        <span class="keyword">if</span> (mStackSupervisor.attachApplicationLocked(app)) &#123;</span><br><span class="line">	            didSomething = <span class="keyword">true</span>;</span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">	        Slog.wtf(TAG, <span class="string">"Exception thrown launching activities in "</span> + app, e);</span><br><span class="line">	        badApp = <span class="keyword">true</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œé€šè¿‡pidè·å–åˆšåˆšåˆ›å»ºçš„è¿›ç¨‹ï¼Œç„¶åå¯¹appè¿›è¡Œä¸€äº›åˆå§‹åŒ–å·¥ä½œï¼Œç„¶åè°ƒç”¨<code>bindApplication</code>è¿œç¨‹è°ƒç”¨å®¢æˆ·ç«¯<code>ActivityThread::bindApplication</code>ï¼Œå†é€šè¿‡<code>Handler</code>è°ƒç”¨åˆ°<code>ActivityThread::handleBindApplication</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">handleBindApplication</span><span class="params">(AppBindData data)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">final</span> ContextImpl appContext = ContextImpl.createAppContext(<span class="keyword">this</span>, data.info);</span><br><span class="line">	<span class="keyword">if</span> (data.instrumentationName != <span class="keyword">null</span>) &#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		mInstrumentationPackageName = ii.packageName;</span><br><span class="line">        mInstrumentationAppDir = ii.sourceDir;</span><br><span class="line">        mInstrumentationSplitAppDirs = ii.splitSourceDirs;</span><br><span class="line">        mInstrumentationLibDir = ii.nativeLibraryDir;</span><br><span class="line">        mInstrumentedAppDir = data.info.getAppDir();</span><br><span class="line">        mInstrumentedSplitAppDirs = data.info.getSplitAppDirs();</span><br><span class="line">        mInstrumentedLibDir = data.info.getLibDir();</span><br><span class="line"></span><br><span class="line">        ApplicationInfo instrApp = <span class="keyword">new</span> ApplicationInfo();</span><br><span class="line">        instrApp.packageName = ii.packageName;</span><br><span class="line">        instrApp.sourceDir = ii.sourceDir;</span><br><span class="line">        instrApp.publicSourceDir = ii.publicSourceDir;</span><br><span class="line">        instrApp.splitSourceDirs = ii.splitSourceDirs;</span><br><span class="line">        instrApp.splitPublicSourceDirs = ii.splitPublicSourceDirs;</span><br><span class="line">        instrApp.dataDir = ii.dataDir;</span><br><span class="line">        instrApp.nativeLibraryDir = ii.nativeLibraryDir;</span><br><span class="line">        LoadedApk pi = getPackageInfo(instrApp, data.compatInfo,</span><br><span class="line">                appContext.getClassLoader(), <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</span><br><span class="line">        ContextImpl instrContext = ContextImpl.createAppContext(<span class="keyword">this</span>, pi);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">java.lang.ClassLoader cl = instrContext.getClassLoader();</span><br><span class="line">        mInstrumentation = (Instrumentation) cl.loadClass(data.instrumentationName.getClassName()).newInstance();</span><br><span class="line">        mInstrumentation.init(<span class="keyword">this</span>, instrContext, appContext, <span class="keyword">new</span> ComponentName(ii.packageName, ii.name), data.instrumentationWatcher, data.instrumentationUiAutomationConnection);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		mInstrumentation = <span class="keyword">new</span> Instrumentation();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	Application app = data.info.makeApplication(data.restrictedBackupMode, <span class="keyword">null</span>);</span><br><span class="line">    mInitialApplication = app;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	mInstrumentation.callApplicationOnCreate(app);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªå½“å‰Appçš„<code>Context</code>ï¼Œç„¶åå¦‚æœ<code>data.instrumentationName != null</code>ï¼Œåˆ™åˆå§‹åŒ–<code>Instrumentation</code>ç›¸å…³çš„å˜é‡ï¼Œå¹¶åˆ›å»º<code>Instrumentation</code>çš„<code>ApplicationInfo</code>ç­‰å¯¹è±¡æ¥åˆ›å»º<code>Instrumentation</code>çš„<code>Context</code>ï¼Œç„¶ååˆ›å»º<code>Instrumentation</code>å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒçš„<code>init</code>æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ã€‚å¦‚æœ<code>data.instrumentationName == null</code>ï¼Œåˆ™newä¸€ä¸ª<code>Instrumentation</code>ï¼ˆåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­åªä¼šæœ‰ä¸€ä¸ª<code>Instrumentation</code>å®ä¾‹ï¼‰ç„¶ååˆ›å»º<code>Application</code>å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒçš„<code>onCreate</code>æ–¹æ³•ï¼Œè¿™æ ·<code>Application</code>å°±ä¼šè¢«å›è°ƒäº†ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å›åˆ°<code>ActivityManagerService::attachApplicationLocked</code>æ–¹æ³•ï¼Œè¿œç¨‹æ‰§è¡Œå®Œ<code>thread.bindApplication</code>æ–¹æ³•ä¹‹åï¼Œæ¥ä¸‹æ¥ä¼šè°ƒç”¨<code>mStackSupervisor.attachApplicationLocked(app)</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">attachApplicationLocked</span><span class="params">(ProcessRecord app)</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	ActivityRecord hr = stack.topRunningActivityLocked(<span class="keyword">null</span>);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	realStartActivityLocked(hr, app, <span class="keyword">true</span>, <span class="keyword">true</span>)</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…ˆé€šè¿‡<code>topRunningActivityLocked</code>ä»å †æ ˆé¡¶ç«¯è·å–è¦å¯åŠ¨çš„Activityï¼Œç„¶å<code>realStartActivityLocked(hr, app, true, true)</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">realStartActivityLocked</span><span class="params">(ActivityRecord r,</span></span></span><br><span class="line"><span class="function"><span class="params">            ProcessRecord app, <span class="keyword">boolean</span> andResume, <span class="keyword">boolean</span> checkConfig)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	app.thread.scheduleLaunchActivity(<span class="keyword">new</span> Intent(r.intent), r.appToken, System.identityHashCode(r), r.info, <span class="keyword">new</span> Configuration(mService.mConfiguration), <span class="keyword">new</span> Configuration(stack.mOverrideConfig), r.compat, r.launchedFromPackage, task.voiceInteractor, app.repProcState, r.icicle, r.persistentState, results, newIntents, !andResume, mService.isNextTransitionForward(), profilerInfo);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»§ç»­é€šè¿‡Binder IPCè¿œç¨‹è°ƒç”¨<code>scheduleLaunchActivity</code>æ–¹æ³•ï¼Œç„¶åè¿›å…¥<code>ActivityThread</code>çš„<code>scheduleLaunchActivity</code>æ–¹æ³•ä¸­ï¼Œç„¶åé€šè¿‡<code>Handler</code>è¿›å…¥<code>handleLaunchActivity</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">handleLaunchActivity</span><span class="params">(ActivityClientRecord r, Intent customIntent)</span></span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	Activity a = performLaunchActivity(r, customIntent);</span><br><span class="line"></span><br><span class="line">	handleResumeActivity(r.token, <span class="keyword">false</span>, r.isForward, !r.activity.mFinished &amp;&amp; !r.startsNotResumed);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…ˆè°ƒç”¨<code>performLaunchActivity</code>æ–¹æ³•è¿”å›ä¸€ä¸ª<code>Activity</code>ï¼Œç„¶åè°ƒç”¨<code>handleResumeActivity</code>æ–¹æ³•è®©è¯¥<code>Activity</code>è¿›å…¥<code>onResume</code>çŠ¶æ€ã€‚æ‰€ä»¥å¾ˆæ˜¾ç„¶åœ¨<code>performLaunchActivity</code>ä¸­è‚¯å®šæ˜¯ç”Ÿæˆäº†<code>Activity</code>å®ä¾‹ï¼Œå¹¶è°ƒç”¨äº†<code>onCreate</code>æ–¹æ³•äº†ï¼Œæ¥çœ‹ä¸‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Activity <span class="title">performLaunchActivity</span><span class="params">(ActivityClientRecord r, Intent customIntent)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	ActivityInfo aInfo = r.activityInfo;</span><br><span class="line">	<span class="keyword">if</span> (r.packageInfo == <span class="keyword">null</span>) &#123;</span><br><span class="line">	    r.packageInfo = getPackageInfo(aInfo.applicationInfo, r.compatInfo,</span><br><span class="line">	            Context.CONTEXT_INCLUDE_CODE);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	java.lang.ClassLoader cl = r.packageInfo.getClassLoader();</span><br><span class="line">    activity = mInstrumentation.newActivity(cl, component.getClassName(), r.intent);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	Context appContext = createBaseContextForActivity(r, activity);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	activity.attach(appContext, <span class="keyword">this</span>, getInstrumentation(), r.token, r.ident, app, r.intent, r.activityInfo, title, r.parent, r.embeddedID, r.lastNonConfigurationInstances, config, r.referrer, r.voiceInteractor);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">if</span> (r.isPersistable()) &#123;</span><br><span class="line">     mInstrumentation.callActivityOnCreate(activity, r.state, r.persistentState);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        mInstrumentation.callActivityOnCreate(activity, r.state);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	mInstrumentation.callActivityOnRestoreInstanceState(activity, r.state, r.persistentState);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	mInstrumentation.callActivityOnPostCreate(activity, r.state, r.persistentState);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œåˆå§‹åŒ–<code>LoadedApk</code>ï¼Œç„¶åé€šè¿‡<code>Instrumentation</code>æ¥åˆ›å»ºä¸€ä¸ª<code>Activity</code>å®ä¾‹ï¼Œé€šè¿‡<code>createBaseContextForActivity</code>æ–¹æ³•åˆ›å»ºä¸€ä¸ª<code>Activity Context</code>ï¼Œè°ƒç”¨<code>activity</code>çš„<code>attach</code>æ–¹æ³•ï¼Œç„¶åä¾æ¬¡è§¦å‘è¯¥<code>Activity</code>çš„<code>onCreate</code>ã€<code>onRestoreInstanceState</code>ã€<code>onPostCreate</code>ç­‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚</p>
<p><code>createBaseContextForActivity</code>æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Context <span class="title">createBaseContextForActivity</span><span class="params">(ActivityClientRecord r, <span class="keyword">final</span> Activity activity)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	ContextImpl appContext = ContextImpl.createActivityContext(<span class="keyword">this</span>, r.packageInfo, displayId, r.overrideConfig);</span><br><span class="line">    appContext.setOuterContext(activity);</span><br><span class="line">    Context baseContext = appContext;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡<code>ContextImpl::createActivityContext</code>åˆ›å»ºçš„<code>Context</code>å¯¹è±¡ï¼Œå¯ä»¥å‘ç°ï¼Œä¸è®ºæ˜¯<code>System Context/App Context/Activity Context</code>ï¼Œè¿™äº›<code>Context</code>éƒ½æ˜¯é€šè¿‡<code>ContextImpl</code>ç”Ÿæˆçš„ï¼Œå…·ä½“è¿™é‡Œå†æŒ–ä¸ªå‘å…ˆã€‚</p>
<p>å†ç»§ç»­è¿›å…¥<code>Activity::attach</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Context context, ActivityThread aThread,</span></span></span><br><span class="line"><span class="function"><span class="params">            Instrumentation instr, IBinder token, <span class="keyword">int</span> ident,</span></span></span><br><span class="line"><span class="function"><span class="params">            Application application, Intent intent, ActivityInfo info,</span></span></span><br><span class="line"><span class="function"><span class="params">            CharSequence title, Activity parent, String id,</span></span></span><br><span class="line"><span class="function"><span class="params">            NonConfigurationInstances lastNonConfigurationInstances,</span></span></span><br><span class="line"><span class="function"><span class="params">            Configuration config, String referrer, IVoiceInteractor voiceInteractor)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	mMainThread = aThread;</span><br><span class="line">    mInstrumentation = instr;</span><br><span class="line">    mToken = token;</span><br><span class="line">    mIdent = ident;</span><br><span class="line">    mApplication = application;</span><br><span class="line">    mIntent = intent;</span><br><span class="line">    mReferrer = referrer;</span><br><span class="line">    mComponent = intent.getComponent();</span><br><span class="line">    mActivityInfo = info;</span><br><span class="line">    mTitle = title;</span><br><span class="line">    mParent = parent;</span><br><span class="line">    mEmbeddedID = id;</span><br><span class="line">    mLastNonConfigurationInstances = lastNonConfigurationInstances;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢å¯¹<code>Activity</code>ä¸<code>ActivityThread</code>ã€<code>Instrumentation</code>ç­‰è¿›è¡Œäº†ç»‘å®šï¼Œæ‰€ä»¥è¯´æ¯ä¸ª<code>Activity</code>éƒ½å«æœ‰ä¸€ä¸ª<code>ActivityThread</code>å¼•ç”¨å’Œä¸€ä¸ª<code>Instrumentation</code>å¼•ç”¨ï¼Œè€Œ<code>ActivityThread</code>å®ä¾‹å’Œ<code>Instrumentation</code>å®ä¾‹åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­éƒ½åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå› ä¸º<code>ActivityThread</code>æ˜¯åœ¨è¿›ç¨‹è¢«åˆ›å»ºæˆåŠŸåï¼Œè¿›å…¥<code>ActivityThread</code>çš„<code>static main()</code>æ—¶æ‰ä¼šè¢«åˆ›å»ºï¼Œè€Œ<code>Instrumentation</code>åˆ™æ˜¯åœ¨<code>ActivityThread</code>è¢«åˆ›å»ºåè¿›è¡Œ<code>attach</code>çš„ä¹‹åè¢«åˆ›å»ºã€‚</p>
<h3 id="å¯åŠ¨åº”ç”¨æµç¨‹æ‰€æœ‰æ–¹æ³•é“¾è°ƒç”¨æ€»ç»“ï¼š"><a href="#å¯åŠ¨åº”ç”¨æµç¨‹æ‰€æœ‰æ–¹æ³•é“¾è°ƒç”¨æ€»ç»“ï¼š" class="headerlink" title="å¯åŠ¨åº”ç”¨æµç¨‹æ‰€æœ‰æ–¹æ³•é“¾è°ƒç”¨æ€»ç»“ï¼š"></a>å¯åŠ¨åº”ç”¨æµç¨‹æ‰€æœ‰æ–¹æ³•é“¾è°ƒç”¨æ€»ç»“ï¼š</h3><ul>
<li><p><code>Activity::startActivity</code></p>
</li>
<li><p><code>Activity::startActivityForResult</code></p>
</li>
<li><p><code>Instrumentation::execStartActivity</code>ï¼š<br>æºå¸¦å‚æ•°ï¼š<br>1. <code>who</code>ï¼šfromçš„Context<br>2. <code>contextThread</code>ï¼šfromçš„<code>ActivityThread</code>çš„<code>ApplicationThread</code>ï¼Œ<code>ApplicationThread</code>ä¸­å¯ä»¥é€šè¿‡Binder IPCæä¾›ç»™æœåŠ¡ç«¯å›è°ƒ<code>Activity</code>ç”Ÿå‘½å‘¨æœŸç­‰æ“ä½œï¼ˆfromçš„ä¸»çº¿ç¨‹ï¼‰ã€‚<br>3. <code>mToken</code>ï¼š<code>Binder</code>ç±»å‹ï¼Œç”¨æ¥æ ‡è¯†fromçš„Activityï¼Œå¯èƒ½ä¸ºnullã€‚<br>4. <code>target</code>ï¼šfromçš„Activityï¼ˆæ‰€ä»¥æ˜¯ç”¨æ¥æ¥æ”¶è·³è½¬ç»“æœçš„ï¼‰ï¼Œå¦‚æœä¸æ˜¯ä»Activityè·³è½¬åˆ™ä¸ºnullã€‚<br>5. <code>intent</code>ï¼šè·³è½¬Intentã€‚<br>6. <code>requestCode</code>ï¼šå¦‚æœæ˜¯<code>startActivity</code>ï¼Œåˆ™ä¸º-1ã€‚<br>7. <code>options</code>ï¼šé¢å¤–Bundleæ•°æ®ã€‚</p>
</li>
<li><p><code>ActivityManagerProxy::startActivity()</code>ï¼š<br>æºå¸¦å‚æ•°ï¼š<br>1. <code>caller</code>ï¼šä¸Šé¢çš„<code>contextThread</code>ï¼Œfromä¸»çº¿ç¨‹ã€‚<br>2. <code>callingPackage</code>ï¼šfromçš„ContextåŒ…åã€‚<br>3. <code>intent</code>ï¼šè·³è½¬Intentã€‚<br>4. <code>resolvedType</code>ï¼šè·³è½¬Intentçš„MIMEç±»å‹ã€‚<br>5. <code>resultTo</code>ï¼šä¸Šé¢çš„<code>token</code>ï¼Œ<code>Binder</code>ç±»å‹ï¼Œç”¨æ¥æ ‡è¯†fromçš„Activityã€‚<br>6. <code>resultWho</code>ï¼šfromçš„Activityçš„mEmbeddedIDï¼ˆå”¯ä¸€æ ‡ç¤ºå­—ç¬¦ä¸²ï¼‰<br>7. <code>requestCode</code>ï¼šå¦‚æœæ˜¯<code>startActivity</code>ï¼Œåˆ™ä¸º-1ã€‚<br>8. <code>startFlags</code>ï¼šé»˜è®¤ä¼ å…¥ä¸º0ã€‚<br>9. <code>profilerInfo</code>ï¼šé»˜è®¤ä¼ å…¥ä¸ºnullã€‚<br>10. <code>options</code>ï¼šé¢å¤–Bundleæ•°æ®ã€‚</p>
</li>
<li><p><code>ActivityManagerService::startActivity()</code>ï¼ˆé€šè¿‡Binder IPCè°ƒç”¨ï¼‰ï¼š<br>æºå¸¦å‚æ•°è·Ÿä¸Šé¢ä¸€æ ·ã€‚</p>
</li>
<li><p><code>ActivityManagerService::startActivityAsUser</code><br>æºå¸¦å‚æ•°åŒ…æ‹¬<code>ActivityManagerService::startActivity()</code>æ‰€æœ‰çš„å‚æ•°ï¼Œæœ€å†åŠ ä¸€ä¸ªï¼š<br>1. <code>userId</code>ï¼šuserIdï¼Œæ ¹æ®ç»™å½“å‰è¿›ç¨‹åˆ†é…çš„Linux UIDï¼ˆè¿™ä¸ªUIDå¯ä»¥ç”¨æ¥è®©ä¸Šå±‚ç³»ç»ŸæœåŠ¡è¿›è¡Œèº«ä»½è¯†åˆ«å’Œæƒé™æ£€æŸ¥ï¼‰å¾—åˆ°ä¸€ä¸ªuserIdï¼ˆå¦‚æœä¸æ˜¯å¤šç”¨æˆ·ï¼Œåˆ™ç›´æ¥è¿”å›0ï¼‰ã€‚</p>
</li>
<li><p><code>ActivityStackSupervisor::startActivityMayWait()</code><br>å‚æ•°ï¼š<br>1. <code>caller</code>ï¼šä¸Šé¢çš„<code>caller/contextThread</code>ï¼Œfromä¸»çº¿ç¨‹ã€‚<br>2. <code>callingUid</code>ï¼šè°ƒç”¨ç”¨æˆ·uidã€‚<br>3. <code>callingPackage</code>ï¼šfromçš„ContextåŒ…åã€‚<br>4. <code>intent</code>ï¼šè·³è½¬Intentã€‚<br>5. <code>resolvedType</code>ï¼šè·³è½¬Intentçš„MIMEç±»å‹ã€‚<br>6. <code>voiceSession</code>ï¼šä¼ nullã€‚<br>7. <code>voiceInteractor</code>ï¼šä¼ nullã€‚<br>8. <code>resultTo</code>ï¼šä¸Šé¢çš„<code>resultTo/token</code>ï¼Œ<code>Binder</code>ç±»å‹ï¼Œç”¨æ¥æ ‡è¯†fromçš„Activityã€‚<br>9. <code>resultWho</code>ï¼šfromçš„Activityçš„mEmbeddedIDï¼ˆå”¯ä¸€æ ‡ç¤ºå­—ç¬¦ä¸²ï¼‰<br>10. <code>requestCode</code>ï¼šå¦‚æœæ˜¯<code>startActivity</code>ï¼Œåˆ™ä¸º-1ã€‚<br>11. <code>startFlags</code>ï¼šä¼ nullã€‚<br>12. <code>profilerInfo</code>ï¼šä¼ nullã€‚<br>13. <code>outResult</code>ï¼šä¼ nullã€‚<br>14. <code>config</code>ï¼šä¼ nullã€‚<br>15. <code>options</code>ï¼šé¢å¤–æ•°æ®ã€‚<br>16. <code>ignoreTargetSecurity</code>ï¼šfalseã€‚<br>17. <code>userId</code>ï¼šä¸Šé¢çš„<code>userId</code>ï¼Œæ ¹æ®ç»™å½“å‰è¿›ç¨‹åˆ†é…çš„Linux UIDï¼ˆè¿™ä¸ªUIDå¯ä»¥ç”¨æ¥è®©ä¸Šå±‚ç³»ç»ŸæœåŠ¡è¿›è¡Œèº«ä»½è¯†åˆ«å’Œæƒé™æ£€æŸ¥ï¼‰å¾—åˆ°ä¸€ä¸ªuserIdï¼ˆå¦‚æœä¸æ˜¯å¤šç”¨æˆ·ï¼Œåˆ™ç›´æ¥è¿”å›0ï¼‰ã€‚<br>18. <code>iContainer</code>ï¼šä¼ nullã€‚<br>19. <code>inTask</code>ï¼šnullã€‚</p>
</li>
<li><p><code>ActivityStackSupervisor::startActivityLocked()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>caller</code>ï¼šä¸Šé¢çš„<code>caller/contextThread</code>ï¼Œfromä¸»çº¿ç¨‹ã€‚<br>2. <code>intent</code>ï¼šè·³è½¬Intentã€‚<br>3. <code>resolvedType</code>ï¼šè·³è½¬Intentçš„MIMEç±»å‹ã€‚<br>4. <code>aInfo</code>ï¼š<code>ActivityInfo</code>ç±»å‹ï¼Œè§£æfromçš„Activityçš„Intentä¿¡æ¯ã€‚<br>5. <code>voiceSession</code>ï¼šä¼ nullã€‚<br>6. <code>voiceInteractor</code>ï¼šä¼ nullã€‚<br>7. <code>resultTo</code>ï¼šä¸Šé¢çš„<code>resultTo/token</code>ï¼Œ<code>Binder</code>ç±»å‹ï¼Œç”¨æ¥æ ‡è¯†fromçš„Activityã€‚<br>8. <code>resultWho</code>ï¼šfromçš„Activityçš„mEmbeddedIDï¼ˆå”¯ä¸€æ ‡ç¤ºå­—ç¬¦ä¸²ï¼‰<br>9. <code>requestCode</code>ï¼šå¦‚æœæ˜¯<code>startActivity</code>ï¼Œåˆ™ä¸º-1ã€‚<br>10. <code>callingPackage</code>ï¼šfromçš„ContextåŒ…åã€‚<br>11. <code>startFlags</code>ï¼šä¼ nullã€‚<br>12. <code>options</code>ï¼šé¢å¤–æ•°æ®ã€‚<br>13. <code>ignoreTargetSecurity</code>ï¼šfalseã€‚<br>14. <code>componentSpecified</code>ï¼šæ˜¯å¦æ˜¾ç¤ºæŒ‡å®šäº†<code>component</code>ã€‚<br>15. <code>outActivity</code>ï¼šä¼ nullã€‚<br>16. <code>container</code>ï¼šä¸Šé¢çš„<code>iContainer</code>ï¼Œè½¬å‹æˆäº†<code>ActivityContainer</code>ï¼Œè¿˜æ˜¯nullã€‚<br>17. <code>inTask</code>ï¼šnullã€‚<br>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œé€šè¿‡<code>ProcessRecord callerApp = mService.getRecordForAppLocked(caller);</code>è·å–åˆ°ä¹‹å‰åˆ›å»ºçš„<code>ProcessRecord</code>ï¼Œç„¶åä»<code>Activity</code>æ ˆä¸­æ ¹æ®<code>resultTo/token</code>è·å–åˆ°å¯¹åº”from Activityçš„<code>ActivityRecord</code>ï¼ˆsourceRecordï¼‰ï¼Œç„¶å<strong>åˆ›å»ºå°†è¦è·³è½¬çš„Activityçš„ActivityRecordå¯¹è±¡</strong>ï¼ˆ<code>Token</code>ä¹Ÿæ˜¯åœ¨è¿™ä¸ªæ—¶å€™ç”Ÿæˆçš„ï¼‰ã€‚</p>
</li>
<li><p><code>ActivityStackSupervisor::startActivityUncheckedLocked()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>r</code>ï¼š<code>ActivityRecord</code>ç±»å‹ï¼Œå°±æ˜¯<code>ActivityStackSupervisor::startActivityLocked()</code>ä¸­åˆ›å»ºçš„å°†è¦è·³è½¬çš„Activityçš„ActivityRecordå¯¹è±¡ã€‚<br>2. <code>sourceRecord</code>ï¼šå°±æ˜¯<code>ActivityStackSupervisor::startActivityLocked()</code>æ–¹æ³•è·å–çš„from Activityçš„<code>sourceRecord</code>ã€‚<br>3. <code>voiceSession</code>ï¼šä¼ nullã€‚<br>4. <code>voiceInteractor</code>ï¼šä¼ nullã€‚<br>5. <code>startFlags</code>ï¼šä¼ nullã€‚<br>6. <code>doResume</code>ï¼šä¼ trueã€‚<br>7. <code>options</code>ï¼šé¢å¤–æ•°æ®ã€‚<br>8. <code>inTask</code>ï¼šnullã€‚<br>è¿™ä¸ªæ–¹æ³•ä¸­æœ‰å¤§é‡çš„ä»£ç æ¥å¤„ç†<code>task/stack</code>ç­‰æ–¹é¢çš„é€»è¾‘ï¼Œä»¥åå†ä»”ç»†æ·±å…¥è¿™ä¸ªæ–¹æ³•ã€‚</p>
</li>
<li><p><code>ActivityStrack::startActivityLocked()</code>ï¼š<br>æ–¹æ³•è°ƒç”¨è€…ï¼š<code>ActivityStack</code>ç±»å‹ï¼Œ<br><code>targetStack</code>ï¼šåœ¨<code>ActivityStackSupervisor::startActivityUncheckedLocked()</code>ä¸­ç¡®å®šçš„éœ€è¦æ·»åŠ åˆ°çš„<code>ActivityStack</code>ã€‚<br>å‚æ•°ï¼š<br>1. <code>r</code>ï¼š<code>ActivityRecord</code>ç±»å‹ï¼Œå°±æ˜¯<code>ActivityStackSupervisor::startActivityLocked()</code>ä¸­åˆ›å»ºçš„è·³è½¬çš„Activityçš„ActivityRecordå¯¹è±¡ã€‚<br>2. <code>newTask</code>ï¼šæ˜¯å¦<code>Intent</code>æ˜¯å¦è®¾ç½®äº†<code>Intent.FLAG_ACTIVITY_NEW_TASK</code>ã€‚<br>3. <code>doResume</code>ï¼šä¼ trueã€‚<br>4. <code>keepCurTransition</code>ï¼šè¿™ä¸ªå…·ä½“åé¢å†ç ”ç©¶ï¼Œè·Ÿ<code>Intent</code>çš„flagæœ‰å…³ã€‚<br>5. <code>options</code>ï¼šé¢å¤–æ•°æ®ã€‚<br>åŒæ ·ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­æœ‰å¤§é‡çš„ä»£ç æ¥å¤„ç†<code>task/stack</code>ç­‰æ–¹é¢çš„é€»è¾‘ï¼Œä»¥åå†ä»”ç»†æ·±å…¥è¿™ä¸ªæ–¹æ³•<strong>ï¼ˆæ‰§è¡Œå®Œè¿™ä¸ªæ–¹æ³•åï¼Œ<code>ActivityRecord</code>å°±ä¼šè¢«çœŸæ­£åŠ å…¥åˆ°<code>ActivityStack</code>ä¸­ï¼‰</strong>ã€‚</p>
</li>
<li><p><code>ActivityStackSupervisor::resumeTopActivitiesLocked()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>targetStack</code>ï¼šåœ¨<code>ActivityStackSupervisor::startActivityUncheckedLocked()</code>ä¸­ç¡®å®šçš„éœ€è¦æ·»åŠ åˆ°çš„<code>ActivityStack</code>ã€‚<br>2. <code>target</code>ï¼š<code>ActivityRecord</code>ç±»å‹ï¼Œå°±æ˜¯<code>ActivityStackSupervisor::startActivityLocked()</code>ä¸­åˆ›å»ºçš„è·³è½¬çš„Activityçš„ActivityRecordå¯¹è±¡ã€‚<br>3. <code>targetOptions</code>ï¼šé¢å¤–æ•°æ®ã€‚</p>
</li>
<li><p><code>ActivityStack::resumeTopActivityLocked()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>prev</code>ï¼š<code>ActivityRecord</code>ç±»å‹ï¼Œå°±æ˜¯<code>ActivityStackSupervisor::startActivityLocked()</code>ä¸­åˆ›å»ºçš„è·³è½¬çš„Activityçš„ActivityRecordå¯¹è±¡ã€‚<br>2. <code>options</code>ï¼šé¢å¤–æ•°æ®ã€‚</p>
</li>
<li><p><code>ActivityStack::resumeTopActivityInnerLocked()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>prev</code>ï¼š<code>ActivityRecord</code>ç±»å‹ï¼Œå°±æ˜¯<code>ActivityStackSupervisor::startActivityLocked()</code>ä¸­åˆ›å»ºçš„è·³è½¬çš„Activityçš„ActivityRecordå¯¹è±¡ã€‚<br>2. <code>options</code>ï¼šé¢å¤–æ•°æ®ã€‚</p>
</li>
<li><p><code>ActivityStackSupervisor::startSpecificActivityLocked()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>r</code>ï¼šæœ€é¡¶éƒ¨æ²¡æœ‰å¤„äºfinishingçš„Activityï¼Œå°±æ˜¯åˆšåˆšåœ¨<code>startActivityLocked</code>ä¸­åŠ å…¥çš„å°†è¦è·³è½¬çš„<code>ActivityRecord</code>ï¼Œé€šè¿‡<code>topRunningActivityLocked(null)</code>æŸ¥æ‰¾<br>2. <code>andResume</code>ï¼šä¼ true<br>3. <code>checkConfig</code>ï¼šä¼ true</p>
</li>
<li><p><code>ActivityManagerService::startProcessLocked()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>processName</code>ï¼šåˆ›å»ºè¿›ç¨‹çš„åç§°ï¼Œå°±æ˜¯<code>ActivityStack::startSpecificActivityLocked()</code>ä¸­çš„<code>r.processName</code><br>2. <code>info</code>ï¼š<code>ApplicationInfo</code>ï¼Œä¹Ÿæ˜¯<code>r.info.applicaitonInfo</code>ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹<code>ActivityStackSupervisor::startActivityLocked()</code>ä¸­åˆ›å»º<code>ActivityRecord</code>çš„ä»£ç ã€‚<br>3. <code>knownToBeDead</code>ï¼šä¼ trueã€‚<br>4. <code>intentFlags</code>ï¼šä¼ 0ã€‚<br>5. <code>hostingType</code>ï¼šä¼ å­—ç¬¦ä¸²â€œactivityâ€ã€‚<br>6. <code>hostingName</code>ï¼š<code>ComponentName</code>ç±»å‹ï¼Œ<code>intent</code>ä¸­çš„<code>Componentname</code><br>7. <code>allowWhileBooting</code>ï¼šä¼ falseã€‚<br>8. <code>isolated</code>ï¼šä¼ false<br>9. <code>keepIfLarge</code>ä¼ true</p>
</li>
<li><p><code>ActivityManagerService::startProcessLocked()</code>ï¼ˆé‡è½½æ–¹æ³•ï¼‰ï¼š<br>å‚æ•°åŒ…å«ä¸Šé¢æ‰€æœ‰ï¼Œå¤šäº†ä»¥ä¸‹å‡ ä¸ªï¼š<br>1. <code>isolatedUid</code>ï¼šä¼ 0<br>2. <code>abiOverride</code>ï¼šä¼ null<br>3. <code>entryPoint</code>ï¼šä¼ null<br>4. <code>entryPointArgs</code>ä¼ null<br>5. <code>crashHandler</code>ä¼ null<br>æ³¨æ„ï¼šåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œä¼šåˆ›å»ºæ–°è¿›ç¨‹çš„<code>ProcessRecord</code>å¯¹è±¡ï¼Œå¹¶ç»‘å®š<code>ApplicationInfo</code>ç­‰ä¿¡æ¯ï¼Œè¿™æ ·ï¼Œå¯åŠ¨è¿›ç¨‹åè¿›è¡Œ<code>bindApplicaiton</code>çš„æ—¶å€™å°±å¯ä»¥æ ¹æ®è¿›ç¨‹PIDè·å–åˆ°æ‰€æœ‰çš„<code>ApplicationInfo</code>ä¿¡æ¯äº†ã€‚</p>
</li>
<li><p><code>ActivityManagerService::startProcessLocked()</code>ï¼ˆé‡è½½æ–¹æ³•ï¼‰ï¼š<br>å‚æ•°ï¼š<br>1. <code>app</code>ï¼š<code>ProcessRecord</code>ç±»å‹ï¼Œåˆ›å»ºçš„è¿›ç¨‹ã€‚<br>2. <code>hostingType</code>ï¼šä¼ å­—ç¬¦ä¸²â€œactivityâ€ã€‚<br>3. <code>hostingNameStr</code>ï¼šé€šè¿‡<code>hostingName</code>ç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼ˆåŒ…å + â€œ/â€œ + ç±»çš„ç®€å•ç±»åï¼‰<br>4. <code>abiOverride</code>ï¼šä¼ null<br>5. <code>entryPoint</code>ï¼šä¼ null<br>6. <code>entryPointArgs</code>ä¼ null</p>
</li>
<li><p><code>Process.start()</code><br>å‚æ•°ï¼ˆçœç•¥éƒ¨åˆ†å‚æ•°ï¼‰ï¼š<br>1. <code>processClass</code>ï¼šä¸Šé¢çš„<code>entryPoint</code>ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯nulläº†ï¼Œè€Œæ˜¯<code>android.app.ActivityThread</code>ï¼Œå› ä¸ºåœ¨<code>ActivityManagerService::startProcessLocked()</code>ä¸­è¢«è®¾ç½®é»˜è®¤å€¼äº†ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªç±»ï¼Œç”¨æ¥ä½œä¸ºæ–°åˆ›å»ºçš„è¿›ç¨‹çš„ä¸»å…¥å£ï¼Œä¼šè°ƒç”¨è¿™ä¸ªç±»çš„é™æ€mainæ–¹æ³•ã€‚æ‰€ä»¥å¯åŠ¨å®Œè¿™ä¸ªè¿›ç¨‹å°±ä¼šè¿›å…¥<code>ActivityThread</code>çš„<code>static main()</code>æ–¹æ³•ã€‚<br>2. <code>zygoteArgs</code>ï¼šfork zygoteè¿›ç¨‹æ—¶çš„å‚æ•°ã€‚</p>
</li>
<li><p><code>ActivityThread::main()</code></p>
</li>
<li><p><code>ActivityThread::attach()</code></p>
</li>
<li><p><code>ActivityManagerProxy::attachApplication()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>mAppThread</code>ï¼š<code>ApplicationThread()</code>ç±»å‹ï¼ŒBinderï¼Œç”¨æ¥æä¾›ç»™AMSè°ƒç”¨ã€‚</p>
</li>
<li><p><code>ActivityManagerService::attachApplication()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>mAppThread</code>ï¼š<code>ApplicationThread()</code>ç±»å‹ï¼ŒBinderï¼Œç”¨æ¥æä¾›ç»™AMSè°ƒç”¨ã€‚</p>
</li>
<li><p><code>ActivityManagerService::attachApplicationLocked()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>thread</code>ï¼š<code>ApplicationThread()</code>ç±»å‹ï¼ŒBinderï¼Œç”¨æ¥æä¾›ç»™AMSè°ƒç”¨ã€‚ä¸Šé¢çš„<code>mAppThread</code>ã€‚<br>2. <code>pid</code>ï¼šå½“å‰è°ƒç”¨çš„è¿›ç¨‹PIDã€‚</p>
</li>
<li><p><code>IApplicationThread::bindApplication()</code>ï¼š<br>æ–¹æ³•è°ƒç”¨è°ƒç”¨è€…ï¼šä¸Šé¢çš„<code>thread/mAppThread</code>ï¼ŒBinderï¼Œç”¨æ¥æä¾›ç»™AMSè°ƒç”¨ã€‚<br>å‚æ•°ï¼ˆçœç•¥éƒ¨åˆ†å‚æ•°ï¼‰ï¼š<br>1. <code>packageName</code>ï¼šç”¨çš„è¿›ç¨‹åå­—<code>processName</code><br>2. <code>info</code>ï¼š<code>ApplicationInfo</code>ç±»å‹ï¼Œä»<code>ProcessRecord</code>ä¸­çš„<code>instrumentationInfoæˆ–è€…info</code>ï¼Œè¿™ä¸ª<code>ApplicationInfo</code>æ˜¯åœ¨å»ºç«‹<code>ProcessRecord</code>æ—¶å°±ä¿å­˜äº†ã€‚</p>
</li>
<li><p><code>ActivityThread::bindApplication()</code>ï¼š<br>å‚æ•°ï¼šåŒä¸Š</p>
</li>
<li><p><code>ActivityThread::handleBindApplication()</code>ï¼š<br>é€šè¿‡Handlerè°ƒç”¨ã€‚<br>å‚æ•°ï¼š<br>1. <code>data</code>ï¼š<code>AppBindData</code>ç±»å‹ï¼Œé‡Œé¢åŒ…å«çš„ç±»å‹<code>processName</code>ï¼Œ<code>providers</code>ï¼Œ<code>instrumentationName</code>ï¼Œ<code>instrumentationArgs</code>ï¼Œ<code>instrumentationWatcher</code>ï¼Œ<code>instrumentationUiAutomationConnection</code>ï¼Œ<code>config</code>ç­‰æ•°æ®ã€‚</p>
</li>
<li><p><code>ActivityManagerService</code>ä¸­çš„<code>ActivityThread::bindApplication()</code>æ‰§è¡Œå®Œæ¯•ä¹‹å</p>
</li>
<li><p><code>ActivityStackSupervisor::attachApplicationLocked()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>app</code>ï¼šæ–°å»ºçš„è¿›ç¨‹ç»‘å®šçš„<code>ProcessRecord</code>ã€‚</p>
</li>
<li><p><code>ActivityStackSupervisor::realStartActivityLocked()</code>ï¼š<br>å‚æ•°ï¼š<br>1. <code>r</code>ï¼š<code>ActivityRecord</code>ç±»å‹ï¼ŒtopRunningActivityLockedä»å †æ ˆé¡¶ç«¯è·å–è¦å¯åŠ¨çš„Activityã€‚<br>2. <code>app</code>ï¼šæ–°å»ºçš„è¿›ç¨‹ç»‘å®šçš„<code>ProcessRecord</code>ã€‚<br>3. <code>andResume</code>ï¼šä¼ å…¥true<br>4. <code>checkConfig</code>ï¼šä¼ å…¥true</p>
</li>
<li><p><code>IApplicationThread::scheduleLaunchActivity()</code>ï¼š<br>å‚æ•°ï¼ˆéƒ¨åˆ†ï¼‰ï¼š<br>1. <code>intent</code>ï¼šå°†è¦å¯åŠ¨çš„<code>ActivityRecord</code>ä¸­çš„<code>intent</code>ã€‚<br>2. <code>token</code>ï¼šå°†è¦å¯åŠ¨çš„<code>ActivityRecord</code>ä¸­çš„<code>token</code>ã€‚<br>3. <code>info</code>ï¼šå°†è¦å¯åŠ¨çš„<code>ActivityRecord</code>ä¸­çš„<code>ApplicationInfo</code>ã€‚</p>
</li>
<li><p><code>ActivityThread::scheduleLaunchActivity()</code>ï¼š<br>Binder IPCè°ƒç”¨ï¼Œå‚æ•°ä¸<code>IApplicationThread::scheduleLaunchActivity()</code>ç›¸åŒã€‚</p>
</li>
<li><p><code>ActivityThread::handleLaunchActivity()</code>ï¼š<br>è¯¥æ–¹æ³•é€šè¿‡Handlerè°ƒç”¨ï¼Œå‚æ•°åŒä¸Šã€‚<br>1. <code>r</code>ï¼š<code>ActivityClientRecord</code>ç±»å‹ï¼Œåœ¨<code>ActivityThread::scheduleLaunchActivity()</code>ä¸­å°è£…ï¼ŒåŒ…æ‹¬çš„æ•°æ®æœ‰<code>token</code>, <code>ident</code>, <code>intent</code>, <code>activityInfo</code>ç­‰ç­‰ï¼Œä½†æ˜¯<code>LoadedApk</code>æ˜¯è¿™æ—¶æ ¹æ®åŒ…åä»<code>ActivityThread</code>ä¸­å¼±å¼•ç”¨ç¼“å­˜ä¸­è·å–çš„çš„ã€‚<br>2. <code>customIntent</code>ï¼šnull</p>
</li>
<li><p><code>ActivityThread::performLaunchActivity()</code>ï¼š<br>å‚æ•°ä¸<code>ActivityThread::handleLaunchActivity()</code>ç›¸åŒã€‚</p>
</li>
<li><p><code>Activity::attach()</code>ï¼š<br>å‚æ•°ï¼ˆéƒ¨åˆ†ï¼‰ï¼š<br>1. <code>context</code>ï¼š<code>ActivityThread::performLaunchActivity()</code>ä¸­åˆ›å»ºçš„<code>Activity Context</code>ã€‚<br>2. <code>aThread</code>ï¼š<code>ActivityThread</code>ç±»å‹ï¼Œä¸»çº¿ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹éƒ½å…±ç”¨ä¸€ä¸ªã€‚<br>3. <code>token</code>ï¼šæ„å»º<code>ActivityRecord</code>æ—¶ç”Ÿæˆçš„<code>token</code>ã€‚<br>4. <code>application</code>ï¼š<code>Application</code>ç¬¬ä¸€æ¬¡çš„æ—¶å€™åˆ›å»ºä¸€éã€‚<br>5. <code>intent</code>ï¼šå°†è¦å¯åŠ¨çš„ActivityRecordä¸­çš„intentã€‚<br>6. <code>info</code>ï¼š<code>ActivityInfo</code>ç±»å‹ï¼Œå°†è¦å¯åŠ¨çš„ActivityRecordä¸­çš„<code>ActivityInfo</code>ã€‚</p>
</li>
<li><p><code>Instrumentation::callActivityOnCreate()</code>ï¼š<br>å‚æ•°ï¼ˆéƒ¨åˆ†ï¼‰ï¼š<br>1. <code>activity</code>ï¼š<code>ActivityThread::performLaunchActivity()</code>ä¸­åˆ›å»ºçš„<code>Activity</code>ã€‚</p>
</li>
<li><p><code>Activity::performCreate()</code></p>
</li>
<li><p><code>Activity::onCreate()</code></p>
</li>
</ul>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> launcher </tag>
            
            <tag> source code </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]Androidç³»ç»Ÿå¯åŠ¨æµç¨‹æºç åˆ†æ]]></title>
      <url>/2015/12/02/Android-Android%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</url>
      <content type="html"><![CDATA[<h3 id="Androidç³»ç»Ÿå¯åŠ¨æµç¨‹æºç åˆ†æ"><a href="#Androidç³»ç»Ÿå¯åŠ¨æµç¨‹æºç åˆ†æ" class="headerlink" title="Androidç³»ç»Ÿå¯åŠ¨æµç¨‹æºç åˆ†æ"></a>Androidç³»ç»Ÿå¯åŠ¨æµç¨‹æºç åˆ†æ</h3><p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œ<code>Android</code>æ˜¯åŸºäº<code>Linux</code>çš„ï¼Œå½“<code>Linux</code>å†…æ ¸åŠ è½½å®Œæˆæ—¶å°±ä¼šè‡ªåŠ¨å¯åŠ¨ä¸€ä¸ª<code>init</code>çš„è¿›ç¨‹ã€‚<br>åˆå› ä¸ºæˆ‘ä»¬æ¯å½“æˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªAppæ—¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„<code>dalvik</code>å®ä¾‹ï¼Œå¹¶å¤„äºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼ˆå½“ç„¶ä¸€ä¸ªAppä¹Ÿå¯èƒ½æ˜¯å¤šè¿›ç¨‹çš„ï¼‰ã€‚<br>å½“æˆ‘ä»¬æ‰“å¼€ç¬¬ä¸€ä¸ªAppçš„æ—¶å€™ï¼Œå°±ä¼šé€šè¿‡<code>init</code>è¿›ç¨‹forkå‡ºä¸€ä¸ª<code>zygote</code>è¿›ç¨‹ã€‚ä¹‹åæ‰“å¼€æ–°çš„Appçš„æ—¶å€™éƒ½ä¼š<code>fork</code>ä¹‹å‰çš„<code>zygote</code>è¿›ç¨‹ã€‚</p>
<p>å½“<code>fork</code>ä¸€ä¸ª<code>zygote</code>è¿›ç¨‹æ—¶ï¼Œä¼šè¿›å…¥<code>com.android.internal.os.ZygoteInit</code>çš„<code>main</code>æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼š</p>
<ul>
<li><p>é¢„åŠ è½½èµ„æº</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">preloadClasses();</span><br><span class="line">preloadResources();</span><br><span class="line">preloadOpenGL();</span><br><span class="line">preloadSharedLibraries();</span><br><span class="line">preloadTextResources();</span><br><span class="line"><span class="comment">// Ask the WebViewFactory to do any initialization that must run in the zygote process,</span></span><br><span class="line"><span class="comment">// for memory sharing purposes.</span></span><br><span class="line">WebViewFactory.prepareWebViewInZygote();</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ä»ç¬¬ä¸€ä¸ª<code>zygote</code>è¿›ç¨‹<code>fork</code>å‡º<code>SystemServer</code>è¿›ç¨‹ï¼Œè¿™ä¸ªè¿›ç¨‹æä¾›å„ç§<code>ManagerService</code>ã€‚</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">startSystemServer(abiList, socketName);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">startSystemServer</span><span class="params">(String abiList, String socketName)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> MethodAndArgsCaller, RuntimeException </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> pid;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	String args[] = &#123;</span><br><span class="line">            <span class="string">"--setuid=1000"</span>,</span><br><span class="line">            <span class="string">"--setgid=1000"</span>,</span><br><span class="line">            <span class="string">"--setgroups=1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1018,1021,1032,3001,3002,3003,3006,3007"</span>,</span><br><span class="line">            <span class="string">"--capabilities="</span> + capabilities + <span class="string">","</span> + capabilities,</span><br><span class="line">            <span class="string">"--nice-name=system_server"</span>,</span><br><span class="line">            <span class="string">"--runtime-args"</span>,</span><br><span class="line">            <span class="string">"com.android.server.SystemServer"</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="comment">/* Request to fork the system server process */</span></span><br><span class="line">    pid = Zygote.forkSystemServer(</span><br><span class="line">            parsedArgs.uid, parsedArgs.gid,</span><br><span class="line">            parsedArgs.gids,</span><br><span class="line">            parsedArgs.debugFlags,</span><br><span class="line">            <span class="keyword">null</span>,</span><br><span class="line">            parsedArgs.permittedCapabilities,</span><br><span class="line">            parsedArgs.effectiveCapabilities);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Forkå®Œ<code>SystemServer</code>è¿›ç¨‹ä¹‹åï¼Œç»§ç»­æ¥ä¸‹æ¥åœ¨<code>handleSystemServerProcess</code>æ–¹æ³•ä¸­ä¼ å…¥å‚æ•°åˆ°<code>SystemServer</code>ï¼š</li>
<li><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RuntimeInit.zygoteInit(parsedArgs.targetSdkVersion, parsedArgs.remainingArgs, cl);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>æ³¨æ„ï¼Œè¿™é‡Œä¼ å…¥çš„å‚æ•°æ˜¯fork<code>SystemServer</code>è¿›ç¨‹åå‰©ä¸‹çš„å‚æ•°ï¼ˆ<code>parsedArgs.remainingArgs</code>ï¼‰ï¼Œå…¶å®åªå‰©ä¸‹äº†<code>com.android.server.SystemServer</code>è¿™ä¸ªå‚æ•°äº†ã€‚</p>
<p>æ¥ä¸‹æ¥ç»§ç»­è°ƒç”¨<code>applicationInit</code> ï¼Œä¼ å…¥å‚æ•°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">applicationInit</span><span class="params">(<span class="keyword">int</span> targetSdkVersion, String[] argv, ClassLoader classLoader)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ZygoteInit.MethodAndArgsCaller </span>&#123;</span><br><span class="line">	<span class="keyword">final</span> Arguments args;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	args = <span class="keyword">new</span> Arguments(argv);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è§£ææˆ<code>Arguments</code>åï¼Œå¾—åˆ°äº†ä¸€ä¸ª<code>startClass</code>å¯¹è±¡ï¼Œè¿™ä¸ª<code>startClass</code>å…¶å®å°±æ˜¯åˆšåˆšçš„é‚£ä¸ª<code>com.android.server.SystemServer</code>ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œç»§ç»­è°ƒç”¨ <code>invokeStaticMain</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">invokeStaticMain</span><span class="params">(String className, String[] argv, ClassLoader classLoader)</span> <span class="keyword">throws</span> ZygoteInit.MethodAndArgsCaller </span>&#123;</span><br><span class="line">	Class&lt;?&gt; cl;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	cl = Class.forName(className, <span class="keyword">true</span>, classLoader);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	m = cl.getMethod(<span class="string">"main"</span>, <span class="keyword">new</span> Class[] &#123; String[].class &#125;);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">throw</span> <span class="keyword">new</span> ZygoteInit.MethodAndArgsCaller(m, argv);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°±æ˜¯è°ƒç”¨é€šè¿‡åå°„å¾—åˆ°<code>com.android.server.SystemServer</code>ï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢çš„<code>startClass</code>ï¼‰çš„<code>main(argv[])</code>æ–¹æ³•ï¼Œç„¶åæ‰‹åŠ¨æŠ›ä¸€ä¸ªæºå¸¦äº†è¿™ä¸ª<code>main(argv[])</code>æ–¹æ³•çš„<code>MethodAndArgsCaller</code>å¼‚å¸¸ï¼Œä½†æ˜¯è¿™ä¸ªå¼‚å¸¸æ˜¯åœ¨<code>ZygoteInit.main()</code>æ–¹æ³•ä¸­è¢«catchï¼Œç„¶åå»è°ƒç”¨å®ƒçš„<code>run()</code>æ–¹æ³•ï¼Œå½“ç„¶è¿™ä¸ª<code>run()</code>æ–¹æ³•ä¸­ä¼šå†å»é€šè¿‡åå°„è°ƒç”¨æºå¸¦çš„<code>main()</code>æ–¹æ³•ï¼ˆè¿™ä¸ªç»•æ³•çœŸæ˜¯æœ‰ç‚¹å‘çˆ¹ï¼ï¼ã€‚ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MethodAndArgsCaller</span> <span class="keyword">extends</span> <span class="title">Exception</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	    mMethod.invoke(<span class="keyword">null</span>, <span class="keyword">new</span> Object[] &#123; mArgs &#125;);</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»•äº†è¿™ä¹ˆä¸€å¤§åœˆï¼Œç»ˆäºé€šè¿‡<code>MethodAndArgsCaller</code>è°ƒç”¨<code>SystemServer</code>çš„<code>main()</code>æ–¹æ³•äº†ï¼Œä»£ç å¾ˆç®€å•ï¼Œç›´æ¥<code>new</code>äº†ä¹‹å<code>run</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> SystemServer().run();</span><br></pre></td></tr></table></figure>
<p>æ¥ç€ï¼Œæˆ‘ä»¬çœ‹<code>SystemServer</code>çš„<code>run</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ... (çœç•¥åˆå§‹åŒ–å½“å‰çš„languageã€localeã€countryã€æŒ‡çº¹ã€ç”¨æˆ·ç­‰ä¿¡æ¯çš„åˆå§‹åŒ–å‡†å¤‡å·¥ä½œ)</span></span><br><span class="line"><span class="comment">// è®¾ç½®å½“å‰è¿›ç¨‹è®¾ç½®ä¼˜å…ˆçº§ä¸ºTHREAD_PRIORITY_FOREGROUNDï¼ˆ-2ï¼‰</span></span><br><span class="line">android.os.Process.setThreadPriority(</span><br><span class="line">    android.os.Process.THREAD_PRIORITY_FOREGROUND);</span><br><span class="line">android.os.Process.setCanSelfBackground(<span class="keyword">false</span>);</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ä¸»çº¿ç¨‹Looper</span></span><br><span class="line">Looper.prepareMainLooper();</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// å¯åŠ¨æ¶ˆæ¯å¾ªç¯</span></span><br><span class="line">Looper.loop()</span><br></pre></td></tr></table></figure>
<p>ç„¶åè°ƒç”¨<code>createSystemContext()</code>æ–¹æ³•åˆ›å»ºåˆå§‹åŒ–<code>system context</code>ï¼Œè¿™ä¸ªå¾…ä¼šå†å±•å¼€ã€‚</p>
<p>åˆ›å»º<code>SystemServiceManager</code>ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mSystemServiceManager = <span class="keyword">new</span> SystemServiceManager(mSystemContext);</span><br><span class="line">LocalServices.addService(SystemServiceManager.class, mSystemServiceManager);</span><br></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨<code>SystemServiceManager</code>å»é€šè¿‡ä»¥ä¸‹æ–¹æ³•åˆ›å»ºå¯åŠ¨å„ä¸ª<code>Service</code>ï¼š<br>1. startBootstrapServices()ï¼š</p>
<ul>
<li><code>com.android.server.pm.Installer</code>ï¼šæä¾›å®‰è£…ã€å¸è½½Appç­‰æœåŠ¡</li>
<li><code>com.android.server.am.ActivityServiceManager</code>ï¼šæä¾›Activityç­‰ç»„ä»¶çš„ç®¡ç†çš„æœåŠ¡ï¼Œè¿™ä¸ªæ¯”è¾ƒå¤æ‚æš‚ä¸”å†æŒ–ä¸ªå‘ã€‚</li>
<li><code>com.android.server.power.PowerManagerService</code>ï¼šç”µæºç®¡ç†çš„æœåŠ¡ã€‚</li>
<li><code>com.android.server.lights.LightsService</code>ï¼šLEDç®¡ç†å’ŒèƒŒå…‰æ˜¾ç¤ºçš„æœåŠ¡ã€‚</li>
<li><code>com.android.server.display.DisplayManagerService</code>ï¼šæä¾›æ˜¾ç¤ºçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œæ ¹æ®ç‰©ç†æ˜¾ç¤ºè®¾å¤‡å½“å‰çš„æƒ…å†µå†³å®šæ˜¾ç¤ºé…ç½®ï¼Œåœ¨çŠ¶æ€æ”¹å˜æ—¶å‘é€é€šçŸ¥ç»™ç³»ç»Ÿå’Œåº”ç”¨ç­‰æœåŠ¡ã€‚</li>
<li><code>com.android.server.pm.PackageManagerService</code>ï¼šç®¡ç†æ‰€æœ‰çš„<code>.apk</code>ã€‚</li>
<li><code>com.android.server.pm.UserManagerService</code>ï¼šæä¾›ç”¨æˆ·ç›¸å…³æœåŠ¡ã€‚</li>
<li>é€šè¿‡<code>startSensorService()</code>æœ¬åœ°æ–¹æ³•å¯åŠ¨SensoræœåŠ¡ã€‚</li>
</ul>
<p>2. startCoreServices();</p>
<ul>
<li><code>com.android.server.BatteryService</code>ï¼šç”µé‡æœåŠ¡ï¼Œéœ€è¦<code>LightService</code>ã€‚</li>
<li><code>com.android.server.usage.UsageStatsService</code>ï¼šæä¾›æ”¶é›†ç»Ÿè®¡åº”ç”¨ç¨‹åºæ•°æ®ä½¿ç”¨çŠ¶æ€çš„æœåŠ¡ã€‚</li>
<li><code>com.android.server.webkit.WebViewUpdateService</code>ï¼šç§æœ‰çš„æœåŠ¡ï¼ˆ@hideï¼‰ï¼Œç”¨äº<code>WebView</code>çš„æ›´æ–°ã€‚</li>
</ul>
<p>3. startOtherServices();</p>
<ul>
<li><code>com.android.server.accounts.AccountManagerService</code>ï¼šæä¾›æ‰€æœ‰è´¦å·ã€å¯†ç ã€è®¤è¯ç®¡ç†ç­‰ç­‰çš„æœåŠ¡ã€‚</li>
<li><code>com.android.server.content.ContentService</code>ï¼šç”¨æˆ·æ•°æ®åŒæ­¥çš„æœåŠ¡ã€‚</li>
<li><code>com.android.server.VibratorService</code>ï¼šéœ‡åŠ¨æœåŠ¡ã€‚</li>
<li><code>IAlarmManager</code>ï¼šæé†’æœåŠ¡ã€‚</li>
<li><code>android.os.storage.IMountService</code>ï¼šå­˜å‚¨ç®¡ç†æœåŠ¡ã€‚</li>
<li><code>com.android.server.NetworkManagementService</code>ï¼šç³»ç»Ÿç½‘ç»œè¿æ¥ç®¡ç†æœåŠ¡ã€‚</li>
<li><code>com.android.server.net.NetworkStatsService</code>ï¼šæ”¶é›†ç»Ÿè®¡è¯¦ç»†çš„ç½‘ç»œæ•°æ®æœåŠ¡ã€‚</li>
<li><code>com.android.server.net.NetworkPolicyManagerService</code>ï¼šæä¾›ä½ç½‘ç»œç­–ç•¥è§„åˆ™ç®¡ç†æœåŠ¡ã€‚</li>
<li><code>com.android.server.ConnectivityService</code>ï¼šæä¾›æ•°æ®è¿æ¥æœåŠ¡ã€‚</li>
<li><code>com.android.server.NetworkScoreService</code>ï¼š<code>android.net.NetworkScoreManager</code>çš„å¤‡ä»½æœåŠ¡ã€‚</li>
<li><code>com.android.server.NsdService</code>ï¼šç½‘ç»œå‘ç°æœåŠ¡ï¼ˆNetwork Service Discovery Serviceï¼‰ã€‚</li>
<li><code>com.android.server.wm.WindowManagerService</code>ï¼šçª—å£ç®¡ç†æœåŠ¡ã€‚</li>
<li><code>com.android.server.usb.UsbService</code>ï¼šUSBæœåŠ¡ã€‚</li>
<li><code>com.android.server.SerialService</code>ï¼šä¸²å£æœåŠ¡ã€‚</li>
<li><code>com.android.server.NetworkTimeUpdateService</code>ï¼šç½‘ç»œæ—¶é—´åŒæ­¥æœåŠ¡ã€‚</li>
<li><code>com.android.server.CommonTimeManagementService</code>ï¼šç®¡ç†æœ¬åœ°å¸¸è§çš„æ—¶é—´é…ç½®çš„æœåŠ¡ï¼Œå½“ç½‘ç»œé…ç½®å˜åŒ–æ—¶ä¼šé‡æ–°é…ç½®æœ¬åœ°æœåŠ¡ã€‚</li>
<li><code>com.android.server.input.InputManagerService</code>ï¼šäº‹ä»¶ä¼ é€’åˆ†å‘æœåŠ¡ã€‚</li>
<li><code>com.android.server.TelephonyRegistry</code>ï¼šæä¾›ç”µè¯æ³¨å†Œç®¡ç†çš„æœåŠ¡ã€‚</li>
<li><code>com.android.server.ConsumerIrService</code>ï¼šè¿œç¨‹æ§åˆ¶æœåŠ¡ã€‚</li>
<li><code>com.android.server.audio.AudioService</code>ï¼šéŸ³é‡ã€é“ƒå£°ã€å£°é“ç­‰ç®¡ç†æœåŠ¡ã€‚</li>
<li><code>com.android.server.MmsServiceBroker</code>ï¼š<code>MmsService</code>çš„ä»£ç†ï¼Œå› ä¸º<code>MmsService</code>è¿è¡Œåœ¨ç”µè¯è¿›ç¨‹ä¸­ï¼Œå¯èƒ½éšæ—¶crashï¼Œå®ƒä¼šé€šè¿‡ä¸€ä¸ª<code>connection</code>ä¸<code>MmsService</code>å»ºç«‹ä¸€ä¸ªæ¡¥æ¢ï¼Œ<code>MmsService</code>å®ç°äº†å…¬å¼€çš„<code>SMS/MMS</code>çš„APIã€‚</li>
<li><code>TelecomLoaderService</code></li>
<li><code>CameraService</code></li>
<li><code>AlarmManagerService</code></li>
<li><code>BluetoothService</code></li>
<li>è¿˜æœ‰å…¶å®ƒå¾ˆå¤šå¾ˆå¤šServiceï¼Œè¿™æ–¹æ³•ç«Ÿç„¶æœ‰è¿‘1000è¡Œâ€¦â€¦</li>
</ul>
<p>åœ¨<code>startOtherServices()</code>æ–¹æ³•çš„æœ€åï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mActivityManagerService.systemReady(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// ä¸‹é¢ä»ç„¶æ˜¯å„ç§Serviceçš„å¯åŠ¨...</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨è¿™ä¸ªæ–¹æ³•ç”¨æ¥å‘Šè¯‰<code>ActivityManagerService</code>ï¼Œæ­¤æ—¶å¯ä»¥è¿è¡Œç¬¬ä¸‰æ–¹çš„ä»£ç äº†ï¼ˆæ³¨æ„ï¼šè¿™é‡Œçš„Homeç•Œé¢ã€Launcherç­‰å†…ç½®çš„Appä¹Ÿç®—æ˜¯ç¬¬ä¸‰æ–¹çš„Appï¼‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">systemReady</span><span class="params">(<span class="keyword">final</span> Runnable goingCallback)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">if</span> (mSystemReady) &#123;</span><br><span class="line">		<span class="comment">// å›è°ƒåˆ°SystemServerï¼Œç»§ç»­å¯åŠ¨å„ç§Service</span></span><br><span class="line">		<span class="keyword">if</span> (goingCallback != <span class="keyword">null</span>) &#123;</span><br><span class="line">		    goingCallback.run();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">	ResolveInfo ri = mContext.getPackageManager().resolveActivity(<span class="keyword">new</span> Intent(Intent.ACTION_FACTORY_TEST), STOCK_PM_FLAGS);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	ActivityInfo ai = ri.activityInfo;</span><br><span class="line">	ApplicationInfo app = ai.applicationInfo;</span><br><span class="line">	<span class="comment">// ...ä»PackageManagerä¸­è·å–è¦æ‰“å¼€çš„HomeActivity</span></span><br><span class="line">	mTopComponent = <span class="keyword">new</span> ComponentName(app.packageName, ai.name);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="comment">// å¯åŠ¨ç¬¬ä¸€ä¸ªHomeç•Œé¢</span></span><br><span class="line">	startHomeActivityLocked(mCurrentUserId, <span class="string">"systemReady"</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="comment">// å¹¿æ’­é€šçŸ¥å¯åŠ¨å®Œæˆ</span></span><br><span class="line">	broadcastIntentLocked(<span class="comment">/*...*/</span>, mCurrentUserId);</span><br><span class="line">	broadcastIntentLocked(<span class="comment">/*...*/</span>, UserHandle.USER_ALL);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨Homeç•Œé¢çš„<code>startHomeActivityLocked</code>æ–¹æ³•ï¼Œè°ƒç”¨<code>mStackSupervisor</code>å¯åŠ¨<code>HomeActivity</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">startHomeActivityLocked</span><span class="params">(<span class="keyword">int</span> userId, String reason)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	Intent intent = getHomeIntent();</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	intent.setFlags(intent.getFlags() | Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">	mStackSupervisor.startHomeActivity(intent, aInfo, reason);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Intent <span class="title">getHomeIntent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Intent intent = <span class="keyword">new</span> Intent(mTopAction, mTopData != <span class="keyword">null</span> ? Uri.parse(mTopData) : <span class="keyword">null</span>);</span><br><span class="line">	<span class="comment">// è®¾ç½®å‰é¢è·å–åˆ°çš„mTopComponent</span></span><br><span class="line">	intent.setComponent(mTopComponent);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	intent.addCategory(Intent.CATEGORY_HOME);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œ<code>SystemServer</code> startå®Œæ¯•ï¼Œå¹¶ä¸”å¯åŠ¨äº†Homeç•Œé¢ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å†å›è¿‡å¤´å»çœ‹çœ‹åœ¨æˆ‘ä»¬å‰é¢åˆ›å»ºç³»ç»Ÿçº§çš„<code>Context</code>ï¼ˆ<code>createSystemContext</code>ï¼‰çš„æ—¶å€™åšäº†ä»€ä¹ˆï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ActivityThread activityThread = ActivityThread.systemMain();</span><br><span class="line">mSystemContext = activityThread.getSystemContext();</span><br><span class="line">mSystemContext.setTheme(android.R.style.Theme_DeviceDefault_Light_DarkActionBar);</span><br></pre></td></tr></table></figure></p>
<p>é¦–å…ˆè°ƒç”¨äº†<code>ActivityThread</code>çš„é™æ€æ–¹æ³•<code>systemMain()</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ActivityThread <span class="title">systemMain</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">    ActivityThread thread = <span class="keyword">new</span> ActivityThread();</span><br><span class="line">    thread.attach(<span class="keyword">true</span>);</span><br><span class="line">    <span class="keyword">return</span> thread;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºä¸€ä¸ª<code>ActivityThread</code>ï¼Œç„¶åè°ƒç”¨å®ƒçš„<code>attach()</code>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">thread.attach(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(<span class="keyword">boolean</span> system)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!system) &#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		mInstrumentation = <span class="keyword">new</span> Instrumentation();</span><br><span class="line">        ContextImpl context = ContextImpl.createAppContext(<span class="keyword">this</span>, getSystemContext().mPackageInfo);</span><br><span class="line">        mInitialApplication = context.mPackageInfo.makeApplication(<span class="keyword">true</span>, <span class="keyword">null</span>);</span><br><span class="line">        mInitialApplication.onCreate();</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‚æ•°<code>system</code>è¡¨ç¤ºï¼Œæ˜¯å¦æ˜¯ç³»ç»Ÿçº§çš„çº¿ç¨‹ï¼Œç°åœ¨æˆ‘ä»¬æ˜¯å¯åŠ¨æ•´ä¸ªAndroidç³»ç»Ÿï¼Œæ˜¾ç„¶å½“å‰ä¼ å…¥çš„å‚æ•°ä¸º<code>true</code>ã€‚æ‰€ä»¥è¿›å…¥elseï¼Œé¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª<code>Instrumentation</code>ï¼Œ<code>Instrumentation</code>æ˜¯ä»€ä¹ˆï¼Ÿæš‚æ—¶å…ˆæŒ–ä¸ªå‘ã€‚æ¥ç€é€šè¿‡<code>System Context</code>åˆ›å»ºä¸€ä¸ª<code>ContextImpl</code>ï¼Œç„¶åä½¿ç”¨å®ƒçš„<code>LoadedApk::makeApplication</code>æ–¹æ³•æ¥åˆ›å»ºæ•´ä¸ªåº”ç”¨çš„<code>Application</code>å¯¹è±¡ï¼Œç„¶åè°ƒç”¨<code>Application</code>çš„<code>onCreate</code>æ–¹æ³•ã€‚</p>
<p>ç„¶åçœ‹ä¸‹<code>LoadedApk::makeApplication</code>æ–¹æ³•çš„å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Application <span class="title">makeApplication</span><span class="params">(<span class="keyword">boolean</span> forceDefaultAppClass,</span></span></span><br><span class="line"><span class="function"><span class="params">            Instrumentation instrumentation)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// åªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨makeApplicationæ‰ä¼šå¾€ä¸‹æ‰§è¡Œ</span></span><br><span class="line">	<span class="keyword">if</span> (mApplication != <span class="keyword">null</span>) &#123;</span><br><span class="line">	    <span class="keyword">return</span> mApplication;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç³»ç»Ÿçš„Applicationï¼Œæ‰€ä»¥appClassæ˜¯"android.app.Application"</span></span><br><span class="line">	String appClass = mApplicationInfo.className;</span><br><span class="line">    <span class="keyword">if</span> (forceDefaultAppClass || (appClass == <span class="keyword">null</span>)) &#123;</span><br><span class="line">        appClass = <span class="string">"android.app.Application"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	ContextImpl appContext = ContextImpl.createAppContext(mActivityThread, <span class="keyword">this</span>);</span><br><span class="line">    app = mActivityThread.mInstrumentation.newApplication(</span><br><span class="line">            cl, appClass, appContext);</span><br><span class="line">    appContext.setOuterContext(app);</span><br><span class="line">	<span class="comment">// ...	</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ›å»º<code>appContext</code>ï¼Œç„¶åé€šè¿‡<code>Instrumentation</code>ç”Ÿæˆ<code>Application</code>å¯¹è±¡ï¼Œå¹¶ç»™<code>appContext</code>è®¾ç½®å¤–éƒ¨å¼•ç”¨ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> launcher </tag>
            
            <tag> source code </tag>
            
            <tag> system </tag>
            
            <tag> linux </tag>
            
            <tag> process </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidå°æŠ€å·§]]></title>
      <url>/2015/11/26/Android%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
      <content type="html"><![CDATA[<p>Activity.startActivities()) å¸¸ç”¨äºåœ¨åº”ç”¨ç¨‹åºä¸­é—´å¯åŠ¨å…¶ä»–çš„Activity.<br>TextUtils.isEmpty()) ç®€å•çš„å·¥å…·ç±»,ç”¨äºæ£€æµ‹æ˜¯å¦ä¸ºç©º<br>Html.fromHtml()) ç”¨äºç”Ÿæˆä¸€ä¸ªHtml,å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸².ä¸ªäººè®¤ä¸ºå®ƒä¸æ˜¯å¾ˆå¿«,æ‰€ä»¥æˆ‘ä¸æ€ä¹ˆç»å¸¸å»ç”¨.ï¼ˆæˆ‘è¯´ä¸ç»å¸¸ç”¨å®ƒæ˜¯ä¸ºäº†é‡ç‚¹çªå‡ºè¿™å¥è¯ï¼šè¯·å¤šæ‰‹åŠ¨æ„å»º Spannable æ¥æ›¿æ¢ Html.fromHtmlï¼‰ï¼Œä½†æ˜¯å®ƒå¯¹æ¸²æŸ“ä» web ä¸Šè·å–çš„æ–‡å­—è¿˜æ˜¯å¾ˆä¸é”™çš„ã€‚<br>TextView.setError() åœ¨éªŒè¯ç”¨æˆ·è¾“å…¥çš„æ—¶å€™å¾ˆæ£’<br>Build.VERSION_CODES è¿™ä¸ªæ ‡æ˜äº†å½“å‰çš„ç‰ˆæœ¬å·,åœ¨å¤„ç†å…¼å®¹æ€§é—®é¢˜çš„æ—¶å€™ç»å¸¸ä¼šç”¨åˆ°.ç‚¹è¿›å»å¯ä»¥çœ‹åˆ°å„ä¸ªç‰ˆæœ¬çš„ä¸åŒç‰¹æ€§<br>Log.getStackTraceString()) æ–¹ä¾¿çš„æ—¥å¿—ç±»å·¥å…·,æ–¹æ³•Log.v()ã€Log.d()ã€Log.i()ã€Log.w()å’ŒLog.e()éƒ½æ˜¯å°†ä¿¡æ¯æ‰“å°åˆ°LogCatä¸­ï¼Œæœ‰æ—¶å€™éœ€è¦å°†å‡ºé”™çš„ä¿¡æ¯æ’å…¥åˆ°æ•°æ®åº“æˆ–ä¸€ä¸ªè‡ªå®šä¹‰çš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µå°±éœ€è¦å°†å‡ºé”™çš„ä¿¡æ¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›æ¥ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨static String getStackTraceString(Throwable tr)æ–¹æ³•çš„æ—¶å€™.<br>LayoutInflater.from() é¡¾åæ€ä¹‰,ç”¨äºInflateä¸€ä¸ªlayout,å‚æ•°æ˜¯layoutçš„id.è¿™ä¸ªç»å¸¸å†™Adapterçš„äººä¼šç”¨çš„æ¯”è¾ƒå¤š.<br>ViewConfiguration.getScaledTouchSlop() ä½¿ç”¨ ViewConfiguration ä¸­æä¾›çš„å€¼ä»¥ä¿è¯æ‰€æœ‰è§¦æ‘¸çš„äº¤äº’éƒ½æ˜¯ç»Ÿä¸€çš„ã€‚è¿™ä¸ªæ–¹æ³•è·å–çš„å€¼è¡¨ç¤º:ç”¨æˆ·çš„æ‰‹æ»‘åŠ¨è¿™ä¸ªè·ç¦»å,æ‰åˆ¤å®šä¸ºæ­£åœ¨è¿›è¡Œæ»‘åŠ¨.å½“ç„¶è¿™ä¸ªå€¼ä¹Ÿå¯ä»¥è‡ªå·±æ¥å†³å®š.ä½†æ˜¯ä¸ºäº†ä¸€è‡´æ€§,è¿˜æ˜¯ä½¿ç”¨æ ‡å‡†çš„å€¼è¾ƒå¥½.<br>PhoneNumberUtils.convertKeypadLettersToDigits é¡¾åæ€ä¹‰.å°†å­—æ¯è½¬æ¢ä¸ºæ•°å­—,ç±»ä¼¼äºT9è¾“å…¥æ³•,<br>Context.getCacheDir() è·å–ç¼“å­˜æ•°æ®æ–‡ä»¶å¤¹çš„è·¯å¾„,å¾ˆç®€å•ä½†æ˜¯çŸ¥é“çš„äººä¸å¤š,è¿™ä¸ªè·¯å¾„é€šå¸¸åœ¨SDå¡ä¸Š(è¿™é‡Œçš„SDå¡æŒ‡çš„æ˜¯å¹¿ä¹‰ä¸Šçš„SDå¡,åŒ…æ‹¬å¤–éƒ¨å­˜å‚¨å’Œå†…éƒ¨å­˜å‚¨)Adnroid/data/æ‚¨çš„åº”ç”¨ç¨‹åºåŒ…å/cache/ ä¸‹é¢.æµ‹è¯•çš„æ—¶å€™,å¯ä»¥å»è¿™é‡Œé¢çœ‹æ˜¯å¦ç¼“å­˜æˆåŠŸ.ç¼“å­˜åœ¨è¿™é‡Œçš„å¥½å¤„æ˜¯:ä¸ç”¨è‡ªå·±å†å»æ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶å¤¹,ä¸ç”¨æ‹…å¿ƒç”¨æˆ·æŠŠè‡ªå·±åˆ›å»ºçš„æ–‡ä»¶å¤¹åˆ æ‰,åœ¨åº”ç”¨ç¨‹åºå¸è½½çš„æ—¶å€™,è¿™é‡Œä¼šè¢«æ¸…ç©º,ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„æ¸…ç†å·¥å…·çš„æ—¶å€™,è¿™é‡Œä¹Ÿä¼šè¢«æ¸…ç©º.<br>ArgbEvaluator ç”¨äºå¤„ç†é¢œè‰²çš„æ¸å˜ã€‚å°±åƒ Chris Banes è¯´çš„ä¸€æ ·ï¼Œè¿™ä¸ªç±»ä¼šè¿›è¡Œå¾ˆå¤šè‡ªåŠ¨è£…ç®±çš„æ“ä½œï¼Œæ‰€ä»¥æœ€å¥½è¿˜æ˜¯å»æ‰å®ƒçš„é€»è¾‘è‡ªå·±å»å®ç°å®ƒã€‚è¿™ä¸ªæ²¡ç”¨è¿‡,ä¸æ˜å…¶æ‰€ä»¥ç„¶,å›å¤´å†è¡¥å…….<br>ContextThemeWrapper æ–¹ä¾¿åœ¨è¿è¡Œçš„æ—¶å€™ä¿®æ”¹ä¸»é¢˜.<br>Space spaceæ˜¯Android 4.0ä¸­æ–°å¢çš„ä¸€ä¸ªæ§ä»¶ï¼Œå®ƒå®é™…ä¸Šå¯ä»¥ç”¨æ¥åˆ†éš”ä¸åŒçš„æ§ä»¶ï¼Œå…¶ä¸­å½¢æˆä¸€ä¸ªç©ºç™½çš„åŒºåŸŸ.è¿™æ˜¯ä¸€ä¸ªè½»é‡çº§çš„è§†å›¾ç»„ä»¶ï¼Œå®ƒå¯ä»¥è·³è¿‡Drawï¼Œå¯¹äºéœ€è¦å ä½ç¬¦çš„ä»»ä½•åœºæ™¯æ¥è¯´éƒ½æ˜¯å¾ˆæ£’çš„ã€‚<br>ValueAnimator.reverse() è¿™ä¸ªæ–¹æ³•å¯ä»¥å¾ˆé¡ºåˆ©åœ°å–æ¶ˆæ­£åœ¨è¿è¡Œçš„åŠ¨ç”».æˆ‘è¶…å–œæ¬¢.</p>
<p>DateUtils.formatDateTime() ç”¨æ¥è¿›è¡ŒåŒºåŸŸæ ¼å¼åŒ–å·¥ä½œ,è¾“å‡ºæ ¼å¼åŒ–å’Œæœ¬åœ°åŒ–çš„æ—¶é—´æˆ–è€…æ—¥æœŸ.<br>AlarmManager.setInexactRepeating) é€šè¿‡é—¹é“ƒåˆ†ç»„çš„æ–¹å¼çœç”µ,å³ä½¿ä½ åªè°ƒç”¨äº†ä¸€ä¸ªé—¹é’Ÿ,è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©,ï¼ˆå¯ä»¥ç¡®ä¿åœ¨ä½¿ç”¨å®Œæ¯•æ—¶è‡ªåŠ¨è°ƒç”¨ AlarmManager.cancel ()ã€‚åŸæ–‡è¯´çš„æ¯”è¾ƒæŠ½è±¡,è¿™é‡Œè¯¦ç»†è¯´ä¸€ä¸‹:setInexactRepeatingæŒ‡çš„æ˜¯è®¾ç½®éå‡†ç¡®é—¹é’Ÿ,ä½¿ç”¨æ–¹æ³•:alarmManager.setInexactRepeating(AlarmManager.RTC, startTime,intervalL, pendingIntent),éå‡†ç¡®é—¹é’Ÿåªèƒ½ä¿è¯å¤§è‡´çš„æ—¶é—´é—´éš”ï¼Œä½†æ˜¯ä¸ä¸€å®šå‡†ç¡®ï¼Œå¯èƒ½å‡ºç°è®¾ç½®é—´éš”ä¸º30åˆ†é’Ÿï¼Œä½†æ˜¯å®é™…ä¸Šä¸€æ¬¡é—´éš”20åˆ†é’Ÿï¼Œå¦ä¸€æ¬¡é—´éš”40åˆ†é’Ÿã€‚å®ƒçš„æœ€å¤§çš„å¥½å¤„æ˜¯å¯ä»¥åˆå¹¶é—¹é’Ÿäº‹ä»¶ï¼Œæ¯”å¦‚é—´éš”è®¾ç½®æ¯30åˆ†é’Ÿä¸€æ¬¡ï¼Œä¸å”¤é†’ä¼‘çœ ï¼Œåœ¨ä¼‘çœ 8å°æ—¶åå·²ç»ç§¯ç´¯äº†16ä¸ªé—¹é’Ÿäº‹ä»¶ï¼Œè€Œåœ¨æ‰‹æœºè¢«å”¤é†’çš„æ—¶å€™ï¼Œéå‡†æ—¶é—¹é’Ÿå¯ä»¥æŠŠ16ä¸ªäº‹ä»¶åˆå¹¶ä¸ºä¸€ä¸ª, æ‰€ä»¥è¿™ä¹ˆçœ‹æ¥,éå‡†æ—¶é—¹é’Ÿä¸€èˆ¬æ¥è¯´æ¯”è¾ƒèŠ‚çº¦èƒ½æº.<br>Formatter.formatFileSize()) ä¸€ä¸ªåŒºåŸŸåŒ–çš„æ–‡ä»¶å¤§å°æ ¼å¼åŒ–å·¥å…·ã€‚é€šä¿—æ¥è¯´å°±æ˜¯æŠŠå¤§å°è½¬æ¢ä¸ºMB,G,KBä¹‹ç±»çš„å­—ç¬¦ä¸².<br>ActionBar.hide())/.show()) é¡¾åæ€ä¹‰,éšè—å’Œæ˜¾ç¤ºActionBar,å¯ä»¥ä¼˜é›…åœ°åœ¨å…¨å±å’Œå¸¦Actionbarä¹‹é—´è½¬æ¢.<br>Linkify.addLinks()) åœ¨Textä¸Šæ·»åŠ é“¾æ¥.å¾ˆå®ç”¨.<br>StaticLayout åœ¨è‡ªå®šä¹‰ View ä¸­æ¸²æŸ“æ–‡å­—çš„æ—¶å€™å¾ˆå®ç”¨ã€‚<br>Activity.onBackPressed()) å¾ˆæ–¹ä¾¿çš„ç®¡ç†backé”®çš„æ–¹æ³•,æœ‰æ—¶å€™éœ€è¦è‡ªå·±æ§åˆ¶è¿”å›é”®çš„äº‹ä»¶çš„æ—¶å€™,å¯ä»¥é‡å†™ä¸€ä¸‹.æ¯”å¦‚åŠ å…¥ â€œç‚¹ä¸¤ä¸‹backé”®é€€å‡ºâ€ åŠŸèƒ½.<br>GestureDetector ç”¨æ¥ç›‘å¬å’Œç›¸åº”å¯¹åº”çš„æ‰‹åŠ¿äº‹ä»¶,æ¯”å¦‚ç‚¹å‡»,é•¿æŒ‰,æ…¢æ»‘åŠ¨,å¿«æ»‘åŠ¨,ç”¨èµ·æ¥å¾ˆç®€å•,æ¯”ä½ è‡ªå·±å®ç°è¦æ–¹ä¾¿è®¸å¤š.<br>DrawFilter å¯ä»¥è®©ä½ åœ¨ä¸è°ƒç”¨onDrewæ–¹æ³•çš„æƒ…å†µä¸‹,æ“ä½œcanvas,æ¯”äº†ä¸ªå¦‚,ä½ å¯ä»¥åœ¨åˆ›å»ºè‡ªå®šä¹‰ View çš„æ—¶å€™è®¾ç½®ä¸€ä¸ª DrawFilterï¼Œç»™çˆ¶ View é‡Œé¢çš„æ‰€æœ‰ View è®¾ç½®ååˆ«åã€‚<br>ActivityManager.getMemoryClass()) å‘Šè¯‰ä½ ä½ çš„æœºå™¨è¿˜æœ‰å¤šå°‘å†…å­˜,åœ¨è®¡ç®—ç¼“å­˜å¤§å°çš„æ—¶å€™ä¼šæ¯”è¾ƒæœ‰ç”¨.<br>ViewStub å®ƒæ˜¯ä¸€ä¸ªåˆå§‹åŒ–ä¸åšä»»ä½•äº‹æƒ…çš„ Viewï¼Œä½†æ˜¯ä¹‹åå¯ä»¥è½½å…¥ä¸€ä¸ªå¸ƒå±€æ–‡ä»¶ã€‚åœ¨æ…¢åŠ è½½ View ä¸­å¾ˆé€‚åˆåšå ä½ç¬¦ã€‚å”¯ä¸€çš„ç¼ºç‚¹å°±æ˜¯ä¸æ”¯æŒæ ‡ç­¾ï¼Œæ‰€ä»¥å¦‚æœä½ ä¸å¤ªå°å¿ƒçš„è¯ï¼Œå¯èƒ½ä¼šåœ¨è§†å›¾ç»“æ„ä¸­åŠ å…¥ä¸éœ€è¦çš„åµŒå¥—ã€‚<br>SystemClock.sleep()) è¿™ä¸ªæ–¹æ³•åœ¨ä¿è¯ä¸€å®šæ—¶é—´çš„ sleep æ—¶å¾ˆæ–¹ä¾¿ï¼Œé€šå¸¸æˆ‘ç”¨æ¥è¿›è¡Œ debug å’Œæ¨¡æ‹Ÿç½‘ç»œå»¶æ—¶ã€‚<br>DisplayMetrics.density è¿™ä¸ªæ–¹æ³•ä½ å¯ä»¥è·å–è®¾å¤‡åƒç´ å¯†åº¦,å¤§éƒ¨åˆ†æ—¶å€™æœ€å¥½è®©ç³»ç»Ÿæ¥è‡ªåŠ¨è¿›è¡Œç¼©æ”¾èµ„æºä¹‹ç±»çš„æ“ä½œ,ä½†æ˜¯æœ‰æ—¶å€™æ§åˆ¶çš„æ•ˆæœä¼šæ›´å¥½ä¸€äº›.(å°¤å…¶æ˜¯åœ¨è‡ªå®šä¹‰Viewçš„æ—¶å€™).<br>Pair.create()) æ–¹ä¾¿æ„å»ºç±»å’Œæ„é€ å™¨çš„æ–¹æ³•ã€‚</p>
<p>UrlQuerySanitizerâ€”â€”ä½¿ç”¨è¿™ä¸ªå·¥å…·å¯ä»¥æ–¹ä¾¿å¯¹ URL è¿›è¡Œæ£€æŸ¥ã€‚<br>Fragment.setArgumentsâ€”â€”å› ä¸ºåœ¨æ„å»º Fragment çš„æ—¶å€™ä¸èƒ½åŠ å‚æ•°ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸ªå¾ˆå¥½çš„ä¸œè¥¿ï¼Œå¯ä»¥åœ¨åˆ›å»º Fragment ä¹‹å‰è®¾ç½®å‚æ•°ï¼ˆå³ä½¿åœ¨ configuration æ”¹å˜çš„æ—¶å€™ä»ç„¶ä¼šå¯¼è‡´é”€æ¯/é‡å»ºï¼‰ã€‚<br>DialogFragment.setShowsDialog ()â€”â€” è¿™æ˜¯ä¸€ä¸ªå¾ˆå·§å¦™çš„æ–¹å¼ï¼ŒDialogFragment å¯ä»¥ä½œä¸ºæ­£å¸¸çš„ Fragment æ˜¾ç¤ºï¼è¿™é‡Œå¯ä»¥è®© Fragment æ‰¿æ‹…åŒé‡ä»»åŠ¡ã€‚æˆ‘é€šå¸¸åœ¨åˆ›å»º Fragment çš„æ—¶å€™æŠŠ onCreateView ()å’Œ onCreateDialog ()éƒ½åŠ ä¸Šï¼Œå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªå…·æœ‰åŒé‡ç›®çš„çš„ Fragmentã€‚<br>FragmentManager.enableDebugLogging ()â€”â€”åœ¨éœ€è¦è§‚å¯Ÿ Fragment çŠ¶æ€çš„æ—¶å€™ä¼šæœ‰å¸®åŠ©ã€‚<br>LocalBroadcastManagerâ€”â€”è¿™ä¸ªä¼šæ¯”å…¨å±€çš„ broadcast æ›´åŠ å®‰å…¨ï¼Œç®€å•ï¼Œå¿«é€Ÿã€‚åƒ otto è¿™æ ·çš„ Event buses æœºåˆ¶å¯¹ä½ çš„åº”ç”¨åœºæ™¯æ›´åŠ æœ‰ç”¨ã€‚<br>PhoneNumberUtils.formatNumber ()â€”â€”é¡¾åæ€ä¹‰ï¼Œè¿™æ˜¯å¯¹æ•°å­—è¿›è¡Œæ ¼å¼åŒ–æ“ä½œçš„æ—¶å€™ç”¨çš„ã€‚<br>Region.op()â€”â€”æˆ‘å‘ç°åœ¨å¯¹æ¯”ä¸¤ä¸ªæ¸²æŸ“ä¹‹å‰çš„åŒºåŸŸçš„æ—¶å€™å¾ˆå®ç”¨ï¼Œå¦‚æœä½ æœ‰ä¸¤æ¡è·¯å¾„ï¼Œé‚£ä¹ˆæ€ä¹ˆçŸ¥é“å®ƒä»¬æ˜¯ä¸æ˜¯ä¼šé‡å å‘¢ï¼Ÿä½¿ç”¨è¿™ä¸ªæ–¹æ³•å°±å¯ä»¥åšåˆ°ã€‚<br>Application.registerActivityLifecycleCallbacksâ€”â€”è™½ç„¶ç¼ºå°‘å®˜æ–¹æ–‡æ¡£è§£é‡Šï¼Œä¸è¿‡æˆ‘æƒ³å®ƒå°±æ˜¯æ³¨å†Œ Activity çš„ç”Ÿå‘½å‘¨æœŸçš„ä¸€äº›å›è°ƒæ–¹æ³•ï¼ˆé¡¾åæ€ä¹‰ï¼‰ï¼Œå°±æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„å·¥å…·ã€‚<br>versionNameSuffixâ€”â€”è¿™ä¸ª gradle è®¾ç½®å¯ä»¥è®©ä½ åœ¨åŸºäºä¸åŒæ„å»ºç±»å‹çš„ manifest ä¸­ä¿®æ”¹ç‰ˆæœ¬åè¿™ä¸ªå±æ€§ï¼Œä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦åœ¨åœ¨ debug ç‰ˆæœ¬ä¸­ä»¥â€-SNAPSHOTâ€ç»“å°¾ï¼Œé‚£ä¹ˆå°±å¯ä»¥è½»æ¾çš„çœ‹å‡ºå½“å‰æ˜¯ debug ç‰ˆè¿˜æ˜¯ release ç‰ˆã€‚<br>CursorJoinerâ€”â€”å¦‚æœä½ æ˜¯åªä½¿ç”¨ä¸€ä¸ªæ•°æ®åº“çš„è¯ï¼Œä½¿ç”¨ SQL ä¸­çš„ join å°±å¯ä»¥äº†ï¼Œä½†æ˜¯å¦‚æœæ”¶åˆ°çš„æ•°æ®æ˜¯æ¥è‡ªä¸¤ä¸ªç‹¬ç«‹çš„ ContentProviderï¼Œé‚£ä¹ˆ CursorJoiner å°±å¾ˆå®ç”¨äº†ã€‚<br>Genymotionâ€”â€”ä¸€ä¸ªéå¸¸å¿«çš„ Android æ¨¡æ‹Ÿå™¨ï¼Œæœ¬äººä¸€ç›´åœ¨ç”¨ã€‚<br>-nodpiâ€”â€”åœ¨æ²¡æœ‰ç‰¹åˆ«å®šä¹‰çš„æƒ…å†µä¸‹ï¼Œå¾ˆå¤šä¿®é¥°ç¬¦(-mdpi,-hdpi,-xdpiç­‰ç­‰)éƒ½ä¼šé»˜è®¤è‡ªåŠ¨ç¼©æ”¾ assets/dimensionsï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä¿æŒæ˜¾ç¤ºä¸€è‡´ï¼Œè¿™ç§æƒ…å†µä¸‹å°±å¯ä»¥ä½¿ç”¨ -nodpiã€‚<br>BroadcastRecevier.setDebugUnregister ()â€”â€”åˆä¸€ä¸ªæ–¹ä¾¿çš„è°ƒè¯•å·¥å…·ã€‚<br>Activity.recreate ()â€”â€”å¼ºåˆ¶è®© Activity é‡å»ºã€‚<br>PackageManager.checkSignatures ()â€”â€”å¦‚æœåŒæ—¶å®‰è£…äº†ä¸¤ä¸ª app çš„è¯ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ£€æŸ¥ã€‚å¦‚æœä¸è¿›è¡Œç­¾åæ£€æŸ¥çš„è¯ï¼Œå…¶ä»–äººå¯ä»¥è½»æ˜“é€šè¿‡ä½¿ç”¨ä¸€æ ·çš„åŒ…åæ¥æ¨¡ä»¿ä½ çš„ appã€‚</p>
<p>Activity.isChangingConfigurations ()â€”â€”å¦‚æœåœ¨ Activity ä¸­ configuration ä¼šç»å¸¸æ”¹å˜çš„è¯ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•å°±å¯ä»¥ä¸ç”¨æ‰‹åŠ¨åšä¿å­˜çŠ¶æ€çš„å·¥ä½œäº†ã€‚<br>SearchRecentSuggestionsProviderâ€”â€”å¯ä»¥åˆ›å»ºæœ€è¿‘æç¤ºæ•ˆæœçš„ providerï¼Œæ˜¯ä¸€ä¸ªç®€å•å¿«é€Ÿçš„æ–¹æ³•ã€‚<br>ViewTreeObserverâ€”â€”è¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„å·¥å…·ã€‚å¯ä»¥è¿›å…¥åˆ° VIew é‡Œé¢ï¼Œå¹¶ç›‘æ§ View ç»“æ„çš„å„ç§çŠ¶æ€ï¼Œé€šå¸¸æˆ‘éƒ½ç”¨æ¥åš View çš„æµ‹é‡æ“ä½œï¼ˆè‡ªå®šä¹‰è§†å›¾ä¸­ç»å¸¸ç”¨åˆ°ï¼‰ã€‚<br>org.gradle.daemon=trueâ€”â€”è¿™å¥è¯å¯ä»¥å¸®åŠ©å‡å°‘ Gradle æ„å»ºçš„æ—¶é—´ï¼Œä»…åœ¨å‘½ä»¤è¡Œç¼–è¯‘çš„æ—¶å€™ç”¨åˆ°ï¼Œå› ä¸º Android Studio å·²ç»è¿™æ ·ä½¿ç”¨äº†ã€‚<br>DatabaseUtilsâ€”â€”ä¸€ä¸ªåŒ…å«å„ç§æ•°æ®åº“æ“ä½œçš„ä½¿ç”¨å·¥å…·ã€‚<br>android:weightSum (LinearLayout)â€”â€”å¦‚æœæƒ³ä½¿ç”¨ layout weightsï¼Œä½†æ˜¯å´ä¸æƒ³å¡«å……æ•´ä¸ª LinearLayout çš„è¯ï¼Œå°±å¯ä»¥ç”¨ weightSum æ¥å®šä¹‰æ€»çš„ weight å¤§å°ã€‚<br>android:duplicateParentState (View)â€”â€”æ­¤æ–¹æ³•å¯ä»¥ä½¿å¾—å­ View å¯ä»¥å¤åˆ¶çˆ¶ View çš„çŠ¶æ€ã€‚æ¯”å¦‚å¦‚æœä¸€ä¸ª ViewGroup æ˜¯å¯ç‚¹å‡»çš„ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•åœ¨å®ƒè¢«ç‚¹å‡»çš„æ—¶å€™è®©å®ƒçš„å­ View éƒ½æ”¹å˜çŠ¶æ€ã€‚<br>android:clipChildren (ViewGroup)â€”â€”å¦‚æœæ­¤å±æ€§è®¾ç½®ä¸ºä¸å¯ç”¨ï¼Œé‚£ä¹ˆ ViewGroup çš„å­ View åœ¨ç»˜åˆ¶çš„æ—¶å€™ä¼šè¶…å‡ºå®ƒçš„èŒƒå›´ï¼Œåœ¨åšåŠ¨ç”»çš„æ—¶å€™éœ€è¦ç”¨åˆ°ã€‚<br>android:fillViewport (ScrollView)â€”â€”åœ¨è¿™ç‰‡æ–‡ç« ä¸­æœ‰è¯¦ç»†ä»‹ç»æ–‡ç« é“¾æ¥ï¼Œå¯ä»¥è§£å†³åœ¨ ScrollView ä¸­å½“å†…å®¹ä¸è¶³çš„æ—¶å€™å¡«ä¸æ»¡å±å¹•çš„é—®é¢˜ã€‚<br>android:tileMode (BitmapDrawable)â€”â€”å¯ä»¥æŒ‡å®šå›¾ç‰‡ä½¿ç”¨é‡å¤å¡«å……çš„æ¨¡å¼ã€‚<br>android:enterFadeDuration/android:exitFadeDuration (Drawables)â€”â€”æ­¤å±æ€§åœ¨ Drawable å…·æœ‰å¤šç§çŠ¶æ€çš„æ—¶å€™ï¼Œå¯ä»¥å®šä¹‰å®ƒå±•ç¤ºå‰çš„æ·¡å…¥æ·¡å‡ºæ•ˆæœã€‚<br>android:scaleType (ImageView)â€”â€”å®šä¹‰åœ¨ ImageView ä¸­æ€ä¹ˆç¼©æ”¾/å‰ªè£å›¾ç‰‡ï¼Œä¸€èˆ¬ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯â€œcenterCropâ€å’Œâ€œcenterInsideâ€ã€‚<br>Mergeâ€”â€”æ­¤æ ‡ç­¾å¯ä»¥åœ¨å¦ä¸€ä¸ªå¸ƒå±€æ–‡ä»¶ä¸­åŒ…å«åˆ«çš„å¸ƒå±€æ–‡ä»¶ï¼Œè€Œä¸ç”¨å†æ–°å»ºä¸€ä¸ª ViewGroupï¼Œå¯¹äºè‡ªå®šä¹‰ ViewGroup çš„æ—¶å€™ä¹Ÿéœ€è¦ç”¨åˆ°ï¼›å¯ä»¥é€šè¿‡è½½å…¥ä¸€ä¸ªå¸¦æœ‰æ ‡ç­¾çš„å¸ƒå±€æ–‡ä»¶æ¥è‡ªåŠ¨å®šä¹‰å®ƒçš„å­éƒ¨ä»¶ã€‚<br>AtomicFileâ€”â€”é€šè¿‡ä½¿ç”¨å¤‡ä»½æ–‡ä»¶è¿›è¡Œæ–‡ä»¶çš„åŸå­åŒ–æ“ä½œã€‚è¿™ä¸ªçŸ¥è¯†ç‚¹ä¹‹å‰æˆ‘ä¹Ÿå†™è¿‡ï¼Œä¸è¿‡æœ€å¥½è¿˜æ˜¯æœ‰å‡ºä¸€ä¸ªå®˜æ–¹çš„ç‰ˆæœ¬æ¯”è¾ƒå¥½ã€‚</p>
<p>ViewDragHelper â€”â€”è§†å›¾æ‹–åŠ¨æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„é—®é¢˜ã€‚è¿™ä¸ªç±»å¯ä»¥å¸®åŠ©è§£å†³ä¸å°‘é—®é¢˜ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªä¾‹å­ï¼ŒDrawerLayoutå°±æ˜¯åˆ©ç”¨å®ƒå®ç°æ‰«æ»‘ã€‚Flavient Laurent è¿˜å†™äº†ä¸€äº›å…³äºè¿™æ–¹é¢çš„ä¼˜ç§€æ–‡ç« ã€‚<br>PopupWindowâ€”â€”Androidåˆ°å¤„éƒ½åœ¨ä½¿ç”¨PopupWindow ï¼Œç”šè‡³ä½ éƒ½æ²¡æœ‰æ„è¯†åˆ°ï¼ˆæ ‡é¢˜å¯¼èˆªæ¡ActionBarï¼Œè‡ªåŠ¨è¡¥å…¨AutoCompleteï¼Œç¼–è¾‘æ¡†é”™è¯¯æé†’Edittext Errorsï¼‰ã€‚è¿™ä¸ªç±»æ˜¯åˆ›å»ºæµ®å±‚å†…å®¹çš„ä¸»è¦æ–¹æ³•ã€‚<br>Actionbar.getThemrContext()â€”â€”å¯¼èˆªæ çš„ä¸»é¢˜åŒ–æ˜¯å¾ˆå¤æ‚çš„ï¼ˆä¸åŒäºActivityå…¶ä»–éƒ¨åˆ†çš„ä¸»é¢˜åŒ–ï¼‰ã€‚ä½ å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ï¼Œç”¨è¿™ä¸ªä¸Šä¸‹æ–‡åˆ›å»ºçš„è‡ªå®šä¹‰ç»„ä»¶å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ä¸»é¢˜ã€‚<br>ThumbnailUtilsâ€”â€”å¸®åŠ©åˆ›å»ºç¼©ç•¥å›¾ã€‚é€šå¸¸æˆ‘éƒ½æ˜¯ç”¨ç°æœ‰çš„å›¾ç‰‡åŠ è½½åº“ï¼ˆæ¯”å¦‚ï¼ŒPicasso æˆ–è€… Volleyï¼‰ï¼Œä¸è¿‡è¿™ä¸ªThumbnaiUtilså¯ä»¥åˆ›å»ºè§†é¢‘ç¼©ç•¥å›¾ã€‚è¯‘è€…æ³¨ï¼šè¯¥APIä»V8æ‰å¼€å§‹æ”¯æŒã€‚<br>Context.getExternalFilesDir()â€”â€”â€”â€” ç”³è¯·äº†SDå¡å†™æƒé™åï¼Œä½ å¯ä»¥åœ¨SDçš„ä»»ä½•åœ°æ–¹å†™æ•°æ®ï¼ŒæŠŠä½ çš„æ•°æ®å†™åœ¨è®¾è®¡å¥½çš„åˆé€‚ä½ç½®ä¼šæ›´åŠ æœ‰ç¤¼è²Œã€‚è¿™æ ·æ•°æ®å¯ä»¥åŠæ—¶è¢«æ¸…ç†ï¼Œä¹Ÿä¼šæœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚æ­¤å¤–ï¼ŒAndroid 4.0 Kitkatä¸­åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹å†™æ•°æ®æ˜¯ä¸éœ€è¦æƒé™çš„ï¼Œæ¯ä¸ªç”¨æˆ·æœ‰è‡ªå·±çš„ç‹¬ç«‹çš„æ•°æ®å­˜å‚¨è·¯å¾„ã€‚è¯‘è€…æ³¨ï¼šè¯¥APIä»V8æ‰å¼€å§‹æ”¯æŒã€‚<br>SparseArrayâ€”â€”Mapçš„é«˜æ•ˆä¼˜åŒ–ç‰ˆæœ¬ã€‚æ¨èäº†è§£å§å¦¹ç±»SparseBooleanArrayã€SparseIntArrayå’ŒSparseLongArrayã€‚<br>PackageManager.setComponentEnabledSetting()â€”â€”å¯ä»¥ç”¨æ¥å¯åŠ¨æˆ–è€…ç¦ç”¨ç¨‹åºæ¸…å•ä¸­çš„ç»„ä»¶ã€‚å¯¹äºå…³é—­ä¸éœ€è¦çš„åŠŸèƒ½ç»„ä»¶æ˜¯éå¸¸èµçš„ï¼Œæ¯”å¦‚å…³æ‰ä¸€ä¸ªå½“å‰ä¸ç”¨çš„å¹¿æ’­æ¥æ”¶å™¨ã€‚<br>SQLiteDatabase.yieldIfContendedSafely()â€”â€”è®©ä½ æš‚æ—¶åœæ­¢ä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡ï¼Œ è¿™æ ·ä½ å¯ä»¥å°±ä¸ä¼šå ç”¨å¤ªå¤šçš„ç³»ç»Ÿèµ„æºã€‚<br>Environment.getExternalStoragePublicDirectory()â€”â€”è¿˜æ˜¯é‚£å¥è¯ï¼Œç”¨æˆ·æœŸæœ›åœ¨SDå¡ä¸Šå¾—åˆ°ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒã€‚ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥è·å¾—åœ¨ç”¨æˆ·è®¾å¤‡ä¸Šæ”¾ç½®æŒ‡å®šç±»å‹æ–‡ä»¶ï¼ˆéŸ³ä¹ã€å›¾ç‰‡ç­‰ï¼‰çš„æ­£ç¡®ç›®å½•ã€‚<br>View.generateViewId()â€”â€”æ¯æ¬¡æˆ‘éƒ½æƒ³è¦æ¨èåŠ¨æ€ç”Ÿæˆæ§ä»¶çš„IDã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸è¦å’Œå·²ç»å­˜åœ¨çš„æ§ä»¶IDæˆ–è€…å…¶ä»–å·²ç»ç”Ÿæˆçš„æ§ä»¶IDé‡å¤ã€‚<br>ActivityManager.clearApplicationUserData()â€”â€” ä¸€é”®æ¸…ç†ä½ çš„appäº§ç”Ÿçš„ç”¨æˆ·æ•°æ®ï¼Œå¯èƒ½æ˜¯åšç”¨æˆ·é€€å‡ºç™»å½•åŠŸèƒ½ï¼Œæœ‰å²ä»¥æ¥æœ€ç®€å•çš„æ–¹å¼äº†ã€‚<br>Context.createConfigurationContext() â€”â€”è‡ªå®šä¹‰ä½ çš„é…ç½®ç¯å¢ƒä¿¡æ¯ã€‚æˆ‘é€šå¸¸ä¼šé‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼šå¼ºåˆ¶è®©ä¸€éƒ¨åˆ†æ˜¾ç¤ºåœ¨æŸä¸ªç‰¹å®šçš„ç¯å¢ƒä¸‹ï¼ˆå€’ä¸æ˜¯æˆ‘ä¸€ç›´è¿™æ ·çæ•´ï¼Œè¯´æ¥è¯é•¿ï¼Œä½ å¾ˆéš¾ç†è§£ï¼‰ã€‚ç”¨è¿™ä¸ªå®ç°èµ·æ¥å¯ä»¥ç¨å¾®ç®€å•ä¸€ç‚¹ã€‚<br>ActivityOptions â€”â€”æ–¹ä¾¿çš„å®šä¹‰ä¸¤ä¸ªActivityåˆ‡æ¢çš„åŠ¨ç”»ã€‚ ä½¿ç”¨ActivityOptionsCompat å¯ä»¥å¾ˆå¥½è§£å†³æ—§ç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜ã€‚<br>AdapterViewFlipper.fyiWillBeAdvancedByHostKThx()â€”â€”ä»…ä»…å› ä¸ºå¾ˆå¥½ç©ï¼Œæ²¡æœ‰å…¶ä»–åŸå› ã€‚åœ¨æ•´ä¸ªå®‰å“å¼€æºé¡¹ç›®ä¸­ï¼ˆAOSP the Android â€”â€”pen Source Project Androidå¼€æ”¾æºä»£ç é¡¹ç›®ï¼‰ä¸­è¿˜æœ‰å…¶ä»–å¾ˆæœ‰æ„æ€çš„ä¸œè¥¿ï¼ˆæ¯”å¦‚<br>GRAVITY_DEATH_STAR_Iï¼‰ã€‚ä¸è¿‡ï¼Œéƒ½ä¸åƒè¿™ä¸ªè¿™æ ·ï¼Œè¿™ä¸ªç¡®å®æœ‰ç”¨<br>ViewParent.requestDisallowInterceptTouchEvent() â€”â€”Androidç³»ç»Ÿè§¦æ‘¸äº‹ä»¶æœºåˆ¶å¤§å¤šæ—¶å€™èƒ½å¤Ÿé»˜è®¤å¤„ç†ï¼Œä¸è¿‡æœ‰æ—¶å€™ä½ éœ€è¦ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¥å‰¥å¤ºçˆ¶çº§æ§ä»¶çš„æ§åˆ¶æƒï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå¦‚æœä½ æƒ³å¯¹Androidè§¦æ‘¸æœºåˆ¶äº†è§£æ›´å¤šï¼Œè¿™ä¸ªæ¼”è®²ä¼šä»¤ä½ æƒŠå¹ä¸å·²ã€‚ï¼‰</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> tips </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]Activityå¯åŠ¨è¿‡ç¨‹]]></title>
      <url>/2015/11/10/Android-Activity%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/</url>
      <content type="html"><![CDATA[<h3 id="Androidç³»ç»Ÿå¯åŠ¨åŠ è½½æµç¨‹ï¼š"><a href="#Androidç³»ç»Ÿå¯åŠ¨åŠ è½½æµç¨‹ï¼š" class="headerlink" title="Androidç³»ç»Ÿå¯åŠ¨åŠ è½½æµç¨‹ï¼š"></a>Androidç³»ç»Ÿå¯åŠ¨åŠ è½½æµç¨‹ï¼š</h3><p><a href="http://i11.tietuku.com/0582844414810f38.png" target="_blank" rel="noopener">å‚è€ƒå›¾</a></p>
<ul>
<li>Linuxå†…æ ¸åŠ è½½å®Œæ¯• </li>
<li>å¯åŠ¨<code>init</code>è¿›ç¨‹ </li>
<li><code>init</code>è¿›ç¨‹forkå‡º<code>zygote</code>è¿›ç¨‹</li>
<li><code>zygote</code>è¿›ç¨‹åœ¨<code>ZygoteInit.main()</code>ä¸­è¿›è¡Œåˆå§‹åŒ–çš„æ—¶å€™forkå‡º<code>SystemServer</code>è¿›ç¨‹</li>
<li><code>SystemServer</code>è¿›ç¨‹å¼€å¯çš„æ—¶å€™åˆå§‹åŒ–<code>ActivityThread</code>å’Œ<code>ActivityManagerService</code>ï¼ˆå…¶å®ƒè¿˜æœ‰<code>PowerManagerService</code>ï¼Œ<code>DisplayManagerService</code>ï¼Œ<code>PackageManagerService</code>ï¼‰</li>
<li>å¯åŠ¨<code>Launcher</code>ï¼Œ<code>Launcher</code>æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªAppï¼Œç»§æ‰¿è‡ª<code>Activity</code></li>
</ul>
<h3 id="Appä¸AMSé€šè¿‡Binderè¿›è¡ŒIPCé€šä¿¡"><a href="#Appä¸AMSé€šè¿‡Binderè¿›è¡ŒIPCé€šä¿¡" class="headerlink" title="Appä¸AMSé€šè¿‡Binderè¿›è¡ŒIPCé€šä¿¡"></a>Appä¸AMSé€šè¿‡Binderè¿›è¡ŒIPCé€šä¿¡</h3><h4 id="å¯åŠ¨ä¸€ä¸ªActivity"><a href="#å¯åŠ¨ä¸€ä¸ªActivity" class="headerlink" title="å¯åŠ¨ä¸€ä¸ªActivity"></a>å¯åŠ¨ä¸€ä¸ªActivity</h4><blockquote>
<p>å®¢æˆ·ç«¯ï¼šActivityManagerProxy â€“&gt; Binderé©±åŠ¨ â€“&gt; ActivityManagerServiceï¼šæœåŠ¡å™¨</p>
</blockquote>
<ul>
<li><strong>ActivityThread</strong><br>è€æ¿ï¼Œè™½ç„¶è¯´å®¶é‡Œçš„äº‹è‡ªå·±è¯´äº†ç®—ï¼Œä½†æ˜¯éœ€è¦å¬ä»AMSçš„æŒ‡æŒ¥</li>
<li><strong>Instrumentation</strong><br>è€æ¿å¨˜ï¼Œè´Ÿè´£å®¶é‡Œçš„å¤§äº‹å°äº‹ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸æŠ›å¤´éœ²é¢ï¼Œå¬ä¸€å®¶ä¹‹ä¸»ActivityThreadçš„å®‰æ’ï¼Œæ¯ä¸ªActivityéƒ½æœ‰ä¸€ä¸ª<code>Instrumentation</code>å¼•ç”¨ï¼Œæ•´ä¸ªè¿›ç¨‹åªæœ‰ä¸€ä¸ª<code>Instrumentation</code>å®ä¾‹</li>
<li><strong>ActivityManagerProxy</strong><br>ActivityManagerNative.getDefault().startActivityè·å–<code>ActivityManagerProxy</code>å¯¹è±¡é€šè¿‡Binder IPCä¸AMSé€šä¿¡</li>
<li><strong>AMS</strong><br>çœŸæ­£å¯åŠ¨ä¸€ä¸ªAtivityï¼ˆ<code>ActivityStackSupervisor</code>, <code>ActivityStack</code>ï¼‰</li>
</ul>
<h4 id="Resumeä¸€ä¸ªActivity"><a href="#Resumeä¸€ä¸ªActivity" class="headerlink" title="Resumeä¸€ä¸ªActivity"></a>Resumeä¸€ä¸ªActivity</h4><blockquote>
<p>å®¢æˆ·ç«¯ï¼šApplicationThread &lt;â€“ Binderé©±åŠ¨ &lt;â€“ ApplicationThreadProxyï¼šæœåŠ¡å™¨</p>
</blockquote>
<ul>
<li><strong>AMS</strong></li>
<li><strong>ApplicationThreadProxy</strong><br><code>ApplicationThreadProxy</code>å¯¹è±¡é€šè¿‡Binder IPCä¸å®¢æˆ·ç«¯é€šä¿¡ã€‚</li>
<li><strong>ApplicationThread</strong></li>
<li><strong>Handler</strong></li>
<li><strong>ActivityThread</strong></li>
<li><strong>Activity</strong><br>è°ƒç”¨onResumeæ–¹æ³•</li>
</ul>
<h3 id="AMS-SystemServerè¿›ç¨‹-ä¸zygoteé€šè¿‡Socketè¿›è¡ŒIPCé€šä¿¡"><a href="#AMS-SystemServerè¿›ç¨‹-ä¸zygoteé€šè¿‡Socketè¿›è¡ŒIPCé€šä¿¡" class="headerlink" title="AMS(SystemServerè¿›ç¨‹)ä¸zygoteé€šè¿‡Socketè¿›è¡ŒIPCé€šä¿¡"></a>AMS(SystemServerè¿›ç¨‹)ä¸zygoteé€šè¿‡Socketè¿›è¡ŒIPCé€šä¿¡</h3><p>å‚è€ƒï¼š<a href="http://blog.csdn.net/zhaokaiqiang1992/article/details/49428287" target="_blank" rel="noopener">http://blog.csdn.net/zhaokaiqiang1992/article/details/49428287</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> activity </tag>
            
            <tag> launcher </tag>
            
            <tag> source code </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€ŠKotliÂ­n for Â­androiÂ­d DeveÂ­lopersÂ­ã€‹ä¸­æ–‡ç¿»è¯‘]]></title>
      <url>/2015/11/05/%E3%80%8AKotli%C2%ADn-for-%C2%ADandroi%C2%ADd-Deve%C2%ADlopers%C2%AD%E3%80%8B%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91/</url>
      <content type="html"><![CDATA[<p>ä¹‹å‰ä¸€ç›´åœ¨å…³æ³¨Kotlinå’ŒAndroidç›¸å…³çš„å¼€å‘ï¼Œå†™è¿‡ä¸¤ç¯‡å…³äºKotlinçš„æ–‡ç« ï¼Œä¸äº†è§£Kotlinçš„å¯ä»¥çœ‹ä¸‹ï¼š</p>
<ul>
<li>[Android]ä½¿ç”¨Kotlin+Ankoå¼€å‘Androidï¼ˆä¸€ï¼‰ï¼š<a href="http://www.cnblogs.com/tiantianbyconan/p/4800656.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4800656.html</a></li>
<li>[Android]ä½¿ç”¨Kotlinå¼€å‘Androidï¼ˆäºŒï¼‰ï¼š<a href="http://www.cnblogs.com/tiantianbyconan/p/4829007.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4829007.html</a></li>
</ul>
<p>åæ¥åœ¨<a href="https://kotlinlang.org/docs/reference/" target="_blank" rel="noopener">Kotlinå®˜ç½‘</a>ä¸Šé¢çœ‹åˆ°äº†è¿™æœ¬ä¹¦ã€ŠKotlin for android developersã€‹ï¼š<br><img src="https://s3.amazonaws.com/titlepages.leanpub.com/kotlin-for-android-developers/large?1445802287]" alt=""></p>
<p>è¿™æœ¬ä¹¦å‘å¸ƒåœ¨<a href="https://leanpub.com/kotlin-for-android-developers" target="_blank" rel="noopener">leanpub</a>ï¼Œå‰ä¸¤å‘¨ä½œè€…å®Œæˆæœ¬ä¹¦åï¼Œæˆ‘å°±è´­ä¹°çœ‹äº†ä¸€éï¼Œé‡Œé¢é€šè¿‡ä¸€ä¸ªå¤©æ°”é¢„æŠ¥çš„Appä¾‹å­è®²è§£äº†åŸºæœ¬ä¸ŠKotlinæ‰€æœ‰çš„è¯­æ³•å’Œç‰¹æ€§ï¼Œè§£å†³äº†å‡ ä¸ªå›°æ‰°æˆ‘å¾ˆä¹…çš„é—®é¢˜ã€‚</p>
<p>åæ¥æ‰“ç®—æŠŠå®ƒç¿»è¯‘æˆä¸­æ–‡ç‰ˆè´¡çŒ®ç»™å¤§å®¶ï¼Œå·²ç»ç¿»è¯‘å®Œæˆï¼š</p>
<p><strong>Gitbookåœ¨çº¿é˜…è¯»æˆ–ä¸‹è½½</strong>ï¼š<a href="https://www.gitbook.com/book/wangjiegulu/kotlin-for-android-developers-zh/details" target="_blank" rel="noopener">https://www.gitbook.com/book/wangjiegulu/kotlin-for-android-developers-zh/details</a><br><strong>Githubåœ°å€</strong>ï¼š<a href="https://github.com/wangjiegulu/kotlin-for-android-developers-zh" target="_blank" rel="noopener">https://github.com/wangjiegulu/kotlin-for-android-developers-zh</a></p>
<p>æœ¬äººæ°´å¹³æœ‰é™ï¼Œå¤§å®¶é‡åˆ°é”™åˆ«å­—ã€ç—…å¥ã€ç¿»è¯‘é”™è¯¯ç­‰é—®é¢˜<a href="https://github.com/wangjiegulu/kotlin-for-android-developers-zh/issues" target="_blank" rel="noopener">å¯ä»¥åœ¨Githubä¸Šæissues</a>ã€‚ä¸è¿‡è¯·è¯´æ˜é”™è¯¯åŸå› ã€‚</p>
<p>å¸Œæœ›å¤§å®¶æ”¯æŒè´­ä¹°åŸç‰ˆï¼š<a href="https://leanpub.com/kotlin-for-android-developers" target="_blank" rel="noopener">https://leanpub.com/kotlin-for-android-developers</a></p>
<h4 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h4><ul>
<li><a href="README.md">Introduction</a></li>
<li><a href="xie_zai_qian_mian.md">å†™åœ¨å‰é¢</a></li>
<li><a href="guan_yu_ben_shu.md">å…³äºæœ¬ä¹¦</a></li>
<li><a href="zhe_ben_shu_shi_he_ni_ma_ff1f.md">è¿™æœ¬ä¹¦é€‚åˆä½ å—ï¼Ÿ</a></li>
<li><a href="guan_yu_zuo_zhe.md">å…³äºä½œè€…</a></li>
<li><a href="jie_shao.md">ä»‹ç»</a><ul>
<li><a href="shi_yao_shi_kotlin.md">ä»€ä¹ˆæ˜¯Kotlinï¼Ÿ</a></li>
<li><a href="wo_men_tong_guo_kotlin_de_dao_shi_yao.md">æˆ‘ä»¬é€šè¿‡Kotlinå¾—åˆ°ä»€ä¹ˆ</a></li>
</ul>
</li>
<li><a href="zhun_bei_gong_zuo.md">å‡†å¤‡å·¥ä½œ</a><ul>
<li><a href="android_studio.md">Android Studio</a></li>
<li><a href="an_zhuang_kotlin_cha_jian.md">å®‰è£…Kotlinæ’ä»¶</a></li>
</ul>
</li>
<li><a href="chuang_jian_yi_ge_xin_de_xiang_mu.md">åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®</a><ul>
<li><a href="zai_android_studio_zhong_chuang_jian_yi_ge_xiang_mu.md">åœ¨Android Studioä¸­åˆ›å»ºä¸€ä¸ªé¡¹ç›®</a></li>
<li><a href="pei_zhi_gradle.md">é…ç½®Gradle</a></li>
<li><a href="ba_mainactivity_zhuan_huan_cheng_kotlin_dai_ma.md">æŠŠMainActivityè½¬æ¢æˆKotlinä»£ç </a></li>
<li><a href="ce_shi_shi_fou_yi_qie_jiu_xu.md">æµ‹è¯•æ˜¯å¦ä¸€åˆ‡å°±ç»ª</a></li>
</ul>
</li>
<li><a href="lei_he_han_shu.md">ç±»å’Œå‡½æ•°</a><ul>
<li><a href="zen_yao_ding_yi_yi_ge_lei.md">æ€ä¹ˆå®šä¹‰ä¸€ä¸ªç±»</a></li>
<li><a href="lei_ji_cheng.md">ç±»ç»§æ‰¿</a></li>
<li><a href="han_shu.md">å‡½æ•°</a></li>
<li><a href="gou_zao_fang_fa_he_han_shu_can_shu.md">æ„é€ æ–¹æ³•å’Œå‡½æ•°å‚æ•°</a></li>
</ul>
</li>
<li><a href="bian_xie_ni_de_di_yi_ge_lei.md">ç¼–å†™ä½ çš„ç¬¬ä¸€ä¸ªç±»</a><ul>
<li><a href="chuang_jian_yi_ge_layout.md">åˆ›å»ºä¸€ä¸ªlayout</a></li>
<li><a href="the_recycler_adapter.md">The Recycler Adapter</a></li>
</ul>
</li>
<li><a href="bian_liang_he_shu_xing.md">å˜é‡å’Œå±æ€§</a><ul>
<li><a href="ji_ben_lei_xing.md">åŸºæœ¬ç±»å‹</a></li>
<li><a href="bian_liang.md">å˜é‡</a></li>
<li><a href="shu_xing.md">å±æ€§</a></li>
</ul>
</li>
<li>Ankoå’Œæ‰©å±•çš„å‡½æ•°<ul>
<li><a href="ankoshi_shi_yao_ff1f.md">Ankoæ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="kai_shi_shi_yong_anko.md">å¼€å§‹ä½¿ç”¨Anko</a></li>
<li><a href="kuo_zhan_han_shu.md">æ‰©å±•å‡½æ•°</a></li>
</ul>
</li>
<li>ä»APIä¸­è·å–æ•°æ®<ul>
<li><a href="zhi_xing_yi_ge_qing_qiu.md">æ‰§è¡Œä¸€ä¸ªè¯·æ±‚</a></li>
<li><a href="zai_zhu_xian_cheng_yi_wai_zhi_xing_qing_qiu.md">åœ¨ä¸»çº¿ç¨‹ä»¥å¤–æ‰§è¡Œè¯·æ±‚</a></li>
</ul>
</li>
<li><a href="shu_ju_lei.md">æ•°æ®ç±»</a><ul>
<li><a href="e_wai_de_han_shu.md">é¢å¤–çš„å‡½æ•°</a></li>
<li><a href="fu_zhi_yi_ge_shu_ju_lei.md">å¤åˆ¶ä¸€ä¸ªæ•°æ®ç±»</a></li>
<li><a href="ying_she_dui_xiang_dao_bian_liang_zhong.md">æ˜ å°„å¯¹è±¡åˆ°å˜é‡ä¸­</a></li>
<li><a href="zhuan_huan_json_dao_shu_ju_lei.md">è½¬æ¢jsonåˆ°æ•°æ®ç±»</a></li>
<li><a href="gou_jiandomain_ceng.md">æ„å»ºdomainå±‚</a></li>
<li><a href="zaiui_zhong_hui_zhi_shu_ju.md">åœ¨UIä¸­ç»˜åˆ¶æ•°æ®</a></li>
</ul>
</li>
<li><a href="cao_zuo_fu_zhong_zai.md">æ“ä½œç¬¦é‡è½½</a><ul>
<li><a href="cao_zuo_fu_biao.md">æ“ä½œç¬¦è¡¨</a></li>
<li><a href="li_zi.md">ä¾‹å­</a></li>
<li><a href="kuo_zhan_han_shu_zhong_de_cao_zuo_fu.md">æ‰©å±•å‡½æ•°ä¸­çš„æ“ä½œç¬¦</a></li>
</ul>
</li>
<li><a href="shi_forecast_list_ke_dian_ji.md">ä½¿Forecast listå¯ç‚¹å‡»</a></li>
<li><a href="lambdas.md">Lambdas</a><ul>
<li><a href="jian_hua_setonclicklistener.md">ç®€åŒ–setOnClickListener()</a></li>
<li><a href="forecastlistadapterde_click_listener.md">ForecastListAdapterçš„click listener</a></li>
<li><a href="kuo_zhan_yu_yan.md">æ‰©å±•è¯­è¨€</a></li>
</ul>
</li>
<li><a href="ke_jian_xing_xiu_shi_fu.md">å¯è§æ€§ä¿®é¥°ç¬¦</a><ul>
<li><a href="xiu_shi_fu.md">ä¿®é¥°ç¬¦</a></li>
<li><a href="gou_zao_qi.md">æ„é€ å™¨</a></li>
<li><a href="zhong_gou_dai_ma.md">é‡æ„ä»£ç </a></li>
</ul>
</li>
<li><a href="kotlin_android_extensions.md">Kotlin Android Extensions</a><ul>
<li><a href="zen_yaoqu_shi_yong_kotlinandroid_extensions.md">æ€ä¹ˆå»ä½¿ç”¨Kotlin Android Extensions</a></li>
<li><a href="zhong_gou_wo_men_de_dai_ma.md">é‡æ„æˆ‘ä»¬çš„ä»£ç </a></li>
</ul>
</li>
<li><a href="applicationdan_li_hua_he_shu_xing_de_delegated.md">Applicationå•ä¾‹åŒ–å’Œå±æ€§çš„Delegated</a><ul>
<li><a href="applicatondan_li_hua.md">Applicatonå•ä¾‹åŒ–</a></li>
<li><a href="wei_tuo_shu_xing.md">å§”æ‰˜å±æ€§</a></li>
<li><a href="biao_zhun_wei_tuo.md">æ ‡å‡†å§”æ‰˜</a></li>
<li><a href="zen_yao_qu_chuang_jian_yi_ge_zi_ding_yi_de_wei_tuo.md">æ€ä¹ˆå»åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„å§”æ‰˜</a></li>
<li><a href="zhong_xin_shixian_application_dan_li_hua.md">é‡æ–°å®ç°Applicationå•ä¾‹åŒ–</a></li>
</ul>
</li>
<li><a href="chuang_jian_yi_ge_sqliteopenhelper.md">åˆ›å»ºä¸€ä¸ªSQLiteOpenHelper</a><ul>
<li><a href="managedsqliteopenhelper.md">ManagedSqliteOpenHelper</a></li>
<li><a href="ding_yi_biao.md">å®šä¹‰è¡¨</a></li>
<li><a href="shi_xian_sqliteopenhelper.md">å®ç°SqliteOpenHelper</a></li>
<li><a href="yi_lai_zhu_ru.md">ä¾èµ–æ³¨å…¥</a></li>
</ul>
</li>
<li><a href="ji_he_he_han_shu_cao_zuo_fu.md">é›†åˆå’Œå‡½æ•°æ“ä½œç¬¦</a><ul>
<li><a href="zong_shu_cao_zuo_fu.md">æ€»æ•°æ“ä½œç¬¦</a></li>
<li><a href="guo_lv_cao_zuo_fu.md">è¿‡æ»¤æ“ä½œç¬¦</a></li>
<li><a href="ying_she_cao_zuo_fu.md">æ˜ å°„æ“ä½œç¬¦</a></li>
<li><a href="yuan_su_cao_zuo_fu.md">å…ƒç´ æ“ä½œç¬¦</a></li>
<li><a href="sheng_chan_cao_zuo_fu.md">ç”Ÿäº§æ“ä½œç¬¦</a></li>
<li><a href="shun_xu_cao_zuo_fu.md">é¡ºåºæ“ä½œç¬¦</a></li>
</ul>
</li>
<li><a href="cong_shu_ju_ku_zhong_bao_cun_huo_cha_xun_shu_ju.md">ä»æ•°æ®åº“ä¸­ä¿å­˜æˆ–æŸ¥è¯¢æ•°æ®</a><ul>
<li><a href="chuang_jian_shu_ju_ku_model_lei.md">åˆ›å»ºæ•°æ®åº“modelç±»</a></li>
<li><a href="xie_ru_he_cha_xun_shu_ju_ku.md">å†™å…¥å’ŒæŸ¥è¯¢æ•°æ®åº“</a></li>
</ul>
</li>
<li><a href="kotlinzhong_de_null_an_quan.md">Kotlinä¸­çš„nullå®‰å…¨</a><ul>
<li><a href="ke_null_lei_xing_zen_yao_gong_zuo.md">å¯nullç±»å‹æ€ä¹ˆå·¥ä½œ</a></li>
<li><a href="ke_null_xing_he_java_ku.md">å¯nullæ€§å’ŒJavaåº“</a></li>
</ul>
</li>
<li><a href="chuang_jian_ye_wu_luo_ji_lai_fang_wen_shu_ju.md">åˆ›å»ºä¸šåŠ¡é€»è¾‘æ¥è®¿é—®æ•°æ®</a></li>
<li><a href="flow_controlhe_ranges.md">Flow controlå’Œranges</a><ul>
<li><a href="ifbiao_da_shi.md">Ifè¡¨è¾¾å¼</a></li>
<li><a href="whenbiao_da_shi.md">Whenè¡¨è¾¾å¼</a></li>
<li><a href="forxun_huan.md">Forå¾ªç¯</a></li>
<li><a href="whilehe_do__while_xun_huan.md">Whileå’Œdo/whileå¾ªç¯</a></li>
<li><a href="ranges.md">Ranges</a></li>
</ul>
</li>
<li><a href="chuang_jian_yi_ge_xiang_qing_jie_mian.md">åˆ›å»ºä¸€ä¸ªè¯¦æƒ…ç•Œé¢</a><ul>
<li><a href="zhun_bei_qing_qiu.md">å‡†å¤‡è¯·æ±‚</a></li>
<li><a href="ti_gong_yige_xin_de_activity.md">æä¾›ä¸€ä¸ªæ–°çš„activity</a></li>
<li><a href="qi_dong_yige_activity__reified_han_shu.md">å¯åŠ¨ä¸€ä¸ªactivityï¼šreifiedå‡½æ•°</a></li>
</ul>
</li>
<li>æ¥å£å’Œå§”æ‰˜<ul>
<li><a href="jie_kou.md">æ¥å£</a></li>
<li><a href="wei_tuo.md">å§”æ‰˜</a></li>
<li><a href="zai_wo_men_de_app_zhong_shi_xian_yi_ge_li_zi.md">åœ¨æˆ‘ä»¬çš„Appä¸­å®ç°ä¸€ä¸ªä¾‹å­</a></li>
</ul>
</li>
<li><a href="fan_xing.md">èŒƒå‹</a><ul>
<li><a href="ji_chu.md">åŸºç¡€</a></li>
<li><a href="bian_ti.md">å˜ä½“</a></li>
<li><a href="fan_xing_li_zi.md">èŒƒå‹ä¾‹å­</a></li>
</ul>
</li>
<li><a href="she_zhi_jie_mian.md">è®¾ç½®ç•Œé¢</a><ul>
<li><a href="chuang_jian_yi_ge_she_zhi_activity.md">åˆ›å»ºä¸€ä¸ªè®¾ç½®activity</a></li>
<li><a href="fang_wen_shared_preferences.md">è®¿é—®Shared Preferences</a></li>
<li><a href="fan_xing_preference_wei_tuo.md">èŒƒå‹preferenceå§”æ‰˜</a></li>
</ul>
</li>
<li><a href="ce_shi_ni_de_app.md">æµ‹è¯•ä½ çš„App</a><ul>
<li><a href="unit_testing.md">Unit testing</a></li>
<li><a href="instrumentation_tests.md">Instrumentation tests</a></li>
</ul>
</li>
<li><a href="qi_ta_de_gai_nian.md">å…¶å®ƒçš„æ¦‚å¿µ</a><ul>
<li><a href="nei_bu_lei.md">å†…éƒ¨ç±»</a></li>
<li><a href="mei_ju.md">æšä¸¾</a></li>
<li><a href="mi_feng_lei.md">å¯†å°ï¼ˆSealedï¼‰ç±»</a></li>
<li><a href="yi_chang_ff08_exceptions.md">å¼‚å¸¸ï¼ˆExceptionsï¼‰</a></li>
</ul>
</li>
<li><a href="jie_wei.md">ç»“å°¾</a></li>
</ul>
]]></content>
      
        
        <tags>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> kotlin </tag>
            
            <tag> KotliÂ­n for android Developers </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä½¿ç”¨Kotlinå¼€å‘Androidï¼ˆäºŒï¼‰]]></title>
      <url>/2015/09/22/Android-%E4%BD%BF%E7%94%A8Kotlin%E5%BC%80%E5%8F%91Android%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>[TOC]</p>
<h2 id="ä½¿ç”¨Kotlinï¼‹OkHttpï¼‹RxJavaè¿›è¡Œç½‘ç»œè¯·æ±‚"><a href="#ä½¿ç”¨Kotlinï¼‹OkHttpï¼‹RxJavaè¿›è¡Œç½‘ç»œè¯·æ±‚" class="headerlink" title="ä½¿ç”¨Kotlinï¼‹OkHttpï¼‹RxJavaè¿›è¡Œç½‘ç»œè¯·æ±‚"></a>ä½¿ç”¨Kotlinï¼‹OkHttpï¼‹RxJavaè¿›è¡Œç½‘ç»œè¯·æ±‚</h2><p>ä»£ç ï¼š<a href="https://github.com/wangjiegulu/KotlinAndroidSample" target="_blank" rel="noopener">https://github.com/wangjiegulu/KotlinAndroidSample</a></p>
<h3 id="1-éœ€è¦"><a href="#1-éœ€è¦" class="headerlink" title="1. éœ€è¦"></a>1. éœ€è¦</h3><ul>
<li>å¯¹<a href="http://kotlinlang.org/" target="_blank" rel="noopener">Kotlin</a>è¯­æ³•æœ‰åŸºæœ¬çš„æŒæ¡</li>
<li>å¯¹<a href="https://github.com/square/okhttp" target="_blank" rel="noopener">OkHttp</a>æœ‰åŸºæœ¬çš„äº†è§£</li>
<li>å¯¹<a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="noopener">RxJava</a> / <a href="https://github.com/ReactiveX/RxAndroid" target="_blank" rel="noopener">RxAndroid</a>æœ‰åŸºæœ¬çš„äº†è§£</li>
</ul>
<h3 id="2-Kotlinæ­å»ºç¯å¢ƒ"><a href="#2-Kotlinæ­å»ºç¯å¢ƒ" class="headerlink" title="2. Kotlinæ­å»ºç¯å¢ƒ"></a>2. Kotlinæ­å»ºç¯å¢ƒ</h3><p>è§ä¹‹å‰çš„æ–‡ç« ï¼š<a href="http://www.cnblogs.com/tiantianbyconan/p/4800656.html" target="_blank" rel="noopener">[Android]ä½¿ç”¨Kotlin+Ankoå¼€å‘Androidï¼ˆä¸€ï¼‰</a></p>
<h3 id="3-Gradleæ·»åŠ ç›¸å…³ä¾èµ–åŒ…ï¼š"><a href="#3-Gradleæ·»åŠ ç›¸å…³ä¾èµ–åŒ…ï¼š" class="headerlink" title="3. Gradleæ·»åŠ ç›¸å…³ä¾èµ–åŒ…ï¼š"></a>3. Gradleæ·»åŠ ç›¸å…³ä¾èµ–åŒ…ï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">compile &quot;org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version&quot;</span><br><span class="line">compile &quot;org.jetbrains.kotlin:kotlin-reflect:$kotlin_version&quot;</span><br><span class="line">compile &apos;com.squareup.okhttp:okhttp:2.4.0&apos;</span><br><span class="line">compile &apos;io.reactivex:rxjava:1.0.12&apos;</span><br><span class="line">compile &apos;io.reactivex:rxandroid:0.24.0&apos;</span><br></pre></td></tr></table></figure>
<h3 id="4-è¯·æ±‚"><a href="#4-è¯·æ±‚" class="headerlink" title="4. è¯·æ±‚"></a>4. è¯·æ±‚</h3><p>ä¸€èˆ¬çš„å†™æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Observable.defer(&#123; -&gt;</span><br><span class="line">                Observable.just(OkHttpClient().newCall(</span><br><span class="line">                        Request.Builder()</span><br><span class="line">                                .url(<span class="string">"https://github.com/wangjiegulu"</span>)</span><br><span class="line">                                .<span class="keyword">get</span>()</span><br><span class="line">                                .build()</span><br><span class="line">                ).execute())</span><br><span class="line">            &#125;).subscribeOn(Schedulers.newThread())</span><br><span class="line">                    .map(&#123;r -&gt; r.body().string()&#125;)</span><br><span class="line">            .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">            .subscribe(&#123; result -&gt; Log.d(TAG, <span class="string">"request result: <span class="variable">$result</span>"</span>); resultTv.setText(<span class="string">"Http request succeed, see log"</span>) &#125;, &#123;throwable -&gt; Log.e(TAG, <span class="string">""</span>, throwable)&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="5-ä½¿ç”¨Kotlinè¯­æ³•ç³–è¿›è¡Œç®€åŒ–"><a href="#5-ä½¿ç”¨Kotlinè¯­æ³•ç³–è¿›è¡Œç®€åŒ–" class="headerlink" title="5. ä½¿ç”¨Kotlinè¯­æ³•ç³–è¿›è¡Œç®€åŒ–"></a>5. ä½¿ç”¨Kotlinè¯­æ³•ç³–è¿›è¡Œç®€åŒ–</h3><h4 id="1-åœ¨Stringç±»ä¸­æ‰©å±•httpè¯·æ±‚æ–¹æ³•"><a href="#1-åœ¨Stringç±»ä¸­æ‰©å±•httpè¯·æ±‚æ–¹æ³•" class="headerlink" title="1) åœ¨Stringç±»ä¸­æ‰©å±•httpè¯·æ±‚æ–¹æ³•"></a>1) åœ¨Stringç±»ä¸­æ‰©å±•httpè¯·æ±‚æ–¹æ³•</h4><p>æˆ‘ä»¬å¸Œæœ›åœ¨urlï¼ˆStringï¼‰ä¸­å¢åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œç›´æ¥è°ƒç”¨åæ„å»ºä¸€ä¸ªhttpè¯·æ±‚ï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">request</span><span class="params">()</span></span>: Request.Builder = Request.Builder().url(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure></p>
<p>å¦‚ä¸Šä»£ç ï¼Œåœ¨Stringç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªrequest()æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªOkHttpçš„Request.Builderå¯¹è±¡ï¼Œå¹¶è®¾ç½®urlä¸ºå½“å‰çš„Stringå¯¹è±¡ï¼Œå³å½“å‰çš„urlã€‚</p>
<h4 id="2-åœ¨Request-Builderç±»ä¸­æ‰©å±•æ‰§è¡Œhttpè¯·æ±‚æ–¹æ³•"><a href="#2-åœ¨Request-Builderç±»ä¸­æ‰©å±•æ‰§è¡Œhttpè¯·æ±‚æ–¹æ³•" class="headerlink" title="2) åœ¨Request.Builderç±»ä¸­æ‰©å±•æ‰§è¡Œhttpè¯·æ±‚æ–¹æ³•"></a>2) åœ¨Request.Builderç±»ä¸­æ‰©å±•æ‰§è¡Œhttpè¯·æ±‚æ–¹æ³•</h4><p>è°ƒç”¨Stringæ–¹æ³•çš„request()æ–¹æ³•ä¹‹åï¼Œè·å¾—äº†ä¸€ä¸ªæ„å»ºçš„Request.Builderå¯¹è±¡ï¼Œç„¶åå¸Œæœ›é€šè¿‡è¿™ä¸ªå¯¹è±¡è°ƒç”¨æŸä¸ªæ–¹æ³•æ¥æ‰§è¡Œhttpè¯·æ±‚ï¼Œäºæ˜¯ç»§ç»­æ‰©å±•ï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> Request.Builder.<span class="title">rxExecute</span><span class="params">()</span></span>: Observable&lt;Response&gt; = Observable.defer(&#123; Observable.just(OkHttpClient().newCall(<span class="keyword">this</span>.build()).execute()) &#125;).subscribeOn(Schedulers.newThread());</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬åœ¨Request.Builderç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªrxExecute()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­ï¼Œä¼šé€šè¿‡RxJavaæ„å»ºä¸€ä¸ªObserableå¯¹è±¡ï¼ŒObserableå¯¹è±¡ä¸­æ’å‡ºç»™è§‚å¯Ÿè€…çš„æ•°æ®å°±æ˜¯httpæ‰§è¡Œå®Œæ¯•åçš„ç»“æœResponseã€‚å¹¶ä¸”æŒ‡å®šäº†æ‰§è¡Œhttpè¯·æ±‚æ‰€åœ¨çš„çº¿ç¨‹ã€‚</p>
<h4 id="3-ä¼˜åŒ–åçš„è°ƒç”¨æ–¹å¼"><a href="#3-ä¼˜åŒ–åçš„è°ƒç”¨æ–¹å¼" class="headerlink" title="3) ä¼˜åŒ–åçš„è°ƒç”¨æ–¹å¼"></a>3) ä¼˜åŒ–åçš„è°ƒç”¨æ–¹å¼</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"https://github.com/wangjiegulu"</span>.request().<span class="keyword">get</span>().rxExecute()</span><br><span class="line">                    .map(&#123; r -&gt; r.body().string() &#125;)</span><br><span class="line">                    .observeOnMain()</span><br><span class="line">                    .subscribeSafeNext &#123; result -&gt; Log.d(TAG, <span class="string">"request result: <span class="variable">$result</span>"</span>); resultTv.setText(<span class="string">"Http request succeed, see log"</span>) &#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šï¼šé€šè¿‡urlæ„å»ºRequest.Builderï¼Œç„¶åé€šè¿‡RequestBuilderæ„å»ºä¸€ä¸ªObserableï¼Œç„¶åè®¢é˜…è·å¾—æ’å‡ºçš„è¯·æ±‚ç»“æœã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿è°ƒç”¨ï¼Œåˆåœ¨Obserableä¸­æ‰©å±•äº†å‡ ä¸ªæ–¹æ³•ï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Observable<span class="type">&lt;T&gt;</span>.<span class="title">observeOnMain</span><span class="params">()</span></span>: Observable&lt;T&gt; = <span class="keyword">this</span>.observeOn(AndroidSchedulers.mainThread())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Observable<span class="type">&lt;T&gt;</span>.<span class="title">subscribeSafeNext</span><span class="params">(onNext: (<span class="type">T</span>)</span></span> -&gt; <span class="built_in">Unit</span>): Subscription = <span class="keyword">this</span>.subscribe(onNext, &#123; t -&gt; Log.e(TAG, <span class="string">""</span>, t) &#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Observable<span class="type">&lt;T&gt;</span>.<span class="title">subscribeSafeCompleted</span><span class="params">(onCompleted: ()</span></span> -&gt; <span class="built_in">Unit</span>): Subscription = <span class="keyword">this</span>.subscribe(&#123;&#125;, &#123; t -&gt; Log.e(TAG, <span class="string">""</span>, t) &#125;, onCompleted);</span><br></pre></td></tr></table></figure></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> kotlin </tag>
            
            <tag> anko </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Kotlinè¯­æ³•ï¼ˆå…¶ä»–ï¼‰]]></title>
      <url>/2015/09/13/Kotlin%E8%AF%AD%E6%B3%95%EF%BC%88%E5%85%B6%E4%BB%96%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>#ä¸‰ã€å…¶ä»–<br>[TOC]</p>
<p>##1. å¤šé‡å£°æ˜<br>æœ‰æ—¶å€™å¯ä»¥é€šè¿‡ç»™å¯¹è±¡æ’å…¥å¤šä¸ªæˆå‘˜å‡½æ•°åšåŒºåˆ«æ˜¯å¾ˆæ–¹ä¾¿çš„:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val (name, age) = person</span><br></pre></td></tr></table></figure></p>
<p>å¤šé‡å£°æ˜ä¸€æ¬¡åˆ›å»ºäº†å¤šä¸ªå˜é‡ã€‚æˆ‘ä»¬å£°æ˜äº†ä¿©ä¸ªæ–°å˜é‡ï¼šname age å¹¶ä¸”å¯ä»¥ç‹¬ç«‹ä½¿ç”¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">println(name)</span><br><span class="line">println(age)</span><br></pre></td></tr></table></figure></p>
<p>ä¹Ÿå¯ä»¥åœ¨ for å¾ªç¯ä¸­ç”¨:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for ((a, b) in collection) &#123; ... &#125;</span><br></pre></td></tr></table></figure></p>
<p>map:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for ((key, value) in map) &#123; ... &#125;</span><br></pre></td></tr></table></figure></p>
<p>##2. Ranges<br>å‡½æ•°æ“ä½œç¬¦æ˜¯<code>:</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if (i in 1..10)&#123; ... &#125;</span><br><span class="line">if (x !in 1.0..3.0) println(x)</span><br><span class="line">if (str in &quot;island&quot;..&quot;isle&quot;) println(str)</span><br><span class="line">for (i in 4 downTo 1) print(i) // prints &apos;4321&apos;</span><br><span class="line">for (i in 1..4 step 2) print(i) // prints &quot;13&quot;</span><br><span class="line">for (i in 4 downTo 1 step 2) print(i) // prints &quot;42&quot;</span><br><span class="line">for (i in 1.0..2.0 step 0.3) print(&quot;$i &quot;) // prints &quot;1.0 1.3 1.6 1.9 &quot;</span><br><span class="line">for (i in (1..4).reversed()) print(i) // prints &quot;4321&quot;</span><br><span class="line">for (i in (1..4).reversed() step 2) print(i) // prints &quot;42&quot;</span><br></pre></td></tr></table></figure></p>
<p>##3. ç±»å‹æ£€æŸ¥å’Œè½¬æ¢<br>is !is è¡¨è¾¾å¼: ç±»ä¼¼Javaçš„instanceof</p>
<p>â€œä¸å®‰å…¨â€çš„è½¬æ¢ç¬¦ï¼Œå¦‚ä¸‹çš„xä¸èƒ½ä¸ºç©ºï¼Œå¦åˆ™æŠ›å¼‚å¸¸:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val x: String = y as String</span><br></pre></td></tr></table></figure></p>
<p>â€œå®‰å…¨â€è½¬æ¢ç¬¦ï¼Œå¦‚ä¸‹ä¸ç®¡ as? å³è¾¹çš„æ˜¯ä¸æ˜¯ä¸€ä¸ªéç©º String ç»“æœéƒ½ä¼šè½¬æ¢ä¸ºå¯ç©ºçš„:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val x: String ?= y as? String</span><br></pre></td></tr></table></figure></p>
<p>##4. This è¡¨è¾¾å¼<br>å¦‚æœ this æ²¡æœ‰åº”ç”¨è€…ï¼Œåˆ™æŒ‡å‘çš„æ˜¯æœ€å†…å±‚çš„é—­åˆèŒƒå›´ã€‚ä¸ºäº†åœ¨å…¶å®ƒèŒƒå›´ä¸­è¿”å› this ï¼Œéœ€è¦ä½¿ç”¨æ ‡ç­¾:<code>this@lable</code></p>
<p>##5. ç­‰å¼<br>åœ¨ kotlin ä¸­æœ‰ä¸¤ç§ç›¸ç­‰ï¼š</p>
<ul>
<li><p>å‚ç…§ç›¸ç­‰: <code>===</code>ï¼Œå‚ç…§ç›¸ç­‰æ˜¯é€šè¿‡ === æ“ä½œç¬¦åˆ¤æ–­çš„(ä¸ç­‰æ˜¯!== ) a===b åªæœ‰ a b æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡æ˜¯åˆ¤åˆ«æ‰æˆç«‹ã€‚å¦å¤–ï¼Œä½ å¯ä»¥ä½¿ç”¨å†…è”å‡½æ•°<code>identityEquals()</code> åˆ¤æ–­å‚ç…§ç›¸ç­‰ã€‚</p>
</li>
<li><p>ç»“æ„ç›¸ç­‰: <code>==</code>ï¼Œç»“æ„ç›¸ç­‰æ˜¯é€šè¿‡ == åˆ¤æ–­çš„ã€‚åƒ<code>a == b</code>å°†ä¼šç¿»è¯‘æˆï¼š<code>a?.equals(b) ?: b === null</code>ï¼Œå¦‚æœ a ä¸æ˜¯ null åˆ™è°ƒç”¨ equals(Any?) å‡½æ•°ï¼Œå¦åˆ™æ£€æŸ¥ b æ˜¯å¦å‚ç…§ç­‰äº nullã€‚</p>
</li>
</ul>
<p>##6. è¿ç®—ç¬¦é‡è½½<br><a href="http://kotlinlang.org/docs/reference/operator-overloading.html" target="_blank" rel="noopener">http://kotlinlang.org/docs/reference/operator-overloading.html</a></p>
<p>##7. ç©ºå®‰å…¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var a: String =&quot;abc&quot;</span><br><span class="line">a = null // ç¼–è¯‘é”™è¯¯</span><br><span class="line">val l = a.length() // å› ä¸ºaä¸èƒ½ä¸ºnullï¼Œæ‰€ä»¥ä¸ä¼šæŠ¥é”™</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var b: String? = &quot;abc&quot;</span><br><span class="line">b = null</span><br><span class="line">val l = b.length() // é”™è¯¯ï¼šbä¸ºç©º</span><br><span class="line">val l = if (b != null) b.length() else -1 // ä¸ä¼šæŠ¥é”™</span><br><span class="line">b?.length() // å®‰å…¨è°ƒç”¨ä¸ä¼šæŠ¥é”™</span><br></pre></td></tr></table></figure>
<p>å®‰å…¨è°ƒç”¨åœ¨é“¾å¼è°ƒç”¨æ˜¯æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚æ¯”å¦‚ï¼Œå¦‚æœ Bob æ˜¯ä¸€ä¸ªé›‡å‘˜å¯èƒ½åˆ†é…éƒ¨é—¨(ä¹Ÿå¯èƒ½ä¸åˆ†é…)ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è·å– Bob çš„éƒ¨é—¨åä½œä¸ºåå­—çš„å‰ç¼€ï¼Œå°±å¯ä»¥è¿™æ ·åšï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bob?.department?.head?.name //</span><br></pre></td></tr></table></figure></p>
<p><strong>Elvis æ“ä½œç¬¦:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val l: Int = if (b != null) b.length() else -1</span><br></pre></td></tr></table></figure></p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ã€€Elvis æ“ä½œç¬¦<code>?:</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val l = b.length()?: -1</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœ ?: å·¦è¾¹è¡¨è¾¾å¼ä¸ä¸ºç©ºåˆ™è¿”å›ï¼Œå¦åˆ™è¿”å›å³è¾¹çš„è¡¨è¾¾å¼ã€‚æ³¨æ„å³è¾¹çš„è¡¨å¸¦å¼åªæœ‰åœ¨å·¦è¾¹è¡¨è¾¾å¼ä¸ºç©ºæ˜¯æ‰ä¼šæ‰§è¡Œã€‚</p>
<p><strong>!!æ“ä½œç¬¦:</strong><br>ç¬¬ä¸‰ä¸ªé€‰æ‹©æ˜¯ NPE-loversã€‚æˆ‘ä»¬å¯ä»¥ç”¨ b!! ï¼Œè¿™ä¼šè¿”å›ä¸€ä¸ªéç©ºçš„ b æˆ–è€…æŠ›å‡ºä¸€ä¸ª b ä¸ºç©ºçš„ NPE:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val l = b !!.length()</span><br></pre></td></tr></table></figure></p>
<p><strong>å®‰å…¨è½¬æ¢:</strong><br>æ™®é€šçš„è½¬æ¢å¯èƒ½äº§ç”Ÿ ClassCastException å¼‚å¸¸ã€‚å¦ä¸€ä¸ªé€‰æ‹©å°±æ˜¯ä½¿ç”¨å®‰å…¨è½¬æ¢ï¼Œå¦‚æœä¸æˆåŠŸå°±è¿”å›ç©ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val aInt: Int? = a as? Int</span><br></pre></td></tr></table></figure></p>
<p>##8.å¼‚å¸¸<br>æ‰€æœ‰çš„å¼‚å¸¸ç±»éƒ½æ˜¯ Exception çš„å­ç±»ã€‚ä½¿ç”¨æ–¹å¼ä¸Javaç±»ä¼¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">  // some code</span><br><span class="line">&#125;</span><br><span class="line">catch (e: SomeException) &#123;</span><br><span class="line">  // handler</span><br><span class="line">&#125;</span><br><span class="line">finally &#123;</span><br><span class="line">  // optional finally block</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>##9.æ³¨è§£<br>æ³¨è§£æ˜¯ä¸€ç§å°†å…ƒæ•°æ®é™„åŠ åˆ°ä»£ç ä¸­çš„æ–¹æ³•ã€‚å£°æ˜æ³¨è§£éœ€è¦åœ¨ç±»å‰é¢ä½¿ç”¨ annotation å…³é”®å­—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">annotation class fancy</span><br></pre></td></tr></table></figure></p>
<p>ç”¨æ³•ï¼šåœ¨å¤šæ•°æƒ…å½¢ä¸­ @ æ ‡è¯†æ˜¯å¯é€‰çš„ã€‚åªæœ‰åœ¨æ³¨è§£è¡¨è¾¾å¼æˆ–æœ¬åœ°å£°æ˜ä¸­æ‰å¿…é¡»<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@fancy class Foo &#123;</span><br><span class="line">    @fancy fun baz(@fancy foo: Int): Int &#123;</span><br><span class="line">        return (@fancy 1)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// å¯çœç•¥@</span><br><span class="line">fancy class Foo &#123;</span><br><span class="line">    fancy fun baz(fancy foo: Int): Int &#123;</span><br><span class="line">        @fancy fun bar() &#123; ... &#125;</span><br><span class="line">        return (@fancy 1)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœè¦ç»™æ„é€ å‡½æ•°æ³¨è§£ï¼Œå°±éœ€è¦åœ¨æ„é€ å‡½æ•°å£°æ˜æ—¶æ·»åŠ  constructor å…³é”®å­—ï¼Œå¹¶ä¸”éœ€è¦åœ¨å‰é¢æ·»åŠ æ³¨è§£ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class Foo @inject constructor (dependency: MyDependency)</span><br></pre></td></tr></table></figure></p>
<p>æ³¨è§£å¯ä»¥æœ‰å¸¦å‚æ•°çš„æ„é€ å‡½æ•°:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">annotation class special(val why: String)</span><br><span class="line">special(&quot;example&quot;) class Foo &#123;&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ³¨è§£ä¹Ÿå¯ä»¥ç”¨åœ¨ Lambda ä¸­ã€‚è¿™å°†ä¼šåº”ç”¨åˆ° lambda ç”Ÿæˆçš„ invoke() æ–¹æ³•:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">annotation class Suspendable</span><br><span class="line">val f = @Suspendable &#123; Fiber.sleep(10) &#125;</span><br></pre></td></tr></table></figure></p>
<p>java æ³¨è§£åœ¨ kotlin ä¸­æ˜¯å®Œå…¨å…¼å®¹çš„ã€‚<br>å¦‚æœjava ä¸­çš„ value å‚æ•°æœ‰æ•°ç»„ç±»å‹ï¼Œåˆ™åœ¨ kotlin ä¸­å˜æˆ vararg å‚æ•°:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// Java</span><br><span class="line">public @interface AnnWithArrayValue &#123;</span><br><span class="line">    String[] value();</span><br><span class="line">&#125;</span><br><span class="line">// Kotlin</span><br><span class="line">AnnWithArrayValue(&quot;abc&quot;, &quot;foo&quot;, &quot;bar&quot;) class C</span><br></pre></td></tr></table></figure></p>
<p>æ³¨è§£å®ä¾‹çš„å€¼åœ¨ kotlin ä»£ç ä¸­æ˜¯æš´éœ²å±æ€§ã€‚</p>
<p>##10.åå°„<br>å¾—åˆ°è¿è¡Œæ—¶çš„ç±»å¼•ç”¨:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val c = MyClass::class</span><br></pre></td></tr></table></figure></p>
<p>å¼•ç”¨æ˜¯ä¸€ç§ KClassç±»å‹çš„å€¼ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>KClass.properties</code> å’Œ<code>KClass.extensionProperties</code>è·å–ç±»å’Œçˆ¶ç±»çš„æ‰€æœ‰å±æ€§å¼•ç”¨çš„åˆ—è¡¨ã€‚</p>
<p><strong>å‡½æ•°å¼•ç”¨</strong><br>ä½¿ç”¨<code>::</code>æ“ä½œç¬¦:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fun isOdd(x: Int) =x % 2 !=0</span><br><span class="line">val numbers = listOf(1, 2, 3)</span><br><span class="line">println(numbers.filter( ::isOdd) ) //prints [1, 3]</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œ<code>::isOdd</code>æ˜¯æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å€¼<code>(Int) -&gt; Boolean</code> </p>
<p>ä¸‹é¢æ˜¯è¿”å›ä¸€ä¸ªç”±ä¸¤ä¸ªä¼ é€’è¿›å»çš„å‡½æ•°çš„ç»„åˆã€‚ç°åœ¨ä½ å¯ä»¥æŠŠå®ƒç”¨åœ¨å¯è°ƒç”¨çš„å¼•ç”¨ä¸Šäº†ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fun compose&lt;A, B, C&gt;(f: (B) -&gt; C, g: (A) -&gt; B): (A) -&gt; C &#123;</span><br><span class="line">    return &#123;x -&gt; f(g(x))&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun length(s: String) = s.size</span><br><span class="line">val oddLength = compose(::isOdd, ::length)</span><br><span class="line">val strings = listOf(&quot;a&quot;, &quot;ab&quot;, &quot;abc&quot;)</span><br><span class="line">println(strings.filter(oddLength)) // Prints &quot;[a, abc]&quot;</span><br></pre></td></tr></table></figure></p>
<p><strong>å±æ€§å¼•ç”¨</strong><br>è®¿é—®é¡¶çº§ç±»çš„å±æ€§ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>::</code>æ“ä½œç¬¦ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var x = 1</span><br><span class="line">fun main(args: Array&lt;String&gt;) &#123;</span><br><span class="line">    println(::x.get())</span><br><span class="line">    ::x.set(2)</span><br><span class="line">    println(x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>::x</code>è¡¨è¾¾å¼è¯„ä¼°ä¸º<code>KProperty&lt;Int&gt;</code>ç±»å‹çš„å±æ€§ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä½¿ç”¨<code>get()</code>è¯»å®ƒçš„å€¼æˆ–è€…ä½¿ç”¨åå­—å–å›å®ƒçš„å±æ€§ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class A(val p: Int)</span><br><span class="line"></span><br><span class="line">fun main(args: Array&lt;String&gt;) &#123;</span><br><span class="line">    val prop = A::p</span><br><span class="line">    println(prop.get(A(1))) // prints &quot;1&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¯¹äºæ‰©å±•å±æ€§ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">val String.lastChar: Char</span><br><span class="line">  get() = this[size - 1]</span><br><span class="line"></span><br><span class="line">fun main(args: Array&lt;String&gt;) &#123;</span><br><span class="line">  println(String::lastChar.get(&quot;abc&quot;)) // prints &quot;c&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>ä¸ java åå°„è°ƒç”¨</strong><br>æƒ³æ‰¾åˆ°ä¸€ä¸ªå¤‡ç”¨å­—æ®µæˆ–è€… java getter æ–¹æ³•:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import kotlin.reflect.jvm.*</span><br><span class="line"></span><br><span class="line">class A(val p: Int)</span><br><span class="line"></span><br><span class="line">fun main(args: Array&lt;String&gt;) &#123;</span><br><span class="line">    println(A::p.javaGetter) // prints &quot;public final int A.getP()&quot;</span><br><span class="line">    println(A::p.javaField)  // prints &quot;private final int A.p&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>æ„é€ å‡½æ•°å¼•ç”¨</strong><br>åªéœ€è¦ä½¿ç”¨<code>::</code>æ“ä½œç¬¦å¹¶åŠ ä¸Šç±»åã€‚ä¸‹é¢çš„å‡½æ•°æ˜¯ä¸€ä¸ªæ²¡æœ‰å‚æ•°å¹¶ä¸”è¿”å›ç±»å‹æ˜¯<code>Foo</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">calss Foo</span><br><span class="line">fun function(factory : () -&gt; Foo) &#123;</span><br><span class="line">    val x: Foo = factory()</span><br><span class="line">&#125;</span><br><span class="line">function(:: Foo)</span><br></pre></td></tr></table></figure></p>
<p>##11. åŠ¨æ€ç±»å‹<br>ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œ<code>dynamic</code>åº”è€Œç”Ÿï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val dyn: dynamic = ...</span><br></pre></td></tr></table></figure></p>
<p><code>dynamic</code>ç±»å‹å…³é—­äº† kotlin çš„ç±»å‹æ£€æŸ¥ï¼š</p>
<blockquote>
<p>è¿™æ ·çš„ç±»å‹å¯ä»¥åˆ†é…ä»»æ„å˜é‡æˆ–è€…åœ¨ä»»æ„çš„åœ°æ–¹ä½œä¸ºå‚æ•°ä¼ é€’ ä»»ä½•å€¼éƒ½å¯ä»¥åˆ†é…ä¸ºdynamic ç±»å‹ï¼Œæˆ–è€…ä½œä¸ºå‚æ•°ä¼ é€’ç»™ä»»ä½•æ¥å— dynamic ç±»å‹å‚æ•°çš„å‡½æ•° è¿™æ ·çš„ç±»å‹ä¸åš null æ£€æŸ¥</p>
</blockquote>
<p><code>dynamic</code>æœ€å¥‡ç‰¹çš„ç‰¹æ€§å°±æ˜¯å¯ä»¥åœ¨<code>dynamic</code>å˜é‡ä¸Šè°ƒç”¨ä»»ä½•å±æ€§æˆ–ä»»ä½•æ–¹æ³•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dyn.whatever(1, &quot;foo&quot;, dyn) // &apos;whatever&apos; is not defined anywhere</span><br><span class="line">dyn.whatever(*array(1, 2, 3))</span><br></pre></td></tr></table></figure></p>
<p>åŠ¨æ€è°ƒç”¨å¯ä»¥è¿”å›<code>dynamic</code>ä½œä¸ºç»“æœï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°é“¾å¼è°ƒç”¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dyn.foo().bar.bat()</span><br></pre></td></tr></table></figure></p>
<p>å½“ç»™åŠ¨æ€è°ƒç”¨ä¼ é€’ä¸€ä¸ª lambda è¡¨è¾¾å¼æ—¶ï¼Œæ‰€æœ‰çš„å‚æ•°é»˜è®¤éƒ½æ˜¯<code>dynamic</code>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dyn.foo &#123;</span><br><span class="line">  x -&gt; x.bar() // x is dynamic</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å‚è€ƒï¼š</strong><br>1. <a href="http://kotlinlang.org/docs/reference/basic-syntax.html" target="_blank" rel="noopener">http://kotlinlang.org/docs/reference/basic-syntax.html</a><br>2. <a href="http://huanglizhuo.gitbooks.io/kotlin-in-chinese" target="_blank" rel="noopener">http://huanglizhuo.gitbooks.io/kotlin-in-chinese</a></p>
]]></content>
      
        
        <tags>
            
            <tag> kotlin </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Kotlinè¯­æ³•ï¼ˆå‡½æ•°å’Œlambdaè¡¨è¾¾å¼ï¼‰]]></title>
      <url>/2015/09/11/Kotlin%E8%AF%AD%E6%B3%95%EF%BC%88%E5%87%BD%E6%95%B0%E5%92%8Clambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>#ä¸‰ã€å‡½æ•°å’Œlambdaè¡¨è¾¾å¼</p>
<p>##1. å‡½æ•°å£°æ˜<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fun double(x: Int): Int &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å‡½æ•°å‚æ•°æ˜¯ç”¨ Pascal ç¬¦å·å®šä¹‰çš„ã€€name:typeã€‚å‚æ•°ä¹‹é—´ç”¨é€—å·éš”å¼€ï¼Œæ¯ä¸ªå‚æ•°å¿…é¡»æŒ‡æ˜ç±»å‹ã€‚å‡½æ•°å‚æ•°å¯ä»¥æœ‰é»˜è®¤å‚æ•°ã€‚è¿™æ ·ç›¸æ¯”å…¶ä»–è¯­è¨€å¯ä»¥å‡å°‘é‡è½½ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fun read(b: Array&lt;Byte&gt;, off: Int = 0, len: Int = b.size() ) &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>##2. å‘½åå‚æ•°<br>åœ¨è°ƒç”¨å‡½æ•°æ—¶å¯ä»¥å‚æ•°å¯ä»¥å‘½åã€‚è¿™å¯¹äºæœ‰å¾ˆå¤šå‚æ•°æˆ–åªæœ‰ä¸€ä¸ªçš„å‡½æ•°æ¥è¯´å¾ˆæ–¹ä¾¿ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fun reformat(str: String, normalizeCase: Boolean = true,upperCaseFirstLetter: Boolean = true,</span><br><span class="line">             divideByCamelHumps: Boolean = false,</span><br><span class="line">             wordSeparator: Char = &apos; &apos;) &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line">reformat(str,</span><br><span class="line">    normalizeCase = true,</span><br><span class="line">    uppercaseFirstLetter = true,</span><br><span class="line">    divideByCamelHumps = false,</span><br><span class="line">    wordSeparator = &apos;_&apos;</span><br><span class="line">  )</span><br></pre></td></tr></table></figure></p>
<p>##3. å˜é•¿å‚æ•°:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fun asList&lt;T&gt;(vararg ts: T): List&lt;T&gt; &#123;</span><br><span class="line">    val result = ArrayList&lt;T&gt;()</span><br><span class="line">    for (t in ts)</span><br><span class="line">        result.add(t)</span><br><span class="line">    return result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¼ é€’ä¸€ä¸ª array çš„å†…å®¹ç»™å‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ * å‰ç¼€æ“ä½œç¬¦ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val a = array(1, 2, 3)</span><br><span class="line">val list = asList(-1, 0, *a, 4)</span><br></pre></td></tr></table></figure></p>
<p>Kotlin ä¸­å¯ä»¥åœ¨æ–‡ä»¶ä¸ªæ ¹çº§å£°æ˜å‡½æ•°ï¼Œè¿™å°±æ„å‘³è€…ä½ ä¸ç”¨åˆ›å»ºä¸€ä¸ªç±»æ¥æŒæœ‰å‡½æ•°ã€‚é™¤äº†é¡¶çº§å‡½æ•°ï¼ŒKotlin å‡½æ•°å¯ä»¥å£°æ˜ä¸ºå±€éƒ¨çš„ï¼Œä½œä¸ºæˆå‘˜å‡½æ•°æˆ–æ‰©å±•å‡½æ•°ã€‚<br>Kotlin æ”¯æŒå±€éƒ¨å‡½æ•°ï¼Œæ¯”å¦‚åœ¨å¦ä¸€ä¸ªå‡½æ•°ä½¿ç”¨å¦ä¸€å‡½æ•°ã€‚å±€éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡(æ¯”å¦‚é—­åŒ…)ã€‚å±€éƒ¨å‡½æ•°ç”šè‡³å¯ä»¥è¿”å›åˆ°å¤–éƒ¨å‡½æ•°</p>
<p>##4. é«˜é˜¶å‡½æ•°<br>é«˜é˜¶å‡½æ•°å°±æ˜¯å¯ä»¥æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°å¹¶è¿”å›ä¸€ä¸ªå‡½æ•°çš„å‡½æ•°ã€‚æ¯”å¦‚ lock() å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª lock å¯¹è±¡å’Œä¸€ä¸ªå‡½æ•°ï¼Œè¿è¡Œå‡½æ•°å¹¶é‡Šæ”¾ lock;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fun lock&lt;T&gt;(lock: Lock, body: () -&gt; T ) : T &#123;</span><br><span class="line">    lock.lock()</span><br><span class="line">    try &#123;</span><br><span class="line">        return body()</span><br><span class="line">    &#125;</span><br><span class="line">    finally &#123;</span><br><span class="line">        lock.unlock()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å…¶å®æœ€æ–¹ä¾¿çš„åŠæ³•æ˜¯ä¼ é€’ä¸€ä¸ªå­—é¢å‡½æ•°(é€šå¸¸æ˜¯ lambda è¡¨è¾¾å¼)ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val result = lock(lock, &#123; sharedResource.operation() &#125;)</span><br></pre></td></tr></table></figure></p>
<p>åœ¨ kotlin ä¸­æœ‰ä¸€ä¸ªçº¦å®šï¼Œå¦‚æœæœ€åä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°ï¼Œå¯ä»¥çœç•¥æ‹¬å·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lock (lock) &#123;</span><br><span class="line">    sharedResource.operation()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>##5. å­—é¢å‡½æ•°</p>
<ul>
<li>å­—é¢å‡½æ•°è¢«åŒ…åœ¨å¤§æ‹¬å·é‡Œ</li>
<li>å‚æ•°åœ¨ -&gt; å‰é¢å£°æ˜(å‚æ•°ç±»å‹å¯ä»¥çœç•¥)</li>
<li>å‡½æ•°ä½“åœ¨ -&gt; ä¹‹å</li>
</ul>
<p>å­—é¢å‡½æ•°æˆ–å‡½æ•°è¡¨è¾¾å¼å°±æ˜¯ä¸€ä¸ª â€œåŒ¿åå‡½æ•°â€ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å£°æ˜çš„å‡½æ•°ï¼Œä½†ç«‹å³ä½œä¸ºè¡¨è¾¾å¼ä¼ é€’ä¸‹å»ã€‚</p>
<p>##6. å‡½æ•°ç±»å‹<br>å¦‚ï¼š(T, T) -&gt; Boolean<br>æ³¨æ„å¦‚æœä¸€ä¸ªå‡½æ•°æ¥å—å¦ä¸€ä¸ªå‡½æ•°åšä¸ºæœ€åä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‡½æ•°æ–‡æœ¬å‚æ•°å¯ä»¥åœ¨æ‹¬å·å†…çš„å‚æ•°åˆ—è¡¨å¤–çš„ä¼ é€’ã€‚</p>
<p>##7. å‡½æ•°æ–‡æœ¬è¯­æ³•<br>å‡½æ•°æ–‡æœ¬çš„å®Œå…¨å†™æ³•æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val sum = &#123;x: Int,y: Int -&gt; x + y&#125;</span><br></pre></td></tr></table></figure></p>
<p>å‡½æ•°æ–‡æœ¬æ€»æ˜¯åœ¨å¤§æ‹¬å·é‡ŒåŒ…è£¹ç€ï¼Œåœ¨å®Œå…¨è¯­æ³•ä¸­å‚æ•°å£°æ˜æ˜¯åœ¨æ‹¬å·å†…ï¼Œç±»å‹æ³¨è§£æ˜¯å¯é€‰çš„ï¼Œå‡½æ•°ä½“æ˜¯åœ¨ã€€-&gt; ä¹‹åï¼Œåƒä¸‹é¢è¿™æ ·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val sum: (Int, Int) -&gt; Int = &#123;x, y -&gt; x+y &#125;</span><br></pre></td></tr></table></figure></p>
<p>##8. å‡½æ•°è¡¨è¾¾å¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fun(x: Int, y: Int ): Int = x + y</span><br></pre></td></tr></table></figure></p>
<p>##9. å†…è”å‡½æ•°<br>åœ¨é«˜é˜¶å‡½æ•°å‰å¢åŠ inlineæ³¨è§£å¯ä»¥æŒ‡å®šå‡½æ•°å…§è”ã€‚inline æ ‡è®°å³å½±å“å‡½æ•°æœ¬èº«ä¹Ÿå½±å“ä¼ é€’è¿›æ¥çš„ lambda å‡½æ•°ï¼šæ‰€æœ‰çš„è¿™äº›éƒ½å°†è¢«å…³è”åˆ°è°ƒç”¨ç‚¹ã€‚<br>å†…è”å¯èƒ½ä¼šå¼•èµ·ç”Ÿæˆä»£ç å¢é•¿ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨noinlineæ¥æŒ‡å®šæŸäº›å‡½æ•°ä¸è¿›è¡Œå…§è”ã€‚</p>
<p>æ³¨æ„æœ‰äº›å†…è”å‡½æ•°å¯ä»¥è°ƒç”¨ä¼ é€’è¿›æ¥çš„ lambda å‡½æ•°ï¼Œä½†ä¸æ˜¯åœ¨å‡½æ•°ä½“ï¼Œè€Œæ˜¯åœ¨å¦ä¸€ä¸ªæ‰§è¡Œçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæ¯”å¦‚å±€éƒ¨å¯¹è±¡æˆ–è€…ä¸€ä¸ªåµŒå¥—å‡½æ•°ã€‚åœ¨è¿™æ ·çš„æƒ…å½¢ä¸­ï¼Œéå±€éƒ¨çš„æ§åˆ¶æµä¹Ÿä¸å…è®¸åœ¨lambda å‡½æ•°ä¸­ã€‚ä¸ºäº†è¡¨æ˜ï¼Œlambda å‚æ•°éœ€è¦æœ‰ InlineOptions.ONLY_LOCAL_RETURN æ³¨è§£</p>
<p><strong>å‚è€ƒï¼š</strong><br>1. <a href="http://kotlinlang.org/docs/reference/basic-syntax.html" target="_blank" rel="noopener">http://kotlinlang.org/docs/reference/basic-syntax.html</a><br>2. <a href="http://huanglizhuo.gitbooks.io/kotlin-in-chinese" target="_blank" rel="noopener">http://huanglizhuo.gitbooks.io/kotlin-in-chinese</a></p>
]]></content>
      
        
        <tags>
            
            <tag> kotlin </tag>
            
            <tag> lambda </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Kotlinè¯­æ³•ï¼ˆç±»å’Œå¯¹è±¡ï¼‰]]></title>
      <url>/2015/09/11/Kotlin%E8%AF%AD%E6%B3%95%EF%BC%88%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>#äºŒã€ç±»å’Œå¯¹è±¡ï¼š</p>
<p>##1. ç±»å®šä¹‰ï¼š<br>ç±»çš„å£°æ˜åŒ…å«ç±»åï¼Œç±»å¤´(æŒ‡å®šç±»å‹å‚æ•°ï¼Œä¸»æ„é€ å‡½æ•°ç­‰ç­‰)ï¼Œä»¥åŠç±»ä¸»ä½“ï¼Œç”¨å¤§æ‹¬å·åŒ…è£¹ã€‚ç±»å¤´å’Œç±»ä½“æ˜¯å¯é€‰çš„ï¼›å¦‚æœæ²¡æœ‰ç±»ä½“å¯ä»¥çœç•¥å¤§æ‹¬å·ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">class Invoice&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>##2. æ„é€ å‡½æ•°:<br>åœ¨ Kotlin ä¸­ç±»å¯ä»¥æœ‰ä¸€ä¸ªä¸»æ„é€ å‡½æ•°ä»¥åŠå¤šä¸ªäºŒçº§æ„é€ å‡½æ•°ã€‚ä¸»æ„é€ å‡½æ•°æ˜¯ç±»å¤´çš„ä¸€éƒ¨åˆ†ï¼šè·Ÿåœ¨ç±»ååé¢(å¯ä»¥æœ‰å¯é€‰çš„å‚æ•°)ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">class Person(val firstName: String, val lastName: String, var age: Int)&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>åˆå§‹åŒ–ä»£ç å¯ä»¥æ”¾åœ¨ä»¥ init åšå‰ç¼€çš„åˆå§‹åŒ–å—å†…ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class Customer(name: String)&#123;</span><br><span class="line">    init &#123;</span><br><span class="line">        logger,info(&quot;Customer initialized with value $&#123;name&#125;&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœæ„é€ å‡½æ•°æœ‰æ³¨è§£æˆ–å¯è§æ€§å£°æ˜ï¼Œåˆ™ constructor å…³é”®å­—æ˜¯ä¸å¯å°‘çš„ï¼Œå¹¶ä¸”æ³¨è§£åº”è¯¥åœ¨å‰ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class Customer public inject constructor (name: String) &#123;...&#125;</span><br></pre></td></tr></table></figure></p>
<p>##3. äºŒçº§æ„é€ å‡½æ•°:<br>å‰ç¼€æ˜¯ constructorï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class Person &#123;</span><br><span class="line">    constructor(parent: Person) &#123;</span><br><span class="line">        parent.children.add(this)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœç±»æœ‰ä¸»æ„é€ å‡½æ•°ï¼Œæ¯ä¸ªäºŒçº§æ„é€ å‡½æ•°éƒ½è¦ï¼Œæˆ–ç›´æ¥æˆ–é—´æ¥é€šè¿‡å¦ä¸€ä¸ªäºŒçº§æ„é€ å‡½æ•°ä»£ç†ä¸»æ„é€ å‡½æ•°ã€‚åœ¨åŒä¸€ä¸ªç±»ä¸­ä»£ç†å¦ä¸€ä¸ªæ„é€ å‡½æ•°ä½¿ç”¨ this å…³é”®å­—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class Person(val name: String) &#123;</span><br><span class="line">    constructor (name: String, paret: Person) : this(name) &#123;</span><br><span class="line">        parent.children.add(this)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ²¡æœ‰å£°æ˜æ„é€ å‡½æ•°ï¼Œåˆ™æœ‰ä¸€ä¸ªé»˜è®¤çš„æ— å‚æ„é€ å‡½æ•°ã€‚</p>
<p>##4. åˆ›å»ºç±»çš„å®ä¾‹:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val invoice = Invoice()</span><br><span class="line">val customer = Customer(&quot;Joe Smith&quot;)</span><br></pre></td></tr></table></figure></p>
<p>##5. ç»§æ‰¿<br>æ‰€æœ‰ç±»çš„åŸºç±»ï¼šAnyï¼Œç±»ä¼¼Javaä¸­çš„Object</p>
<p>æ‰€æœ‰éæŠ½è±¡ç±»é»˜è®¤éƒ½æ˜¯ä¸å¯ç»§æ‰¿çš„ï¼ˆjavaä¸­çš„finalï¼‰ï¼Œå¦‚æœè¦è¢«å­ç±»ç»§æ‰¿ï¼Œéœ€è¦ä½¿ç”¨<code>open</code>å…³é”®å­—ï¼ˆä¸javaä¸­çš„finalåŠŸèƒ½ç›¸åï¼‰ï¼Œç»§æ‰¿ç”¨<code>:</code>æ“ä½œç¬¦ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">open class Base(p: Ont)</span><br><span class="line">class Derived(p: Int) : Base(p)</span><br></pre></td></tr></table></figure></p>
<p>æ–¹æ³•å¦‚æœè¦è¢«é‡å†™ï¼Œåˆ™ä¹Ÿéœ€è¦æ˜¯<code>open</code>çš„ï¼Œä¸æƒ³è¢«é‡å†™å°±åŠ <code>final</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">open class AnotherDerived() : Base() &#123;</span><br><span class="line">    final override fun v() &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ–¹æ³•é‡å†™è§„åˆ™ï¼šå¦‚æœæœ‰å¤šä¸ªç›¸åŒçš„æ–¹æ³•ï¼ˆç»§æ‰¿æˆ–è€…å®ç°è‡ªå…¶ä»–ç±»ï¼Œå¦‚Aã€Bç±»ï¼‰ï¼Œåˆ™å¿…é¡»è¦é‡å†™è¯¥æ–¹æ³•ï¼Œä½¿ç”¨superèŒƒå‹å»é€‰æ‹©æ€§åœ°è°ƒç”¨çˆ¶ç±»çš„å®ç°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">open class A &#123;</span><br><span class="line">    open fun f () &#123; print(&quot;A&quot;) &#125;</span><br><span class="line">    fun a() &#123; print(&quot;a&quot;) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface B &#123;</span><br><span class="line">    fun f() &#123; print(&quot;B&quot;) &#125; //æ¥å£çš„æˆå‘˜å˜é‡é»˜è®¤æ˜¯ open çš„</span><br><span class="line">    fun b() &#123; print(&quot;b&quot;) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class C() : A() , B&#123;</span><br><span class="line">    override fun f() &#123;</span><br><span class="line">        super&lt;A&gt;.f()//è°ƒç”¨ A.f()</span><br><span class="line">        super&lt;B&gt;.f()//è°ƒç”¨ B.f()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>##6. æŠ½è±¡ç±»<br><code>abstract</code>å…³é”®å­—ï¼ŒæŠ½è±¡ç±»å’Œå‡½æ•°é»˜è®¤æ˜¯<code>open</code>çš„ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">open class Base &#123;</span><br><span class="line">    open fun f() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">abstract class Derived : Base() &#123;</span><br><span class="line">    override abstract fun f()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>##7. ä¼´éšå¯¹è±¡<br>ä½¿ç”¨ä¼´éšå¯¹è±¡å¯ä»¥ç›´æ¥ä½¿ç”¨ç±»åæ¥è®¿é—®ï¼ˆç”¨æ³•ç±»ä¼¼Javaä¸­çš„staticï¼Œä½†æ˜¯ä¸ä¸€æ ·ï¼‰ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class MyClass &#123;</span><br><span class="line">    companion object &#123;</span><br><span class="line">        var BASE_URL: String = &quot;BASE_URL&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">println(&quot;BASE_URL: &quot; + MyClass.BASE_URL)</span><br></pre></td></tr></table></figure></p>
<p>ä¸javaçš„staticä¸åŒï¼Œè¿è¡Œæ—¶å®ƒä»¬ä»ç„¶æ˜¯çœŸæ­£å¯¹è±¡çš„æˆå‘˜å®ä¾‹ï¼Œæ¯”å¦‚å¯ä»¥å®ç°æ¥å£ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">inerface Factory&lt;T&gt; &#123;</span><br><span class="line">    fun create(): T</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class MyClass &#123;</span><br><span class="line">    companion object : Factory&lt;MyClass&gt; &#123;</span><br><span class="line">        override fun create(): MyClass = MyClass()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>##8. Getter å’Œ Setter å‡½æ•°<br>ä¸€èˆ¬å®šä¹‰å˜é‡çš„æ—¶å€™æœ‰é»˜è®¤çš„getter/setteræ–¹æ³•ï¼›å¦‚æœä½¿ç”¨$è®¿é—®ï¼Œåˆ™å¯ä»¥é¿å¼€getter/setteræ–¹æ³•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var stringRepresentation: String</span><br><span class="line">    get() = this.toString()</span><br><span class="line">    set (value) &#123;</span><br><span class="line">        setDataFormString(value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ”¹å˜ä¸€ä¸ªè®¿é—®è€…çš„å¯è§æ€§æˆ–è€…æ³¨è§£å®ƒï¼Œå¯ä»¥ä¸ç”¨æ”¹å˜é»˜è®¤çš„å®ç°:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var settVisibilite: String = &quot;abc&quot;//éç©ºç±»å‹å¿…é¡»åˆå§‹åŒ–</span><br><span class="line">    private set // setter æ˜¯ç§æœ‰çš„å¹¶ä¸”æœ‰é»˜è®¤çš„å®ç°</span><br><span class="line">var setterVithAnnotation: Any?</span><br><span class="line">    @Inject set // ç”¨ Inject æ³¨è§£ setter</span><br></pre></td></tr></table></figure></p>
<p>##9. æ¥å£<br>å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œä»¥åŠæ–¹æ³•çš„é»˜è®¤å®ç°ã€‚å¯ä»¥æœ‰å±æ€§ä½†å¿…é¡»æ˜¯æŠ½è±¡çš„ã€‚ä¸€ä¸ªç±»æˆ–å¯¹è±¡å¯ä»¥å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">interface MyInterface &#123;</span><br><span class="line">    fun bar()</span><br><span class="line">    fun foo() &#123;</span><br><span class="line">        //å‡½æ•°ä½“æ˜¯å¯é€‰çš„</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ¥å£å±æ€§ä¸èƒ½èµ‹å€¼ï¼Œéœ€è¦è¢«å­ç±»overrideï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">interface MyInterface &#123;</span><br><span class="line">    val property: Int //æŠ½è±¡å±æ€§</span><br><span class="line">    fun foo() &#123;</span><br><span class="line">        println(property)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Child : MyInterface &#123;</span><br><span class="line">    override val property: Int = 29</span><br><span class="line">&#125;</span><br><span class="line">è¾“å‡ºï¼š29</span><br></pre></td></tr></table></figure></p>
<p>##10. å¯è§æ€§ä¿®é¥°è¯</p>
<ul>
<li>private: åªåœ¨è¯¥ç±»(ä»¥åŠå®ƒçš„æˆå‘˜)ä¸­å¯è§</li>
<li>protected: å’Œ private ä¸€æ ·ä½†åœ¨å­ç±»ä¸­ä¹Ÿå¯è§</li>
<li>internal: åœ¨æœ¬æ¨¡å—çš„æ‰€æœ‰å¯ä»¥è®¿é—®è¯¥ç±»çš„å‡å¯ä»¥è®¿é—®è¯¥ç±»çš„æ‰€æœ‰ internal æˆå‘˜</li>
<li>public: ä»»ä½•åœ°æ–¹å¯è§</li>
</ul>
<p>##11. æ•°æ®ç±»<br>ä½¿ç”¨<code>data</code>å…³é”®è¯ä¿®é¥°ç±»ï¼Œåˆ™ä¼šè‡ªåŠ¨æ·»åŠ <code>equals()/hashCode</code>, <code>toString</code>, <code>[compontN()functions]å¯¹åº”æŒ‰å£°æ˜é¡ºåºå‡ºç°çš„æ‰€æœ‰å±æ€§</code>, <code>copy()</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data class User(val name: String, val age: Int)</span><br></pre></td></tr></table></figure></p>
<p>ç»„ä»¶å‡½æ•°å…è®¸æ•°æ®ç±»åœ¨å¤šé‡å£°æ˜ä¸­ä½¿ç”¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val jane = User(&quot;jane&quot;, 35)</span><br><span class="line">val (name, age) = jane</span><br><span class="line">println(&quot;$name, $age years of age&quot;)</span><br></pre></td></tr></table></figure></p>
<p>##12. å†…éƒ¨ç±»<br>ç±»å¯ä»¥æ ‡è®°ä¸º inner è¿™æ ·å°±å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æˆå‘˜ã€‚å†…éƒ¨ç±»æ‹¥æœ‰å¤–éƒ¨ç±»çš„ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class Outer &#123;</span><br><span class="line">    private val bar: Int = 1</span><br><span class="line">    inner class Inner &#123;</span><br><span class="line">        fun foo() = bar</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">val demo = Outer().Inner().foo()</span><br></pre></td></tr></table></figure></p>
<p>##13. å¯¹è±¡è¡¨è¾¾å¼<br>ç±»ä¼¼Javaçš„åŒ¿åå†…éƒ¨ç±»ï¼Œå¯ä»¥ç»§æ‰¿/å®ç°å¤šä¸ªï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var zhangsan = object : Person(), MyInterface&#123;</span><br><span class="line">        override val property: Int = 512</span><br><span class="line"></span><br><span class="line">        override fun toString(): String &#123;</span><br><span class="line">            return &quot;toString() modified&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">println(zhangsan.toString())</span><br></pre></td></tr></table></figure></p>
<p>ä¸€ä¸ªæ²¡æœ‰çˆ¶ç±»çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">val adHoc = object &#123;</span><br><span class="line">    var x: Int = 0</span><br><span class="line">    var y: Int = 0</span><br><span class="line">&#125;</span><br><span class="line">print(adHoc.x + adHoc.y)</span><br></pre></td></tr></table></figure></p>
<p>##14. ä»£ç†<br>ç±»ä»£ç†ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">interface Base &#123;</span><br><span class="line">    fun print()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class BaseImpl(val x: Int) : Base &#123;</span><br><span class="line">    override fun print() &#123; printz(x) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Derived(b: Base) : Base by b</span><br><span class="line"></span><br><span class="line">fun main() &#123;</span><br><span class="line">    val b = BaseImpl(10)</span><br><span class="line">    Derived(b).print()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å±æ€§ä»£ç†ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class Example &#123;</span><br><span class="line">    var p: String by Delegate()</span><br><span class="line">&#125;</span><br><span class="line">class Delegate &#123;</span><br><span class="line">    fun get(thisRef: Any?, prop: PropertyMetadata): String &#123;</span><br><span class="line">        return &quot;$thisRef, thank you for delegating &apos;$&#123;prop.name&#125;&apos; to me !&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun set(thisRef: Any?, prop: PropertyMatada, value: String) &#123;</span><br><span class="line">        println(&quot;$value has been assigned to &apos;$&#123;prop.name&#125; in $thisRef.&apos;&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">val e = Example()</span><br><span class="line">pintln(e.p)</span><br><span class="line"></span><br><span class="line">è¾“å‡ºï¼šExample@33a17727, thank you for delegating â€˜pâ€™ to me!</span><br></pre></td></tr></table></figure></p>
<p><a href="http://huanglizhuo.gitbooks.io/kotlin-in-chinese/content/ClassesAndObjects/DelegationProperties.html" target="_blank" rel="noopener">æ ‡å‡†ä»£ç†</a></p>
<p><strong>å‚è€ƒï¼š</strong><br>1. <a href="http://kotlinlang.org/docs/reference/basic-syntax.html" target="_blank" rel="noopener">http://kotlinlang.org/docs/reference/basic-syntax.html</a><br>2. <a href="http://huanglizhuo.gitbooks.io/kotlin-in-chinese" target="_blank" rel="noopener">http://huanglizhuo.gitbooks.io/kotlin-in-chinese</a></p>
]]></content>
      
        
        <tags>
            
            <tag> kotlin </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Kotlinè¯­æ³•ï¼ˆåŸºç¡€ï¼‰]]></title>
      <url>/2015/09/11/Kotlin%E8%AF%AD%E6%B3%95%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>#ä¸€ã€åŸºç¡€è¯­æ³•ï¼š</p>
<p>##1. å®šä¹‰åŒ…åï¼š<br>åŒ…ååº”è¯¥åœ¨æºæ–‡ä»¶çš„æœ€å¼€å¤´ï¼ŒåŒ…åä¸å¿…å’Œæ–‡ä»¶å¤¹è·¯å¾„ä¸€è‡´ï¼šæºæ–‡ä»¶å¯ä»¥æ”¾åœ¨ä»»æ„ä½ç½®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">package my.demo</span><br></pre></td></tr></table></figure></p>
<p>##2. å®šä¹‰å‡½æ•°ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fun sum(a: Int , b: Int) : Int&#123;</span><br><span class="line">ã€€ã€€return a + b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è¡¨è¾¾å¼å‡½æ•°ä½“è‡ªåŠ¨æ¨æ–­å‹çš„è¿”å›å€¼ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fun sum(a: Int, b Int) = a + b</span><br></pre></td></tr></table></figure></p>
<p>è¦æƒ³å‡½æ•°åœ¨æ¨¡å—å¤–é¢å¯è§å°±å¿…é¡»æœ‰ä¸€ä¸ªç¡®å®šçš„è¿”å›å€¼ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public fun sum(a: Int, b: Int): Int = a + b</span><br></pre></td></tr></table></figure></p>
<p>Unitç›¸å½“äºJavaä¸­çš„voidï¼Œå¯çœç•¥</p>
<p>##3. å®šä¹‰å˜é‡ï¼š</p>
<ul>
<li><code>var a: Int = 1</code>ï¼Œæ™®é€šå˜é‡</li>
<li><code>val a: Int = 1</code>ï¼Œåªè¯»å˜é‡ï¼Œç›¸å½“äºJavaä¸­çš„final</li>
<li><code>var a = 1</code>ï¼Œå¯æ¨å¯¼å‡ºIntç±»å‹</li>
</ul>
<p>##4. å­—ç¬¦ä¸²æ¨¡æ¿<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fun main(args: Array&lt;String&gt;) &#123;</span><br><span class="line">    if (args.size() == 0) return</span><br><span class="line">    print(&quot;First argument: $&#123;args[0]&#125;&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ¢è¡Œï¼š\n</p>
<p>ä¸‰ä¸ªå¼•å·åŒ…(â€œâ€â€)è£¹çš„,ä¸åŒ…å«åˆ†å‰²ç¬¦å¹¶ä¸”å¯ä»¥åŒ…å«å…¶å®ƒå­—ç¬¦ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val text = &quot;&quot;&quot;</span><br><span class="line">    for (c in &quot;foo&quot;)</span><br><span class="line">        print(c)</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure></p>
<p>###5. ifè¯­å¥<br>é™¤äº†ç±»ä¼¼Javaçš„ç”¨æ³•ï¼Œè¿˜å¯ä»¥å½“ä½œè¡¨è¾¾å¼ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fun max(a: Int,  b: Int) = if (a &gt; b) a else b</span><br></pre></td></tr></table></figure></p>
<p>å¯ç›´æ¥è¿”å›ifç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fun foo(param: Int)&#123;</span><br><span class="line">    val result = if (param == 1) &#123;</span><br><span class="line">        &quot;one&quot;</span><br><span class="line">    &#125; else if (param == 2) &#123;</span><br><span class="line">        &quot;two&quot;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        &quot;three&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>###6. å¯ç©ºå˜é‡ä»¥åŠç©ºå€¼æ£€æŸ¥<br>å£°æ˜å¯ç©ºå˜é‡ï¼š<code>var a:Int? = null</code><br>å‡½æ•°è¿”å›å¯ç©ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fun parseInt(str : String): Int?&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è°ƒç”¨æ—¶è‡ªåŠ¨æ£€æŸ¥nullï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val files = File(&quot;Test&quot;).listFiles()</span><br><span class="line">println(files?.size)</span><br></pre></td></tr></table></figure></p>
<p>è°ƒç”¨æ—¶è‡ªåŠ¨æ£€æŸ¥nullï¼ˆå¯è®¾ç½®å¦‚æœä¸ºnullæ—¶çš„é»˜è®¤å€¼ï¼‰ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val files = File(&quot;test&quot;).listFiles()</span><br><span class="line">println(files?.size ?: &quot;empty&quot;)</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœä¸ºç©ºæ‰§è¡ŒæŸæ“ä½œï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val data = ...</span><br><span class="line">val email = data[&quot;email&quot;] ?: throw</span><br><span class="line">IllegalStateException(&quot;Email is missing!&quot;)</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœä¸ä¸ºç©ºæ‰§è¡ŒæŸæ“ä½œï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val date = ...</span><br><span class="line">data?.let&#123;</span><br><span class="line">    ...//å¦‚æœä¸ä¸ºç©ºæ‰§è¡Œè¯¥è¯­å¥å—</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>###7. ä½¿ç”¨å€¼æ£€æŸ¥<br><code>is</code>ï¼šç›¸å½“äºJavaä¸­çš„instanceof, æ˜¯å¦æ˜¯æŸä¸ªç±»å‹çš„å®ä¾‹ã€‚å¦‚æœå¯¹ä¸€ä¸ªä¸å¯å˜çš„å±€éƒ¨å˜é‡å±æ€§æ£€æŸ¥æ˜¯å¦æ˜¯æŸç§ç‰¹å®šç±»å‹ï¼Œå°±æ²¡æœ‰å¿…è¦æ˜ç¡®è½¬æ¢</p>
<p>###8. å¾ªç¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (arg in args)&#123;</span><br><span class="line">    print(arg)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>While</code>ç­‰å¾ªç¯ä¸Javaä¸€æ ·</p>
<p>###9. Whenè¡¨è¾¾å¼<br>ç›¸å½“äºJavaä¸­çš„switch caseï¼Œä½†æ˜¯æ›´å¼ºå¤§ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fun cases(obj: Any) &#123;</span><br><span class="line">    when (obj) &#123;</span><br><span class="line">    1    -&gt; print(&quot;one&quot;)</span><br><span class="line">    &quot;hello&quot;    -&gt; print(&quot;Greeting&quot;)</span><br><span class="line">    is Long    -&gt; print(&quot;Long&quot;)</span><br><span class="line">    ! is Long    -&gt; print(&quot;Not a string&quot;)</span><br><span class="line">    else    -&gt; print(&quot;Ubknow&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¯ç›´æ¥è¿”å›whençš„åˆ¤æ–­ç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fun transform(color: String): Int &#123;</span><br><span class="line">    return when(color) &#123;</span><br><span class="line">        &quot;Red&quot; -&gt; 0</span><br><span class="line">        &quot;Green&quot; -&gt; 1</span><br><span class="line">        &quot;Blue&quot; -&gt; 2</span><br><span class="line">        else -&gt; throw IllegalArgumentException(&quot;Invalid color param value&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>###10. ranges &amp; in<br>æ£€æŸ¥ in æ“ä½œç¬¦æ£€æŸ¥æ•°å€¼æ˜¯å¦åœ¨æŸä¸ªèŒƒå›´å†…ï¼ˆåŒæ ·é€‚ç”¨äºé›†åˆï¼‰ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (x in 1..100)&#123;</span><br><span class="line">    print(&quot;$&#123;x&#125; in 1~100&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (x !in 1..100)&#123;</span><br><span class="line">    print(&quot;$&#123;x&#125; not in 1~100&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ in æ“ä½œç¬¦æ£€æŸ¥é›†åˆä¸­æ˜¯å¦åŒ…å«æŸä¸ªå¯¹è±¡ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if (text in names) //å°†ä¼šè°ƒç”¨nemes.contains(text)æ–¹æ³•</span><br><span class="line">    print(&quot;Yes)</span><br></pre></td></tr></table></figure></p>
<p>éå† mapï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for ((k, v) in map) &#123;</span><br><span class="line">    print(&quot;$k -&gt; $v&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>###11. å‡½æ•°é»˜è®¤å€¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fun foo(a: Int = 0, b: String = &quot;&quot;) &#123;...&#125;</span><br></pre></td></tr></table></figure></p>
<p>###12. è¿‡æ»¤ list<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val positives = list.filter &#123; x -&gt; x &gt;0 &#125;</span><br></pre></td></tr></table></figure></p>
<p>æˆ–è€…æ›´çŸ­ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val positives = list.filter &#123; it &gt; 0 &#125;</span><br></pre></td></tr></table></figure></p>
<p>###13. åªè¯» list/map<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val list = listOf(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</span><br></pre></td></tr></table></figure></p>
<p>æˆ–è€…ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val map = maoOf(&quot;a&quot; to 1, &quot;b&quot; to 2, &quot;c&quot; to 3)</span><br></pre></td></tr></table></figure></p>
<p>è·å–mapä¸­çš„å€¼ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">println(map[&quot;key&quot;])</span><br><span class="line">map[&quot;key&quot;] = value</span><br></pre></td></tr></table></figure></p>
<p>###14. æ‰©å±•å‡½æ•°(ç»™ç°æœ‰ç±»å¢æ·»æ–°å‡½æ•°)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fun String.spcaceToCamelCase() &#123; ... &#125;</span><br><span class="line">&quot;Convert this to camelcase&quot;.spcaceToCamelCase()</span><br></pre></td></tr></table></figure></p>
<h3 id="15-åˆ›å»ºå•ä¾‹æ¨¡å¼"><a href="#15-åˆ›å»ºå•ä¾‹æ¨¡å¼" class="headerlink" title="15. åˆ›å»ºå•ä¾‹æ¨¡å¼"></a>15. åˆ›å»ºå•ä¾‹æ¨¡å¼</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">object Resource &#123;</span><br><span class="line">    val name = &quot;Name&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="16-try-catch"><a href="#16-try-catch" class="headerlink" title="16. try-catch"></a>16. try-catch</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    count()</span><br><span class="line">&#125;catch (e: ArithmeticException) &#123;</span><br><span class="line">    throw IllegaStateException(e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ç›´æ¥è¿”å›try-catchç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fun test() &#123;</span><br><span class="line">    val result = try &#123;</span><br><span class="line">        count()</span><br><span class="line">    &#125;catch (e: ArithmeticException) &#123;</span><br><span class="line">        throw IllegaStateException(e)</span><br><span class="line">    &#125;</span><br><span class="line">    //å¤„ç† result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="17-è¿”å›ä¸è·³è½¬"><a href="#17-è¿”å›ä¸è·³è½¬" class="headerlink" title="17. è¿”å›ä¸è·³è½¬"></a>17. è¿”å›ä¸è·³è½¬</h3><p>return break ç»“æŸæœ€è¿‘çš„é—­åˆå¾ªç¯ continue è·³åˆ°æœ€è¿‘çš„é—­åˆå¾ªç¯çš„ä¸‹ä¸€æ¬¡å¾ªç¯ã€‚</p>
<p>ä½¿ç”¨æ ‡ç­¾å¿«é€Ÿè·³è½¬ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">loop@ for(i in 1..5)&#123;</span><br><span class="line">        println(&quot;-i: $i&quot;)</span><br><span class="line">        for(j in 11..17)&#123;</span><br><span class="line">            if(14 == j)&#123;</span><br><span class="line">                break@loop</span><br><span class="line">            &#125;</span><br><span class="line">            println(&quot;-&gt; j: $j&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>è¾“å‡ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-i: 1</span><br><span class="line">-&gt; j: 11</span><br><span class="line">-&gt; j: 12</span><br><span class="line">-&gt; j: 13</span><br></pre></td></tr></table></figure></p>
<p>break æ˜¯è·³è½¬æ ‡ç­¾åé¢çš„è¡¨è¾¾å¼ï¼Œcontinue æ˜¯è·³è½¬åˆ°å¾ªç¯çš„ä¸‹ä¸€æ¬¡è¿­ä»£ã€‚<br><br>return å…è®¸æˆ‘ä»¬è¿”å›åˆ°å¤–å±‚å‡½æ•°ã€‚æœ€é‡è¦çš„ä¾‹å­å°±æ˜¯ä»å­—é¢å‡½æ•°ä¸­è¿”å›ã€‚</p>
<p><strong>å‚è€ƒï¼š</strong><br>1. <a href="http://kotlinlang.org/docs/reference/basic-syntax.html" target="_blank" rel="noopener">http://kotlinlang.org/docs/reference/basic-syntax.html</a><br>2. <a href="http://huanglizhuo.gitbooks.io/kotlin-in-chinese" target="_blank" rel="noopener">http://huanglizhuo.gitbooks.io/kotlin-in-chinese</a></p>
]]></content>
      
        
        <tags>
            
            <tag> kotlin </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä½¿ç”¨Kotlin+Ankoå¼€å‘Androidï¼ˆä¸€ï¼‰]]></title>
      <url>/2015/09/11/Android-%E4%BD%BF%E7%94%A8Kotlin-Anko%E5%BC%80%E5%8F%91Android%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>Kotlinæ˜¯ç”±JetBrainså¼€å‘å¹¶ä¸”å¼€æºçš„é™æ€ç±»å‹JVMè¯­è¨€ã€‚æ¯”Javaè¯­è¨€è¯­æ³•ç®€æ´ï¼Œæ”¯æŒå¾ˆå¤šJavaä¸­ä¸æ”¯æŒçš„è¯­æ³•ç‰¹æ€§ï¼Œå¦‚é«˜é˜¶å‡½æ•°ã€å…§è”å‡½æ•°ã€nullå®‰å…¨ã€çµæ´»æ‰©å±•ã€æ“ä½œç¬¦é‡è½½ç­‰ç­‰ã€‚è€Œä¸”å®ƒè¿˜å®Œå…¨å…¼å®¹Javaï¼Œä¸Scalaç±»ä¼¼ï¼Œä½†æ˜¯Scalaçš„å®—æ—¨æ˜¯&ldquo;å°½å¯èƒ½è‡ªå·±å®ç°ï¼Œä¸å¾—å·²æ‰ä½¿ç”¨Java&rdquo;ï¼Œè€ŒKotlinå´ç›¸åï¼š&ldquo;å°½å¯èƒ½å¤ç”¨Javaçš„å®ç°ï¼Œä¸å¾—å·²æ‰è‡ªå·±å®ç°&rdquo;ã€‚æ‰€ä»¥ç›¸æ¯”ä¹‹ä¸‹Kotlinæ›´ç®€æ´è½»é‡ï¼Œéå¸¸é€‚åˆç§»åŠ¨ç«¯çš„å¼€å‘ã€‚å¦å¤–JetBrainsé’ˆå¯¹Androidå¼€å‘æä¾›äº†ä¸€ä¸ªç”±Kotlinå®ç°çš„&ldquo;anko&rdquo;å¼€æºåº“ï¼Œå¯ä»¥è®©ä½ ä½¿ç”¨DSLçš„æ–¹å¼ç›´æ¥ç”¨ä»£ç ç¼–å†™UIï¼Œè®©ä½ ä»ç¹ççš„xmlä¸­è§£è„±å‡ºæ¥ï¼Œè€Œä¸”é¿å…äº†xmlè§£æè¿‡ç¨‹æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<p>&nbsp;</p>
<p>è¿™ç¯‡å…ˆè®²æ€ä¹ˆå»ä½¿ç”¨ideaï¼ˆAndroid Studioç”¨æˆ·ä¹Ÿä¸€æ ·ï¼‰æ­å»ºKotlinçš„Androidå¼€å‘ç¯å¢ƒã€‚</p>
<p>&nbsp;</p>
<p><span style="font-size: 15px;"><strong>ä¸€ã€ä¸‹è½½ä»¥ä¸‹ç›¸å…³ideaæ’ä»¶ï¼š</strong></span></p>
<p>1. Kotlin</p>
<p>2. Kotlin Extensions For Android</p>
<p>3. Anko DSL Preview</p>
<p>å…¶ä¸­Anko DSL Previewæ’ä»¶ç”¨äºé¢„è§ˆä½¿ç”¨DSLç¼–å†™çš„UIä»£ç ï¼Œå°±åƒä»¥å‰ä½¿ç”¨xmlç¼–å†™UIæ–‡ä»¶æ—¶å¯ä»¥åŠ¨æ€åœ¨&ldquo;Preview&rdquo;çª—å£é¢„è§ˆæ•ˆæœä¸€æ ·ã€‚</p>
<p>&nbsp;</p>
<p><span style="font-size: 15px;"><strong>äºŒã€æ–°å»ºAndroidé¡¹ç›®</strong></span></p>
<p>åœ¨src/mainç›®å½•ä¸‹ï¼Œæ–°å»ºkotlinç›®å½•ï¼ˆç”¨äºæ”¾ç½®kotlinä»£ç ï¼‰ï¼Œé…ç½®Gradleå¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">buildscript {<br></span><span style="color: #008080;"> 2</span>     ext.kotlin_version = â€˜0.12.1230â€™<br><span style="color: #008080;"> 3</span> <span style="color: #000000;">    repositories {<br></span><span style="color: #008080;"> 4</span> <span style="color: #000000;">        mavenCentral()<br></span><span style="color: #008080;"> 5</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">    dependencies {<br></span><span style="color: #008080;"> 7</span>         classpath â€˜com.android.tools.build:gradle:1.1.1â€™<br><span style="color: #008080;"> 8</span>         classpath â€œorg.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_versionâ€<br><span style="color: #008080;"> 9</span>         classpath â€œorg.jetbrains.kotlin:kotlin-android-extensions:$kotlin_versionâ€<br><span style="color: #008080;">10</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">12</span> apply plugin: â€˜com.android.applicationâ€™<br><span style="color: #008080;">13</span> apply plugin: â€˜kotlin-androidâ€™<br><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> <span style="color: #000000;">repositories {<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    mavenCentral()<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span> <span style="color: #000000;">android {<br></span><span style="color: #008080;">20</span>     compileSdkVersion 22<br><span style="color: #008080;">21</span>     buildToolsVersion â€œ22.0.1â€<br><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> <span style="color: #000000;">    defaultConfig {<br></span><span style="color: #008080;">24</span>         applicationId â€œcom.wangjie.androidwithkotlinâ€<br><span style="color: #008080;">25</span>         minSdkVersion 9<br><span style="color: #008080;">26</span>         targetSdkVersion 22<br><span style="color: #008080;">27</span>         versionCode 1<br><span style="color: #008080;">28</span>         versionName â€œ1.0â€<br><span style="color: #008080;">29</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span> <span style="color: #000000;">    sourceSets {<br></span><span style="color: #008080;">32</span>         main.java.srcDirs += â€˜src/main/kotlinâ€™<br><span style="color: #008080;">33</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">34</span><br><span style="color: #008080;">35</span> <span style="color: #000000;">    buildTypes {<br></span><span style="color: #008080;">36</span> <span style="color: #000000;">        release {<br></span><span style="color: #008080;">37</span>             minifyEnabled <span style="color: #0000ff;">false</span><br><span style="color: #008080;">38</span>             proguardFiles getDefaultProguardFile(â€˜proguard-android.txtâ€™), â€˜proguard-rules.proâ€™<br><span style="color: #008080;">39</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">40</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">41</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">42</span><br><span style="color: #008080;">43</span> <span style="color: #000000;">dependencies {<br></span><span style="color: #008080;">44</span>     compile fileTree(dir: â€˜libsâ€™, include: [â€˜*.jarâ€™<span style="color: #000000;">])<br></span><span style="color: #008080;">45</span>     compile â€˜com.android.support:appcompat-v7:22.2.0â€™<br><span style="color: #008080;">46</span>     compile â€œorg.jetbrains.kotlin:kotlin-stdlib:$kotlin_versionâ€<br><span style="color: #008080;">47</span>     compile â€œorg.jetbrains.kotlin:kotlin-reflect:$kotlin_versionâ€<br><span style="color: #008080;">48</span>     compile â€˜org.jetbrains.anko:anko:0.6.3-15â€™<br><span style="color: #008080;">49</span> }</pre><br></div>

<p>ç„¶åsync &amp; buildã€‚</p>
<p>&nbsp;</p>
<p><span style="font-size: 15px;"><strong>ä¸‰ã€é…ç½®Kotlin</strong></span></p>
<p>è°ƒç”¨&ldquo;Configuring Kotlin in the project&rdquo;è¿™ä¸ªAction</p>
<p><img src="http://kotlinlang.org/assets/images/tutorials//kotlin-android/configure-kotlin-in-project.png" alt=""></p>
<p><img src="http://kotlinlang.org/assets/images/tutorials//kotlin-android/configure-kotlin-in-project-details.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="font-size: 15px;"><strong>å››ã€æŠŠJavaä»£ç ä¸€é”®è½¬æˆkotlinä»£ç </strong></span></p>
<p>æ‰“å¼€è¦è½¬æ¢çš„Javaæ–‡ä»¶ï¼Œè°ƒç”¨&ldquo;Convert Java File to Kotlin File&rdquo;è¿™ä¸ªActionå³å¯ã€‚</p>
<p><img src="http://kotlinlang.org/assets/images/tutorials//kotlin-android/convert-java-to-kotlin.png" alt=""></p>
<p>è½¬æ¢ä¹‹å‰çš„Javaä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> ActionBarActivity {<br><br>    @Override<br>    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> onCreateOptionsMenu(Menu menu) {<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> Inflate the menu; this adds items to the action bar if it is present.</span><br><span style="color: #000000;">        getMenuInflater().inflate(R.menu.menu_main, menu);<br>        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> onOptionsItemSelected(MenuItem item) {<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> Handle action bar item clicks here. The action bar will<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> automatically handle clicks on the Home/Up button, so long<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> as you specify a parent activity in AndroidManifest.xml.</span><br>        <span style="color: #0000ff;">int</span> id =<span style="color: #000000;"> item.getItemId();<br><br>        </span><span style="color: #008000;">//</span><span style="color: #008000;">noinspection SimplifiableIfStatement</span><br>        <span style="color: #0000ff;">if</span> (id ==<span style="color: #000000;"> R.id.action_settings) {<br>            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br>        }<br><br>        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">super</span><span style="color: #000000;">.onOptionsItemSelected(item);<br>    }<br>}</span></pre><br></div>

<p>è½¬æ¢ä¹‹åçš„Kotlinä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> MainActivity : ActionBarActivity() {<br><br>    override fun onCreate(savedInstanceState: Bundle</span>?<span style="color: #000000;">) {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState)<br>        setContentView(R.layout.activity_main)<br>    }<br><br>    override fun onCreateOptionsMenu(menu: Menu</span>?<span style="color: #000000;">): Boolean {<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> Inflate the menu; this adds items to the action bar if it is present.</span><br><span style="color: #000000;">        getMenuInflater().inflate(R.menu.menu_main, menu)<br>        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;"><br>    }<br><br>    override fun onOptionsItemSelected(item: MenuItem</span>?<span style="color: #000000;">): Boolean {<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> Handle action bar item clicks here. The action bar will<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> automatically handle clicks on the Home/Up button, so long<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> as you specify a parent activity in AndroidManifest.xml.</span><br>        val id = item!!<span style="color: #000000;">.getItemId()<br><br>        </span><span style="color: #008000;">//</span><span style="color: #008000;">noinspection SimplifiableIfStatement</span><br>        <span style="color: #0000ff;">if</span> (id ==<span style="color: #000000;"> R.id.action_settings) {<br>            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;"><br>        }<br><br>        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">super</span><span style="color: #000000;">.onOptionsItemSelected(item)<br>    }<br>}</span></pre><br></div>

<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> kotlin </tag>
            
            <tag> anko </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Kotlinï¼šAndroidä¸–ç•Œçš„Swift]]></title>
      <url>/2015/09/09/Kotlin%EF%BC%9AAndroid%E4%B8%96%E7%95%8C%E7%9A%84Swift/</url>
      <content type="html"><![CDATA[<p>è½¬è‡ªï¼š<a href="http://www.infoq.com/cn/news/2015/06/Android-JVM-JetBrains-Kotlin" target="_blank" rel="noopener">http://www.infoq.com/cn/news/2015/06/Android-JVM-JetBrains-Kotlin</a></p>
<p><a href="http://kotlinlang.org/" target="_blank" rel="noopener">Kotlin</a>æ˜¯ä¸€é—¨ä¸Swiftç±»ä¼¼çš„é™æ€ç±»å‹JVMè¯­è¨€ï¼Œç”±<a href="https://www.jetbrains.com/" target="_blank" rel="noopener">JetBrains</a>è®¾è®¡å¼€å‘å¹¶<a href="https://github.com/jetbrains/kotlin" target="_blank" rel="noopener">å¼€æº</a>ã€‚ä¸Javaç›¸æ¯”ï¼ŒKotlinçš„è¯­æ³•æ›´ç®€æ´ã€æ›´å…·è¡¨è¾¾æ€§ï¼Œè€Œä¸”æä¾›äº†æ›´å¤šçš„ç‰¹æ€§ï¼Œæ¯”å¦‚ï¼Œé«˜é˜¶å‡½æ•°ã€æ“ä½œç¬¦é‡è½½ã€å­—ç¬¦ä¸²æ¨¡æ¿ã€‚å®ƒä¸Javaé«˜åº¦å¯äº’æ“ä½œï¼Œå¯ä»¥åŒæ—¶ç”¨åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ã€‚</p>
<p><a href="http://kotlinlang.org/docs/reference/faq.html" target="_blank" rel="noopener">æŒ‰ç…§JetBrainsçš„è¯´æ³•</a>ï¼Œæ ¹æ®ä»–ä»¬å¤šå¹´çš„Javaå¹³å°å¼€å‘ç»éªŒï¼Œä»–ä»¬è®¤ä¸ºJavaç¼–ç¨‹è¯­è¨€æœ‰ä¸€å®šçš„å±€é™æ€§å’Œé—®é¢˜ï¼Œè€Œä¸”ç”±äºéœ€è¦å‘åå…¼å®¹ï¼Œå®ƒä»¬ä¸å¯èƒ½æˆ–å¾ˆéš¾å¾—åˆ°è§£å†³ã€‚å› æ­¤ï¼Œä»–ä»¬åˆ›å»ºäº†Kotliné¡¹ç›®ï¼Œä¸»è¦ç›®æ ‡æ˜¯ï¼š</p>
<ul>
<li>åˆ›å»ºä¸€ç§å…¼å®¹Javaçš„è¯­è¨€</li>
<li>ç¼–è¯‘é€Ÿåº¦è‡³å°‘åŒJavaä¸€æ ·å¿«</li>
<li>æ¯”Javaæ›´å®‰å…¨</li>
<li>æ¯”Javaæ›´ç®€æ´</li>
<li>æ¯”æœ€æˆç†Ÿçš„ç«äº‰è€…Scalaè¿˜ç®€å•</li>
</ul>
<p><a href="http://tutsplus.com/authors/ashraff-hathibelagal" target="_blank" rel="noopener">Ashraff Hathibelagal</a>æ˜¯ä¸€åå–œæ¬¢ç ”ç©¶æ–°æ¡†æ¶å’ŒSDKçš„ç‹¬ç«‹å¼€å‘è€…ã€‚è¿‘æ—¥ï¼Œä»–<a href="http://code.tutsplus.com/tutorials/an-introduction-to-kotlin--cms-24051" target="_blank" rel="noopener">æ’°æ–‡</a>ä»‹ç»äº†Kotlinçš„ä¸€äº›è¯­æ³•ã€‚æŒ‰ç…§ä»–çš„è¯´æ³•ï¼Œä¸€ä¸ªåˆæ ¼çš„Javaç¨‹åºå‘˜å¯ä»¥åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…å­¦ä¼šä½¿ç”¨Kotlinã€‚</p>
<p><strong>ç±»ä¸æ„é€ å‡½æ•°</strong></p>
<p>Kotlinåˆ›å»ºç±»çš„æ–¹å¼ä¸Javaç±»ä¼¼ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ªæœ‰ä¸‰ä¸ªå±æ€§çš„<code>Person</code>ç±»ï¼š</p>
<pre><code>class Person{
    var name: String = &quot;&quot;
    var age: Int = 0
    var college: String? = null
}
`&lt;/pre&gt;

å¯ä»¥çœ‹åˆ°ï¼ŒKotlinçš„å˜é‡å£°æ˜æ–¹å¼ç•¥æœ‰äº›ä¸åŒã€‚åœ¨Kotlineä¸­ï¼Œå£°æ˜å˜é‡å¿…é¡»ä½¿ç”¨å…³é”®å­—`var`ï¼Œè€Œå¦‚æœè¦åˆ›å»ºä¸€ä¸ªåªè¯»/åªèµ‹å€¼ä¸€æ¬¡çš„å˜é‡ï¼Œåˆ™éœ€è¦ä½¿ç”¨`val`ä»£æ›¿å®ƒã€‚å¦å¤–ï¼Œä¸ºäº†å®ç°&amp;ldquo;ç©ºå®‰å…¨ï¼ˆnull safetyï¼‰&amp;rdquo;ï¼ŒKotlinå¯¹å¯ä»¥ä¸ºç©ºçš„å˜é‡å’Œä¸å¯ä»¥ä¸ºç©ºçš„å˜é‡ä½œäº†åŒºåˆ†ã€‚åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå˜é‡`name`å’Œ`age`ä¸å¯ä¸ºç©ºï¼Œè€Œ`ï¼Ÿ`è¡¨æ˜å˜é‡`college`å¯ä»¥ä¸ºç©ºã€‚å®šä¹‰å®Œç±»ä¹‹åï¼Œåˆ›å»ºå®ä¾‹å°±éå¸¸ç®€å•äº†ï¼š

&lt;pre&gt;`var jake = Person()
`&lt;/pre&gt;

æ³¨æ„ï¼ŒKotlinæ²¡æœ‰å…³é”®å­—`new`ã€‚å®ä¾‹åˆ›å»ºå®Œæˆåï¼Œå°±å¯ä»¥åƒåœ¨Javaä¸­ä¸€æ ·ä¸ºå˜é‡èµ‹å€¼äº†ï¼š

&lt;pre&gt;`jake.name = &quot;Jake Hill&quot;
jake.age = 24
jake.college = &quot;Stephen&apos;s College&quot;
`&lt;/pre&gt;

å˜é‡å¯ä»¥é‡‡ç”¨ä¸Šè¿°æ–¹å¼èµ‹å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°èµ‹å€¼ï¼Œä½†åè€…æ˜¯ä¸€ç§æ›´å¥½çš„ç¼–ç å®è·µã€‚åœ¨Kotlinä¸­ï¼Œåˆ›å»ºè¿™æ ·çš„ä¸€ä¸ªæ„é€ å‡½æ•°éå¸¸ç®€å•ï¼š

&lt;pre&gt;`class Person(var name: String, var age: Int, var college: String?) {
}
`&lt;/pre&gt;

è€Œå®é™…ä¸Šï¼Œç”±äºæ„é€ å‡½æ•°ä¸­æ²¡æœ‰å…¶å®ƒæ“ä½œï¼Œæ‰€ä»¥èŠ±æ‹¬å·ä¹Ÿå¯ä»¥çœç•¥ï¼Œä»£ç å˜å¾—ç›¸å½“ç®€æ´ï¼š

&lt;pre&gt;`class Person(var name: String, var age: Int, var college: String?)

var jake = Person(&quot;Jake Hill&quot;, 24, &quot;Stephen&apos;s College&quot;)
`&lt;/pre&gt;

ä¸Šè¿°ä»£ç ä¸­çš„æ„é€ å‡½æ•°æ˜¯ç±»å¤´çš„ä¸€éƒ¨åˆ†ï¼Œç§°ä¸ºä¸»æ„é€ å‡½æ•°ã€‚åœ¨Kotlinä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨`constructor`å…³é”®å­—åˆ›å»ºè¾…åŠ©æ„é€ å‡½æ•°ï¼Œä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç å¢åŠ äº†ä¸€ä¸ªè¾…åŠ©æ„é€ å‡½æ•°åˆå§‹åŒ–å˜é‡`email`ï¼š

&lt;pre&gt;`class Person(var name: String, var age: Int, var college: String?) {

    var email: String = &quot;&quot;

    constructor(name:String, age:Int, college: String?, email: String) : this(name, age, college) {
        this.email = email
    }
}
`&lt;/pre&gt;

Kotlinå…è®¸åˆ›å»ºæ´¾ç”Ÿç±»ï¼Œä½†è¦éµå¾ªå¦‚ä¸‹è§„åˆ™ï¼š
</code></pre><ul>
<li>å¿…é¡»ä½¿ç”¨<code>ï¼š</code>ä»£æ›¿Javaä¸­çš„<code>extends</code>å…³é”®å­—</li>
<li>åŸºç±»å¤´å¿…é¡»æœ‰<code>open</code>æ³¨è§£</li>
<li><p>åŸºç±»å¿…é¡»æœ‰ä¸€ä¸ªå¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œæ´¾ç”Ÿç±»è¦åœ¨å®ƒè‡ªå·±çš„å¤´ä¸­åˆå§‹åŒ–é‚£äº›å‚æ•°</p>
<p>æ¯”å¦‚ä¸‹é¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ªåä¸º<code>Empoyee</code>çš„æ´¾ç”Ÿç±»ï¼š</p>
<pre>`open class Person(var name: String, var age: Int, var college: String?) {
    ...
}

class Employee(name: String, age: Int, college: String?, var company: String) : Person(name, age, college) {
}
`</pre>

<p><strong>å‡½æ•°ä¸æ‰©å±•</strong></p>
<p>æœ‰æ´¾ç”Ÿå°±æœ‰é‡è½½ã€‚ä¸ç±»çš„æ´¾ç”Ÿä¸€æ ·ï¼Œå…è®¸é‡è½½çš„æ–¹æ³•è¦æœ‰<code>open</code>æ³¨è§£ï¼Œè€Œåœ¨æ´¾ç”Ÿç±»ä¸­é‡è½½æ—¶è¦ä½¿ç”¨<code>override</code>æ³¨è§£ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯åœ¨<code>Employee</code>ç±»ä¸­é‡è½½<code>Person</code>ç±»çš„<code>isEligibleToVote</code>æ–¹æ³•çš„ä»£ç ï¼š</p>
<pre>`override fun isEligibleToVote(): Boolean {
    return true
}
`</pre>

<p>é™¤äº†æ”¹å˜ç±»çš„å·²æœ‰è¡Œä¸ºï¼ŒKotlinè¿˜å…è®¸å¼€å‘è€…åœ¨ä¸ä¿®æ”¹ç±»çš„åŸå§‹å®šä¹‰çš„æƒ…å†µä¸‹å®ç°å¯¹ç±»çš„æ‰©å±•ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ä¸º<code>Person</code>ç±»å¢åŠ äº†ä¸€ä¸ªåä¸º<code>isTeenager</code>çš„æ‰©å±•ï¼š</p>
<pre>`fun Person.isTeenager(): Boolean {
    return age in 13..19
}
`</pre>

<p>åœ¨éœ€è¦æ‰©å±•æ¥è‡ªå…¶å®ƒé¡¹ç›®çš„ç±»æ—¶ï¼Œè¿™ä¸ªç‰¹æ€§ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<p>ä¸Šé¢æåˆ°çš„å‡½æ•°éƒ½ä¸Javaä¸­çš„å‡½æ•°ç±»ä¼¼ï¼Œä½†Kotlinè¿˜æ”¯æŒå…¶å®ƒç±»å‹çš„å‡½æ•°ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°è¿”å›å•ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>=</code>æ¥å®šä¹‰å‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ›å»ºå•è¡¨è¾¾å¼å‡½æ•°çš„ä¾‹å­ï¼š</p>
<pre>`fun isOctogenarian(): Boolean = age in 80 .. 89
`</pre>

<p>Kotlinè¿˜æ”¯æŒé«˜é˜¶å‡½æ•°å’ŒLambdaè¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œlambdaè¡¨è¾¾å¼<code>{x,y-&amp;gt;x+y}</code>å¯ä»¥åƒä¸‹é¢è¿™æ ·ç»™ä¸€ä¸ªå˜é‡èµ‹å€¼ï¼š</p>
<pre>`val sumLambda: (Int, Int) -&gt; Int = {x,y -&gt; x+y}
`</pre>

<p>è€Œä¸‹é¢çš„é«˜é˜¶å‡½æ•°å°†ä¸Šè¿°è¡¨è¾¾å¼ä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œå¹¶å°†è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœç¿»å€ï¼š</p>
<pre>`fun doubleTheResult(x:Int, y:Int, f:(Int, Int)-&gt;Int): Int {
    return f(x,y) * 2
}
`</pre>

<p>è¯¥å‡½æ•°å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å…¶ä¸­ä¸€ç§æ–¹å¼è°ƒç”¨ï¼š</p>
<pre>`val result1 = doubleTheResult(3, 4, sumLambda)
`</pre>

<p>æˆ–</p>
<pre>`val result2 = doubleTheResult(3, 4, {x,y -&gt; x+y})
`</pre>

<p><strong>èŒƒå›´è¡¨è¾¾å¼</strong></p>
<p>åœ¨Kotlinä¸­ï¼ŒèŒƒå›´è¡¨è¾¾å¼ç”¨çš„æ¯”è¾ƒå¤šã€‚èŒƒå›´åˆ›å»ºåªéœ€è¦<code>..</code>æ“ä½œç¬¦ï¼Œä¾‹å¦‚ï¼š</p>
<pre>`val r1 = 1..5
//è¯¥èŒƒå›´åŒ…å«æ•°å€¼1,2,3,4,5
`</pre>

<p>å¦‚æœåˆ›å»ºä¸€ä¸ªé™åºèŒƒå›´ï¼Œåˆ™éœ€è¦ä½¿ç”¨<code>downTo</code>å‡½æ•°ï¼Œä¾‹å¦‚ï¼š</p>
<pre>`val r2 = 5 downTo 1
//è¯¥èŒƒå›´åŒ…å«æ•°å€¼5,4,3,2,1
`</pre>

<p>å¦‚æœæ­¥é•¿ä¸æ˜¯1ï¼Œåˆ™éœ€è¦ä½¿ç”¨<code>step</code>å‡½æ•°ï¼Œä¾‹å¦‚ï¼š</p>
<pre>`val r3 = 5 downTo 1 step 2
//è¯¥èŒƒå›´åŒ…å«æ•°å€¼5,3,1
`</pre>

<p><strong>æ¡ä»¶ç»“æ„</strong></p>
<p>åœ¨Kotlinä¸­ï¼Œifæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ ¹æ®æ¡ä»¶æ˜¯å¦æ»¡è¶³è¿”å›ä¸åŒçš„å€¼ï¼Œä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç å°†<code>isEligibleToVote</code>è®¾ç½®ä¸º&ldquo;Yes&rdquo;</p>
<pre>`var age = 20
val isEligibleToVote = if(age &gt; 18) "Yes" else "No"
`</pre>

<p><code>when</code>è¡¨è¾¾å¼ç›¸å½“äºJavaçš„<code>switch</code>ï¼Œä½†åŠŸèƒ½æ›´å¼ºå¤§ï¼Œä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç å°†<code>typeOfPerson</code>è®¾ç½®ä¸º&ldquo;Teenager&rdquo;ï¼š</p>
<pre>`val age = 17

val typeOfPerson = when(age){
    0 -&gt; "New born"
    in 1..12 -&gt; "Child"
    in 13..19 -&gt; "Teenager"
    else -&gt; "Adult"
}
`</pre>

<p><strong>å¾ªç¯ç»“æ„</strong></p>
<p>Kotlinä½¿ç”¨<code>for..in</code>éå†æ•°ç»„ã€é›†åˆåŠå…¶å®ƒæä¾›äº†è¿­ä»£å™¨çš„æ•°æ®ç»“æ„ï¼Œè¯­æ³•åŒJavaå‡ ä¹å®Œå…¨ç›¸åŒï¼Œåªæ˜¯ç”¨<code>in</code>æ“ä½œç¬¦å–ä»£äº†<code>:</code>æ“ä½œç¬¦ï¼Œä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç å°†éå†ä¸€ä¸ª<code>String</code>å¯¹è±¡æ•°ç»„ï¼š</p>
<pre>`val names = arrayOf("Jake", "Jill", "Ashley", "Bill")

for (name in names) {
    println(name)
}
`</pre>

<p><code>while</code>å’Œ<code>do..while</code>å¾ªç¯çš„è¯­æ³•ä¸Javaå®Œå…¨ç›¸åŒã€‚</p>
<p><strong>å­—ç¬¦ä¸²æ¨¡æ¿</strong></p>
<p>Kotlinå…è®¸åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡å’Œè¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š</p>
<p><pre>`val name = â€œBobâ€<br>println(â€œMy name is ${name}â€) //æ‰“å°â€My name is Bobâ€</pre></p>
<p>val a = 10<br>val b = 20<br>println(â€œThe sum is ${a+b}â€) //æ‰“å°â€The sum is 30â€</p>
</li>
</ul>
<p>æ­¤å¤–ï¼ŒKotlinä¸Javaé«˜åº¦å¯äº’æ“ä½œã€‚Kotlinå¯ä»¥ç”¨ä¸€ç§è‡ªç„¶çš„æ–¹å¼è°ƒç”¨ç°æœ‰çš„Javaä»£ç ï¼Œè€ŒJavaä¹Ÿå¾ˆå®¹æ˜“è°ƒç”¨Kotlinä»£ç ã€‚åŒæ—¶ï¼ŒKotlinä¹Ÿå¯ä»¥ä¸JavaScriptäº’æ“ä½œã€‚</p>
<p>ä¸Šé¢ä»‹ç»çš„åªæ˜¯Kotlinçš„ä¸€äº›åŸºæœ¬è¯­æ³•å’Œç‰¹æ€§ï¼Œæ›´å¤šç»†èŠ‚è¯·æŸ¥é˜…<a href="http://kotlinlang.org/docs/reference/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚äº‹å®ä¸Šï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼ŒKotlinè¿˜ä»ç„¶åªæ˜¯ä¸€ä¸ªé¢„è§ˆç‰ˆæœ¬ï¼Œæ¥ä¸‹æ¥çš„å‡ ä¸ªæœˆä¸­è¿˜ä¼šæœ‰å¤šé¡¹é‡å¤§æ”¹è¿›åŠæ–°å¢ç‰¹æ€§ã€‚å°½ç®¡å¦‚æ­¤ï¼Œ<a href="https://github.com/search?q=Kotlin&amp;ref=cmdform" target="_blank" rel="noopener">GitHubä¸Šå·²æœ‰400å¤šä¸ªä¸Kotliné¡¹ç›®ç›¸å…³çš„åº“</a>ã€‚</p>
<p>åœ¨å¦å¤–ä¸€ç¯‡<a href="http://code.tutsplus.com/tutorials/how-to-use-kotlin-in-your-android-projects--cms-24052" target="_blank" rel="noopener">æ–‡ç« </a>ä¸­ï¼ŒHathibelagalå†™é“ï¼Œ&ldquo;å¦‚æœä½ æ­£åœ¨ä¸ºAndroidå¼€å‘å¯»æ‰¾ä¸€ç§æ›¿ä»£ç¼–ç¨‹è¯­è¨€ï¼Œé‚£ä¹ˆåº”è¯¥è¯•ä¸‹Kotlinã€‚å®ƒå¾ˆå®¹æ˜“åœ¨Androidé¡¹ç›®ä¸­æ›¿ä»£Javaæˆ–è€…åŒJavaä¸€èµ·ä½¿ç”¨ã€‚&rdquo;æƒ³è¦äº†è§£å¦‚ä½•åœ¨Android Studioä¸­ä½¿ç”¨Kotlinå¼€å‘Androidé¡¹ç›®çš„è¯»è€…ï¼Œå¯ä»¥è¯»ä¸‹è¿™ç¯‡æ–‡ç« ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> kotlin </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]Androidç«¯ORMæ¡†æ¶â€”â€”RapidORM(v1.0)]]></title>
      <url>/2015/08/21/Android-Android%E7%AB%AFORM%E6%A1%86%E6%9E%B6%E2%80%94%E2%80%94RapidORM-v1-0/</url>
      <content type="html"><![CDATA[<p>Androidä¸Šä¸»æµçš„ORMæ¡†æ¶æœ‰å¾ˆå¤šï¼Œå¸¸ç”¨çš„æœ‰ORMLiteã€GreenDaoç­‰ã€‚</p>
<p>ORMLiteï¼š</p>
<p>ï¼ä¼˜ç‚¹ï¼šAPIå¾ˆå‹å¥½ï¼Œä½¿ç”¨æ¯”è¾ƒæ–¹ä¾¿ç®€å•ç¨³å®šï¼Œç›¸å…³åŠŸèƒ½æ¯”è¾ƒå®Œæ•´ã€‚</p>
<p>ï¼ç¼ºç‚¹ï¼šå†…éƒ¨ä½¿ç”¨åå°„å®ç°ï¼Œæ€§èƒ½å¹¶ä¸æ˜¯å¾ˆå¥½ã€‚</p>
<p>GreenDaoï¼š</p>
<p>ï¼ä¼˜ç‚¹ï¼šæ€§èƒ½å¾ˆä¸é”™ï¼Œ</p>
<p>ï¼ç¼ºç‚¹ï¼šAPIå´ä¸å¤ªå‹å¥½ï¼Œè€Œä¸”ä¸æ”¯æŒå¤åˆä¸»é”®ï¼Œä¸»é”®å¿…é¡»è¦æœ‰å¹¶ä¸”å¿…é¡»æ˜¯longæˆ–è€…Longã€‚æŒä¹…ç±»å¯ä»¥ç”¨å®ƒæä¾›çš„æ¨¡ç‰ˆç”Ÿæˆï¼Œä½†æ˜¯ä¸€æ—¦ä½¿ç”¨äº†å®ƒçš„æ¨¡ç‰ˆï¼ŒæŒä¹…ç±»ã€DAOå°±ä¸èƒ½éšæ„å»ä¿®æ”¹ï¼Œæ‰©å±•æ€§ä¸æ˜¯å¾ˆå¥½ã€‚å¦‚æœä¸ä½¿ç”¨å®ƒçš„æ¨¡ç‰ˆï¼Œä»£ç å†™èµ·æ¥å°±å¾ˆç¹çã€‚</p>
<p>&nbsp;</p>
<p>æ‰€ä»¥ç»“åˆäº†ä¸¤è€…é‡æ–°å†™äº†ä¸€ä¸ªORMï¼š<strong><a href="https://github.com/wangjiegulu/RapidORM" target="_blank" rel="noopener">RapidORM</a></strong>ï¼ˆ<a href="https://github.com/wangjiegulu/RapidORM" target="_blank" rel="noopener"><strong>https://github.com/wangjiegulu/RapidORM</strong></a>ï¼‰</p>
<p>ç‰¹ç‚¹ï¼š</p>
<p>1. æ”¯æŒä½¿ç”¨åå°„å’Œéåå°„ï¼ˆæ¨¡ç‰ˆç”Ÿæˆï¼‰ä¸¤ç§æ–¹å¼å®ç°æ‰§è¡ŒSQLã€‚</p>
<p>2. æ”¯æŒå¤åˆä¸»é”®</p>
<p>3. æ”¯æŒä»»ä½•ä¸»é”®ç±»å‹</p>
<p>4. å…¼å®¹androidåŸç”Ÿçš„&nbsp;<span style="color: #000000; background-color: #e1e1e1;">android.database.sqlite.SQLiteDatabase</span>&nbsp;å’ŒSqlCipherçš„ <span style="background-color: #e1e1e1;">net.sqlcipher.database.SQLiteDatabase</span>ã€‚<span style="background-color: #e1e1e1;"><br></span></p>
<p>ç¼ºç‚¹ï¼š</p>
<p>1. ä¸æ”¯æŒé“¾è¡¨æŸ¥è¯¢ã€‚</p>
<p>&nbsp;</p>
<p><span style="font-size: 18px;"><strong>å¿«é€ŸæŒ‡å—ï¼š</strong></span></p>
<p><strong><span style="font-size: 14px;">ä¸€ã€æ–°å»ºæŒä¹…ç±»Personï¼š</span></strong></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 6/25/15.<br></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 6</span> @Table(propertyClazz = PersonProperty.<span style="color: #0000ff;">class</span><span style="color: #000000;">)<br></span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Person <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Serializable{<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span>     @Column(primaryKey = <span style="color: #0000ff;">true</span><span style="color: #000000;">)<br></span><span style="color: #008080;">10</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Integer id;<br></span><span style="color: #008080;">11</span><br><span style="color: #008080;">12</span>     @Column(primaryKey = <span style="color: #0000ff;">true</span><span style="color: #000000;">)<br></span><span style="color: #008080;">13</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Integer typeId;<br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> <span style="color: #000000;">    @Column<br></span><span style="color: #008080;">16</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span> <span style="color: #000000;">    @Column<br></span><span style="color: #008080;">19</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Integer age;<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> <span style="color: #000000;">    @Column<br></span><span style="color: #008080;">22</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String address;<br></span><span style="color: #008080;">23</span><br><span style="color: #008080;">24</span> <span style="color: #000000;">    @Column<br></span><span style="color: #008080;">25</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Long birth;<br></span><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span> <span style="color: #000000;">    @Column<br></span><span style="color: #008080;">28</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Boolean student;<br></span><span style="color: #008080;">29</span><br><span style="color: #008080;">30</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> getter/setterâ€¦</span><br><span style="color: #008080;">31</span><br><span style="color: #008080;">32</span> }</pre><br></div>

<p>&nbsp;</p>
<p><span style="line-height: 1.5;">1. Tableæ³¨è§£ç”¨äºæ ‡è®°è¿™ä¸ªç±»éœ€è¦æ˜ å°„åˆ°æ•°æ®è¡¨ï¼ŒRapidORMä¼šåˆ›å»ºè¿™ä¸ªè¡¨ã€‚</span></p>
<p>ï¼nameå±æ€§ï¼šè¡¨ç¤ºå¯¹åº”è¡¨çš„åç§°ï¼Œé»˜è®¤ä¸ºç±»çš„simpleNameã€‚</p>
<p>ï¼propertyClazzå±æ€§ï¼šè¡¨ç¤ºå¦‚æœä¸ä½¿ç”¨åå°„æ‰§è¡Œsqlæ—¶ï¼Œéœ€è¦çš„ModelPropertyç±»çš„Classï¼ŒRapidORMä¼šè‡ªåŠ¨åœ¨è¿™ä¸ªModelPropertyä¸­å»ç»‘å®šéœ€è¦æ‰§è¡ŒSQLçš„æ•°æ®ã€‚ä¸å¡«å†™åˆ™è¡¨ç¤ºä½¿ç”¨é»˜è®¤çš„åå°„çš„æ–¹å¼æ‰§è¡ŒSQLã€‚å…·ä½“åé¢ä¼šè®²åˆ°ã€‚</p>
<p>2. Columnæ³¨è§£ç”¨è¯­æ ‡è®°è¿™ä¸ªå­—æ®µæ˜ å°„åˆ°çš„æ•°æ®è¡¨çš„åˆ—ï¼ˆå¦‚æœï¼‰ã€‚</p>
<p>ï¼nameå±æ€§ï¼šè¡¨ç¤ºå¯¹åº”åˆ—çš„åç§°ã€‚é»˜è®¤ä¸ºå­—æ®µçš„åç§°ã€‚</p>
<p>ï¼primaryKeyå±æ€§ï¼šè¡¨ç¤ºæ”¹åˆ—æ˜¯å¦æ˜¯ä¸»é”®ï¼Œé»˜è®¤æ˜¯falseã€‚ï¼ˆå¯ä»¥åœ¨å¤šä¸ªå­—æ®µéƒ½é€‚ç”¨è¿™ä¸ªå±æ€§ï¼Œè¡¨ç¤ºä¸ºå¤åˆä¸»é”®ï¼‰ã€‚</p>
<p>ï¼autoincrementå±æ€§ï¼šè¡¨ç¤ºä¸»é”®æ˜¯å¦æ˜¯è‡ªå¢é•¿ï¼Œåªæœ‰è¯¥å­—æ®µæ˜¯ä¸»é”®å¹¶ä¸”åªæœ‰ä¸€ä¸ªä¸»é”®å¹¶ä¸”æ˜¯Integeræˆ–intç±»å‹æ‰ä¼šç”Ÿæ•ˆã€‚</p>
<p>ï¼defaultValueå±æ€§ï¼šè¡¨ç¤ºè¯¥åˆ—é»˜è®¤å€¼ã€‚</p>
<p>ï¼notNullå±æ€§ï¼šè¡¨ç¤ºè¯¥åˆ—ä¸èƒ½ä¸ºç©ºã€‚</p>
<p>ï¼uniqueå±æ€§ï¼šè¡¨ç¤ºè¯¥åˆ—å”¯ä¸€çº¦æŸã€‚</p>
<p>ï¼uniqueComboå±æ€§ï¼šæš‚æœªå®ç°ã€‚</p>
<p>ï¼indexå±æ€§ï¼šæš‚æœªå®ç°ã€‚</p>
<p>&nbsp;</p>
<p><strong><span style="font-size: 14px;">äºŒã€æ³¨å†ŒæŒä¹…ç±»ï¼Œå¹¶æŒ‡å®šSQLiteOpenHelperï¼š</span></strong></p>
<p>æ–°å»ºç±»DatabaseFactoryï¼Œç»§æ‰¿RapidORMConnectionï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 6/25/15.<br></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> DatabaseFactory <span style="color: #0000ff;">extends</span> RapidORMConnection&lt;RapidORMDefaultSQLiteOpenHelperDelegate&gt;<span style="color: #000000;"> {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> VERSION = 1<span style="color: #000000;">;<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> DatabaseFactory instance;<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">synchronized</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> DatabaseFactory getInstance() {<br></span><span style="color: #008080;">12</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> instance) {<br></span><span style="color: #008080;">13</span>             instance = <span style="color: #0000ff;">new</span><span style="color: #000000;"> DatabaseFactory();<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">15</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> instance;<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> DatabaseFactory() {<br></span><span style="color: #008080;">19</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">();<br></span><span style="color: #008080;">20</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">21</span><br><span style="color: #008080;">22</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">23</span>     <span style="color: #0000ff;">protected</span><span style="color: #000000;"> RapidORMDefaultSQLiteOpenHelperDelegate getRapidORMDatabaseOpenHelper(@NonNull String databaseName) {<br></span><span style="color: #008080;">24</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> RapidORMDefaultSQLiteOpenHelperDelegate(<span style="color: #0000ff;">new</span><span style="color: #000000;"> MyDatabaseOpenHelper(MyApplication.getInstance(), databaseName, VERSION));<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">28</span>     <span style="color: #0000ff;">protected</span> List&lt;Class&lt;?&gt;&gt;<span style="color: #000000;"> registerAllTableClass() {<br></span><span style="color: #008080;">29</span>         List&lt;Class&lt;?&gt;&gt; allTableClass = <span style="color: #0000ff;">new</span> ArrayList&lt;&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">30</span>         allTableClass.add(Person.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br></span><span style="color: #008080;">31</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> all table class</span><br><span style="color: #008080;">32</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> allTableClass;<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">34</span> }</pre><br></div>

<p>DatabaseFactoryæ¨èä½¿ç”¨å•ä¾‹ï¼Œå®ç°RapidORMConnectionçš„getRapidORMDatabaseOpenHelper()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ªRapidORMDatabaseOpenHelperDelegateæˆ–è€…å®ƒçš„å­ç±»å¯¹è±¡ï¼ŒRapidORMDatabaseOpenHelperDelegateæ˜¯SQLiteOpenHelperçš„å§”æ‰˜ï¼Œå› ä¸ºéœ€è¦å…¼å®¹androidåŸç”Ÿçš„&nbsp;<span style="background-color: #e1e1e1;">android.database.sqlite.SQLiteDatabase</span>&nbsp;å’ŒSqlCipherçš„&nbsp;<span style="background-color: #e1e1e1;">net.sqlcipher.database.SQLiteDatabase</span> ä¸¤ç§æ–¹å¼ã€‚</p>
<p>å¦‚æœä½¿ç”¨&nbsp;<span style="background-color: #e1e1e1;">android.database.sqlite.SQLiteDatabase</span>&nbsp;ï¼Œåˆ™å¯ä»¥ä½¿ç”¨RapidORMDefaultSQLiteOpenHelperDelegateï¼Œç„¶åæ„é€ æ–¹æ³•ä¸­ä¼ å…¥çœŸæ­£çš„<span style="background-color: #e1e1e1;">android.database.sqlite.SQLiteDatabase</span>&nbsp;ï¼ˆä¹Ÿå°±æ˜¯è¿™é‡Œçš„MyDatabaseOpenHelperï¼‰å³å¯ï¼Œä½¿ç”¨SqlCipherçš„æ–¹å¼åé¢å†è®²ã€‚</p>
<p>è¿˜éœ€è¦å®ç°registerAllTableClass()æ–¹æ³•ï¼Œè¿™é‡Œè¿”å›ä¸€ä¸ªæ‰€æœ‰éœ€è¦æ˜ å°„è¡¨çš„æŒä¹…ç±»Classé›†åˆã€‚</p>
<p>&nbsp;</p>
<p><strong><span style="font-size: 14px;">ä¸‰ã€åœ¨éœ€è¦çš„åœ°æ–¹è¿›è¡Œåˆå§‹åŒ–RapidORMï¼ˆæ¯”å¦‚åœ¨ç™»å½•å®Œæˆä¹‹åï¼‰ï¼š</span></strong></p>
<div class="cnblogs_code"><br><pre>DatabaseFactory.getInstance().resetDatabase(â€œhello_rapid_orm.dbâ€);</pre><br></div>

<p>å¦‚ä¸Šï¼Œè°ƒç”¨resetDatabase()æ–¹æ³•å³å¯åˆå§‹åŒ–æ•°æ®åº“ã€‚</p>
<p>&nbsp;</p>
<p><strong>å››ã€ç¼–å†™Daoï¼š</strong></p>
<p>æ–°å»ºPersonDaoImplç»§æ‰¿BaseDaoImpl&lt;Person&gt;ï¼ˆè¿™é‡Œç®€ç•¥äº†PersonDaoæ¥å£ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 6/26/15.<br></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> PersonDaoImpl <span style="color: #0000ff;">extends</span> BaseDaoImpl&lt;Person&gt;<span style="color: #000000;"> {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> PersonDaoImpl() {<br></span><span style="color: #008080;"> 8</span>         <span style="color: #0000ff;">super</span>(Person.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> }</pre><br></div>

<p>BaseDaoImplä¸­é»˜è®¤å®ç°äº†ä¸‹é¢çš„åŸºæœ¬æ–¹æ³•ï¼ˆTä¸ºèŒƒå‹ï¼ŒæŒ‡å…·ä½“çš„æŒä¹…ç±»ï¼‰ï¼š</p>
<p>ï¼void insert(T model) throws Exception;ã€€ã€€//&nbsp;æ’å…¥ä¸€æ¡æ•°æ®ã€‚</p>
<p>ï¼void update(T model) throws Exception;ã€€ã€€//&nbsp;æ›´æ–°ä¸€æ¡æ•°æ®ã€‚</p>
<p>ï¼void delete(T model) throws Exception;ã€€ã€€// åˆ é™¤ä¸€æ¡æ•°æ®ã€‚</p>
<p>ï¼void deleteAll() throws Exception;ã€€ã€€ã€€ã€€ã€€ã€€// åˆ é™¤è¡¨ä¸­æ‰€æœ‰çš„æ•°æ®</p>
<p>ï¼void insertOrReplace(T model) throws Exception;ã€€ã€€ã€€ã€€// åˆ é™¤æˆ–è€…æ›¿æ¢ï¼ˆæš‚ä¸æ”¯æŒï¼‰</p>
<p>ï¼List&lt;T&gt; queryAll() throws Exception;ã€€ã€€ã€€ã€€ã€€ã€€// æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰æ•°æ®</p>
<p>ï¼List&lt;T&gt; rawQuery(String sql, String[] selectionArgs) throws Exception;ã€€ã€€ã€€ã€€ã€€ã€€// ä½¿ç”¨åŸç”ŸsqlæŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰çš„æ•°æ®</p>
<p>ï¼void rawExecute(String sql, Object[] bindArgs) throws Exception;ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// ä½¿ç”¨åŸç”Ÿsqlæ‰§è¡Œä¸€æ¡sqlè¯­å¥</p>
<p>ï¼void insertInTx(Tâ€¦ models) throws Exception;ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// æ’å…¥å¤šæ¡æ•°æ®ï¼ˆåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼‰</p>
<p>ï¼void insertInTx(Iterable&lt;T&gt; models) throws Exception;ã€€ã€€ã€€ã€€ã€€ã€€// åŒä¸Š</p>
<p>ï¼void updateInTx(Tâ€¦ models) throws Exception;ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// æ›´æ–°å¤šæ¡æ•°æ®ï¼ˆåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼‰</p>
<p>ï¼void updateInTx(Iterable&lt;T&gt; models) throws Exception;ã€€ã€€ã€€ã€€ã€€ã€€// åŒä¸Š</p>
<p>ï¼void deleteInTx(Tâ€¦ models) throws Exception;ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// åˆ é™¤å¤šæ¡æ•°æ®ï¼ˆåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼‰</p>
<p>ï¼void deleteInTx(Iterable&lt;T&gt; models) throws Exception;ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// åŒä¸Š</p>
<p>ï¼void executeInTx(RapidORMSQLiteDatabaseDelegate db, RapidOrmFunc1 func1) throws Exception;&nbsp;// æ‰§è¡Œä¸€ä¸ªæ–¹æ³•ï¼ˆå¯å¤šä¸ªsqlï¼‰ï¼Œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­</p>
<p>ï¼void executeInTx(RapidOrmFunc1 func1) throws Exception;ã€€ã€€ã€€ã€€// åŒä¸Š</p>
<p>&nbsp;</p>
<p><span style="font-size: 15px;"><strong>é¢å‘å¯¹è±¡çš„æ–¹å¼ä½¿ç”¨Whereå’ŒBuilderæ¥æ„å»ºsqlè¯­å¥ï¼š</strong></span></p>
<p><strong>1. Whereï¼š</strong></p>
<p>Whereè¡¨ç¤ºä¸€ç³»åˆ—çš„æ¡ä»¶è¯­å¥ï¼Œå«ä¹‰ä¸SQLä¸­çš„whereå…³é”®å­—ä¸€è‡´ã€‚</p>
<p>æ”¯æŒçš„whereæ“ä½œï¼š</p>
<p>ï¼eq(String column, Object value)ã€€ã€€ã€€ã€€//&nbsp;ç›¸ç­‰æ¡ä»¶åˆ¤æ–­</p>
<p>ï¼ne(String column, Object value)ã€€ã€€ã€€ã€€// ä¸ç›¸ç­‰æ¡ä»¶åˆ¤æ–­</p>
<p>ï¼gt(String column, Object value)ã€€ã€€ã€€ã€€ // å¤§äºæ¡ä»¶åˆ¤æ–­</p>
<p>ï¼lt(String column, Object value)ã€€ã€€ã€€ã€€ã€€// å°äºæ¡ä»¶åˆ¤æ–­</p>
<p>ï¼ge(String column, Object value)ã€€ã€€ã€€ã€€ //&nbsp;å¤§äºç­‰äºæ¡ä»¶</p>
<p>ï¼le(String column, Object value)ã€€ã€€ã€€ã€€ã€€// å°äºç­‰äºæ¡ä»¶</p>
<p>ï¼in(String column, Objectâ€¦ values)ã€€ã€€ã€€ // åŒ…å«æ¡ä»¶</p>
<p>ï¼ni(String column, Objectâ€¦ values)ã€€ã€€ã€€ // ä¸åŒ…å«æ¡ä»¶</p>
<p>ï¼isNull(String column)ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€//&nbsp;nullæ¡ä»¶åˆ¤æ–­</p>
<p>ï¼notNull(String column)ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// ä¸ä¸ºnullæ¡ä»¶åˆ¤æ–­</p>
<p>ï¼between(String column, Object value1, Object value2)ã€€ã€€//&nbsp;BETWEEN â€¦ AND â€¦â€ condition</p>
<p>ï¼like(String column, Object value)ã€€ã€€ã€€ã€€ã€€ã€€// æ¨¡ç³ŠåŒ¹é…æ¡ä»¶</p>
<p>ï¼Where raw(String rawWhere, Objectâ€¦ values)ã€€ã€€// åŸç”Ÿsqlæ¡ä»¶</p>
<p>ï¼and(Whereâ€¦ wheres)ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// å¤šä¸ªWhereä¸</p>
<p>ï¼or(Whereâ€¦ wheres)ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// å¤šä¸ªWhereæˆ–</p>
<p>&nbsp;</p>
<p>Whereä¸¾ä¾‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #000000;">    Where.and(<br></span><span style="color: #008080;">2</span>                 Where.like(PersonProperty.name.column, â€œ%wangjie%â€<span style="color: #000000;">),<br></span><span style="color: #008080;">3</span>                 Where.lt(PersonProperty.id.column, 200<span style="color: #000000;">),<br></span><span style="color: #008080;">4</span> <span style="color: #000000;">                Where.or(<br></span><span style="color: #008080;">5</span>                         Where.between(PersonProperty.age.column, 19, 39<span style="color: #000000;">),<br></span><span style="color: #008080;">6</span> <span style="color: #000000;">                        Where.isNull(PersonProperty.address.column)<br></span><span style="color: #008080;">7</span> <span style="color: #000000;">                ),<br></span><span style="color: #008080;">8</span>                 Where.eq(PersonProperty.typeId.column, 1<span style="color: #000000;">)<br></span><span style="color: #008080;">9</span>         )</pre><br></div>

<p>å¦‚ä¸Šï¼Œ</p>
<p>Line2æ¡ä»¶ï¼šnameæ¨¡ç³ŠåŒ¹é…wangjie</p>
<p>Line3æ¡ä»¶ï¼šidå°äº200</p>
<p>Line5æ¡ä»¶ï¼šageåœ¨19åˆ°39ä¹‹é—´</p>
<p>Line6æ¡ä»¶ï¼šaddressä¸æ˜¯null</p>
<p>Line8æ¡ä»¶ï¼štypeIdç­‰äº1</p>
<p>Line4æ¡ä»¶ï¼šLine5æ¡ä»¶å’ŒLine6æ¡ä»¶æ˜¯orå…³ç³»ï¼›</p>
<p>Line1æ¡ä»¶ï¼šLine2ã€Line3ã€Line4ã€Line8æ¡ä»¶æ˜¯andå…³ç³»ã€‚</p>
<p>&nbsp;</p>
<p><strong>2. QueryBuilderï¼š</strong></p>
<p>QueryBuilderç”¨äºæ„å»ºæŸ¥è¯¢è¯­å¥ã€‚</p>
<p>ï¼setWhere(Where where)ã€€ã€€ã€€ã€€// è®¾ç½®Whereæ¡ä»¶ï¼›</p>
<p>ï¼setLimit(Integer limit)ã€€ã€€ã€€ã€€ã€€ã€€// è®¾ç½®limit</p>
<p>ï¼addSelectColumn(Stringâ€¦ selectColumn)ã€€ã€€ã€€ã€€// è®¾ç½®æŸ¥è¯¢çš„æ•°æ®åˆ—åï¼ˆå¯ä»¥è°ƒç”¨å¤šéæ¥è®¾ç½®å¤šä¸ªï¼Œé»˜è®¤æ˜¯æŸ¥è¯¢æ‰€æœ‰æ•°æ®ï¼‰</p>
<p>ï¼addOrder(String column, boolean isAsc)ã€€ã€€ã€€ã€€ã€€// è®¾ç½®æŸ¥è¯¢ç»“æœçš„æ’åºï¼ˆå¯ä»¥è°ƒç”¨å¤šéæ¥è®¾ç½®å¤šä¸ªï¼‰</p>
<p>&nbsp;</p>
<p>QueryBuilderä¸¾ä¾‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span>     <span style="color: #0000ff;">public</span> List&lt;Person&gt; findPersonsByWhere() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {<br></span><span style="color: #008080;"> 2</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> queryBuilder()<br></span><span style="color: #008080;"> 3</span> <span style="color: #000000;">                .addSelectColumn(PersonProperty.id.column, PersonProperty.typeId.column, PersonProperty.name.column,<br></span><span style="color: #008080;"> 4</span> <span style="color: #000000;">                        PersonProperty.age.column, PersonProperty.birth.column, PersonProperty.address.column)<br></span><span style="color: #008080;"> 5</span> <span style="color: #000000;">                .setWhere(Where.and(<br></span><span style="color: #008080;"> 6</span>                         Where.like(PersonProperty.name.column, â€œ%wangjie%â€<span style="color: #000000;">),<br></span><span style="color: #008080;"> 7</span>                         Where.lt(PersonProperty.id.column, 200<span style="color: #000000;">),<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">                        Where.or(<br></span><span style="color: #008080;"> 9</span>                                 Where.between(PersonProperty.age.column, 19, 39<span style="color: #000000;">),<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">                                Where.isNull(PersonProperty.address.column)<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">                        ),<br></span><span style="color: #008080;">12</span>                         Where.eq(PersonProperty.typeId.column, 1<span style="color: #000000;">)<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">                ))<br></span><span style="color: #008080;">14</span>                 .addOrder(PersonProperty.id.column, <span style="color: #0000ff;">false</span><span style="color: #000000;">)<br></span><span style="color: #008080;">15</span>                 .addOrder(PersonProperty.name.column, <span style="color: #0000ff;">true</span><span style="color: #000000;">)<br></span><span style="color: #008080;">16</span>                 .setLimit(10<span style="color: #000000;">)<br></span><span style="color: #008080;">17</span>                 .query(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">18</span>     }</pre><br></div>

<p>å¦‚ä¸Šï¼Œé€šè¿‡queryBuilder()æ–¹æ³•æ„å»ºä¸€ä¸ªQueryBuilderï¼Œå¹¶è®¾ç½®æŸ¥è¯¢çš„åˆ—åã€Whereã€æ’åºã€limitç­‰å‚æ•°ï¼Œæœ€åè°ƒç”¨query()æ‰§è¡ŒæŸ¥è¯¢ã€‚</p>
<p>&nbsp;</p>
<p><strong>3. UpdateBuilderï¼š</strong></p>
<p>UpdateBuilderç”¨äºæ„å»ºæ›´æ–°è¯­å¥ã€‚</p>
<p>ï¼setWhere(Where where)ã€€ã€€ã€€ã€€// è®¾ç½®Whereæ¡ä»¶ï¼›</p>
<p>ï¼addUpdateColumn(String column, Object value)ã€€ã€€ã€€ã€€// æ·»åŠ éœ€è¦æ›´æ–°çš„å­—æ®µï¼›</p>
<p>&nbsp;</p>
<p>UpdateBuilderä¸¾ä¾‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> updatePerson() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {<br></span><span style="color: #008080;"> 2</span>         <span style="color: #0000ff;">long</span> now =<span style="color: #000000;"> System.currentTimeMillis();<br></span><span style="color: #008080;"> 3</span> <span style="color: #000000;">        updateBuilder()<br></span><span style="color: #008080;"> 4</span> <span style="color: #000000;">                .setWhere(Where.and(<br></span><span style="color: #008080;"> 5</span>                         Where.like(PersonProperty.name.column, â€œ%wangjie%â€<span style="color: #000000;">),<br></span><span style="color: #008080;"> 6</span>                         Where.lt(PersonProperty.id.column, 200<span style="color: #000000;">),<br></span><span style="color: #008080;"> 7</span> <span style="color: #000000;">                        Where.or(<br></span><span style="color: #008080;"> 8</span>                                 Where.between(PersonProperty.age.column, 19, 39<span style="color: #000000;">),<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">                                Where.isNull(PersonProperty.address.column)<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">                        ),<br></span><span style="color: #008080;">11</span>                         Where.eq(PersonProperty.typeId.column, 1<span style="color: #000000;">)<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">                ))<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">                .addUpdateColumn(PersonProperty.birth.column, now)<br></span><span style="color: #008080;">14</span>                 .addUpdateColumn(PersonProperty.address.column, â€œaddress_â€ + now).update(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">15</span>     }</pre><br></div>

<p>å¦‚ä¸Šï¼Œé€šè¿‡updateBuilder()æ–¹æ³•æ„å»ºä¸€ä¸ªUpdateBuilderï¼Œå¹¶è®¾ç½®è¦æ›´æ–°çš„å­—æ®µï¼Œæœ€åè°ƒç”¨update()æ‰§è¡ŒæŸ¥è¯¢ã€‚</p>
<p>&nbsp;</p>
<p><strong>4. DeleteBuilderï¼š&nbsp;</strong></p>
<p>DeleteBuilderç”¨äºæ„å»ºåˆ é™¤è¯­å¥ã€‚</p>
<p>ï¼setWhere(Where where)ã€€ã€€ã€€ã€€// è®¾ç½®Whereæ¡ä»¶ï¼›</p>
<p>&nbsp;</p>
<p>DeleteBuilderä¸¾ä¾‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> deletePerson() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">        deleteBuilder()<br></span><span style="color: #008080;"> 3</span> <span style="color: #000000;">                .setWhere(Where.and(<br></span><span style="color: #008080;"> 4</span>                         Where.like(PersonProperty.name.column, â€œ%wangjie%â€<span style="color: #000000;">),<br></span><span style="color: #008080;"> 5</span>                         Where.lt(PersonProperty.id.column, 200<span style="color: #000000;">),<br></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">                        Where.or(<br></span><span style="color: #008080;"> 7</span>                                 Where.between(PersonProperty.age.column, 19, 39<span style="color: #000000;">),<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">                                Where.isNull(PersonProperty.address.column)<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">                        ),<br></span><span style="color: #008080;">10</span>                         Where.eq(PersonProperty.typeId.column, 1<span style="color: #000000;">)<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">                ))<br></span><span style="color: #008080;">12</span>                 .delete(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">13</span>     }</pre><br></div>

<p>å¦‚ä¸Šï¼Œé€šè¿‡deleteBuilder()æ–¹æ³•æ„å»ºä¸€ä¸ªDeleteBuilderï¼Œå¹¶è®¾ç½®Whereæ¡ä»¶ï¼Œæœ€åè°ƒç”¨delete()æ‰§è¡ŒæŸ¥è¯¢ã€‚</p>
<p>&nbsp;</p>
<p><span style="font-size: 15px;"><strong>ä½¿ç”¨æ¨¡ç‰ˆç”ŸæˆModelPropertyï¼š</strong></span></p>
<p>å¦‚æœä½ æ‰“ç®—ä½¿ç”¨éåå°„çš„æ–¹å¼æ‰§è¡Œsqlï¼Œåˆ™å¯ä»¥ä½¿ç”¨ModelPropertyGeneratoræ¨¡ç‰ˆæ¥ç”Ÿæˆ</p>
<p>1. æ–°å»ºä¸€ä¸ªç±»ï¼Œåœ¨mainæ–¹æ³•ä¸­æ‰§è¡Œï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  Author: wangjie<br> <em> Email: tiantian.china.2@gmail.com
 </em> Date: 7/2/15.<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> MyGenerator {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> main(String[] args) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {<br><br>        Class tableClazz </span>= Person.<span style="color: #0000ff;">class</span><span style="color: #000000;">;<br>        </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> ModelPropertyGenerator().generate(tableClazz,<br>                </span>â€œexample/src/main/javaâ€<span style="color: #000000;">,<br>                tableClazz.getPackage().getName() </span>+ â€œ.configâ€<span style="color: #000000;">);<br><br>    }<br><br>}</span></pre><br></div>

<p>å¦‚ä¸Šï¼Œgenerate()æ–¹æ³•å‚æ•°å¦‚ä¸‹ï¼š</p>
<p>generate(Class tableClazz, String outerDir, String packageName)</p>
<p>å‚æ•°ä¸€ï¼šè¦ç”Ÿæˆçš„PropertyæŒä¹…ç±»çš„Class</p>
<p>å‚æ•°äºŒï¼šç”Ÿæˆçš„ModelPropertyç±»æ–‡ä»¶å­˜æ”¾ç›®å½•</p>
<p>å‚æ•°ä¸‰ï¼šç”Ÿæˆçš„ModelPropertyç±»æ–‡ä»¶çš„åŒ…å</p>
<p>æ‰§è¡Œå®Œæ¯•åï¼Œå°±ä¼šåœ¨com.wangjie.rapidorm.example.database.model.configåŒ…ä¸‹ç”Ÿæˆå¦‚ä¸‹çš„ModelPropertyï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">  1</span> <span style="color: #008000;">//</span><span style="color: #008000;"> THIS CODE IS GENERATED BY RapidORM, DO NOT EDIT.</span><br><span style="color: #008080;">  2</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">  3</span> <span style="color: #008000;"> Property of Person<br></span><span style="color: #008080;">  4</span> <span style="color: #008000;">*/</span><br><span style="color: #008080;">  5</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> PersonProperty <span style="color: #0000ff;">implements</span> IModelProperty&lt;Person&gt;<span style="color: #000000;"> {<br></span><span style="color: #008080;">  6</span><br><span style="color: #008080;">  7</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> ModelFieldMapper id = <span style="color: #0000ff;">new</span> ModelFieldMapper(0, â€œidâ€, â€œidâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">  8</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> ModelFieldMapper typeId = <span style="color: #0000ff;">new</span> ModelFieldMapper(1, â€œtypeIdâ€, â€œtypeIdâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">  9</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> ModelFieldMapper name = <span style="color: #0000ff;">new</span> ModelFieldMapper(2, â€œnameâ€, â€œnameâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 10</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> ModelFieldMapper age = <span style="color: #0000ff;">new</span> ModelFieldMapper(3, â€œageâ€, â€œageâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 11</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> ModelFieldMapper address = <span style="color: #0000ff;">new</span> ModelFieldMapper(4, â€œaddressâ€, â€œaddressâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 12</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> ModelFieldMapper birth = <span style="color: #0000ff;">new</span> ModelFieldMapper(5, â€œbirthâ€, â€œbirthâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 13</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> ModelFieldMapper student = <span style="color: #0000ff;">new</span> ModelFieldMapper(6, â€œstudentâ€, â€œstudentâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 14</span><br><span style="color: #008080;"> 15</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> PersonProperty() {<br></span><span style="color: #008080;"> 16</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 17</span><br><span style="color: #008080;"> 18</span><br><span style="color: #008080;"> 19</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> bindInsertArgs(Person model, List&lt;Object&gt;<span style="color: #000000;"> insertArgs) {<br></span><span style="color: #008080;"> 21</span>         Integer id =<span style="color: #000000;"> model.getId();<br></span><span style="color: #008080;"> 22</span>         insertArgs.add(<span style="color: #0000ff;">null</span> == id ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : id);<br></span><span style="color: #008080;"> 23</span><br><span style="color: #008080;"> 24</span>         Integer typeId =<span style="color: #000000;"> model.getTypeId();<br></span><span style="color: #008080;"> 25</span>         insertArgs.add(<span style="color: #0000ff;">null</span> == typeId ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : typeId);<br></span><span style="color: #008080;"> 26</span><br><span style="color: #008080;"> 27</span>         String name =<span style="color: #000000;"> model.getName();<br></span><span style="color: #008080;"> 28</span>         insertArgs.add(<span style="color: #0000ff;">null</span> == name ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : name);<br></span><span style="color: #008080;"> 29</span><br><span style="color: #008080;"> 30</span>         Integer age =<span style="color: #000000;"> model.getAge();<br></span><span style="color: #008080;"> 31</span>         insertArgs.add(<span style="color: #0000ff;">null</span> == age ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : age);<br></span><span style="color: #008080;"> 32</span><br><span style="color: #008080;"> 33</span>         String address =<span style="color: #000000;"> model.getAddress();<br></span><span style="color: #008080;"> 34</span>         insertArgs.add(<span style="color: #0000ff;">null</span> == address ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : address);<br></span><span style="color: #008080;"> 35</span><br><span style="color: #008080;"> 36</span>         Long birth =<span style="color: #000000;"> model.getBirth();<br></span><span style="color: #008080;"> 37</span>         insertArgs.add(<span style="color: #0000ff;">null</span> == birth ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : birth);<br></span><span style="color: #008080;"> 38</span><br><span style="color: #008080;"> 39</span>         Boolean student =<span style="color: #000000;"> model.isStudent();<br></span><span style="color: #008080;"> 40</span>         insertArgs.add(<span style="color: #0000ff;">null</span> == student ? <span style="color: #0000ff;">null</span> : student ? 1 : 0<span style="color: #000000;">);<br></span><span style="color: #008080;"> 41</span><br><span style="color: #008080;"> 42</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 43</span><br><span style="color: #008080;"> 44</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 45</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> bindUpdateArgs(Person model, List&lt;Object&gt;<span style="color: #000000;"> updateArgs) {<br></span><span style="color: #008080;"> 46</span>         String name =<span style="color: #000000;"> model.getName();<br></span><span style="color: #008080;"> 47</span>         updateArgs.add(<span style="color: #0000ff;">null</span> == name ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : name);<br></span><span style="color: #008080;"> 48</span><br><span style="color: #008080;"> 49</span>         Integer age =<span style="color: #000000;"> model.getAge();<br></span><span style="color: #008080;"> 50</span>         updateArgs.add(<span style="color: #0000ff;">null</span> == age ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : age);<br></span><span style="color: #008080;"> 51</span><br><span style="color: #008080;"> 52</span>         String address =<span style="color: #000000;"> model.getAddress();<br></span><span style="color: #008080;"> 53</span>         updateArgs.add(<span style="color: #0000ff;">null</span> == address ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : address);<br></span><span style="color: #008080;"> 54</span><br><span style="color: #008080;"> 55</span>         Long birth =<span style="color: #000000;"> model.getBirth();<br></span><span style="color: #008080;"> 56</span>         updateArgs.add(<span style="color: #0000ff;">null</span> == birth ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : birth);<br></span><span style="color: #008080;"> 57</span><br><span style="color: #008080;"> 58</span>         Boolean student =<span style="color: #000000;"> model.isStudent();<br></span><span style="color: #008080;"> 59</span>         updateArgs.add(<span style="color: #0000ff;">null</span> == student ? <span style="color: #0000ff;">null</span> : student ? 1 : 0<span style="color: #000000;">);<br></span><span style="color: #008080;"> 60</span><br><span style="color: #008080;"> 61</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 62</span><br><span style="color: #008080;"> 63</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 64</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> bindPkArgs(Person model, List&lt;Object&gt;<span style="color: #000000;"> pkArgs) {<br></span><span style="color: #008080;"> 65</span>         Integer id =<span style="color: #000000;"> model.getId();<br></span><span style="color: #008080;"> 66</span>         pkArgs.add(<span style="color: #0000ff;">null</span> == id ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : id);<br></span><span style="color: #008080;"> 67</span><br><span style="color: #008080;"> 68</span>         Integer typeId =<span style="color: #000000;"> model.getTypeId();<br></span><span style="color: #008080;"> 69</span>         pkArgs.add(<span style="color: #0000ff;">null</span> == typeId ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : typeId);<br></span><span style="color: #008080;"> 70</span><br><span style="color: #008080;"> 71</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 72</span><br><span style="color: #008080;"> 73</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 74</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Person parseFromCursor(Cursor cursor) {<br></span><span style="color: #008080;"> 75</span>         Person model = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Person();<br></span><span style="color: #008080;"> 76</span>         <span style="color: #0000ff;">int</span><span style="color: #000000;"> index;<br></span><span style="color: #008080;"> 77</span>         index = cursor.getColumnIndex(â€œidâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 78</span>         <span style="color: #0000ff;">if</span>(-1 !=<span style="color: #000000;"> index){<br></span><span style="color: #008080;"> 79</span>             model.setId(cursor.isNull(index) ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : (cursor.getInt(index)));<br></span><span style="color: #008080;"> 80</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 81</span><br><span style="color: #008080;"> 82</span>         index = cursor.getColumnIndex(â€œtypeIdâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 83</span>         <span style="color: #0000ff;">if</span>(-1 !=<span style="color: #000000;"> index){<br></span><span style="color: #008080;"> 84</span>             model.setTypeId(cursor.isNull(index) ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : (cursor.getInt(index)));<br></span><span style="color: #008080;"> 85</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 86</span><br><span style="color: #008080;"> 87</span>         index = cursor.getColumnIndex(â€œnameâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 88</span>         <span style="color: #0000ff;">if</span>(-1 !=<span style="color: #000000;"> index){<br></span><span style="color: #008080;"> 89</span>             model.setName(cursor.isNull(index) ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : (cursor.getString(index)));<br></span><span style="color: #008080;"> 90</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 91</span><br><span style="color: #008080;"> 92</span>         index = cursor.getColumnIndex(â€œageâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 93</span>         <span style="color: #0000ff;">if</span>(-1 !=<span style="color: #000000;"> index){<br></span><span style="color: #008080;"> 94</span>             model.setAge(cursor.isNull(index) ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : (cursor.getInt(index)));<br></span><span style="color: #008080;"> 95</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 96</span><br><span style="color: #008080;"> 97</span>         index = cursor.getColumnIndex(â€œaddressâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 98</span>         <span style="color: #0000ff;">if</span>(-1 !=<span style="color: #000000;"> index){<br></span><span style="color: #008080;"> 99</span>             model.setAddress(cursor.isNull(index) ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : (cursor.getString(index)));<br></span><span style="color: #008080;">100</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">101</span><br><span style="color: #008080;">102</span>         index = cursor.getColumnIndex(â€œbirthâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">103</span>         <span style="color: #0000ff;">if</span>(-1 !=<span style="color: #000000;"> index){<br></span><span style="color: #008080;">104</span>             model.setBirth(cursor.isNull(index) ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : (cursor.getLong(index)));<br></span><span style="color: #008080;">105</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">106</span><br><span style="color: #008080;">107</span>         index = cursor.getColumnIndex(â€œstudentâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">108</span>         <span style="color: #0000ff;">if</span>(-1 !=<span style="color: #000000;"> index){<br></span><span style="color: #008080;">109</span>             model.setStudent(cursor.isNull(index) ? <span style="color: #0000ff;">null</span> : (cursor.getInt(index) == 1<span style="color: #000000;">));<br></span><span style="color: #008080;">110</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">111</span><br><span style="color: #008080;">112</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> model;<br></span><span style="color: #008080;">113</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">114</span><br><span style="color: #008080;">115</span> }</pre><br></div>

<p>æ³¨æ„ï¼šæ­¤Propertyç±»ä¸€æ—¦ç”Ÿæˆï¼Œåˆ™ä¸èƒ½ä¿®æ”¹ï¼›å¦‚æœè¯¥æŒä¹…ç±»ç›¸å…³çš„æ³¨è§£å±æ€§æ”¹å˜ï¼Œåˆ™éœ€è¦é‡æ–°ç”Ÿæˆè¿™ä¸ªPropertyç±»ã€‚</p>
<p>2. åœ¨ç›¸åº”çš„æŒä¹…ç±»çš„@Tableæ³¨è§£ä¸­è®¾ç½®propertyClazzï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> @Table(propertyClazz = PersonProperty.<span style="color: #0000ff;">class</span><span style="color: #000000;">)<br></span><span style="color: #008080;">2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Person <span style="color: #0000ff;">implements</span> Serializable{</pre><br></div>

<p>&nbsp;</p>
<p><span style="font-size: 16px;"><strong>å¦‚ä½•å…¼å®¹SqlCipher</strong></span></p>
<p>1. æ–°å»ºMySQLCipherOpenHelperï¼Œç»§æ‰¿net.sqlcipher.database.SQLiteOpenHelperï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.content.Context;<br></span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.rapidorm.core.dao.DatabaseProcessor;<br></span><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.rapidorm.core.delegate.database.RapidORMSQLiteDatabaseDelegate;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> net.sqlcipher.database.SQLiteDatabase;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> net.sqlcipher.database.SQLiteDatabaseHook;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> net.sqlcipher.database.SQLiteOpenHelper;<br></span><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 9</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;">10</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;">11</span> <span style="color: #008000;">  Date: 8/17/15.<br></span><span style="color: #008080;">12</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;">13</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MySQLCipherOpenHelper <span style="color: #0000ff;">extends</span><span style="color: #000000;"> SQLiteOpenHelper {<br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> RapidORMSQLiteDatabaseDelegate rapidORMSQLiteDatabaseDelegate;<br></span><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span> MySQLCipherOpenHelper(Context context, String name, <span style="color: #0000ff;">int</span><span style="color: #000000;"> version) {<br></span><span style="color: #008080;">18</span>         <span style="color: #0000ff;">super</span>(context, name, <span style="color: #0000ff;">null</span><span style="color: #000000;">, version);<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span> MySQLCipherOpenHelper(Context context, String name, SQLiteDatabase.CursorFactory factory, <span style="color: #0000ff;">int</span><span style="color: #000000;"> version) {<br></span><span style="color: #008080;">22</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, name, factory, version);<br></span><span style="color: #008080;">23</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span>     <span style="color: #0000ff;">public</span> MySQLCipherOpenHelper(Context context, String name, SQLiteDatabase.CursorFactory factory, <span style="color: #0000ff;">int</span><span style="color: #000000;"> version, SQLiteDatabaseHook hook) {<br></span><span style="color: #008080;">26</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, name, factory, version, hook);<br></span><span style="color: #008080;">27</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">30</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(SQLiteDatabase db) {<br></span><span style="color: #008080;">31</span> <span style="color: #008000;">//</span><span style="color: #008000;">        super.onCreate(db);</span><br><span style="color: #008080;">32</span>         rapidORMSQLiteDatabaseDelegate = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySQLCipherDatabaseDelegate(db);<br></span><span style="color: #008080;">33</span>         DatabaseProcessor databaseProcessor =<span style="color: #000000;"> DatabaseProcessor.getInstance();<br></span><span style="color: #008080;">34</span>         <span style="color: #0000ff;">for</span> (Class&lt;?&gt;<span style="color: #000000;"> tableClazz : databaseProcessor.getAllTableClass()) {<br></span><span style="color: #008080;">35</span>             databaseProcessor.createTable(rapidORMSQLiteDatabaseDelegate, tableClazz, <span style="color: #0000ff;">true</span><span style="color: #000000;">);<br></span><span style="color: #008080;">36</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">37</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">38</span><br><span style="color: #008080;">39</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">40</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onUpgrade(SQLiteDatabase db, <span style="color: #0000ff;">int</span> oldVersion, <span style="color: #0000ff;">int</span><span style="color: #000000;"> newVersion) {<br></span><span style="color: #008080;">41</span> <span style="color: #008000;">//</span><span style="color: #008000;">        super.onUpgrade(db, oldVersion, newVersion);</span><br><span style="color: #008080;">42</span>         rapidORMSQLiteDatabaseDelegate = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySQLCipherDatabaseDelegate(db);<br></span><span style="color: #008080;">43</span>         DatabaseProcessor databaseProcessor =<span style="color: #000000;"> DatabaseProcessor.getInstance();<br></span><span style="color: #008080;">44</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> todo: dev only!!!!!</span><br><span style="color: #008080;">45</span> <span style="color: #000000;">        databaseProcessor.dropAllTable(rapidORMSQLiteDatabaseDelegate);<br></span><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">48</span> }</pre><br></div>

<p>&nbsp;</p>
<p>2. æ–°å»ºMySQLCipherDatabaseDelegateç»§æ‰¿RapidORMSQLiteDatabaseDelegateï¼Œå¹¶å®ç°ä»¥ä¸‹çš„æ–¹æ³•ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.database.Cursor;<br></span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.database.SQLException;<br></span><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.rapidorm.core.delegate.database.RapidORMSQLiteDatabaseDelegate;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> net.sqlcipher.database.SQLiteDatabase;<br></span><span style="color: #008080;"> 5</span><br><span style="color: #008080;"> 6</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 7</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;"> 8</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 9</span> <span style="color: #008000;">  Date: 8/17/15.<br></span><span style="color: #008080;">10</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MySQLCipherDatabaseDelegate <span style="color: #0000ff;">extends</span> RapidORMSQLiteDatabaseDelegate&lt;SQLiteDatabase&gt;<span style="color: #000000;"> {<br></span><span style="color: #008080;">12</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> MySQLCipherDatabaseDelegate(SQLiteDatabase db) {<br></span><span style="color: #008080;">13</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(db);<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> execSQL(String sql) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> SQLException {<br></span><span style="color: #008080;">18</span> <span style="color: #000000;">        db.execSQL(sql);<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">22</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isDbLockedByCurrentThread() {<br></span><span style="color: #008080;">23</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> db.isDbLockedByCurrentThread();<br></span><span style="color: #008080;">24</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">25</span><br><span style="color: #008080;">26</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">27</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> execSQL(String sql, Object[] bindArgs) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {<br></span><span style="color: #008080;">28</span> <span style="color: #000000;">        db.execSQL(sql, bindArgs);<br></span><span style="color: #008080;">29</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">32</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Cursor rawQuery(String sql, String[] selectionArgs) {<br></span><span style="color: #008080;">33</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> db.rawQuery(sql, selectionArgs);<br></span><span style="color: #008080;">34</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">35</span><br><span style="color: #008080;">36</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">37</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> beginTransaction() {<br></span><span style="color: #008080;">38</span> <span style="color: #000000;">        db.beginTransaction();<br></span><span style="color: #008080;">39</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">42</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setTransactionSuccessful() {<br></span><span style="color: #008080;">43</span> <span style="color: #000000;">        db.setTransactionSuccessful();<br></span><span style="color: #008080;">44</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">45</span><br><span style="color: #008080;">46</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">47</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> endTransaction() {<br></span><span style="color: #008080;">48</span> <span style="color: #000000;">        db.endTransaction();<br></span><span style="color: #008080;">49</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">50</span><br><span style="color: #008080;">51</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">52</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> close() {<br></span><span style="color: #008080;">53</span> <span style="color: #000000;">        db.close();<br></span><span style="color: #008080;">54</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">55</span> }</pre><br></div>

<p>æ³¨æ„è¿™é‡Œçš„importï¼Œè¿™é‡Œçš„SQLiteDatabaseéœ€è¦å¯¼å…¥&nbsp;<span style="background-color: #d8d8d8;">net.sqlcipher.database.SQLiteDatabase</span>&nbsp;ã€‚</p>
<p>&nbsp;</p>
<p>3. æ–°å»ºMySQLCipherOpenHelperDelegateç»§æ‰¿RapidORMDatabaseOpenHelperDelegateï¼Œå®ç°å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.rapidorm.core.delegate.openhelper.RapidORMDatabaseOpenHelperDelegate;<br></span><span style="color: #008080;"> 2</span> <span style="color: #008080;"> 3</span><br><span style="color: #008080;"> 4</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 5</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;"> 6</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 7</span> <span style="color: #008000;">  Date: 6/18/15.<br></span><span style="color: #008080;"> 8</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MySQLCipherOpenHelperDelegate <span style="color: #0000ff;">extends</span> RapidORMDatabaseOpenHelperDelegate&lt;MySQLCipherOpenHelper, MySQLCipherOpenHelperDelegate&gt;<span style="color: #000000;"> {<br></span><span style="color: #008080;">10</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> MySQLCipherOpenHelperDelegate(MySQLCipherOpenHelper sqLiteOpenHelper) {<br></span><span style="color: #008080;">11</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(sqLiteOpenHelper);<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">13</span><br><span style="color: #008080;">14</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String SECRET_KEY = â€œ1234567890abcdefâ€<span style="color: #000000;">;<br></span><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> MySQLCipherOpenHelperDelegate getReadableDatabase() {<br></span><span style="color: #008080;">18</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySQLCipherDatabaseDelegate(openHelper.getReadableDatabase(SECRET_KEY));<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">22</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> MySQLCipherOpenHelperDelegate getWritableDatabase() {<br></span><span style="color: #008080;">23</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySQLCipherDatabaseDelegate(openHelper.getWritableDatabase(SECRET_KEY));<br></span><span style="color: #008080;">24</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">25</span><br><span style="color: #008080;">26</span> }</pre><br></div>

<p>&nbsp;</p>
<p>4. åœ¨DatabaseFactoryä¸­ä½¿ç”¨SqlCipherç‰ˆæœ¬ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 6/25/15.<br></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> DatabaseFactory <span style="color: #0000ff;">extends</span> RapidORMConnection&lt;MySQLCipherOpenHelperDelegate&gt;<span style="color: #000000;"> {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> VERSION = 1<span style="color: #000000;">;<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> DatabaseFactory instance;<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">synchronized</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> DatabaseFactory getInstance() {<br></span><span style="color: #008080;">12</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> instance) {<br></span><span style="color: #008080;">13</span>             instance = <span style="color: #0000ff;">new</span><span style="color: #000000;"> DatabaseFactory();<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">15</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> instance;<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> DatabaseFactory() {<br></span><span style="color: #008080;">19</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">();<br></span><span style="color: #008080;">20</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">21</span><br><span style="color: #008080;">22</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">23</span>     <span style="color: #0000ff;">protected</span><span style="color: #000000;"> MySQLCipherOpenHelperDelegate getRapidORMDatabaseOpenHelper(@NonNull String databaseName) {<br></span><span style="color: #008080;">24</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> MySQLCipherOpenHelperDelegate(<span style="color: #0000ff;">new</span><span style="color: #000000;"> MySQLCipherOpenHelper(applicationContext, databaseName, VERSION));<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">28</span>     <span style="color: #0000ff;">protected</span> List&lt;Class&lt;?&gt;&gt;<span style="color: #000000;"> registerAllTableClass() {<br></span><span style="color: #008080;">29</span>         List&lt;Class&lt;?&gt;&gt; allTableClass = <span style="color: #0000ff;">new</span> ArrayList&lt;&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">30</span>         allTableClass.add(Person.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br></span><span style="color: #008080;">31</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> register all table class hereâ€¦</span><br><span style="color: #008080;">32</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> allTableClass;<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">34</span> }</pre><br></div>

<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> orm </tag>
            
            <tag> rapidorm </tag>
            
            <tag> library </tag>
            
            <tag> database </tag>
            
            <tag> sqlite </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]åŸºäºRxJavaã€RxAndroidçš„EventBuså®ç°]]></title>
      <url>/2015/06/15/Android-%E5%9F%BA%E4%BA%8ERxJava%E3%80%81RxAndroid%E7%9A%84EventBus%E5%AE%9E%E7%8E%B0/</url>
      <content type="html"><![CDATA[<p><strong><span style="line-height: 1.5;">Githubï¼š<a href="https://github.com/wangjiegulu/RxAndroidEventsSample" target="_blank" rel="noopener">https://github.com/wangjiegulu/RxAndroidEventsSample</a></span></strong></p>
<p>EventBusçš„ä½œç”¨æ˜¯å‘å¸ƒ/è®¢é˜…äº‹ä»¶æ€»çº¿ï¼Œå› ä¸ºé¡¹ç›®ä¸­ç”¨åˆ°RxJavaã€RxAndroidï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥ä½¿ç”¨RxJavaã€RxAndroidæ¥å®ç°EventBusã€‚</p>
<p>&nbsp;</p>
<p>1. ç¼–å†™RxBusï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰äº‹ä»¶Subjectsã€‚</p>
<p>äº‹ä»¶æ˜¯ä¼ é€’çš„æœ€å°å•ä½ï¼Œå¯ä»¥æŠŠä»»ä½•ç±»ä½œä¸ºä¸€ä¸ªäº‹ä»¶ã€‚</p>
<p>RxBusä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 6/11/15.<br></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> RxBus {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = RxBus.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> RxBus instance;<br></span><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">boolean</span> DEBUG = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">synchronized</span><span style="color: #000000;"> RxBus get() {<br></span><span style="color: #008080;">12</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> instance) {<br></span><span style="color: #008080;">13</span>             instance = <span style="color: #0000ff;">new</span><span style="color: #000000;"> RxBus();<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">15</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> instance;<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> RxBus() {<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>     <span style="color: #0000ff;">private</span> ConcurrentHashMap&lt;Object, List&lt;Subject&gt;&gt; subjectMapper = <span style="color: #0000ff;">new</span> ConcurrentHashMap&lt;&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span>     @SuppressWarnings(â€œuncheckedâ€<span style="color: #000000;">)<br></span><span style="color: #008080;">24</span>     <span style="color: #0000ff;">public</span> &lt;T&gt; Observable&lt;T&gt; register(@NonNull Object tag, @NonNull Class&lt;T&gt;<span style="color: #000000;"> clazz) {<br></span><span style="color: #008080;">25</span>         List&lt;Subject&gt; subjectList =<span style="color: #000000;"> subjectMapper.get(tag);<br></span><span style="color: #008080;">26</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> subjectList) {<br></span><span style="color: #008080;">27</span>             subjectList = <span style="color: #0000ff;">new</span> ArrayList&lt;&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">28</span> <span style="color: #000000;">            subjectMapper.put(tag, subjectList);<br></span><span style="color: #008080;">29</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span>         Subject&lt;T, T&gt;<span style="color: #000000;"> subject;<br></span><span style="color: #008080;">32</span>         subjectList.add(subject =<span style="color: #000000;"> PublishSubject.create());<br></span><span style="color: #008080;">33</span>         <span style="color: #0000ff;">if</span> (DEBUG) Log.d(TAG, â€œ[register]subjectMapper: â€œ +<span style="color: #000000;"> subjectMapper);<br></span><span style="color: #008080;">34</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> subject;<br></span><span style="color: #008080;">35</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">36</span><br><span style="color: #008080;">37</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> unregister(@NonNull Object tag, @NonNull Observable observable) {<br></span><span style="color: #008080;">38</span>         List&lt;Subject&gt; subjects =<span style="color: #000000;"> subjectMapper.get(tag);<br></span><span style="color: #008080;">39</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> subjects) {<br></span><span style="color: #008080;">40</span> <span style="color: #000000;">            subjects.remove((Subject) observable);<br></span><span style="color: #008080;">41</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> (ABTextUtil.isEmpty(subjects)) {<br></span><span style="color: #008080;">42</span> <span style="color: #000000;">                subjectMapper.remove(tag);<br></span><span style="color: #008080;">43</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">44</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">45</span><br><span style="color: #008080;">46</span>         <span style="color: #0000ff;">if</span> (DEBUG) Log.d(TAG, â€œ[unregister]subjectMapper: â€œ +<span style="color: #000000;"> subjectMapper);<br></span><span style="color: #008080;">47</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">48</span><br><span style="color: #008080;">49</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> post(@NonNull Object content) {<br></span><span style="color: #008080;">50</span> <span style="color: #000000;">        post(content.getClass().getName(), content);<br></span><span style="color: #008080;">51</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">52</span><br><span style="color: #008080;">53</span>     @SuppressWarnings(â€œuncheckedâ€<span style="color: #000000;">)<br></span><span style="color: #008080;">54</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> post(@NonNull Object tag, @NonNull Object content) {<br></span><span style="color: #008080;">55</span>         List&lt;Subject&gt; subjectList =<span style="color: #000000;"> subjectMapper.get(tag);<br></span><span style="color: #008080;">56</span><br><span style="color: #008080;">57</span>         <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">ABTextUtil.isEmpty(subjectList)) {<br></span><span style="color: #008080;">58</span>             <span style="color: #0000ff;">for</span><span style="color: #000000;"> (Subject subject : subjectList) {<br></span><span style="color: #008080;">59</span> <span style="color: #000000;">                subject.onNext(content);<br></span><span style="color: #008080;">60</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">61</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">62</span>         <span style="color: #0000ff;">if</span> (DEBUG) Log.d(TAG, â€œ[send]subjectMapper: â€œ +<span style="color: #000000;"> subjectMapper);<br></span><span style="color: #008080;">63</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">64</span> }</pre><br></div>

<p>å¦‚ä¸Šè¿°ä»£ç ï¼ŒRxBusåªæä¾›äº†registerã€unregisterã€postä¸‰ä¸ªæ–¹æ³•ã€‚</p>
<p>è¿™é‡ŒåˆåŠ å…¥äº†ä¸€ä¸ªtagçš„æ¦‚å¿µï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºchannelï¼Œæ³¨å†ŒSubjectã€åæ³¨å†ŒSubjectå’Œpostäº‹ä»¶çš„æ—¶å€™éƒ½éœ€è¦è¿™ä¸ªtagï¼Œåªæœ‰tagä¸€è‡´æ‰èƒ½æ­£å¸¸æ¥æ”¶åˆ°äº‹ä»¶ã€‚</p>
<p>æ¯”å¦‚æœ‰ä¸€ä¸ªäº‹ä»¶ç±»HelloEventï¼Œè¿™ä¸ªäº‹ä»¶çš„ä½œç”¨æ˜¯æ¥æ”¶åˆ°åtoastä¸€ä¸ªæç¤º&ldquo;hello&rdquo;ï¼Œå¦‚æœä¸¤ä¸ªActivityéƒ½æ³¨å†Œäº†è¿™ä¸ªHelloEventäº‹ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰tagå»é™åˆ¶ï¼Œä¸€æ—¦postäº†ä¸€ä¸ªhelloEventäº‹ä»¶åï¼Œä¸¤ä¸ªActivityéƒ½ä¼šæ”¶åˆ°è¿™ä¸ªäº‹ä»¶ï¼Œå¯¼è‡´ä¸¤ä¸ªActivityéƒ½ä¼štoastã€‚å¦‚æœä½¿ç”¨tagï¼Œpostè¿™ä¸ªHelloEventçš„æ—¶å€™å¯ä»¥è®¾ç½®è¿™ä¸ªtagï¼Œåªæœ‰registeræ—¶ä¹Ÿä½¿ç”¨äº†è¿™ä¸ªtagæ‰ä¼šæ¥æ”¶åˆ°è¿™ä¸ªeventã€‚</p>
<p>2. åœ¨Presentï¼ˆå¦‚Activityçš„onCreateï¼‰ä¸­æ³¨å†Œä¸€ä¸ªObserverï¼ˆä»¥ä¸‹ä»¥å‘é€ä¸€ä¸ªStringç±»å‹çš„äº‹ä»¶ä¸ºä¾‹ï¼‰</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> Observable&lt;String&gt; addOb =<span style="color: #000000;"> RxBus.get()<br></span><span style="color: #008080;">2</span>                 .register(â€œaddFeedTagâ€, String.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br></span><span style="color: #008080;">3</span><br><span style="color: #008080;">4</span> <span style="color: #000000;">addOb.observeOn(AndroidSchedulers.mainThread())<br></span><span style="color: #008080;">5</span>                 .subscribe(s -&gt;<span style="color: #000000;"> {<br></span><span style="color: #008080;">6</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> todo: Accept event and process here</span><br><span style="color: #008080;">7</span>                 });</pre><br></div>

<p>å¦‚ä¸Šï¼Œæ³¨å†Œäº†ä¸€ä¸ªStringç±»å‹çš„äº‹ä»¶ï¼Œäº‹ä»¶çš„tagæ˜¯&ldquo;addFeedTag&rdquo;ï¼Œç”¨æ¥å¢åŠ ä¸€ä¸ªFeedã€‚ä½¿ç”¨RxAndroidåœ¨Action1ä¸­å¤„ç†æ¥æ”¶åˆ°çš„è¿™ä¸ªäº‹ä»¶ã€‚</p>
<p>3. åœ¨ä»»ä½•åœ°æ–¹å‘é€ä¸€ä¸ªäº‹ä»¶ï¼š</p>
<div class="cnblogs_code"><br><pre>RxBus.get().post(â€œaddFeedTagâ€, â€œhello RxBus!â€);</pre><br></div>

<p>è¿™é‡Œå‘é€äº†ä¸€ä¸ªtagä¸º&ldquo;addFeedTag&rdquo;çš„Stringç±»å‹çš„äº‹ä»¶ã€‚</p>
<p>4. åæ³¨å†ŒObserverï¼š</p>
<div class="cnblogs_code"><br><pre>RxBus.get().unregister(â€œaddFeedTagâ€, addOb);</pre><br></div>

<p>æ³¨æ„ï¼šè¿™é‡Œçš„Tagéƒ½ä¸º&ldquo;addFeedTag&rdquo;ã€‚</p>
<p>&nbsp;</p>
<p><strong>ä¸‹é¢ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ›´ç®€å•æ–¹ä¾¿åœ°ä½¿ç”¨RxBusï¼ˆå—¯ï¼ã€‚ï¼è¿™é‡Œæ‰æ˜¯é‡ç‚¹ï¼‰ã€‚</strong></p>
<p>é¦–å…ˆæ¥çœ‹ä¸‹ä½¿ç”¨æ³¨è§£åçš„ä»£ç ï¼š</p>
<p>1. æ³¨å†ŒObserver</p>
<p>è¿™ä¸€æ­¥å¯ä»¥çœç•¥æ‰ã€‚</p>
<p>2. å‘é€ä¸€ä¸ªäº‹ä»¶ï¼ˆè¿™é‡Œæˆ‘ä»¬æ¢ä¸€ä¸ªäº‹ä»¶ï¼šFeedItemClickEventï¼Œæˆ‘ä»¬å®šä¹‰è¿™ä¸ªäº‹ä»¶æ˜¯ç”¨æ¥å¤„ç†å½“Feedè¢«ç‚¹å‡»åçš„äº‹ä»¶ï¼‰</p>
<div class="cnblogs_code"><br><pre>RxBus.get().post(<span style="color: #0000ff;">new</span> FeedItemClickEvent().setPosition(position).setFeed(feed));</pre><br></div>

<p>3. æ¥æ”¶äº‹ä»¶ï¼Œç„¶åå¤„ç†</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #000000;">@Accept<br></span><span style="color: #008080;">2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onPostAccept(Object tag, FeedItemClickEvent event) {<br></span><span style="color: #008080;">3</span> ã€€ã€€Logger.d(TAG, â€œonPostAccept event: â€œ +<span style="color: #000000;"> event);<br></span><span style="color: #008080;">4</span> ã€€ã€€Feed feed =<span style="color: #000000;"> event.getFeed();<br></span><span style="color: #008080;">5</span> ã€€ã€€<span style="color: #008000;">//</span><span style="color: #008000;"> è·³è½¬åˆ°feedè¯¦æƒ…é¡µé¢â€¦</span><br><span style="color: #008080;">6</span> }</pre><br></div>

<p>å¦‚ä¸Šï¼Œè¿™é‡Œåªéœ€è¦ç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼ŒåŠ ä¸ŠAcceptæ³¨è§£ï¼Œç„¶ååœ¨æ–¹æ³•ä¸­è¿›è¡Œäº‹ä»¶å¤„ç†å³å¯ã€‚</p>
<p>æ³¨æ„ï¼šæ–¹æ³•åå¯ä»¥ä»»æ„</p>
<p>æ–¹æ³•å‚æ•°ä¸€ï¼šå¿…é¡»ä¸ºObjectç±»å‹çš„tagï¼›</p>
<p>æ–¹æ³•å‚æ•°äºŒï¼Œå¦‚æœè¿™ä¸ªæ–¹æ³•åªæ¥æ”¶ä¸€ç§äº‹ä»¶ï¼Œåˆ™å†™æ˜å…·ä½“çš„äº‹ä»¶ç±»å‹ï¼Œå¦‚ä¸Šï¼›å¦‚æœè¿™ä¸ªæ–¹æ³•æ¥æ”¶å¤šç§äº‹ä»¶ï¼Œåˆ™ç±»å‹éœ€è¦ä¸ºObjectã€‚</p>
<p>4. åæ³¨å†ŒObserver</p>
<p>è¿™ä¸€æ­¥ä¹Ÿå¯ä»¥çœç•¥æ‰ã€‚</p>
<p>&nbsp;</p>
<p>æ¥æ”¶å¤šç§äº‹ä»¶ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">@Accept(<br></span><span style="color: #008080;"> 2</span>             acceptScheduler =<span style="color: #000000;"> AcceptScheduler.NEW_THREAD,<br></span><span style="color: #008080;"> 3</span>             value =<span style="color: #000000;"> {<br></span><span style="color: #008080;"> 4</span>                     @AcceptType(tag = ActionEvent.CLOSE, clazz = String.<span style="color: #0000ff;">class</span><span style="color: #000000;">),<br></span><span style="color: #008080;"> 5</span>                     @AcceptType(tag = ActionEvent.BACK, clazz = String.<span style="color: #0000ff;">class</span><span style="color: #000000;">),<br></span><span style="color: #008080;"> 6</span>                     @AcceptType(tag = ActionEvent.EDIT, clazz = String.<span style="color: #0000ff;">class</span><span style="color: #000000;">),<br></span><span style="color: #008080;"> 7</span>                     @AcceptType(tag = ActionEvent.REFRESH, clazz = String.<span style="color: #0000ff;">class</span><span style="color: #000000;">)<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">    )<br></span><span style="color: #008080;">10</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onPostAccept(Object tag, Object actionEvent) {<br></span><span style="color: #008080;">11</span>         Logger.d(TAG, â€œ[ActionEvent]onPostAccept action event name: â€œ +<span style="color: #000000;"> actionEvent);<br></span><span style="color: #008080;">12</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> todo: Accept event and process here (in new thread)</span><br><span style="color: #008080;">13</span>     }</pre><br></div>

<p>è¿™é‡Œ@Acceptæ³¨è§£ä¸­è®¾ç½®äº†acceptSchedulerä¸ºAcceptScheduler.NEW_THREADï¼ŒæŒ‡æ˜æ–¹æ³•è¿è¡Œåœ¨å­çº¿ç¨‹ä¸­.</p>
<p>valueä¸­æŒ‡æ˜äº†æ¥æ”¶çš„äº‹ä»¶ç±»å‹ï¼Œè¿™é‡Œè¡¨ç¤ºè¿™ä¸ªæ–¹æ³•æ¥æ”¶4ç§ç±»å‹çš„äº‹ä»¶ï¼šCLOSE, BACK, EDIT, REFRESH.</p>
<p>&nbsp;</p>
<p><strong>æ³¨è§£è§£é‡Šï¼š</strong></p>
<p><strong>@Acceptæ³¨è§£</strong></p>
<p>acceptScheduler: æŒ‡å®šè¢«æ³¨è§£çš„æ–¹æ³•è¿è¡Œçš„Schedulerã€‚</p>
<p>value[]: AcceptTypeæ³¨è§£æ•°ç»„ï¼Œç”¨äºæŒ‡å®šæ¥æ”¶äº‹ä»¶çš„tagå’Œclassã€‚</p>
<p>&nbsp;</p>
<p><strong>@AcceptTypeæ³¨è§£ï¼š</strong></p>
<p>tag: æ¥æ”¶äº‹ä»¶çš„tag<br>clazz: æ¥æ”¶äº‹ä»¶çš„ç±»å‹</p>
<p>&nbsp;</p>
<p><strong>AcceptSchedulerï¼š</strong></p>
<p>è¯¦æƒ…è§ï¼šrx.schedulers.Schedulerså’Œrx.android.schedulers.AndroidSchedulers</p>
<p>å¦‚æœè®¾ç½®çš„æ˜¯AcceptScheduler.EXECUTORæˆ–AcceptScheduler.HANDLERï¼Œåˆ™éœ€è¦åœ¨Applicationä¸­é…ç½®Executorå’ŒHandlerï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 6/15/15.<br></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MyApplication <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Application {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">private</span> Executor acceptExecutor =<span style="color: #000000;"> Executors.newCachedThreadPool();<br></span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">private</span> Handler handler = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Handler(Looper.getMainLooper());<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">11</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate() {<br></span><span style="color: #008080;">12</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate();<br></span><span style="color: #008080;">13</span>         RxBus.DEBUG = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span>         DefaultAcceptConfiguration.getInstance().registerAcceptConfiguration(<span style="color: #0000ff;">new</span><span style="color: #000000;"> DefaultAcceptConfiguration.OnDefaultAcceptConfiguration() {<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">17</span>             <span style="color: #0000ff;">public</span><span style="color: #000000;"> Executor applyAcceptExecutor() {<br></span><span style="color: #008080;">18</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;"> acceptExecutor;<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">22</span>             <span style="color: #0000ff;">public</span><span style="color: #000000;"> Handler applyAcceptHandler() {<br></span><span style="color: #008080;">23</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;"> handler;<br></span><span style="color: #008080;">24</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">26</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">27</span> }</pre><br></div>

<p>å› ä¸ºéœ€è¦å¯¹Acceptå’ŒAcceptTypeæ³¨è§£çš„è§£æï¼Œæ‰€ä»¥é¡¹ç›®çš„BaseActivityéœ€è¦ä½¿ç”¨<strong><a href="https://github.com/wangjiegulu/androidInject/blob/master/src/com/wangjie/androidinject/annotation/present/AIAppCompatActivity.java" target="_blank" rel="noopener">AIAppCompatActivity</a></strong>ï¼Œç„¶åå®ç°parserMethodAnnotations()æ–¹æ³•ï¼Œä½¿ç”¨<strong><a href="https://github.com/wangjiegulu/RxAndroidEventsSample/blob/master/sample/src/main/java/com/wangjie/rxandroideventssample/rxbus/RxBusAnnotationManager.java" target="_blank" rel="noopener">RxBusAnnotationManager</a></strong>å¯¹æ³¨è§£è¿›è¡Œè§£æã€‚</p>
<p>&nbsp;</p>
<p>å‚è€ƒï¼š<a href="http://nerds.weddingpartyapp.com/tech/2014/12/24/implementing-an-event-bus-with-rxjava-rxbus/" target="_blank" rel="noopener">http://nerds.weddingpartyapp.com/tech/2014/12/24/implementing-an-event-bus-with-rxjava-rxbus/</a></p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> RxJava </tag>
            
            <tag> RxAndroid </tag>
            
            <tag> EventBus </tag>
            
            <tag> RxBus </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Learn RxJava]]></title>
      <url>/2015/05/11/Learn-RxJava/</url>
      <content type="html"><![CDATA[<p>Learn&nbsp;RxJava</p>
<p>ã€€ã€€<a href="http://reactivex.io/documentation/operators.html" target="_blank" rel="noopener">http://reactivex.io/documentation/operators.html</a></p>
<p><span style="line-height: 1.5;">ã€€ã€€</span><a href="https://github.com/ReactiveX/RxJava/wiki/The-RxJava-Android-Module" target="_blank" rel="noopener">https://github.com/ReactiveX/RxJava/wiki/The-RxJava-Android-Module</a></p>
<p>ã€€ã€€<a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="noopener">https://github.com/ReactiveX/RxJava</a></p>
<p>&nbsp;</p>
<ul>
<li><a href="http://open.blogs.nytimes.com/2014/08/18/getting-groovy-with-reactive-android/?_php=true&amp;_type=blogs&amp;_php=true&amp;_type=blogs&amp;_r=1&amp;" target="_blank" rel="noopener">How the New York Times is building its Android app with Groovy/RxJava</a>&nbsp;by Mohit Pandey</li>
<li><a href="http://mttkay.github.io/blog/2013/08/25/functional-reactive-programming-on-android-with-rxjava/" target="_blank" rel="noopener">Functional Reactive Programming on Android With RxJava</a>&nbsp;and&nbsp;<a href="https://speakerdeck.com/mttkay/conquering-concurrency-bringing-the-reactive-extensions-to-the-android-platform" target="_blank" rel="noopener">Conquering concurrency - bringing the Reactive Extensions to the Android platform</a>&nbsp;by Matthias K&auml;ppler</li>
<li><a href="https://github.com/kaushikgopal/Android-RxJava" target="_blank" rel="noopener">Learning RxJava for Android by example</a>&nbsp;by Kaushik Gopal</li>
<li><a href="http://blog.futurice.com/top-7-tips-for-rxjava-on-android" target="_blank" rel="noopener">Top 7 Tips for RxJava on Android</a>&nbsp;and&nbsp;<a href="http://www.slideshare.net/TimoTuominen1/rxjava-architectures-on-android-8-android-livecode-32531688" target="_blank" rel="noopener">Rx Architectures in Android</a>&nbsp;by Timo Tuominen</li>
<li><a href="http://slid.es/yaroslavheriatovych/frponandroid" target="_blank" rel="noopener">FRP on Android</a>&nbsp;by Yaroslav Heriatovych</li>
<li><a href="http://blog.futurice.com/tech-pick-of-the-week-rx-for-net-and-rxjava-for-android" target="_blank" rel="noopener">Rx for .NET and RxJava for Android</a>&nbsp;by Olli Salonen</li>
<li><a href="http://blog.futurice.com/android-development-has-its-own-swift" target="_blank" rel="noopener">RxJava in Xtend for Android</a>&nbsp;by Andre Medeiros</li>
<li><a href="http://mnmlst-dvlpr.blogspot.de/2014/07/rxjava-and-xtend.html" target="_blank" rel="noopener">RxJava and Xtend</a>&nbsp;by Stefan Oehme</li>
<li>Grokking RxJava,&nbsp;<a href="http://blog.danlew.net/2014/09/15/grokking-rxjava-part-1/" target="_blank" rel="noopener">Part 1: The Basics</a>,&nbsp;<a href="http://blog.danlew.net/2014/09/22/grokking-rxjava-part-2/" target="_blank" rel="noopener">Part 2: Operator, Operator</a>,&nbsp;<a href="http://blog.danlew.net/2014/09/30/grokking-rxjava-part-3/" target="_blank" rel="noopener">Part 3: Reactive with Benefits</a>,&nbsp;<a href="http://blog.danlew.net/2014/10/08/grokking-rxjava-part-4/" target="_blank" rel="noopener">Part 4: Reactive Android</a>&nbsp;- published in Sep/Oct 2014 by Daniel Lew</li>
<li><a href="http://blog.dreamtobe.cn/2289.html" target="_blank" rel="noopener">http://blog.dreamtobe.cn/2289.html</a>ï¼ˆä¸­æ–‡ï¼‰</li>
</ul>
]]></content>
      
        
        <tags>
            
            <tag> rxjava </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]RapidFloatingActionButtonæ¡†æ¶æ­£å¼å‡ºç‚‰]]></title>
      <url>/2015/05/03/Android-RapidFloatingActionButton%E6%A1%86%E6%9E%B6%E6%AD%A3%E5%BC%8F%E5%87%BA%E7%82%89/</url>
      <content type="html"><![CDATA[<h1 id="RapidFloatingActionButton"><a href="#RapidFloatingActionButton" class="headerlink" title="RapidFloatingActionButton"></a>RapidFloatingActionButton</h1><p>Googleæ¨å‡ºäº†MaterialDesignçš„è®¾è®¡è¯­è¨€ï¼Œå…¶ä¸­FloatingActionButtonå°±æ˜¯ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯Googleå´æ²¡æœ‰æä¾›ä¸€ä¸ªå®˜æ–¹çš„FloatingActionButtonæ§ä»¶ï¼Œç½‘ä¸Šæ‰¾äº†å‡ ä¸ªè¯•ç”¨äº†ä¸‹ï¼Œä½†æ˜¯å§‹ç»ˆæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ï¼Œæ‰€ä»¥ï¼Œè‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿäº†ã€‚</p>
<p><a href="http://www.cnblogs.com/RapidFloatingActionButton" target="_blank" rel="noopener">RapidFloatingActionButton</a>ï¼ˆä»¥ä¸‹ç®€ç§°RFABï¼‰æ˜¯Floating Action Buttonçš„å¿«é€Ÿå®ç°ã€‚</p>
<p><strong><span style="color: #ff0000;">Githubåœ°å€ï¼š<a href="https://github.com/wangjiegulu/RapidFloatingActionButton" target="_blank" rel="noopener"><span style="color: #ff0000;">https://github.com/wangjiegulu/RapidFloatingActionButton</span></a></span></strong></p>
<p><a href="https://raw.githubusercontent.com/wangjiegulu/RapidFloatingActionButton/master/screenshot/rfab_label_list.gif" target="_blank" rel="noopener"><img src="https://raw.githubusercontent.com/wangjiegulu/RapidFloatingActionButton/master/screenshot/rfab_label_list.gif" alt=""></a>&nbsp;<a href="https://raw.githubusercontent.com/wangjiegulu/RapidFloatingActionButton/master/screenshot/rfabg.gif" target="_blank" rel="noopener"><img src="https://raw.githubusercontent.com/wangjiegulu/RapidFloatingActionButton/master/screenshot/rfabg.gif" alt=""></a>&nbsp;</p>
<p><a href="https://raw.githubusercontent.com/wangjiegulu/RapidFloatingActionButton/master/screenshot/rfab_01.png" target="_blank" rel="noopener"><img src="https://raw.githubusercontent.com/wangjiegulu/RapidFloatingActionButton/master/screenshot/rfab_01.png" alt=""></a>&nbsp;<a href="https://raw.githubusercontent.com/wangjiegulu/RapidFloatingActionButton/master/screenshot/rfab_03.png" target="_blank" rel="noopener"><img src="https://raw.githubusercontent.com/wangjiegulu/RapidFloatingActionButton/master/screenshot/rfab_03.png" alt=""></a></p>
<h1 id="ä½¿ç”¨æ–¹å¼ï¼š"><a href="#ä½¿ç”¨æ–¹å¼ï¼š" class="headerlink" title="ä½¿ç”¨æ–¹å¼ï¼š"></a><a href="https://github.com/wangjiegulu/RapidFloatingActionButton#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F" target="_blank" rel="noopener"></a>ä½¿ç”¨æ–¹å¼ï¼š</h1><p>ä¾èµ–ï¼š<br><strong><a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">AndroidBucket</a>(<a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket</a>)</strong>ï¼šåŸºç¡€å·¥å…·åŒ…<br><strong><a href="https://github.com/wangjiegulu/androidInject" target="_blank" rel="noopener">AndroidInject</a>(<a href="https://github.com/wangjiegulu/androidInject" target="_blank" rel="noopener">https://github.com/wangjiegulu/androidInject</a>)</strong>ï¼šæ³¨è§£æ¡†æ¶</p>
<p><strong><a href="https://github.com/JakeWharton/NineOldAndroids" target="_blank" rel="noopener">NineOldAndroids</a>(<a href="https://github.com/JakeWharton/NineOldAndroids" target="_blank" rel="noopener">https://github.com/JakeWharton/NineOldAndroids</a>)</strong>ï¼šå…¼å®¹ä½ç‰ˆæœ¬çš„åŠ¨ç”»æ¡†æ¶</p>
<h2 id="activity-main-xmlï¼š"><a href="#activity-main-xmlï¼š" class="headerlink" title="activity_main.xmlï¼š"></a><a href="https://github.com/wangjiegulu/RapidFloatingActionButton#activity_mainxml" target="_blank" rel="noopener"></a>activity_main.xmlï¼š</h2><div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> &lt;<span style="color: #000000;">com.wangjie.rapidfloatingactionbutton.RapidFloatingActionLayout<br></span><span style="color: #008080;"> 2</span>       xmlns:rfal=â€<a href="http://schemas.android.com/apk/res-auto" target="_blank" rel="noopener">http://schemas.android.com/apk/res-auto</a>â€œ<br><span style="color: #008080;"> 3</span>       android:id=â€@+id/activity_main_rfalâ€<br><span style="color: #008080;"> 4</span>       android:layout_width=â€match_parentâ€<br><span style="color: #008080;"> 5</span>       android:layout_height=â€match_parentâ€<br><span style="color: #008080;"> 6</span>       rfal:rfal_frame_color=â€#ffffffâ€<br><span style="color: #008080;"> 7</span>       rfal:rfal_frame_alpha=â€0.7â€<br><span style="color: #008080;"> 8</span>       &gt;<br><span style="color: #008080;"> 9</span>   &lt;<span style="color: #000000;">com.wangjie.rapidfloatingactionbutton.RapidFloatingActionButton<br></span><span style="color: #008080;">10</span>           xmlns:rfab=â€<a href="http://schemas.android.com/apk/res-auto" target="_blank" rel="noopener">http://schemas.android.com/apk/res-auto</a>â€œ<br><span style="color: #008080;">11</span>           android:id=â€@+id/activity_main_rfabâ€<br><span style="color: #008080;">12</span>           android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;">13</span>           android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;">14</span>           android:layout_alignParentRight=â€trueâ€<br><span style="color: #008080;">15</span>           android:layout_alignParentBottom=â€trueâ€<br><span style="color: #008080;">16</span>           android:layout_marginRight=â€15dpâ€<br><span style="color: #008080;">17</span>           android:layout_marginBottom=â€15dpâ€<br><span style="color: #008080;">18</span>           android:padding=â€8dpâ€<br><span style="color: #008080;">19</span>           rfab:rfab_size=â€normalâ€<br><span style="color: #008080;">20</span>           rfab:rfab_drawable=â€@drawable/rfab__drawable_rfab_defaultâ€<br><span style="color: #008080;">21</span>           rfab:rfab_color_normal=â€#37474fâ€<br><span style="color: #008080;">22</span>           rfab:rfab_color_pressed=â€#263238â€<br><span style="color: #008080;">23</span>           rfab:rfab_shadow_radius=â€7dpâ€<br><span style="color: #008080;">24</span>           rfab:rfab_shadow_color=â€#999999â€<br><span style="color: #008080;">25</span>           rfab:rfab_shadow_dx=â€0dpâ€<br><span style="color: #008080;">26</span>           rfab:rfab_shadow_dy=â€5dpâ€<br><span style="color: #008080;">27</span>           /&gt;<br><span style="color: #008080;">28</span> &lt;/com.wangjie.rapidfloatingactionbutton.RapidFloatingActionLayout&gt;</pre><br></div>

<p>åœ¨éœ€è¦å¢åŠ RFABæœ€å¤–å±‚ä½¿ç”¨<code>&amp;lt;com.wangjie.rapidfloatingactionbutton.RapidFloatingActionLayout&amp;gt;</code>ï¼ŒæŒ‰é’®ä½¿ç”¨<code>&amp;lt;com.wangjie.rapidfloatingactionbutton.RapidFloatingActionButton&amp;gt;</code></p>
<h3 id="å±æ€§è§£é‡Š"><a href="#å±æ€§è§£é‡Š" class="headerlink" title="å±æ€§è§£é‡Š"></a><a href="https://github.com/wangjiegulu/RapidFloatingActionButton#%E5%B1%9E%E6%80%A7%E8%A7%A3%E9%87%8A" target="_blank" rel="noopener"></a>å±æ€§è§£é‡Š</h3><h4 id="RapidFloatingActionLayout"><a href="#RapidFloatingActionLayout" class="headerlink" title="RapidFloatingActionLayout:"></a><a href="https://github.com/wangjiegulu/RapidFloatingActionButton#rapidfloatingactionlayout" target="_blank" rel="noopener"></a>RapidFloatingActionLayout:</h4><div class="cnblogs_code"><br><pre><span style="color: #000000;">  rfal_frame_color: å±•å¼€RFABæ—¶å€™æœ€å¤–è¦†ç›–å±‚çš„é¢œè‰²ï¼Œé»˜è®¤æ˜¯çº¯ç™½è‰²<br>  rfal_frame_alpha: å±•å¼€RFABæ—¶å€™æœ€å¤–è¦†ç›–å±‚çš„é€æ˜åº¦(0 ~ 1)ï¼Œé»˜è®¤æ˜¯0.7</span></pre><br></div>

<h4 id="RapidFloatingActionButton-1"><a href="#RapidFloatingActionButton-1" class="headerlink" title="RapidFloatingActionButton:"></a><a href="https://github.com/wangjiegulu/RapidFloatingActionButton#rapidfloatingactionbutton-1" target="_blank" rel="noopener"></a>RapidFloatingActionButton:</h4><div class="cnblogs_code"><br><pre><span style="color: #000000;">ã€€rfab_size: RFABçš„å°ºå¯¸å¤§å°ï¼Œåªæ”¯æŒä¸¤ç§å°ºå¯¸ï¼ˆMaterial Designè§„èŒƒï¼‰ï¼š<br>          normal: ç›´å¾„56dp<br>          mini: ç›´å¾„40dp<br>  rfab_drawable: RFABä¸­é—´çš„å›¾æ ‡ï¼Œé»˜è®¤æ˜¯ä¸€ä¸ªâ€+â€å›¾æ ‡<br>  rfab_color_normal: RFABèƒŒæ™¯çš„æ™®é€šçŠ¶æ€ä¸‹çš„é¢œè‰²ã€‚é»˜è®¤æ˜¯ç™½è‰²<br>  rfab_color_pressed: RFABèƒŒæ™¯çš„è§¦æ‘¸æŒ‰ä¸‹çŠ¶æ€çš„é¢œè‰²ã€‚é»˜è®¤é¢œè‰²æ˜¯â€#ddddddâ€<br>  rfab_shadow_radius: RFABçš„é˜´å½±åŠå¾„ã€‚é»˜è®¤æ˜¯0ï¼Œè¡¨ç¤ºæ²¡æœ‰é˜´å½±<br>  rfab_shadow_color: RFABçš„é˜´å½±é¢œè‰²ã€‚é»˜è®¤æ˜¯é€æ˜ï¼Œå¦å¤–å¦‚æœrfab_shadow_radiusä¸º0ï¼Œåˆ™è¯¥å±æ€§æ— æ•ˆ<br>  rfab_shadow_dx: RFABçš„é˜´å½±Xè½´åç§»é‡ã€‚é»˜è®¤æ˜¯0<br>  rfab_shadow_dy: RFABçš„é˜´å½±Yè½´åç§»é‡ã€‚é»˜è®¤æ˜¯0</span></pre><br></div>

<h2 id="MainActivityï¼š"><a href="#MainActivityï¼š" class="headerlink" title="MainActivityï¼š"></a><a href="https://github.com/wangjiegulu/RapidFloatingActionButton#mainactivity" target="_blank" rel="noopener"></a>MainActivityï¼š</h2><div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">@AILayout(R.layout.activity_main)<br></span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span> AIActionBarActivity <span style="color: #0000ff;">implements</span><span style="color: #000000;"> RapidFloatingActionContentLabelList.OnRapidFloatingActionContentListener {<br></span><span style="color: #008080;"> 3</span><br><span style="color: #008080;"> 4</span> <span style="color: #000000;">    @AIView(R.id.activity_main_rfal)<br></span><span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> RapidFloatingActionLayout rfaLayout;<br></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">    @AIView(R.id.activity_main_rfab)<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> RapidFloatingActionButton rfaBtn;<br></span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> RapidFloatingActionButtonHelper rfabHelper;<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">11</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br></span><span style="color: #008080;">12</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br></span><span style="color: #008080;">13</span><br><span style="color: #008080;">14</span>         RapidFloatingActionContentLabelList rfaContent = <span style="color: #0000ff;">new</span><span style="color: #000000;"> RapidFloatingActionContentLabelList(context);<br></span><span style="color: #008080;">15</span>         rfaContent.setOnRapidFloatingActionContentListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">16</span>         List&lt;RFACLabelItem&gt; items = <span style="color: #0000ff;">new</span> ArrayList&lt;&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">17</span>         items.add(<span style="color: #0000ff;">new</span> RFACLabelItem&lt;Integer&gt;<span style="color: #000000;">()<br></span><span style="color: #008080;">18</span>                         .setLabel(â€œGithub: wangjieguluâ€<span style="color: #000000;">)<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">                        .setResId(R.drawable.ic_launcher)<br></span><span style="color: #008080;">20</span>                         .setIconNormalColor(0xffd84315<span style="color: #000000;">)<br></span><span style="color: #008080;">21</span>                         .setIconPressedColor(0xffbf360c<span style="color: #000000;">)<br></span><span style="color: #008080;">22</span>                         .setWrapper(0<span style="color: #000000;">)<br></span><span style="color: #008080;">23</span> <span style="color: #000000;">        );<br></span><span style="color: #008080;">24</span>         items.add(<span style="color: #0000ff;">new</span> RFACLabelItem&lt;Integer&gt;<span style="color: #000000;">()<br></span><span style="color: #008080;">25</span>                         .setLabel(â€œtiantian.china.2@gmail.comâ€<span style="color: #000000;">)<br></span><span style="color: #008080;">26</span> <span style="color: #000000;">                        .setResId(R.drawable.ic_launcher)<br></span><span style="color: #008080;">27</span>                         .setIconNormalColor(0xff4e342e<span style="color: #000000;">)<br></span><span style="color: #008080;">28</span>                         .setIconPressedColor(0xff3e2723<span style="color: #000000;">)<br></span><span style="color: #008080;">29</span>                         .setWrapper(1<span style="color: #000000;">)<br></span><span style="color: #008080;">30</span> <span style="color: #000000;">        );<br></span><span style="color: #008080;">31</span>         items.add(<span style="color: #0000ff;">new</span> RFACLabelItem&lt;Integer&gt;<span style="color: #000000;">()<br></span><span style="color: #008080;">32</span>                         .setLabel(â€œWangJieâ€<span style="color: #000000;">)<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">                        .setResId(R.drawable.ic_launcher)<br></span><span style="color: #008080;">34</span>                         .setIconNormalColor(0xff056f00<span style="color: #000000;">)<br></span><span style="color: #008080;">35</span>                         .setIconPressedColor(0xff0d5302<span style="color: #000000;">)<br></span><span style="color: #008080;">36</span>                         .setWrapper(2<span style="color: #000000;">)<br></span><span style="color: #008080;">37</span> <span style="color: #000000;">        );<br></span><span style="color: #008080;">38</span>         items.add(<span style="color: #0000ff;">new</span> RFACLabelItem&lt;Integer&gt;<span style="color: #000000;">()<br></span><span style="color: #008080;">39</span>                         .setLabel(â€œComposeâ€<span style="color: #000000;">)<br></span><span style="color: #008080;">40</span> <span style="color: #000000;">                        .setResId(R.drawable.ic_launcher)<br></span><span style="color: #008080;">41</span>                         .setIconNormalColor(0xff283593<span style="color: #000000;">)<br></span><span style="color: #008080;">42</span>                         .setIconPressedColor(0xff1a237e<span style="color: #000000;">)<br></span><span style="color: #008080;">43</span>                         .setWrapper(3<span style="color: #000000;">)<br></span><span style="color: #008080;">44</span> <span style="color: #000000;">        );<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">        rfaContent<br></span><span style="color: #008080;">46</span> <span style="color: #000000;">                .setItems(items)<br></span><span style="color: #008080;">47</span>                 .setIconShadowRadius(ABTextUtil.dip2px(context, 5<span style="color: #000000;">))<br></span><span style="color: #008080;">48</span>                 .setIconShadowColor(0xff999999<span style="color: #000000;">)<br></span><span style="color: #008080;">49</span>                 .setIconShadowDy(ABTextUtil.dip2px(context, 5<span style="color: #000000;">))<br></span><span style="color: #008080;">50</span> <span style="color: #000000;">        ;<br></span><span style="color: #008080;">51</span><br><span style="color: #008080;">52</span>         rfabHelper = <span style="color: #0000ff;">new</span><span style="color: #000000;"> RapidFloatingActionButtonHelper(<br></span><span style="color: #008080;">53</span> <span style="color: #000000;">                context,<br></span><span style="color: #008080;">54</span> <span style="color: #000000;">                rfaLayout,<br></span><span style="color: #008080;">55</span> <span style="color: #000000;">                rfaBtn,<br></span><span style="color: #008080;">56</span> <span style="color: #000000;">                rfaContent<br></span><span style="color: #008080;">57</span> <span style="color: #000000;">        ).build();<br></span><span style="color: #008080;">58</span><br><span style="color: #008080;">59</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">60</span><br><span style="color: #008080;">61</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">62</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onRFACItemLabelClick(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position, RFACLabelItem item) {<br></span><span style="color: #008080;">63</span>         Toast.makeText(getContext(), â€œclicked label: â€œ +<span style="color: #000000;"> position, Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">64</span> <span style="color: #000000;">        rfabHelper.toggleContent();<br></span><span style="color: #008080;">65</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">66</span><br><span style="color: #008080;">67</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">68</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onRFACItemIconClick(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position, RFACLabelItem item) {<br></span><span style="color: #008080;">69</span>         Toast.makeText(getContext(), â€œclicked icon: â€œ +<span style="color: #000000;"> position, Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">70</span> <span style="color: #000000;">        rfabHelper.toggleContent();<br></span><span style="color: #008080;">71</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">72</span> }</pre><br></div>

<p>é™¤äº†xmlä¸­è®¾ç½®çš„<code>RapidFloatingActionLayout</code>å’Œ<code>RapidFloatingActionButton</code>ä¹‹å¤–ï¼Œè¿˜éœ€è¦<code>RapidFloatingActionContent</code>çš„å®ç°ç±»æ¥å¡«å……å’ŒæŒ‡å®šRFABçš„å†…å®¹å’Œå½¢å¼ã€‚<br>è¿™é‡Œæä¾›äº†ä¸€ä¸ªå¿«é€Ÿçš„<code>RapidFloatingActionContent</code>çš„å®ç°è§£å†³æ–¹æ¡ˆ:<code>RapidFloatingActionContentLabelList</code>ã€‚ä½ å¯ä»¥åŠ å…¥å¤šä¸ªitemï¼ˆRFACLabelItemï¼Œå½“ç„¶ï¼Œä¸å»ºè®®åŠ å¤ªå¤šçš„itemï¼Œå¯¼è‡´è¶…è¿‡ä¸€ä¸ªå±å¹•ï¼‰ï¼Œç„¶åè®¾ç½®æ¯ä¸ªitemçš„é¢œè‰²ã€å›¾æ ‡ã€é˜´å½±ã€labelçš„èƒŒæ™¯å›¾ç‰‡ã€å­—ä½“å¤§å°é¢œè‰²ç”šè‡³åŠ¨ç”»ã€‚<br>å®ƒçš„æ•ˆæœå¯å‚è€ƒ<a href="https://github.com/wangjiegulu/RapidFloatingActionButton/tree/master/screenshot" target="_blank" rel="noopener">æœ€ä¸Šé¢çš„æ•ˆæœå›¾ç‰‡</a>æˆ–è€…<a href="https://play.google.com/store/apps/details?id=com.google.android.apps.inbox" target="_blank" rel="noopener">Googleçš„Inbox</a>çš„æ•ˆæœã€‚<br>é™¤æ­¤ä¹‹å¤–ï¼Œä½ è¿˜éœ€è¦ä½¿ç”¨<code>RapidFloatingActionButtonHelper</code>æ¥æŠŠä»¥ä¸Šæ‰€æœ‰é›¶æ•£çš„ç»„ä»¶ç»„åˆèµ·æ¥ã€‚</p>
<h1 id="å…³äºæ‰©å±•ï¼š"><a href="#å…³äºæ‰©å±•ï¼š" class="headerlink" title="å…³äºæ‰©å±•ï¼š"></a><a href="https://github.com/wangjiegulu/RapidFloatingActionButton#%E5%85%B3%E4%BA%8E%E6%89%A9%E5%B1%95" target="_blank" rel="noopener"></a>å…³äºæ‰©å±•ï¼š</h1><p>å¦‚æœä½ ä¸å–œæ¬¢é»˜è®¤æä¾›çš„<code>RapidFloatingActionContentLabelList</code>ï¼Œç†è®ºä¸Šä½ å¯ä»¥æ‰©å±•è‡ªå·±çš„å†…å®¹æ ·å¼ã€‚æ–¹æ³•æ˜¯ç»§æ‰¿<code>com.wangjie.rapidfloatingactionbutton.RapidFloatingActionContent</code>ï¼Œç„¶ååˆå§‹åŒ–å†…å®¹å¸ƒå±€å’Œæ ·å¼ï¼Œå¹¶è°ƒç”¨çˆ¶ç±»çš„<code>setRootView(xxx);</code>æ–¹æ³•å³å¯ã€‚å¦‚æœä½ éœ€è¦å¢åŠ åŠ¨ç”»ï¼Œå¯ä»¥é‡å†™å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onExpandAnimator(AnimatorSet animatorSet);<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCollapseAnimator(AnimatorSet animatorSet);</pre><br></div>

<p>æŠŠéœ€è¦çš„Animatorå¢åŠ åˆ°animatorSetä¸­å³å¯<br><code>å¦å¤–ï¼Œä½œè€…ä¹Ÿä¼šä¸å®šæœŸå¢åŠ æ›´å¤šçš„RapidFloatingActionContentçš„æ‰©å±•</code></p>
<h1 id="License"><a href="#License" class="headerlink" title="License"></a><a href="https://github.com/wangjiegulu/RapidFloatingActionButton#license" target="_blank" rel="noopener"></a>License</h1><div class="cnblogs_code"><br><pre><span style="color: #000000;">Copyright 2015 Wang Jie<br><br>Licensed under the Apache License, Version 2.0 (the â€œLicenseâ€);<br>you may not use this file except in compliance with the License.<br>You may obtain a copy of the License at<br><br>   <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener">http://www.apache.org/licenses/LICENSE-2.0</a><br><br>Unless required by applicable law or agreed to in writing, software<br>distributed under the License is distributed on an â€œAS ISâ€ BASIS,<br>WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br>See the License for the specific language governing permissions and<br>limitations under the License.</span></pre><br></div>

<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> view </tag>
            
            <tag> FloatingActionButton </tag>
            
            <tag> FAB </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]Activityè·³è½¬ä¼ é€’ä»»æ„ç±»å‹çš„æ•°æ®ã€Activityä¸ºSingleTaskæ—¶ä»£æ›¿StartActivityForResultçš„è§£å†³æ–¹æ¡ˆ]]></title>
      <url>/2015/04/03/Android-Activity%E8%B7%B3%E8%BD%AC%E4%BC%A0%E9%80%92%E4%BB%BB%E6%84%8F%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E3%80%81Activity%E4%B8%BASingleTask%E6%97%B6%E4%BB%A3%E6%9B%BFStartActivityForResult%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      <content type="html"><![CDATA[<p><span style="color: #ff0000;"><strong>ä»¥ä¸‹å†…å®¹ä¸ºåŸåˆ›ï¼Œæ¬¢è¿è½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜</strong></span></p>
<p><span style="color: #ff0000;"><strong>æ¥è‡ªå¤©å¤©åšå®¢ï¼š<a href="http://www.cnblogs.com/tiantianbyconan/p/4389674.html" title="view: [Android]Activityè·³è½¬ä¼ é€’ä»»æ„ç±»å‹çš„æ•°æ®ã€Activityä¸ºSingleTaskæ—¶ä»£æ›¿StartActivityçš„è§£å†³æ–¹æ¡ˆ" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4389674.html</a><a href="http://www.cnblogs.com/tiantianbyconan/p/4388175.html%20" target="_blank" rel="noopener"><span style="color: #ff0000;"><br></span></a></strong></span></p>
<p>&nbsp;</p>
<p>éœ€æ±‚ï¼šåœ¨ActivityAè·³è½¬åˆ°ActivityBï¼Œç„¶ååœ¨ActivityBæ“ä½œå®Œè¿”å›æ•°æ®ç»™ActivityAã€‚</p>
<p>è¿™ä¸ªå¾ˆæ™®éçš„éœ€æ±‚ï¼Œä¸€èˆ¬æƒ…å†µæ˜¯ä½¿ç”¨startActivityForResultçš„æ–¹å¼å»å®Œæˆã€‚</p>
<p>ä½†æ˜¯å½“ActivityBä¸ºSingleTaskæ—¶ï¼Œè¿™ä¸ªæ–¹å¼å°±æ— æ•ˆäº†ã€‚ä½ ä¼šå‘ç°å½“ä½ æ‰§è¡ŒstartActivityForResultåï¼ŒonActivityResultæ–¹æ³•é©¬ä¸Šå°±ä¼šè¢«å›è°ƒã€‚è‡³äºä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå‚è€ƒè¿™ä½è€å…„çš„æ–‡ç« å°±å¯ä»¥ç†è§£<a href="http://blog.csdn.net/sodino/article/details/22101881" target="_blank" rel="noopener">http://blog.csdn.net/sodino/article/details/22101881</a>ã€‚</p>
<p>è§£å†³è¿™ç§æƒ…å†µçš„æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯æŠŠActivityAä¹Ÿè®¾ç½®ä¸ºSingleTaskï¼Œç„¶ååœ¨ActivityBä¸­startActivity(context, ActivityA.class)ï¼Œç„¶åActivityAåœ¨onNewIntent(Intent intent)æ–¹æ³•ä¸­å»è·å–ä¼ é€’æ•°æ®ï¼Œè¿™æ ·çš„æ–¹å¼ä¸ä»…ç ´åäº†ActivityAçš„lauchModeï¼Œè€Œä¸”è¿˜éœ€è¦ActivityBä¸­å¯åŠ¨æŒ‡å®šçš„ActivityAã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœèƒ½æŠŠActivityAçš„å½“å‰å¯¹è±¡ï¼ˆå®ç°æŸä¸ªæ¥å£ï¼‰ä¼ åˆ°ActivityBä¸­ï¼Œç„¶åActivityBä¸­é€šè¿‡æ¥å£ç›´æ¥å›è°ƒé‚£å°±è§£å†³é—®é¢˜äº†ã€‚</p>
<p>ä½†æ˜¯é—®é¢˜æ˜¯æ€ä¹ˆæŠŠå½“å‰å¯¹è±¡ä¼ è¿‡å»ï¼Œä½¿ç”¨Intentæ˜¾ç„¶ä¸è¡Œã€‚</p>
<p>æ€è·¯æ˜¯ç»´æŠ¤ä¸€ä¸ªStoragePoolï¼Œé‡Œé¢å¯ä»¥æš‚å­˜éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚ç›¸å½“äºä¸€ä¸ªæš‚å­˜åŒºï¼ŒActivityAè·³è½¬å‰ï¼ŒæŠŠæ•°æ®æ”¾å…¥è¿™ä¸ªæš‚å­˜åŒºï¼Œè·å¾—ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œç„¶åæŠŠè¿™ä¸ªå”¯ä¸€æ ‡è¯†ä½¿ç”¨Intentçš„æ–¹å¼ä¼ é€’ç»™ActivityBï¼Œç„¶åActivityBæ‹¿åˆ°è¿™ä¸ªå”¯ä¸€æ ‡è¯†åå»æš‚å­˜åŒºå»å–æ•°æ®å°±å¥½äº†ã€‚</p>
<p>æš‚å­˜åŒºStoragePoolä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;"> <em> Author: wangjie<br></em></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">  Email: tiantian.china.2@gmail.com<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;"> <em> Date: 3/30/15.<br></em></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> StoragePool {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 8</span> <span style="color: #008000;">     <em> key   â€“ æ ‡è¯†æ˜¯å“ªä¸€ä¸ªintentçš„ï¼ˆUUIDï¼‰<br></em></span><span style="color: #008080;"> 9</span> <span style="color: #008000;">     <br></span><span style="color: #008080;">10</span> <span style="color: #008000;">     <em>         |- key â€“ å­˜å‚¨çš„å¯¹è±¡æ ‡è¯†ï¼ˆStorageKeyï¼Œä½¿ç”¨UUIDå”¯ä¸€ï¼‰<br></em></span><span style="color: #008080;">11</span> <span style="color: #008000;">      value â€“|<br></span><span style="color: #008080;">12</span> <span style="color: #008000;">     <em>         |- value â€“ å­˜å‚¨çš„å†…å®¹<br></em></span><span style="color: #008080;">13</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">14</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> ConcurrentHashMap&lt;String, HashMap&lt;StorageKey, WeakReference&lt;Object&gt;&gt;&gt; storageMapper = <span style="color: #0000ff;">new</span> ConcurrentHashMap&lt;&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> StoragePool() {<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> storage(String tagUUID, StorageKey key, Object content) {<br></span><span style="color: #008080;">20</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> == key || <span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> content) {<br></span><span style="color: #008080;">21</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;">22</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">23</span>         HashMap&lt;StorageKey, WeakReference&lt;Object&gt;&gt; extraMapper =<span style="color: #000000;"> storageMapper.get(tagUUID);<br></span><span style="color: #008080;">24</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> extraMapper) {<br></span><span style="color: #008080;">25</span>             extraMapper = <span style="color: #0000ff;">new</span> HashMap&lt;&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">26</span> <span style="color: #000000;">            storageMapper.put(tagUUID, extraMapper);<br></span><span style="color: #008080;">27</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">28</span>         extraMapper.put(key, <span style="color: #0000ff;">new</span> WeakReference&lt;&gt;<span style="color: #000000;">(content));<br></span><span style="color: #008080;">29</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> Object remove(String tagUUID, StorageKey key) {<br></span><span style="color: #008080;">32</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> key) {<br></span><span style="color: #008080;">33</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;">34</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">35</span>         HashMap&lt;StorageKey, WeakReference&lt;Object&gt;&gt; extraMapper =<span style="color: #000000;"> storageMapper.get(tagUUID);<br></span><span style="color: #008080;">36</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> extraMapper) {<br></span><span style="color: #008080;">37</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;">38</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">39</span><br><span style="color: #008080;">40</span>         WeakReference&lt;Object&gt; ref =<span style="color: #000000;"> extraMapper.remove(key);<br></span><span style="color: #008080;">41</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (ABTextUtil.isEmpty(extraMapper)) {<br></span><span style="color: #008080;">42</span> <span style="color: #000000;">            storageMapper.remove(tagUUID);<br></span><span style="color: #008080;">43</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">44</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span> == ref ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : ref.get();<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> HashMap&lt;StorageKey, WeakReference&lt;Object&gt;&gt;<span style="color: #000000;"> remove(String tagUUID) {<br></span><span style="color: #008080;">48</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> tagUUID) {<br></span><span style="color: #008080;">49</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;">50</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">51</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> storageMapper.remove(tagUUID);<br></span><span style="color: #008080;">52</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">53</span><br><span style="color: #008080;">54</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> clear() {<br></span><span style="color: #008080;">55</span> <span style="color: #000000;">        storageMapper.clear();<br></span><span style="color: #008080;">56</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">57</span><br><span style="color: #008080;">58</span> }</pre><br></div>

<p>å¦‚ä¸Šä»£ç ï¼ŒStoragePoolç»´æŠ¤äº†ä¸€ä¸ªHashMapï¼Œkeyæ˜¯ä¸€ä¸ªUUIDï¼Œä»£è¡¨å”¯ä¸€çš„ä¸€ä¸ªIntentè·³è½¬ï¼ŒActivityAè·³è½¬æ—¶ä¼šæŠŠè¿™ä¸ªUUIDä¼ é€’åˆ°ActivityBï¼ŒActivityBå°±æ˜¯é€šè¿‡è¿™ä¸ªUUIDæ¥è·å–è¿™æ¬¡è·³è½¬éœ€è¦ä¼ é€’çš„æ•°æ®çš„ã€‚valueä¹Ÿæ˜¯ä¸€ä¸ªHashMapï¼Œé‡Œé¢å­˜å‚¨äº†æŸæ¬¡è·³è½¬ä¼ é€’çš„æ‰€æœ‰æ•°æ®ã€‚keyæ˜¯StorageKeyï¼Œå®è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªUUIDï¼Œvalueæ˜¯ä»»æ„çš„æ•°æ®ã€‚</p>
<p>è·³è½¬å‰çš„å­˜å‚¨æ•°æ®å’ŒçœŸæ­£çš„StartActivityéƒ½éœ€è¦ä½¿ç”¨StorageIntentCenteræ¥è¿›è¡Œæ“ä½œï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 3/31/15.<br></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> StorageIntentCenter {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String STORAGE_INTENT_CENTER_KEY_UUID = StorageIntentCenter.<span style="color: #0000ff;">class</span>.getSimpleName() + â€œ_UUIDâ€<span style="color: #000000;">;<br></span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = StorageIntentCenter.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Intent intent;<br></span><span style="color: #008080;">11</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String uuid;<br></span><span style="color: #008080;">12</span>     <span style="color: #0000ff;">private</span> HashMap&lt;StorageKey, Object&gt;<span style="color: #000000;"> extras;<br></span><span style="color: #008080;">13</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isUsed;<br></span><span style="color: #008080;">14</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> StorageIntentCenter() {<br></span><span style="color: #008080;">15</span>         intent = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Intent();<br></span><span style="color: #008080;">16</span>         uuid =<span style="color: #000000;"> java.util.UUID.randomUUID().toString();<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">        intent.putExtra(STORAGE_INTENT_CENTER_KEY_UUID, uuid);<br></span><span style="color: #008080;">18</span>         isUsed = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> StorageIntentCenter putExtra(String intentKey, Object content){<br></span><span style="color: #008080;">22</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> content) {<br></span><span style="color: #008080;">23</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;">24</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">25</span>         StorageKey storageKey = <span style="color: #0000ff;">new</span><span style="color: #000000;"> StorageKey(content.getClass());<br></span><span style="color: #008080;">26</span> <span style="color: #000000;">        intent.putExtra(intentKey, storageKey);<br></span><span style="color: #008080;">27</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> extras){<br></span><span style="color: #008080;">28</span>             extras = <span style="color: #0000ff;">new</span> HashMap&lt;&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">29</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">30</span> <span style="color: #000000;">        extras.put(storageKey, content);<br></span><span style="color: #008080;">31</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;">32</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">33</span><br><span style="color: #008080;">34</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> startActivity(Context packageContext, Class&lt;?&gt;<span style="color: #000000;"> cls){<br></span><span style="color: #008080;">35</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;">(isUsed){<br></span><span style="color: #008080;">36</span>             Logger.e(TAG, <span style="color: #0000ff;">this</span> + â€œ can not be reuse!â€<span style="color: #000000;">);<br></span><span style="color: #008080;">37</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;">38</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">39</span> <span style="color: #000000;">        intent.setClass(packageContext, cls);<br></span><span style="color: #008080;">40</span>         <span style="color: #0000ff;">if</span>(!<span style="color: #000000;">ABTextUtil.isEmpty(extras)){<br></span><span style="color: #008080;">41</span>             Set&lt;Map.Entry&lt;StorageKey, Object&gt;&gt; entrySet =<span style="color: #000000;"> extras.entrySet();<br></span><span style="color: #008080;">42</span>             <span style="color: #0000ff;">for</span>(Map.Entry&lt;StorageKey, Object&gt;<span style="color: #000000;"> entry : entrySet){<br></span><span style="color: #008080;">43</span> <span style="color: #000000;">                StoragePool.storage(uuid, entry.getKey(), entry.getValue());<br></span><span style="color: #008080;">44</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">46</span>         isUsed = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">47</span> <span style="color: #000000;">        packageContext.startActivity(intent);<br></span><span style="color: #008080;">48</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">49</span><br><span style="color: #008080;">50</span><br><span style="color: #008080;">51</span> }</pre><br></div>

<p>æ¯ä¸ªStorageIntentCenteréƒ½ç»´æŠ¤äº†ä¸€ä¸ªçœŸæ­£è·³è½¬çš„Intentï¼Œä¸€ä¸ªæ­¤æ¬¡è·³è½¬çš„uuidå’Œæ‰€æœ‰éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚</p>
<p>&nbsp;</p>
<p>ä½¿ç”¨æ–¹å¼ï¼ˆä»¥ä»MainActivityè·³è½¬åˆ°OtherActivityä¸ºä¾‹ï¼‰ï¼š</p>
<p>MainActivityä¸­ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #000000;">@AILayout(R.layout.main)<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span> BaseActivity <span style="color: #0000ff;">implements</span><span style="color: #000000;"> ICommunicate {<br><br>    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = MainActivity.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br><br>    @Override<br>    @AIClick({R.id.ac_test_a_btn})<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClickCallbackSample(View view) {<br>        </span><span style="color: #0000ff;">switch</span><span style="color: #000000;"> (view.getId()) {<br>            </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.ac_test_a_btn:<br>                </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> StorageIntentCenter()<br>                        .putExtra(</span>â€œiCommunicateâ€, <span style="color: #0000ff;">this</span><span style="color: #000000;">)<br>                        .putExtra(</span>â€œtestStringâ€, â€œhello worldâ€<span style="color: #000000;">)<br>                        .putExtra(</span>â€œtestFloatâ€, 3.2f<span style="color: #000000;">)<br>                        .startActivity(context, OtherActivity.</span><span style="color: #0000ff;">class</span><span style="color: #000000;">);<br><br>                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br>        }<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> hello(String content) {<br>        Logger.d(TAG, </span>â€œhello received: â€œ +<span style="color: #000000;"> content);<br>    }<br><br>}</span></pre><br></div>

<p>&nbsp;</p>
<p>OtherActivityç»§æ‰¿äº†BaseActivityã€‚</p>
<p>BaseActivityï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 4/2/15.<br></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> BaseActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> AIActivity {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String storageIntentCenterUUID;<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">10</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br></span><span style="color: #008080;">11</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br></span><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> <span style="color: #000000;">        initExtraFromStorage();<br></span><span style="color: #008080;">14</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> remove extra from StoragePool</span><br><span style="color: #008080;">15</span> <span style="color: #000000;">        StoragePool.remove(storageIntentCenterUUID);<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> initExtraFromStorage() {<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">final</span> &lt;T&gt; T getExtraFromStorage(String key, Class&lt;T&gt;<span style="color: #000000;"> contentType) {<br></span><span style="color: #008080;">22</span>         StorageKey storageKey =<span style="color: #000000;"> (StorageKey) getIntent().getSerializableExtra(key);<br></span><span style="color: #008080;">23</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> storageIntentCenterUUID) {<br></span><span style="color: #008080;">24</span>             storageIntentCenterUUID =<span style="color: #000000;"> getIntent().getStringExtra(StorageIntentCenter.STORAGE_INTENT_CENTER_KEY_UUID);<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">26</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> (T) StoragePool.remove(storageIntentCenterUUID, storageKey);<br></span><span style="color: #008080;">27</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span> }</pre><br></div>

<p>Line15ï¼šä¸ºäº†é˜²æ­¢è·³è½¬åˆ°OtherActivityåï¼Œå¦‚æœæ²¡æœ‰å»æš‚å­˜åŒºæŠŠæ•°æ®å–å‡ºæ¥ä»è€Œå¯¼è‡´æš‚å­˜åŒºæœ‰æ— ç”¨çš„æ•°æ®ï¼ˆç”šè‡³å†…å­˜æ³„æ¼ï¼Œæš‚å­˜åŒºä½¿ç”¨è½¯å¼•ç”¨ä¹Ÿæ˜¯ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œæä¾›ä¸€ä¸ªinitExtraFromStorageæ–¹æ³•è®©å­ç±»é‡å†™ï¼Œå­ç±»å¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å»æŠŠæ•°æ®å–å‡ºæ¥ã€‚ç„¶ååœ¨initExtraFromStorageæ–¹æ³•æ‰§è¡Œå®Œæ¯•åï¼Œå†åŠæ—¶æŠŠæš‚å­˜åŒºçš„æ•°æ®åˆ é™¤ã€‚</p>
<p>Line21ï½27:è¿™é‡Œæä¾›äº†ä»æš‚å­˜åŒºæå–æ•°æ®çš„æ–¹æ³•ä¾›å­ç±»è°ƒç”¨ã€‚</p>
<p>&nbsp;</p>
<p>OtherActivityï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  Author: wangjie<br> <em> Email: tiantian.china.2@gmail.com
 </em> Date: 4/2/15.<br> </span><span style="color: #008000;">*/</span><span style="color: #000000;"><br>@AILayout(R.layout.other)<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> OtherActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> BaseActivity{<br>    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = OtherActivity.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br><br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> ICommunicate iCommunicate;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String testString;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Float testFloat;<br><br>    @Override<br>    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> initExtraFromStorage() {<br>        iCommunicate </span>= getExtraFromStorage(â€œiCommunicateâ€, ICommunicate.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br>        testString </span>= getExtraFromStorage(â€œtestStringâ€, String.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br>        testFloat </span>= getExtraFromStorage(â€œtestFloatâ€, Float.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br>    }<br><br>    @Override<br>    @AIClick({R.id.other_btn})<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClickCallbackSample(View view) {<br>        </span><span style="color: #0000ff;">switch</span><span style="color: #000000;">(view.getId()){<br>            </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.other_btn:<br>                </span><span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> iCommunicate){<br>                    </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;<br>                }<br>                Logger.d(TAG, </span>â€œiCommunicate: â€œ +<span style="color: #000000;"> iCommunicate);<br>                iCommunicate.hello(</span>â€œcontent from ACTestBActivity!â€<span style="color: #000000;">);<br><br>                Logger.d(TAG, </span>â€œtestString: â€œ +<span style="color: #000000;"> testString);<br>                Logger.d(TAG, </span>â€œtestFloat: â€œ +<span style="color: #000000;"> testFloat);<br>                finish();<br><br>                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br>        }<br>    }<br>}</span></pre><br></div>

<p>å¦‚ä¸Šä»£ç OtherActivityä¸­è·å–äº†ä»MainActivityä¸­ä¼ é€’è¿‡æ¥çš„MainActivityå®ä¾‹ï¼Œåœ¨ç‚¹å‡»äº‹ä»¶å‘ç”Ÿåé€šè¿‡MainActivityå®ä¾‹è¿›è¡Œç›´æ¥å›è°ƒã€‚</p>
<p>æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre>04-03 12:09:52.184  25529-25529/com.wangjie.androidstorageintent D/<span style="color: #000000;">OtherActivityï¹• iCommunicate: com.wangjie.androidstorageintent.sample.MainActivity@42879ff8<br></span>04-03 12:09:52.184  25529-25529/com.wangjie.androidstorageintent D/MainActivityï¹• hello received: content from ACTestBActivity!<br>04-03 12:09:52.184  25529-25529/com.wangjie.androidstorageintent D/<span style="color: #000000;">OtherActivityï¹• testString: hello world<br></span>04-03 12:09:52.184  25529-25529/com.wangjie.androidstorageintent D/OtherActivityï¹• testFloat: 3.2</pre><br></div>

<p>MainActivityè¢«å›è°ƒï¼Œå¹¶è·å–äº†æ•°æ®&ldquo;content from ACTestBActivity!&rdquo;å­—ç¬¦ä¸²ã€‚</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;"><strong>æ³¨ï¼š</strong></span></p>
<p><span style="color: #ff0000;"><strong>1. ä»¥ä¸Šä½¿ç”¨çš„ä»£ç å·²æ‰˜ç®¡åˆ°githubï¼š<a href="https://github.com/wangjiegulu/AndroidStorageIntent" target="_blank" rel="noopener"><span style="color: #ff0000;">https://github.com/wangjiegulu/AndroidStorageIntent</span></a></strong></span></p>
<p><span style="color: #ff0000;"><strong>2. ä¸Šé¢çš„æ³¨è§£å®ç°ä½¿ç”¨AndroidInjectï¼š<a href="https://github.com/wangjiegulu/androidInject" target="_blank" rel="noopener"><span style="color: #ff0000;">https://github.com/wangjiegulu/androidInject</span></a></strong></span></p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> activity </tag>
            
            <tag> launch mode </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä½¿ç”¨Gradleæäº¤è‡ªå·±å¼€æºAndroidåº“åˆ°Mavenä¸­å¿ƒåº“]]></title>
      <url>/2015/04/02/Android-%E4%BD%BF%E7%94%A8Gradle%E6%8F%90%E4%BA%A4%E8%87%AA%E5%B7%B1%E5%BC%80%E6%BA%90Android%E5%BA%93%E5%88%B0Maven%E4%B8%AD%E5%BF%83%E5%BA%93/</url>
      <content type="html"><![CDATA[<p>æ­¤æ–‡é’ˆå¯¹å¼€æºçˆ±å¥½è€…ã€‚</p>
<p>å¦‚æœä½ æƒ³è®©åˆ«äººä½¿ç”¨ä½ çš„Androidå¼€æºåº“ï¼Œç¬¬ä¸€ç§æ–¹æ³•æ˜¯ï¼Œæä¾›ä½ çš„Githubåœ°å€ï¼Œè®©åˆ«äººcloneä¸€ä»½ï¼Œç„¶åè®©åˆ«äººimportåˆ°ä»–çš„é¡¹ç›®ä¸­ã€‚å¦ä¸€ç§æ›´ç®€å•çš„æ–¹å¼å°±æ˜¯ç›´æ¥è®©åˆ«äººåœ¨ä»–çš„Gradleä¸­æ·»åŠ ä½ çš„åº“ä¾èµ–ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre>compile â€˜com.github.wangjiegulu:AndroidBucket:1.0.1â€™</pre><br></div>

<p>å¦‚æœæƒ³ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œä½ éœ€è¦å°†ä½ çš„é¡¹ç›®æäº¤åˆ°å…¬å…±çš„ä¸­å¿ƒåº“ã€‚</p>
<p>è¿™é‡Œä»‹ç»ä½¿ç”¨sonatypeæ¥æŠŠä½ çš„å¼€æºåº“ï¼ˆsnapshotæˆ–releaseï¼‰æäº¤åˆ°Mavençš„ä¸­å¿ƒåº“ã€‚<strong>
</strong></p>
<p>1. é¦–å…ˆï¼Œåœ¨<a href="https://issues.sonatype.org" target="_blank" rel="noopener">https://issues.sonatype.org</a>ä¸­æ³¨å†Œè´¦å·ã€‚</p>
<p>2. ç„¶ååœ¨<a href="https://issues.sonatype.org/secure/CreateIssue.jspa?issuetype=21&amp;pid=10134" target="_blank" rel="noopener">https://issues.sonatype.org/secure/CreateIssue.jspa?issuetype=21&amp;pid=10134</a>ä¸­æ–°å»ºä¸€ä¸ª&ldquo;Project ticket&rdquo;ã€‚</p>
<p>ï¼Summaryï¼šå¡«å†™é¡¹ç›®åç§°<span class="aui-icon icon-required"><br></span></p>
<p>ï¼Descriptionï¼šå¡«å†™æè¿°</p>
<p>ï¼Group Idï¼šåŸŸååè½¬ï¼Œå¦‚æœæ²¡æœ‰åŸŸåï¼Œå°±ç›´æ¥ä½¿ç”¨githubåè½¬ï¼ˆå¦‚github.com/wangjiegulu â€“&gt; com.github.wangjieguluï¼‰ï¼Œå…·ä½“çœ‹<a href="http://central.sonatype.org/pages/choosing-your-coordinates.html" target="_blank" rel="noopener">http://central.sonatype.org/pages/choosing-your-coordinates.html</a><span class="aui-icon icon-required"><br></span></p>
<p>ï¼Project URLï¼šé¡¹ç›®çš„urlï¼Œå¯ä»¥æ˜¯é¡¹ç›®çš„githubåœ°å€ã€‚å¦‚<a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket</a></p>
<p>ï¼SCM urlï¼šç‰ˆæœ¬æ§åˆ¶çš„uriï¼Œå¦‚<a href="https://github.com/wangjiegulu/AndroidBucket.git" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket.git</a></p>
<p>3. åˆ›å»ºå®Œæ¯•åå°±ç­‰å¾…çŠ¶æ€å˜ä¸º&ldquo;resolved&rdquo;ï¼Œç„¶åä½ å°±å¯ä»¥ä½¿ç”¨Gradleä¸Šä¼ é¡¹ç›®äº†ã€‚</p>
<p>4. ä¸Šä¼ å‰éœ€è¦è¿›è¡ŒGPGç­¾åï¼Œæ‰€ä»¥å…ˆå»ä¸‹è½½GPGï¼ˆ<a href="https://www.gnupg.org/download/index.html" target="_blank" rel="noopener">https://www.gnupg.org/download/index.html</a>ï¼‰ï¼Œç„¶åæ‰“å¼€</p>
<p><img src="http://images.cnitblog.com/blog2015/378300/201504/021841366545243.png" alt=""></p>
<p>æ–°å»ºä¸€ä¸ªKeychainï¼Œå®Œæˆåå³é”®&ldquo;Send Public Key to Key Server&rdquo;ï¼Œè¿™æ ·å°±èƒ½æŠŠä½ çš„public keyå‘é€åˆ°æœåŠ¡ç«¯ã€‚</p>
<p>5. ç„¶åæˆ‘ä»¬å†æ‰“åŒ…é¡¹ç›®çš„aaræ–‡ä»¶ï¼Œintellij ideaå’Œandroid studioä½¿ç”¨gradleæ„å»ºåï¼Œä¼šåœ¨buildä¸­è‡ªåŠ¨ç”Ÿæˆè¯¥æ–‡ä»¶ï¼Œç›´æ¥æŠŠä»–æ‹·å‡ºæ¥å³å¯ã€‚</p>
<p>6. ç„¶åæ–°å»ºbuild.gradleæ¥è¿›è¡Œæˆ‘ä»¬çš„ä¸Šä¼ æ“ä½œï¼Œå¤§æ¦‚å†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">//</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></span><span style="color: #000000;"><br>apply plugin: </span>â€˜mavenâ€™<span style="color: #000000;"><br>apply plugin: </span>â€˜signingâ€™ <span style="color: #008000;">//</span><span style="color: #008000;">ä½¿ç”¨signing pluginåšæ•°å­—ç­¾å<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;">å®šä¹‰GroupIDå’ŒVersionï¼ŒArtefactIDä¼šè‡ªåŠ¨ä½¿ç”¨Projectå</span><br>group = â€˜com.github.wangjieguluâ€™<span style="color: #000000;"><br>version </span>= â€˜1.0.1â€™<br><span style="color: #000000;"><br>repositories {<br>    mavenCentral();<br>}<br><br>artifacts {<br>    archives file(</span>â€˜AndroidBucket.aarâ€™<span style="color: #000000;">)<br>}<br>signing {<br>    sign configurations.archives<br>}</span><br><span style="color: #000000;"><br>uploadArchives {<br>    repositories {<br>        mavenDeployer {<br>            </span><span style="color: #008000;">//</span><span style="color: #008000;">ä¸ºPomæ–‡ä»¶åšæ•°å­—ç­¾å</span><br>            beforeDeployment { MavenDeployment deployment -&gt;<span style="color: #000000;"> signing.signPom(deployment) }<br><br>            </span><span style="color: #008000;">//</span><span style="color: #008000;">æŒ‡å®šé¡¹ç›®éƒ¨ç½²åˆ°çš„ä¸­å¤®åº“åœ°å€ï¼ŒUserNameå’ŒPasswordå°±æ˜¯Part 1ä¸­æ³¨å†Œçš„è´¦å·ã€‚</span><br>            repository(url: â€œ<a href="https://oss.sonatype.org/service/local/staging/deploy/maven2/" target="_blank" rel="noopener">https://oss.sonatype.org/service/local/staging/deploy/maven2/</a>â€œ<span style="color: #000000;">) {<br>                authentication(userName: ossrhUsername, password: ossrhPassword)<br>            }<br>            snapshotRepository(url: </span>â€œ<a href="https://oss.sonatype.org/content/repositories/snapshots/" target="_blank" rel="noopener">https://oss.sonatype.org/content/repositories/snapshots/</a>â€œ<span style="color: #000000;">) {<br>                authentication(userName: ossrhUsername, password: ossrhPassword)<br>            }<br><br>            </span><span style="color: #008000;">//</span><span style="color: #008000;">æ„é€ é¡¹ç›®çš„Pomæ–‡ä»¶ï¼Œå‚è§Part 2ä¸­Pomæ–‡ä»¶çš„è§„èŒƒï¼Œä¸è¦é—æ¼å¿…å¡«é¡¹</span><br><span style="color: #000000;">            pom.project {<br>                name project.name<br>                packaging </span>â€˜aarâ€™<span style="color: #000000;"><br>                description </span>â€˜Androidå¼€å‘å¸¸ç”¨æ•´ç†â€™<span style="color: #000000;"><br>                url </span>â€˜<a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket</a>â€˜<span style="color: #000000;"><br><br>                scm {<br>                    url </span>â€˜scm:git@github.com:wangjiegulu/AndroidBucket.gitâ€™<span style="color: #000000;"><br>                    connection </span>â€˜scm:git@github.com:wangjiegulu/AndroidBucket.gitâ€™<span style="color: #000000;"><br>                    developerConnection </span>â€˜git@github.com:wangjiegulu/AndroidBucket.gitâ€™<span style="color: #000000;"><br>                }<br><br>                licenses {<br>                    license {<br>                        name </span>â€˜The Apache Software License, Version 2.0â€™<span style="color: #000000;"><br>                        url </span>â€˜<a href="http://www.apache.org/licenses/LICENSE-2.0.txt" target="_blank" rel="noopener">http://www.apache.org/licenses/LICENSE-2.0.txt</a>â€˜<span style="color: #000000;"><br>                        distribution </span>â€˜wangjieâ€™<span style="color: #000000;"><br>                    }<br>                }<br><br>                developers {<br>                    developer {<br>                        id </span>â€˜wangjieâ€™<span style="color: #000000;"><br>                        name </span>â€˜Wagn Jieâ€™<span style="color: #000000;"><br>                        email </span>â€˜tiantian.china.2@gmail.comâ€™<span style="color: #000000;"><br>                    }<br>                }<br>            }<br>        }<br>    }<br>}</span></pre><br></div>

<p>archives file(â€˜AndroidBucket.aarâ€™) è¡¨ç¤ºæŒ‡å®šä¸Šä¼ çš„aaræ–‡ä»¶ã€‚</p>
<div class="cnblogs_code"><br><pre><span style="color: #000000;">signing {<br>    sign configurations.archives<br>}</span></pre><br></div>

<p>è¡¨ç¤ºå¯¹å†…å®¹è¿›è¡Œgpgç­¾åï¼Œæ—¢ç„¶éœ€è¦ç­¾åï¼Œé‚£éœ€è¦åœ¨gradle.properitesä¸­é…ç½®keyçš„ä¿¡æ¯ï¼Œè¿˜æœ‰ä¸Šä¼ çš„è´¦å·å¯†ç ï¼š</p>
<div class="cnblogs_code"><br><pre>signing.keyId=<span style="color: #000000;">XXXXXXXXX<br>signing.password</span>=XXXXXXXXX<span style="color: #000000;"><br>signing.secretKeyRingFile</span>=/Users/wangjie/.gnupg/secring.gpg</pre><br><br>&nbsp; ossrhUsername=oss.sonatype.orgæˆ–è€…issues.sonatype.orgçš„è´¦å·ï¼ˆåŒä¸€ä¸ªï¼‰<br>&nbsp; ossrhPassword=oss.sonatype.orgæˆ–è€…issues.sonatype.orgçš„å¯†ç ï¼ˆåŒä¸€ä¸ªï¼‰<br><br></div>

<p>æ‰€æœ‰é…ç½®å®Œæ¯•åæ‰§è¡Œgradle&nbsp;uploadArchivesè¿›è¡Œä¸Šä¼ æ“ä½œã€‚</p>
<p>7. ç™»å½•<a href="https://oss.sonatype.org" target="_blank" rel="noopener">https://oss.sonatype.org</a>ï¼Œç‚¹å‡»å·¦è¾¹çš„&ldquo;Staging Repositories&rdquo;ï¼Œç„¶ååˆšåˆšä¸Šä¼ çš„é¡¹ç›®åç§°ä¸ºcom.github.wangjieguluå»æ‰ç‚¹-æ•°å­—</p>
<p>é€‰ä¸­åç‚¹å‡»&ldquo;Close&rdquo;ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å†ç‚¹å‡»&ldquo;Release&rdquo;æŒ‰é’®å‘å¸ƒã€‚</p>
<p>ç„¶åå†ç­‰å¾…2å°æ—¶ï¼Œå°±å¯ä»¥åœ¨Mavenä¸­å¿ƒåº“ä¸­æœç´¢åˆ°äº†ã€‚</p>
<p>&nbsp;</p>
<p>æ³¨æ„ï¼šä»¥åå¦‚æœéœ€è¦å†ä¸Šä¼ å…¶å®ƒé¡¹ç›®çš„æ—¶å€™ï¼Œç›´æ¥ä»ç¬¬4æ­¥å¼€å§‹å³å¯ï¼Œå› ä¸ºä½ çš„groupIdå·²ç»ç”³è¯·è¿‡äº†ï¼Œä»¥åæ–°çš„artifactså¯ä»¥ç›´æ¥éƒ¨ç½²åˆ°è¿™ä¸ªgroupIdä¸­ã€‚</p>
<p>&nbsp;</p>
<p>å‚è€ƒï¼š<a href="http://central.sonatype.org/pages/ossrh-guide.html" target="_blank" rel="noopener">http://central.sonatype.org/pages/ossrh-guide.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> maven </tag>
            
            <tag> open source </tag>
            
            <tag> gradle </tag>
            
            <tag> uploadArchive </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[100ä¸ªé«˜è´¨é‡Javaå¼€å‘è€…åšå®¢]]></title>
      <url>/2015/02/28/100%E4%B8%AA%E9%AB%98%E8%B4%A8%E9%87%8FJava%E5%BC%80%E5%8F%91%E8%80%85%E5%8D%9A%E5%AE%A2/</url>
      <content type="html"><![CDATA[<p>ImportNewæ³¨ï¼šåŸæ–‡ä¸­è¿˜æ²¡æœ‰100ä¸ªã€‚ä½œè€…å¸Œæœ›å¤§å®¶ä¸€èµ·æ¥æ¨èé«˜è´¨é‡çš„Javaå¼€å‘åšå®¢ï¼Œç„¶åä¸æ®µè¡¥å……åˆ°è¿™ä¸ªåˆ—è¡¨ã€‚æ¬¢è¿ä½ ä¹Ÿå‚ä¸æ¨èä¼˜è´¨çš„Javaå¼€å‘åšå®¢ã€‚ï¼ˆå£°æ˜ä¸€ä¸‹ï¼šæˆ‘ä»¬çš„æ•°å­¦ä¸æ˜¯ä½“è‚²è€å¸ˆæ•™çš„ï¼:) ï¼‰</p>
<p>æœ¬æ–‡çš„ä¸»è¦ç›®çš„æ˜¯æ”¶é›†å…¨çƒèŒƒå›´å†…100ä¸ªé«˜è´¨é‡Javaå¼€å‘è€…åšå®¢ã€‚å…¶ä¸­ä¼šæœ‰ä¸€äº›åšå®¢å¹¶ä¸æ˜¯ç”±çº¯ç²¹çš„Javaå¼€å‘è€…æ’°å†™çš„ï¼Œä½†æ˜¯Javaå¼€å‘è€…ä»¬èƒ½å¤Ÿä»ä¸­å‘ç°ä¸€äº›æœ‰ç”¨çš„æˆ–è€…æœ‰è¶£çš„ä¸œè¥¿ã€‚é˜…è¯»è¿™äº›åšå®¢å°†ä¼šéå¸¸æœ‰è¶£ï¼Œæœ‰æ—¶ä¼šç»™ä½ å¸¦æ¥ä¸€äº›æ–°é²œçš„æƒ³æ³•ã€‚</p>
<p>Googleçš„æ’åç®—æ³•ä¸­ï¼Œå¤§å‹ç½‘ç«™çš„æ’ä½ä¼šæ¯”è¾ƒé«˜ã€‚è¿™å¯¹ä¸€äº›å°å‹çš„é«˜è´¨é‡åšå®¢æ¥è¯´å¹¶ä¸å…¬å¹³ã€‚æœ‰äº›ç«™ç‚¹çš„æµé‡éå¸¸å¤§ï¼Œä½†æ˜¯è´¨é‡å¹¶ä¸é«˜ã€‚æˆ‘å¯¹é«˜è´¨é‡çš„å®šä¹‰æ˜¯ï¼š</p>
<ol>
<li>æ–‡ç« å…·æœ‰å¯è¯»æ€§å¹¶ä¸”æ˜¯åŸåˆ›çš„ã€‚</li>
<li>æ–‡ç« ä½œè€…å¯¹æŠ€æœ¯æœ¬èº«æœ‰ç€æµ“åšçš„å…´è¶£ã€‚</li>
<li>æ–‡ç« åœ¨ä¸ªäººç†è§£çš„åŸºç¡€ä¸Šæå‡ºä¸€äº›åˆ›é€ æ€§çš„æƒ³æ³•ã€‚</li>
<li>åšå®¢ä¸­æ²¡æœ‰å¤ªå¤šçš„å¹¿å‘Šã€‚</li>
<li>åšå®¢çš„æ›´æ–°é¢‘ç‡æ¯”è¾ƒé«˜ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œå¾ˆå¤šGoogleæ’åé å‰çš„åšå®¢å¹¶æ²¡æœ‰å‡ºç°åœ¨ä¸‹é¢çš„åˆ—è¡¨é‡Œã€‚å¦‚æœä½ çŸ¥é“ä¸€äº›å€¼å¾—æ¨èçš„åšå®¢ï¼Œè¯·ç•™è¨€å‘Šè¯‰æˆ‘ã€‚ç”±äºè¿™ä¸ªåˆ—è¡¨æ­£åœ¨å¿«é€Ÿå¢é•¿ï¼Œè¯·åªæ¨èé«˜è´¨é‡çš„åšå®¢ç«™ç‚¹ã€‚</p>
<div id="text-13"><br><div class="textwidget"><br><table style="height: 1033px; width: 763px;"><br><tbody><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">&nbsp;</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><strong>åç§°(ç«™ç‚¹åæˆ–äººå)</strong></span></td><br><td valign="top" width="101"><span style="font-size: 14px;"><strong>å›½å®¶</strong></span></td><br><td valign="top" width="261"><span style="font-size: 14px;"><strong>å¤‡æ³¨</strong></span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">1</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://www.adam-bien.com/roller/abien/" target="_blank" rel="noopener">Adam&nbsp;Bien</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">å¾·å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Java&nbsp;EEç›¸å…³</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">2</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://antoniogoncalves.org/" target="_blank" rel="noopener">Antonio&nbsp;Goncalves</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">æ³•å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Java&nbsp;EEç›¸å…³ï¼ˆã€ŠJava&nbsp;EE&nbsp;5ã€‹å’Œã€ŠJava&nbsp;EE&nbsp;7ã€‹çš„ä½œè€…ï¼‰</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">3</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://henrikwarne.com/" target="_blank" rel="noopener">Henrik&nbsp;Warne</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç‘å…¸</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">ç¼–ç¨‹è¿‡ç¨‹ä¸­çš„ä¸€äº›æ€è€ƒ</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">4</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://keaplogik.blogspot.com/" target="_blank" rel="noopener">Billy&nbsp;Yarosh</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Javaæ—¥å¸¸å¼€å‘ä¸­çš„å®ç”¨ä»£ç ç¤ºä¾‹</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">5</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://www.vogella.com/" target="_blank" rel="noopener">Lars&nbsp;Vogel</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">å¾·å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Javaã€Android&nbsp;å’Œ<span class="wp_keywordlink"><a href="http://res.importnew.com/eclipse" title="Eclipse ImportNewä¸»é¡µ" target="_blank" rel="noopener">Eclipse</a></span></span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">6</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://javax0.wordpress.com/" target="_blank" rel="noopener">Peter&nbsp;Verhas</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">åŒˆç‰™åˆ©</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">çº¯ç²¹çš„Java</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">7</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://martinfowler.com/" target="_blank" rel="noopener">Martin&nbsp;Fowler</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">é¢å‘å¯¹è±¡è®¾è®¡ä¸“å®¶å’Œå’¨è¯¢å¸ˆ</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">8</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://techblog.bozho.net/" target="_blank" rel="noopener">Bozhidar&nbsp;Bozhanov</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ä¿åŠ åˆ©äºš</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Java&nbsp;EEç›¸å…³</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">9</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://insightfullogic.com/blog/" target="_blank" rel="noopener">Richard&nbsp;Warburton</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">è‹±å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Java&nbsp;8&nbsp;Lambdas</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">10</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://invariantproperties.com/" target="_blank" rel="noopener">Bear&nbsp;Giles</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Java&nbsp;EEç›¸å…³</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">11</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://blog.mikiobraun.de/" target="_blank" rel="noopener">Marginally&nbsp;Interesting</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">å¾·å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">æœºå™¨å­¦ä¹ </span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">12</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://pragmaticintegrator.wordpress.com/" target="_blank" rel="noopener">Pascal&nbsp;Alma</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Java&nbsp;EEç›¸å…³</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">13</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://blog.drorhelper.com/" target="_blank" rel="noopener">Dror&nbsp;Helper</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">ä»£ç æµ‹è¯•å’Œä»£ç è´¨é‡</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">14</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://juristr.com/" target="_blank" rel="noopener">Juri&nbsp;Strumpflohner</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">æ„å¤§åˆ©</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">JavaScript</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">15</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="https://blogs.oracle.com/reza/" target="_blank" rel="noopener">Reza&nbsp;Rahman</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Java&nbsp;EE/Glassfish</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">16</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://www.bigfastblog.com/" target="_blank" rel="noopener">Phil&nbsp;Whelan</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">åŠ æ‹¿å¤§</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">WebæŠ€æœ¯</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">17</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://brettporter.wordpress.com/" target="_blank" rel="noopener">Brett&nbsp;Porter</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">æ¾³å¤§åˆ©äºš</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Apache&nbsp;Maven&nbsp;2çš„ä½œè€…</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">18</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://www.benmccann.com/blog/" target="_blank" rel="noopener">Ben&nbsp;McCann</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">ä¸€äº›å®ç”¨çš„æ“ä½œæŒ‡å—ï¼ˆConnectifierçš„è”åˆåˆ›å§‹äººï¼‰</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">19</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://www.javaposse.com/" target="_blank" rel="noopener">Java&nbsp;Posse</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Javaç›¸å…³çš„ä¸€äº›æœ‰ç”¨çš„é“¾æ¥</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">20</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://www.markhneedham.com/blog/" target="_blank" rel="noopener">Mark&nbsp;Needham</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">è‹±å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">æ•°æ®å¤„ç†</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">21</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://www.takipiblog.com/" target="_blank" rel="noopener">Iris&nbsp;Shoor</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ä»¥è‰²åˆ—</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">è°ƒè¯•æŠ€æœ¯ã€æ€§èƒ½ç­‰</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">22</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://blog.pengyifan.com/" target="_blank" rel="noopener">Yifan&nbsp;Peng</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Javaå¼€å‘ã€ç®—æ³•ä¸æ•°æ®ç»“æ„ç­‰ï¼ˆä¸€ä¸ªæœ¬ç§‘æ¯•ä¸šç”Ÿçš„åšå®¢ï¼‰</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">23</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://plumbr.eu/blog" target="_blank" rel="noopener">Nikita&nbsp;Salnikov&nbsp;Tarnovski</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">çˆ±æ²™å°¼äºš</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">å†…å­˜æ³„éœ²</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">24</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://marxsoftware.blogspot.com/" target="_blank" rel="noopener">Dustin&nbsp;Marx</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">ä¸€äº›é€šç”¨çš„å¼€å‘æŠ€æœ¯ä»¥åŠJavaã€&nbsp;JavaFXã€Groovyç­‰ç›¸å…³æŠ€æœ¯</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">25</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://blog.thesoftwarecraft.com/" target="_blank" rel="noopener">Bart&nbsp;Bakker</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">è·å…°</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">æ•æ·å¼€å‘</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">26</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://gunnarpeipman.com/" target="_blank" rel="noopener">Gunnar&nbsp;Peipman</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">éJavaï¼ˆC#ã€.Netç›¸å…³ï¼‰</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">27</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://jobtipsforgeeks.com/" target="_blank" rel="noopener">Dave&nbsp;Fecak</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">ç¨‹åºå‘˜éœ€è¦çŸ¥é“çš„å·¥ä½œæŠ€å·§</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">28</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://blog.jooq.org/" target="_blank" rel="noopener">JOOQ</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç‘å£«</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">SQL</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">29</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://www.petrikainulainen.net/" target="_blank" rel="noopener">Petri&nbsp;Kainulainen</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">èŠ¬å…°</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">WebæŠ€æœ¯</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">30</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://blog.informatech.cr/" target="_blank" rel="noopener">Informatech&nbsp;CR</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">å“¥æ–¯è¾¾é»åŠ </span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Javaã€Webã€Mobileå¼€å‘</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">31</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://blog.arungupta.me/" target="_blank" rel="noopener">Arun&nbsp;Gupta</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Java&nbsp;EE</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">32</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://mechanical-sympathy.blogspot.com/" target="_blank" rel="noopener">Mechanical&nbsp;Sympathy</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">è‹±å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">æ€§èƒ½ï¼ˆé”ã€åƒåœ¾å›æ”¶ã€ç¼–è¯‘ä¼˜åŒ–ç­‰ï¼‰</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">33</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://matteo.vaccari.name/blog/" target="_blank" rel="noopener">Extreme&nbsp;Enthusiasm</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">æ„å¤§åˆ©</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">æ•æ·å¼€å‘</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">34</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://steveblank.com/" target="_blank" rel="noopener">Steve&nbsp;Blank</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">The&nbsp;Startup&nbsp;Owner&rsquo;s&nbsp;Manualï¼ˆåˆ›ä¸šè€…æŒ‡å—ï¼‰çš„ä½œè€…</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">35</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://olivergierke.de/" target="_blank" rel="noopener">Oliver&nbsp;Gierke</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">å¾·å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">SpringSourceï¼ˆç°ä¸ºVMwareæ——ä¸‹éƒ¨é—¨ï¼Œæä¾›Javaä¼ä¸šåº”ç”¨å¼€å‘å¹³å°ï¼‰</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">36</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://blog.frankel.ch/" target="_blank" rel="noopener">Nicolas&nbsp;Fr&auml;nkel</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç‘å£«</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">Java&nbsp;EE</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">37</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://blog.bdoughan.com/" target="_blank" rel="noopener">Blaise&nbsp;Doughan</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">XMLå’ŒJSONç›¸å…³</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">38</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://vladmihalcea.wordpress.com/" target="_blank" rel="noopener">Vlad&nbsp;Mihalcea</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç½—é©¬å°¼äºš</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">è½¯ä»¶é›†æˆ</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">39</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://lckymn.com/about-kevin" target="_blank" rel="noopener">Kevin&nbsp;Lee</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">æ¾³å¤§åˆ©äºš</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">WebæŠ€æœ¯</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">40</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://java-performance.info/" target="_blank" rel="noopener">Mikhail&nbsp;Vorontsov</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">æ¾³å¤§åˆ©äºš</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">æ€§èƒ½ï¼ˆè¯­è¨€æœ¬èº«çš„æ€§èƒ½ç ”ç©¶ï¼‰</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">41</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://jenkov.com/" target="_blank" rel="noopener">Jakob&nbsp;Jenkov</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ä¸¹éº¦</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">JavaåŸºç¡€</span></td><br></tr><br><tr><br><td valign="top" width="32"><span style="font-size: 14px;">42</span></td><br><td valign="top" width="173"><span style="font-size: 14px;"><a href="http://www.programcreek.com/" target="_blank" rel="noopener">Program&nbsp;Creek</a></span></td><br><td valign="top" width="101"><span style="font-size: 14px;">ç¾å›½</span></td><br><td valign="top" width="261"><span style="font-size: 14px;">æ·±å…¥ç†è§£Java</span></td><br></tr><br></tbody><br></table><br><br>&nbsp;<br><br><span style="line-height: 1.5;">åŸæ–‡é“¾æ¥ï¼š&nbsp;</span><a href="http://www.programcreek.com/2012/11/top-100-java-developers-blogs/" target="_blank" rel="noopener">programcreek</a><span style="line-height: 1.5;">&nbsp;ç¿»è¯‘ï¼š&nbsp;</span><a href="http://www.importnew.com/" target="_blank" rel="noopener">ImportNew.com&nbsp;</a><span style="line-height: 1.5;">-&nbsp;</span><a href="http://www.importnew.com/author/xiaqianlin" target="_blank" rel="noopener">å¤åƒæ—</a><br><br></div><br></div>

<p>è¯‘æ–‡é“¾æ¥ï¼š&nbsp;<a href="http://www.importnew.com/7469.html" target="_blank" rel="noopener">http://www.importnew.com/7469.html</a><br>[&nbsp;<strong>è½¬è½½è¯·ä¿ç•™åŸæ–‡å‡ºå¤„ã€è¯‘è€…å’Œè¯‘æ–‡é“¾æ¥ã€‚</strong>]</p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> blog </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]å®ç°ç±»ä¼¼å¾®ä¿¡çš„å»¶è¿ŸåŠ è½½çš„Fragmentâ€”â€”LazyFragment]]></title>
      <url>/2015/02/27/Android-%E5%AE%9E%E7%8E%B0%E7%B1%BB%E4%BC%BC%E5%BE%AE%E4%BF%A1%E7%9A%84%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%E7%9A%84Fragment%E2%80%94%E2%80%94LazyFragment/</url>
      <content type="html"><![CDATA[<p>å‚è€ƒå¾®ä¿¡ï¼Œä½¿ç”¨ViewPageræ¥æ˜¾ç¤ºä¸åŒçš„tabï¼Œæ¯ä¸ªtabæ˜¯ä¸€ä¸ªFragmentï¼Œ</p>
<p>å‡è®¾æœ‰3ä¸ªtabï¼Œå¯¹åº”çš„fragmentæ˜¯FragmentAã€FragmentBã€FragmentC</p>
<p>éœ€è¦å®ç°çš„æ•ˆæœæ˜¯è¿›å…¥åï¼Œé»˜è®¤å…ˆåªåŠ è½½FragmentAï¼Œå…·ä½“æ»‘åŠ¨åˆ°äº†å“ªä¸ªFragmentï¼Œå†å»åŠ è½½è¯¥Fragmentçš„æ•°æ®ã€‚</p>
<p>å¯ä»¥å‚è€ƒå¦‚ä¸‹BaseLazyFragmentä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">  1</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">  2</span> <span style="color: #008000;"> <em> Author: wangjie<br></em></span><span style="color: #008080;">  3</span> <span style="color: #008000;">  Email: tiantian.china.2@gmail.com<br></span><span style="color: #008080;">  4</span> <span style="color: #008000;"> <em> Date: 1/23/15.<br></em></span><span style="color: #008080;">  5</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;">  6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> BaseLazyFragment <span style="color: #0000ff;">extends</span><span style="color: #000000;"> BaseFragment {<br></span><span style="color: #008080;">  7</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = BaseLazyFragment.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;">  8</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isPrepared;<br></span><span style="color: #008080;">  9</span><br><span style="color: #008080;"> 10</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 11</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onActivityCreated(Bundle savedInstanceState) {<br></span><span style="color: #008080;"> 12</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onActivityCreated(savedInstanceState);<br></span><span style="color: #008080;"> 13</span> <span style="color: #000000;">        initPrepare();<br></span><span style="color: #008080;"> 14</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 15</span><br><span style="color: #008080;"> 16</span><br><span style="color: #008080;"> 17</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 18</span> <span style="color: #008000;">     <em> ç¬¬ä¸€æ¬¡onResumeä¸­çš„è°ƒç”¨onUserVisibleé¿å…æ“ä½œä¸onFirstUserVisibleæ“ä½œé‡å¤<br></em></span><span style="color: #008080;"> 19</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isFirstResume = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 21</span><br><span style="color: #008080;"> 22</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 23</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onResume() {<br></span><span style="color: #008080;"> 24</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onResume();<br></span><span style="color: #008080;"> 25</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (isFirstResume) {<br></span><span style="color: #008080;"> 26</span>             isFirstResume = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 27</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 28</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 29</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (getUserVisibleHint()) {<br></span><span style="color: #008080;"> 30</span> <span style="color: #000000;">            onUserVisible();<br></span><span style="color: #008080;"> 31</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 32</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 33</span><br><span style="color: #008080;"> 34</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 35</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onPause() {<br></span><span style="color: #008080;"> 36</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onPause();<br></span><span style="color: #008080;"> 37</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (getUserVisibleHint()) {<br></span><span style="color: #008080;"> 38</span> <span style="color: #000000;">            onUserInvisible();<br></span><span style="color: #008080;"> 39</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 40</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 41</span><br><span style="color: #008080;"> 42</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isFirstVisible = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 43</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isFirstInvisible = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 44</span><br><span style="color: #008080;"> 45</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 46</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setUserVisibleHint(<span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isVisibleToUser) {<br></span><span style="color: #008080;"> 47</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.setUserVisibleHint(isVisibleToUser);<br></span><span style="color: #008080;"> 48</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (isVisibleToUser) {<br></span><span style="color: #008080;"> 49</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> (isFirstVisible) {<br></span><span style="color: #008080;"> 50</span>                 isFirstVisible = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 51</span> <span style="color: #000000;">                initPrepare();<br></span><span style="color: #008080;"> 52</span>             } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {<br></span><span style="color: #008080;"> 53</span> <span style="color: #000000;">                onUserVisible();<br></span><span style="color: #008080;"> 54</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 55</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {<br></span><span style="color: #008080;"> 56</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> (isFirstInvisible) {<br></span><span style="color: #008080;"> 57</span>                 isFirstInvisible = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 58</span> <span style="color: #000000;">                onFirstUserInvisible();<br></span><span style="color: #008080;"> 59</span>             } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {<br></span><span style="color: #008080;"> 60</span> <span style="color: #000000;">                onUserInvisible();<br></span><span style="color: #008080;"> 61</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 62</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 63</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 64</span><br><span style="color: #008080;"> 65</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">synchronized</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> initPrepare() {<br></span><span style="color: #008080;"> 66</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (isPrepared) {<br></span><span style="color: #008080;"> 67</span> <span style="color: #000000;">            onFirstUserVisible();<br></span><span style="color: #008080;"> 68</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {<br></span><span style="color: #008080;"> 69</span>             isPrepared = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 70</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 71</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 72</span><br><span style="color: #008080;"> 73</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 74</span> <span style="color: #008000;">     <em> ç¬¬ä¸€æ¬¡fragmentå¯è§ï¼ˆè¿›è¡Œåˆå§‹åŒ–å·¥ä½œï¼‰<br></em></span><span style="color: #008080;"> 75</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 76</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onFirstUserVisible() {<br></span><span style="color: #008080;"> 77</span><br><span style="color: #008080;"> 78</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 79</span><br><span style="color: #008080;"> 80</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 81</span> <span style="color: #008000;">     <em> fragmentå¯è§ï¼ˆåˆ‡æ¢å›æ¥æˆ–è€…onResumeï¼‰<br></em></span><span style="color: #008080;"> 82</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 83</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onUserVisible() {<br></span><span style="color: #008080;"> 84</span><br><span style="color: #008080;"> 85</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 86</span><br><span style="color: #008080;"> 87</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 88</span> <span style="color: #008000;">     <em> ç¬¬ä¸€æ¬¡fragmentä¸å¯è§ï¼ˆä¸å»ºè®®åœ¨æ­¤å¤„ç†äº‹ä»¶ï¼‰<br></em></span><span style="color: #008080;"> 89</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 90</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onFirstUserInvisible() {<br></span><span style="color: #008080;"> 91</span><br><span style="color: #008080;"> 92</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 93</span><br><span style="color: #008080;"> 94</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 95</span> <span style="color: #008000;">     <em> fragmentä¸å¯è§ï¼ˆåˆ‡æ¢æ‰æˆ–è€…onPauseï¼‰<br></em></span><span style="color: #008080;"> 96</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 97</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onUserInvisible() {<br></span><span style="color: #008080;"> 98</span><br><span style="color: #008080;"> 99</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">100</span><br><span style="color: #008080;">101</span> }</pre><br></div>

<p>å¦‚ä¸Šä»£ç ï¼Œä½¿ç”¨setUserVisibleHintæ–¹æ³•ä½œä¸ºå›è°ƒçš„ä¾æ®ï¼Œ</p>
<p>æš´éœ²å‡ºæ¥è®©å­ç±»ä½¿ç”¨çš„æ–°çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸ºï¼š</p>
<ul>
<li>onFirstUserVisible();</li>
</ul>
<p>ç¬¬ä¸€æ¬¡fragmentå¯è§ï¼ˆè¿›è¡Œåˆå§‹åŒ–å·¥ä½œï¼‰</p>
<ul>
<li>onUserVisible();&nbsp;</li>
</ul>
<p>fragmentå¯è§ï¼ˆåˆ‡æ¢å›æ¥æˆ–è€…onResumeï¼‰</p>
<ul>
<li>onFirstUserInvisible();</li>
</ul>
<p>ç¬¬ä¸€æ¬¡fragmentä¸å¯è§ï¼ˆä¸å»ºè®®åœ¨æ­¤å¤„ç†äº‹ä»¶ï¼‰</p>
<ul>
<li>onUserInvisible();</li>
</ul>
<p>fragmentä¸å¯è§ï¼ˆåˆ‡æ¢æ‰æˆ–è€…onPauseï¼‰</p>
<p>&nbsp;</p>
<p>å…·ä½“çš„æ•ˆæœæ˜¯ï¼š</p>
<p>1. é¦–å…ˆåŠ è½½ViewPagerï¼Œå›è°ƒFragmentAï¼ˆç¬¬ä¸€ä¸ªé»˜è®¤å‘ˆç°çš„Fragmentï¼‰çš„onFirstUserVisible()ï¼Œå¯ä»¥åœ¨è¿™é‡Œè¿›è¡ŒFragmentAçš„åˆå§‹åŒ–å·¥ä½œï¼Œå…¶ä»–Fragmentä¿æŒä¸å˜ã€‚</p>
<p>2. ç”¨æˆ·ä»FragmentAæ»‘åŠ¨åˆ°FragmentBï¼Œå›è°ƒFragmentAçš„onUserInvisible()ã€FragmentBçš„onFirstUserVisible()ï¼ˆå› ä¸ºç¬¬ä¸€æ¬¡åˆ‡æ¢åˆ°FragmentBï¼Œå¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œåˆå§‹åŒ–å·¥ä½œï¼‰ã€‚</p>
<p>3. ç”¨æˆ·ä»FragmentBæ»‘åŠ¨åˆ°FragmentCï¼Œå›è°ƒFragmentBçš„onUserInvisible()ã€FragmentCçš„onFirstUserVisible()ï¼ˆå› ä¸ºç¬¬ä¸€æ¬¡åˆ‡æ¢åˆ°FragmentCï¼Œå¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œåˆå§‹åŒ–å·¥ä½œï¼‰ã€‚</p>
<p>4. ç”¨æˆ·ä»FragmentCæ»‘åŠ¨åˆ°FragmentBï¼Œå›è°ƒFragmentCçš„onUserInvisible()ã€FragmentBçš„onUserVisible()ï¼ˆå› ä¸ºFragmentBä¹‹å‰å·²ç»è¢«åŠ è½½è¿‡ï¼‰ã€‚</p>
<p>5. å› ä¸ºåˆ°æ­¤ä¸ºæ­¢ï¼Œsuoyouçš„Fragmentéƒ½å·²ç»è¢«åŠ è½½è¿‡äº†ï¼Œæ‰€ä»¥ä»¥åè¿™3ä¸ªFragmentäº’ç›¸ä»»æ„åˆ‡æ¢ï¼Œåªä¼šå›è°ƒåŸæ¥Fragmentçš„onUserInvisible()å’Œåˆ‡æ¢åçš„Fragmentçš„onUserVisible()ã€‚</p>
<p>6. ç”¨æˆ·å¤„äºFragmentBï¼Œå…³é—­æ‰‹æœºå±å¹•ï¼Œå›è°ƒFragmentBçš„onUserInvisible()ã€‚</p>
<p>7.&nbsp;ç”¨æˆ·å¤„äºFragmentBï¼Œæ‰‹æœºå±å¹•å¤„å…³é—­çŠ¶æ€ï¼Œç„¶åå¼€å¯æ‰‹æœºå±å¹•è§£é”ï¼Œåªå›è°ƒFragmentBçš„onUserVisible()ã€‚</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> LazyFragment </tag>
            
            <tag> lazy </tag>
            
            <tag> Fragment </tag>
            
            <tag> wechat </tag>
            
            <tag> å¾®ä¿¡ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[androidå¤šåˆ†è¾¨ç‡å¤šå±å¹•å¯†åº¦ä¸‹UIé€‚é…æ–¹æ¡ˆ]]></title>
      <url>/2015/02/02/android%E5%A4%9A%E5%88%86%E8%BE%A8%E7%8E%87%E5%A4%9A%E5%B1%8F%E5%B9%95%E5%AF%86%E5%BA%A6%E4%B8%8BUI%E9%80%82%E9%85%8D%E6%96%B9%E6%A1%88/</url>
      <content type="html"><![CDATA[<p><strong>æ–‡ç« è½¬è½½è‡ª<a href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2013/0627/1393.html" target="_blank" rel="noopener">http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2013/0627/1393.html</a></strong></p>
<p><strong>æ‘˜è¦</strong>&nbsp;å‰è¨€ Android è®¾è®¡ä¹‹åˆå°±è€ƒè™‘åˆ°äº† UI åœ¨å¤šå¹³å°çš„é€‚é…ï¼Œå®ƒæœ¬èº«æä¾›äº†ä¸€å¥—å®Œå–„çš„é€‚é…æœºåˆ¶ï¼Œéšç€ç‰ˆæœ¬çš„å‘å±•é€‚é…ä¹Ÿè¶Šæ¥è¶Šç²¾ç¡®ï¼Œ UI é€‚é…ä¸»è¦å—å¹³å°ä¸¤ä¸ªå› ç´ çš„å½±å“ï¼šå±å¹•å°ºå¯¸ï¼ˆå±å¹•çš„åƒç´ å®½åº¦åŠåƒç´ é«˜åº¦ï¼‰å’Œå±å¹•å¯†åº¦ï¼Œé’ˆå¯¹ä¸åŒçš„åº”ç”¨åœºæ™¯é‡‡ç”¨çš„é€‚é…æ–¹æ¡ˆä¹Ÿä¸ä¸€æ ·ï¼Œ</p>
<div class="first"><br><br># å‰è¨€<br><br>Androidè®¾è®¡ä¹‹åˆå°±è€ƒè™‘åˆ°äº†UIåœ¨å¤šå¹³å°çš„é€‚é…ï¼Œå®ƒæœ¬èº«æä¾›äº†ä¸€å¥—å®Œå–„çš„é€‚é…æœºåˆ¶ï¼Œéšç€ç‰ˆæœ¬çš„å‘å±•é€‚é…ä¹Ÿè¶Šæ¥è¶Šç²¾ç¡®ï¼ŒUIé€‚é…ä¸»è¦å—å¹³å°ä¸¤ä¸ªå› ç´ çš„å½±å“ï¼šå±å¹•å°ºå¯¸ï¼ˆå±å¹•çš„åƒç´ å®½åº¦åŠåƒç´ é«˜åº¦ï¼‰å’Œå±å¹•å¯†åº¦ï¼Œé’ˆå¯¹ä¸åŒçš„åº”ç”¨åœºæ™¯é‡‡ç”¨çš„é€‚é…æ–¹æ¡ˆä¹Ÿä¸ä¸€æ ·ï¼Œæ­¤æ–‡æ¡£ä»…é’ˆå¯¹Android4.0åŠä»¥ä¸‹ç‰ˆæœ¬<br><br>&nbsp;<br><br><strong>ç›¸å…³æ¦‚å¿µ</strong><br><br><strong>åˆ†è¾¨ç‡ï¼š</strong>æ•´ä¸ªå±å¹•çš„åƒç´ æ•°ç›®ï¼Œä¸ºäº†è¡¨ç¤ºæ–¹ä¾¿ä¸€èˆ¬ç”¨å±å¹•çš„åƒç´ å®½åº¦ï¼ˆæ°´å¹³åƒç´ æ•°ç›®ï¼‰ä¹˜ä»¥åƒç´ é«˜åº¦è¡¨ç¤ºï¼Œå½¢å¦‚1280x720ï¼Œåä¹‹åˆ†è¾¨ç‡ä¸º1280x720çš„å±å¹•ï¼Œåƒç´ å®½åº¦ä¸ä¸€å®šä¸º1280<br><br><strong>å±å¹•å¯†åº¦ï¼š</strong>è¡¨ç¤ºå•ä½é¢ç§¯å†…çš„åƒç´ ä¸ªæ•°ï¼Œé€šå¸¸ç”¨dpiä¸ºå•ä½ï¼Œå³æ¯è‹±å¯¸å¤šå°‘ä¸ªåƒç´ ç‚¹<br><br><strong>px**</strong>ï¼š<strong>é•¿åº¦å•ä½ï¼Œä»¥å…·ä½“åƒç´ ä¸ºå•ä½

</strong>dp<strong>**ï¼š</strong>é•¿åº¦å•ä½ï¼Œä¸å…·ä½“å±å¹•å¯†åº¦æ— å…³ï¼Œæ˜¾ç¤ºçš„æ—¶å€™æ ¹æ®å…·ä½“å¹³å°å±å¹•å¯†åº¦çš„ä¸åŒæœ€ç»ˆè½¬æ¢ä¸ºç›¸åº”çš„åƒç´ é•¿åº¦ï¼Œå…·ä½“è½¬æ¢è§„åˆ™æ˜¯: 1dp =&nbsp;ï¼ˆç›®æ ‡å±å¹•å¯†åº¦/æ ‡å‡†å¯†åº¦ï¼‰<em>px,æ ‡å‡†å¯†åº¦ä¸º160dpiï¼Œä¾‹å¦‚ï¼Œ1dpé•¿åº¦åœ¨å¯†åº¦ä¸º160dpiçš„å¹³å°è¡¨ç¤ºä¸€ä¸ªåƒç´ çš„é•¿åº¦ï¼Œè€Œåœ¨240dpiçš„å¹³å°åˆ™è¡¨ç¤º1.5ä¸ªåƒç´ çš„é•¿åº¦<br><br><strong>å±å¹•å°ºå¯¸ï¼š</strong>å±å¹•çš„å¤§å°ï¼Œé€šå¸¸ç”¨å±å¹•å¯¹è§’çº¿çš„é•¿åº¦è¡¨ç¤º<br><br># Androidç•Œé¢é€‚é…æœºåˆ¶<br><br>UIç•Œé¢åœ¨ä¸åŒå¹³å°çš„é€‚é…å—å±å¹•å°ºå¯¸å’Œå±å¹•å¯†åº¦å½±å“ï¼ŒAndroidé€‚é…æœºåˆ¶å°±æ˜¯åœ¨èµ„æºåé¢æ·»åŠ å¯¹è¿™ä¸¤ç§å› ç´ çš„é™å®šï¼Œé€šè¿‡ä¸åŒçš„é™å®šåŒºåˆ†ä¸åŒçš„å¹³å°èµ„æºï¼ŒAndroidåœ¨ä½¿ç”¨èµ„æºçš„æ—¶å€™ä¼šä¼˜å…ˆé€‰æ‹©æ»¡è¶³æœ¬å¹³å°é™å®šçš„èµ„æºï¼Œå†æ‰¾æœ€æ¥è¿‘æ¡ä»¶çš„ï¼Œå†æ‰¾é»˜è®¤ï¼ˆå³ä¸åŠ é™å®šï¼‰ï¼Œé€šè¿‡é€‰æ‹©é€‚åˆå½“å‰å¹³å°çš„èµ„æºæ¥å®Œæˆä¸åŒå¹³å°çš„é€‚é…ã€‚<br><br>&nbsp;<br><br>å±å¹•å°ºå¯¸åˆ†ä¸ºï¼šsmall,normal,large,xlargeåˆ†åˆ«è¡¨ç¤ºå°ï¼Œä¸­ï¼Œå¤§ï¼Œè¶…å¤§å±<br><br>å±å¹•å¯†åº¦åˆ†ä¸ºï¼šldpi,mdpi,hdpi,xhdpiï¼Œå®ƒä»¬çš„æ ‡å‡†å€¼åˆ†åˆ«æ˜¯ï¼š120dpiï¼Œ160dpiï¼Œ240dpiï¼Œ320dpi<br><br>ä»¥ä¸Šåˆ’åˆ†å‡è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªèŒƒå›´ï¼š<br><br><img src="http://www.jcodecraeer.com/uploads/20130627/13722624421110.jpg" alt="" title="image001.jpg"><br><br>åœ¨èµ„æºç›®å½•åé¢åŠ ä¸Šä¸Šé¢çš„é™å®šå°±èƒ½ä¸ºèµ„æºæŒ‡å®šç‰¹å®šçš„é€‚ç”¨å¹³å°ï¼Œå¦‚ä¸‹æ‰€ç¤º<br><br><img src="http://www.jcodecraeer.com/uploads/20130627/13722624942474.jpg" alt="" title="image002.jpg"><br><br>è¡¨ç¤ºå¤§å±ï¼Œä¸­å¯†åº¦å¸ƒå±€ä¼šé€‰æ‹©ä¸Šé¢é‚£ä¸ªmain.xmlï¼Œè¶…å¤§å±ï¼Œä¸­å¯†åº¦ä¼šé€‰æ‹©ä¸‹é¢é‚£ä¸ªmain.xml<br><br>&nbsp;<br><br>åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­å±å¹•å°ºå¯¸ä¸å¤Ÿç›´è§‚ï¼Œandroidå°†å…¶è½¬æ¢ä¸ºåˆ†è¾¨ç‡è¡¨ç¤ºï¼Œæ ¹æ®å±å¹•å…·ä½“åˆ†è¾¨ç‡å¯é€‰æ‹©ç›¸åº”çš„é™å®šç¬¦<br><br><img src="http://www.jcodecraeer.com/uploads/20130627/13722625497179.jpg" alt="" title="image003.jpg"><br><br>å°ç»“ï¼šé€šè¿‡åŠ ä¸Šä¸Šè¿°é™å®šå¯ä»¥å®ç°ä¸€ä¸ªapké€‚é…å‡ ç§ä¸»æµçš„å±å¹•å°ºå¯¸å’Œå±å¹•å¯†åº¦ï¼Œè¿™ç§é™å®šæ–¹å¼æ¯”è¾ƒé€‚ç”¨äºå¯¹å¤–å‘å¸ƒåº”ç”¨ï¼Œä¸çŸ¥é“ç»ˆç«¯å…·ä½“å‚æ•°çš„æƒ…å†µï¼Œä½†æ˜¯ä¸èƒ½åšåˆ°ç²¾ç¡®é€‚é…ï¼Œå¯¹äºå±å¹•å°ºå¯¸å’Œå¯†åº¦ç›¸å·®ä¸å¤§çš„ä¸¤ç§å¹³å°ä¸èƒ½å¾ˆå¥½çš„åŒºåˆ†ã€‚<br><br>&nbsp;<br><br>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œè‡ªAndroid3.2å¼€å§‹ï¼Œå¼•å…¥äº†ç²¾ç¡®é€‚é…ï¼Œç†è®ºä¸Šå¯ä»¥é€‚é…ä»»æ„åƒç´ å®½åº¦ï¼Œé«˜åº¦ï¼Œå±å¹•å¯†åº¦çš„å¹³å°ï¼Œéœ€ç”¨ä»¥ä¸‹æ–¹å¼æ·»åŠ é™å®šç¬¦<br><br><img src="http://www.jcodecraeer.com/uploads/20130627/13722625806649.jpg" alt="" title="image004.jpg"><br><br>å…¶ä¸­w1280dpè¡¨ç¤ºå±å¹•å®½åº¦ä¸º1280dpï¼Œh752dpè¡¨ç¤ºå±å¹•é«˜åº¦ä¸º752dpï¼Œ160dpiè¡¨ç¤ºå±å¹•å¯†åº¦ï¼Œå…¶ä¸­å±å¹•å®½ï¼Œé«˜å¿…é¡»ä»¥dpä¸ºå•ä½ï¼Œåœ¨çŸ¥é“å±å¹•åƒç´ å®½é«˜åº¦çš„æƒ…å†µä¸‹å¯ä»¥é€šè¿‡å…¬å¼ï¼š1dp =&nbsp;ï¼ˆç›®æ ‡å±å¹•å¯†åº¦/æ ‡å‡†å¯†åº¦ï¼‰</em>px&nbsp;è½¬æ¢æˆdpå•ä½ã€‚<br><br>ä¾‹å¦‚ï¼šæŸå¹³å°å±å¹•å®½ï¼Œé«˜åˆ†åˆ«ä¸º1920pxï¼Œ720pxï¼Œå±å¹•å¯†åº¦ä¸º240dpi<br><br>é€‚é…è¯¥å¹³å°çš„é™å®šä¸ºï¼š<br><br><img src="http://www.jcodecraeer.com/uploads/20130627/13722626152563.jpg" alt="" title="image005.jpg"><br><br>æˆ–è€…<br><br><img src="http://www.jcodecraeer.com/uploads/20130627/13722626311624.jpg" alt="" title="image006.jpg"><br><br>æ ¹æ®å…¬å¼1dp=ï¼ˆ240/160ï¼‰px=1.5px,å®½åº¦ï¼Œé«˜åº¦è½¬ä¸ºdpå•ä½åˆ†åˆ«æ˜¯1280dpå’Œ480dp.<br><br>&nbsp;<br><br><strong>Androidè‡ªé€‚åº”ä¸åŒåˆ†è¾¨ç‡æˆ–ä¸åŒå±å¹•å¤§å°çš„layoutå¸ƒå±€(æ¨ªå±|ç«–å±</strong>)<br><br>ä¸€ï¼šä¸åŒçš„layout<br><br>Androidæ‰‹æœºå±å¹•å¤§å°ä¸ä¸€ï¼Œæœ‰480x320, 640x360, 800x480.æ€æ ·æ‰èƒ½è®©Appè‡ªåŠ¨é€‚åº”ä¸åŒçš„å±å¹•å‘¢ï¼Ÿ<br>å…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨resç›®å½•ä¸‹åˆ›å»ºä¸åŒçš„layoutæ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚layout-640x360,layout-800x480,æ‰€æœ‰çš„layoutæ–‡ä»¶åœ¨ç¼–è¯‘ä¹‹åéƒ½ä¼šå†™å…¥R.javaé‡Œï¼Œè€Œç³»ç»Ÿä¼šæ ¹æ®å±å¹•çš„å¤§å°è‡ªå·±é€‰æ‹©åˆé€‚çš„layoutè¿›è¡Œä½¿ç”¨ã€‚<br><br>äºŒï¼šhdpiã€mdpiã€ldpi<br><br>åœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œåªæœ‰ä¸€ä¸ªdrawableï¼Œè€Œ2.1ç‰ˆæœ¬ä¸­æœ‰drawable-mdpiã€drawable-ldpiã€drawable-hdpiä¸‰ä¸ªï¼Œè¿™ä¸‰ä¸ªä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒå¤šåˆ†è¾¨ç‡ã€‚<br><br>drawable- hdpiã€drawable- mdpiã€drawable-ldpiçš„åŒºåˆ«ï¼š<br><br>(1)drawable-hdpié‡Œé¢å­˜æ”¾é«˜åˆ†è¾¨ç‡çš„å›¾ç‰‡,å¦‚WVGA (480x800),FWVGA (480x854)<br><br>(2)drawable-mdpié‡Œé¢å­˜æ”¾ä¸­ç­‰åˆ†è¾¨ç‡çš„å›¾ç‰‡,å¦‚HVGA (320x480)<br><br>(3)drawable-ldpié‡Œé¢å­˜æ”¾ä½åˆ†è¾¨ç‡çš„å›¾ç‰‡,å¦‚QVGA (240x320)<br><br>ã€€ã€€ç³»ç»Ÿä¼šæ ¹æ®æœºå™¨çš„åˆ†è¾¨ç‡æ¥åˆ†åˆ«åˆ°è¿™å‡ ä¸ªæ–‡ä»¶å¤¹é‡Œé¢å»æ‰¾å¯¹åº”çš„å›¾ç‰‡ã€‚<br><br>æ›´æ­£ï¼šåº”è¯¥æ˜¯å¯¹åº”ä¸åŒdensity çš„å›¾ç‰‡<br><br>ã€€ã€€åœ¨å¼€å‘ç¨‹åºæ—¶ä¸ºäº†å…¼å®¹ä¸åŒå¹³å°ä¸åŒå±å¹•ï¼Œå»ºè®®å„è‡ªæ–‡ä»¶å¤¹æ ¹æ®éœ€æ±‚å‡å­˜æ”¾ä¸åŒç‰ˆæœ¬å›¾ç‰‡ã€‚<br><br>[i]å¤‡æ³¨ï¼šä¸‰è€…çš„è§£æåº¦ä¸ä¸€æ ·ï¼Œå°±åƒä½ æŠŠç”µè„‘çš„åˆ†è¾¨ç‡è°ƒä½ï¼Œå›¾ç‰‡ä¼šå˜å¤§ä¸€æ ·ï¼Œåä¹‹åˆ†è¾¨ç‡é«˜ï¼Œå›¾ç‰‡ç¼©å°ã€‚ [/i]&nbsp;<br>å±å¹•æ–¹å‘ï¼š<br><br>æ¨ªå±ç«–å±è‡ªåŠ¨åˆ‡æ¢ï¼š<br><br>å¯ä»¥åœ¨resç›®å½•ä¸‹å»ºç«‹layout-port-800x600å’Œlayout-landä¸¤ä¸ªç›®å½•ï¼Œé‡Œé¢åˆ†åˆ«æ”¾ç½®ç«–å±å’Œæ¨ªå±ä¸¤ç§å¸ƒå±€æ–‡ä»¶ï¼Œè¿™æ ·åœ¨æ‰‹æœºå±å¹•æ–¹å‘å˜åŒ–çš„æ—¶å€™ç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨ç›¸åº”çš„å¸ƒå±€æ–‡ä»¶ï¼Œé¿å…ä¸€ç§å¸ƒå±€æ–‡ä»¶æ— æ³•æ»¡è¶³ä¸¤ç§å±å¹•æ˜¾ç¤ºçš„é—®é¢˜ã€‚<br><br>ä¸åŒåˆ†è¾¨ç‡æ¨ªå±ç«–å±è‡ªåŠ¨åˆ‡æ¢ï¼š<br><br>ä»¥800x600ä¸ºä¾‹<br>å¯ä»¥åœ¨resç›®å½•ä¸‹å»ºç«‹layout-port-800x600å’Œlayout-land-800x600ä¸¤ä¸ªç›®å½•<br><br>ä¸åˆ‡æ¢ï¼š<br><br>ä»¥ä¸‹æ­¥éª¤æ˜¯ç½‘ä¸Šæµä¼ çš„ï¼Œä¸è¿‡æˆ‘è‡ªå·±ä¹‹å‰æ˜¯é€šè¿‡å›¾å½¢åŒ–ç•Œé¢å®ç°è¿™ä¸ªé…ç½®ï¼Œç®—æ˜¯æ®Šé€”åŒå½’ï¼Œæœ‰ç©ºæˆ‘ä¼šæŠŠå›¾ç‰‡è´´ä¸Šæ¥ã€‚<br><br>è¿˜è¦è¯´æ˜ä¸€ç‚¹ï¼šæ¯ä¸ªactivityéƒ½æœ‰è¿™ä¸ªå±æ€§screenOrientationï¼Œæ¯ä¸ªactivityéƒ½éœ€è¦è®¾ç½®ï¼Œå¯ä»¥è®¾ç½®ä¸ºç«–å±ï¼ˆportraitï¼‰ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºæ— é‡åŠ›æ„Ÿåº”ï¼ˆnosensorï¼‰ã€‚<br><br>è¦è®©ç¨‹åºç•Œé¢ä¿æŒä¸€ä¸ªæ–¹å‘ï¼Œä¸éšæ‰‹æœºæ–¹å‘è½¬åŠ¨è€Œå˜åŒ–çš„å¤„ç†åŠæ³•ï¼š<br><br>åœ¨AndroidManifest.xmlé‡Œé¢é…ç½®ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚åŠ å…¥è¿™ä¸€è¡Œandroid:screenOrientation=â€landscapeâ€ã€‚<br>ä¾‹å¦‚ï¼ˆlandscapeæ˜¯æ¨ªå‘ï¼Œportraitæ˜¯çºµå‘ï¼‰ï¼š<br><br>Javaä»£ç :<br><br>&lt;?xml version=â€1.0â€ encoding=â€utf-8â€?&gt;<br>&lt;manifestxmlns:android=â€<a href="http://schemas.android.com/apk/res/android&quot;&amp;nbsp" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android&quot;&amp;nbsp</a>;<br>package=â€com.ray.linkitâ€&nbsp;<br>android:versionCode=â€1â€&nbsp;<br>android:versionName=â€1.0â€&gt;&nbsp;<br>&lt;application android:icon=â€@drawable/iconâ€android:label=â€@string/app_nameâ€&gt;&nbsp;<br>&lt;activity android:name=â€.Mainâ€&nbsp;<br>android:label=â€@string/app_nameâ€&nbsp;<br>android:screenOrientation=â€portraitâ€&gt;&nbsp;<br>&lt;intent-filter&gt;&nbsp;<br>&lt;action android:name=â€android.intent.action.MAINâ€ /&gt;&nbsp;<br>&lt;category android:name=â€android.intent.category.LAUNCHERâ€ /&gt;&nbsp;<br>&lt;/intent-filter&gt;&nbsp;<br>&lt;/activity&gt;&nbsp;<br>&lt;activity android:name=â€.GamePlayâ€&nbsp;<br>android:screenOrientation=â€portraitâ€&gt;&lt;/activity&gt;&nbsp;<br>&lt;activity android:name=â€.OptionViewâ€&nbsp;<br>android:screenOrientation=â€portraitâ€&gt;&lt;/activity&gt;&nbsp;<br>&lt;/application&gt;&nbsp;<br>&lt;uses-sdk android:minSdkVersion=â€3â€ /&gt;&nbsp;<br>&lt;/manifest&gt;<br><br>å¦å¤–ï¼Œandroidä¸­æ¯æ¬¡å±å¹•çš„åˆ‡æ¢åŠ¨ä¼šé‡å¯Activityï¼Œæ‰€ä»¥åº”è¯¥åœ¨Activityé”€æ¯å‰ä¿å­˜å½“å‰æ´»åŠ¨çš„çŠ¶æ€ï¼Œåœ¨Activityå†æ¬¡Createçš„æ—¶å€™è½½å…¥é…ç½®ï¼Œé‚£æ ·ï¼Œè¿›è¡Œä¸­çš„æ¸¸æˆå°±ä¸ä¼šè‡ªåŠ¨é‡å¯äº†ï¼<br><br>æœ‰çš„ç¨‹åºé€‚åˆä»ç«–å±åˆ‡æ¢åˆ°æ¨ªå±ï¼Œæˆ–è€…åè¿‡æ¥ï¼Œè¿™ä¸ªæ—¶å€™æ€ä¹ˆåŠå‘¢ï¼Ÿå¯ä»¥åœ¨é…ç½®Activityçš„åœ°æ–¹è¿›è¡Œå¦‚ä¸‹çš„é…ç½®android:screenOrientation=â€portraitâ€ã€‚è¿™æ ·å°±å¯ä»¥ä¿è¯æ˜¯ç«–å±æ€»æ˜¯ç«–å±äº†ï¼Œæˆ–è€…landscapeæ¨ªå‘ã€‚<br><br>è€Œæœ‰çš„ç¨‹åºæ˜¯é€‚åˆæ¨ªç«–å±åˆ‡æ¢çš„ã€‚å¦‚ä½•å¤„ç†å‘¢ï¼Ÿé¦–å…ˆè¦åœ¨é…ç½®Activityçš„æ—¶å€™è¿›è¡Œå¦‚ä¸‹çš„é…ç½®ï¼šandroid:configChanges=â€keyboardHidden|orientationâ€ï¼Œå¦å¤–éœ€è¦é‡å†™Activityçš„ onConfigurationChangedæ–¹æ³•ã€‚å®ç°æ–¹å¼å¦‚ä¸‹ï¼Œä¸éœ€è¦åšå¤ªå¤šçš„å†…å®¹ï¼š<br><br>@Override&nbsp;<br>public void onConfigurationChanged(Configuration newConfig) {&nbsp;<br>super.onConfigurationChanged(newConfig);&nbsp;<br>if (this.getResources().getConfiguration().orientation ==Configuration.ORIENTATION_LANDSCAPE) {&nbsp;<br>// land do nothing is ok&nbsp;<br>} else if (this.getResources().getConfiguration().orientation ==Configuration.ORIENTATION_PORTRAIT) {&nbsp;<br>// port do nothing is ok&nbsp;<br>}&nbsp;<br>}<br><br>å†™ä¸€ä¸ªæ”¯æŒå¤šåˆ†è¾¨çš„ç¨‹åºï¼ŒåŸºäº1.6å¼€å‘çš„ï¼Œå»ºç«‹äº†ä¸‰ä¸ªèµ„æºæ–‡ä»¶å¤¹drawable-hdpi drawable-mdpidrawable-ldpiï¼Œé‡Œé¢åˆ†åˆ«å­˜æ”¾72<em>72 48</em>48 36<em>36çš„iconå›¾æ ‡æ–‡ä»¶ã€‚å½“æˆ‘åœ¨G1ï¼ˆ1.5çš„ç³»ç»Ÿï¼‰ä¸Šæµ‹è¯•æ—¶ï¼Œå›¾æ ‡åº”è¯¥è‡ªé€‚åº”ä¸º48</em>48æ‰å¯¹å•Šï¼Œä½†å®é™…æ˜¾ç¤ºçš„æ˜¯36<em>36ã€‚æ€ä¹ˆæ‰èƒ½è®©å…¶è‡ªé€‚åº” 48</em>48çš„iconå›¾æ ‡å‘¢<br><br>è§£å†³åŠæ³• drawable-hdpi drawable-mdpi drawable-ldpiæ”¹æˆdrawable-480X320 drawable-800X480çš„å¤šåˆ†è¾¨æ”¯æŒçš„æ–‡ä»¶å¤¹<br><br>å¯¹äºAndroidæ¸¸æˆå¼€å‘æˆ‘ä»¬ä¸å¾—ä¸åƒiPhoneé‚£æ ·æ€è€ƒå…¼å®¹ Androidå¹³æ¿ç”µè„‘ï¼Œå¯¹äºè‹¹æœè¦è€ƒè™‘iPadã€iPhone 3GSå’ŒiPhone 4ç­‰å±å¹•ä¹‹é—´çš„å…¼å®¹æ€§ï¼Œå¯¹äºå‡ ä¹æ‰€æœ‰çš„åˆ†è¾¨ç‡æ€»ç»“äº†å¤§çº¦è¶…è¿‡20ä¸­ç²‰ç¬”é˜¿å¥³éƒçš„å¤§å°å’Œå¯¹åº”å…³ç³»ï¼Œå¯¹äºå¼€å‘Androidæ¸¸æˆè€Œè¨€å¯ä»¥è€ƒè™‘åˆ°æœªæ¥çš„3.0ä»¥åŠå¾ˆå¤šå¹³æ¿ç”µè„‘çš„éœ€è¦ã€‚<br><br>å¸¸è§„çš„æˆ‘ä»¬å¯èƒ½åªè€ƒè™‘QVGAï¼ŒHVGAï¼ŒWVGAï¼ŒFWVGAå’ŒDVGAï¼Œä½†æ˜¯æŠ›å»äº†æ‰‹æœºä¸è°ˆï¼Œå¯èƒ½å¹³æ¿ä½¿ç”¨ç±»ä¼¼WSVGAçš„1024&times;576ä»¥åŠWXGAçš„1280&times;768ç­‰ç­‰ã€‚<br>QVGA = 320 <em> 240;<br>WQVGA = 320 </em> 480;<br>WQVGA2 = 400 <em> 240;<br>WQVGA3 = 432 </em> 240;<br>HVGA = 480 <em> 320;<br>VGA = 640 </em> 480;<br>WVGA = 800 <em> 480;<br>WVGA2 = 768 </em> 480;<br>FWVGA = 854 <em> 480;<br>DVGA = 960 </em> 640;<br>PAL = 576 <em> 520;<br>NTSC = 486 </em> 440;<br>SVGA = 800 <em> 600;<br>WSVGA [â€¦]<br><br>è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰ä»£è¡¨æ€§çš„Androidè½¯ä»¶èµ„æºåŒ…ï¼Œdrawableé‡Œé¢å­˜æ”¾çš„æ˜¯åº”ç”¨çš„å›¾æ ‡æ–‡ä»¶ï¼Œlayoutå­˜æ”¾çš„æ˜¯å¸ƒå±€ï¼Œç®€å•è¯´å°±æ˜¯è¿™äº›å›¾æ ‡å¦‚ä½•æ‘†æ”¾ã€‚ä¸ºä»€ä¹ˆAndroidä¸Šéœ€è¦è¿™ä¹ˆå¤šèµ„æºåŒ…æ–‡ä»¶å’Œå¸ƒå±€æ–‡ä»¶æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥éœ€è¦è®¨è®ºçš„é—®é¢˜ã€‚<br><br>Androidè®¾å¤‡å±å¹•çš„å°ºå¯¸æ˜¯å„å¼å„æ ·çš„ï¼Œå¦‚å°ç±³æ˜¯4è‹±å¯¸çš„ï¼ŒXoomå¹³æ¿æ˜¯10è‹±å¯¸ï¼›åˆ†è¾¨ç‡ä¹Ÿåƒå¥‡ç™¾æ€ªï¼Œ800&times;480ï¼Œ960&times;540ç­‰ï¼›Androidç‰ˆæœ¬çš„ç¢ç‰‡åŒ–é—®é¢˜æ›´æ˜¯è¦ç»•äºå¿ƒï¼Œä¸è¿‡åœ¨è®¾è®¡åº”ç”¨æ—¶å¯ä»¥åˆ†ä¸ºä¸¤å¤§å—ï¼š3.0ä¹‹å‰çš„ç‰ˆæœ¬å’Œ3.0ä¹‹åçš„ç‰ˆæœ¬ã€‚è¿™ç§æƒ…å†µä¼šå¸¦æ¥ä»€ä¹ˆé—®é¢˜æˆ‘ä»¬ç”¨ä¸‰ä¸ªå‡è®¾æ¥è¯´æ˜ä¸€ä¸‹ã€‚<br><br>1. å‡è®¾ä½ çš„æ‰‹ä¸Šæœ‰ä¸¤ä¸ª4è‹±å¯¸çš„è®¾å¤‡ï¼Œè®¾å¤‡Açš„åˆ†è¾¨ç‡æ˜¯800&times;480ï¼Œè®¾å¤‡Bçš„åˆ†è¾¨ç‡æ˜¯1600&times;960ã€‚ä½ åœ¨è®¾å¤‡Aä¸Šè®¾è®¡äº†ä¸€ä¸ª64&times;64åƒç´ çš„å›¾æ ‡ï¼Œæ„Ÿè§‰å®ƒå¤§å°æ­£åˆé€‚ï¼Œä½†æ”¾åˆ°è®¾å¤‡Bä¸Šçš„æ—¶å€™ï¼Œè¿™ä¸ªå›¾æ ‡çœ‹ä¸Šå»å°±åªæœ‰ä¹‹å‰ä¸€åŠå¤§å°äº†ã€‚<br><br>2. å‡è®¾ä½ æ‰‹ä¸Šçš„ä¸¤ä¸ªè®¾å¤‡ï¼Œè®¾å¤‡Aæ˜¯4è‹±å¯¸ï¼Œè®¾å¤‡Bæ˜¯10è‹±å¯¸ã€‚åœ¨è®¾å¤‡Aä¸Šæ–¹æ”¾äº†ä¸€ä¸ªtabæ§ä»¶ï¼Œæœ‰ä¸‰ä¸ªé¡µç­¾ã€‚æ”¾åˆ°è®¾å¤‡Bä¸Šçœ‹æ—¶tabæ§ä»¶çš„ä¸‰ä¸ªé¡µç­¾è¢«æ‹‰å¾—å¾ˆé•¿ï¼Œæœ¬æ¥æ”¾6ä¸ªé¡µç­¾çš„ç©ºé—´åªæ”¾äº†ä¸‰ä¸ªé¡µç­¾ã€‚<br><br>3. å‡è®¾ä½ æ‰‹ä¸Šçš„ä¸¤ä¸ªè®¾å¤‡ï¼Œè®¾å¤‡Aè£…çš„æ˜¯Android2.3ï¼Œè®¾å¤‡Bè£…çš„æ˜¯Android4.0ï¼Œè€Œè®¾å¤‡Bæ²¡æœ‰menuå»ºï¼Œé£æ ¼ä¹Ÿä¸ä¸€æ ·ã€‚ä½ å‘ç°ä¸¤ä¸ªè®¾å¤‡ä¸Šç”¨åŒä¸€å¥—é£æ ¼çš„çš®è‚¤å¹¶ä¸åˆé€‚ã€‚<br><br>Googleæä¾›äº†ä¸€å¥—ä½“ç³»å»è§£å†³è¿™äº›é—®é¢˜ã€‚æˆ‘ä»¬å†å›åˆ°ä¸Šé¢çš„é‚£å¼ å›¾ï¼Œdrawableæ–‡ä»¶å¤¹æœ‰ldpiã€mdpiã€hdpiã€xhdpiå››ç§ã€‚dpiæŒ‡åƒç´ /è‹±å¯¸ï¼Œè€ŒldpiæŒ‡120ï¼ŒmdpiæŒ‡160ï¼ŒhdpiæŒ‡240ï¼ŒxhdpiæŒ‡320ã€‚å°ç±³æ‰‹æœºæ˜¯4è‹±å¯¸ã€854&times;480çš„åˆ†è¾¨ç‡ï¼Œé‚£ä¹ˆå°ç±³æ‰‹æœºçš„dpiå°±æ˜¯854çš„å¹³æ–¹åŠ 480çš„å¹³æ–¹å’Œå¼€2æ¬¡æ–¹åé™¤ä»¥4ï¼Œç»“æœå¤§çº¦æ˜¯245ã€‚å¦‚æœåº”ç”¨å®‰è£…åœ¨å°ç±³æ‰‹æœºä¸Šï¼Œé‚£ä¹ˆç³»ç»Ÿä¼šè°ƒç”¨å›¾ä¸­drawable-hdpié‡Œé¢çš„èµ„æºã€‚è¿™æ ·ï¼Œä½ åªè¦åš4å¥—èµ„æºåˆ†åˆ«æ”¾åœ¨drawable-ldpiã€drawable-mdpiã€drawable-hdpiä»¥åŠdrawable-xdpiä¸‹ï¼ˆå›¾æ ‡å¯ä»¥æŒ‰ç…§3ï¼š4ï¼š6ï¼š8çš„æ¯”ä¾‹åˆ¶ä½œå›¾ç‰‡èµ„æºï¼‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥è§£å†³ä¸Šé¢å‡è®¾1å½“ä¸­æåˆ°çš„é—®é¢˜ã€‚<br><br>å¯¹äºç›¸åŒdpiã€ä½†å°ºå¯¸ä¸ä¸€æ ·çš„è®¾å¤‡ï¼Œå¯ä»¥é€šè¿‡layoutæ–‡ä»¶æ§åˆ¶å„ç§èµ„æºçš„å¸ƒå±€ã€‚Googleå°†è®¾å¤‡åˆ†ä¸ºsmallï¼ˆ2ï½3è‹±å¯¸ï¼‰ã€normalï¼ˆ4è‹±å¯¸å·¦å³ï¼‰ã€largeï¼ˆ5ï½7è‹±å¯¸ï¼‰ã€xlargeï¼ˆ7è‹±å¯¸ä»¥ä¸Šï¼‰ã€‚åœ¨ä¸Šé¢çš„å‡è®¾2ç§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨layout-normalé‡Œé…ç½®3ä¸ªé¡µç­¾çš„tabæ ï¼Œåœ¨layout-xlargeé‡Œé…ç½®6ä¸ªé¡µç­¾çš„tabæ ã€‚å¦‚æœåº”ç”¨åœ¨æ‰€æœ‰è®¾å¤‡ä¸Šå¸ƒå±€éƒ½ä¸€æ ·ï¼Œé‚£ä¹ˆå°±ä¸ç”¨è€ƒè™‘é’ˆå¯¹ä¸åŒå°ºå¯¸çš„layoutã€‚ä»å›¾ä¸­é‚£äº›layout</em>æ–‡ä»¶å¤¹å¯ä»¥çœ‹å‡ºï¼Œè¯¥åº”ç”¨åœ¨hdpiåŠxhdpiä¸Šæ”¯æŒæ¨ªç«–å±ï¼Œè€Œä¸”æ¨ªç«–å±çš„å¸ƒå±€ä¸ä¸€è‡´ï¼Œä½†æ²¡æœ‰è€ƒè™‘ä¸åŒå°ºå¯¸çš„è®¾å¤‡ä½¿ç”¨ä¸åŒå¸ƒå±€çš„æƒ…å†µã€‚<br><br>Android3.0ä¹‹å‰çš„é£æ ¼ä¸Android3.0ï¼ˆåŒ…å«3.0ï¼‰ä¹‹åçš„é£æ ¼åŒºåˆ«å¾ˆå¤§ï¼Œå›¾ä¸­é‚£ä¸ªåº”ç”¨å°±ä½¿ç”¨äº†ä¸¤ç§é£æ ¼çš„èµ„æºåŠå¸ƒå±€ã€‚Android2.3çš„å°ç±³ä¼šä½¿ç”¨drawable-hdpiåŠlayout-hdpiå½“ä¸­çš„æ–‡ä»¶ï¼Œè€ŒAndroid4.0çš„å°ç±³å°±ä¼šä½¿ç”¨drawable-hdpi-v11åŠlayout-hdpi-v11é‡Œé¢çš„æ–‡ä»¶ã€‚<br><br>ä»Šå¤©å°±åˆ°æ­¤ä¸ºæ­¢äº†ï¼Œæœ‰ç©ºçš„æ—¶å€™å†è¯´è¯´9-Patchçš„ä½¿ç”¨ã€‚è¿™ç¯‡æ–‡ç« ä¹Ÿå°±åªèƒ½èµ·åˆ°æŠ›ç –å¼•ç‰çš„ä½œç”¨ï¼Œåœ¨å®é™…è®¾è®¡åº”ç”¨çš„æ—¶å€™è¿˜éœ€è¦å¤šå»å‚è€ƒå…¶ä»–æ–‡æ¡£èµ„æ–™ï¼Œç‰¹åˆ«æ˜¯Androidå¼€å‘çš„å®˜æ–¹æ–‡æ¡£ã€‚<br><br></div>

]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ui </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆä¸‰ï¼‰]]></title>
      <url>/2015/02/02/Android-%E4%BD%BF%E7%94%A8RecyclerView%E6%9B%BF%E4%BB%A3ListView%EF%BC%88%E4%B8%89%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>&nbsp;</p>
<p>è¿™æ¬¡æ¥ä½¿ç”¨RecyclerViewå®ç°PinnedListViewçš„æ•ˆæœï¼Œæ•ˆæœå¾ˆå¸¸è§ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201502/021602294536998.gif" alt=""></p>
<p>å¼€å‘çš„ä»£ç å»ºç«‹åœ¨ä¸Šä¸€ç¯‡ï¼ˆ<strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4242541.html" target="_blank" rel="noopener">[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆäºŒï¼‰</a>ï¼š<a href="http://www.cnblogs.com/tiantianbyconan/p/4242541.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4242541.html</a></strong>ï¼‰åŸºç¡€ä¹‹ä¸Šã€‚</p>
<p>ä¿®æ”¹å¸ƒå±€å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><br><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">              android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><br><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">              android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;"> 6</span> <span style="color: #ff0000;">              android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">android.support.v7.widget.Toolbar<br></span><span style="color: #008080;"> 9</span>             <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/recycler_view_pinned_toolbarâ€</span><br><span style="color: #008080;">10</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;">11</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">12</span> <span style="color: #ff0000;">            android:background</span><span style="color: #0000ff;">=â€?attr/colorPrimaryâ€</span><br><span style="color: #008080;">13</span>             <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">14</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">android.support.v4.widget.SwipeRefreshLayout<br></span><span style="color: #008080;">15</span>             <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/recycler_view_pinned_srlâ€</span><br><span style="color: #008080;">16</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">17</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;">18</span>             <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">19</span><br><span style="color: #008080;">20</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">com.wangjie.androidbucket.support.recyclerview.pinnedlayout.PinnedRecyclerViewLayout<br></span><span style="color: #008080;">21</span>                 <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/recycler_view_pinned_layoutâ€</span><br><span style="color: #008080;">22</span> <span style="color: #ff0000;">                android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"> android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">23</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">android.support.v7.widget.RecyclerView<br></span><span style="color: #008080;">24</span>                     <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/recycler_view_pinned_rvâ€</span><br><span style="color: #008080;">25</span> <span style="color: #ff0000;">                    android:scrollbars</span><span style="color: #0000ff;">=â€verticalâ€</span><br><span style="color: #008080;">26</span> <span style="color: #ff0000;">                    android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">27</span> <span style="color: #ff0000;">                    android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">28</span> <span style="color: #ff0000;">                    android:background</span><span style="color: #0000ff;">=â€#bbccaaâ€</span><br><span style="color: #008080;">29</span>                     <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">30</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Button<br></span><span style="color: #008080;">31</span>                     <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/recycler_view_pinned_add_btnâ€</span><br><span style="color: #008080;">32</span> <span style="color: #ff0000;">                    android:layout_width</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"> android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;">33</span> <span style="color: #ff0000;">                    android:layout_centerVertical</span><span style="color: #0000ff;">=â€trueâ€</span><br><span style="color: #008080;">34</span> <span style="color: #ff0000;">                    android:background</span><span style="color: #0000ff;">=â€#abcabcâ€</span><br><span style="color: #008080;">35</span> <span style="color: #ff0000;">                    android:text</span><span style="color: #0000ff;">=â€addâ€</span><br><span style="color: #008080;">36</span>                     <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">37</span><br><span style="color: #008080;">38</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">com.wangjie.androidbucket.support.recyclerview.pinnedlayout.PinnedRecyclerViewLayout</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">39</span><br><span style="color: #008080;">40</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">android.support.v4.widget.SwipeRefreshLayout</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">41</span><br><span style="color: #008080;">42</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>å¯ä»¥çœ‹åˆ°RecyclerViewæ˜¯è¢«ä¸€ä¸ª<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/pinnedlayout/PinnedRecyclerViewLayout.java" target="_blank" rel="noopener">PinnedRecyclerViewLayout</a>ï¼ˆ<a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/pinnedlayout/PinnedRecyclerViewLayout.java" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/pinnedlayout/PinnedRecyclerViewLayout.java</a>ï¼‰</strong>åŒ…å«åœ¨é‡Œé¢çš„ã€‚è¿™ä¸ªåœ¨é¡¹ç›®<strong><a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">AndroidBucket</a>ï¼ˆ<a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket</a>ï¼‰</strong>ä¸­ã€‚å…ˆçœ‹çœ‹ä»£ç ä¸­æ€ä¹ˆä½¿ç”¨å§ï¼Œå…·ä½“å®ç°å¾…ä¼šè¯´ã€‚</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> pinnedLayout.initRecyclerPinned(recyclerView, layoutManager, LayoutInflater.from(context).inflate(R.layout.recycler_view_item_float, <span style="color: #0000ff;">null</span><span style="color: #000000;">));<br></span><span style="color: #008080;">2</span> pinnedLayout.setOnRecyclerViewPinnedViewListener(<span style="color: #0000ff;">this</span>);</pre><br></div>

<p>å¦‚ä¸Šï¼Œä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼š</p>
<p>Line1ï¼šåˆå§‹åŒ–ç»‘å®šPinnedRecyclerViewLayoutå’ŒRecyclerViewï¼Œå¹¶è®¾ç½®éœ€è¦è¢«é¡¶ä¸Šå»çš„pinnedView</p>
<p>Line2ï¼šè®¾ç½®OnRecyclerViewPinnedViewListenerï¼Œä½œç”¨æ˜¯åœ¨é¡¶éƒ¨è¢«é¡¶ä¸Šå»æ›¿æ¢æ‰çš„æ—¶å€™ï¼Œä¼šå›è°ƒé‡æ–°æ¸²æŸ“æ•°æ®ï¼Œä¼ å…¥çš„OnRecyclerViewPinnedViewListeneræ˜¯thisï¼Œæ˜¾ç„¶ï¼Œæ­¤Activityå®ç°äº†è¿™ä¸ªæ¥å£ï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">//</span><span style="color: #008000;"> æ¸²æŸ“pinnedViewæ•°æ®</span><br><span style="color: #008080;"> 2</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 3</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onPinnedViewRender(PinnedRecyclerViewLayout pinnedRecyclerViewLayout, View pinnedView, <span style="color: #0000ff;">int</span><span style="color: #000000;"> position) {<br></span><span style="color: #008080;"> 4</span>         <span style="color: #0000ff;">switch</span><span style="color: #000000;"> (pinnedRecyclerViewLayout.getId()) {<br></span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.recycler_view_pinned_layout:<br></span><span style="color: #008080;"> 6</span>                 TextView nameTv =<span style="color: #000000;"> (TextView) pinnedView.findViewById(R.id.recycler_view_item_float_name_tv);<br></span><span style="color: #008080;"> 7</span> <span style="color: #000000;">                nameTv.setText(personList.get(position).getName());<br></span><span style="color: #008080;"> 8</span>                 TextView ageTv =<span style="color: #000000;"> (TextView) pinnedView.findViewById(R.id.recycler_view_item_float_age_tv);<br></span><span style="color: #008080;"> 9</span>                 ageTv.setText(personList.get(position).getAge() + â€œå²â€<span style="color: #000000;">);<br></span><span style="color: #008080;">10</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">12</span>     }</pre><br></div>

<p>ç„¶åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/pinnedlayout/PinnedRecyclerViewLayout.java" target="_blank" rel="noopener">PinnedRecyclerViewLayout</a></strong>æ˜¯æ€ä¹ˆå®ç°çš„ã€‚</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">  1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">  2</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;">  3</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;">  4</span> <span style="color: #008000;">  Date: 2/2/15.<br></span><span style="color: #008080;">  5</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;">  6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> PinnedRecyclerViewLayout <span style="color: #0000ff;">extends</span><span style="color: #000000;"> RelativeLayout {<br></span><span style="color: #008080;">  7</span><br><span style="color: #008080;">  8</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = PinnedRecyclerViewLayout.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;">  9</span><br><span style="color: #008080;"> 10</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> OnRecyclerViewPinnedViewListener {<br></span><span style="color: #008080;"> 11</span>         <span style="color: #0000ff;">void</span> onPinnedViewRender(PinnedRecyclerViewLayout pinnedRecyclerViewLayout, View pinnedView, <span style="color: #0000ff;">int</span><span style="color: #000000;"> position);<br></span><span style="color: #008080;"> 12</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 13</span><br><span style="color: #008080;"> 14</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> OnRecyclerViewPinnedViewListener onRecyclerViewPinnedViewListener;<br></span><span style="color: #008080;"> 15</span><br><span style="color: #008080;"> 16</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setOnRecyclerViewPinnedViewListener(OnRecyclerViewPinnedViewListener onRecyclerViewPinnedViewListener) {<br></span><span style="color: #008080;"> 17</span>         <span style="color: #0000ff;">this</span>.onRecyclerViewPinnedViewListener =<span style="color: #000000;"> onRecyclerViewPinnedViewListener;<br></span><span style="color: #008080;"> 18</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 19</span><br><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> PinnedRecyclerViewLayout(Context context) {<br></span><span style="color: #008080;"> 21</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context);<br></span><span style="color: #008080;"> 22</span> <span style="color: #000000;">        init(context);<br></span><span style="color: #008080;"> 23</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 24</span><br><span style="color: #008080;"> 25</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> PinnedRecyclerViewLayout(Context context, AttributeSet attrs) {<br></span><span style="color: #008080;"> 26</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, attrs);<br></span><span style="color: #008080;"> 27</span> <span style="color: #000000;">        init(context);<br></span><span style="color: #008080;"> 28</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 29</span><br><span style="color: #008080;"> 30</span>     <span style="color: #0000ff;">public</span> PinnedRecyclerViewLayout(Context context, AttributeSet attrs, <span style="color: #0000ff;">int</span><span style="color: #000000;"> defStyleAttr) {<br></span><span style="color: #008080;"> 31</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, attrs, defStyleAttr);<br></span><span style="color: #008080;"> 32</span> <span style="color: #000000;">        init(context);<br></span><span style="color: #008080;"> 33</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 34</span><br><span style="color: #008080;"> 35</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> init(Context context) {<br></span><span style="color: #008080;"> 36</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 37</span><br><span style="color: #008080;"> 38</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> View pinnedView;<br></span><span style="color: #008080;"> 39</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> ABaseLinearLayoutManager layoutManager;<br></span><span style="color: #008080;"> 40</span><br><span style="color: #008080;"> 41</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> initRecyclerPinned(RecyclerView recyclerView, ABaseLinearLayoutManager layoutManager, View pinnedView) {<br></span><span style="color: #008080;"> 42</span>         <span style="color: #0000ff;">this</span>.pinnedView =<span style="color: #000000;"> pinnedView;<br></span><span style="color: #008080;"> 43</span>         <span style="color: #0000ff;">this</span>.layoutManager =<span style="color: #000000;"> layoutManager;<br></span><span style="color: #008080;"> 44</span>         <span style="color: #0000ff;">this</span>.addView(<span style="color: #0000ff;">this</span><span style="color: #000000;">.pinnedView);<br></span><span style="color: #008080;"> 45</span>         RelativeLayout.LayoutParams lp = <span style="color: #0000ff;">new</span><span style="color: #000000;"> RelativeLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT);<br></span><span style="color: #008080;"> 46</span>         <span style="color: #0000ff;">this</span><span style="color: #000000;">.pinnedView.setLayoutParams(lp);<br></span><span style="color: #008080;"> 47</span>         layoutManager.getRecyclerViewScrollManager().addScrollListener(recyclerView, <span style="color: #0000ff;">new</span><span style="color: #000000;"> OnRecyclerViewScrollListener() {<br></span><span style="color: #008080;"> 48</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;"> 49</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onScrollStateChanged(RecyclerView recyclerView, <span style="color: #0000ff;">int</span><span style="color: #000000;"> newState) {<br></span><span style="color: #008080;"> 50</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 51</span><br><span style="color: #008080;"> 52</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;"> 53</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onScrolled(RecyclerView recyclerView, <span style="color: #0000ff;">int</span> dx, <span style="color: #0000ff;">int</span><span style="color: #000000;"> dy) {<br></span><span style="color: #008080;"> 54</span> <span style="color: #000000;">                refreshPinnedView();<br></span><span style="color: #008080;"> 55</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 56</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;"> 57</span> <span style="color: #000000;">        pinnedView.setVisibility(GONE);<br></span><span style="color: #008080;"> 58</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 59</span><br><span style="color: #008080;"> 60</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> ä¿å­˜ä¸Šæ¬¡çš„position</span><br><span style="color: #008080;"> 61</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> lastPosition =<span style="color: #000000;"> RecyclerView.NO_POSITION;<br></span><span style="color: #008080;"> 62</span><br><span style="color: #008080;"> 63</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> refreshPinnedView() {<br></span><span style="color: #008080;"> 64</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> == pinnedView || <span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> layoutManager) {<br></span><span style="color: #008080;"> 65</span>             Logger.e(TAG, â€œPlease init pinnedView and layoutManager with initRecyclerPinned method first!â€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 66</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 67</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 68</span>         <span style="color: #0000ff;">if</span> (VISIBLE !=<span style="color: #000000;"> pinnedView.getVisibility()) {<br></span><span style="color: #008080;"> 69</span> <span style="color: #000000;">            pinnedView.setVisibility(VISIBLE);<br></span><span style="color: #008080;"> 70</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 71</span>         <span style="color: #0000ff;">int</span> curPosition =<span style="color: #000000;"> layoutManager.findFirstVisibleItemPosition();<br></span><span style="color: #008080;"> 72</span>         <span style="color: #0000ff;">if</span> (RecyclerView.NO_POSITION ==<span style="color: #000000;"> curPosition) {<br></span><span style="color: #008080;"> 73</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 74</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 75</span>         View curItemView =<span style="color: #000000;"> layoutManager.findViewByPosition(curPosition);<br></span><span style="color: #008080;"> 76</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> curItemView) {<br></span><span style="color: #008080;"> 77</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 78</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 79</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœå½“å‰çš„curPositionå’Œä¸Šæ¬¡çš„lastPositionä¸ä¸€æ ·ï¼Œåˆ™è¯´æ˜éœ€è¦é‡æ–°åˆ·æ–°æ•°æ®ï¼Œé¿å…curPositionä¸€æ ·çš„æƒ…å†µä¸‹é‡å¤åˆ·æ–°ç›¸åŒæ•°æ®</span><br><span style="color: #008080;"> 80</span>         <span style="color: #0000ff;">if</span> (curPosition !=<span style="color: #000000;"> lastPosition) {<br></span><span style="color: #008080;"> 81</span>             <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> onRecyclerViewPinnedViewListener) {<br></span><span style="color: #008080;"> 82</span>                 onRecyclerViewPinnedViewListener.onPinnedViewRender(<span style="color: #0000ff;">this</span><span style="color: #000000;">, pinnedView, curPosition);<br></span><span style="color: #008080;"> 83</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 84</span>             lastPosition =<span style="color: #000000;"> curPosition;<br></span><span style="color: #008080;"> 85</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 86</span><br><span style="color: #008080;"> 87</span>         <span style="color: #0000ff;">int</span><span style="color: #000000;"> displayTop;<br></span><span style="color: #008080;"> 88</span>         <span style="color: #0000ff;">int</span> itemHeight =<span style="color: #000000;"> curItemView.getHeight();<br></span><span style="color: #008080;"> 89</span>         <span style="color: #0000ff;">int</span> curTop =<span style="color: #000000;"> curItemView.getTop();<br></span><span style="color: #008080;"> 90</span>         <span style="color: #0000ff;">int</span> floatHeight =<span style="color: #000000;"> pinnedView.getHeight();<br></span><span style="color: #008080;"> 91</span>         <span style="color: #0000ff;">if</span> (curTop &lt; floatHeight -<span style="color: #000000;"> itemHeight) {<br></span><span style="color: #008080;"> 92</span>             displayTop = itemHeight + curTop -<span style="color: #000000;"> floatHeight;<br></span><span style="color: #008080;"> 93</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {<br></span><span style="color: #008080;"> 94</span>             displayTop = 0<span style="color: #000000;">;<br></span><span style="color: #008080;"> 95</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 96</span>         RelativeLayout.LayoutParams lp =<span style="color: #000000;"> (LayoutParams) pinnedView.getLayoutParams();<br></span><span style="color: #008080;"> 97</span>         lp.topMargin =<span style="color: #000000;"> displayTop;<br></span><span style="color: #008080;"> 98</span> <span style="color: #000000;">        pinnedView.setLayoutParams(lp);<br></span><span style="color: #008080;"> 99</span> <span style="color: #000000;">        pinnedView.invalidate();<br></span><span style="color: #008080;">100</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">101</span><br><span style="color: #008080;">102</span><br><span style="color: #008080;">103</span> }</pre><br></div>

<p>&nbsp;</p>
<p>è¿™ä¸ª<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/pinnedlayout/PinnedRecyclerViewLayout.java" target="_blank" rel="noopener">PinnedRecyclerViewLayout</a>&nbsp;</strong>æ˜¯ç»§æ‰¿RelativeLayoutçš„ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨é‡Œé¢æ·»åŠ ä¸€ä¸ªè¢«é¡¶ä¸Šå»çš„pinnedViewï¼Œéœ€è¦è¦†ç›–åœ¨RecyclerViewä¸Šé¢ã€‚</p>
<p>Line44ï¼šæŠŠä¼ è¿›æ¥çš„pinnedViewå¢åŠ åˆ°<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/pinnedlayout/PinnedRecyclerViewLayout.java" target="_blank" rel="noopener">PinnedRecyclerViewLayout</a>&nbsp;</strong>é‡Œé¢</p>
<p>Line47ï½56ï¼šåœ¨ABaseLinearLayoutManagerä¸­å¢åŠ ä¸€ä¸ªæ»šåŠ¨çš„ç›‘å¬å™¨ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨æ»šåŠ¨çš„æ—¶å€™åŠ¨æ€çš„æ”¹å˜pinnedViewçš„ä½ç½®ï¼Œè¿™æ ·æ‰èƒ½æ¨¡æ‹Ÿé¡¶ä¸Šå»çš„æ•ˆæœã€‚å¹¶æ»šåŠ¨æ—¶è°ƒç”¨refreshPinnedViewæ¥åˆ·æ–°pinnedViewçš„ä½ç½®ã€‚</p>
<p>Line57ï¼šå› ä¸ºåœ¨è°ƒç”¨initRecyclerPinnedæ–¹æ³•æ—¶ï¼ŒRecyclerViewå¯èƒ½è¿˜æ²¡æœ‰æ•°æ®æºï¼Œæ‰€ä»¥ä¸éœ€è¦æ˜¾ç¤ºè¿™ä¸ªpinnedViewï¼Œç­‰åˆ°çœŸæ­£æ»šåŠ¨çš„æ—¶å€™å†æ˜¾ç¤ºå°±å¯ä»¥äº†ã€‚</p>
<p>refreshPinnedView()æ–¹æ³•çš„ä½œç”¨æ˜¯åœ¨æ»šåŠ¨çš„åŒæ—¶ç”¨æ¥åˆ·æ–°pinnedViewçš„ä½ç½®å’Œæ˜¾ç¤ºçš„æ•°æ®ï¼š</p>
<p>Line71ï½78ï¼šé€šè¿‡layoutManagerè·å–å½“å‰ç¬¬ä¸€ä¸ªæ˜¾ç¤ºçš„æ•°æ®positionï¼Œç„¶åæ ¹æ®positionè·å–å½“å‰ç¬¬ä¸€ä¸ªæ˜¾ç¤ºçš„Viewã€‚</p>
<p>Line79~85ï¼šå¦‚æœå½“å‰çš„curPositionå’Œä¸Šæ¬¡çš„lastPositionä¸ä¸€æ ·ï¼Œåˆ™è¯´æ˜éœ€è¦é‡æ–°åˆ·æ–°æ•°æ®ï¼Œé¿å…curPositionä¸€æ ·çš„æƒ…å†µä¸‹é‡å¤åˆ·æ–°ç›¸åŒæ•°æ®ã€‚</p>
<p>Line87ï½95ï¼šæ ¹æ®å½“å‰ç¬¬ä¸€ä¸ªæ˜¾ç¤ºçš„Viewï¼Œæ ¹æ®å®ƒçš„topã€å®ƒçš„é«˜åº¦å’ŒpinnedViewçš„é«˜åº¦è®¡ç®—å‡ºpinnedViewéœ€è¦å¾€ä¸Šç§»åŠ¨çš„è·ç¦»ï¼ˆç”»ä¸ªå‡ ä½•å›¾ä¸€ç›®äº†ç„¶äº†ï¼‰ã€‚</p>
<p>Line96ï½99ï¼šåˆ·æ–°pinnedViewçš„ä½ç½®</p>
<p>&nbsp;</p>
<p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>
<p><strong><a href="https://github.com/wangjiegulu/RecyclerViewSample" target="_blank" rel="noopener">https://github.com/wangjiegulu/RecyclerViewSample</a></strong></p>
<p>&nbsp;</p>
<p><span style="font-size: 16px; color: #ff0000;"><strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4232560.html" target="_blank" rel="noopener"><span style="color: #ff0000;">[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆä¸€ï¼‰</span></a></strong>ï¼š</span></p>
<p><span style="font-size: 16px;"><strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4232560.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4232560.html</a></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;"><span style="font-size: 16px;"><strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4242541.html" target="_blank" rel="noopener"><span style="color: #ff0000;">[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆäºŒï¼‰</span></a></strong>ï¼š</span>&nbsp;</span></p>
<p><strong><span style="font-size: 16px;"><span style="color: #ff0000;"><a href="http://www.cnblogs.com/tiantianbyconan/p/4242541.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4242541.html</a></span></span></strong></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> RecyclerView </tag>
            
            <tag> ListView </tag>
            
            <tag> best practices </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆäºŒï¼‰]]></title>
      <url>/2015/01/22/Android-%E4%BD%BF%E7%94%A8RecyclerView%E6%9B%BF%E4%BB%A3ListView%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>ä»¥å‰å†™è¿‡ä¸€ç¯‡&ldquo;<a href="http://www.cnblogs.com/tiantianbyconan/p/3992843.html" target="_blank" rel="noopener">[Android]ä½¿ç”¨AdapterTypeRenderå¯¹ä¸åŒç±»å‹çš„itemæ•°æ®åˆ°UIçš„æ¸²æŸ“</a>ï¼ˆ<a href="http://www.cnblogs.com/tiantianbyconan/p/3992843.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/3992843.html</a>ï¼‰&rdquo;ï¼Œç”¨äºåœ¨æœ‰å¾ˆå¤šä¸åŒç±»å‹ä¸åŒå¸ƒå±€çš„itemçš„æ—¶å€™æ€ä¹ˆå»è¾ƒå¥½çš„è¿›è¡Œviewçš„ç»‘å®šå’Œæ•°æ®çš„æ¸²æŸ“ï¼Œä½†æ˜¯è¿™ä¸ªæ˜¯é’ˆå¯¹ListViewå†™çš„ã€‚è¿™æ¬¡æˆ‘é’ˆå¯¹RecyclerViewä¹Ÿé‡æ–°å®ç°äº†ä¸€éã€‚</p>
<p>æ¥ä¸‹æ¥æ¼”ç¤ºä¸‹æ€ä¹ˆå»æ¸²æŸ“ä¸åŒç±»å‹çš„itemï¼Œå¹¶ä¸”ä½¿å®ƒæ”¯æŒä¸‹æ‹‰åˆ·æ–°ï¼Œæ»šåŠ¨åˆ°åº•éƒ¨æ˜¾ç¤ºåŠ è½½è¿›åº¦æ¡æ˜¾ç¤ºã€‚</p>
<p>ä»¥ä¸‹æ‰€æœ‰çš„å°è£…éƒ½åœ¨<a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener"><strong>AndroidBucket</strong></a>é¡¹ç›®ä¸­ï¼š<strong><a href="https://github.com/wangjiegulu/AndroidBucket/tree/master/src/com/wangjie/androidbucket/support/recyclerview" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket/tree/master/src/com/wangjie/androidbucket/support/recyclerview</a>
</strong></p>
<p><img src="http://images.cnitblog.com/blog/378300/201501/221902087508177.png" alt="">&nbsp;<img src="http://images.cnitblog.com/blog/378300/201501/221902461722079.png" alt=""></p>
<p>ä½¿ç”¨çš„æ–¹å¼å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">final</span> View footerView = LayoutInflater.from(context).inflate(R.layout.recycler_view_item_type_footer, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 2</span> <span style="color: #008000;">//</span><span style="color: #008000;">        ä¸çŸ¥é“ä¸ºä»€ä¹ˆåœ¨xmlè®¾ç½®çš„&ldquo;android:layout_width=â€match_parentâ€&rdquo;æ— æ•ˆäº†ï¼Œéœ€è¦åœ¨è¿™é‡Œé‡æ–°è®¾ç½®</span><br><span style="color: #008080;"> 3</span>         LinearLayout.LayoutParams lp = <span style="color: #0000ff;">new</span><span style="color: #000000;"> LinearLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT);<br></span><span style="color: #008080;"> 4</span> <span style="color: #000000;">        footerView.setLayoutParams(lp);<br></span><span style="color: #008080;"> 5</span><br><span style="color: #008080;"> 6</span>         recyclerView.setHasFixedSize(<span style="color: #0000ff;">true</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span>         <span style="color: #0000ff;">final</span> ABaseLinearLayoutManager layoutManager = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ABaseLinearLayoutManager(context);<br></span><span style="color: #008080;"> 9</span>         layoutManager.setOnRecyclerViewScrollLocationListener(recyclerView, <span style="color: #0000ff;">new</span><span style="color: #000000;"> OnRecyclerViewScrollLocationListener() {<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">11</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onTopWhenScrollIdle(RecyclerView recyclerView) {<br></span><span style="color: #008080;">12</span>                 Logger.d(TAG, â€œonTopWhenScrollIdleâ€¦â€<span style="color: #000000;">);<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">16</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onBottomWhenScrollIdle(RecyclerView recyclerView) {<br></span><span style="color: #008080;">17</span>                 Logger.d(TAG, â€œonBottomWhenScrollIdleâ€¦â€<span style="color: #000000;">);<br></span><span style="color: #008080;">18</span> <span style="color: #000000;">                footerView.setVisibility(View.VISIBLE);<br></span><span style="color: #008080;">19</span>                 ThreadPool.go(<span style="color: #0000ff;">new</span> Runtask&lt;Object, Object&gt;<span style="color: #000000;">() {<br></span><span style="color: #008080;">20</span> <span style="color: #000000;">                    @Override<br></span><span style="color: #008080;">21</span>                     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Object runInBackground() {<br></span><span style="color: #008080;">22</span>                         ABThreadUtil.sleep(3000<span style="color: #000000;">);<br></span><span style="color: #008080;">23</span>                         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;">24</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">25</span><br><span style="color: #008080;">26</span> <span style="color: #000000;">                    @Override<br></span><span style="color: #008080;">27</span>                     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onResult(Object result) {<br></span><span style="color: #008080;">28</span>                         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onResult(result);<br></span><span style="color: #008080;">29</span>                         refreshLayout.setRefreshing(<span style="color: #0000ff;">false</span><span style="color: #000000;">);<br></span><span style="color: #008080;">30</span> <span style="color: #000000;">                        footerView.setVisibility(View.GONE);<br></span><span style="color: #008080;">31</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">32</span> <span style="color: #000000;">                });<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">34</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">35</span> <span style="color: #000000;">        layoutManager.setOrientation(LinearLayoutManager.VERTICAL);<br></span><span style="color: #008080;">36</span>         layoutManager.getRecyclerViewScrollManager().addScrollListener(recyclerView, <span style="color: #0000ff;">new</span><span style="color: #000000;"> OnRecyclerViewScrollListener() {<br></span><span style="color: #008080;">37</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">38</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onScrollStateChanged(RecyclerView recyclerView, <span style="color: #0000ff;">int</span><span style="color: #000000;"> newState) {<br></span><span style="color: #008080;">39</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">42</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onScrolled(RecyclerView recyclerView, <span style="color: #0000ff;">int</span> dx, <span style="color: #0000ff;">int</span><span style="color: #000000;"> dy) {<br></span><span style="color: #008080;">43</span>                 refreshLayout.setEnabled(layoutManager.findFirstCompletelyVisibleItemPosition() == 0<span style="color: #000000;">);<br></span><span style="color: #008080;">44</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">46</span> <span style="color: #000000;">        recyclerView.setLayoutManager(layoutManager);<br></span><span style="color: #008080;">47</span><br><span style="color: #008080;">48</span> <span style="color: #000000;">        initData();<br></span><span style="color: #008080;">49</span><br><span style="color: #008080;">50</span>         adapter = <span style="color: #0000ff;">new</span> PersonTypeAdapter(context, personList, <span style="color: #0000ff;">null</span><span style="color: #000000;">, footerView);<br></span><span style="color: #008080;">51</span>         adapter.setOnRecyclerViewListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">52</span> <span style="color: #000000;">        recyclerView.setAdapter(adapter);<br></span><span style="color: #008080;">53</span><br><span style="color: #008080;">54</span> <span style="color: #000000;">        refreshLayout.setColorSchemeColors(Color.BLUE, Color.RED, Color.YELLOW, Color.GREEN);<br></span><span style="color: #008080;">55</span>         refreshLayout.setOnRefreshListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> SwipeRefreshLayout.OnRefreshListener() {<br></span><span style="color: #008080;">56</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">57</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onRefresh() {<br></span><span style="color: #008080;">58</span>                 ThreadPool.go(<span style="color: #0000ff;">new</span> Runtask&lt;Object, Object&gt;<span style="color: #000000;">() {<br></span><span style="color: #008080;">59</span> <span style="color: #000000;">                    @Override<br></span><span style="color: #008080;">60</span>                     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Object runInBackground() {<br></span><span style="color: #008080;">61</span>                         ABThreadUtil.sleep(3000<span style="color: #000000;">);<br></span><span style="color: #008080;">62</span>                         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;">63</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">64</span><br><span style="color: #008080;">65</span> <span style="color: #000000;">                    @Override<br></span><span style="color: #008080;">66</span>                     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onResult(Object result) {<br></span><span style="color: #008080;">67</span>                         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onResult(result);<br></span><span style="color: #008080;">68</span>                         refreshLayout.setRefreshing(<span style="color: #0000ff;">false</span><span style="color: #000000;">);<br></span><span style="color: #008080;">69</span> <span style="color: #000000;">                        footerView.setVisibility(View.GONE);<br></span><span style="color: #008080;">70</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">71</span> <span style="color: #000000;">                });<br></span><span style="color: #008080;">72</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">73</span>         });</pre><br></div>

<p>&nbsp;</p>
<p><span style="line-height: 1.5;">å¦‚ä¸Šè¿°ä»£ç ï¼š</span></p>
<p>Line1ï¼šä»å¸ƒå±€æ–‡ä»¶ä¸­inflateå‡ºä¸€ä¸ªViewå®ä¾‹ï¼Œè¿™ä¸ªViewå®ä¾‹ï¼Œä¸‹é¢ä¼šè¢«ç”¨äºä½œä¸ºä¸‹è½½æç¤ºçš„footerã€‚</p>
<p>Line8ï¼šç”Ÿæˆä¸€ä¸ª<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/layoutmanager/ABaseLinearLayoutManager.java" target="_blank" rel="noopener">ABaseLinearLayoutManager</a></strong>å®ä¾‹ï¼Œæ˜¾ç„¶è¿™ä¸ªç±»æ˜¯ç»§æ‰¿LinearLayoutManagerä¹‹åæ‰©å±•çš„ï¼Œè¯¦è§ï¼š<a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/layoutmanager/ABaseLinearLayoutManager.java" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/layoutmanager/ABaseLinearLayoutManager.java</a>ï¼Œè¿™ä¸ªç±»å¯¹æ»‘åŠ¨çš„ç›‘å¬è¿›è¡Œäº†æ‰©å±•ï¼Œå¯ä»¥ç›‘å¬æ»‘åŠ¨åˆ°é¡¶éƒ¨æˆ–è€…åº•éƒ¨çš„äº‹ä»¶</p>
<p>Line9ï½34ï¼šè®¾ç½®æ»‘åŠ¨åˆ°é¡¶éƒ¨æˆ–åº•éƒ¨çš„ç›‘å¬å™¨ï¼Œç„¶åä¸€æ—¦æ»‘åŠ¨åˆ°åº•éƒ¨åˆ™åŠ è½½æ›´å¤šæ•°æ®ã€‚</p>
<p>Line36ï½45ï¼šä¹Ÿæ˜¯è®¾ç½®æ»‘åŠ¨ç›‘å¬å™¨ï¼Œæ»‘åŠ¨è¿‡ç¨‹ä¸­å¦‚æœä¸æ˜¯å¤„åœ¨ç¬¬ä¸€ä¸ªitemï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°±å¯ä»¥ä¸‹æ‹‰ä½¿ç”¨SwipeRefreshLayoutè¿›è¡Œåˆ·æ–°ï¼Œå¦‚æœä¸æ˜¯åˆ™ï¼Œä»…ç”¨SwipeRefreshLayoutã€‚ä¹‹æ‰€ä»¥éœ€è¦åšè¿™ä¸ªå¤„ç†ï¼Œæ˜¯å› ä¸ºGoogleäº‹ä»¶å¤„ç†çš„ä¸€ä¸ªbugï¼ï¼ã€‚</p>
<p>Line50ï¼šä½¿ç”¨äº†ä¸€ä¸ªPersonTypeAdapterï¼Œè¿™ä¸ªç±»ç»§æ‰¿äº†<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/extra/ABRecyclerViewTypeExtraViewAdapter.java" target="_blank" rel="noopener">ABRecyclerViewTypeExtraViewAdapter</a>ï¼Œ</strong>è¿™ä¸ªç±»ç»§æ‰¿RecyclerView.Adapterå®ç°äº†å¯¹ä¸åŒtypeæ¸²æŸ“æ•°æ®çš„å°è£…ã€‚</p>
<p>&nbsp;</p>
<p>æ¥ä¸‹æ¥é‡ç‚¹åˆ†æä¸‹ABRecyclerViewTypeExtraViewAdapterè¿™ä¸ªç±»ï¼ˆè¿™ä¸ªç±»åœ¨å¹³å¸¸ä½¿ç”¨æ—¶ä¸éœ€è¦å…³æ³¨ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">  1</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">  2</span> <span style="color: #008000;"> <em> Author: wangjie<br></em></span><span style="color: #008080;">  3</span> <span style="color: #008000;">  Email: tiantian.china.2@gmail.com<br></span><span style="color: #008080;">  4</span> <span style="color: #008000;"> <em> Date: 1/22/15.<br></em></span><span style="color: #008080;">  5</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;">  6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span> ABRecyclerViewTypeExtraViewAdapter <span style="color: #0000ff;">extends</span> RecyclerView.Adapter&lt;ABRecyclerViewTypeExtraHolder&gt;<span style="color: #000000;"> {<br></span><span style="color: #008080;">  7</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> TYPE_HEADER_VIEW = 0x7683<span style="color: #000000;">;<br></span><span style="color: #008080;">  8</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> View headerView;<br></span><span style="color: #008080;">  9</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> TYPE_FOOTER_VIEW = 0x7684<span style="color: #000000;">;<br></span><span style="color: #008080;"> 10</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> View footerView;<br></span><span style="color: #008080;"> 11</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> extraCount;<br></span><span style="color: #008080;"> 12</span><br><span style="color: #008080;"> 13</span>     <span style="color: #0000ff;">protected</span><span style="color: #000000;"> ABRecyclerViewTypeExtraViewAdapter(View headerView, View footerView) {<br></span><span style="color: #008080;"> 14</span>         <span style="color: #0000ff;">this</span>.headerView =<span style="color: #000000;"> headerView;<br></span><span style="color: #008080;"> 15</span>         <span style="color: #0000ff;">this</span>.footerView =<span style="color: #000000;"> footerView;<br></span><span style="color: #008080;"> 16</span>         extraCount += hasHeaderView() ? 0 : 1<span style="color: #000000;">;<br></span><span style="color: #008080;"> 17</span>         extraCount += hasFooterView() ? 0 : 1<span style="color: #000000;">;<br></span><span style="color: #008080;"> 18</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 19</span><br><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> hasHeaderView() {<br></span><span style="color: #008080;"> 21</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> headerView;<br></span><span style="color: #008080;"> 22</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 23</span><br><span style="color: #008080;"> 24</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> hasFooterView() {<br></span><span style="color: #008080;"> 25</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> footerView;<br></span><span style="color: #008080;"> 26</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 27</span><br><span style="color: #008080;"> 28</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> innerPositionToRealItemPosition(<span style="color: #0000ff;">int</span><span style="color: #000000;"> innerPosition) {<br></span><span style="color: #008080;"> 29</span>         <span style="color: #0000ff;">return</span> hasHeaderView() ? innerPosition - 1<span style="color: #000000;"> : innerPosition;<br></span><span style="color: #008080;"> 30</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 31</span><br><span style="color: #008080;"> 32</span> <span style="color: #000000;">    @TargetApi(Build.VERSION_CODES.DONUT)<br></span><span style="color: #008080;"> 33</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 34</span>     <span style="color: #0000ff;">public</span> ABRecyclerViewTypeExtraHolder onCreateViewHolder(ViewGroup viewGroup, <span style="color: #0000ff;">int</span><span style="color: #000000;"> viewType) {<br></span><span style="color: #008080;"> 35</span>         ABAdapterTypeRender&lt;ABRecyclerViewTypeExtraHolder&gt; render =<span style="color: #000000;"> getAdapterTypeRender(viewType);<br></span><span style="color: #008080;"> 36</span>         ABRecyclerViewTypeExtraHolder holder =<span style="color: #000000;"> render.getReusableComponent();<br></span><span style="color: #008080;"> 37</span> <span style="color: #000000;">        holder.itemView.setTag(R.id.ab<strong>id_adapter_item_type_render, render);<br></strong></span><span style="color: #008080;"> 38</span> <span style="color: #000000;">        render.fitEvents();<br></span><span style="color: #008080;"> 39</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> holder;<br></span><span style="color: #008080;"> 40</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 41</span><br><span style="color: #008080;"> 42</span> <span style="color: #000000;">    @TargetApi(Build.VERSION_CODES.DONUT)<br></span><span style="color: #008080;"> 43</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 44</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onBindViewHolder(ABRecyclerViewTypeExtraHolder holder, <span style="color: #0000ff;">int</span><span style="color: #000000;"> innerPosition) {<br></span><span style="color: #008080;"> 45</span>         ABAdapterTypeRender&lt;ABRecyclerViewTypeExtraHolder&gt; render = (ABAdapterTypeRender&lt;ABRecyclerViewTypeExtraHolder&gt;<span style="color: #000000;">) holder.itemView.getTag(R.id.abid_adapter_item_type_render);<br></span><span style="color: #008080;"> 46</span>         <span style="color: #008000;">/</span><br><span style="color: #008080;"> 47</span> <span style="color: #008000;">         <em> è®¡ç®—è¯¥itemåœ¨listä¸­çš„indexï¼ˆä¸åŒ…æ‹¬headerViewå’ŒfooterViewï¼‰<br></em></span><span style="color: #008080;"> 48</span>          <span style="color: #008000;">/</span><br><span style="color: #008080;"> 49</span>         <span style="color: #0000ff;">int</span> realItemPosition =<span style="color: #000000;"> innerPositionToRealItemPosition(innerPosition);<br></span><span style="color: #008080;"> 50</span> <span style="color: #000000;">        render.fitDatas(realItemPosition);<br></span><span style="color: #008080;"> 51</span>         <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 52</span> <span style="color: #008000;">         <em> é‡æ–°è®¾ç½®itemåœ¨listä¸­çš„indexï¼ˆä¸åŒ…æ‹¬headerViewå’ŒfooterViewï¼‰<br></em></span><span style="color: #008080;"> 53</span>          <span style="color: #008000;">/</span><br><span style="color: #008080;"> 54</span> <span style="color: #000000;">        holder.setRealItemPosition(realItemPosition);<br></span><span style="color: #008080;"> 55</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 56</span><br><span style="color: #008080;"> 57</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 58</span> <span style="color: #008000;">     <em> é€šè¿‡ç±»å‹è·å¾—å¯¹åº”çš„renderï¼ˆä¸åŒ…æ‹¬headerViewå’ŒfooterViewï¼‰<br></em></span><span style="color: #008080;"> 59</span> <span style="color: #008000;">     <br></span><span style="color: #008080;"> 60</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> type<br></span><span style="color: #008080;"> 61</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><br><span style="color: #008080;"> 62</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 63</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> ABAdapterTypeRender&lt;ABRecyclerViewTypeExtraHolder&gt; getAdapterTypeRenderExcludeExtraView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> type);<br></span><span style="color: #008080;"> 64</span><br><span style="color: #008080;"> 65</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 66</span> <span style="color: #008000;">      è·å–itemçš„æ•°é‡ï¼ˆä¸åŒ…æ‹¬headerViewå’ŒfooterViewï¼‰<br></span><span style="color: #008080;"> 67</span> <span style="color: #008000;">     <em><br></em></span><span style="color: #008080;"> 68</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><br><span style="color: #008080;"> 69</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 70</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getItemCountExcludeExtraView();<br></span><span style="color: #008080;"> 71</span><br><span style="color: #008080;"> 72</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 73</span> <span style="color: #008000;">      é€šè¿‡realItemPositionå¾—åˆ°è¯¥itemçš„ç±»å‹ï¼ˆä¸åŒ…æ‹¬headerViewå’ŒfooterViewï¼‰<br></span><span style="color: #008080;"> 74</span> <span style="color: #008000;">     <em><br></em></span><span style="color: #008080;"> 75</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> realItemPosition<br></span><span style="color: #008080;"> 76</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><br><span style="color: #008080;"> 77</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 78</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">int</span> getItemViewTypeExcludeExtraView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> realItemPosition);<br></span><span style="color: #008080;"> 79</span><br><span style="color: #008080;"> 80</span>     <span style="color: #0000ff;">public</span> ABAdapterTypeRender&lt;ABRecyclerViewTypeExtraHolder&gt; getAdapterTypeRender(<span style="color: #0000ff;">int</span><span style="color: #000000;"> type) {<br></span><span style="color: #008080;"> 81</span>         <span style="color: #0000ff;">switch</span><span style="color: #000000;"> (type) {<br></span><span style="color: #008080;"> 82</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> TYPE_HEADER_VIEW:<br></span><span style="color: #008080;"> 83</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> ABRecyclerViewTypeExtraRender(headerView);<br></span><span style="color: #008080;"> 84</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> TYPE_FOOTER_VIEW:<br></span><span style="color: #008080;"> 85</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> ABRecyclerViewTypeExtraRender(footerView);<br></span><span style="color: #008080;"> 86</span>             <span style="color: #0000ff;">default</span><span style="color: #000000;">:<br></span><span style="color: #008080;"> 87</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;"> getAdapterTypeRenderExcludeExtraView(type);<br></span><span style="color: #008080;"> 88</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 89</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 90</span><br><span style="color: #008080;"> 91</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 92</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getItemCount() {<br></span><span style="color: #008080;"> 93</span>         <span style="color: #0000ff;">return</span> getItemCountExcludeExtraView() +<span style="color: #000000;"> extraCount;<br></span><span style="color: #008080;"> 94</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 95</span><br><span style="color: #008080;"> 96</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 97</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> getItemViewType(<span style="color: #0000ff;">int</span><span style="color: #000000;"> innerPosition) {<br></span><span style="color: #008080;"> 98</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> != headerView &amp;&amp; 0 == innerPosition) { <span style="color: #008000;">//</span><span style="color: #008000;"> header</span><br><span style="color: #008080;"> 99</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> TYPE_HEADER_VIEW;<br></span><span style="color: #008080;">100</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> != footerView &amp;&amp; getItemCount() - 1 == innerPosition) { <span style="color: #008000;">//</span><span style="color: #008000;"> footer</span><br><span style="color: #008080;">101</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> TYPE_FOOTER_VIEW;<br></span><span style="color: #008080;">102</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">103</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> getItemViewTypeExcludeExtraView(innerPositionToRealItemPosition(innerPosition));<br></span><span style="color: #008080;">104</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">105</span> }</pre><br></div>

<p>å¦‚ä¸Šè¿°ä»£ç æ‰€ç¤ºï¼š</p>
<p>å› ä¸ºæˆ‘ä»¬çš„éœ€æ±‚æ˜¯éœ€è¦æ·»åŠ &ldquo;åŠ è½½è¿›åº¦æ¡&rdquo;ï¼Œæ‰€ä»¥éœ€è¦åƒListViewé‚£æ ·ï¼Œæ·»åŠ ä¸€ä¸ªFooterViewã€‚å¯æ˜¯å‘çˆ¹çš„æ˜¯ï¼ŒRecyclerViewä¸æä¾›addheaderView()å’ŒaddFooterView()æ–¹æ³•ï¼Œæ‰€ä»¥åªèƒ½æˆ‘ä»¬è‡ªå·±å»å®ç°äº†ï¼Œæ–¹æ³•å½“ç„¶æ˜¯ä½¿ç”¨ä¸åŒtypeæ¥åŒºåˆ†ç±»å‹ã€‚è™½ç„¶headerViewè¿™é‡Œæ²¡æœ‰ç”¨åˆ°ï¼Œä½†æ˜¯ä¹Ÿé¡ºå¸¦å®ç°ä¸‹å¥½äº†ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„Holderæ˜¯<a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/extra/ABRecyclerViewTypeExtraHolder.java" target="_blank" rel="noopener"><strong>ABRecyclerViewTypeExtraHolder</strong></a>ï¼Œè¿™ä¸ªç±»å¾…ä¼šåˆ†æã€‚</p>
<p>headerViewå’ŒfooterViewè¿™é‡Œä½¿ç”¨æ„é€ æ–¹æ³•ä¼ å…¥ï¼Œå¹¶ç¼“å­˜headerViewå’ŒfooterViewã€‚åœ¨onCreateViewHolderä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸åŒtypeï¼Œç”Ÿæˆç›¸åº”çš„renderã€‚å¹¶æŠŠrenderç»‘å®šåˆ°holderçš„itemViewä¸Šé¢ï¼Œå› ä¸ºæ—¢ç„¶ç°åœ¨å¤ç”¨çš„æ˜¯holderï¼Œé‚£æˆ‘çš„renderä¹Ÿè¦å®ç°å¤ç”¨çš„è¯ï¼Œä¹Ÿç»‘å®šåœ¨holderé‡Œé¢å§ã€‚ç„¶åè°ƒç”¨renderçš„fitEventsæ–¹æ³•ï¼Œæ¥å®ç°renderé‡Œé¢çš„äº‹ä»¶ç»‘å®šã€‚</p>
<p>onBindViewHolderæ–¹æ³•ä¸­ï¼Œé€šè¿‡holderï¼Œå–å‡ºrenderï¼Œç„¶åæ³¨æ„Line49ï½54ï¼Œé‡Œé¢æ‰§è¡Œäº†innerPositionToRealItemPosition()æ–¹æ³•å¯¹innerPositionåˆ°RealItemPositionçš„è½¬æ¢ï¼Œè¿™é‡Œçš„innerPositionä»£è¡¨å†…éƒ¨çš„positionï¼Œå› ä¸ºè¿™é‡Œå¯èƒ½ä¼šæ·»åŠ äº†headerViewï¼Œä¸€æ—¦æ·»åŠ äº†headerViewï¼Œé‚£positionè·Ÿæ•°æ®æºListä¸­çš„indexå°±ä¸åŒ¹é…äº†ï¼Œè¿™æ ·çš„è¯ç»‘å®šç‚¹å‡»äº‹ä»¶åï¼Œé€šè¿‡holder.getPositon()å¾—åˆ°çš„positionå°±ä¸æ˜¯indexäº†ï¼Œæ‰€ä»¥ä¸èƒ½å†™&ldquo;list.get(position)â€¦&rdquo;äº†ã€‚è¿™é‡Œçš„realItemPositionå°±ä»£è¡¨æ•°æ®æºå¯¹åº”çš„index ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æŠŠinnerPositionè½¬æ¢ä¸ºrealItemPositionï¼Œæ–¹æ³•å¾ˆç®€å•ï¼ŒinnerPositionï¼1=realItemPositionï¼ˆè¿™é‡Œçš„å‡å»1å®é™…ä¸Šå°±æ˜¯å‡å»äº†headerViewï¼‰ã€‚å…¶å®holderä¸­æœ¬æ¥å°±ç¼“å­˜äº†å½“å‰ä½¿ç”¨äº†è¿™ä¸ªholderçš„itemçš„positionï¼Œä½†æ˜¯å› ä¸ºæœ‰äº†headerViewçš„å­˜åœ¨ï¼Œpositionå°±ä¸ç­‰äºrealItemPositionäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ç¼“å­˜realItemPositionã€‚æ‰€ä»¥ä»£ç Line46ï½54è¯ç”Ÿäº†ã€‚</p>
<p>getItemCountExcludeExtraView()æ–¹æ³•éœ€è¦å­ç±»å®ç°ï¼Œè¿”å›æ•°æ®æºä¸­çš„æ•°æ®æ•°é‡ï¼Œç„¶åå†åŠ ä¸ŠextraCountå³æ˜¯getItemCountçš„å€¼ã€‚</p>
<p>getItemViewType()æ–¹æ³•å…ˆæ‰§è¡Œäº†headerç±»å‹å’Œfooterç±»å‹çš„é€»è¾‘ï¼Œç„¶åå†è®©è‡ªç±»å»å®ç°getItemViewTypeExcludeExtraView()æ¥æ‰§è¡Œå…¶ä»–ç±»å‹çš„é€»è¾‘ã€‚</p>
<p>è‡³äº<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/extra/ABRecyclerViewTypeExtraRender.java" target="_blank" rel="noopener">ABRecyclerViewTypeExtraRender</a>ï¼ˆ<a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/extra/ABRecyclerViewTypeExtraRender.java" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/extra/ABRecyclerViewTypeExtraRender.java</a>ï¼‰</strong></p>
<p>éƒ¨åˆ†çš„å®ç°å¯ä»¥æŸ¥çœ‹</p>
<p><strong><a href="http://www.cnblogs.com/[Android]ä½¿ç”¨AdapterTypeRenderå¯¹ä¸åŒç±»å‹çš„itemæ•°æ®åˆ°UIçš„æ¸²æŸ“" target="_blank" rel="noopener">[Android]ä½¿ç”¨AdapterTypeRenderå¯¹ä¸åŒç±»å‹çš„itemæ•°æ®åˆ°UIçš„æ¸²æŸ“</a></strong>ï¼ˆ<strong><a href="http://www.cnblogs.com/tiantianbyconan/p/3992843.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/3992843.html</a></strong>ï¼‰</p>
<p>å®ç°çš„åŸç†å¤§åŒå°å¼‚äº†ã€‚</p>
<p>&nbsp;</p>
<p>ç„¶ååˆ†æä¸‹<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/extra/ABRecyclerViewTypeExtraHolder.java" target="_blank" rel="noopener">ABRecyclerViewTypeExtraHolder</a>ï¼ˆ<a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/extra/ABRecyclerViewTypeExtraHolder.java" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/extra/ABRecyclerViewTypeExtraHolder.java</a>ï¼‰</strong>è¿™ä¸ªç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;"> <em> Author: wangjie<br></em></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">  Email: tiantian.china.2@gmail.com<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;"> <em> Date: 1/22/15.<br></em></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ABRecyclerViewTypeExtraHolder <span style="color: #0000ff;">extends</span><span style="color: #000000;"> ABRecyclerViewHolder {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> ABRecyclerViewTypeExtraHolder(View itemView) {<br></span><span style="color: #008080;"> 8</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(itemView);<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">12</span> <span style="color: #008000;">     <em> ä¿å­˜å½“å‰positionï¼ˆlist indexï¼Œä¸åŒ…æ‹¬headerViewå’ŒfooterViewï¼‰<br></em></span><span style="color: #008080;">13</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">14</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> realItemPosition;<br></span><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getRealItemPosition() {<br></span><span style="color: #008080;">17</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> realItemPosition;<br></span><span style="color: #008080;">18</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">19</span><br><span style="color: #008080;">20</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> setRealItemPosition(<span style="color: #0000ff;">int</span><span style="color: #000000;"> realItemPosition) {<br></span><span style="color: #008080;">21</span>         <span style="color: #0000ff;">this</span>.realItemPosition =<span style="color: #000000;"> realItemPosition;<br></span><span style="color: #008080;">22</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">23</span><br><span style="color: #008080;">24</span> }</pre><br></div>

<p>å®ƒç»§æ‰¿äº†<a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/ABRecyclerViewHolder.java" target="_blank" rel="noopener"><strong>ABRecyclerViewHolder</strong></a>ï¼ˆ<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/ABRecyclerViewHolder.java" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/ABRecyclerViewHolder.java</a></strong>ï¼‰ï¼Œåªæ˜¯ä¿å­˜äº†ä¸€ä¸ªåˆšåˆšè®²åˆ°çš„realItemPositionå¯¹è±¡ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å†è´´ä¸‹<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/support/recyclerview/adapter/ABRecyclerViewHolder.java" target="_blank" rel="noopener">ABRecyclerViewHolder</a></strong>çš„ä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;"> <em> Author: wangjie<br></em></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">  Email: tiantian.china.2@gmail.com<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;"> <em> Date: 1/19/15.<br></em></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ABRecyclerViewHolder <span style="color: #0000ff;">extends</span><span style="color: #000000;"> RecyclerView.ViewHolder {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = ABRecyclerViewHolder.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">private</span> SparseArray&lt;View&gt; holder = <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> ABRecyclerViewHolder(View itemView) {<br></span><span style="color: #008080;">11</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(itemView);<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">13</span><br><span style="color: #008080;">14</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">15</span> <span style="color: #008000;">     <em> è·å–ä¸€ä¸ªç¼“å­˜çš„view<br></em></span><span style="color: #008080;">16</span> <span style="color: #008000;">     <br></span><span style="color: #008080;">17</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> id<br></span><span style="color: #008080;">18</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> &lt;T&gt;<br></span><span style="color: #008080;">19</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><br><span style="color: #008080;">20</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span> &lt;T <span style="color: #0000ff;">extends</span> View&gt; T obtainView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> id) {<br></span><span style="color: #008080;">22</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> holder) {<br></span><span style="color: #008080;">23</span>             holder = <span style="color: #0000ff;">new</span> SparseArray&lt;&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">24</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">25</span>         View view =<span style="color: #000000;"> holder.get(id);<br></span><span style="color: #008080;">26</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> view) {<br></span><span style="color: #008080;">27</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> (T) view;<br></span><span style="color: #008080;">28</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">29</span>         view =<span style="color: #000000;"> itemView.findViewById(id);<br></span><span style="color: #008080;">30</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> view) {<br></span><span style="color: #008080;">31</span>             Logger.e(TAG, â€œno view that id is â€œ +<span style="color: #000000;"> id);<br></span><span style="color: #008080;">32</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">34</span> <span style="color: #000000;">        holder.put(id, view);<br></span><span style="color: #008080;">35</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> (T) view;<br></span><span style="color: #008080;">36</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">37</span><br><span style="color: #008080;">38</span>     <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">39</span> <span style="color: #008000;">      è·å–ä¸€ä¸ªç¼“å­˜çš„viewï¼Œå¹¶è‡ªåŠ¨è½¬å‹<br></span><span style="color: #008080;">40</span> <span style="color: #008000;">     <em><br></em></span><span style="color: #008080;">41</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> id<br></span><span style="color: #008080;">42</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> &lt;T&gt;<br></span><span style="color: #008080;">43</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><br><span style="color: #008080;">44</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">45</span>     <span style="color: #0000ff;">public</span> &lt;T&gt; T obtainView(<span style="color: #0000ff;">int</span> id, Class&lt;T&gt;<span style="color: #000000;"> viewClazz) {<br></span><span style="color: #008080;">46</span>         View view =<span style="color: #000000;"> obtainView(id);<br></span><span style="color: #008080;">47</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> view) {<br></span><span style="color: #008080;">48</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;">49</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">50</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> (T) view;<br></span><span style="color: #008080;">51</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">52</span><br><span style="color: #008080;">53</span> }</pre><br></div>

<p>ç„¶åå‘ç°ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨äºä½¿ç”¨SparseArrayæ¥ç¼“å­˜findViewByIdåçš„æ§ä»¶ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œè¿™ä¸ªholderå¯ä»¥é€‚ç”¨äºä»»ä½•çš„RecyclerView.Adapterä¸­ã€‚åªè¦é€šè¿‡obtainView()æ–¹æ³•å°±èƒ½å¾—åˆ°itemViewä¸­çš„å…·ä½“çš„viewå¯¹è±¡ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> Person person =<span style="color: #000000;"> adapter.getList().get(position);<br></span><span style="color: #008080;">2</span> holder.obtainView(R.id.recycler_view_test_item_person_name_tv, TextView.<span style="color: #0000ff;">class</span><span style="color: #000000;">).setText(person.getName());ï¼<br></span><span style="color: #008080;">3</span> holder.obtainView(R.id.recycler_view_test_item_person_age_tv, TextView.<span style="color: #0000ff;">class</span>).setText(person.getAge() + â€œå²â€);</pre><br></div>

<p>&nbsp;</p>
<p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>
<p><strong><a href="https://github.com/wangjiegulu/RecyclerViewSample" target="_blank" rel="noopener">https://github.com/wangjiegulu/RecyclerViewSample</a></strong></p>
<p>&nbsp;</p>
<p><span style="font-size: 16px; color: #ff0000;"><strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4232560.html" target="_blank" rel="noopener"><span style="color: #ff0000;">[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆä¸€ï¼‰</span></a></strong>ï¼š</span></p>
<p><span style="font-size: 16px;"><strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4232560.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4232560.html</a></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;"><span style="font-size: 16px;"><strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4268097.html" target="_blank" rel="noopener"><span style="color: #ff0000;">[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆä¸‰ï¼‰</span></a></strong>ï¼š</span>&nbsp;</span></p>
<p><span style="font-size: 16px; line-height: 24px;"><strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4268097.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/4268097.html</a></strong></span></p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> RecyclerView </tag>
            
            <tag> ListView </tag>
            
            <tag> best practices </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆä¸€ï¼‰]]></title>
      <url>/2015/01/18/Android-%E4%BD%BF%E7%94%A8RecyclerView%E6%9B%BF%E4%BB%A3ListView%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>RecyclerViewæ˜¯ä¸€ä¸ªæ¯”ListViewæ›´çµæ´»çš„ä¸€ä¸ªæ§ä»¶ï¼Œä»¥åå¯ä»¥ç›´æ¥æŠ›å¼ƒListViewäº†ã€‚å…·ä½“å¥½åœ¨å“ªäº›åœ°æ–¹ï¼Œå¾€ä¸‹çœ‹å°±çŸ¥é“äº†ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥ä½¿ç”¨RecyclerViewæ¥å®ç°ListViewçš„æ•ˆæœï¼Œä¸€ä¸ªæ»šåŠ¨åˆ—è¡¨ï¼Œå…ˆçœ‹ä¸‹æ•ˆæœå›¾ï¼ˆé™¤äº†æœ‰åŠ¨ç”»ä¹‹å¤–ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«ï¼ï¼ï¼‰ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201501/182259096511353.png" alt=""></p>
<p>&nbsp;</p>
<p>æ¯ä¸ªitemçš„å¸ƒå±€å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><span style="color: #ff0000;"><br>              android:id</span><span style="color: #0000ff;">=â€@+id/recycler_view_test_item_person_viewâ€</span><span style="color: #ff0000;"><br>              android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><span style="color: #ff0000;"><br>              android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"><br>              android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br>              android:padding</span><span style="color: #0000ff;">=â€15dpâ€</span><span style="color: #ff0000;"><br>              android:background</span><span style="color: #0000ff;">=â€#aabbccâ€</span><br>        <span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">TextView<br>            </span><span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/recycler_view_test_item_person_name_tvâ€</span><span style="color: #ff0000;"><br>            android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"><br>            android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br>            android:textSize</span><span style="color: #0000ff;">=â€18spâ€</span><span style="color: #ff0000;"><br>            android:background</span><span style="color: #0000ff;">=â€#ccbbaaâ€</span><br>            <span style="color: #0000ff;">/&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">TextView<br>            </span><span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/recycler_view_test_item_person_age_tvâ€</span><span style="color: #ff0000;"><br>            android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"><br>            android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br>            android:paddingLeft</span><span style="color: #0000ff;">=â€5dpâ€</span><span style="color: #ff0000;"><br>            android:background</span><span style="color: #0000ff;">=â€#aaccbbâ€</span><span style="color: #ff0000;"><br>            android:textSize</span><span style="color: #0000ff;">=â€15spâ€</span><br>            <span style="color: #0000ff;">/&gt;</span><br><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>itemçš„å¸ƒå±€å¾ˆç®€å•ï¼Œåªæœ‰ä¸¤ä¸ªTextViewï¼Œä¸€ä¸ªç”¨æ¥æ˜¾ç¤ºåå­—ï¼Œä¸€ä¸ªç”¨æ¥æ˜¾ç¤ºå¹´é¾„ã€‚</p>
<p>Personçš„å®ä½“ç±»å°±ä¸è´´ä»£ç äº†ï¼Œä¸¤ä¸ªå±æ€§ï¼šåå­—å’Œå¹´é¾„ã€‚</p>
<p>ç„¶åéœ€è¦ä½¿ç”¨åˆ°RecyclerViewï¼Œæ‰€ä»¥éœ€è¦æŠŠsupport v7æ·»åŠ åˆ°class pathï¼Œå¹¶åœ¨å¸ƒå±€ä¸­æ·»åŠ è¯¥æ§ä»¶ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">android.support.v7.widget.RecyclerView<br>                </span><span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/recycler_view_test_rvâ€</span><span style="color: #ff0000;"><br>                android:scrollbars</span><span style="color: #0000ff;">=â€verticalâ€</span><span style="color: #ff0000;"><br>                android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"><br>                android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"><br>                android:background</span><span style="color: #0000ff;">=â€#bbccaaâ€</span><br>                <span style="color: #0000ff;">/&gt;</span></pre><br></div>

<p>ç„¶ååœ¨onCreateä¸­ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span>         recyclerView.setHasFixedSize(<span style="color: #0000ff;">true</span><span style="color: #000000;">);<br></span><span style="color: #008080;">2</span><br><span style="color: #008080;">3</span>         RecyclerView.LayoutManager layoutManager = <span style="color: #0000ff;">new</span><span style="color: #000000;"> LinearLayoutManager(context);<br></span><span style="color: #008080;">4</span> <span style="color: #000000;">        recyclerView.setLayoutManager(layoutManager);<br></span><span style="color: #008080;">5</span><br><span style="color: #008080;">6</span> <span style="color: #000000;">        initData();<br></span><span style="color: #008080;">7</span>         adapter = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PersonAdapter(personList);<br></span><span style="color: #008080;">8</span>         adapter.setOnRecyclerViewListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">9</span>         recyclerView.setAdapter(adapter);    </pre><br></div>

<p>&nbsp;</p>
<p>å¦‚ä¸Šè¿°ä»£ç ï¼š</p>
<p>Line1: ä½¿RecyclerViewä¿æŒå›ºå®šçš„å¤§å°,è¿™æ ·ä¼šæé«˜RecyclerViewçš„æ€§èƒ½ã€‚</p>
<p>Line3: LinearLayoutManagerï¼Œå¦‚æœä½ éœ€è¦æ˜¾ç¤ºçš„æ˜¯æ¨ªå‘æ»šåŠ¨çš„åˆ—è¡¨æˆ–è€…ç«–ç›´æ»šåŠ¨çš„åˆ—è¡¨ï¼Œåˆ™ä½¿ç”¨è¿™ä¸ªLayoutManagerã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬è¦å®ç°çš„æ˜¯ListViewçš„æ•ˆæœï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å®ƒã€‚ç”Ÿæˆè¿™ä¸ªLinearLayoutManagerä¹‹åå¯ä»¥è®¾ç½®ä»–æ»šåŠ¨çš„æ–¹å‘ï¼Œé»˜è®¤ç«–ç›´æ»šåŠ¨ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰æ˜¾å¼åœ°è®¾ç½®ã€‚</p>
<p>Line6: åˆå§‹åŒ–æ•°æ®æºã€‚</p>
<p>Line7ï½9: è·ŸListViewä¸€æ ·ï¼Œéœ€è¦è®¾ç½®RecyclerViewçš„Adapterï¼Œä½†æ˜¯è¿™é‡Œçš„Adapterè·ŸListViewä½¿ç”¨çš„Adapterä¸ä¸€æ ·ï¼Œè¿™é‡Œçš„Adapteréœ€è¦ç»§æ‰¿RecyclerView.Adapterï¼Œéœ€è¦å®ç°3ä¸ªæ–¹æ³•ï¼š</p>
<p>-&nbsp;onCreateViewHolder()</p>
<p>-&nbsp;onBindViewHolder()</p>
<p>-&nbsp;getItemCount()</p>
<p>ç›´æ¥çœ‹ä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.helloandroid.sample.recycler.person;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v7.widget.RecyclerView;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.LayoutInflater;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.ViewGroup;<br></span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.LinearLayout;<br></span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.TextView;<br></span><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.log.Logger;<br></span><span style="color: #008080;">10</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.helloandroid.R;<br></span><span style="color: #008080;">11</span><br><span style="color: #008080;">12</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br></span><span style="color: #008080;">13</span><br><span style="color: #008080;">14</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">15</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;">16</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;">17</span> <span style="color: #008000;">  Date: 1/17/15.<br></span><span style="color: #008080;">18</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;">19</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> PersonAdapter <span style="color: #0000ff;">extends</span><span style="color: #000000;"> RecyclerView.Adapter {<br></span><span style="color: #008080;">20</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> OnRecyclerViewListener {<br></span><span style="color: #008080;">21</span>         <span style="color: #0000ff;">void</span> onItemClick(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position);<br></span><span style="color: #008080;">22</span>         <span style="color: #0000ff;">boolean</span> onItemLongClick(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position);<br></span><span style="color: #008080;">23</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> OnRecyclerViewListener onRecyclerViewListener;<br></span><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setOnRecyclerViewListener(OnRecyclerViewListener onRecyclerViewListener) {<br></span><span style="color: #008080;">28</span>         <span style="color: #0000ff;">this</span>.onRecyclerViewListener =<span style="color: #000000;"> onRecyclerViewListener;<br></span><span style="color: #008080;">29</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = PersonAdapter.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;">32</span>     <span style="color: #0000ff;">private</span> List&lt;Person&gt;<span style="color: #000000;"> list;<br></span><span style="color: #008080;">33</span><br><span style="color: #008080;">34</span>     <span style="color: #0000ff;">public</span> PersonAdapter(List&lt;Person&gt;<span style="color: #000000;"> list) {<br></span><span style="color: #008080;">35</span>         <span style="color: #0000ff;">this</span>.list =<span style="color: #000000;"> list;<br></span><span style="color: #008080;">36</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">37</span><br><span style="color: #008080;">38</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">39</span>     <span style="color: #0000ff;">public</span> RecyclerView.ViewHolder onCreateViewHolder(ViewGroup viewGroup, <span style="color: #0000ff;">int</span><span style="color: #000000;"> i) {<br></span><span style="color: #008080;">40</span>         Logger.d(TAG, â€œonCreateViewHolder, i: â€œ +<span style="color: #000000;"> i);<br></span><span style="color: #008080;">41</span>         View view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.recycler_view_test_item_person, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br></span><span style="color: #008080;">42</span>         LinearLayout.LayoutParams lp = <span style="color: #0000ff;">new</span><span style="color: #000000;"> LinearLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT);<br></span><span style="color: #008080;">43</span> <span style="color: #000000;">        view.setLayoutParams(lp);<br></span><span style="color: #008080;">44</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> PersonViewHolder(view);<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">48</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onBindViewHolder(RecyclerView.ViewHolder viewHolder, <span style="color: #0000ff;">int</span><span style="color: #000000;"> i) {<br></span><span style="color: #008080;">49</span>         Logger.d(TAG, â€œonBindViewHolder, i: â€œ + i + â€œ, viewHolder: â€œ +<span style="color: #000000;"> viewHolder);<br></span><span style="color: #008080;">50</span>         PersonViewHolder holder =<span style="color: #000000;"> (PersonViewHolder) viewHolder;<br></span><span style="color: #008080;">51</span>         holder.position =<span style="color: #000000;"> i;<br></span><span style="color: #008080;">52</span>         Person person =<span style="color: #000000;"> list.get(i);<br></span><span style="color: #008080;">53</span> <span style="color: #000000;">        holder.nameTv.setText(person.getName());<br></span><span style="color: #008080;">54</span>         holder.ageTv.setText(person.getAge() + â€œå²â€<span style="color: #000000;">);<br></span><span style="color: #008080;">55</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">56</span><br><span style="color: #008080;">57</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">58</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getItemCount() {<br></span><span style="color: #008080;">59</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> list.size();<br></span><span style="color: #008080;">60</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">61</span><br><span style="color: #008080;">62</span>     <span style="color: #0000ff;">class</span> PersonViewHolder <span style="color: #0000ff;">extends</span> RecyclerView.ViewHolder <span style="color: #0000ff;">implements</span><span style="color: #000000;"> View.OnClickListener, View.OnLongClickListener<br></span><span style="color: #008080;">63</span> <span style="color: #000000;">    {<br></span><span style="color: #008080;">64</span>         <span style="color: #0000ff;">public</span><span style="color: #000000;"> View rootView;<br></span><span style="color: #008080;">65</span>         <span style="color: #0000ff;">public</span><span style="color: #000000;"> TextView nameTv;<br></span><span style="color: #008080;">66</span>         <span style="color: #0000ff;">public</span><span style="color: #000000;"> TextView ageTv;<br></span><span style="color: #008080;">67</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> position;<br></span><span style="color: #008080;">68</span><br><span style="color: #008080;">69</span>         <span style="color: #0000ff;">public</span><span style="color: #000000;"> PersonViewHolder(View itemView) {<br></span><span style="color: #008080;">70</span>             <span style="color: #0000ff;">super</span><span style="color: #000000;">(itemView);<br></span><span style="color: #008080;">71</span>             nameTv =<span style="color: #000000;"> (TextView) itemView.findViewById(R.id.recycler_view_test_item_person_name_tv);<br></span><span style="color: #008080;">72</span>             ageTv =<span style="color: #000000;"> (TextView) itemView.findViewById(R.id.recycler_view_test_item_person_age_tv);<br></span><span style="color: #008080;">73</span>             rootView =<span style="color: #000000;"> itemView.findViewById(R.id.recycler_view_test_item_person_view);<br></span><span style="color: #008080;">74</span>             rootView.setOnClickListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">75</span>             rootView.setOnLongClickListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">76</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">77</span><br><span style="color: #008080;">78</span> <span style="color: #000000;">        @Override<br></span><span style="color: #008080;">79</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClick(View v) {<br></span><span style="color: #008080;">80</span>             <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> onRecyclerViewListener) {<br></span><span style="color: #008080;">81</span> <span style="color: #000000;">                onRecyclerViewListener.onItemClick(position);<br></span><span style="color: #008080;">82</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">83</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">84</span><br><span style="color: #008080;">85</span> <span style="color: #000000;">        @Override<br></span><span style="color: #008080;">86</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> onLongClick(View v) {<br></span><span style="color: #008080;">87</span>             <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> onRecyclerViewListener){<br></span><span style="color: #008080;">88</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;"> onRecyclerViewListener.onItemLongClick(position);<br></span><span style="color: #008080;">89</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">90</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">91</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">92</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">93</span><br><span style="color: #008080;">94</span> }</pre><br></div>

<p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼š</p>
<p>public RecyclerView.ViewHolder onCreateViewHolder(ViewGroup viewGroup, int i)</p>
<p>è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”Ÿæˆä¸ºæ¯ä¸ªItem inflaterå‡ºä¸€ä¸ªViewï¼Œä½†æ˜¯è¯¥æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªViewHolderã€‚æ–¹æ³•æ˜¯æŠŠViewç›´æ¥å°è£…åœ¨ViewHolderä¸­ï¼Œç„¶åæˆ‘ä»¬é¢å‘çš„æ˜¯ViewHolderè¿™ä¸ªå®ä¾‹ï¼Œå½“ç„¶è¿™ä¸ªViewHolderéœ€è¦æˆ‘ä»¬è‡ªå·±å»ç¼–å†™ã€‚ç›´æ¥çœå»äº†å½“åˆçš„convertView.setTag(holder)å’ŒconvertView.getTag()è¿™äº›ç¹ççš„æ­¥éª¤ã€‚</p>
<p>&nbsp;</p>
<p>public void onBindViewHolder(RecyclerView.ViewHolder viewHolder, int i)</p>
<p>è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºé€‚é…æ¸²æŸ“æ•°æ®åˆ°Viewä¸­ã€‚æ–¹æ³•æä¾›ç»™ä½ äº†ä¸€ä¸ªviewHolderï¼Œè€Œä¸æ˜¯åŸæ¥çš„convertViewã€‚</p>
<p>å¯¹æ¯”ä¸‹ä»¥å‰çš„å†™æ³•å°±ä¸€ç›®äº†ç„¶äº†ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">@Override<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">public</span> View getView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position, View convertView, ViewGroup parent) {<br></span><span style="color: #008080;"> 3</span> <span style="color: #000000;">        ViewHolder holder;<br></span><span style="color: #008080;"> 4</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> convertView){<br></span><span style="color: #008080;"> 5</span>             holder = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ViewHolder();<br></span><span style="color: #008080;"> 6</span>             LayoutInflater mInflater =<span style="color: #000000;"> (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);<br></span><span style="color: #008080;"> 7</span>             convertView = mInflater.inflate(R.layout.item, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 8</span>             holder.btn =<span style="color: #000000;"> (Button) convertView.findViewById(R.id.btn);<br></span><span style="color: #008080;"> 9</span>             holder.tv =<span style="color: #000000;"> (TextView) convertView.findViewById(R.id.tv);<br></span><span style="color: #008080;">10</span>             holder.iv =<span style="color: #000000;"> (TextView) convertView.findViewById(R.id.iv);<br></span><span style="color: #008080;">11</span><br><span style="color: #008080;">12</span> <span style="color: #000000;">            convertView.setTag(holder);<br></span><span style="color: #008080;">13</span>         }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;">14</span>             holder =<span style="color: #000000;"> (ViewHolder) convertView.getTag();<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">16</span>         <span style="color: #0000ff;">final</span> HashMap&lt;String, Object&gt; map =<span style="color: #000000;"> list.get(position);<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>         holder.iv.setImageResource(Integer.valueOf(map.get(â€œivâ€<span style="color: #000000;">).toString()));<br></span><span style="color: #008080;">19</span>         holder.tv.setText(map.get(â€œtvâ€<span style="color: #000000;">).toString());<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>         holder.btn.setOnClickListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> View.OnClickListener() {<br></span><span style="color: #008080;">22</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">23</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClick(View v) {<br></span><span style="color: #008080;">24</span>                 Toast.makeText(context, map.get(â€œbtnâ€<span style="color: #000000;">).toString(), Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">26</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">27</span><br><span style="color: #008080;">28</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> convertView;<br></span><span style="color: #008080;">29</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span>     <span style="color: #0000ff;">class</span><span style="color: #000000;"> ViewHolder{<br></span><span style="color: #008080;">32</span> <span style="color: #000000;">        Button btn;<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">        ImageView iv;<br></span><span style="color: #008080;">34</span> <span style="color: #000000;">        TextView tv;<br></span><span style="color: #008080;">35</span><br><span style="color: #008080;">36</span>     }</pre><br></div>

<p>å¯¹æ¯”åå¯ä»¥å‘ç°ï¼š</p>
<p>æ—§çš„å†™æ³•ä¸­Line5ï½Line12ï¼‹Line28éƒ¨åˆ†çš„ä»£ç å…¶å®èµ·åˆ°çš„ä½œç”¨ç›¸å½“äºæ–°çš„å†™æ³•çš„onCreateViewHolder()ï¼›</p>
<p>æ—§çš„å†™æ³•ä¸­Line14ï½Line26éƒ¨åˆ†çš„ä»£ç å…¶å®èµ·åˆ°çš„ä½œç”¨ç›¸å½“äºæ–°çš„å†™æ³•çš„onBindViewHolder()ï¼›</p>
<p>æ—¢ç„¶æ˜¯è¿™æ ·ï¼Œé‚£æˆ‘ä»¬å°±æŠŠåŸæ¥ç›¸åº”çš„ä»£ç æ¬åˆ°å¯¹åº”çš„onCreateViewHolder()å’ŒonBindViewHolder()è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­å°±å¯ä»¥äº†ã€‚</p>
<p>å› ä¸ºRecyclerViewå¸®æˆ‘ä»¬å°è£…äº†Holderï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå·±å†™çš„ViewHolderå°±éœ€è¦ç»§æ‰¿RecyclerView.ViewHolderï¼Œåªæœ‰è¿™æ ·ï¼ŒRecyclerViewæ‰èƒ½å¸®ä½ å»ç®¡ç†è¿™ä¸ªViewHolderç±»ã€‚</p>
<p>æ—¢ç„¶getViewæ–¹æ³•çš„æ¸²æŸ“æ•°æ®éƒ¨åˆ†çš„ä»£ç ç›¸å½“äºonBindViewHolder()ï¼Œæ‰€ä»¥å¦‚æœè°ƒç”¨adapter.notifyDataSetChanged()æ–¹æ³•ï¼Œåº”è¯¥ä¹Ÿä¼šé‡æ–°è°ƒç”¨onBindViewHolder()æ–¹æ³•æ‰å¯¹å§ï¼Ÿå®éªŒåï¼Œæœç„¶å¦‚æ­¤ï¼</p>
<p>é™¤äº†adapter.notifyDataSetChanged()è¿™ä¸ªæ–¹æ³•ä¹‹å¤–ï¼Œæ–°çš„Adapterè¿˜æä¾›äº†å…¶ä»–çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre>        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> notifyDataSetChanged()<br>        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">void</span> notifyItemChanged(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position)<br>        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">void</span> notifyItemRangeChanged(<span style="color: #0000ff;">int</span> positionStart, <span style="color: #0000ff;">int</span><span style="color: #000000;"> itemCount)<br>        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">void</span> notifyItemInserted(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position)<br>        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">void</span> notifyItemMoved(<span style="color: #0000ff;">int</span> fromPosition, <span style="color: #0000ff;">int</span><span style="color: #000000;"> toPosition)<br>        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">void</span> notifyItemRangeInserted(<span style="color: #0000ff;">int</span> positionStart, <span style="color: #0000ff;">int</span><span style="color: #000000;"> itemCount)<br>        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">void</span> notifyItemRemoved(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position)<br>        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">void</span> notifyItemRangeRemoved(<span style="color: #0000ff;">int</span> positionStart, <span style="color: #0000ff;">int</span> itemCount) </pre><br></div>

<p>åŸºæœ¬ä¸Šçœ‹åˆ°æ–¹æ³•çš„åå­—å°±çŸ¥é“è¿™ä¸ªæ–¹æ³•æ˜¯å¹²å˜›çš„äº†ï¼Œ</p>
<p>ç¬¬ä¸€ä¸ªæ–¹æ³•æ²¡ä»€ä¹ˆå¥½è®²çš„ï¼Œè·Ÿä»¥å‰ä¸€æ ·ã€‚</p>
<p>notifyItemChanged(int position)ï¼Œpositionæ•°æ®å‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå°±ä¼šå›è°ƒå¯¹åº”positionçš„onBindViewHolder()æ–¹æ³•äº†ï¼Œå½“ç„¶ï¼Œå› ä¸ºViewHolderæ˜¯å¤ç”¨çš„ï¼Œæ‰€ä»¥å¦‚æœpositionåœ¨å½“å‰å±å¹•ä»¥å¤–ï¼Œä¹Ÿå°±ä¸ä¼šå›è°ƒäº†ï¼Œå› ä¸ºæ²¡æœ‰æ„ä¹‰ï¼Œä¸‹æ¬¡positionæ»šåŠ¨ä¼šå½“å‰å±å¹•ä»¥å†…çš„æ—¶å€™åŒæ ·ä¼šè°ƒç”¨onBindViewHolder()æ–¹æ³•åˆ·æ–°æ•°æ®äº†ã€‚å…¶ä»–çš„æ–¹æ³•ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ã€‚</p>
<p>public final void notifyItemRangeChanged(int positionStart, int itemCount)ï¼Œé¡¾åæ€ä¹‰ï¼Œå¯ä»¥åˆ·æ–°ä»positionStartå¼€å§‹itemCountæ•°é‡çš„itemäº†ï¼ˆè¿™é‡Œçš„åˆ·æ–°æŒ‡å›è°ƒonBindViewHolder()æ–¹æ³•ï¼‰ã€‚</p>
<p>public final void notifyItemInserted(int position)ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ç¬¬positionä½ç½®è¢«æ’å…¥äº†ä¸€æ¡æ•°æ®çš„æ—¶å€™å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•åˆ·æ–°ï¼Œæ³¨æ„è¿™ä¸ªæ–¹æ³•è°ƒç”¨åä¼šæœ‰æ’å…¥çš„åŠ¨ç”»ï¼Œè¿™ä¸ªåŠ¨ç”»å¯ä»¥ä½¿ç”¨é»˜è®¤çš„ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰ã€‚</p>
<p>public final void notifyItemMoved(int fromPosition, int toPosition)ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ä»fromPositionç§»åŠ¨åˆ°toPositionä¸ºæ­¢çš„æ—¶å€™å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•åˆ·æ–°</p>
<p>public final void notifyItemRangeInserted(int positionStart, int itemCount)ï¼Œæ˜¾ç„¶æ˜¯æ‰¹é‡æ·»åŠ ã€‚</p>
<p>public final void notifyItemRemoved(int position)ï¼Œç¬¬positionä¸ªè¢«åˆ é™¤çš„æ—¶å€™åˆ·æ–°ï¼ŒåŒæ ·ä¼šæœ‰åŠ¨ç”»ã€‚</p>
<p>public final void notifyItemRangeRemoved(int positionStart, int itemCount)ï¼Œæ‰¹é‡åˆ é™¤ã€‚</p>
<p>&nbsp;</p>
<p>è¿™äº›æ–¹æ³•åˆ†æå®Œä¹‹åï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼Œæ–°å¢ä¸€æ¡æ•°æ®ï¼Œé•¿æŒ‰ä¸€ä¸ªitemï¼Œåˆ é™¤ä¸€æ¡æ•°æ®çš„åœºæ™¯ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ–°å¢ä¸€æ¡æ•°æ®çš„ä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> Person person = <span style="color: #0000ff;">new</span> Person(i, â€œWangJie_â€ + i, 10 +<span style="color: #000000;"> i);<br></span><span style="color: #008080;">2</span> adapter.notifyItemInserted(2<span style="color: #000000;">);<br></span><span style="color: #008080;">3</span> personList.add(2<span style="color: #000000;">, person);<br></span><span style="color: #008080;">4</span> adapter.notifyItemRangeChanged(2, adapter.getItemCount());</pre><br></div>

<p>å¦‚ä¸Šä»£ç ï¼š</p>
<p>Line2ï¼šè¡¨ç¤ºåœ¨positionä¸º2çš„ä½ç½®ï¼Œæ’å…¥ä¸€æ¡æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™åŠ¨ç”»å¼€å§‹æ‰§è¡Œã€‚</p>
<p>Line3: è¡¨ç¤ºåœ¨æ•°æ®æºä¸­positionä¸º2çš„ä½ç½®æ–°å¢ä¸€æ¡æ•°æ®ï¼ˆå…¶å®è¿™ä¸ªæ‰æ˜¯çœŸæ­£çš„æ–°å¢æ•°æ®å•¦ï¼‰ã€‚</p>
<p>Line4: ä¸ºä»€ä¹ˆè¦åˆ·æ–°positionä¸º2ä»¥åçš„æ•°æ®å‘¢ï¼Ÿå› ä¸ºï¼Œåœ¨positionä¸º2çš„ä½ç½®æ’å…¥äº†ä¸€æ¡æ•°æ®åï¼Œæ–°æ•°æ®çš„positionå˜æˆäº†2ï¼Œé‚£åŸæ¥çš„positionä¸º2çš„åº”è¯¥å˜æˆäº†3ï¼Œ3çš„åº”è¯¥å˜æˆäº†4ï¼Œæ‰€ä»¥2ä»¥åçš„æ‰€æœ‰æ•°æ®çš„positionéƒ½å‘ç”Ÿäº†æ”¹å˜ï¼Œæ‰€ä»¥éœ€è¦æŠŠposition2ä»¥åçš„æ•°æ®éƒ½è¦åˆ·æ–°ã€‚ç†è®ºä¸Šæ˜¯è¿™æ ·ï¼Œä½†æ˜¯å®é™…ä¸Šåˆ·æ–°çš„æ•°é‡åªæœ‰åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„positionä¸º2ä»¥åçš„æ•°æ®è€Œå·²ã€‚å¦‚æœè¿™é‡Œä½¿ç”¨notifyDataSetChanged()æ¥åˆ·æ–°å±å¹•ä¸Šæ˜¾ç¤ºçš„æ‰€æœ‰itemå¯ä»¥å—ï¼Ÿç»“æœä¸ä¼šå‡ºé”™ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå‰é¢è°ƒç”¨äº†notifyItemInserted()æ–¹æ³•åä¼šåœ¨æ‰§è¡ŒåŠ¨ç”»ï¼Œå¦‚æœä½ è°ƒç”¨notifyDataSetChanged()åˆ·æ–°å±å¹•ä¸Šæ˜¾ç¤ºçš„æ‰€æœ‰itemçš„è¯ï¼Œå¿…ç„¶ä¹Ÿä¼šåˆ·æ–°å½“å‰æ­£åœ¨æ‰§è¡ŒåŠ¨ç”»çš„é‚£ä¸ªitemï¼Œè¿™æ ·å¯¼è‡´çš„ç»“æœæ˜¯ï¼Œå‰é¢çš„åŠ¨ç”»è¿˜æ²¡æ‰§è¡Œå®Œï¼Œå®ƒé©¬ä¸Šåˆè¢«åˆ·æ–°äº†ï¼ŒåŠ¨ç”»å°±çœ‹ä¸è§äº†ã€‚æ‰€ä»¥åªè¦åˆ·æ–°2ä»¥åçš„itemå°±å¯ä»¥äº†ã€‚</p>
<p>&nbsp;</p>
<p>çœ‹äº†RecyclerViewçš„apiï¼Œå‘ç°æ²¡æœ‰setOnItemClickListenerï¼ï¼ï¼Œæ‰€ä»¥è¿˜æ˜¯è‡ªå·±æŠŠonItemClickä»Adapterä¸­å›è°ƒå‡ºæ¥å§ã€‚è¿™ä¸ªå¾ˆç®€å•ï¼Œå°±åƒä¸Šé¢PersonAdaperä¸­å†™çš„OnRecyclerViewListeneré‚£æ ·ã€‚</p>
<p>&nbsp;</p>
<p>é•¿æŒ‰åˆ é™¤çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #000000;">adapter.notifyItemRemoved(position);<br></span><span style="color: #008080;">2</span> <span style="color: #000000;">personList.remove(position);<br></span><span style="color: #008080;">3</span> adapter.notifyItemRangeChanged(position, adapter.getItemCount());</pre><br></div>

<p>ä»£ç è·Ÿä¹‹å‰æ’å…¥çš„ä»£ç åŸºæœ¬ä¸€è‡´ã€‚å…ˆé€šçŸ¥æ‰§è¡ŒåŠ¨ç”»ï¼Œç„¶ååˆ é™¤æ•°æ®æºä¸­çš„æ•°æ®ï¼Œç„¶åé€šçŸ¥positionä¹‹åçš„æ•°æ®åˆ·æ–°å°±å¯ä»¥äº†ã€‚</p>
<p>è¿™æ ·ListViewçš„æ•ˆæœå°±å®ç°äº†ã€‚</p>
<p>&nbsp;</p>
<p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>
<p><strong><a href="https://github.com/wangjiegulu/RecyclerViewSample" target="_blank" rel="noopener">https://github.com/wangjiegulu/RecyclerViewSample</a></strong></p>
<p>&nbsp;</p>
<p><span style="font-size: 16px; color: #ff0000;"><strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4242541.html" target="_blank" rel="noopener"><span style="color: #ff0000;">[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆäºŒï¼‰</span></a></strong>ï¼š</span></p>
<p><span style="font-size: 16px; color: #0000ff;"><strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4242541.html" target="_blank" rel="noopener"><span style="color: #0000ff;">http://www.cnblogs.com/tiantianbyconan/p/4242541.html</span></a></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;"><span style="font-size: 16px;"><strong><a href="http://www.cnblogs.com/tiantianbyconan/p/4242541.html" target="_blank" rel="noopener"><span style="color: #ff0000;">[Android]ä½¿ç”¨RecyclerViewæ›¿ä»£ListViewï¼ˆä¸‰ï¼‰</span></a></strong>ï¼š</span>&nbsp;</span></p>
<p><span style="color: #0000ff;"><a href="http://www.cnblogs.com/tiantianbyconan/p/4268097.html" target="_blank" rel="noopener"><span style="color: #0000ff;"><span style="font-size: 16px; line-height: 24px;"><strong><span style="text-decoration: underline;">http://www.cnblogs.com/tiantianbyconan/p/4268097.html</span></strong></span></span></a></span></p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> RecyclerView </tag>
            
            <tag> ListView </tag>
            
            <tag> best practices </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä»¿æ–°ç‰ˆQQçš„tabä¸‹é¢æ‹–æ‹½æ ‡è®°ä¸ºå·²è¯»çš„æ•ˆæœ]]></title>
      <url>/2014/12/24/Android-%E4%BB%BF%E6%96%B0%E7%89%88QQ%E7%9A%84tab%E4%B8%8B%E9%9D%A2%E6%8B%96%E6%8B%BD%E6%A0%87%E8%AE%B0%E4%B8%BA%E5%B7%B2%E8%AF%BB%E7%9A%84%E6%95%88%E6%9E%9C/</url>
      <content type="html"><![CDATA[<p>å¯æ‹–æ‹½çš„çº¢ç‚¹ï¼Œï¼ˆä»¿æ–°ç‰ˆQQï¼Œtabä¸‹é¢æ‹–æ‹½æ ‡è®°ä¸ºå·²è¯»çš„æ•ˆæœï¼‰ï¼Œæ‹–æ‹½ä¸€å®šçš„è·ç¦»å¯ä»¥æ¶ˆå¤±å›è°ƒã€‚</p>
<p><img src="https://raw.githubusercontent.com/wangjiegulu/DraggableFlagView/master/screenshot/draggableflagview.gif" alt=""></p>
<p>&nbsp;<img src="https://raw.githubusercontent.com/wangjiegulu/DraggableFlagView/master/screenshot/draggableflagview_b.png" alt=""><span style="line-height: 1.5;">&nbsp;</span><img src="https://raw.githubusercontent.com/wangjiegulu/DraggableFlagView/master/screenshot/draggableflagview_d.png" alt=""></p>
<p>&nbsp;</p>
<p><strong>GitHubï¼š<a href="https://github.com/wangjiegulu/DraggableFlagView" target="_blank" rel="noopener">DraggableFlagView</a>ï¼ˆ<a href="https://github.com/wangjiegulu/DraggableFlagView" target="_blank" rel="noopener">https://github.com/wangjiegulu/DraggableFlagView</a>ï¼‰</strong></p>
<p>å®ç°åŸç†ï¼š</p>
<p>å½“æ ¹æ®touchäº‹ä»¶çš„ç§»åŠ¨ï¼Œä¸æ–­è°ƒç”¨onDraw()æ–¹æ³•è¿›è¡Œåˆ·æ–°ç»˜åˆ¶ã€‚</p>
<p><span style="color: #ff0000;">*æ³¨æ„ï¼šè¿™é‡ŒåŸæ¥çš„å°çº¢ç‚¹ç§°ä¸ºçº¢ç‚¹Aï¼›æ ¹æ®æ‰‹æŒ‡ç§»åŠ¨ç»˜åˆ¶çš„å°çº¢ç‚¹ç§°ä¸ºçº¢ç‚¹Bã€‚</span></p>
<p>touchäº‹ä»¶ç§»åŠ¨çš„æ—¶å€™éœ€è¦å¤„ç†çš„é€»è¾‘ï¼š</p>
<p>1. <span style="color: #000000;">çº¢ç‚¹Açš„åŠå¾„æ ¹æ®æ»‘åŠ¨çš„è·ç¦»ä¼šä¸æ–­åœ°å˜å°ã€‚</span></p>
<p><span style="color: #000000;">2. çº¢ç‚¹Bä¼šç´§éšæ‰‹æŒ‡çš„ä½ç½®ç§»åŠ¨ã€‚</span></p>
<p><span style="color: #000000;">3. åœ¨çº¢ç‚¹Aå’Œçº¢ç‚¹Bä¹‹é—´éœ€è¦ç”¨è´å¡å°”æ›²çº¿ç»˜åˆ¶è¿æ¥åŒºåŸŸã€‚</span></p>
<p><span style="color: #000000;">4. å¦‚æœçº¢ç‚¹Aå’Œçº¢ç‚¹Bä¹‹é—´çš„é—´è·è¾¾åˆ°äº†è®¾ç½®çš„æœ€å¤§çš„è·ç¦»ï¼Œåˆ™è¡¨ç¤ºï¼Œè¿™æ¬¡çš„æ‹–æ‹½ä¼šæœ‰æ•ˆï¼Œä¸€æ—¦æ”¾æ‰‹çº¢ç‚¹å°±ä¼šæ¶ˆå¤±ã€‚</span></p>
<p><span style="color: #000000;">5. å¦‚æœè¾¾åˆ°äº†ç¬¬4ä¸­æƒ…å†µï¼Œåˆ™çº¢ç‚¹Aå’Œä¸­é—´è¿æ¥çš„è´å¡å°”æ›²çº¿ä¸ä¼šè¢«ç»˜åˆ¶ã€‚</span></p>
<p><span style="color: #000000;">6. å¦‚æœçº¢ç‚¹Aå’Œçº¢ç‚¹Bä¹‹é—´çš„è·ç¦»æ²¡æœ‰è¾¾åˆ°è®¾ç½®çš„æœ€å¤§çš„è·ç¦»ï¼Œåˆ™æ”¾æ‰‹åï¼Œçº¢ç‚¹Bæ¶ˆå¤±ï¼Œçº¢ç‚¹Aä»åŸæ¥å˜å°çš„åŠå¾„ä½¿ç”¨åå¼¹åŠ¨ç”»å˜æ¢åˆ°åŸæ¥æœ€åˆçš„çŠ¶æ€</span></p>
<p>ä¸€äº›å·¥å…·ç±»éœ€è¦ä¾èµ–&nbsp;<strong><a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">AndroidBucket</a>(<a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket</a>)ï¼Œnineoldandroid</strong></p>
<p><span style="font-size: 16px;"><strong><span style="color: #000000;">ä½¿ç”¨æ–¹å¼ï¼š</span></strong></span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">com.wangjie.draggableflagview.DraggableFlagView<br>ã€€ã€€ã€€ã€€ã€€ã€€ã€€</span><span style="color: #ff0000;">xmlns:dfv</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/com.wangjie.draggableflagview" target="_blank" rel="noopener">http://schemas.android.com/apk/res/com.wangjie.draggableflagview</a>â€œ</span><span style="color: #ff0000;"><br>            android:id</span><span style="color: #0000ff;">=â€@+id/main_dfvâ€</span><span style="color: #ff0000;"><br>            android:layout_width</span><span style="color: #0000ff;">=â€20dpâ€</span><span style="color: #ff0000;"><br>            android:layout_height</span><span style="color: #0000ff;">=â€20dpâ€</span><span style="color: #ff0000;"><br>            android:layout_alignParentBottom</span><span style="color: #0000ff;">=â€trueâ€</span><span style="color: #ff0000;"><br>            android:layout_margin</span><span style="color: #0000ff;">=â€15dpâ€</span><span style="color: #ff0000;"><br>            dfv:color</span><span style="color: #0000ff;">=â€#FF3B30â€</span><br>            <span style="color: #0000ff;">/&gt;</span></pre><br></div>

<p>&nbsp;</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span> Activity <span style="color: #0000ff;">implements</span><span style="color: #000000;"> DraggableFlagView.OnDraggableFlagViewListener, View.OnClickListener {<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br></span><span style="color: #008080;"> 5</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">        setContentView(R.layout.main);<br></span><span style="color: #008080;"> 7</span>         findViewById(R.id.main_btn).setOnClickListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span>         DraggableFlagView draggableFlagView =<span style="color: #000000;"> (DraggableFlagView) findViewById(R.id.main_dfv);<br></span><span style="color: #008080;">10</span>         draggableFlagView.setOnDraggableFlagViewListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">11</span>         draggableFlagView.setText(â€œ7â€<span style="color: #000000;">);<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">13</span><br><span style="color: #008080;">14</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">15</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onFlagDismiss(DraggableFlagView view) {<br></span><span style="color: #008080;">16</span>         Toast.makeText(<span style="color: #0000ff;">this</span>, â€œonFlagDismissâ€<span style="color: #000000;">, Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">20</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClick(View v) {<br></span><span style="color: #008080;">21</span>         <span style="color: #0000ff;">switch</span><span style="color: #000000;"> (v.getId()) {<br></span><span style="color: #008080;">22</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.main_btn:<br></span><span style="color: #008080;">23</span>                 Toast.makeText(<span style="color: #0000ff;">this</span>, â€œhello worldâ€<span style="color: #000000;">, Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">24</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">26</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">27</span> }</pre><br></div>

<p><span style="font-size: 16px;"><strong>DraggableFlagViewä»£ç ï¼š</strong></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">  1</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">  2</span> <span style="color: #008000;"> <em> Author: wangjie<br></em></span><span style="color: #008080;">  3</span> <span style="color: #008000;">  Email: tiantian.china.2@gmail.com<br></span><span style="color: #008080;">  4</span> <span style="color: #008000;"> <em> Date: 12/23/14.<br></em></span><span style="color: #008080;">  5</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;">  6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> DraggableFlagView <span style="color: #0000ff;">extends</span><span style="color: #000000;"> View {<br></span><span style="color: #008080;">  7</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = DraggableFlagView.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;">  8</span><br><span style="color: #008080;">  9</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> OnDraggableFlagViewListener {<br></span><span style="color: #008080;"> 10</span>         <span style="color: #008000;">/</span><br><span style="color: #008080;"> 11</span> <span style="color: #008000;">         <em> æ‹–æ‹½é”€æ¯åœ†ç‚¹åçš„å›è°ƒ<br></em></span><span style="color: #008080;"> 12</span> <span style="color: #008000;">         <br></span><span style="color: #008080;"> 13</span> <span style="color: #008000;">         <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> view<br></span><span style="color: #008080;"> 14</span>          <span style="color: #008000;">/</span><br><span style="color: #008080;"> 15</span>         <span style="color: #0000ff;">void</span><span style="color: #000000;"> onFlagDismiss(DraggableFlagView view);<br></span><span style="color: #008080;"> 16</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 17</span><br><span style="color: #008080;"> 18</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> OnDraggableFlagViewListener onDraggableFlagViewListener;<br></span><span style="color: #008080;"> 19</span><br><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setOnDraggableFlagViewListener(OnDraggableFlagViewListener onDraggableFlagViewListener) {<br></span><span style="color: #008080;"> 21</span>         <span style="color: #0000ff;">this</span>.onDraggableFlagViewListener =<span style="color: #000000;"> onDraggableFlagViewListener;<br></span><span style="color: #008080;"> 22</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 23</span><br><span style="color: #008080;"> 24</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> DraggableFlagView(Context context) {<br></span><span style="color: #008080;"> 25</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context);<br></span><span style="color: #008080;"> 26</span> <span style="color: #000000;">        init(context);<br></span><span style="color: #008080;"> 27</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 28</span><br><span style="color: #008080;"> 29</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> patientColor =<span style="color: #000000;"> Color.RED;<br></span><span style="color: #008080;"> 30</span><br><span style="color: #008080;"> 31</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> DraggableFlagView(Context context, AttributeSet attrs) {<br></span><span style="color: #008080;"> 32</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, attrs);<br></span><span style="color: #008080;"> 33</span>         TypedArray a =<span style="color: #000000;"> context.obtainStyledAttributes(attrs, R.styleable.DraggableFlagView);<br></span><span style="color: #008080;"> 34</span>         <span style="color: #0000ff;">int</span> indexCount =<span style="color: #000000;"> a.getIndexCount();<br></span><span style="color: #008080;"> 35</span>         <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 0; i &lt; indexCount; i++<span style="color: #000000;">) {<br></span><span style="color: #008080;"> 36</span>             <span style="color: #0000ff;">int</span> attrIndex =<span style="color: #000000;"> a.getIndex(i);<br></span><span style="color: #008080;"> 37</span>             <span style="color: #0000ff;">if</span> (attrIndex ==<span style="color: #000000;"> R.styleable.DraggableFlagView_color) {<br></span><span style="color: #008080;"> 38</span>                 patientColor =<span style="color: #000000;"> a.getColor(attrIndex, Color.RED);<br></span><span style="color: #008080;"> 39</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 40</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 41</span> <span style="color: #000000;">        a.recycle();<br></span><span style="color: #008080;"> 42</span> <span style="color: #000000;">        init(context);<br></span><span style="color: #008080;"> 43</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 44</span><br><span style="color: #008080;"> 45</span>     <span style="color: #0000ff;">public</span> DraggableFlagView(Context context, AttributeSet attrs, <span style="color: #0000ff;">int</span><span style="color: #000000;"> defStyle) {<br></span><span style="color: #008080;"> 46</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, attrs, defStyle);<br></span><span style="color: #008080;"> 47</span> <span style="color: #000000;">        init(context);<br></span><span style="color: #008080;"> 48</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 49</span><br><span style="color: #008080;"> 50</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Context context;<br></span><span style="color: #008080;"> 51</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> originRadius; <span style="color: #008000;">//</span><span style="color: #008000;"> åˆå§‹çš„åœ†çš„åŠå¾„</span><br><span style="color: #008080;"> 52</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> originWidth;<br></span><span style="color: #008080;"> 53</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> originHeight;<br></span><span style="color: #008080;"> 54</span><br><span style="color: #008080;"> 55</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> maxMoveLength; <span style="color: #008000;">//</span><span style="color: #008000;"> æœ€å¤§çš„ç§»åŠ¨æ‹‰é•¿è·ç¦»</span><br><span style="color: #008080;"> 56</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isArrivedMaxMoved; <span style="color: #008000;">//</span><span style="color: #008000;"> è¾¾åˆ°äº†æœ€å¤§çš„æ‹‰é•¿è·ç¦»ï¼ˆæ¾æ‰‹å¯ä»¥è§¦å‘äº‹ä»¶ï¼‰</span><br><span style="color: #008080;"> 57</span><br><span style="color: #008080;"> 58</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> curRadius; <span style="color: #008000;">//</span><span style="color: #008000;"> å½“å‰ç‚¹çš„åŠå¾„</span><br><span style="color: #008080;"> 59</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> touchedPointRadius; <span style="color: #008000;">//</span><span style="color: #008000;"> touchçš„åœ†çš„åŠå¾„</span><br><span style="color: #008080;"> 60</span>     <span style="color: #0000ff;">private</span> Point startPoint = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Point();<br></span><span style="color: #008080;"> 61</span>     <span style="color: #0000ff;">private</span> Point endPoint = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Point();<br></span><span style="color: #008080;"> 62</span><br><span style="color: #008080;"> 63</span>     <span style="color: #0000ff;">private</span> Paint paint; <span style="color: #008000;">//</span><span style="color: #008000;"> ç»˜åˆ¶åœ†å½¢å›¾å½¢</span><br><span style="color: #008080;"> 64</span>     <span style="color: #0000ff;">private</span> Paint textPaint; <span style="color: #008000;">//</span><span style="color: #008000;"> ç»˜åˆ¶åœ†å½¢å›¾å½¢</span><br><span style="color: #008080;"> 65</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Paint.FontMetrics textFontMetrics;<br></span><span style="color: #008080;"> 66</span><br><span style="color: #008080;"> 67</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;">[] location;<br></span><span style="color: #008080;"> 68</span><br><span style="color: #008080;"> 69</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isTouched; <span style="color: #008000;">//</span><span style="color: #008000;"> æ˜¯å¦æ˜¯è§¦æ‘¸çŠ¶æ€</span><br><span style="color: #008080;"> 70</span><br><span style="color: #008080;"> 71</span>     <span style="color: #0000ff;">private</span> Triangle triangle = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Triangle();<br></span><span style="color: #008080;"> 72</span><br><span style="color: #008080;"> 73</span>     <span style="color: #0000ff;">private</span> String text = â€œâ€; <span style="color: #008000;">//</span><span style="color: #008000;"> æ­£å¸¸çŠ¶æ€ä¸‹æ˜¾ç¤ºçš„æ–‡å­—</span><br><span style="color: #008080;"> 74</span><br><span style="color: #008080;"> 75</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> init(Context context) {<br></span><span style="color: #008080;"> 76</span>         <span style="color: #0000ff;">this</span>.context =<span style="color: #000000;"> context;<br></span><span style="color: #008080;"> 77</span><br><span style="color: #008080;"> 78</span> <span style="color: #000000;">        setBackgroundColor(Color.TRANSPARENT);<br></span><span style="color: #008080;"> 79</span><br><span style="color: #008080;"> 80</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®ç»˜åˆ¶flagçš„paint</span><br><span style="color: #008080;"> 81</span>         paint = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Paint();<br></span><span style="color: #008080;"> 82</span> <span style="color: #000000;">        paint.setColor(patientColor);<br></span><span style="color: #008080;"> 83</span>         paint.setAntiAlias(<span style="color: #0000ff;">true</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 84</span><br><span style="color: #008080;"> 85</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®ç»˜åˆ¶æ–‡å­—çš„paint</span><br><span style="color: #008080;"> 86</span>         textPaint = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Paint();<br></span><span style="color: #008080;"> 87</span>         textPaint.setAntiAlias(<span style="color: #0000ff;">true</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 88</span> <span style="color: #000000;">        textPaint.setColor(Color.WHITE);<br></span><span style="color: #008080;"> 89</span>         textPaint.setTextSize(ABTextUtil.sp2px(context, 12<span style="color: #000000;">));<br></span><span style="color: #008080;"> 90</span> <span style="color: #000000;">        textPaint.setTextAlign(Paint.Align.CENTER);<br></span><span style="color: #008080;"> 91</span>         textFontMetrics =<span style="color: #000000;"> paint.getFontMetrics();<br></span><span style="color: #008080;"> 92</span><br><span style="color: #008080;"> 93</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 94</span><br><span style="color: #008080;"> 95</span>     RelativeLayout.LayoutParams originLp; <span style="color: #008000;">//</span><span style="color: #008000;"> å®é™…çš„layoutparams</span><br><span style="color: #008080;"> 96</span>     RelativeLayout.LayoutParams newLp; <span style="color: #008000;">//</span><span style="color: #008000;"> è§¦æ‘¸æ—¶å€™çš„LayoutParams</span><br><span style="color: #008080;"> 97</span><br><span style="color: #008080;"> 98</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isFirst = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 99</span><br><span style="color: #008080;">100</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">101</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> onSizeChanged(<span style="color: #0000ff;">int</span> w, <span style="color: #0000ff;">int</span> h, <span style="color: #0000ff;">int</span> oldw, <span style="color: #0000ff;">int</span><span style="color: #000000;"> oldh) {<br></span><span style="color: #008080;">102</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onSizeChanged(w, h, oldw, oldh);<br></span><span style="color: #008080;">103</span> <span style="color: #008000;">//</span><span style="color: #008000;">        Logger.d(TAG, String.format(â€œonSizeChanged, w: %s, h: %s, oldw: %s, oldh: %sâ€, w, h, oldw, oldh));</span><br><span style="color: #008080;">104</span>         <span style="color: #0000ff;">if</span> (isFirst &amp;&amp; w &gt; 0 &amp;&amp; h &gt; 0<span style="color: #000000;">) {<br></span><span style="color: #008080;">105</span>             isFirst = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">106</span><br><span style="color: #008080;">107</span>             originWidth =<span style="color: #000000;"> w;<br></span><span style="color: #008080;">108</span>             originHeight =<span style="color: #000000;"> h;<br></span><span style="color: #008080;">109</span><br><span style="color: #008080;">110</span>             originRadius = Math.min(originWidth, originHeight) / 2<span style="color: #000000;">;<br></span><span style="color: #008080;">111</span>             curRadius =<span style="color: #000000;"> originRadius;<br></span><span style="color: #008080;">112</span>             touchedPointRadius =<span style="color: #000000;"> originRadius;<br></span><span style="color: #008080;">113</span><br><span style="color: #008080;">114</span>             maxMoveLength = ABAppUtil.getDeviceHeight(context) / 6<span style="color: #000000;">;<br></span><span style="color: #008080;">115</span><br><span style="color: #008080;">116</span> <span style="color: #000000;">            refreshStartPoint();<br></span><span style="color: #008080;">117</span><br><span style="color: #008080;">118</span>             ViewGroup.LayoutParams lp = <span style="color: #0000ff;">this</span><span style="color: #000000;">.getLayoutParams();<br></span><span style="color: #008080;">119</span>             <span style="color: #0000ff;">if</span> (RelativeLayout.LayoutParams.<span style="color: #0000ff;">class</span><span style="color: #000000;">.isAssignableFrom(lp.getClass())) {<br></span><span style="color: #008080;">120</span>                 originLp =<span style="color: #000000;"> (RelativeLayout.LayoutParams) lp;<br></span><span style="color: #008080;">121</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">122</span>             newLp = <span style="color: #0000ff;">new</span><span style="color: #000000;"> RelativeLayout.LayoutParams(lp.width, lp.height);<br></span><span style="color: #008080;">123</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">124</span><br><span style="color: #008080;">125</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">126</span><br><span style="color: #008080;">127</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">128</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setLayoutParams(ViewGroup.LayoutParams params) {<br></span><span style="color: #008080;">129</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.setLayoutParams(params);<br></span><span style="color: #008080;">130</span> <span style="color: #000000;">        refreshStartPoint();<br></span><span style="color: #008080;">131</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">132</span><br><span style="color: #008080;">133</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">134</span> <span style="color: #008000;">     <em> ä¿®æ”¹layoutParamsåï¼Œéœ€è¦é‡æ–°è®¾ç½®startPoint<br></em></span><span style="color: #008080;">135</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">136</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> refreshStartPoint() {<br></span><span style="color: #008080;">137</span>         location = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">int</span>[2<span style="color: #000000;">];<br></span><span style="color: #008080;">138</span>         <span style="color: #0000ff;">this</span><span style="color: #000000;">.getLocationInWindow(location);<br></span><span style="color: #008080;">139</span> <span style="color: #008000;">//</span><span style="color: #008000;">        Logger.d(TAG, â€œlocation on screen: â€œ + Arrays.toString(location));<br></span><span style="color: #008080;">140</span> <span style="color: #008000;">//</span><span style="color: #008000;">            startPoint.set(location[0], location[1] + h);</span><br><span style="color: #008080;">141</span>         <span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">142</span>             location[1] = location[1] -<span style="color: #000000;"> ABAppUtil.getTopBarHeight((Activity) context);<br></span><span style="color: #008080;">143</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception ex) {<br></span><span style="color: #008080;">144</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">145</span><br><span style="color: #008080;">146</span>         startPoint.set(location[0], location[1] +<span style="color: #000000;"> getMeasuredHeight());<br></span><span style="color: #008080;">147</span> <span style="color: #008000;">//</span><span style="color: #008000;">        Logger.d(TAG, â€œstartPoint: â€œ + startPoint);</span><br><span style="color: #008080;">148</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">149</span><br><span style="color: #008080;">150</span>     Path path = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Path();<br></span><span style="color: #008080;">151</span><br><span style="color: #008080;">152</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">153</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDraw(Canvas canvas) {<br></span><span style="color: #008080;">154</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onDraw(canvas);<br></span><span style="color: #008080;">155</span> <span style="color: #000000;">        canvas.drawColor(Color.TRANSPARENT);<br></span><span style="color: #008080;">156</span><br><span style="color: #008080;">157</span>         <span style="color: #0000ff;">int</span> startCircleX = 0, startCircleY = 0<span style="color: #000000;">;<br></span><span style="color: #008080;">158</span>         <span style="color: #0000ff;">if</span> (isTouched) { <span style="color: #008000;">//</span><span style="color: #008000;"> è§¦æ‘¸çŠ¶æ€</span><br><span style="color: #008080;">159</span><br><span style="color: #008080;">160</span>             startCircleX = startPoint.x +<span style="color: #000000;"> curRadius;<br></span><span style="color: #008080;">161</span>             startCircleY = startPoint.y -<span style="color: #000000;"> curRadius;<br></span><span style="color: #008080;">162</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> ç»˜åˆ¶åŸæ¥çš„åœ†å½¢ï¼ˆè§¦æ‘¸ç§»åŠ¨çš„æ—¶å€™åŠå¾„ä¼šä¸æ–­å˜åŒ–ï¼‰</span><br><span style="color: #008080;">163</span> <span style="color: #000000;">            canvas.drawCircle(startCircleX, startCircleY, curRadius, paint);<br></span><span style="color: #008080;">164</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> ç»˜åˆ¶æ‰‹æŒ‡è·Ÿè¸ªçš„åœ†å½¢</span><br><span style="color: #008080;">165</span>             <span style="color: #0000ff;">int</span> endCircleX =<span style="color: #000000;"> endPoint.x;<br></span><span style="color: #008080;">166</span>             <span style="color: #0000ff;">int</span> endCircleY =<span style="color: #000000;"> endPoint.y;<br></span><span style="color: #008080;">167</span> <span style="color: #000000;">            canvas.drawCircle(endCircleX, endCircleY, originRadius, paint);<br></span><span style="color: #008080;">168</span><br><span style="color: #008080;">169</span>             <span style="color: #0000ff;">if</span> (!isArrivedMaxMoved) { <span style="color: #008000;">//</span><span style="color: #008000;"> æ²¡æœ‰è¾¾åˆ°æ‹‰ä¼¸æœ€å¤§å€¼</span><br><span style="color: #008080;">170</span> <span style="color: #000000;">                path.reset();<br></span><span style="color: #008080;">171</span>                 <span style="color: #0000ff;">double</span> sin = triangle.deltaY /<span style="color: #000000;"> triangle.hypotenuse;<br></span><span style="color: #008080;">172</span>                 <span style="color: #0000ff;">double</span> cos = triangle.deltaX /<span style="color: #000000;"> triangle.hypotenuse;<br></span><span style="color: #008080;">173</span><br><span style="color: #008080;">174</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Aç‚¹</span><br><span style="color: #008080;">175</span> <span style="color: #000000;">                path.moveTo(<br></span><span style="color: #008080;">176</span>                         (<span style="color: #0000ff;">float</span>) (startCircleX - curRadius <em><span style="color: #000000;"> sin),<br></span><span style="color: #008080;">177</span>                         (<span style="color: #0000ff;">float</span>) (startCircleY - curRadius </em><span style="color: #000000;"> cos)<br></span><span style="color: #008080;">178</span> <span style="color: #000000;">                );<br></span><span style="color: #008080;">179</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Bç‚¹</span><br><span style="color: #008080;">180</span> <span style="color: #000000;">                path.lineTo(<br></span><span style="color: #008080;">181</span>                         (<span style="color: #0000ff;">float</span>) (startCircleX + curRadius <em><span style="color: #000000;"> sin),<br></span><span style="color: #008080;">182</span>                         (<span style="color: #0000ff;">float</span>) (startCircleY + curRadius </em><span style="color: #000000;"> cos)<br></span><span style="color: #008080;">183</span> <span style="color: #000000;">                );<br></span><span style="color: #008080;">184</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Cç‚¹</span><br><span style="color: #008080;">185</span> <span style="color: #000000;">                path.quadTo(<br></span><span style="color: #008080;">186</span>                         (startCircleX + endCircleX) / 2, (startCircleY + endCircleY) / 2<span style="color: #000000;">,<br></span><span style="color: #008080;">187</span>                         (<span style="color: #0000ff;">float</span>) (endCircleX + originRadius <em> sin), (<span style="color: #0000ff;">float</span>) (endCircleY + originRadius </em><span style="color: #000000;"> cos)<br></span><span style="color: #008080;">188</span> <span style="color: #000000;">                );<br></span><span style="color: #008080;">189</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Dç‚¹</span><br><span style="color: #008080;">190</span> <span style="color: #000000;">                path.lineTo(<br></span><span style="color: #008080;">191</span>                         (<span style="color: #0000ff;">float</span>) (endCircleX - originRadius <em><span style="color: #000000;"> sin),<br></span><span style="color: #008080;">192</span>                         (<span style="color: #0000ff;">float</span>) (endCircleY - originRadius </em><span style="color: #000000;"> cos)<br></span><span style="color: #008080;">193</span> <span style="color: #000000;">                );<br></span><span style="color: #008080;">194</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> Aç‚¹</span><br><span style="color: #008080;">195</span> <span style="color: #000000;">                path.quadTo(<br></span><span style="color: #008080;">196</span>                         (startCircleX + endCircleX) / 2, (startCircleY + endCircleY) / 2<span style="color: #000000;">,<br></span><span style="color: #008080;">197</span>                         (<span style="color: #0000ff;">float</span>) (startCircleX - curRadius <em> sin), (<span style="color: #0000ff;">float</span>) (startCircleY - curRadius </em><span style="color: #000000;"> cos)<br></span><span style="color: #008080;">198</span> <span style="color: #000000;">                );<br></span><span style="color: #008080;">199</span> <span style="color: #000000;">                canvas.drawPath(path, paint);<br></span><span style="color: #008080;">200</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">201</span><br><span style="color: #008080;">202</span><br><span style="color: #008080;">203</span>         } <span style="color: #0000ff;">else</span> { <span style="color: #008000;">//</span><span style="color: #008000;"> éè§¦æ‘¸çŠ¶æ€</span><br><span style="color: #008080;">204</span>             <span style="color: #0000ff;">if</span> (curRadius &gt; 0<span style="color: #000000;">) {<br></span><span style="color: #008080;">205</span>                 startCircleX =<span style="color: #000000;"> curRadius;<br></span><span style="color: #008080;">206</span>                 startCircleY = originHeight -<span style="color: #000000;"> curRadius;<br></span><span style="color: #008080;">207</span> <span style="color: #000000;">                canvas.drawCircle(startCircleX, startCircleY, curRadius, paint);<br></span><span style="color: #008080;">208</span>                 <span style="color: #0000ff;">if</span> (curRadius == originRadius) { <span style="color: #008000;">//</span><span style="color: #008000;"> åªæœ‰åœ¨æ¢å¤æ­£å¸¸çš„æƒ…å†µä¸‹æ‰æ˜¾ç¤ºæ–‡å­—<br></span><span style="color: #008080;">209</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> ç»˜åˆ¶æ–‡å­—</span><br><span style="color: #008080;">210</span>                     <span style="color: #0000ff;">float</span> textH = textFontMetrics.bottom -<span style="color: #000000;"> textFontMetrics.top;<br></span><span style="color: #008080;">211</span>                     canvas.drawText(text, startCircleX, startCircleY + textH / 2<span style="color: #000000;">, textPaint);<br></span><span style="color: #008080;">212</span> <span style="color: #008000;">//</span><span style="color: #008000;">                    canvas.drawText(text, startCircleX, startCircleY, textPaint);</span><br><span style="color: #008080;">213</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">214</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">215</span><br><span style="color: #008080;">216</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">217</span><br><span style="color: #008080;">218</span> <span style="color: #008000;">//</span><span style="color: #008000;">        Logger.d(TAG, â€œcircleX: â€œ + startCircleX + â€œ, circleY: â€œ + startCircleY + â€œ, curRadius: â€œ + curRadius);</span><br><span style="color: #008080;">219</span><br><span style="color: #008080;">220</span><br><span style="color: #008080;">221</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">222</span><br><span style="color: #008080;">223</span>     <span style="color: #0000ff;">float</span> downX =<span style="color: #000000;"> Float.MAX_VALUE;<br></span><span style="color: #008080;">224</span>     <span style="color: #0000ff;">float</span> downY =<span style="color: #000000;"> Float.MAX_VALUE;<br></span><span style="color: #008080;">225</span><br><span style="color: #008080;">226</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">227</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> onTouchEvent(MotionEvent event) {<br></span><span style="color: #008080;">228</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onTouchEvent(event);<br></span><span style="color: #008080;">229</span> <span style="color: #008000;">//</span><span style="color: #008000;">        Logger.d(TAG, â€œonTouchEvent: â€œ + event);</span><br><span style="color: #008080;">230</span>         <span style="color: #0000ff;">switch</span><span style="color: #000000;"> (event.getAction()) {<br></span><span style="color: #008080;">231</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION_DOWN:<br></span><span style="color: #008080;">232</span>                 isTouched = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">233</span>                 <span style="color: #0000ff;">this</span><span style="color: #000000;">.setLayoutParams(newLp);<br></span><span style="color: #008080;">234</span>                 endPoint.x = (<span style="color: #0000ff;">int</span><span style="color: #000000;">) downX;<br></span><span style="color: #008080;">235</span>                 endPoint.y = (<span style="color: #0000ff;">int</span><span style="color: #000000;">) downY;<br></span><span style="color: #008080;">236</span><br><span style="color: #008080;">237</span>                 changeViewHeight(<span style="color: #0000ff;">this</span><span style="color: #000000;">, ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT);<br></span><span style="color: #008080;">238</span> <span style="color: #000000;">                postInvalidate();<br></span><span style="color: #008080;">239</span><br><span style="color: #008080;">240</span>                 downX = event.getX() + location[0<span style="color: #000000;">];<br></span><span style="color: #008080;">241</span>                 downY = event.getY() + location[1<span style="color: #000000;">];<br></span><span style="color: #008080;">242</span> <span style="color: #008000;">//</span><span style="color: #008000;">                Logger.d(TAG, String.format(â€œdownX: %f, downY: %fâ€, downX, downY));</span><br><span style="color: #008080;">243</span><br><span style="color: #008080;">244</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">245</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION_MOVE:<br></span><span style="color: #008080;">246</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> è®¡ç®—ç›´è§’è¾¹å’Œæ–œè¾¹ï¼ˆç”¨äºè®¡ç®—ç»˜åˆ¶ä¸¤åœ†ä¹‹é—´çš„å¡«å……å»ï¼‰</span><br><span style="color: #008080;">247</span>                 triangle.deltaX = event.getX() -<span style="color: #000000;"> downX;<br></span><span style="color: #008080;">248</span>                 triangle.deltaY = -1 <em> (event.getY() - downY); <span style="color: #008000;">//</span><span style="color: #008000;"> yè½´æ–¹å‘ç›¸åï¼Œæ‰€æœ‰éœ€è¦å–å</span><br><span style="color: #008080;">249</span>                 <span style="color: #0000ff;">double</span> distance = Math.sqrt(triangle.deltaX </em> triangle.deltaX + triangle.deltaY <em><span style="color: #000000;"> triangle.deltaY);<br></span><span style="color: #008080;">250</span>                 triangle.hypotenuse =<span style="color: #000000;"> distance;<br></span><span style="color: #008080;">251</span> <span style="color: #008000;">//</span><span style="color: #008000;">                Logger.d(TAG, â€œtriangle: â€œ + triangle);</span><br><span style="color: #008080;">252</span>                 refreshCurRadiusByMoveDistance((<span style="color: #0000ff;">int</span><span style="color: #000000;">) distance);<br></span><span style="color: #008080;">253</span><br><span style="color: #008080;">254</span>                 endPoint.x = (<span style="color: #0000ff;">int</span><span style="color: #000000;">) event.getX();<br></span><span style="color: #008080;">255</span>                 endPoint.y = (<span style="color: #0000ff;">int</span><span style="color: #000000;">) event.getY();<br></span><span style="color: #008080;">256</span><br><span style="color: #008080;">257</span> <span style="color: #000000;">                postInvalidate();<br></span><span style="color: #008080;">258</span><br><span style="color: #008080;">259</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">260</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION_UP:<br></span><span style="color: #008080;">261</span>                 isTouched = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">262</span>                 <span style="color: #0000ff;">this</span><span style="color: #000000;">.setLayoutParams(originLp);<br></span><span style="color: #008080;">263</span><br><span style="color: #008080;">264</span>                 <span style="color: #0000ff;">if</span> (isArrivedMaxMoved) { <span style="color: #008000;">//</span><span style="color: #008000;"> è§¦å‘äº‹ä»¶</span><br><span style="color: #008080;">265</span>                     changeViewHeight(<span style="color: #0000ff;">this</span><span style="color: #000000;">, originWidth, originHeight);<br></span><span style="color: #008080;">266</span> <span style="color: #000000;">                    postInvalidate();<br></span><span style="color: #008080;">267</span>                     <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> onDraggableFlagViewListener) {<br></span><span style="color: #008080;">268</span>                         onDraggableFlagViewListener.onFlagDismiss(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">269</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">270</span>                     Logger.d(TAG, â€œè§¦å‘äº‹ä»¶â€¦â€<span style="color: #000000;">);<br></span><span style="color: #008080;">271</span> <span style="color: #000000;">                    resetAfterDismiss();<br></span><span style="color: #008080;">272</span>                 } <span style="color: #0000ff;">else</span> { <span style="color: #008000;">//</span><span style="color: #008000;"> è¿˜åŸ</span><br><span style="color: #008080;">273</span>                     changeViewHeight(<span style="color: #0000ff;">this</span><span style="color: #000000;">, originWidth, originHeight);<br></span><span style="color: #008080;">274</span>                     startRollBackAnimation(500<span style="color: #008000;">/</span></em><span style="color: #008000;">ms</span><span style="color: #008000;">*/</span><span style="color: #000000;">);<br></span><span style="color: #008080;">275</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">276</span><br><span style="color: #008080;">277</span>                 downX =<span style="color: #000000;"> Float.MAX_VALUE;<br></span><span style="color: #008080;">278</span>                 downY =<span style="color: #000000;"> Float.MAX_VALUE;<br></span><span style="color: #008080;">279</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">280</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">281</span><br><span style="color: #008080;">282</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">283</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">284</span><br><span style="color: #008080;">285</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">286</span> <span style="color: #008000;">     <em> è§¦å‘äº‹ä»¶ä¹‹åé‡ç½®<br></em></span><span style="color: #008080;">287</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">288</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> resetAfterDismiss() {<br></span><span style="color: #008080;">289</span>         <span style="color: #0000ff;">this</span><span style="color: #000000;">.setVisibility(GONE);<br></span><span style="color: #008080;">290</span>         text = â€œâ€<span style="color: #000000;">;<br></span><span style="color: #008080;">291</span>         isArrivedMaxMoved = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">292</span>         curRadius =<span style="color: #000000;"> originRadius;<br></span><span style="color: #008080;">293</span> <span style="color: #000000;">        postInvalidate();<br></span><span style="color: #008080;">294</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">295</span><br><span style="color: #008080;">296</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">297</span> <span style="color: #008000;">     <em> æ ¹æ®ç§»åŠ¨çš„è·ç¦»æ¥åˆ·æ–°åŸæ¥çš„åœ†åŠå¾„å¤§å°<br></em></span><span style="color: #008080;">298</span> <span style="color: #008000;">     <br></span><span style="color: #008080;">299</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> distance<br></span><span style="color: #008080;">300</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">301</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> refreshCurRadiusByMoveDistance(<span style="color: #0000ff;">int</span><span style="color: #000000;"> distance) {<br></span><span style="color: #008080;">302</span>         <span style="color: #0000ff;">if</span> (distance &gt;<span style="color: #000000;"> maxMoveLength) {<br></span><span style="color: #008080;">303</span>             isArrivedMaxMoved = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">304</span>             curRadius = 0<span style="color: #000000;">;<br></span><span style="color: #008080;">305</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">306</span>             isArrivedMaxMoved = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">307</span>             <span style="color: #0000ff;">float</span> calcRadius = (1 - 1f <em> distance / maxMoveLength) </em><span style="color: #000000;"> originRadius;<br></span><span style="color: #008080;">308</span>             <span style="color: #0000ff;">float</span> maxRadius = ABTextUtil.dip2px(context, 2<span style="color: #000000;">);<br></span><span style="color: #008080;">309</span>             curRadius = (<span style="color: #0000ff;">int</span><span style="color: #000000;">) Math.max(calcRadius, maxRadius);<br></span><span style="color: #008080;">310</span> <span style="color: #008000;">//</span><span style="color: #008000;">            Logger.d(TAG, â€œ[refreshCurRadiusByMoveDistance]curRadius: â€œ + curRadius + â€œ, calcRadius: â€œ + calcRadius + â€œ, maxRadius: â€œ + maxRadius);</span><br><span style="color: #008080;">311</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">312</span><br><span style="color: #008080;">313</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">314</span><br><span style="color: #008080;">315</span><br><span style="color: #008080;">316</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">317</span> <span style="color: #008000;">     <em> æ”¹å˜æŸæ§ä»¶çš„é«˜åº¦<br></em></span><span style="color: #008080;">318</span> <span style="color: #008000;">     <br></span><span style="color: #008080;">319</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> view<br></span><span style="color: #008080;">320</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> height<br></span><span style="color: #008080;">321</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;">322</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> changeViewHeight(View view, <span style="color: #0000ff;">int</span> width, <span style="color: #0000ff;">int</span><span style="color: #000000;"> height) {<br></span><span style="color: #008080;">323</span>         ViewGroup.LayoutParams lp =<span style="color: #000000;"> view.getLayoutParams();<br></span><span style="color: #008080;">324</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> lp) {<br></span><span style="color: #008080;">325</span>             lp =<span style="color: #000000;"> originLp;<br></span><span style="color: #008080;">326</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">327</span>         lp.width =<span style="color: #000000;"> width;<br></span><span style="color: #008080;">328</span>         lp.height =<span style="color: #000000;"> height;<br></span><span style="color: #008080;">329</span> <span style="color: #000000;">        view.setLayoutParams(lp);<br></span><span style="color: #008080;">330</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">331</span><br><span style="color: #008080;">332</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">333</span> <span style="color: #008000;">      å›æ»šçŠ¶æ€åŠ¨ç”»<br></span><span style="color: #008080;">334</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;">335</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> ValueAnimator rollBackAnim;<br></span><span style="color: #008080;">336</span><br><span style="color: #008080;">337</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> startRollBackAnimation(<span style="color: #0000ff;">long</span><span style="color: #000000;"> duration) {<br></span><span style="color: #008080;">338</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> rollBackAnim) {<br></span><span style="color: #008080;">339</span>             rollBackAnim =<span style="color: #000000;"> ValueAnimator.ofFloat(curRadius, originRadius);<br></span><span style="color: #008080;">340</span>             rollBackAnim.addUpdateListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> ValueAnimator.AnimatorUpdateListener() {<br></span><span style="color: #008080;">341</span> <span style="color: #000000;">                @Override<br></span><span style="color: #008080;">342</span>                 <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onAnimationUpdate(ValueAnimator animation) {<br></span><span style="color: #008080;">343</span>                     <span style="color: #0000ff;">float</span> value = (<span style="color: #0000ff;">float</span><span style="color: #000000;">) animation.getAnimatedValue();<br></span><span style="color: #008080;">344</span>                     curRadius = (<span style="color: #0000ff;">int</span><span style="color: #000000;">) value;<br></span><span style="color: #008080;">345</span> <span style="color: #000000;">                    postInvalidate();<br></span><span style="color: #008080;">346</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">347</span> <span style="color: #000000;">            });<br></span><span style="color: #008080;">348</span>             rollBackAnim.setInterpolator(<span style="color: #0000ff;">new</span> BounceInterpolator()); <span style="color: #008000;">//</span><span style="color: #008000;"> åå¼¹æ•ˆæœ</span><br><span style="color: #008080;">349</span>             rollBackAnim.addListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> AnimatorListenerAdapter() {<br></span><span style="color: #008080;">350</span> <span style="color: #000000;">                @Override<br></span><span style="color: #008080;">351</span>                 <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onAnimationEnd(Animator animation) {<br></span><span style="color: #008080;">352</span>                     <span style="color: #0000ff;">super</span><span style="color: #000000;">.onAnimationEnd(animation);<br></span><span style="color: #008080;">353</span>                     DraggableFlagView.<span style="color: #0000ff;">this</span><span style="color: #000000;">.clearAnimation();<br></span><span style="color: #008080;">354</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">355</span> <span style="color: #000000;">            });<br></span><span style="color: #008080;">356</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">357</span> <span style="color: #000000;">        rollBackAnim.setDuration(duration);<br></span><span style="color: #008080;">358</span> <span style="color: #000000;">        rollBackAnim.start();<br></span><span style="color: #008080;">359</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">360</span><br><span style="color: #008080;">361</span><br><span style="color: #008080;">362</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">363</span> <span style="color: #008000;">      è®¡ç®—å››ä¸ªåæ ‡çš„ä¸‰è§’è¾¹å…³ç³»<br></span><span style="color: #008080;">364</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">365</span>     <span style="color: #0000ff;">class</span><span style="color: #000000;"> Triangle {<br></span><span style="color: #008080;">366</span>         <span style="color: #0000ff;">double</span><span style="color: #000000;"> deltaX;<br></span><span style="color: #008080;">367</span>         <span style="color: #0000ff;">double</span><span style="color: #000000;"> deltaY;<br></span><span style="color: #008080;">368</span>         <span style="color: #0000ff;">double</span><span style="color: #000000;"> hypotenuse;<br></span><span style="color: #008080;">369</span><br><span style="color: #008080;">370</span> <span style="color: #000000;">        @Override<br></span><span style="color: #008080;">371</span>         <span style="color: #0000ff;">public</span><span style="color: #000000;"> String toString() {<br></span><span style="color: #008080;">372</span>             <span style="color: #0000ff;">return</span> â€œTriangle{â€œ +<br><span style="color: #008080;">373</span>                     â€œdeltaX=â€ + deltaX +<br><span style="color: #008080;">374</span>                     â€œ, deltaY=â€ + deltaY +<br><span style="color: #008080;">375</span>                     â€œ, hypotenuse=â€ + hypotenuse +<br><span style="color: #008080;">376</span>                     â€˜}â€™<span style="color: #000000;">;<br></span><span style="color: #008080;">377</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">378</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">379</span><br><span style="color: #008080;">380</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String getText() {<br></span><span style="color: #008080;">381</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> text;<br></span><span style="color: #008080;">382</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">383</span><br><span style="color: #008080;">384</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setText(String text) {<br></span><span style="color: #008080;">385</span>         <span style="color: #0000ff;">this</span>.text =<span style="color: #000000;"> text;<br></span><span style="color: #008080;">386</span> <span style="color: #000000;">        postInvalidate();<br></span><span style="color: #008080;">387</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">388</span> }</pre><br></div>

<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> view </tag>
            
            <tag> DaggerableFlagView </tag>
            
            <tag> qq </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä¸‹æ‹‰åˆ·æ–°æ§ä»¶RefreshableViewçš„å®ç°]]></title>
      <url>/2014/12/18/Android-%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0%E6%8E%A7%E4%BB%B6RefreshableView%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
      <content type="html"><![CDATA[<p>&nbsp;</p>
<p>éœ€æ±‚ï¼šè‡ªå®šä¹‰ä¸€ä¸ªViewGroupï¼Œå®ç°å¯ä»¥ä¸‹æ‹‰åˆ·æ–°çš„åŠŸèƒ½ã€‚ä¸‹æ‹‰ä¸€å®šè·ç¦»åï¼ˆä¸‹æ‹‰æ—¶æ˜¾ç¤ºçš„ç•Œé¢å¯ä»¥è‡ªå®šä¹‰ä»»ä½•å¤æ‚çš„ç•Œé¢ï¼‰é‡Šæ”¾æ‰‹æŒ‡å¯ä»¥å›è°ƒåˆ·æ–°çš„åŠŸèƒ½ï¼Œç”¨æˆ·å¤„ç†å®Œåˆ·æ–°çš„å†…å®¹åï¼Œå¯ä»¥è°ƒç”¨æ–¹æ³•onCompleteRefresh()é€šçŸ¥åˆ·æ–°å®Œæ¯•ï¼Œç„¶åå›å½’æ­£å¸¸çŠ¶æ€ã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/wangjiegulu/RefreshableView/master/screenshot/refreshableview.gif" alt="">&nbsp;&nbsp;&nbsp;<img src="https://raw.githubusercontent.com/wangjiegulu/RefreshableView/master/screenshot/refreshablelistview.gif" alt=""></p>
<p>&nbsp;</p>
<p><strong>æºä»£ç ï¼š<span style="color: #ff0000;"><a href="https://github.com/wangjiegulu/RefreshableView" target="_blank" rel="noopener"><span style="color: #ff0000;">RefreshableView</span></a></span>ï¼ˆ<span style="color: #ff0000;"><a href="https://github.com/wangjiegulu/RefreshableView" target="_blank" rel="noopener"><span style="color: #ff0000;">https://github.com/wangjiegulu/RefreshableView</span></a></span>ï¼‰</strong></p>
<p><span style="font-size: 18px;"><strong>åˆ†æï¼š</strong></span></p>
<p>æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ç®¡ä»€ä¹ˆæ§ä»¶ï¼Œåªè¦åœ¨xmlä¸­å¤–é¢åŒ…ä¸€å±‚æ ‡ç­¾ï¼Œé‚£è¿™ä¸ªæ ‡ç­¾ä¸‹é¢çš„æ‰€æœ‰å­æ ‡ç­¾æ‰€åœ¨çš„æ§ä»¶éƒ½è¢«æ”¯æŒå¯ä»¥ä¸‹æ‹‰åˆ·æ–°äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ViewGroupæ¥å®ç°ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ç»§æ‰¿LinearLayoutï¼Œå½“ç„¶å…¶ä»–çš„ï¼ˆFrameLayoutç­‰ï¼‰ä¹Ÿä¸€æ ·äº†ã€‚</p>
<p>å› ä¸ºæ ¹æ®æ‰‹æŒ‡ä¸‹æ»‘ï¼Œéœ€è¦æœ‰ä¸€ä¸ªåˆ·æ–°çš„viewè¢«æ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦æ·»åŠ ä¸€ä¸ªå­viewï¼ˆç§°ä¸ºrefreshHeaderViewï¼‰ï¼Œå¹¶æ”¾ç½®åœ¨æœ€é¡¶éƒ¨ï¼Œä½¿ç”¨LinearLayoutçš„å¥½å¤„æ˜¯å¯ä»¥è®¾ç½®ä¸ºVERTICALï¼Œè¿™æ ·å¯ä»¥ç›´æ¥&ldquo;this.addView(refreshHeaderView, 0);&rdquo;æå®šäº†ã€‚ç„¶åå°±è¦æ ¹æ®æ‰‹æŒ‡æ»‘åŠ¨çš„è·ç¦»ï¼ŒåŠ¨æ€åœ°å»æ”¹å˜refreshHeaderViewçš„é«˜åº¦ã€‚åŒæ—¶æ£€æµ‹æ˜¯å¦åˆ°è¾¾äº†å¯ä»¥åˆ·æ–°çš„é«˜åº¦äº†ï¼Œå¦‚æœè¾¾åˆ°äº†ï¼Œæ›´æ–°å½“å‰çš„åˆ·æ–°çŠ¶æ€ã€‚æ‰‹æŒ‡æ”¾å¼€æ—¶ï¼Œæ ¹æ®ä¹‹å‰ç§»åŠ¨çš„åˆ·æ–°çŠ¶æ€ï¼Œæ‰§è¡Œåˆ·æ–°æˆ–è€…å›å½’æ­£å¸¸çŠ¶æ€ã€‚</p>
<p>RefreshableViewä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">  1</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">  2</span> <span style="color: #008000;"> <em> ä¸‹æ‹‰åˆ·æ–°æ§ä»¶<br></em></span><span style="color: #008080;">  3</span> <span style="color: #008000;">  Author: wangjie<br></span><span style="color: #008080;">  4</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;">  5</span> <span style="color: #008000;">  Date: 12/13/14.<br></span><span style="color: #008080;">  6</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;">  7</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> RefreshableView <span style="color: #0000ff;">extends</span><span style="color: #000000;"> LinearLayout {<br></span><span style="color: #008080;">  8</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = RefreshableView.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;">  9</span><br><span style="color: #008080;"> 10</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> RefreshableView(Context context) {<br></span><span style="color: #008080;"> 11</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context);<br></span><span style="color: #008080;"> 12</span> <span style="color: #000000;">        init(context);<br></span><span style="color: #008080;"> 13</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 14</span><br><span style="color: #008080;"> 15</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> RefreshableView(Context context, AttributeSet attrs) {<br></span><span style="color: #008080;"> 16</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, attrs);<br></span><span style="color: #008080;"> 17</span><br><span style="color: #008080;"> 18</span>         TypedArray a =<span style="color: #000000;"> context.obtainStyledAttributes(attrs, R.styleable.refreshableView);<br></span><span style="color: #008080;"> 19</span>         <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 0, len = a.length(); i &lt; len; i++<span style="color: #000000;">) {<br></span><span style="color: #008080;"> 20</span>             <span style="color: #0000ff;">int</span> attrIndex =<span style="color: #000000;"> a.getIndex(i);<br></span><span style="color: #008080;"> 21</span>             <span style="color: #0000ff;">switch</span><span style="color: #000000;"> (attrIndex) {<br></span><span style="color: #008080;"> 22</span>                 <span style="color: #0000ff;">case</span><span style="color: #000000;"> R.styleable.refreshableView_interceptAllMoveEvents:<br></span><span style="color: #008080;"> 23</span>                     interceptAllMoveEvents = a.getBoolean(i, <span style="color: #0000ff;">false</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 24</span>                     <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 25</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 26</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 27</span> <span style="color: #000000;">        a.recycle();<br></span><span style="color: #008080;"> 28</span><br><span style="color: #008080;"> 29</span> <span style="color: #000000;">        init(context);<br></span><span style="color: #008080;"> 30</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 31</span><br><span style="color: #008080;"> 32</span>     <span style="color: #0000ff;">public</span> RefreshableView(Context context, AttributeSet attrs, <span style="color: #0000ff;">int</span><span style="color: #000000;"> defStyle) {<br></span><span style="color: #008080;"> 33</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, attrs, defStyle);<br></span><span style="color: #008080;"> 34</span> <span style="color: #000000;">        init(context);<br></span><span style="color: #008080;"> 35</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 36</span><br><span style="color: #008080;"> 37</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 38</span> <span style="color: #008000;">     <em> åˆ·æ–°çŠ¶æ€<br></em></span><span style="color: #008080;"> 39</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 40</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> STATE_REFRESH_NORMAL = 0x21<span style="color: #000000;">;<br></span><span style="color: #008080;"> 41</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> STATE_REFRESH_NOT_ARRIVED = 0x22<span style="color: #000000;">;<br></span><span style="color: #008080;"> 42</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> STATE_REFRESH_ARRIVED = 0x23<span style="color: #000000;">;<br></span><span style="color: #008080;"> 43</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> STATE_REFRESHING = 0x24<span style="color: #000000;">;<br></span><span style="color: #008080;"> 44</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> refreshState;<br></span><span style="color: #008080;"> 45</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> åˆ·æ–°çŠ¶æ€ç›‘å¬</span><br><span style="color: #008080;"> 46</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> RefreshableHelper refreshableHelper;<br></span><span style="color: #008080;"> 47</span><br><span style="color: #008080;"> 48</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setRefreshableHelper(RefreshableHelper refreshableHelper) {<br></span><span style="color: #008080;"> 49</span>         <span style="color: #0000ff;">this</span>.refreshableHelper =<span style="color: #000000;"> refreshableHelper;<br></span><span style="color: #008080;"> 50</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 51</span><br><span style="color: #008080;"> 52</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Context context;<br></span><span style="color: #008080;"> 53</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 54</span> <span style="color: #008000;">     <em> åˆ·æ–°çš„view<br></em></span><span style="color: #008080;"> 55</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 56</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> View refreshHeaderView;<br></span><span style="color: #008080;"> 57</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 58</span> <span style="color: #008000;">     <em> åˆ·æ–°çš„viewçš„çœŸå®é«˜åº¦<br></em></span><span style="color: #008080;"> 59</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 60</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> originRefreshHeight;<br></span><span style="color: #008080;"> 61</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 62</span> <span style="color: #008000;">     <em> æœ‰æ•ˆä¸‹æ‹‰åˆ·æ–°éœ€è¦è¾¾åˆ°çš„é«˜åº¦<br></em></span><span style="color: #008080;"> 63</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 64</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> refreshArrivedStateHeight;<br></span><span style="color: #008080;"> 65</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 66</span> <span style="color: #008000;">     <em> åˆ·æ–°æ—¶æ˜¾ç¤ºçš„é«˜åº¦<br></em></span><span style="color: #008080;"> 67</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 68</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> refreshingHeight;<br></span><span style="color: #008080;"> 69</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 70</span> <span style="color: #008000;">     <em> æ­£å¸¸æœªåˆ·æ–°é«˜åº¦<br></em></span><span style="color: #008080;"> 71</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 72</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> refreshNormalHeight;<br></span><span style="color: #008080;"> 73</span><br><span style="color: #008080;"> 74</span><br><span style="color: #008080;"> 75</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 76</span> <span style="color: #008000;">     <em> é»˜è®¤ä¸å…è®¸æ‹¦æˆªï¼ˆå³ï¼Œå¾€å­viewä¼ é€’äº‹ä»¶ï¼‰ï¼Œè¯¥å±æ€§åªæœ‰åœ¨interceptAllMoveEventsä¸ºfalseçš„æ—¶å€™æ‰æœ‰æ•ˆ<br></em></span><span style="color: #008080;"> 77</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 78</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> disallowIntercept = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 79</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 80</span> <span style="color: #008000;">     <em> xmlä¸­å¯è®¾ç½®å®ƒçš„å€¼ä¸ºfalseï¼Œè¡¨ç¤ºä¸æŠŠç§»åŠ¨çš„äº‹ä»¶ä¼ é€’ç»™å­æ§ä»¶<br></em></span><span style="color: #008080;"> 81</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 82</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> interceptAllMoveEvents;<br></span><span style="color: #008080;"> 83</span><br><span style="color: #008080;"> 84</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> init(Context context) {<br></span><span style="color: #008080;"> 85</span>         <span style="color: #0000ff;">this</span>.context =<span style="color: #000000;"> context;<br></span><span style="color: #008080;"> 86</span>         <span style="color: #0000ff;">this</span><span style="color: #000000;">.setOrientation(VERTICAL);<br></span><span style="color: #008080;"> 87</span><br><span style="color: #008080;"> 88</span> <span style="color: #008000;">//</span><span style="color: #008000;">        Log.d(TAG, â€œ[init]originRefreshHeight: â€œ + refreshHeaderView.getMeasuredHeight());</span><br><span style="color: #008080;"> 89</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 90</span><br><span style="color: #008080;"> 91</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 92</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> onSizeChanged(<span style="color: #0000ff;">int</span> w, <span style="color: #0000ff;">int</span> h, <span style="color: #0000ff;">int</span> oldw, <span style="color: #0000ff;">int</span><span style="color: #000000;"> oldh) {<br></span><span style="color: #008080;"> 93</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onSizeChanged(w, h, oldw, oldh);<br></span><span style="color: #008080;"> 94</span><br><span style="color: #008080;"> 95</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> refreshableHelper) {<br></span><span style="color: #008080;"> 96</span>             refreshHeaderView =<span style="color: #000000;"> refreshableHelper.onInitRefreshHeaderView();<br></span><span style="color: #008080;"> 97</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 98</span> <span style="color: #008000;">//</span><span style="color: #008000;">        refreshHeaderView = LayoutInflater.from(context).inflate(R.layout.refresh_head, null);</span><br><span style="color: #008080;"> 99</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> refreshHeaderView) {<br></span><span style="color: #008080;">100</span>             Log.e(TAG, â€œrefreshHeaderView is null!â€<span style="color: #000000;">);<br></span><span style="color: #008080;">101</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;">102</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">103</span>         <span style="color: #0000ff;">this</span><span style="color: #000000;">.removeView(refreshHeaderView);<br></span><span style="color: #008080;">104</span>         <span style="color: #0000ff;">this</span>.addView(refreshHeaderView, 0<span style="color: #000000;">);<br></span><span style="color: #008080;">105</span><br><span style="color: #008080;">106</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¡ç®—refreshHeadViewå°ºå¯¸</span><br><span style="color: #008080;">107</span>         <span style="color: #0000ff;">int</span> width = View.MeasureSpec.makeMeasureSpec(0<span style="color: #000000;">, View.MeasureSpec.UNSPECIFIED);<br></span><span style="color: #008080;">108</span>         <span style="color: #0000ff;">int</span> expandSpec = View.MeasureSpec.makeMeasureSpec(Integer.MAX_VALUE &gt;&gt; 2<span style="color: #000000;">, View.MeasureSpec.AT_MOST);<br></span><span style="color: #008080;">109</span> <span style="color: #000000;">        refreshHeaderView.measure(width, expandSpec);<br></span><span style="color: #008080;">110</span><br><span style="color: #008080;">111</span>         Log.d(TAG, â€œ[onSizeChanged]w: â€œ + w + â€œ, h: â€œ +<span style="color: #000000;"> h);<br></span><span style="color: #008080;">112</span>         Log.d(TAG, â€œ[onSizeChanged]oldw: â€œ + oldw + â€œ, oldh: â€œ +<span style="color: #000000;"> oldh);<br></span><span style="color: #008080;">113</span>         Log.d(TAG, â€œ[onSizeChanged]child counts: â€œ + <span style="color: #0000ff;">this</span><span style="color: #000000;">.getChildCount());<br></span><span style="color: #008080;">114</span>         originRefreshHeight =<span style="color: #000000;"> refreshHeaderView.getMeasuredHeight();<br></span><span style="color: #008080;">115</span><br><span style="color: #008080;">116</span>         <span style="color: #0000ff;">boolean</span> isUseDefault = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">117</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> refreshableHelper) {<br></span><span style="color: #008080;">118</span>             isUseDefault =<span style="color: #000000;"> refreshableHelper.onInitRefreshHeight(originRefreshHeight);<br></span><span style="color: #008080;">119</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">120</span><br><span style="color: #008080;">121</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> åˆå§‹åŒ–å„ä¸ªé«˜åº¦</span><br><span style="color: #008080;">122</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> (isUseDefault) {<br></span><span style="color: #008080;">123</span>             refreshArrivedStateHeight =<span style="color: #000000;"> originRefreshHeight;<br></span><span style="color: #008080;">124</span>             refreshingHeight =<span style="color: #000000;"> originRefreshHeight;<br></span><span style="color: #008080;">125</span>             refreshNormalHeight = 0<span style="color: #000000;">;<br></span><span style="color: #008080;">126</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">127</span>         Log.d(TAG, â€œ[onSizeChanged]refreshHeaderView origin height: â€œ +<span style="color: #000000;"> originRefreshHeight);<br></span><span style="color: #008080;">128</span> <span style="color: #000000;">        changeViewHeight(refreshHeaderView, refreshNormalHeight);<br></span><span style="color: #008080;">129</span><br><span style="color: #008080;">130</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> åˆå§‹åŒ–ä¸ºæ­£å¸¸çŠ¶æ€</span><br><span style="color: #008080;">131</span> <span style="color: #000000;">        setRefreshState(STATE_REFRESH_NORMAL);<br></span><span style="color: #008080;">132</span><br><span style="color: #008080;">133</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">134</span><br><span style="color: #008080;">135</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">136</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> dispatchTouchEvent(MotionEvent ev) {<br></span><span style="color: #008080;">137</span>         Log.d(TAG, â€œ[dispatchTouchEvent]ev action: â€œ +<span style="color: #000000;"> ev.getAction());<br></span><span style="color: #008080;">138</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">super</span><span style="color: #000000;">.dispatchTouchEvent(ev);<br></span><span style="color: #008080;">139</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">140</span><br><span style="color: #008080;">141</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">142</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> onInterceptTouchEvent(MotionEvent ev) {<br></span><span style="color: #008080;">143</span>         Log.d(TAG, â€œ[onInterceptTouchEvent]ev action: â€œ +<span style="color: #000000;"> ev.getAction());<br></span><span style="color: #008080;">144</span>         <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">interceptAllMoveEvents) {<br></span><span style="color: #008080;">145</span>             <span style="color: #0000ff;">return</span> !<span style="color: #000000;">disallowIntercept;<br></span><span style="color: #008080;">146</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">147</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœè®¾ç½®äº†æ‹¦æˆªæ‰€æœ‰moveäº‹ä»¶ï¼Œå³interceptAllMoveEventsä¸ºtrue</span><br><span style="color: #008080;">148</span>         <span style="color: #0000ff;">if</span> (MotionEvent.ACTION_MOVE ==<span style="color: #000000;"> ev.getAction()) {<br></span><span style="color: #008080;">149</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">150</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">151</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">152</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">153</span><br><span style="color: #008080;">154</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">155</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> requestDisallowInterceptTouchEvent(<span style="color: #0000ff;">boolean</span><span style="color: #000000;"> disallowIntercept) {<br></span><span style="color: #008080;">156</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">this</span>.disallowIntercept ==<span style="color: #000000;"> disallowIntercept) {<br></span><span style="color: #008080;">157</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;">158</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">159</span>         <span style="color: #0000ff;">this</span>.disallowIntercept =<span style="color: #000000;"> disallowIntercept;<br></span><span style="color: #008080;">160</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.requestDisallowInterceptTouchEvent(disallowIntercept);<br></span><span style="color: #008080;">161</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">162</span><br><span style="color: #008080;">163</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">float</span> downY =<span style="color: #000000;"> Float.MAX_VALUE;<br></span><span style="color: #008080;">164</span><br><span style="color: #008080;">165</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">166</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> onTouchEvent(MotionEvent event) {<br></span><span style="color: #008080;">167</span> <span style="color: #008000;">//</span><span style="color: #008000;">        super.onTouchEvent(event);</span><br><span style="color: #008080;">168</span>         Log.d(TAG, â€œ[onTouchEvent]ev action: â€œ +<span style="color: #000000;"> event.getAction());<br></span><span style="color: #008080;">169</span>         <span style="color: #0000ff;">switch</span><span style="color: #000000;"> (event.getAction()) {<br></span><span style="color: #008080;">170</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION_DOWN:<br></span><span style="color: #008080;">171</span>                 downY =<span style="color: #000000;"> event.getY();<br></span><span style="color: #008080;">172</span>                 Log.d(TAG, â€œDown â€“&gt; downY: â€œ +<span style="color: #000000;"> downY);<br></span><span style="color: #008080;">173</span>                 requestDisallowInterceptTouchEvent(<span style="color: #0000ff;">true</span>); <span style="color: #008000;">//</span><span style="color: #008000;"> ä¿è¯äº‹ä»¶å¯å¾€ä¸‹ä¼ é€’</span><br><span style="color: #008080;">174</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">175</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION_MOVE:<br></span><span style="color: #008080;">176</span><br><span style="color: #008080;">177</span>                 <span style="color: #0000ff;">float</span> curY =<span style="color: #000000;"> event.getY();<br></span><span style="color: #008080;">178</span>                 <span style="color: #0000ff;">float</span> deltaY = curY -<span style="color: #000000;"> downY;<br></span><span style="color: #008080;">179</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> æ˜¯å¦æ˜¯æœ‰æ•ˆçš„å¾€ä¸‹æ‹–åŠ¨äº‹ä»¶ï¼ˆåˆ™éœ€è¦æ˜¾ç¤ºåŠ è½½headerï¼‰</span><br><span style="color: #008080;">180</span>                 <span style="color: #0000ff;">boolean</span> isDropDownValidate = Float.MAX_VALUE !=<span style="color: #000000;"> downY;<br></span><span style="color: #008080;">181</span>                 <span style="color: #008000;">/</span><br><span style="color: #008080;">182</span> <span style="color: #008000;">                 <em> ä¿®æ”¹æ‹¦æˆªè®¾ç½®<br></em></span><span style="color: #008080;">183</span> <span style="color: #008000;">                  å¦‚æœæ˜¯æœ‰æ•ˆå¾€ä¸‹æ‹–åŠ¨äº‹ä»¶ï¼Œåˆ™äº‹ä»¶éœ€è¦åœ¨æœ¬ViewGroupä¸­å¤„ç†ï¼Œæ‰€ä»¥éœ€è¦æ‹¦æˆªä¸å¾€å­æ§ä»¶ä¼ é€’ï¼Œå³ä¸å…è®¸æ‹¦æˆªè®¾ä¸ºfalse<br></span><span style="color: #008080;">184</span> <span style="color: #008000;">                 <em> å¦‚æœæ˜¯æœ‰æ•ˆå¾€ä¸‹æ‹–åŠ¨äº‹ä»¶ï¼Œåˆ™äº‹ä»¶ä¼ é€’ç»™å­æ§ä»¶å¤„ç†ï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹¦æˆªï¼Œå¹¶å¾€å­æ§ä»¶ä¼ é€’ï¼Œå³ä¸å…è®¸æ‹¦æˆªè®¾ä¸ºtrue<br></em></span><span style="color: #008080;">185</span>                  <span style="color: #008000;">/</span><br><span style="color: #008080;">186</span>                 requestDisallowInterceptTouchEvent(!<span style="color: #000000;">isDropDownValidate);<br></span><span style="color: #008080;">187</span><br><span style="color: #008080;">188</span>                 downY =<span style="color: #000000;"> curY;<br></span><span style="color: #008080;">189</span>                 Log.d(TAG, â€œMove â€“&gt; deltaY(curY - downY): â€œ +<span style="color: #000000;"> deltaY);<br></span><span style="color: #008080;">190</span>                 <span style="color: #0000ff;">int</span> curHeight =<span style="color: #000000;"> refreshHeaderView.getMeasuredHeight();<br></span><span style="color: #008080;">191</span>                 <span style="color: #0000ff;">int</span> exceptHeight = curHeight + (<span style="color: #0000ff;">int</span>) (deltaY / 2<span style="color: #000000;">);<br></span><span style="color: #008080;">192</span><br><span style="color: #008080;">193</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœå½“å‰æ²¡æœ‰å¤„åœ¨æ­£åœ¨åˆ·æ–°çŠ¶æ€ï¼Œåˆ™æ›´æ–°åˆ·æ–°çŠ¶æ€</span><br><span style="color: #008080;">194</span>                 <span style="color: #0000ff;">if</span> (STATE_REFRESHING !=<span style="color: #000000;"> refreshState) {<br></span><span style="color: #008080;">195</span>                     <span style="color: #0000ff;">if</span> (curHeight &gt;= refreshArrivedStateHeight) { <span style="color: #008000;">//</span><span style="color: #008000;"> è¾¾åˆ°å¯åˆ·æ–°çŠ¶æ€</span><br><span style="color: #008080;">196</span> <span style="color: #000000;">                        setRefreshState(STATE_REFRESH_ARRIVED);<br></span><span style="color: #008080;">197</span>                     } <span style="color: #0000ff;">else</span> { <span style="color: #008000;">//</span><span style="color: #008000;"> æœªè¾¾åˆ°å¯åˆ·æ–°çŠ¶æ€</span><br><span style="color: #008080;">198</span> <span style="color: #000000;">                        setRefreshState(STATE_REFRESH_NOT_ARRIVED);<br></span><span style="color: #008080;">199</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">200</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">201</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;"> (isDropDownValidate) {<br></span><span style="color: #008080;">202</span> <span style="color: #000000;">                    changeViewHeight(refreshHeaderView, Math.max(refreshNormalHeight, exceptHeight));<br></span><span style="color: #008080;">203</span>                 } <span style="color: #0000ff;">else</span> { <span style="color: #008000;">//</span><span style="color: #008000;"> é˜²æ­¢ä»å­æ§ä»¶ä¿®æ”¹æ‹¦æˆªåå¼•å‘çš„downYä¸ºFloat.MAX_VALUEçš„é—®é¢˜</span><br><span style="color: #008080;">204</span> <span style="color: #000000;">                    changeViewHeight(refreshHeaderView, Math.max(curHeight, exceptHeight));<br></span><span style="color: #008080;">205</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">206</span><br><span style="color: #008080;">207</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">208</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION_UP:<br></span><span style="color: #008080;">209</span>                 downY =<span style="color: #000000;"> Float.MAX_VALUE;<br></span><span style="color: #008080;">210</span>                 Log.d(TAG, â€œUp â€“&gt; downY: â€œ +<span style="color: #000000;"> downY);<br></span><span style="color: #008080;">211</span>                 requestDisallowInterceptTouchEvent(<span style="color: #0000ff;">true</span>); <span style="color: #008000;">//</span><span style="color: #008000;"> ä¿è¯äº‹ä»¶å¯å¾€ä¸‹ä¼ é€’<br></span><span style="color: #008080;">212</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœæ˜¯è¾¾åˆ°åˆ·æ–°çŠ¶æ€ï¼Œåˆ™è®¾ç½®æ­£åœ¨åˆ·æ–°çŠ¶æ€çš„é«˜åº¦</span><br><span style="color: #008080;">213</span>                 <span style="color: #0000ff;">if</span> (STATE_REFRESH_ARRIVED == refreshState) { <span style="color: #008000;">//</span><span style="color: #008000;"> è¾¾åˆ°äº†åˆ·æ–°çš„çŠ¶æ€</span><br><span style="color: #008080;">214</span> <span style="color: #000000;">                    startHeightAnimation(refreshHeaderView, refreshHeaderView.getMeasuredHeight(), refreshingHeight);<br></span><span style="color: #008080;">215</span> <span style="color: #000000;">                    setRefreshState(STATE_REFRESHING);<br></span><span style="color: #008080;">216</span>                 } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (STATE_REFRESHING == refreshState) { <span style="color: #008000;">//</span><span style="color: #008000;"> æ­£åœ¨åˆ·æ–°çš„çŠ¶æ€</span><br><span style="color: #008080;">217</span> <span style="color: #000000;">                    startHeightAnimation(refreshHeaderView, refreshHeaderView.getMeasuredHeight(), refreshingHeight);<br></span><span style="color: #008080;">218</span>                 } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">219</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> æ‰§è¡ŒåŠ¨ç”»åå›å½’æ­£å¸¸çŠ¶æ€</span><br><span style="color: #008080;">220</span> <span style="color: #000000;">                    startHeightAnimation(refreshHeaderView, refreshHeaderView.getMeasuredHeight(), refreshNormalHeight, normalAnimatorListener);<br></span><span style="color: #008080;">221</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">222</span><br><span style="color: #008080;">223</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">224</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION_CANCEL:<br></span><span style="color: #008080;">225</span>                 Log.d(TAG, â€œcancelâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">226</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">227</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">228</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">229</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">230</span><br><span style="color: #008080;">231</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">232</span> <span style="color: #008000;">     <em> åˆ·æ–°å®Œæ¯•åè°ƒç”¨æ­¤æ–¹æ³•<br></em></span><span style="color: #008080;">233</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">234</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCompleteRefresh() {<br></span><span style="color: #008080;">235</span>         <span style="color: #0000ff;">if</span> (STATE_REFRESHING ==<span style="color: #000000;"> refreshState) {<br></span><span style="color: #008080;">236</span> <span style="color: #000000;">            setRefreshState(STATE_REFRESH_NORMAL);<br></span><span style="color: #008080;">237</span> <span style="color: #000000;">            startHeightAnimation(refreshHeaderView, refreshHeaderView.getMeasuredHeight(), refreshNormalHeight);<br></span><span style="color: #008080;">238</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">239</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">240</span><br><span style="color: #008080;">241</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">242</span> <span style="color: #008000;">     <em> ä¿®æ”¹å½“å‰çš„åˆ·æ–°çŠ¶æ€<br></em></span><span style="color: #008080;">243</span> <span style="color: #008000;">     <br></span><span style="color: #008080;">244</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> expectRefreshState<br></span><span style="color: #008080;">245</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">246</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> setRefreshState(<span style="color: #0000ff;">int</span><span style="color: #000000;"> expectRefreshState) {<br></span><span style="color: #008080;">247</span>         <span style="color: #0000ff;">if</span> (expectRefreshState !=<span style="color: #000000;"> refreshState) {<br></span><span style="color: #008080;">248</span>             refreshState =<span style="color: #000000;"> expectRefreshState;<br></span><span style="color: #008080;">249</span>             <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> refreshableHelper) {<br></span><span style="color: #008080;">250</span> <span style="color: #000000;">                refreshableHelper.onRefreshStateChanged(refreshHeaderView, refreshState);<br></span><span style="color: #008080;">251</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">252</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">253</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">254</span><br><span style="color: #008080;">255</span><br><span style="color: #008080;">256</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">257</span> <span style="color: #008000;">     <em> æ”¹å˜æŸæ§ä»¶çš„é«˜åº¦<br></em></span><span style="color: #008080;">258</span> <span style="color: #008000;">     <br></span><span style="color: #008080;">259</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> view<br></span><span style="color: #008080;">260</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> height<br></span><span style="color: #008080;">261</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">262</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> changeViewHeight(View view, <span style="color: #0000ff;">int</span><span style="color: #000000;"> height) {<br></span><span style="color: #008080;">263</span>         Log.d(TAG, â€œ[changeViewHeight]change Height: â€œ +<span style="color: #000000;"> height);<br></span><span style="color: #008080;">264</span>         ViewGroup.LayoutParams lp =<span style="color: #000000;"> view.getLayoutParams();<br></span><span style="color: #008080;">265</span>         lp.height =<span style="color: #000000;"> height;<br></span><span style="color: #008080;">266</span> <span style="color: #000000;">        view.setLayoutParams(lp);<br></span><span style="color: #008080;">267</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">268</span><br><span style="color: #008080;">269</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">270</span> <span style="color: #008000;">     <em> æ”¹å˜æŸæ§ä»¶çš„é«˜åº¦åŠ¨ç”»<br></em></span><span style="color: #008080;">271</span> <span style="color: #008000;">     <br></span><span style="color: #008080;">272</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> view<br></span><span style="color: #008080;">273</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> fromHeight<br></span><span style="color: #008080;">274</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> toHeight<br></span><span style="color: #008080;">275</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">276</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> startHeightAnimation(<span style="color: #0000ff;">final</span> View view, <span style="color: #0000ff;">int</span> fromHeight, <span style="color: #0000ff;">int</span><span style="color: #000000;"> toHeight) {<br></span><span style="color: #008080;">277</span>         startHeightAnimation(view, fromHeight, toHeight, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br></span><span style="color: #008080;">278</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">279</span><br><span style="color: #008080;">280</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> startHeightAnimation(<span style="color: #0000ff;">final</span> View view, <span style="color: #0000ff;">int</span> fromHeight, <span style="color: #0000ff;">int</span><span style="color: #000000;"> toHeight, Animator.AnimatorListener animatorListener) {<br></span><span style="color: #008080;">281</span>         <span style="color: #0000ff;">if</span> (toHeight ==<span style="color: #000000;"> view.getMeasuredHeight()) {<br></span><span style="color: #008080;">282</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;">283</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">284</span>         ValueAnimator heightAnimator =<span style="color: #000000;"> ValueAnimator.ofInt(fromHeight, toHeight);<br></span><span style="color: #008080;">285</span>         heightAnimator.addUpdateListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> ValueAnimator.AnimatorUpdateListener() {<br></span><span style="color: #008080;">286</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">287</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onAnimationUpdate(ValueAnimator valueAnimator) {<br></span><span style="color: #008080;">288</span>                 Integer value =<span style="color: #000000;"> (Integer) valueAnimator.getAnimatedValue();<br></span><span style="color: #008080;">289</span>                 <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> == value) <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;">290</span> <span style="color: #000000;">                changeViewHeight(view, value);<br></span><span style="color: #008080;">291</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">292</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">293</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> animatorListener) {<br></span><span style="color: #008080;">294</span> <span style="color: #000000;">            heightAnimator.addListener(animatorListener);<br></span><span style="color: #008080;">295</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">296</span>         heightAnimator.setInterpolator(<span style="color: #0000ff;">new</span><span style="color: #000000;"> LinearInterpolator());<br></span><span style="color: #008080;">297</span>         heightAnimator.setDuration(300<span style="color: #008000;">/<em></em></span><span style="color: #008000;">ms</span><span style="color: #008000;">/</span><span style="color: #000000;">);<br></span><span style="color: #008080;">298</span> <span style="color: #000000;">        heightAnimator.start();<br></span><span style="color: #008080;">299</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">300</span><br><span style="color: #008080;">301</span>     AnimatorListenerAdapter normalAnimatorListener = <span style="color: #0000ff;">new</span><span style="color: #000000;"> AnimatorListenerAdapter() {<br></span><span style="color: #008080;">302</span> <span style="color: #000000;">        @Override<br></span><span style="color: #008080;">303</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onAnimationEnd(Animator animation) {<br></span><span style="color: #008080;">304</span>             <span style="color: #0000ff;">super</span><span style="color: #000000;">.onAnimationEnd(animation);<br></span><span style="color: #008080;">305</span>             setRefreshState(STATE_REFRESH_NORMAL); <span style="color: #008000;">//</span><span style="color: #008000;"> å›å½’æ­£å¸¸çŠ¶æ€</span><br><span style="color: #008080;">306</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">307</span> <span style="color: #000000;">    };<br></span><span style="color: #008080;">308</span><br><span style="color: #008080;">309</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setRefreshArrivedStateHeight(<span style="color: #0000ff;">int</span><span style="color: #000000;"> refreshArrivedStateHeight) {<br></span><span style="color: #008080;">310</span>         <span style="color: #0000ff;">this</span>.refreshArrivedStateHeight =<span style="color: #000000;"> refreshArrivedStateHeight;<br></span><span style="color: #008080;">311</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">312</span><br><span style="color: #008080;">313</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setRefreshingHeight(<span style="color: #0000ff;">int</span><span style="color: #000000;"> refreshingHeight) {<br></span><span style="color: #008080;">314</span>         <span style="color: #0000ff;">this</span>.refreshingHeight =<span style="color: #000000;"> refreshingHeight;<br></span><span style="color: #008080;">315</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">316</span><br><span style="color: #008080;">317</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setRefreshNormalHeight(<span style="color: #0000ff;">int</span><span style="color: #000000;"> refreshNormalHeight) {<br></span><span style="color: #008080;">318</span>         <span style="color: #0000ff;">this</span>.refreshNormalHeight =<span style="color: #000000;"> refreshNormalHeight;<br></span><span style="color: #008080;">319</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">320</span><br><span style="color: #008080;">321</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getOriginRefreshHeight() {<br></span><span style="color: #008080;">322</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> originRefreshHeight;<br></span><span style="color: #008080;">323</span>     }</pre><br></div>

<p>å…¶ä¸­ï¼š</p>
<p>originRefreshHeightï¼Œè¡¨ç¤ºå¤´éƒ¨åˆ·æ–°viewçš„å®é™…é«˜åº¦ã€‚</p>
<p>refreshArrivedStateHeightï¼Œè¡¨ç¤ºä¸‹æ‹‰å¤šå°‘è·ç¦»å¯ä»¥æ‰§è¡Œåˆ·æ–°äº†</p>
<p>refreshingHeightï¼Œè¡¨ç¤ºåˆ·æ–°çš„æ—¶å€™æ˜¾ç¤ºçš„é«˜åº¦æ—¶å¤šå°‘</p>
<p>refreshNormalHeightï¼Œè¡¨ç¤ºæ­£å¸¸çŠ¶æ€ä¸‹refreshHeaderViewæ˜¾ç¤ºçš„é«˜åº¦æ˜¯å¤šå°‘</p>
<p>&nbsp;</p>
<p>ä¸»è¦çš„æ ¸å¿ƒä»£ç åº”è¯¥æ˜¯åœ¨onTouchEventæ–¹æ³•ä¸­ï¼Œ</p>
<p>å…ˆç®€å•åˆ†æé‡Œé¢çš„ä¸»è¦ä»£ç ï¼šåœ¨ACTION_DOWNçš„æ—¶å€™ï¼Œçºªå½•å½“å‰æ‰‹æŒ‡ä¸‹è½çš„yåæ ‡ï¼Œç„¶åå†ACTION_MOVEçš„æ—¶å€™ï¼Œå»è®¡ç®—æ»‘åŠ¨çš„è·ç¦»ï¼Œå¹¶ä¸”åˆ¤æ–­å¦‚æœæ»‘åŠ¨çš„è·ç¦»å¤§äºrefreshArrivedStateHeightï¼Œæ›´æ–°å¤„äºå·²ç»è¾¾åˆ°å¯åˆ·æ–°çš„çŠ¶æ€ï¼Œåä¹‹å°±æ›´æ–°å¤„äºæœªè¾¾åˆ°å¯åˆ·æ–°çš„çŠ¶æ€ã€‚ç„¶åå†ACTION_UPä¸­ï¼Œå¦‚æœå·²ç»è¾¾åˆ°äº†å¯åˆ·æ–°çš„çŠ¶æ€ï¼Œåˆ™æ›´æ–°å½“å‰çŠ¶æ€ä¸ºæ­£åœ¨åˆ·æ–°çŠ¶æ€ï¼Œå¹¶ä¸”å›è°ƒçŠ¶æ€æ”¹å˜çš„æ–¹æ³•ã€‚</p>
<p>&nbsp;</p>
<p>å¦‚æœé‡Œé¢æœ‰ScrollViewç­‰å¯ä»¥æ»šåŠ¨çš„æ§ä»¶çš„æ—¶å€™ï¼Œåº”è¯¥æ€ä¹ˆå¤„ç†é‡Œé¢çš„äº‹ä»¶å‘¢ï¼Ÿ</p>
<p>å°±ä»¥<a href="https://github.com/wangjiegulu/RefreshableView" target="_blank" rel="noopener">https://github.com/wangjiegulu/RefreshableView</a>&nbsp;ä¸ºä¾‹</p>
<p>xmlå¸ƒå±€å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">com.wangjie.refreshableview.RefreshableView<br></span><span style="color: #008080;"> 2</span>             <span style="color: #ff0000;">xmlns:rv</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/com.wangjie.refreshableview" target="_blank" rel="noopener">http://schemas.android.com/apk/res/com.wangjie.refreshableview</a>â€œ</span><br><span style="color: #008080;"> 3</span> <span style="color: #ff0000;">            android:id</span><span style="color: #0000ff;">=â€@+id/main_refresh_viewâ€</span><br><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;"> 6</span> <span style="color: #ff0000;">            rv:interceptAllMoveEvents</span><span style="color: #0000ff;">=â€falseâ€</span><br><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 8</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">com.wangjie.refreshableview.NestScrollView </span><span style="color: #ff0000;">android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"> android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;"> 9</span> <span style="color: #ff0000;">                android:fillViewport</span><span style="color: #0000ff;">=â€trueâ€</span><br><span style="color: #008080;">10</span>                 <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">11</span><br><span style="color: #008080;">12</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">TextView<br></span><span style="color: #008080;">13</span>                     <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/main_tvâ€</span><br><span style="color: #008080;">14</span> <span style="color: #ff0000;">                    android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;">15</span> <span style="color: #ff0000;">                    android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;">16</span> <span style="color: #ff0000;">                    android:gravity</span><span style="color: #0000ff;">=â€centerâ€</span><br><span style="color: #008080;">17</span> <span style="color: #ff0000;">                    android:padding</span><span style="color: #0000ff;">=â€20dpâ€</span><br><span style="color: #008080;">18</span> <span style="color: #ff0000;">                    android:textSize</span><span style="color: #0000ff;">=â€18spâ€</span><br><span style="color: #008080;">19</span> <span style="color: #ff0000;">                    android:text</span><span style="color: #0000ff;">=â€Drop Down For Refresh\n\n\n\n\n\n\n\n\n\n\nDrop Down For Refresh\nDrop Down For Refresh\n\n\n\n\n\n\n\n\n\n\nDrop Down For Refresh\nDrop Down For Refresh\n\n\n\n\n\n\n\n\n\n\nDrop Down For Refresh\nDrop Down For Refresh\n\n\n\n\n\n\n\n\n\n\nDrop Down For Refreshâ€</span><br><span style="color: #008080;">20</span>                     <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">21</span><br><span style="color: #008080;">22</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">com.wangjie.refreshableview.NestScrollView</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">23</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">com.wangjie.refreshableview.RefreshableView</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>å¦‚ä¸Šï¼Œæœ€å¤–é¢æ˜¯ä¸€ä¸ªRefreshableViewï¼Œç„¶åé‡Œé¢æ˜¯ä¸€ä¸ªNestScrollViewï¼ŒNestScrollViewé‡Œé¢æ˜¯TextViewï¼Œå…¶ä¸­TextViewä¸­å› ä¸ºæ–‡å­—è¾ƒå¤šï¼Œæ‰€ä»¥ä½¿ç”¨NestScrollViewæ¥å®ç°æ»šåŠ¨ï¼ˆNestScrollViewæ‰©å±•è‡ªScrollViewï¼Œä¸‹é¢ä¼šè®²åˆ°ï¼‰ã€‚è¿™ä¸ªæ—¶å€™çš„é€»è¾‘åº”è¯¥æ˜¯ï¼Œå½“NestScrollViewå¤„äºé¡¶éƒ¨çš„æ—¶å€™ï¼Œæ‰‹æŒ‡å‘ä¸‹æ»‘åŠ¨ï¼Œè¿™æ—¶è¿™ä¸ªtouchäº‹ä»¶åº”è¯¥äº¤ç»™RefreshableViewå¤„ç†ï¼›å½“æ‰‹æŒ‡å‘ä¸Šæ»‘åŠ¨æ—¶ï¼Œä¹Ÿå°±æ˜¯ScrollViewå‘ä¸‹æ»šåŠ¨ï¼Œè¿™æ—¶ï¼Œéœ€è¦æŠŠtouchäº‹ä»¶ç»™RefreshableViewæ¥å¤„ç†ã€‚</p>
<p>&nbsp;</p>
<p>ä¸‹é¢åˆ†æé‡Œé¢çš„ä»£ç ï¼š</p>
<p>RefreshableViewçš„interceptAllMoveEventsè¡¨ç¤ºæ˜¯å¦éœ€è¦RefreshableViewé˜»æ­¢æ‰€æœ‰MOVEçš„äº‹ä»¶ï¼ˆä¹Ÿå°±æ˜¯è¯´ç”±RefreshableViewè‡ªå·±å¤„ç†æ‰€æœ‰MOVEäº‹ä»¶ï¼‰ï¼Œå¦‚æœè‡ªæ§ä»¶ä¸­æ²¡æœ‰ScrollViewç­‰éœ€è¦å¤„ç†MOVEäº‹ä»¶çš„æ§ä»¶ï¼Œåˆ™å¯ä»¥è®¾ç½®ä¸ºtrueï¼›å¦‚æœæœ‰ç±»ä¼¼ScrollViewç­‰æ§ä»¶ï¼Œåˆ™éœ€è¦è®¾ç½®ä¸ºfalseï¼Œè¿™æ ·çš„è¯ï¼ŒRefreshableViewä¼šæŠŠMOVEäº‹ä»¶ä¼ é€’ç»™å­ç±»ï¼Œç”±å­ç±»å»å¤„ç†ã€‚æ˜¾ç„¶ï¼Œç°åœ¨ä¾‹å­ä¸­çš„æƒ…å†µæ˜¯éœ€è¦æŠŠinterceptAllMoveEventsè®¾ç½®ä¸ºfalseã€‚è®¾ç½®çš„æ–¹æ³•å¯ä»¥çœ‹ä¸Šé¢çš„xmlæ–‡ä»¶ï¼Œä½¿ç”¨rv:interceptAllMoveEvents=â€falseâ€è¿™ä¸ªå±æ€§å³å¯ã€‚</p>
<p>onInterceptTouchEvent()æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è¿”å›çš„æ˜¯disallowInterceptï¼Œè¿™ä¸ªdisallowInterceptæ˜¯æ ¹æ®requestDisallowInterceptTouchEvent()æ–¹æ³•çš„è°ƒç”¨æ¥åŠ¨æ€å˜åŒ–çš„ï¼Œè¿™æ ·å¯ä»¥åšåˆ°åˆ‡æ¢touchäº‹ä»¶çš„å¤„ç†å¯¹è±¡ã€‚</p>
<p>åœ¨æ‰‹æŒ‡è½ä¸‹çš„æ—¶å€™ï¼Œå…ˆè°ƒç”¨requestDisallowInterceptTouchEvent()æ–¹æ³•ï¼Œä¿è¯å½“å‰çš„äº‹ä»¶å¯ä»¥æ­£å¸¸å¾€å­æ§ä»¶ä¼ é€’ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨çš„ScrollViewã€‚ç„¶åæ‰‹æŒ‡ä¼šå¼€å§‹ç§»åŠ¨ï¼Œåœ¨ACTION_MOVEä¸­ï¼Œå…ˆè®¡ç®—å‡ºå½“å‰æ»‘åŠ¨çš„è·ç¦»ã€‚</p>
<p>å¦‚æœæ˜¯æœ‰æ•ˆå¾€ä¸‹æ‹–åŠ¨äº‹ä»¶ï¼Œåˆ™äº‹ä»¶éœ€è¦åœ¨RefreshableViewä¸­å¤„ç†ï¼Œæ‰€ä»¥éœ€è¦æ‹¦æˆªä¸å¾€å­æ§ä»¶ä¼ é€’ï¼Œå³ä¸å…è®¸æ‹¦æˆªè®¾ä¸ºfalseï¼›å¦‚æœä¸æ˜¯æœ‰æ•ˆå¾€ä¸‹æ‹–åŠ¨äº‹ä»¶ï¼Œåˆ™äº‹ä»¶ä¼ é€’ç»™å­æ§ä»¶å¤„ç†ï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹¦æˆªï¼Œå¹¶å¾€å­æ§ä»¶ä¼ é€’ï¼Œå³ä¸å…è®¸æ‹¦æˆªè®¾ä¸ºtrueã€‚</p>
<p>æ€ä¹ˆå»åˆ¤æ–­æ˜¯å¦æœ‰æ•ˆå‘¢ï¼Ÿæ ¹æ®downYï¼Œå¦‚æœdownYæ˜¯åŸæ¥çš„åˆå§‹å€¼Float.MAX_VALUEï¼Œè¯´æ˜ï¼Œè¿™ä¸ªMOVEäº‹ä»¶åˆšå¼€å§‹DOWNçš„æ—¶å€™æ˜¯è¢«å­æ§ä»¶å¤„ç†çš„ï¼Œè€Œä¸æ˜¯RefreshableViewå¤„ç†çš„ï¼Œè¯´æ˜å¯¹äºRefreshableViewæ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªæ— æ•ˆçš„å¾€ä¸‹æ‹–åŠ¨äº‹ä»¶ï¼›å¦‚æœdownYä¸æ˜¯åŸæ¥çš„åˆå§‹å€¼Float.MAX_VALUEï¼Œè¯´æ˜ï¼Œè¿™ä¸ªMOVEäº‹ä»¶åœ¨DOWNçš„æ—¶å€™å°±å·²ç»æ˜¯RefreshableViewå¤„ç†çš„äº†ï¼Œæ‰€ä»¥æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<p>ç„¶åï¼Œè®¡ç®—refreshHeaderViewçš„é«˜åº¦ï¼Œæ ¹æ®æ»‘åŠ¨çš„å·®é‡å¯¹refreshHeaderViewçš„é«˜åº¦è¿›è¡Œå˜æ¢ã€‚</p>
<p>å¦‚æœå½“å‰çš„çŠ¶æ€æ˜¯æ­£åœ¨åˆ·æ–°ï¼Œé‚£MOVEäº‹ä»¶ç›´æ¥æ— æ•ˆã€‚</p>
<p>å¦åˆ™ï¼Œå†å»åˆ¤æ–­å½“å‰çš„é«˜åº¦æ˜¯ä¸æ˜¯è¾¾åˆ°äº†å¯åˆ·æ–°çŠ¶æ€ï¼Œæˆ–è€…æ²¡æœ‰è¾¾åˆ°å¯åˆ·æ–°çŠ¶æ€ï¼Œæ›´æ–°çŠ¶æ€å€¼ã€‚</p>
<p>åœ¨UPçš„æ—¶å€™ï¼Œè¿˜æ˜¯å…ˆä¿è¯äº‹ä»¶å¾€ä¸‹ä¼ é€’ã€‚å¹¶é‡ç½®downYã€‚ç„¶åæ ¹æ®å½“å‰çš„çŠ¶æ€ï¼Œå¦‚æœè¾¾åˆ°äº†åˆ·æ–°çš„çŠ¶æ€ï¼Œåˆ™å¼€å§‹åˆ·æ–°ï¼Œå¹¶æ›´æ–°å½“å‰çš„é¢çŠ¶æ€æ—¶æ­£åœ¨åˆ·æ–°çŠ¶æ€ï¼›å¦‚æœæ²¡æœ‰è¾¾åˆ°åˆ·æ–°çŠ¶æ€ï¼Œåˆ™æ‰§è¡ŒåŠ¨ç”»è¿”å›åˆ°æ­£å¸¸çŠ¶æ€ï¼›å¦‚æœæœ¬æ¥å°±æ˜¯æ­£åœ¨åˆ·æ–°çŠ¶æ€ï¼Œä¹Ÿæ‰§è¡ŒåŠ¨ç”»å›å½’åˆ°æ­£åœ¨åˆ·æ–°çš„é«˜åº¦ã€‚</p>
<p>&nbsp;</p>
<p>ç„¶ååˆ†æä¸‹NestScrollViewï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;"> <em> Author: wangjie<br></em></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">  Email: tiantian.china.2@gmail.com<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;"> <em> Date: 12/13/14.<br></em></span><span style="color: #008080;"> 5</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> NestScrollView <span style="color: #0000ff;">extends</span><span style="color: #000000;"> ScrollView {<br></span><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = NestScrollView.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> NestScrollView(Context context) {<br></span><span style="color: #008080;">10</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context);<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> NestScrollView(Context context, AttributeSet attrs) {<br></span><span style="color: #008080;">14</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, attrs);<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span> NestScrollView(Context context, AttributeSet attrs, <span style="color: #0000ff;">int</span><span style="color: #000000;"> defStyle) {<br></span><span style="color: #008080;">18</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, attrs, defStyle);<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">22</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> dispatchTouchEvent(MotionEvent ev) {<br></span><span style="color: #008080;">23</span>         Log.d(TAG, â€œ<strong><em>[dispatchTouchEvent]ev action: â€œ +<span style="color: #000000;"> ev.getAction());<br></span><span style="color: #008080;">24</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">super</span><span style="color: #000000;">.dispatchTouchEvent(ev);<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">28</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> onInterceptTouchEvent(MotionEvent ev) {<br></span><span style="color: #008080;">29</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onInterceptTouchEvent(ev);<br></span><span style="color: #008080;">30</span>         Log.d(TAG, â€œ</em></strong>[onInterceptTouchEvent]ev action: â€œ +<span style="color: #000000;"> ev.getAction());<br></span><span style="color: #008080;">31</span>         <span style="color: #0000ff;">if</span> (MotionEvent.ACTION_MOVE ==<span style="color: #000000;"> ev.getAction()) {<br></span><span style="color: #008080;">32</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">34</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">35</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">36</span><br><span style="color: #008080;">37</span>     <span style="color: #0000ff;">float</span><span style="color: #000000;"> lastDownY;<br></span><span style="color: #008080;">38</span><br><span style="color: #008080;">39</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">40</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> onTouchEvent(MotionEvent event) {<br></span><span style="color: #008080;">41</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onTouchEvent(event);<br></span><span style="color: #008080;">42</span>         <span style="color: #0000ff;">switch</span><span style="color: #000000;"> (event.getAction()) {<br></span><span style="color: #008080;">43</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION_DOWN:<br></span><span style="color: #008080;">44</span>                 lastDownY =<span style="color: #000000;"> event.getY();<br></span><span style="color: #008080;">45</span>                 parentRequestDisallowInterceptTouchEvent(<span style="color: #0000ff;">true</span>); <span style="color: #008000;">//</span><span style="color: #008000;"> ä¿è¯äº‹ä»¶å¯å¾€ä¸‹ä¼ é€’</span><br><span style="color: #008080;">46</span>                 Log.d(TAG, â€œ<strong>_Downâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">47</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">48</span> <span style="color: #008000;">//</span><span style="color: #008000;">                break;</span><br><span style="color: #008080;">49</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION<em>MOVE:<br></em></span><span style="color: #008080;">50</span>                 Log.d(TAG, â€œ</strong>move, this.getScrollY(): â€œ + <span style="color: #0000ff;">this</span><span style="color: #000000;">.getScrollY());<br></span><span style="color: #008080;">51</span>                 <span style="color: #0000ff;">boolean</span> isTop = event.getY() - lastDownY &gt; 0 &amp;&amp; <span style="color: #0000ff;">this</span>.getScrollY() == 0<span style="color: #000000;">;<br></span><span style="color: #008080;">52</span>                 <span style="color: #0000ff;">if</span> (isTop) { <span style="color: #008000;">//</span><span style="color: #008000;"> å…è®¸çˆ¶æ§ä»¶æ‹¦æˆªï¼Œå³ä¸å…è®¸çˆ¶æ§ä»¶æ‹¦æˆªè®¾ä¸ºfalse</span><br><span style="color: #008080;">53</span>                     parentRequestDisallowInterceptTouchEvent(<span style="color: #0000ff;">false</span><span style="color: #000000;">);<br></span><span style="color: #008080;">54</span>                     <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">55</span>                 } <span style="color: #0000ff;">else</span> { <span style="color: #008000;">//</span><span style="color: #008000;"> ä¸å…è®¸çˆ¶æ§ä»¶æ‹¦æˆªï¼Œå³ä¸å…è®¸çˆ¶æ§ä»¶æ‹¦æˆªè®¾ä¸ºtrue</span><br><span style="color: #008080;">56</span>                     parentRequestDisallowInterceptTouchEvent(<span style="color: #0000ff;">true</span><span style="color: #000000;">);<br></span><span style="color: #008080;">57</span>                     <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">58</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">59</span> <span style="color: #008000;">//</span><span style="color: #008000;">                break;</span><br><span style="color: #008080;">60</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION_UP:<br></span><span style="color: #008080;">61</span>                 Log.d(TAG, â€œ<strong>_up, this.getScrollY(): â€œ + <span style="color: #0000ff;">this</span><span style="color: #000000;">.getScrollY());<br></span><span style="color: #008080;">62</span>                 parentRequestDisallowInterceptTouchEvent(<span style="color: #0000ff;">true</span>); <span style="color: #008000;">//</span><span style="color: #008000;"> ä¿è¯äº‹ä»¶å¯å¾€ä¸‹ä¼ é€’</span><br><span style="color: #008080;">63</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">64</span>             <span style="color: #0000ff;">case</span><span style="color: #000000;"> MotionEvent.ACTION<em>CANCEL:<br></em></span><span style="color: #008080;">65</span>                 Log.d(TAG, â€œ</strong>cancelâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">66</span>                 <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">67</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">68</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">69</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">70</span><br><span style="color: #008080;">71</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">72</span> <span style="color: #008000;">     <em> æ˜¯å¦å…è®¸çˆ¶æ§ä»¶æ‹¦æˆªäº‹ä»¶<br></em></span><span style="color: #008080;">73</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> disallowIntercept<br></span><span style="color: #008080;">74</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">75</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> parentRequestDisallowInterceptTouchEvent(<span style="color: #0000ff;">boolean</span><span style="color: #000000;"> disallowIntercept) {<br></span><span style="color: #008080;">76</span>         ViewParent vp =<span style="color: #000000;"> getParent();<br></span><span style="color: #008080;">77</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> vp) {<br></span><span style="color: #008080;">78</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;">79</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">80</span> <span style="color: #000000;">        vp.requestDisallowInterceptTouchEvent(disallowIntercept);<br></span><span style="color: #008080;">81</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">82</span><br><span style="color: #008080;">83</span> }</pre><br></div>

<p>å¦‚ä¸Šæ‰€ç¤ºï¼Œä¹Ÿéœ€è¦é‡å†™onInterceptTouchEvent()æ–¹æ³•ï¼Œå®ƒéœ€è¦æŠŠé™¤äº†MOVEäº‹ä»¶å¤–çš„æ‰€æœ‰äº‹ä»¶ä¼ é€’ä¸‹å»ï¼Œè¿™æ ·æœ€é‡Œé¢çš„TextViewæ‰æœ‰OnClickç­‰äº‹ä»¶ã€‚</p>
<p>åœ¨onTouchEventæ–¹æ³•ä¸­ï¼Œåœ¨ACTION_DOWNçš„æ—¶å€™ï¼Œå…ˆçºªå½•downçš„yåæ ‡ï¼Œç„¶åä¿è¯parentï¼ˆå³ï¼ŒRefreshableViewï¼‰çš„äº‹ä»¶å¯ä»¥ä¼ é€’è¿‡æ¥ï¼Œæ‰€ä»¥éœ€è¦è°ƒç”¨getParent().requestDisallowInterceptTouchEvent()æ–¹æ³•ã€‚å› ä¸ºä¸‹æ‹‰åˆ·æ–°åªèƒ½å‘ç”Ÿåœ¨ScrollViewæ»šåŠ¨æ¡åœ¨é¡¶éƒ¨çš„æ—¶å€™ï¼Œæ‰€ä»¥åœ¨MOVEä¸­ï¼Œå¦‚æœå½“å‰çŠ¶æ€åœ¨é¡¶éƒ¨ï¼Œé‚£å°±éœ€è¦è®©çˆ¶æ§ä»¶ï¼ˆRefreshableViewï¼‰æ‹¦æˆªï¼Œç„¶åç›´æ¥è¿”å›falseï¼Œè®©å½“å‰çš„äº‹ä»¶ä¼ é€’åˆ°RefreshableViewä¸­çš„onTouchEventæ–¹æ³•ä¸­å¤„ç†ã€‚å¦‚æœä¸æ˜¯åœ¨topï¼Œé‚£å°±å±è”½è°ƒç”¨çˆ¶æ§ä»¶ï¼ˆRefreshableViewï¼‰çš„å¤„ç†ï¼Œç›´æ¥è‡ªå·±å¤„ç†ã€‚æœ€ååœ¨UPçš„æ—¶å€™å†ç¡®ä¿äº‹ä»¶å¯ä»¥ä¼ é€’åˆ°ScrollViewè¿™é‡Œæ¥ã€‚</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> view </tag>
            
            <tag> RefreshableView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åŸºäºgitçš„æºä»£ç ç®¡ç†æ¨¡å‹â€”â€”git flow]]></title>
      <url>/2014/12/11/%E5%9F%BA%E4%BA%8Egit%E7%9A%84%E6%BA%90%E4%BB%A3%E7%A0%81%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9E%8B%E2%80%94%E2%80%94git-flow/</url>
      <content type="html"><![CDATA[<p><strong>è¯´æ˜ï¼š</strong>&nbsp;æœ¬æ–‡ä»¥nvieçš„&ldquo;<a href="http://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener">a successful git branching model</a>&rdquo;ä¸ºè“æœ¬ï¼Œç»“åˆæˆ‘ä¸ªäººç†è§£å†™æˆã€‚å¦‚æœ‰è°¬è¯¯ï¼Œè¿˜è¯·å„ä½æŒ‡å‡ºã€‚å¤šè°¢ï¼</p>
<p><strong>Note:</strong>&nbsp;This article is highly based on nvieâ€™s&nbsp;<a href="http://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener">a successful git branching model</a>. Thanks nvie.</p>
<div class="post-text"><br><br># Git Flow æ˜¯ä»€ä¹ˆ<br><br>Git Flowæ˜¯æ„å»ºåœ¨Gitä¹‹ä¸Šçš„ä¸€ä¸ªç»„ç»‡è½¯ä»¶å¼€å‘æ´»åŠ¨çš„æ¨¡å‹ï¼Œæ˜¯åœ¨Gitä¹‹ä¸Šæ„å»ºçš„ä¸€é¡¹è½¯ä»¶å¼€å‘æœ€ä½³å®è·µã€‚Git Flowæ˜¯ä¸€å¥—ä½¿ç”¨Gitè¿›è¡Œæºä»£ç ç®¡ç†æ—¶çš„ä¸€å¥—è¡Œä¸ºè§„èŒƒå’Œç®€åŒ–éƒ¨åˆ†Gitæ“ä½œçš„å·¥å…·ã€‚<br><br>2010å¹´5æœˆï¼Œåœ¨ä¸€ç¯‡åä¸º&ldquo;<a href="http://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener">ä¸€ç§æˆåŠŸçš„Gitåˆ†æ”¯æ¨¡å‹</a>&rdquo;çš„åšæ–‡ä¸­ï¼Œ@nvieä»‹ç»äº†ä¸€ç§åœ¨Gitä¹‹ä¸Šçš„è½¯ä»¶å¼€å‘æ¨¡å‹ã€‚é€šè¿‡åˆ©ç”¨Gitåˆ›å»ºå’Œç®¡ç†åˆ†æ”¯çš„èƒ½åŠ›ï¼Œä¸ºæ¯ä¸ªåˆ†æ”¯è®¾å®šå…·æœ‰ç‰¹å®šçš„å«ä¹‰åç§°ï¼Œå¹¶å°†è½¯ä»¶ç”Ÿå‘½å‘¨æœŸä¸­çš„å„ç±»æ´»åŠ¨å½’å¹¶åˆ°ä¸åŒçš„åˆ†æ”¯ä¸Šã€‚å®ç°äº†è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸åŒæ“ä½œçš„ç›¸äº’éš”ç¦»ã€‚è¿™ç§è½¯ä»¶å¼€å‘çš„æ´»åŠ¨æ¨¡å‹è¢«nwieç§°ä¸º&ldquo;Git Flow&rdquo;ã€‚<br><br>ä¸€èˆ¬è€Œè¨€ï¼Œè½¯ä»¶å¼€å‘æ¨¡å‹æœ‰å¸¸è§çš„ç€‘å¸ƒæ¨¡å‹ã€è¿­ä»£å¼€å‘æ¨¡å‹ã€ä»¥åŠæœ€è¿‘å‡ºç°çš„æ•æ·å¼€å‘æ¨¡å‹ç­‰ä¸åŒçš„æ¨¡å‹ã€‚æ¯ç§æ¨¡å‹æœ‰å„è‡ªåº”ç”¨åœºæ™¯ã€‚Git Flowé‡ç‚¹è§£å†³çš„æ˜¯ç”±äºæºä»£ç åœ¨å¼€å‘è¿‡ç¨‹ä¸­çš„å„ç§å†²çªå¯¼è‡´å¼€å‘æ´»åŠ¨æ··ä¹±çš„é—®é¢˜ã€‚å› æ­¤ï¼ŒGit flowå¯ä»¥å¾ˆå¥½çš„äºå„ç§ç°æœ‰å¼€å‘æ¨¡å‹ç›¸ç»“åˆä½¿ç”¨ã€‚<br><br>åœ¨å¼€å§‹ç ”ç©¶Git Flowçš„å…·ä½“å†…å®¹å‰ï¼Œä¸‹é¢è¿™å¼ å›¾å¯ä»¥çœ‹åˆ°æ¨¡å‹çš„å…¨è²Œï¼ˆå¼•è‡ªnvieçš„<a href="http://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener">åšæ–‡</a>)ï¼š<br><br>&nbsp;<br><br># Git Flowä¸­çš„åˆ†æ”¯<br><br>Git Flowæ¨¡å‹ä¸­å®šä¹‰äº†ä¸»åˆ†æ”¯å’Œè¾…åŠ©åˆ†æ”¯ä¸¤ç±»åˆ†æ”¯ã€‚å…¶ä¸­ä¸»åˆ†æ”¯ç”¨äºç»„ç»‡ä¸è½¯ä»¶å¼€å‘ã€éƒ¨ç½²ç›¸å…³çš„æ´»åŠ¨ï¼›è¾…åŠ©åˆ†æ”¯ç»„ç»‡ä¸ºäº†è§£å†³ç‰¹å®šçš„é—®é¢˜è€Œè¿›è¡Œçš„å„ç§å¼€å‘æ´»åŠ¨ã€‚<br><br>## ä¸»åˆ†æ”¯<br><br>ä¸»åˆ†æ”¯æ˜¯æ‰€æœ‰å¼€å‘æ´»åŠ¨çš„æ ¸å¿ƒåˆ†æ”¯ã€‚æ‰€æœ‰çš„å¼€å‘æ´»åŠ¨äº§ç”Ÿçš„è¾“å‡ºç‰©æœ€ç»ˆéƒ½ä¼šåæ˜ åˆ°ä¸»åˆ†æ”¯çš„ä»£ç ä¸­ã€‚ä¸»åˆ†æ”¯åˆ†ä¸ºmasteråˆ†æ”¯å’Œdevelopmentåˆ†æ”¯ã€‚<br><br>&nbsp;<br><br>### masteråˆ†æ”¯<br><br>masteråˆ†æ”¯ä¸Šå­˜æ”¾çš„åº”è¯¥æ˜¯éšæ—¶å¯ä¾›åœ¨ç”Ÿäº§ç¯å¢ƒä¸­éƒ¨ç½²çš„ä»£ç ï¼ˆProduction Ready stateï¼‰ã€‚å½“å¼€å‘æ´»åŠ¨å‘Šä¸€æ®µè½ï¼Œäº§ç”Ÿäº†ä¸€ä»½æ–°çš„å¯ä¾›éƒ¨ç½²çš„ä»£ç æ—¶ï¼Œmasteråˆ†æ”¯ä¸Šçš„ä»£ç ä¼šè¢«æ›´æ–°ã€‚åŒæ—¶ï¼Œæ¯ä¸€æ¬¡æ›´æ–°ï¼Œæœ€å¥½æ·»åŠ å¯¹åº”çš„ç‰ˆæœ¬å·æ ‡ç­¾ï¼ˆTAGï¼‰ã€‚<br><br>### developåˆ†æ”¯<br><br>developåˆ†æ”¯æ˜¯ä¿å­˜å½“å‰æœ€æ–°å¼€å‘æˆæœçš„åˆ†æ”¯ã€‚é€šå¸¸è¿™ä¸ªåˆ†æ”¯ä¸Šçš„ä»£ç ä¹Ÿæ˜¯å¯è¿›è¡Œæ¯æ—¥å¤œé—´å‘å¸ƒçš„ä»£ç ï¼ˆNightly buildï¼‰ã€‚å› æ­¤è¿™ä¸ªåˆ†æ”¯æœ‰æ—¶ä¹Ÿå¯ä»¥è¢«ç§°ä½œ&ldquo;integration branch&rdquo;ã€‚<br><br>å½“developåˆ†æ”¯ä¸Šçš„ä»£ç å·²å®ç°äº†è½¯ä»¶éœ€æ±‚è¯´æ˜ä¹¦ä¸­æ‰€æœ‰çš„åŠŸèƒ½ï¼Œé€šè¿‡äº†æ‰€æœ‰çš„æµ‹è¯•åï¼Œå¹¶ä¸”ä»£ç å·²ç»è¶³å¤Ÿç¨³å®šæ—¶ï¼Œå°±å¯ä»¥å°†æ‰€æœ‰çš„å¼€å‘æˆæœåˆå¹¶å›masteråˆ†æ”¯äº†ã€‚å¯¹äºmasteråˆ†æ”¯ä¸Šçš„æ–°æäº¤çš„ä»£ç å»ºè®®éƒ½æ‰“ä¸Šä¸€ä¸ªæ–°çš„ç‰ˆæœ¬å·æ ‡ç­¾ï¼ˆTAGï¼‰ï¼Œä¾›åç»­ä»£ç è·Ÿè¸ªä½¿ç”¨ã€‚<br><br>å› æ­¤ï¼Œæ¯æ¬¡å°†developåˆ†æ”¯ä¸Šçš„ä»£ç åˆå¹¶å›masteråˆ†æ”¯æ—¶ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥è®¤ä¸ºä¸€ä¸ªæ–°çš„å¯ä¾›åœ¨ç”Ÿäº§ç¯å¢ƒä¸­éƒ¨ç½²çš„ç‰ˆæœ¬å°±äº§ç”Ÿäº†ã€‚é€šå¸¸è€Œè¨€ï¼Œ&ldquo;ä»…åœ¨å‘å¸ƒæ–°çš„å¯ä¾›éƒ¨ç½²çš„ä»£ç æ—¶æ‰æ›´æ–°masteråˆ†æ”¯ä¸Šçš„ä»£ç &rdquo;æ˜¯æ¨èæ‰€æœ‰äººéƒ½éµå®ˆçš„è¡Œä¸ºå‡†åˆ™ã€‚åŸºäºæ­¤ï¼Œç†è®ºä¸Šè¯´ï¼Œæ¯å½“æœ‰ä»£ç æäº¤åˆ°masteråˆ†æ”¯æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Git Hookè§¦å‘è½¯ä»¶è‡ªåŠ¨æµ‹è¯•ä»¥åŠç”Ÿäº§ç¯å¢ƒä»£ç çš„è‡ªåŠ¨æ›´æ–°å·¥ä½œã€‚è¿™äº›è‡ªåŠ¨åŒ–æ“ä½œå°†æœ‰åˆ©äºå‡å°‘æ–°ä»£ç å‘å¸ƒä¹‹åçš„ä¸€äº›äº‹åŠ¡æ€§å·¥ä½œã€‚<br><br>## è¾…åŠ©åˆ†æ”¯<br><br>è¾…åŠ©åˆ†æ”¯æ˜¯ç”¨äºç»„ç»‡è§£å†³ç‰¹å®šé—®é¢˜çš„å„ç§è½¯ä»¶å¼€å‘æ´»åŠ¨çš„åˆ†æ”¯ã€‚è¾…åŠ©åˆ†æ”¯ä¸»è¦ç”¨äºç»„ç»‡è½¯ä»¶æ–°åŠŸèƒ½çš„å¹¶è¡Œå¼€å‘ã€ç®€åŒ–æ–°åŠŸèƒ½å¼€å‘ä»£ç çš„è·Ÿè¸ªã€è¾…åŠ©å®Œæˆç‰ˆæœ¬å‘å¸ƒå·¥ä½œä»¥åŠå¯¹ç”Ÿäº§ä»£ç çš„ç¼ºé™·è¿›è¡Œç´§æ€¥ä¿®å¤å·¥ä½œã€‚è¿™äº›åˆ†æ”¯ä¸ä¸»åˆ†æ”¯ä¸åŒï¼Œé€šå¸¸åªä¼šåœ¨æœ‰é™çš„æ—¶é—´èŒƒå›´å†…å­˜åœ¨ã€‚<br><br>è¾…åŠ©åˆ†æ”¯åŒ…æ‹¬ï¼š<br><br><em>   ç”¨äºå¼€å‘æ–°åŠŸèƒ½æ—¶æ‰€ä½¿ç”¨çš„featureåˆ†æ”¯ï¼›
</em>   ç”¨äºè¾…åŠ©ç‰ˆæœ¬å‘å¸ƒçš„releaseåˆ†æ”¯ï¼›<br><em>   ç”¨äºä¿®æ­£ç”Ÿäº§ä»£ç ä¸­çš„ç¼ºé™·çš„hotfixåˆ†æ”¯ã€‚<br><br>ä»¥ä¸Šè¿™äº›åˆ†æ”¯éƒ½æœ‰å›ºå®šçš„ä½¿ç”¨ç›®çš„å’Œåˆ†æ”¯æ“ä½œé™åˆ¶ã€‚ä»å•çº¯æŠ€æœ¯çš„è§’åº¦è¯´ï¼Œè¿™äº›åˆ†æ”¯ä¸Gitå…¶ä»–åˆ†æ”¯å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä½†é€šè¿‡å‘½åï¼Œæˆ‘ä»¬å®šä¹‰äº†ä½¿ç”¨è¿™äº›åˆ†æ”¯çš„æ–¹æ³•ã€‚<br><br>### featureåˆ†æ”¯<br><br>ä½¿ç”¨è§„èŒƒï¼š

</em>   å¯ä»¥ä»developåˆ†æ”¯å‘èµ·featureåˆ†æ”¯<br><em>   ä»£ç å¿…é¡»åˆå¹¶å›developåˆ†æ”¯
</em>   featureåˆ†æ”¯çš„å‘½åå¯ä»¥ä½¿ç”¨é™¤<code>master</code>ï¼Œ<code>develop</code>ï¼Œ<code>release-*</code>ï¼Œ<code>hotfix-*</code>ä¹‹å¤–çš„ä»»ä½•åç§°<br><br>featureåˆ†æ”¯ï¼ˆæœ‰æ—¶ä¹Ÿå¯ä»¥è¢«å«åš&ldquo;topicåˆ†æ”¯&rdquo;ï¼‰é€šå¸¸æ˜¯åœ¨å¼€å‘ä¸€é¡¹æ–°çš„è½¯ä»¶åŠŸèƒ½çš„æ—¶å€™ä½¿ç”¨ï¼Œè¿™ä¸ªåˆ†æ”¯ä¸Šçš„ä»£ç å˜æ›´æœ€ç»ˆåˆå¹¶å›developåˆ†æ”¯æˆ–è€…å¹²è„†è¢«æŠ›å¼ƒæ‰ï¼ˆä¾‹å¦‚å®éªŒæ€§ä¸”æ•ˆæœä¸å¥½çš„ä»£ç å˜æ›´ï¼‰ã€‚<br><br>ä¸€èˆ¬è€Œè¨€ï¼Œfeatureåˆ†æ”¯ä»£ç å¯ä»¥ä¿å­˜åœ¨å¼€å‘è€…è‡ªå·±çš„ä»£ç åº“ä¸­è€Œä¸å¼ºåˆ¶æäº¤åˆ°ä¸»ä»£ç åº“é‡Œã€‚<br><br>&nbsp;<br><br>### releaseåˆ†æ”¯<br><br>ä½¿ç”¨è§„èŒƒï¼š<br><br><em>   å¯ä»¥ä»developåˆ†æ”¯æ´¾ç”Ÿ
</em>   å¿…é¡»åˆå¹¶å›developåˆ†æ”¯å’Œmasteråˆ†æ”¯<br><em>   åˆ†æ”¯å‘½åæƒ¯ä¾‹ï¼š`release-</em><code>releaseåˆ†æ”¯æ˜¯ä¸ºå‘å¸ƒæ–°çš„äº§å“ç‰ˆæœ¬è€Œè®¾è®¡çš„ã€‚åœ¨è¿™ä¸ªåˆ†æ”¯ä¸Šçš„ä»£ç å…è®¸åšå°çš„ç¼ºé™·ä¿®æ­£ã€å‡†å¤‡å‘å¸ƒç‰ˆæœ¬æ‰€éœ€çš„å„é¡¹è¯´æ˜ä¿¡æ¯ï¼ˆç‰ˆæœ¬å·ã€å‘å¸ƒæ—¶é—´ã€ç¼–è¯‘æ—¶é—´ç­‰ç­‰ï¼‰ã€‚é€šè¿‡åœ¨releaseåˆ†æ”¯ä¸Šè¿›è¡Œè¿™äº›å·¥ä½œå¯ä»¥è®©developåˆ†æ”¯ç©ºé—²å‡ºæ¥ä»¥æ¥å—æ–°çš„featureåˆ†æ”¯ä¸Šçš„ä»£ç æäº¤ï¼Œè¿›å…¥æ–°çš„è½¯ä»¶å¼€å‘è¿­ä»£å‘¨æœŸã€‚

å½“developåˆ†æ”¯ä¸Šçš„ä»£ç å·²ç»åŒ…å«äº†æ‰€æœ‰å³å°†å‘å¸ƒçš„ç‰ˆæœ¬ä¸­æ‰€è®¡åˆ’åŒ…å«çš„è½¯ä»¶åŠŸèƒ½ï¼Œå¹¶ä¸”å·²é€šè¿‡æ‰€æœ‰æµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘å‡†å¤‡åˆ›å»ºreleaseåˆ†æ”¯äº†ã€‚è€Œæ‰€æœ‰åœ¨å½“å‰å³å°†å‘å¸ƒçš„ç‰ˆæœ¬ä¹‹å¤–çš„ä¸šåŠ¡éœ€æ±‚ä¸€å®šè¦ç¡®ä¿ä¸èƒ½æ··åˆ°releaseåˆ†æ”¯ä¹‹å†…ï¼ˆé¿å…ç”±æ­¤å¼•å…¥ä¸€äº›ä¸å¯æ§çš„ç³»ç»Ÿç¼ºé™·ï¼‰ã€‚

æˆåŠŸçš„æ´¾ç”Ÿäº†releaseåˆ†æ”¯ï¼Œå¹¶è¢«èµ‹äºˆç‰ˆæœ¬å·ä¹‹åï¼Œdevelopåˆ†æ”¯å°±å¯ä»¥ä¸º&amp;ldquo;ä¸‹ä¸€ä¸ªç‰ˆæœ¬&amp;rdquo;æœåŠ¡äº†ã€‚æ‰€è°“çš„&amp;ldquo;ä¸‹ä¸€ä¸ªç‰ˆæœ¬&amp;rdquo;æ˜¯åœ¨å½“å‰å³å°†å‘å¸ƒçš„ç‰ˆæœ¬ä¹‹åå‘å¸ƒçš„ç‰ˆæœ¬ã€‚ç‰ˆæœ¬å·çš„å‘½åå¯ä»¥ä¾æ®é¡¹ç›®å®šä¹‰çš„ç‰ˆæœ¬å·å‘½åè§„åˆ™è¿›è¡Œã€‚

### hotfixåˆ†æ”¯

ä½¿ç”¨è§„èŒƒï¼š

*   å¯ä»¥ä»masteråˆ†æ”¯æ´¾ç”Ÿ
*   å¿…é¡»åˆå¹¶å›masteråˆ†æ”¯å’Œdevelopåˆ†æ”¯
*   åˆ†æ”¯å‘½åæƒ¯ä¾‹ï¼š</code>hotfix-<em><code>é™¤äº†æ˜¯è®¡åˆ’å¤–åˆ›å»ºçš„ä»¥å¤–ï¼Œhotfixåˆ†æ”¯ä¸releaseåˆ†æ”¯ååˆ†ç›¸ä¼¼ï¼šéƒ½å¯ä»¥äº§ç”Ÿä¸€ä¸ªæ–°çš„å¯ä¾›åœ¨ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²çš„è½¯ä»¶ç‰ˆæœ¬ã€‚

å½“ç”Ÿäº§ç¯å¢ƒä¸­çš„è½¯ä»¶é‡åˆ°äº†å¼‚å¸¸æƒ…å†µæˆ–è€…å‘ç°äº†ä¸¥é‡åˆ°å¿…é¡»ç«‹å³ä¿®å¤çš„è½¯ä»¶ç¼ºé™·çš„æ—¶å€™ï¼Œå°±éœ€è¦ä»masteråˆ†æ”¯ä¸ŠæŒ‡å®šçš„TAGç‰ˆæœ¬æ´¾ç”Ÿhotfixåˆ†æ”¯æ¥ç»„ç»‡ä»£ç çš„ç´§æ€¥ä¿®å¤å·¥ä½œã€‚

è¿™æ ·åšçš„æ˜¾è€Œæ˜“è§çš„å¥½å¤„æ˜¯ä¸ä¼šæ‰“æ–­æ­£åœ¨è¿›è¡Œçš„developåˆ†æ”¯çš„å¼€å‘å·¥ä½œï¼Œèƒ½å¤Ÿè®©å›¢é˜Ÿä¸­è´Ÿè´£æ–°åŠŸèƒ½å¼€å‘çš„äººä¸è´Ÿè´£ä»£ç ç´§æ€¥ä¿®å¤çš„äººå¹¶è¡Œçš„å¼€å±•å·¥ä½œã€‚

&amp;nbsp;

# æ›´è¿›ä¸€æ­¥

Git Flowå¼€å‘æ¨¡å‹ä»æºä»£ç ç®¡ç†è§’åº¦å¯¹é€šå¸¸æ„ä¹‰ä¸Šçš„è½¯ä»¶å¼€å‘æ´»åŠ¨è¿›è¡Œäº†çº¦æŸã€‚åº”è¯¥è¯´ï¼Œä¸ºæˆ‘ä»¬çš„è½¯ä»¶å¼€å‘æä¾›äº†ä¸€ä¸ªå¯ä¾›å‚è€ƒçš„ç®¡ç†æ¨¡å‹ã€‚Git Flowå¼€å‘æ¨¡å‹è®©nvieçš„å¼€å‘ä»£ç ä»“åº“ä¿æŒæ•´æ´ï¼Œè®©å°ç»„å„ä¸ªæˆå‘˜ä¹‹é—´çš„å¼€å‘ç›¸äº’éš”ç¦»ï¼Œèƒ½å¤Ÿæœ‰æ•ˆé¿å…å¤„äºå¼€å‘çŠ¶æ€ä¸­çš„ä»£ç ç›¸äº’å½±å“è€Œå¯¼è‡´çš„æ•ˆç‡ä½ä¸‹å’Œæ··ä¹±ã€‚

æ‰€è°“æ¨¡å‹ï¼Œåœ¨ä¸åŒçš„å¼€å‘å›¢é˜Ÿï¼Œä¸åŒçš„æ–‡åŒ–ï¼Œä¸åŒçš„é¡¹ç›®èƒŒæ™¯æƒ…å†µä¸‹éƒ½æœ‰å¯èƒ½éœ€è¦è¿›è¡Œé€‚å½“çš„è£å‰ªæˆ–æ‰©å……ã€‚ç¥å„ä½å¥½è¿ï¼

PSï¼šä¸ºäº†ç®€åŒ–ä½¿ç”¨Git Flowæ¨¡å‹æ—¶GitæŒ‡ä»¤çš„å¤æ‚æ€§ï¼Œnvieå¼€å‘å‡ºäº†ä¸€å¥—[gitå¢å¼ºæŒ‡ä»¤é›†](https://github.com/nvie/gitflow)ã€‚å¯ä»¥è¿è¡ŒäºWindowsã€Linuxã€Unixå’ŒMacæ“ä½œç³»ç»Ÿä¹‹ä¸‹ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å»çœ‹çœ‹ã€‚

# é™„å½•

## å®‰è£…Git Flow

Git Flowçš„åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¹‹ä¸‹æœ‰ä¸€äº›è½»å¾®çš„ä¸åŒã€‚å¥½åœ¨nvieç»™å‡ºäº†è¯¦ç»†çš„æŒ‡å¯¼ã€‚

### Windows

é…åˆCygwinä½¿ç”¨ã€‚Cygwinä¹‹ä¸‹çš„å®‰è£…éå¸¸ç®€å•ã€‚æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤å³å¯ï¼š</code>wget -q -O - â€“no-check-certificate <a href="https://github.com/nvie/gitflow/raw/develop/contrib/gitflow-installer.sh" target="_blank" rel="noopener">https://github.com/nvie/gitflow/raw/develop/contrib/gitflow-installer.sh</a> | bash`<br><br>ä½¿ç”¨è¿™æ¡å‘½ä»¤åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½å¯ä»¥å®ŒæˆGit Flowçš„å®‰è£…ã€‚ä½†åœ¨å°‘æ•°æƒ…å†µä¸‹ä¹Ÿä¼šé‡åˆ°å¼‚å¸¸ï¼š

</em>   æ‰§è¡Œ git flow init å‘½ä»¤åå‡ºç°é”™è¯¯ï¼šâ€flags: FATAL unable to determine getopt versionâ€<br><br>éœ€è¦ä½¿ç”¨Cygwinçš„Util-linuxå®‰è£…åŒ…ã€‚é‡æ–°ä½¿ç”¨cywginçš„setupå®‰è£…å§ã€‚<br><br><em>   å¦‚æœå‡ºç°ç±»ä¼¼â€$â€™\râ€™: command not foundâ€çš„é”™è¯¯ï¼Œåˆ™å¯èƒ½æ˜¯æ¢è¡Œç¬¦å‡ºç°äº†é—®é¢˜ã€‚å¯ä»¥ä½¿ç”¨sedå‘½ä»¤æ¥å¿«é€Ÿè§£å†³ã€‚<br><br>`$ sed -i â€˜s/\n\r/\n/mgâ€™ /usr/local/bin/git-flow</em><br>$ sed -i â€˜s/\n\r/\n/mgâ€™ /usr/local/bin/gitflow-*`<br><br>&nbsp;<br><br></div><br><div class="copyright-announce">æ¥è‡ªï¼š<a href="http://www.ituring.com.cn/article/56870" target="_blank" rel="noopener">http://www.ituring.com.cn/article/56870</a></div>

]]></content>
      
        
        <tags>
            
            <tag> git </tag>
            
            <tag> git flow </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]åœ¨Adapterçš„getViewæ–¹æ³•ä¸­ç»‘å®šOnClickListeneræ¯”è¾ƒå¥½çš„æ–¹æ³•]]></title>
      <url>/2014/12/05/Android-%E5%9C%A8Adapter%E7%9A%84getView%E6%96%B9%E6%B3%95%E4%B8%AD%E7%BB%91%E5%AE%9AOnClickListener%E6%AF%94%E8%BE%83%E5%A5%BD%E7%9A%84%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>ç»™ListViewä¸­æ¯ä¸ªitemç»‘å®šç‚¹å‡»äº‹ä»¶çš„æ–¹æ³•ï¼Œæ¯”è¾ƒå¸¸è§çš„å¦‚ä¸‹è¿™ç§æ–¹å¼ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">public</span> View getView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> positon, View convertView, ViewGroup parent){<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> convertView){<br></span><span style="color: #008080;"> 3</span>         convertView = LayoutInflater.<span style="color: #0000ff;">from</span>(context).inflate(R.layout.item, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 4</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 5</span><br><span style="color: #008080;"> 6</span>     Button button =<span style="color: #000000;"> ABViewUtil.obtainView(convertView, R.id.item_btn);<br></span><span style="color: #008080;"> 7</span>     button.setOnClickListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> View.OnClickListener(){<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">        @Override<br></span><span style="color: #008080;"> 9</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClick(View v){<br></span><span style="color: #008080;">10</span>             Toast.makeText(context, <span style="color: #800000;">â€œ</span><span style="color: #800000;">position: </span><span style="color: #800000;">â€œ</span> +<span style="color: #000000;"> position, Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">    });<br></span><span style="color: #008080;">13</span><br><span style="color: #008080;">14</span> }</pre><br></div>

<p>ç„¶åè¿è¡Œï¼Œå½“ç„¶æ²¡é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œæ³¨æ„ä»£ç ç¬¬7è¡Œï¼Œæ¯æ¬¡è°ƒç”¨getViewæ–¹æ³•éƒ½ä¼šè®¾ç½®Buttonçš„OnClickListenerï¼Œä¼šç”Ÿæˆå¾ˆå¤šä¸å¿…è¦çš„OnClickListenerå¯¹è±¡ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°ï¼Œåœ¨ç”ŸæˆconvertViewæ—¶ï¼ŒåŒæ—¶è®¾ç½®Buttonçš„OnClickListenerï¼ŒconvertViewæ˜¯è¢«ä¸æ–­åœ°å¤ç”¨çš„ï¼Œè¿™æ ·çš„OnClickListenerä¹Ÿå°±å¯ä»¥è¢«ä¸æ–­åœ°æœç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç¬¬3è¡Œå’Œç¬¬4è¡Œä¹‹é—´è¿›è¡Œè¿™ä¸€æ­¥ã€‚è¿™æ ·ï¼Œä»£ç æ¼”åŒ–åˆ°å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">public</span> View getView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> positon, View convertView, ViewGroup parent){<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> convertView){<br></span><span style="color: #008080;"> 3</span>         convertView = LayoutInflater.from(context).inflate(R.layout.item, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 4</span>         Button button =<span style="color: #000000;"> ABViewUtil.obtainView(convertView, R.id.item_btn);<br></span><span style="color: #008080;"> 5</span>         button.setOnClickListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> View.OnClickListener(){<br></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClick(View v){<br></span><span style="color: #008080;"> 8</span>                 Toast.makeText(context, â€œposition: â€œ +<span style="color: #000000;"> position, Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">12</span> }</pre><br></div>

<p>è¿™ä¸ªä»£ç çœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯é—®é¢˜å°±åœ¨onClickå›è°ƒçš„çš„ç¬¬8è¡Œä¸­ä½¿ç”¨çš„positionçš„æ—¶å€™ï¼Œå› ä¸ºè¿™é‡Œä½¿ç”¨çš„æ˜¯åŒ¿åå†…éƒ¨ç±»ï¼ˆè¿™ä¸ªåŒ¿åå†…éƒ¨ç±»å®ç°äº†View.OnClickListenerè¿™ä¸ªæ¥å£ï¼‰ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦åœ¨onClickä¸­ä½¿ç”¨positionè¿™ä¸ªå˜é‡çš„è¯ï¼Œéœ€è¦æŠŠpositionå£°æ˜ä¸ºfinalã€‚ä¸€æ—¦å£°æ˜äº†finalï¼Œç­‰åˆ°ç¼–è¯‘ä¹‹åï¼Œè¿™ä¸ªpositionå°±ä¼šè¢«ä½œä¸ºè¿™ä¸ªåŒ¿åå†…éƒ¨ç±»ä¸­çš„ä¸€ä¸ªprivateçš„æˆå‘˜å˜é‡ã€‚è¿™æ ·ï¼ŒListViewå¾€ä¸‹æ»šåŠ¨ï¼Œä¸‹é¢éœ€è¦æ˜¾ç¤ºçš„itemä¼šé‡ç”¨ä¸Šé¢ä¸æ˜¾ç¤ºçš„convertViewï¼ŒconvertViewä¸­çš„Buttonè®¾ç½®çš„OnClickListenerå®ç°ç±»çš„å¯¹è±¡ï¼Œå›è°ƒonClickæ—¶ï¼Œä½¿ç”¨çš„positionå…¶å®æ˜¯è¯¥OnClickListenerå®ç°ç±»çš„æˆå‘˜å˜é‡positionï¼ˆè¿™ä¸ªpositionçš„å€¼åªæ˜¯åœ¨æ„é€ çš„æ—¶å€™è¢«åˆå§‹åŒ–äº†è€Œå·²ï¼ï¼‰ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªListViewåˆšåŠ è½½å®Œæ•°æ®åï¼Œè¿˜æœªæ»šåŠ¨æ—¶ï¼Œç‚¹å‡»å±å¹•ä¸Šçš„iteméƒ½æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯å¦‚æœä¸€æ—¦æ»šåŠ¨ï¼Œæœ‰viewè¢«é‡ç”¨äº†ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œpositionçš„å€¼å°±é”™ä¹±äº†ï¼Œæ‰€ä»¥åœ¨onClickä¸­é€šè¿‡positionè·å–åˆ°çš„itemçš„æ•°æ®å½“ç„¶ä¹Ÿæ˜¯é”™ä¹±çš„äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±éœ€è¦è®©onClickæ–¹æ³•å›è°ƒçš„æ—¶å€™å¾—åˆ°çš„positionæ˜¯ä¸ªæ­£ç¡®çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨æŠŠå½“å‰æ˜¾ç¤ºçš„convertViewå¯¹åº”çš„positionå€¼ä¿å­˜åœ¨convertViewä¸­ï¼Œç„¶åæŠŠè¿™ä¸ªconvertViewå¯¹è±¡ä¼ å…¥OnClickListenerä¸­ä¿å­˜ï¼Œæ‰€ä»¥ä»£ç æ¼”åŒ–åˆ°å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">public</span> View getView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> positon, View convertView, ViewGroup parent){<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> convertView){<br></span><span style="color: #008080;"> 3</span>         convertView = LayoutInflater.from(context).inflate(R.layout.item, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 4</span>         Button button =<span style="color: #000000;"> ABViewUtil.obtainView(convertView, R.id.item_btn);<br></span><span style="color: #008080;"> 5</span>         button.setOnClickListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> OnConvertViewClickListener(convertView, R.id.ab<strong>id_adapter_item_position){<br></strong></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">                @Override<br></span><span style="color: #008080;"> 7</span>                 <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onClickCallBack(View registedView, <span style="color: #0000ff;">int</span><span style="color: #000000;">â€¦ positionIds){<br></span><span style="color: #008080;"> 8</span>                     Toast.makeText(context, â€œposition: â€œ + positionIds[0<span style="color: #000000;">], Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">    convertView.setTag(R.id.abid_adapter_item_position, position);<br></span><span style="color: #008080;">13</span> }</pre><br></div>

<p>å°±åƒä¸Šé¢ç¬¬5è¡Œè¿™æ ·ï¼ŒButtonç»‘å®šçš„æ˜¯<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/adapter/listener/OnConvertViewClickListener.java" target="_blank" rel="noopener">OnConvertViewClickListener</a></strong>ï¼Œå®ƒæ˜¯OnClickListenerçš„ä¸€ä¸ªå®ç°ç±»å¯ä»¥ä¿å­˜convertViewåˆ°Listenerä¸­ï¼Œåˆ°æ—¶å€™å›è°ƒonClickæ–¹æ³•çš„æ—¶å€™å¯ä»¥ä»ä¿å­˜çš„convertViewä¸­è·å–åˆ°å½“å‰æ˜¾ç¤ºçš„itemçš„positionï¼ˆè¿™ä¸ªpositionæ˜¯ä»¥tagçš„æ–¹å¼ä¿å­˜åœ¨convertViewä¸­çš„ï¼‰ã€‚</p>
<p>å½“ç„¶ï¼Œè¿˜éœ€è¦åšç¬¬12è¡Œè¿™ä¸€æ­¥ï¼Œå®ƒçš„ç›®çš„æ˜¯æŠŠå½“å‰æ˜¾ç¤ºçš„positionä¿å­˜åˆ°convertViewä¸­ï¼Œæä¾›ç»™<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/adapter/listener/OnConvertViewClickListener.java" target="_blank" rel="noopener">OnConvertViewClickListener</a></strong>è·å–å½“å‰çš„positionã€‚</p>
<p>è¿™æ ·å°±okäº†ï¼Œå¯ä»¥åœ¨onClickCallBack()æ–¹æ³•ä¸­è¿›è¡Œç‚¹å‡»äº‹ä»¶çš„å¤„ç†äº†ï¼Œæ¯ä¸ªbuttonæ°¸è¿œåªæœ‰ä¸€ä¸ªonClickListenerã€‚</p>
<p><span style="color: #008000;"><strong>æ³¨ï¼šä½¿ç”¨<a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/adapter/listener/OnConvertViewClickListener.java" target="_blank" rel="noopener"><span style="color: #008000;">OnConvertViewClickListener</span></a>å¯ä»¥ä¾èµ–<a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">AndroidBucket</a>ï¼ˆ<a href="https://github.com/wangjiegulu/AndroidBucketï¼‰é¡¹ç›®" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucketï¼‰é¡¹ç›®</a></strong></span></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ListView </tag>
            
            <tag> best practices </tag>
            
            <tag> adapter </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ListViewçš„Adapter.getView()æ–¹æ³•ä¸­å»¶è¿ŸåŠ è½½å›¾ç‰‡çš„ä¼˜åŒ–]]></title>
      <url>/2014/12/03/Android-ListView%E7%9A%84Adapter-getView-%E6%96%B9%E6%B3%95%E4%B8%AD%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%E5%9B%BE%E7%89%87%E7%9A%84%E4%BC%98%E5%8C%96/</url>
      <content type="html"><![CDATA[<p>ä¸¾ä¸ªä¾‹å­å§ï¼Œä»¥å¥½å‹åˆ—è¡¨ä¸ºä¾‹</p>
<p>ListViewä¸­æ¯ä¸ªItemè¡¨ç¤ºä¸€ä¸ªå¥½å‹ï¼Œæ¯ä¸ªå¥½å‹ä¸­éƒ½æœ‰ä¸€ä¸ªå¤´åƒï¼Œéœ€è¦ä»æœåŠ¡ç«¯åŠ è½½åˆ°æœ¬åœ°ï¼Œç„¶åæ˜¾ç¤ºåœ¨itemä¸­ã€‚</p>
<p>æ˜¾ç„¶ï¼Œå¯åŠ¨åŠ è½½å›¾ç‰‡çš„è¿‡ç¨‹åº”è¯¥æ˜¯åœ¨getView()æ–¹æ³•ä¸­è§¦å‘ï¼Œå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åä¸‹è½½å¤´åƒå›¾ç‰‡ã€‚è¿™é‡Œä½¿ç”¨æˆ‘å†™çš„ä¸€ä¸ªå¼€æºæ¡†æ¶<strong><a href="https://github.com/wangjiegulu/ImageLoaderSample" target="_blank" rel="noopener">ImageLoaderSample</a></strong>ï¼ˆ<a href="https://github.com/wangjiegulu/ImageLoaderSample" target="_blank" rel="noopener">https://github.com/wangjiegulu/ImageLoaderSample</a>ï¼‰æ¥åŠ è½½å›¾ç‰‡ï¼Œå¹¶å®ç°å†…å­˜ç¼“å­˜å’Œæœ¬åœ°ç¼“å­˜ã€‚</p>
<p>é¢ï¼ï¼è¿™é‡Œä¸å†ä»‹ç»ImageLoaderSampleçš„ç”¨æ³•äº†ï¼Œç»™ä¸ªä¼ é€é—¨ï¼š<a href="http://www.cnblogs.com/tiantianbyconan/p/3574131.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/3574131.html</a></p>
<p>&nbsp;</p>
<p>å†æ¥çœ‹çœ‹getView()æ–¹æ³•çš„è°ƒç”¨æ—¶æœºï¼š</p>
<p>1. Adapterè°ƒç”¨NotifyDataChangedçš„æ—¶å€™</p>
<p>2. ListViewæ»šåŠ¨æ—¶ï¼Œä¹Ÿå°±æ˜¯convertViewä¸æ–­å¤ç”¨çš„æ—¶å€™ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯å½“ListViewæ»šåŠ¨æ—¶ï¼ŒgetView()æ–¹æ³•ä¸æ–­è¢«è°ƒç”¨ï¼Œå›¾ç‰‡ä¸‹è½½çš„è¿‡ç¨‹ä¸æ–­åœ°æ‰§è¡Œï¼ˆå½“ç„¶ï¼Œ<strong><a href="https://github.com/wangjiegulu/ImageLoaderSample" target="_blank" rel="noopener">ImageLoaderSample</a></strong>ä¸­ä¼šæœ‰ç¼“å­˜ï¼Œä½†æ˜¯å†…å­˜ç¼“å­˜æ—¶æœ‰é™çš„ï¼Œå¦‚æœå†…å­˜ç¼“å­˜ä¸­æ‰¾ä¸åˆ°è¦æ˜¾ç¤ºçš„å›¾ç‰‡ï¼Œé‚£å°±éœ€è¦åˆ°æ–‡ä»¶ç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œéœ€è¦è¿›è¡Œioè¯»å†™ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ç›¸å¯¹æ¯”è¾ƒè€—æ—¶çš„ï¼‰ï¼Œæ˜¾ç„¶ï¼Œè¿™é‡Œé¢è¿˜æœ‰ä¼˜åŒ–çš„ä½™åœ°ã€‚</p>
<p>æ€ä¹ˆå»ä¼˜åŒ–è¿™é‡Œï¼Ÿåªè¦è®©ListViewæ»šåŠ¨çš„æ—¶å€™å›¾ç‰‡æ˜¾ç¤ºçš„æ—¶å€™ä¸è¦å»è¿›è¡Œioè¯»å†™å°±å¥½äº†ï¼Œå…·ä½“é€»è¾‘å¦‚ä¸‹ï¼š</p>
<p>ï¼å¦‚æœè°ƒç”¨GetViewæ–¹æ³•æ—¶ï¼ŒListViewå¤„äºåœæ­¢çŠ¶æ€ï¼Œåˆ™å…ˆå»å†…å­˜ä¸­æŸ¥æ‰¾å¤´åƒå›¾ç‰‡ï¼›å¦‚æœå†…å­˜å›¾ç‰‡å­˜åœ¨ï¼Œåˆ™æ˜¾ç¤ºå†…å­˜ä¸­ä¿å­˜å¥½çš„å›¾ç‰‡ï¼›å¦‚æœå†…å­˜å›¾ç‰‡ä¸å­˜åœ¨ï¼Œåˆ™ç»§ç»­åˆ°æ–‡ä»¶ç¼“å­˜ä¸­æ‰¾ï¼Œå¦‚æœæ–‡ä»¶ç¼“å­˜å›¾ç‰‡å­˜åœ¨ï¼Œåˆ™æ˜¾ç¤ºæ–‡ä»¶ç¼“å­˜ä¸­çš„å›¾ç‰‡ï¼›å¦‚æœæ–‡ä»¶ç¼“å­˜å›¾ç‰‡ä¸å­˜åœ¨ï¼Œåˆ™æ ¹æ®urlå»ç½‘ç»œä¸‹è½½è¿™å¼ å›¾ç‰‡ï¼Œç„¶åæ˜¾ç¤ºï¼›</p>
<p>ï¼å¦‚æœè°ƒç”¨getViewæ–¹æ³•æ—¶ï¼ŒListViewå¤„äºæ»šåŠ¨çŠ¶æ€ï¼Œåˆ™å»å†…å­˜ä¸­æŸ¥æ‰¾å¤´åƒçš„å›¾ç‰‡ï¼›å¦‚æœå†…å­˜å›¾ç‰‡å­˜åœ¨ï¼Œåˆ™æ˜¾ç¤ºå†…å­˜ä¸­ä¿å­˜å¥½çš„å›¾ç‰‡ï¼›å¦‚æœå†…å­˜å›¾ç‰‡ä¸å­˜åœ¨ï¼Œåˆ™æ˜¾ç¤ºä¸€å¼ é»˜è®¤çš„å›¾ç‰‡ï¼ˆçœå»äº†ä»æ–‡ä»¶ç¼“å­˜ä¸­æ‰¾å›¾ç‰‡å’Œç½‘ç»œä¸­å»è¯·æ±‚å›¾ç‰‡çš„æ­¥éª¤ï¼‰ã€‚</p>
<p>&nbsp;</p>
<p>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±å¿…é¡»è¦æ”¹å†™BaseAdapterï¼Œè®©å®ƒèƒ½å¤Ÿç›‘æµ‹ListViewçš„æ»šåŠ¨çŠ¶æ€ï¼Œå¹¶åœ¨Adapterä¸­å¯ä»¥è·å–åˆ°å½“å‰ListViewçš„æ»šåŠ¨çŠ¶æ€ã€‚æ‰€ä»¥æ”¹é€ BaseAdapterï¼Œ<strong><a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/adapter/ABaseAdapter.java" target="_blank" rel="noopener">ABaseAdapter</a></strong>ï¼ˆ<a href="https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/adapter/ABaseAdapter.java" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket/blob/master/src/com/wangjie/androidbucket/adapter/ABaseAdapter.java</a>ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.androidbucket.adapter;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span> android.widget.<em><span style="color: #000000;">;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.adapter.listener.OnAdapterScrollListener;<br></span><span style="color: #008080;"> 5</span><br><span style="color: #008080;"> 6</span> <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 7</span> <span style="color: #008000;"> </span></em> Author: wangjie<br><span style="color: #008080;"> 8</span> <span style="color: #008000;"> <em> Email: tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 9</span> <span style="color: #008000;">  Date: 12/3/14.<br></span><span style="color: #008080;">10</span>  <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span> ABaseAdapter <span style="color: #0000ff;">extends</span> BaseAdapter <span style="color: #0000ff;">implements</span><span style="color: #000000;"> AbsListView.OnScrollListener {<br></span><span style="color: #008080;">12</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> OnAdapterScrollListener onAdapterScrollListener;<br></span><span style="color: #008080;">13</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">14</span> <span style="color: #008000;">      å½“å‰listviewæ˜¯å¦å±äºæ»šåŠ¨çŠ¶æ€<br></span><span style="color: #008080;">15</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">16</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isScrolling;<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isScrolling() {<br></span><span style="color: #008080;">19</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> isScrolling;<br></span><span style="color: #008080;">20</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">21</span><br><span style="color: #008080;">22</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setOnAdapterScrollListener(OnAdapterScrollListener onAdapterScrollListener) {<br></span><span style="color: #008080;">23</span>         <span style="color: #0000ff;">this</span>.onAdapterScrollListener =<span style="color: #000000;"> onAdapterScrollListener;<br></span><span style="color: #008080;">24</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">25</span><br><span style="color: #008080;">26</span>     <span style="color: #0000ff;">protected</span><span style="color: #000000;"> ABaseAdapter(AbsListView listView) {<br></span><span style="color: #008080;">27</span>         listView.setOnScrollListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;">28</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">29</span><br><span style="color: #008080;">30</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">31</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onScroll(AbsListView view, <span style="color: #0000ff;">int</span> firstVisibleItem, <span style="color: #0000ff;">int</span> visibleItemCount, <span style="color: #0000ff;">int</span><span style="color: #000000;"> totalItemCount) {<br></span><span style="color: #008080;">32</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> onAdapterScrollListener) {<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">            onAdapterScrollListener.onScroll(view, firstVisibleItem, visibleItemCount, totalItemCount);<br></span><span style="color: #008080;">34</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">35</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">36</span><br><span style="color: #008080;">37</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">38</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onScrollStateChanged(AbsListView view, <span style="color: #0000ff;">int</span><span style="color: #000000;"> scrollState) {<br></span><span style="color: #008080;">39</span>         <span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> onAdapterScrollListener) {<br></span><span style="color: #008080;">40</span> <span style="color: #000000;">            onAdapterScrollListener.onScrollStateChanged(view, scrollState);<br></span><span style="color: #008080;">41</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">42</span><br><span style="color: #008080;">43</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®æ˜¯å¦æ»šåŠ¨çš„çŠ¶æ€</span><br><span style="color: #008080;">44</span>         <span style="color: #0000ff;">if</span> (scrollState == AbsListView.OnScrollListener.SCROLL_STATE_IDLE) { <span style="color: #008000;">//</span><span style="color: #008000;"> ä¸æ»šåŠ¨çŠ¶æ€</span><br><span style="color: #008080;">45</span>             isScrolling = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">46</span>             <span style="color: #0000ff;">this</span><span style="color: #000000;">.notifyDataSetChanged();<br></span><span style="color: #008080;">47</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">48</span>             isScrolling = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">49</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">50</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">51</span> }</pre><br></div>

<p>å¦‚ä¸Šè¿°ä»£ç æ‰€ç¤ºï¼Œè¯¥Adapterå®ç°äº†AbsListView.OnScrollListenerï¼Œå¹¶åœ¨æ„é€ æ–¹æ³•ä¸­ç»™ListViewç»‘å®šäº†OnScrollListenerï¼Œåœ¨å®ç°çš„onScrollStateChangedæ–¹æ³•ä¸­è·å–åˆ°å½“å‰æ»šåŠ¨çŠ¶æ€ï¼Œå¹¶ä¸”ä¿å­˜è¿™ä¸ªçŠ¶æ€isScrollingï¼Œå¹¶æš´éœ²isScrolling()æ–¹æ³•ç»™å¤–é¢ã€‚</p>
<p>OnAdapterScrollListenerè¿™ä¸ªæ¥å£æ˜¯ç»§æ‰¿äº†AbsListView.OnScrollListenerï¼Œå› ä¸ºè¿™é‡Œåœ¨Adapterä¸­ä¸€æ™¯è®¾ç½®äº†OnScrollListeneräº†ï¼Œæ‰€ä»¥å¦‚æœåœ¨å¤–é¢è®¾ç½®äº†æ–°çš„OnScrollListenerçš„è¯ï¼Œå°±ä¼šå¤±æ•ˆäº†ï¼Œæ‰€ä»¥å¿…é¡»æä¾›å¦å¤–ä¸€ä¸ªsetOnAdapterScrollListenerï¼Œç„¶åå†ä¼ å…¥ä¸€ä¸ªOnScrollListenerï¼Œç„¶ååœ¨æ¯ä¸ªæ–¹æ³•ä¸­è¿›è¡Œå›è°ƒå°±å¥½äº†ï¼Œå› ä¸ºè€ƒè™‘åˆ°ä»¥åå¯èƒ½ä¼šæ‰©å±•å…¶ä»–çš„æ¥å£æ–¹æ³•ï¼Œæ‰€ä»¥è¿™é‡Œæ–°å†™äº†ä¸€ä¸ªæ¥å£ï¼ˆä¸ºäº†ä»¥åæ‰©å±•æ—¶åŸæ¥çš„ä»£ç ä¸ä¼šè¢«å½±å“ï¼Œæ¨èä½¿ç”¨OnAdapterScrollSampleListenerè¿™ä¸ªå®ç°ç±»æ¥ä»£æ›¿OnAdapterScrollListenerè¿™ä¸ªæ¥å£ï¼ŒOnAdapterScrollSampleListenerè¿™ä¸ªç±»åªæ˜¯å¯¹OnAdapterScrollListenerçš„æ‰€æœ‰æ–¹æ³•è¿›è¡Œäº†ç©ºå®ç°ï¼‰ã€‚</p>
<p>&nbsp;</p>
<p>ç„¶åæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªMyAdapterç»§æ‰¿ABaseAdapterï¼Œç„¶åï¼Œåœ¨getView()æ–¹æ³•ä¸­ï¼Œéœ€è¦æ˜¾ç¤ºå¤´åƒçš„æ—¶å€™è°ƒç”¨å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<p>// å¦‚æœåœ¨æ»šåŠ¨ï¼ˆä»å†…å­˜ä¸­æŸ¥æ‰¾ï¼Œæ‰¾ä¸åˆ°ä¹Ÿä¸è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼‰</p>
<div class="cnblogs_code"><br><pre>ImageLoader.getInstances().displayImage(headUrl, headIv, <span style="color: #0000ff;">null</span>, R.drawable.default_head, isScrolling());</pre><br></div>

<p>çœ‹åˆ°æœ¨æœ‰ï¼Ÿ</p>
<p>1. displayImage()æ–¹æ³•å‘ç”Ÿäº†æ”¹å˜ï¼Œå¤šäº†æœ€åä¸€ä¸ªå‚æ•°isOnlyMemoryè¿™ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºæ˜¯å¦åªæ˜¯åœ¨å†…å­˜ç¼“å­˜ä¸­æ‰¾è¿™å¼ å›¾ç‰‡ï¼Œå¦‚æœæ²¡æœ‰å°±ä¸å†ç»§ç»­æ‰¾ä¸‹å»äº†ï¼ˆdisplayImageåŸæ¥çš„æ–¹æ³•æˆ‘è¿˜ç•™ç€ï¼Œæ‰€ä»¥ä¸ä¼šå½±å“ä¹‹å‰çš„ä»£ç ï¼‰ã€‚</p>
<p>2. è°ƒç”¨äº†isScrolling()æ–¹æ³•ï¼Œä½œä¸ºå‚æ•°isOnlyMemoryçš„å€¼ï¼Œè¡¨ç¤ºï¼Œå¦‚æœæ­£åœ¨æ»šåŠ¨çš„è¯ï¼Œå°±åªåœ¨ç¼“å­˜ä¸­æ‰¾è¿™å¼ å›¾ç‰‡ã€‚</p>
<p>è¿™æ ·ï¼Œè¿è¡ŒåŸæ¥çš„ä»£ç è¯•è¯•å§ï¼Œæ˜¯ä¸æ˜¯æ•ˆç‡å¿«äº†ä¸€äº›ï¼Ÿ</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ListView </tag>
            
            <tag> best practices </tag>
            
            <tag> optimize </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç›´æ¥æ‹¿æ¥ç”¨ï¼åå¤§Material Designå¼€æºé¡¹ç›®]]></title>
      <url>/2014/11/23/%E7%9B%B4%E6%8E%A5%E6%8B%BF%E6%9D%A5%E7%94%A8%EF%BC%81%E5%8D%81%E5%A4%A7Material-Design%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/</url>
      <content type="html"><![CDATA[<p>æ¥è‡ªï¼š<a href="http://www.csdn.net/article/2014-11-21/2822753-material-design-libs/1" target="_blank" rel="noopener">http://www.csdn.net/article/2014-11-21/2822753-material-design-libs/1</a></p>
<p>ä»‹äºæ‹Ÿç‰©å’Œæ‰å¹³ä¹‹é—´çš„Material Designè‡ªé¢ä¸–ä»¥æ¥ï¼Œä¾¿å¼•èµ·äº†å¾ˆå¤šäººçš„å…³æ³¨ä¸æ€è€ƒï¼Œå°±æ­¤äº§ç”Ÿçš„è®¨è®ºä¹Ÿä¸ç»äºè€³ã€‚æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†åœ¨Androidå¼€å‘è€…åœˆå­é‡Œé¢‡å—é’ççš„åä¸ªMaterial Designå¼€æºé¡¹ç›®ï¼Œä»ç¤ºä¾‹ã€FABã€èœå•ã€åŠ¨ç”»ã€Rippleåˆ°Dialogï¼Œçœ‹è¢«ç§°ä¸º&ldquo;Googleç¬¬ä¸€æ¬¡åœ¨è®¾è®¡è¯­è¨€å’Œè§„èŒƒä¸Šè¶…è¶Šäº†Apple&rdquo;çš„Material Designæ˜¯å¦‚ä½•é€æ¸æˆä¸ºAppçš„ä¸€ç§å…¨æ–°è®¾è®¡æ ‡å‡†ã€‚</p>
<p><strong>1.&nbsp;<a href="https://github.com/navasmdc/MaterialDesignLibrary" target="_blank" rel="noopener">MaterialDesignLibrary</a></strong></p>
<p>åœ¨ä¼—å¤šæ–°æ™‹åº“ä¸­ï¼ŒMaterialDesignLibraryå¯ä»¥è¯´æ˜¯é¢‡å—å¼€å‘è€…ç©ç›®çš„ä¸€ä¸ªæ§ä»¶æ•ˆæœåº“ï¼Œèƒ½å¤Ÿè®©å¼€å‘è€…åœ¨Android 2.2ç³»ç»Ÿä¸Šä½¿ç”¨Android 5.0æ‰æ”¯æŒçš„æ§ä»¶æ•ˆæœï¼Œæ¯”å¦‚æ‰å¹³ã€çŸ©å½¢ã€æµ®åŠ¨æŒ‰é’®ï¼Œå¤é€‰æ¡†ä»¥åŠå„å¼å„æ ·çš„è¿›åº¦æŒ‡ç¤ºå™¨ç­‰ã€‚</p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546e9b100445a_middle.jpg" alt=""></p>
<p>é™¤ä¸Šè¿°ä¹‹å¤–ï¼ŒMaterialDesignLibraryè¿˜æ‹¥æœ‰SnackBarã€Dialogã€Color selectorç»„ä»¶ï¼Œå¯éå¸¸ä¾¿æ·åœ°å¯¹åº”ç”¨ç•Œé¢è¿›è¡Œè®¾ç½®ã€‚</p>
<p>è¿›åº¦æŒ‡ç¤ºå™¨æ ·å¼æ•ˆæœè®¾ç½®ï¼š&nbsp;</p>
<div class="dp-highlighter bg_xml"><br><div class="bar"><br><div class="tools"><br><div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">com.gc.materialdesign.views.ProgressBarCircularIndetermininate<br>                </span><span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/progressBarCircularIndetermininateâ€</span><span style="color: #ff0000;"><br>                android:layout_width</span><span style="color: #0000ff;">=â€32dpâ€</span><span style="color: #ff0000;"><br>                android:layout_height</span><span style="color: #0000ff;">=â€32dpâ€</span><span style="color: #ff0000;"><br>                android:background</span><span style="color: #0000ff;">=â€#1E88E5â€</span> <span style="color: #0000ff;">/&gt;</span></pre><br></div>

<p>&nbsp;</p>
<p></p></div><br></div><br></div><p></p>
<p>Dialogï¼š</p>
<div class="cnblogs_code"><br><pre>Dialog dialog = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Dialog(Context context,String title, String message);<br>dialog.show();</span></pre><br></div>

<p>&nbsp;</p>
<p><strong>2.&nbsp;<a href="https://github.com/traex/RippleEffect" target="_blank" rel="noopener">RippleEffect</a></strong></p>
<p>ç”±æ¥è‡ªæ³•å…°è¥¿çš„Robin Chutauxå¼€å‘çš„RippleEffectåŸºäºMITè®¸å¯åè®®å¼€æºï¼Œèƒ½å¤Ÿåœ¨Android API 9+ä¸Šå®ç°Material Designï¼Œä¸ºå¼€å‘è€…æä¾›äº†ä¸€ç§æä¸ºç®€æ˜“çš„æ–¹å¼æ¥åˆ›å»ºå¸¦æœ‰å¯æ‰©å±•è§†å›¾çš„headerè§†å›¾ï¼Œå¹¶ä¸”å…è®¸æœ€å¤§ç¨‹åº¦ä¸Šçš„è‡ªå®šåˆ¶ã€‚</p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546ea09e7c452_middle.jpg" alt=""></p>
<p>ç”¨æ³•ï¼ˆåœ¨XMLæ–‡ä»¶ä¸­å£°æ˜ä¸€ä¸ªRippleViewï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">com.andexert.library.RippleView<br>  </span><span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/moreâ€</span><span style="color: #ff0000;"><br>  android:layout_width</span><span style="color: #0000ff;">=â€?android:actionBarSizeâ€</span><span style="color: #ff0000;"><br>  android:layout_height</span><span style="color: #0000ff;">=â€?android:actionBarSizeâ€</span><span style="color: #ff0000;"><br>  android:layout_toLeftOf</span><span style="color: #0000ff;">=â€@+id/more2â€</span><span style="color: #ff0000;"><br>  android:layout_margin</span><span style="color: #0000ff;">=â€5dpâ€</span><span style="color: #ff0000;"><br>  ripple:rv_centered</span><span style="color: #0000ff;">=â€trueâ€</span><span style="color: #0000ff;">&gt;</span><br><br>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">ImageView<br>    </span><span style="color: #ff0000;">android:layout_width</span><span style="color: #0000ff;">=â€?android:actionBarSizeâ€</span><span style="color: #ff0000;"><br>    android:layout_height</span><span style="color: #0000ff;">=â€?android:actionBarSizeâ€</span><span style="color: #ff0000;"><br>    android:src</span><span style="color: #0000ff;">=â€@android:drawable/ic_menu_editâ€</span><span style="color: #ff0000;"><br>    android:layout_centerInParent</span><span style="color: #0000ff;">=â€trueâ€</span><span style="color: #ff0000;"><br>    android:padding</span><span style="color: #0000ff;">=â€10dpâ€</span><span style="color: #ff0000;"><br>    android:background</span><span style="color: #0000ff;">=â€@android:color/holo_blue_darkâ€</span><span style="color: #0000ff;">/&gt;</span><br><br><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">com.andexert.library.RippleView</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>&nbsp;</p>
<p><strong>3.&nbsp;<a href="https://github.com/rengwuxian/MaterialEditText" target="_blank" rel="noopener">MaterialEditText</a></strong></p>
<p>éšç€Material Designçš„åˆ°æ¥ï¼ŒAppCompat v21ä¹Ÿä¸ºå¼€å‘è€…æä¾›äº†Material Designçš„æ§ä»¶å¤–è§‚æ”¯æŒï¼Œå…¶ä¸­å°±åŒ…æ‹¬EditTextï¼Œä½†å´å¹¶ä¸å¥½ç”¨ï¼Œæ²¡æœ‰è®¾ç½®é¢œè‰²çš„APIï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•Google Material Design Specä¸­æåˆ°çš„ç‰¹æ€§ã€‚äºæ˜¯ï¼Œæ¥è‡ªå›½å†…çš„å¼€å‘è€…&ldquo;æ‰”ç‰©çº¿&rdquo;å¼€å‘äº†MaterialEditTextåº“ï¼Œç›´æ¥ç»§æ‰¿EditTextï¼Œæ— éœ€ä¿®æ”¹Javaæ–‡ä»¶å³èƒ½å®ç°è‡ªå®šä¹‰æ§ä»¶é¢œè‰²ã€‚</p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546ea1168a50c_middle.jpg" alt=""></p>
<p>è‡ªå®šä¹‰Base Colorï¼š</p>
<div class="cnblogs_code"><br><pre>app:baseColor=â€#0056d3â€</pre><br></div>

<p><img src="http://cms.csdnimg.cn/article/201411/21/546ea26d93a02_middle.jpg" alt=""></p>
<p>&nbsp;</p>
<p>è‡ªå®šä¹‰Error Colorï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #000000;">app:maxCharacters=â€10â€<br>app:errorColor=â€#ddaa00â€</span></pre><br></div>

<p><span style="line-height: 1.5;">&nbsp;</span></p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546ea27b0fc23_middle.jpg" alt=""></p>
<p><strong>4.&nbsp;<a href="https://github.com/mikepenz/Android-LollipopShowcase" target="_blank" rel="noopener">Android-LollipopShowcase</a></strong></p>
<p>Android-LollipopShowcaseæ˜¯ç”±æ¥è‡ªå¥¥åœ°åˆ©çš„ç§»åŠ¨ã€åç«¯åŠWebå¼€å‘è€…Mike Penzæ‰€å¼€å‘çš„æ¼”ç¤ºåº”ç”¨ï¼Œé›†ä¸­æ¼”ç¤ºäº†æ–°Material Designä¸­æ‰€æœ‰çš„UIæ•ˆæœï¼Œä»¥åŠAndroid Lollipopä¸­å…¶ä»–éå¸¸é…·ç‚«çš„ç‰¹æ€§å…ƒç´ ï¼Œæ¯”å¦‚Toolbarã€RecyclerViewã€ActionBarDrawerToggleã€Floating Action Buttonï¼ˆFABï¼‰ã€Android Compat Themeç­‰ã€‚</p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546ed8a896530_middle.jpg" alt=""></p>
<p><strong>5.&nbsp;<a href="https://github.com/dexafree/MaterialList" target="_blank" rel="noopener">MaterialList</a></strong></p>
<p>MaterialListæ˜¯ä¸€ä¸ªèƒ½å¤Ÿå¸®åŠ©æ‰€æœ‰Androidå¼€å‘è€…è·å–è°·æ­ŒUIè®¾è®¡è§„èŒƒä¸­æ–°å¢çš„CardViewï¼ˆå¡ç‰‡è§†å›¾ï¼‰çš„å¼€æºåº“ï¼Œæ”¯æŒAndroid 2.3+ç³»ç»Ÿã€‚ä½œä¸ºListViewçš„æ‰©å±•ï¼ŒMaterialListå¯ä»¥æ¥æ”¶ã€å­˜å‚¨å¡ç‰‡åˆ—è¡¨ï¼Œå¹¶æ ¹æ®å®ƒä»¬çš„Androidé£æ ¼å’Œè®¾è®¡æ¨¡å¼è¿›è¡Œå±•ç¤ºã€‚æ­¤å¤–ï¼Œå¼€å‘è€…è¿˜å¯ä»¥åˆ›å»ºä¸“å±äºè‡ªå·±çš„å¡ç‰‡å¸ƒå±€ï¼Œå¹¶è½»æ¾å°†å…¶æ·»åŠ åˆ°CardListä¸­ã€‚</p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546ede74f3033_middle.jpg" alt=""></p>
<p>ä½¿ç”¨è¿‡ç¨‹ä»£ç ï¼Œåœ¨å¸ƒå±€ä¸­å£°æ˜MaterialListViewï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RelativeLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><span style="color: #ff0000;"><br>    android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"><br>    android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"><br>    android:paddingLeft</span><span style="color: #0000ff;">=â€@dimen/activity_horizontal_marginâ€</span><span style="color: #ff0000;"><br>    android:paddingRight</span><span style="color: #0000ff;">=â€@dimen/activity_horizontal_marginâ€</span><span style="color: #ff0000;"><br>    android:paddingTop</span><span style="color: #0000ff;">=â€@dimen/activity_vertical_marginâ€</span><span style="color: #ff0000;"><br>    android:paddingBottom</span><span style="color: #0000ff;">=â€@dimen/activity_vertical_marginâ€</span><span style="color: #0000ff;">&gt;</span><br><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">com.dexafree.materiallistviewexample.view.MaterialListView<br>        </span><span style="color: #ff0000;">android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br>        android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br>        android:id</span><span style="color: #0000ff;">=â€@+id/material_listviewâ€</span><span style="color: #0000ff;">/&gt;</span><br><br><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">RelativeLayout</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>&nbsp;</p>
<p><strong>6.&nbsp;<a href="https://github.com/futuresimple/android-floating-action-button" target="_blank" rel="noopener">android-floating-action-button</a></strong></p>
<p>Floating Action Buttonï¼ˆFABï¼‰æ˜¯ä¼—å¤šä¸“å®¶å¤§ç‰›é’ˆå¯¹Material Designè®¨è®ºæ¯”è¾ƒç»†åŒ–çš„ä¸€ä¸ªç‚¹ï¼Œé€šè¿‡åœ†å½¢å…ƒç´ ä¸åˆ†å‰²çº¿ã€å¡ç‰‡ã€å„ç§Barçš„ç›´çº¿å½¢æˆé²œæ˜å¯¹æ¯”ï¼Œå¹¶ä½¿ç”¨è‰²å½©è®¾å®šä¸­é²œè‰³çš„è¾…è‰²ï¼Œå¸¦æ¥æ›´å…·çªç ´æ€§çš„è§†è§‰æ•ˆæœã€‚ä¹Ÿæ­£å› å¦‚æ­¤ï¼Œåœ¨Githubä¸Šï¼Œæœ‰ç€è®¸å¤šä¸FABç›¸å…³çš„å¼€æºé¡¹ç›®ï¼ŒåŸºäºMaterial Designè§„èŒƒçš„å¼€æºAndroidæµ®åŠ¨Action Buttonæ§ä»¶android-floating-action-buttonä¾¿æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546efe7e3a855_middle.jpg?_=33895" alt="">&nbsp;<img src="http://cms.csdnimg.cn/article/201411/21/546efe84a5da6.jpg" alt=""></p>
<p>å…¶ä¸»è¦ç‰¹æ€§å¦‚ä¸‹ï¼š</p>
<p>&nbsp;</p>
<ul>
<li>æ”¯æŒå¸¸è§„56dpå’Œæœ€å°40dpçš„æŒ‰é’®ï¼›</li>
<li>æ”¯æŒè‡ªå®šä¹‰æ­£å¸¸ã€PressçŠ¶æ€ä»¥åŠå¯æ‹–æ‹½å›¾æ ‡çš„æŒ‰é’®èƒŒæ™¯é¢œè‰²ï¼›</li>
<li>AddFloatingActionButtonç±»èƒ½å¤Ÿè®©å¼€å‘è€…éå¸¸æ–¹ä¾¿åœ°ç›´æ¥åœ¨ä»£ç ä¸­å†™å…¥åŠ å·å›¾æ ‡ï¼›</li>
<li>FloatingActionsMenuç±»æ”¯æŒå±•å¼€/æŠ˜å æ˜¾ç¤ºåŠ¨ä½œã€‚</li>
</ul>
<p>&nbsp;</p>
<p><strong>7.&nbsp;<a href="https://github.com/markushi/android-ui" target="_blank" rel="noopener">android-ui</a></strong></p>
<p>android-uiæ˜¯Android UIç»„ä»¶ç±»åº“ï¼Œæ”¯æŒAndroid API 14+ï¼ŒåŒ…å«äº†ActionViewã€RevealColorViewç­‰UIç»„ä»¶ã€‚å…¶ä¸­ï¼ŒActionViewå¯ä½¿ActionåŠ¨ä½œæ˜¾ç¤ºåŠ¨ç”»æ•ˆæœï¼Œè€ŒRevealColorViewåˆ™å¸¦æ¥äº†Android 5.0ä¸­çš„åœ†å½¢æ˜¾ç¤º/éšè—åŠ¨ç”»ä½“éªŒã€‚</p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546f0a7681186.jpg" alt=""></p>
<p><strong>8.&nbsp;<a href="https://github.com/balysv/material-menu" target="_blank" rel="noopener">Material Menu</a></strong></p>
<p>Material Menuä¸ºå¼€å‘è€…å¸¦æ¥äº†éå¸¸é…·ç‚«çš„Androidèœå•ã€è¿”å›ã€åˆ é™¤ä»¥åŠæ£€æŸ¥æŒ‰é’®å˜å½¢ï¼Œå®Œå…¨æ§åˆ¶åŠ¨ç”»ï¼Œå¹¶ä¸ºå¼€å‘è€…æä¾›äº†ä¸¤ç§MaterialMenuDrawableåŒ…è£…ã€‚</p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546f0b8672e44.jpg" alt=""></p>
<p>è‡ªå®šä¹‰é¢œè‰²ç­‰æ“ä½œï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">//</span><span style="color: #008000;"> change color</span><br>MaterialMenu.setColor(<span style="color: #0000ff;">int</span><span style="color: #000000;"> color)<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;"> change transformation animation duration</span><br>MaterialMenu.setTransformationDuration(<span style="color: #0000ff;">int</span><span style="color: #000000;"> duration)<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;"> change pressed animation duration</span><br>MaterialMenu.setPressedDuration(<span style="color: #0000ff;">int</span><span style="color: #000000;"> duration)<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;"> change transformation interpolator</span><br><span style="color: #000000;">MaterialMenu.setInterpolator(Interpolator interpolator)<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;"> set RTL layout support</span><br>MaterialMenu.setRTLEnabled(<span style="color: #0000ff;">boolean</span> enabled)</pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>9.&nbsp;<a href="https://github.com/ksoichiro/Android-ObservableScrollView" target="_blank" rel="noopener">Android-ObservableScrollView</a></strong></p>
<p>Android-ObservableScrollViewæ˜¯ä¸€æ¬¾ç”¨äºåœ¨æ»šåŠ¨è§†å›¾ä¸­è§‚æµ‹æ»šåŠ¨äº‹ä»¶çš„Androidåº“ã€‚å®ƒèƒ½å¤Ÿè½»è€Œæ˜“ä¸¾åœ°ä¸Android 5.0 Lollipopå¼•è¿›çš„å·¥å…·æ ï¼ˆToolbarï¼‰è¿›è¡Œäº¤äº’ï¼Œè¿˜å¯ä»¥å¸®åŠ©å¼€å‘è€…å®ç°æ‹¥æœ‰Material Designåº”ç”¨è§†è§‰ä½“éªŒçš„ç•Œé¢å¤–è§‚ï¼Œæ”¯æŒListViewã€ScrollViewã€WebViewã€RecyclerViewã€GridViewç»„ä»¶ã€‚</p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546ef6d6abfcd.jpg" alt=""><img src="http://cms.csdnimg.cn/article/201411/21/546ef6e476b55.jpg" alt=""><img src="http://cms.csdnimg.cn/article/201411/21/546ef6eea211e.jpg" alt=""></p>
<p>äº¤äº’ä»£ç å›è°ƒï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #000000;">@Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onUpOrCancelMotionEvent(ScrollState scrollState) {<br>        ActionBar ab </span>=<span style="color: #000000;"> getSupportActionBar();<br>        </span><span style="color: #0000ff;">if</span> (scrollState ==<span style="color: #000000;"> ScrollState.UP) {<br>            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (ab.isShowing()) {<br>                ab.hide();<br>            }<br>        } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (scrollState ==<span style="color: #000000;"> ScrollState.DOWN) {<br>            </span><span style="color: #0000ff;">if</span> (!<span style="color: #000000;">ab.isShowing()) {<br>                ab.show();<br>            }<br>        }<br>    }</span></pre><br></div>

<p>&nbsp;</p>
<p><strong>10.&nbsp;<a href="https://github.com/google/material-design-icons" target="_blank" rel="noopener">Material Design Icons</a></strong></p>
<p>æœ€åï¼Œå†æ¥ä»‹ç»ä¸€ä¸‹Google Material Designè§„èŒƒçš„å®˜æ–¹å¼€æºå›¾æ ‡é›†Material Design Iconsã€‚è‰¯å¿ƒGoogleå¼€æºäº†åŒ…æ‹¬Material Designç³»ç»Ÿå›¾æ ‡åŒ…åœ¨å†…çš„750ä¸ªå­—å½¢ï¼Œæ¶µç›–åŠ¨ä½œã€éŸ³è§†é¢‘ã€é€šä¿¡ã€å†…å®¹ã€ç¼–è¾‘å™¨ã€æ–‡ä»¶ã€ç¡¬ä»¶ã€å›¾åƒã€åœ°å›¾ã€å¯¼èˆªã€é€šçŸ¥ã€ç¤¾äº¤ç­‰å„ä¸ªæ–¹é¢ï¼Œé€‚ç”¨äºWebã€Androidå’ŒiOSåº”ç”¨å¼€å‘ï¼Œç»å¯¹æ˜¯å¼€å‘è€…åŠè®¾è®¡å¸ˆå¿…å¤‡çš„èµ„æºã€‚</p>
<p><img src="http://cms.csdnimg.cn/article/201411/21/546ef31fa0f7e_middle.jpg" alt=""></p>
<p>å›¾æ ‡æ ¼å¼ä¸»è¦åŒ…æ‹¬ï¼š&nbsp;</p>
<ul>
<li>SVGæ ¼å¼ï¼Œ24pxå’Œ48pxï¼›</li>
<li>SVGå’ŒCSS Spritesï¼›</li>
<li>é€‚ç”¨äºWebå¹³å°çš„1xã€2x PNGæ ¼å¼å›¾æ ‡ï¼›</li>
<li>é€‚ç”¨äºiOSçš„1xã€2xã€3x PNGå›¾æ ‡ï¼›</li>
<li>æ‰€æœ‰å›¾æ ‡çš„Hi-dpiç‰ˆæœ¬ï¼ˆhdpiã€mdpiã€xhdpiã€xxhdpiã€xxxhdpiï¼‰ã€‚</li>
</ul>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> view </tag>
            
            <tag> Material Design </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ä½¿ç”¨AdapterTypeRenderå¯¹ä¸åŒç±»å‹çš„itemæ•°æ®åˆ°UIçš„æ¸²æŸ“]]></title>
      <url>/2014/09/25/Android-%E4%BD%BF%E7%94%A8AdapterTypeRender%E5%AF%B9%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E7%9A%84item%E6%95%B0%E6%8D%AE%E5%88%B0UI%E7%9A%84%E6%B8%B2%E6%9F%93/</url>
      <content type="html"><![CDATA[<p>æœ¬æ–‡è®²çš„å·¥å…·å‡æ”¾åœ¨<strong><a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">AndroidBucket</a></strong>å¼€æºé¡¹ç›®ä¸­ï¼Œæ¬¢è¿å¤§å®¶star/forkï¼Œåœ°å€ï¼š<a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket</a></p>
<p>&nbsp;</p>
<p>ä¸»è¦å®ç°èŠå¤©åŠŸèƒ½ä¸­çš„å‘é€ä¸åŒç±»å‹çš„ä¿¡æ¯ï¼Œæ¯”å¦‚çº¯æ–‡æœ¬ã€å›¾ç‰‡ã€è¯­éŸ³ã€å›¾æ–‡æ··æ’å¤šåª’ä½“çš„æ•°æ®ç­‰ï¼ˆå…·ä½“æ•ˆæœçœ‹å¾®ä¿¡ï¼‰ã€‚</p>
<p>è¿™é‡Œä½¿ç”¨AdapterTypeRenderåœ¨BaseTypeAdapterï¼ˆè¿™ä¸ªä¹‹åä¼šè®²åˆ°ï¼‰ä¸­å®ç°ã€‚</p>
<p>è¿™é‡Œä¸»è¦çš„å®ç°æ–¹å¼æ˜¯åœ¨ChatAdapterï¼ˆç»§æ‰¿BaseTypeAdapterï¼‰ä¸­æ ¹æ®æ¯ä¸ªpositionçš„itemçš„typeï¼Œæ¥ä½¿ç”¨ä¸åŒçš„AdapterTypeRenderæ¸²æŸ“å™¨è¿›è¡Œæ¸²æŸ“ã€‚æ¸²æŸ“çš„è¿‡ç¨‹å½“ç„¶æ˜¯åœ¨getViewæ–¹æ³•ä¸­è¿›è¡Œã€‚</p>
<p><strong>1.&nbsp;AdapterTypeRender</strong></p>
<p>å…ˆæ¥çœ‹çœ‹AdapterTypeRenderè¿™ä¸ªæ¥å£ã€‚å®ƒæœ‰3ä¸ªæ–¹æ³•ï¼šgetConvertView()ã€fitEvents()ã€fitDatas()ä¸‰ä¸ªæ–¹æ³•ã€‚</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.androidbucket.adapter;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br><br></span><span style="color: #008000;">/<strong></strong></span><span style="color: #008000;"><br> <em> ç”¨äºå¯¹ä¸åŒç±»å‹itemæ•°æ®åˆ°UIçš„æ¸²æŸ“
 </em> Author: wangjie<br> <em> Email: tiantian.china.2@gmail.com
 </em> Date: 9/14/14.<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> AdapterTypeRender {<br><br>    </span><span style="color: #008000;">/</span><span style="color: #008000;"><br>     <em> è¿”å›ä¸€ä¸ªitemçš„convertViewï¼Œä¹Ÿå°±æ˜¯BaseAdapterä¸­getViewæ–¹æ³•ä¸­è¿”å›çš„convertView
     </em> </span><span style="color: #808080;">@return</span><br>     <span style="color: #008000;"><em>/</em></span><span style="color: #000000;"><br>    View getConvertView();<br><br>    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
      å¡«å……itemä¸­å„ä¸ªæ§ä»¶çš„äº‹ä»¶ï¼Œæ¯”å¦‚æŒ‰é’®ç‚¹å‡»äº‹ä»¶ç­‰<br>     </span><span style="color: #008000;"><em>/</em></span><br>    <span style="color: #0000ff;">void</span><span style="color: #000000;"> fitEvents();<br><br>    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
      å¯¹æŒ‡å®špositionçš„itemè¿›è¡Œæ•°æ®çš„é€‚é…<br>     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> position<br>     </span><span style="color: #008000;">/</span><br>    <span style="color: #0000ff;">void</span> fitDatas(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position);<br><br>}</span></pre><br></div>

<p>ï¼getconvertView()æ–¹æ³•ç”¨äºè¿”å›ç»™BaseTypeAdapterä¸€ä¸ªconvertViewï¼Œä¸€ä¸ªAdapterTypeRenderå®ç°ç±»å¯¹åº”ä¸€ä¸ªconvertViewå®ä¾‹ï¼Œè¯¥AdapterTypeRenderå¯ä»¥è¢«é‡ç”¨ï¼Œæ‰€ä»¥convertViewä¹Ÿå¯ä»¥è¢«é‡ç”¨äº†ã€‚</p>
<p>ï¼fitEvents()æ–¹æ³•ç”¨äºç»™å½“å‰çš„itemä¸­çš„å„ä¸ªæ§ä»¶æ³¨å†Œäº‹ä»¶ï¼Œæ¯”å¦‚ç‚¹å‡»äº‹ä»¶ã€touchäº‹ä»¶ç­‰ï¼ˆå…·ä½“çš„æ³¨å†Œäº‹ä»¶åé¢å›è®²åˆ°ï¼‰ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨getViewä¸­åªæœ‰convertViewä¸ºnullæ—¶æ‰ä¼šè°ƒç”¨ï¼Œæ‰€ä»¥åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæ·»åŠ äº‹ä»¶æ˜¯æ¯”è¾ƒå¥½çš„ã€‚</p>
<p>ï¼fitDatas()æ–¹æ³•ç”¨äºæŠŠæ•°æ®é€‚é…åˆ°itemçš„å„ä¸ªviewä¸­è¿›è¡Œæ˜¾ç¤ºã€‚è¿™ä¸ªæ–¹æ³•åªè¦getViewå¾—åˆ°è°ƒç”¨ï¼Œå°±ä¼šè¢«è°ƒç”¨ã€‚</p>
<p><strong>2. BaseTypeAdapter</strong></p>
<p>è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ˜¯ç»§æ‰¿äºBaseAdapterçš„ï¼Œé‡å†™äº†é‡Œé¢çš„getViewæ–¹æ³•ã€‚ä¼šè‡ªåŠ¨æ ¹æ®æŒ‡å®špositionçš„itemè·å–å¯¹åº”çš„typeï¼Œç„¶åé€šè¿‡typeå®ä¾‹åŒ–ä¸€ä¸ªAdapterTypeRenderçš„å®ç°ï¼Œç„¶ååˆä½¿ç”¨äº†BaseAdapterä¸­è‡ªå¸¦çš„convertViewçš„é‡ç”¨æœºåˆ¶è¿›è¡Œå¯¹viewçš„é‡ç”¨ï¼ŒåŒæ ·ä¹Ÿæ˜¯å¯¹AdapterTypeRenderçš„é‡ç”¨ã€‚</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.androidbucket.adapter.typeadapter;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.annotation.TargetApi;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.Build;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.ViewGroup;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.BaseAdapter;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.R;<br><br></span><span style="color: #008000;">/<strong></strong></span><span style="color: #008000;"><br> <em> Author: wangjie
 </em> Email: tiantian.china.2@gmail.com<br> <em> Date: 9/25/14.<br> </em></span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span> BaseTypeAdapter <span style="color: #0000ff;">extends</span><span style="color: #000000;"> BaseAdapter{<br>    @TargetApi(Build.VERSION_CODES.DONUT)<br>    @Override<br>    </span><span style="color: #0000ff;">public</span> View getView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position, View convertView, ViewGroup parent) {<br>        AdapterTypeRender typeRender;<br>        </span><span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> convertView){<br>            typeRender </span>=<span style="color: #000000;"> getAdapterTypeRender(position);<br>            convertView </span>=<span style="color: #000000;"> typeRender.getConvertView();<br>            convertView.setTag(R.id.ab<strong>id_adapter_item_type_render, typeRender);<br>            typeRender.fitEvents();<br>        }</strong></span><span style="color: #0000ff;">else</span><span style="color: #000000;">{<br>            typeRender </span>=<span style="color: #000000;"> (AdapterTypeRender) convertView.getTag(R.id.abid_adapter_item_type_render);<br>        }<br>        convertView.setTag(R.id.ab__id_adapter_item_position, position);<br><br>        </span><span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> typeRender){<br>            typeRender.fitDatas(position);<br>        }<br><br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> convertView;<br>    }<br><br>    </span><span style="color: #008000;">/</span><span style="color: #008000;"><br>     <em> æ ¹æ®æŒ‡å®špositionçš„itemè·å–å¯¹åº”çš„typeï¼Œç„¶åé€šè¿‡typeå®ä¾‹åŒ–ä¸€ä¸ªAdapterTypeRenderçš„å®ç°
     </em> </span><span style="color: #808080;">@param</span><span style="color: #008000;"> position<br>     <em> </em></span><span style="color: #808080;">@return</span><br>     <span style="color: #008000;">/</span><br>    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> AdapterTypeRender getAdapterTypeRender(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position);<br>}</span></pre><br></div>

<p>ä¸ºäº†å®ç°AdapterTypeRenderçš„é‡ç”¨ï¼Œä¸€æ—¦ç”Ÿæˆäº†ä¸€ä¸ªAdapterTypeRenderå®ç°ç±»çš„å®ä¾‹ï¼Œåˆ™ä½¿ç”¨setTagçš„æ–¹æ³•è¿›è¡Œå¯¹convertViewå’ŒAdapterTypeRenderçš„ç»‘å®šï¼ˆR.id.ab__id_adapter_item_type_renderè¿™ä¸ªidæ˜¯åœ¨<strong><a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">AndroidBucket</a></strong>ä¸­å®šä¹‰äº†çš„ï¼‰ï¼Œè¿™ä¸ªå¯ä»¥å‚è€ƒä»¥å‰çš„ViewHolderçš„å†™æ³•ã€‚</p>
<p>ä¸ºäº†å®ç°åœ¨åŒä¸€ä¸ªitemä¸­çš„äº‹ä»¶ï¼ˆè¿™é‡Œä»¥viewçš„ç‚¹å‡»äº‹ä»¶ä¸ºä¾‹ï¼‰å“åº”éƒ½å…±ç”¨ä¸€ä¸ªè§‚å¯Ÿè€…çš„å®ä¾‹ï¼Œéœ€è¦åœ¨convertViewä¸­ä¿å­˜å¯¹åº”çš„positionã€‚è¿™æ˜¯å› ä¸ºåŒä¸€ä¸ªconvertViewå› ä¸ºä½¿ç”¨äº†viewçš„é‡ç”¨ï¼Œæ˜¯è¢«éæ˜¾ç¤ºé¡µé¢çš„å¾ˆå¤šä¸ªitemæ‰€å…±ç”¨çš„ã€‚æ‰€ä»¥åªéœ€è¦ï¼Œåœ¨å½“å‰æ˜¾ç¤ºçš„ä¸€å±ä¸­ï¼Œæ¯ä¸ªconvertViewå¯¹åº”çš„postionå³å¯ï¼Œæ¯•ç«Ÿè¿™äº›äº‹ä»¶è§¦å‘åªæœ‰åœ¨å½“å‰æ˜¾ç¤ºçš„ä¸€å±ä¸­æ‰ä¼šè¢«è§¦å‘ã€‚ä¿å­˜postionçš„æ–¹å¼ä¾ç„¶ä½¿ç”¨äº†setTagçš„æ–¹å¼ï¼ˆR.id.ab__id_adapter_item_positionè¿™ä¸ªidæ˜¯åœ¨<strong><a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">AndroidBucket</a></strong>ä¸­å®šä¹‰äº†çš„ï¼‰ï¼Œæ³¨æ„ï¼šå­ç±»ä¸€èˆ¬ä¸éœ€è¦é‡å†™getViewæ–¹æ³•äº†ï¼Œå…¶ä»–çš„æ•°æ®é€‚é…UIæ¸²æŸ“éƒ½äº¤ç»™Renderå§ï¼</p>
<p>é™¤äº†é‡å†™äº†getViewæ–¹æ³•ä¹‹å¤–ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼šgetAdapterTypeRenderã€‚è¿™ä¸ªæ–¹æ³•éœ€è¦å­ç±»å»å®ç°ï¼Œéœ€è¦å‘Šè¯‰BaseTypeAdapterï¼ŒæŒ‡å®špositionçš„itemï¼Œå®ƒçš„typeå¯¹åº”çš„AdapterTypeRenderçš„å®ä¾‹æ˜¯ä»€ä¹ˆã€‚</p>
<p><strong>3. è‡ªå®šä¹‰AdapterTypeRenderçš„å®ç°</strong></p>
<p>æ¥ä¸‹æ¥ï¼Œå°±å°è¯•è‡ªå·±å®ç°å‡ ä¸ªä¸åŒå¸ƒå±€çš„Renderå§ã€‚è¿™é‡Œå‡è®¾éœ€è¦å®ç°ä¸¤ç§ï¼šæ–‡æœ¬å¸ƒå±€ï¼ˆTypeTextRenderï¼‰ã€å›¾ç‰‡å¸ƒå±€ï¼ˆTypeImageRenderï¼‰ã€‚</p>
<p>a) TypeTextRenderçš„å®ç°ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.activities.typerendertest.adapter;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.content.Context;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.LayoutInflater;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.ImageButton;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.ImageView;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.ProgressBar;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.TextView;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.adapter.typeadapter.AdapterTypeRender;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.adapter.listener.OnConvertViewClickListener;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.thread.ThreadPool;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.utils.ABTimeUtil;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.utils.ABViewUtil;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.imageloadersample.imageloader.ImageLoader;<br><br></span><span style="color: #008000;">/<strong></strong></span><span style="color: #008000;"><br> <em> Author: wangjie
 </em> Email: tiantian.china.2@gmail.com<br> <em> Date: 9/14/14.<br> </em></span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TypeTextRender <span style="color: #0000ff;">implements</span><span style="color: #000000;"> AdapterTypeRender {<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Context context;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> ChatAdapter adapter;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> View contentView;<br><br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> TypeTextRender(Context context, ChatAdapter adapter) {<br>        </span><span style="color: #0000ff;">this</span>.context =<span style="color: #000000;"> context;<br>        </span><span style="color: #0000ff;">this</span>.adapter =<span style="color: #000000;"> adapter;<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> è§£ææ–‡æœ¬ç±»å‹çš„å¸ƒå±€</span><br>        contentView = LayoutInflater.from(context).inflate(R.layout.item_type_text, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> View getConvertView() {<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> è¿”å›æ–‡æœ¬ç±»å‹çš„å¸ƒå±€</span><br>        <span style="color: #0000ff;">return</span><span style="color: #000000;"> contentView;<br>    }<br><br>    </span><span style="color: #008000;">/</span><span style="color: #008000;"><br>     <em> è¿™ä¸ªæ–¹æ³•åŒä¸€ä¸ªconvertViewåªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥å¯ä»¥æ”¾å¿ƒåœ°åœ¨è¿™é‡Œæ‰§è¡Œäº‹ä»¶åœ°ç»‘å®šï¼Œä¸ç”¨æ‹…å¿ƒç”Ÿæˆè¿‡å¤šçš„OnClickListenerç­‰<br>     </em></span><span style="color: #008000;">/</span><span style="color: #000000;"><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> fitEvents() {<br>        </span><span style="color: #008000;">/<strong></strong></span><span style="color: #008000;"><br>         <em> ç”Ÿæˆä¸€ä¸ªåœ¨convertViewä¸­ä½¿ç”¨çš„clickListener<br>         </em></span><span style="color: #008000;">/</span><span style="color: #000000;"><br>        OnConvertViewClickListener onConvertViewClickListener </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> OnConvertViewClickListener(contentView, R.id.ab__id_adapter_item_position) {<br>            @Override<br>            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onClickCallBack(View registedView, <span style="color: #0000ff;">int</span><span style="color: #000000;">â€¦ positionIds) {<br>                ChatAdapter.OnChatItemListener onChatItemListener </span>=<span style="color: #000000;"> adapter.getOnChatItemListener();<br>                </span><span style="color: #0000ff;">switch</span><span style="color: #000000;"> (registedView.getId()) {<br>                    </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.item_type_text_view:<br>                        </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> != onChatItemListener &amp;&amp; <span style="color: #0000ff;">null</span> != positionIds &amp;&amp; positionIds.length &gt; 0<span style="color: #000000;">) {<br>                            onChatItemListener.onItemClicked(positionIds[</span>0<span style="color: #000000;">]);<br>                        }<br>                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br><br>                    </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.item_type_text_head_iv:<br>                        </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> != onChatItemListener &amp;&amp; <span style="color: #0000ff;">null</span> != positionIds &amp;&amp; positionIds.length &gt; 0<span style="color: #000000;">) {<br>                            onChatItemListener.onHeadClicked(positionIds[</span>0<span style="color: #000000;">]);<br>                        }<br>                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br><br>                }<br><br>            }<br>        };<br><br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> é€šè¿‡ABViewUtilä»contentViewä¸­è·å–å¯¹åº”idçš„æ§ä»¶ï¼Œç„¶åè®¾ç½®OnClickListener</span><br><span style="color: #000000;">        ABViewUtil.obtainView(contentView, R.id.item_type_text_view)<br>                .setOnClickListener(onConvertViewClickListener);<br>        ABViewUtil.obtainView(contentView, R.id.item_type_text_head_iv)<br>                .setOnClickListener(onConvertViewClickListener);<br><br>    }<br><br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> ImageView headIv;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> View rootView;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> TextView contentTv;<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> fitDatas(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position) {<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> é€šè¿‡ABViewUtilä»contentViewä¸­è·å–å¯¹åº”idçš„æ§ä»¶ï¼Œç„¶åè®¾ç½®OnClickListener</span><br>        headIv =<span style="color: #000000;"> ABViewUtil.obtainView(contentView, R.id.item_type_text_head_iv);<br>        contentTv </span>=<span style="color: #000000;"> ABViewUtil.obtainView(contentView, R.id.item_type_text_content_tv);<br>        </span><span style="color: #008000;">/</span><span style="color: #008000;"><br>         <em> åœ¨è¿™é‡Œé€‚é…æ•°æ®åˆ°ui<br>         </em></span><span style="color: #008000;">/</span><span style="color: #000000;"><br>        Message message </span>=<span style="color: #000000;"> adapter.getItem(position);<br>        contentTv.setText(message.getContent());<br>        ImageLoader.getInstances().displayImage(message.getHeadUrl(), headIv, </span>100, <span style="color: #0000ff;">null</span><span style="color: #000000;">, R.drawable.default_head);<br><br>    }<br><br>}</span></pre><br></div>

<p>å¦‚ä¸Šä»£ç ï¼Œè¯¥TypeTextRenderå®ç°äº†AdapterTypeRenderæ¥å£ï¼Œå®ç°äº†å…¶ä¸­çš„3ä¸ªæ–¹æ³•ã€‚æ³¨æ„ï¼šéœ€è¦åœ¨æ„é€ æ–¹æ³•ä¸­è§£æå‡ºconvertViewï¼Œç”¨äºæä¾›ç»™BaseTypeAdapteråœ¨getViewä¸­è¿”å›ã€‚</p>
<p>ç„¶ååœ¨fitEventsä¸­æ³¨å†Œå„ç§äº‹ä»¶ï¼Œè¿™é‡Œåªæ³¨å†Œäº†ç‚¹å‡»äº‹ä»¶ï¼ˆä¸€ä¸ªrootViewã€ä¸€ä¸ªheadIvæ³¨å†Œäº†ç‚¹å‡»äº‹ä»¶ï¼‰ã€‚è¿™é‡Œçš„OnConvertViewClickListeneræ˜¯ä¸€ä¸ªå®ç°äº†View.OnClickListenerçš„ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç”Ÿæˆä¸€ä¸ªOnConvertViewClickListeneræ—¶éœ€è¦ä¼ å…¥convertViewå’Œpositionsçš„idï¼Œè¿™æ ·ç”±äºRenderè¢«é‡ç”¨åï¼ŒconvertViewä¹Ÿæ˜¯è¢«é‡ç”¨äº†ï¼Œå¯¼è‡´onClickListenerä¹Ÿæ˜¯è¢«é‡ç”¨äº†ï¼Œè¿™ä¼šå¯¼è‡´å“åº”ç‚¹å‡»äº‹ä»¶çš„æ—¶å€™ï¼Œå›è°ƒçš„onClickedæ–¹æ³•ä¸­æ— æ³•å¾—çŸ¥ç‚¹å‡»çš„æ˜¯å“ªä¸ªViewï¼Œæ‰€ä»¥ï¼Œéœ€è¦æŠŠconverViewå’Œpositionsçš„idä¼ å…¥ï¼Œpositionsçš„idå¯ä»¥ç”¨æ¥åœ¨convertViewä¸­ç»‘å®špostionä½œä¸ºtagã€‚positonsIdsæ˜¯ä¸€ä¸ªå¯å˜é•¿çš„å‚æ•°ï¼Œå› ä¸ºå¯èƒ½æ˜¯ä¸€ä¸ªExpandableListViewï¼Œéœ€è¦groupPositionå’ŒchildPositionä¸¤ä¸ªpositonæ¥ç¡®å®šã€‚å›è°ƒçš„onClickCallBackä¸­çš„å‚æ•°registedViewè¡¨ç¤ºè¢«ç‚¹å‡»çš„viewï¼ŒpositionIdsï¼Œè¢«ç‚¹å‡»çš„itemçš„positionsï¼ˆè¿™ä¸ªä¹Ÿæ˜¯å¯ä»¥åœ¨<strong><a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">AndroidBucket</a></strong>ä¸­æ‰¾åˆ°ï¼Œä»¥åæœ‰æ—¶é—´ä¼šé’ˆå¯¹è¿™ä¸ªè¯¦ç»†è¯´æ˜ï¼‰ã€‚</p>
<p>&ldquo;ABViewUtil.obtainViewâ€¦&rdquo;è¿™ä¸ªæ–¹æ³•å¯¹viewHolderè¿›è¡Œäº†å°è£…ï¼ŒæŠŠconvertViewä¸­çš„æ§ä»¶éƒ½ç¼“å­˜åœ¨äº†ä¸€ä¸ªSparseArray&lt;View&gt;ä¸­ï¼ˆä½œç”¨è·Ÿå¸¸ç”¨çš„ViewHolderç›¸åŒï¼‰ã€‚</p>
<p>ç„¶ååœ¨fitDatasæ–¹æ³•ä¸­å°±å¯ä»¥è¿›è¡Œå¯¹æ•°æ®çš„é€‚é…äº†ï¼Œç›¸å½“äºæˆ‘ä»¬ä»¥å‰åœ¨BaseAdapterçš„getViewæ–¹æ³•ä¸­çš„æ“ä½œäº†ã€‚</p>
<p>b) TypeImageRenderçš„å®ç°ï¼ˆä¸TypeTextRenderå¤§åŒå°å¼‚ï¼Œä¸åšè¿‡å¤šçš„è¯´æ˜äº†ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.activities.typerendertest.adapter;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.content.Context;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.LayoutInflater;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.ImageButton;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.ImageView;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.ProgressBar;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.TextView;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.adapter.typeadapter.AdapterTypeRender;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.adapter.listener.OnConvertViewClickListener;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.thread.ThreadPool;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.utils.ABTimeUtil;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.utils.ABViewUtil;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.imageloadersample.imageloader.ImageLoader;<br><br></span><span style="color: #008000;">/<strong></strong></span><span style="color: #008000;"><br> <em> Author: wangjie
 </em> Email: tiantian.china.2@gmail.com<br> <em> Date: 9/14/14.<br> </em></span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ChatTypeImageRender <span style="color: #0000ff;">implements</span><span style="color: #000000;"> AdapterTypeRender {<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Context context;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> ChatAdapter adapter;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> View contentView;<br><br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> ChatTypeImageRender(Context context, ChatAdapter adapter) {<br>        </span><span style="color: #0000ff;">this</span>.context =<span style="color: #000000;"> context;<br>        </span><span style="color: #0000ff;">this</span>.adapter =<span style="color: #000000;"> adapter;<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> è§£æå›¾ç‰‡ç±»å‹çš„å¸ƒå±€</span><br>        contentView = LayoutInflater.from(context).inflate(R.layout.item_type_text, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> View getConvertView() {<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> è¿”å›æ–‡æœ¬ç±»å‹çš„å¸ƒå±€</span><br>        <span style="color: #0000ff;">return</span><span style="color: #000000;"> contentView;<br>    }<br><br>    </span><span style="color: #008000;">/</span><span style="color: #008000;"><br>     <em> è¿™ä¸ªæ–¹æ³•åŒä¸€ä¸ªconvertViewåªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥å¯ä»¥æ”¾å¿ƒåœ°åœ¨è¿™é‡Œæ‰§è¡Œäº‹ä»¶åœ°ç»‘å®šï¼Œä¸ç”¨æ‹…å¿ƒç”Ÿæˆè¿‡å¤šçš„OnClickListenerç­‰<br>     </em></span><span style="color: #008000;">/</span><span style="color: #000000;"><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> fitEvents() {<br>        </span><span style="color: #008000;">/<strong></strong></span><span style="color: #008000;"><br>         <em> ç”Ÿæˆä¸€ä¸ªåœ¨convertViewä¸­ä½¿ç”¨çš„clickListener<br>         </em></span><span style="color: #008000;">/</span><span style="color: #000000;"><br>        OnConvertViewClickListener onConvertViewClickListener </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> OnConvertViewClickListener(contentView, R.id.ab__id_adapter_item_position) {<br>            @Override<br>            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onClickCallBack(View registedView, <span style="color: #0000ff;">int</span><span style="color: #000000;">â€¦ positionIds) {<br>                ChatAdapter.OnChatItemListener onChatItemListener </span>=<span style="color: #000000;"> adapter.getOnChatItemListener();<br>                </span><span style="color: #0000ff;">switch</span><span style="color: #000000;"> (registedView.getId()) {<br>                    </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.item_type_text_view:<br>                        </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> != onChatItemListener &amp;&amp; <span style="color: #0000ff;">null</span> != positionIds &amp;&amp; positionIds.length &gt; 0<span style="color: #000000;">) {<br>                            onChatItemListener.onItemClicked(positionIds[</span>0<span style="color: #000000;">]);<br>                        }<br>                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br><br>                    </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.item_type_text_head_iv:<br>                        </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> != onChatItemListener &amp;&amp; <span style="color: #0000ff;">null</span> != positionIds &amp;&amp; positionIds.length &gt; 0<span style="color: #000000;">) {<br>                            onChatItemListener.onHeadClicked(positionIds[</span>0<span style="color: #000000;">]);<br>                        }<br>                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br>                    </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.item_type_text_content_iv:<br>                        </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">null</span> != onChatItemListener &amp;&amp; <span style="color: #0000ff;">null</span> != positionIds &amp;&amp; positionIds.length &gt; 0<span style="color: #000000;">) {<br>                            onChatItemListener.onImageClicked(positionIds[</span>0<span style="color: #000000;">]);<br>                        }<br>                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br><br>                }<br><br>            }<br>        };<br><br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> é€šè¿‡ABViewUtilä»contentViewä¸­è·å–å¯¹åº”idçš„æ§ä»¶ï¼Œç„¶åè®¾ç½®OnClickListener</span><br><span style="color: #000000;">        ABViewUtil.obtainView(contentView, R.id.item_type_text_view)<br>                .setOnClickListener(onConvertViewClickListener);<br>        ABViewUtil.obtainView(contentView, R.id.item_type_text_head_iv)<br>                .setOnClickListener(onConvertViewClickListener);<br>        ABViewUtil.obtainView(contentView, R.id.item_type_text_content_iv)<br>                .setOnClickListener(onConvertViewClickListener);<br><br>    }<br><br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> ImageView headIv;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> View rootView;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> ImageView contentIv;<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> fitDatas(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position) {<br>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> é€šè¿‡ABViewUtilä»contentViewä¸­è·å–å¯¹åº”idçš„æ§ä»¶ï¼Œç„¶åè®¾ç½®OnClickListener</span><br>        headIv =<span style="color: #000000;"> ABViewUtil.obtainView(contentView, R.id.item_type_text_head_iv);<br>        contentIv </span>=<span style="color: #000000;"> ABViewUtil.obtainView(contentView, R.id.item_type_text_content_iv);<br>        </span><span style="color: #008000;">/</span><span style="color: #008000;"><br>         <em> åœ¨è¿™é‡Œé€‚é…æ•°æ®åˆ°ui<br>         </em></span><span style="color: #008000;">/</span><span style="color: #000000;"><br>        Message message </span>=<span style="color: #000000;"> adapter.getItem(position);<br>        ImageLoader.getInstances().displayImage(message.getHeadUrl(), headIv, </span>100, <span style="color: #0000ff;">null</span><span style="color: #000000;">, R.drawable.default_head);<br>        ImageLoader.getInstances().displayImage(message.getContentUrl(), headIv, </span>100, <span style="color: #0000ff;">null</span><span style="color: #000000;">, R.drawable.default_pic);<br><br>    }<br><br>}</span></pre><br></div>

<p><strong>3. BaseTypeAdapterçš„å®ç°</strong></p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å®šä¹‰å¥½äº†å„ç§typeçš„Renderäº†ï¼Œç°åœ¨éœ€è¦åœ¨Adapterä¸­å»ä½¿ç”¨å®ƒï¼Œæ–¹æ³•ä¹‹å‰è®²è¿‡ï¼Œåªè¦ç»§æ‰¿BaseTypeAdapterï¼Œç„¶åå®ç°é‡Œé¢çš„getAdapterTypeRenderæ–¹æ³•å³å¯ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.activities.typerendertest.adapter;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.content.Context;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.adapter.typeadapter.AdapterTypeRender;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidbucket.adapter.typeadapter.BaseTypeAdapter;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br><br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  Author: wangjie<br> <em> Email: tiantian.china.2@gmail.com
 </em> Date: 9/14/14.<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MessageAdapter <span style="color: #0000ff;">extends</span><span style="color: #000000;"> BaseTypeAdapter {<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> OnChatItemListener{<br>        </span><span style="color: #0000ff;">void</span> onImageClicked(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position);<br>        </span><span style="color: #0000ff;">void</span> onHeadClicked(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position);<br>        </span><span style="color: #0000ff;">void</span> onItemClicked(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position);<br>    }<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> OnChatItemListener onChatItemListener;<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setOnChatItemListener(OnChatItemListener onChatItemListener) {<br>        </span><span style="color: #0000ff;">this</span>.onChatItemListener =<span style="color: #000000;"> onChatItemListener;<br>    }<br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> OnChatItemListener getOnChatItemListener() {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> onChatItemListener;<br>    }<br><br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Context context;<br>    </span><span style="color: #0000ff;">private</span> List&lt;Message&gt;<span style="color: #000000;"> list;<br>    </span><span style="color: #0000ff;">public</span> List&lt;Message&gt;<span style="color: #000000;"> getList() {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> list;<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> MessageAdapter(Context context, List&lt;Message&gt;<span style="color: #000000;"> list) {<br>        </span><span style="color: #0000ff;">this</span>.context =<span style="color: #000000;"> context;<br>        </span><span style="color: #0000ff;">this</span>.list =<span style="color: #000000;"> list;<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getCount() {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> list.size();<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> DoctorFriendMessageViewModelProxy getItem(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position) {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> list.get(position);<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">long</span> getItemId(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position) {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> position;<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> getItemViewType(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position) {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> list.get(position).getTyp();<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getViewTypeCount() {<br>        </span><span style="color: #0000ff;">return</span> 2<span style="color: #000000;">;<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> AdapterTypeRender getAdapterTypeRender(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position){<br>        AdapterTypeRender typeRender </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br>        </span><span style="color: #0000ff;">switch</span><span style="color: #000000;">(getItemViewType(position)){<br>            </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> MessageConstants.MessageType.IMAGE:<br>                typeRender </span>= <span style="color: #0000ff;">new</span> ChatTypeImageRender(context, <span style="color: #0000ff;">this</span><span style="color: #000000;">);<br>                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br>            </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> MessageConstants.MessageType.TEXT:<br>            </span><span style="color: #0000ff;">default</span><span style="color: #000000;">:<br>                typeRender </span>= <span style="color: #0000ff;">new</span> ChatTypeTextRender(context, <span style="color: #0000ff;">this</span><span style="color: #000000;">);<br>                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br>        }<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> typeRender;<br>    }<br><br>}</span></pre><br></div>

<p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œé€šè¿‡å®ç°getAdapterTypeRenderæ¥è·å–å¯¹åº”ç±»å‹çš„Renderå³å¯äº†ã€‚</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ListView </tag>
            
            <tag> best practices </tag>
            
            <tag> adapter </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidä¸Šçš„MVPï¼šå¦‚ä½•ç»„ç»‡æ˜¾ç¤ºå±‚çš„å†…å®¹]]></title>
      <url>/2014/07/13/Android%E4%B8%8A%E7%9A%84MVP%EF%BC%9A%E5%A6%82%E4%BD%95%E7%BB%84%E7%BB%87%E6%98%BE%E7%A4%BA%E5%B1%82%E7%9A%84%E5%86%85%E5%AE%B9/</url>
      <content type="html"><![CDATA[<p>MVPï¼ˆModel View Presenterï¼‰æ¨¡å¼æ˜¯è‘—åçš„MVCï¼ˆModel View Controllerï¼‰æ¨¡å¼çš„ä¸€ä¸ªæ¼”åŒ–ç‰ˆæœ¬ï¼Œç›®å‰å®ƒåœ¨Androidåº”ç”¨å¼€å‘ä¸­è¶Šæ¥è¶Šé‡è¦äº†ï¼Œå¤§å®¶ä¹Ÿéƒ½åœ¨è®¨è®ºå…³äºMVPçš„ç†è®ºï¼Œåªæ˜¯ç»“æ„åŒ–çš„èµ„æ–™éå¸¸å°‘ã€‚è¿™å°±æ˜¯æˆ‘å†™è¿™ç¯‡åšå®¢çš„åŸå› ï¼Œæˆ‘æƒ³é¼“åŠ±å¤§å®¶å¤šå‚ä¸è®¨è®ºï¼Œç„¶åæŠŠMVPæ¨¡å¼è¿ç”¨åœ¨é¡¹ç›®å¼€å‘ä¸­ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯MVPï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯MVPï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯MVPï¼Ÿ"></a>ä»€ä¹ˆæ˜¯MVPï¼Ÿ</h3><p>MVPæ¨¡å¼å¯ä»¥åˆ†ç¦»æ˜¾ç¤ºå±‚å’Œé€»è¾‘å±‚ï¼Œæ‰€ä»¥åŠŸèƒ½æ¥å£å¦‚ä½•å·¥ä½œä¸åŠŸèƒ½çš„å±•ç¤ºå¯ä»¥å®ç°åˆ†ç¦»ï¼ŒMVPæ¨¡å¼ç†æƒ³åŒ–åœ°å¯ä»¥å®ç°åŒä¸€ä»½é€»è¾‘ä»£ç æ­é…ä¸åŒçš„æ˜¾ç¤ºç•Œé¢ã€‚é¦–å…ˆè¦æ¾„æ¸…å°±æ˜¯MVPä¸æ˜¯ä¸€ä¸ªç»“æ„åŒ–çš„æ¨¡å¼ï¼Œå®ƒåªæ˜¯è´Ÿè´£æ˜¾ç¤ºå±‚è€Œå·²ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥åœ¨è‡ªå·±çš„é¡¹ç›®ç»“æ„ä¸­ä½¿ç”¨MVPæ¨¡å¼ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨MVPï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨MVPï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨MVPï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨MVPï¼Ÿ</h3><p>æˆ‘ä»¬çŸ¥é“åœ¨Androidä¸Šé€»è¾‘æ¥å£å’Œæ•°æ®å­˜å–æ˜¯ç´§è€¦åˆçš„ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥çœ‹çœ‹CursorAdapterè¿™ä¸ªä¾‹å­ï¼Œå®ƒæ—¢èåˆäº†é€‚é…å™¨ï¼ŒåŒæ—¶ä¹Ÿæœ‰æ˜¾ç¤ºçš„æˆåˆ†ï¼Œè€Œcursorå¾ˆå¤§ç¨‹åº¦ä¸Šåº”è¯¥æ˜¯æ•°æ®æ•°æ®å­˜å–å±‚çš„ã€‚</p>
<p>å¯¹äºä¸€ä¸ªå¯æ‰©å±•ã€ç¨³å®šçš„åº”ç”¨æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å„ä¸ªåˆ†ç¦»å±‚ï¼Œæ¯•ç«Ÿï¼Œæˆ‘ä»¬ä¸çŸ¥é“ä»¥åè¿˜è¦åŠ å…¥ä»€ä¹ˆé€»è¾‘ï¼Œæ˜¯ä»æœ¬åœ°æ•°æ®åº“æ£€ç´¢æ•°æ®ï¼Ÿè¿˜æ˜¯ä»è¿œç¨‹çš„web Serviceä¸­ï¼Ÿ</p>
<p>MVPæ¨¡å¼å¯ä»¥è®©æ˜¾ç¤ºç•Œé¢å’Œæ•°æ®åˆ†ç¦»ï¼Œæˆ‘ä»¬å¼€å‘çš„åº”ç”¨å¯ä»¥åˆ†ç¦»è‡³å°‘ä¸‰å±‚ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥è¿›è¡Œç‹¬ç«‹æµ‹è¯•ã€‚æœ‰äº†MVPæˆ‘ä»¬å°±å¯ä»¥ä»Activityä¸­åˆ†ç¦»å¤§éƒ¨åˆ†ä»£ç ï¼Œè€Œä¸”ä¸ç”¨å•å…ƒæµ‹è¯•å¯ä»¥å¯¹æ¯ä¸ªæ¨¡å—è¿›è¡Œå•ç‹¬æµ‹è¯•äº†ã€‚</p>
<h3 id="æ€ä¹ˆåœ¨Androidä¸Šå®ç°MVPï¼Ÿ"><a href="#æ€ä¹ˆåœ¨Androidä¸Šå®ç°MVPï¼Ÿ" class="headerlink" title="æ€ä¹ˆåœ¨Androidä¸Šå®ç°MVPï¼Ÿ"></a>æ€ä¹ˆåœ¨Androidä¸Šå®ç°MVPï¼Ÿ</h3><p>è¯´åˆ°è¿™é‡Œï¼Œé—®é¢˜å°±æœ‰ç‚¹å¤æ‚äº†ã€‚å®ç°MVPçš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å’Œè‡ªå·±å–œæ¬¢çš„æ–¹å¼å»ä¿®æ­£MVPçš„å®ç°æ–¹å¼ï¼Œå®ƒå¯ä»¥éšç€Presenterçš„å¤æ‚ç¨‹åº¦å˜åŒ–ã€‚</p>
<p>åœ¨Viewä¸­éœ€ä¸éœ€è¦æ§åˆ¶è¿›åº¦æ¡ï¼Ÿæˆ–è€…æ˜¯åœ¨Presenterå¤„ç†ï¼Ÿè¿˜æœ‰ï¼Œè°æ¥å†³å®šAction Barè¯¥æ˜¾ç¤ºä»€ä¹ˆæ“ä½œï¼Ÿè¿™æ˜¯ä¸€ä¸ªè‰°éš¾çš„å†³å®šã€‚è¿™é‡Œæˆ‘ä¼šå±•ç¤ºæˆ‘è‡ªå·±çš„åšæ³•ï¼Œä½†æ˜¯æˆ‘å¸Œæœ›æœ¬æ–‡æˆä¸ºä¸€ä¸ªè®¨è®ºå¦‚ä½•åº”ç”¨MVPçš„åœ°æ–¹ï¼Œå› ä¸ºç›®å‰ä¸ºæ­¢è¿˜æ²¡æœ‰å®ç°MVPçš„æ ‡å‡†æ–¹å¼ã€‚</p>
<h3 id="Presenter"><a href="#Presenter" class="headerlink" title="Presenter"></a>Presenter</h3><p>Presenterä¸»è¦ä½œä¸ºæ²Ÿé€šViewå’ŒModelçš„æ¡¥æ¢ï¼Œå®ƒä»Modelå±‚æ£€ç´¢æ•°æ®åï¼Œè¿”å›ç»™Viewå±‚ï¼Œä½†æ˜¯ä¸æƒ³å…¸å‹çš„MVCç»“æ„ï¼Œå› ä¸ºå®ƒä¹Ÿå¯ä»¥å†³å®šä¸Viewå±‚çš„äº¤äº’æ“ä½œã€‚</p>
<h3 id="View"><a href="#View" class="headerlink" title="View"></a>View</h3><p>Viewé€šå¸¸æ¥è¯´æ˜¯ç”±Activityå®ç°çš„ï¼ˆä¹Ÿè®¸æ˜¯Fragmentï¼ŒVIewï¼Œå–å†³äºappçš„æ•´ä½“ç»“æ„ï¼‰ï¼Œå®ƒä¼šåŒ…å«ä¸€ä¸ªPresenterçš„å¼•ç”¨ï¼Œæœ€ç†æƒ³çš„æ˜¯Presenterç”±ä¸€ä¸ªä¾èµ–æ³¨å…¥ç®¡ç†å™¨æä¾›ï¼Œæ¯”å¦‚<a href="http://square.github.io/dagger/" target="_blank" rel="noopener">Dagger</a>ï¼Œä¸è¿‡å¦‚æœä¸ç”¨æ³¨å…¥å™¨çš„è¯ï¼Œå°±éœ€è¦ç‹¬ç«‹åˆ›å»ºPresenterå¯¹è±¡äº†ã€‚Viewè¦åšçš„å°±åªæ˜¯åœ¨æ¯æ¬¡æœ‰æ¥å£è°ƒç”¨çš„æ—¶å€™ï¼ˆæ¯”å¦‚æŒ‰é’®ç‚¹å‡»åï¼‰è°ƒç”¨Presenterçš„æ–¹æ³•ã€‚</p>
<h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><p>å¯¹äºä¸€ä¸ªç»“æ„åŒ–çš„APPæ¥è¯´ï¼ŒModelä¸»è¦æ˜¯é€šå‘ä¸»é¢†åŸŸå±‚æˆ–è€…é€»è¾‘å±‚çš„é€šé“ï¼Œå¦‚æœä½¿ç”¨äº†<a href="http://blog.8thlight.com/uncle-bob/2012/08/13/the-clean-architecture.html" target="_blank" rel="noopener">Uncle Bob clean architecture</a>çš„è¯ï¼ŒModelå°±å¯èƒ½æ˜¯ä¸€ä¸ªå®ç°äº†ç”¨ä¾‹åœºæ™¯çš„äº¤äº’å·¥å…·ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘å°†è¦åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­è®¨è®ºçš„ä¸€ä¸ªä¸»é¢˜ã€‚ç°åœ¨ï¼Œåªè¦æŠŠå®ƒçœ‹åšæ˜¯ç»™Viewæä¾›æ•°æ®çš„å®¹å™¨å°±å¯¹äº†ã€‚</p>
<h3 id="ä¸€ä¸ªä¾‹å­"><a href="#ä¸€ä¸ªä¾‹å­" class="headerlink" title="ä¸€ä¸ªä¾‹å­"></a>ä¸€ä¸ªä¾‹å­</h3><p>é‰´äºå·²ç»è§£é‡Šçš„å¤ªé•¿äº†ï¼Œæœ¬äººå†™äº†ä¸€ä¸ªä¾‹å­<a href="https://github.com/antoniolg/androidmvp" target="_blank" rel="noopener">an MVP example on Github</a>ï¼Œç”±ä¸€ä¸ªç™»å½•ç•Œé¢ç»„æˆï¼Œå¯ä»¥éªŒè¯æ•°æ®ç„¶åè¿›å…¥ä¸€ä¸ªå¸¦æœ‰åˆ—è¡¨çš„ä¸»ç•Œé¢ï¼Œæ•°æ®æ¥è‡ªModelï¼Œå› ä¸ºæ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æœ¬æ–‡å°±ä¸è®²ä»£ç äº†ï¼Œä½†æ˜¯å¦‚æœè¯»è€…è§‰å¾—è¿˜æ˜¯å¾ˆéš¾ç†è§£çš„è¯ï¼Œæˆ‘è¿˜å¯ä»¥å†å†™ä¸€ç¯‡æ–‡ç« è¯¦ç»†ä»‹ç»ã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åœ¨Androidä¸Šè¦åˆ†ç¦»æ¥å£å’Œé€»è¾‘ä¸å®¹æ˜“å®ç°ï¼Œä½†æ˜¯Model-View-Presenteræ¨¡å¼å¯ä»¥æ›´ç®€å•çš„é˜²æ­¢åœ¨Activityä¸­æºæ‚å¤ªå¤šä»£ç åœ¨å¤§çš„é¡¹ç›®ä¸­ï¼Œç»„ç»‡å¥½ä»£ç ç»“æ„æ˜¯æœ€åŸºæœ¬çš„è¦æ±‚ï¼Œä¸ç„¶ï¼Œä»£ç çš„ç¨³å®šå’Œæ‰©å±•å°±å¾ˆå›°éš¾äº†ã€‚</p>
<p>&nbsp;</p>
<p>åŸæ–‡é“¾æ¥ï¼š&nbsp;<a href="http://antonioleiva.com/mvp-android/" target="_blank" rel="noopener">antonioleiva</a>&nbsp;&nbsp;&nbsp;ç¿»è¯‘ï¼š&nbsp;<a href="http://blog.jobbole.com/" target="_blank" rel="noopener">ä¼¯ä¹åœ¨çº¿&nbsp;</a>-&nbsp;<a href="http://blog.jobbole.com/author/chris/" target="_blank" rel="noopener">chris</a><br>è¯‘æ–‡é“¾æ¥ï¼š&nbsp;<a href="http://blog.jobbole.com/71209/" target="_blank" rel="noopener">http://blog.jobbole.com/71209/</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> best practices </tag>
            
            <tag> mvp </tag>
            
            <tag> mvc </tag>
            
            <tag> framework </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]è§£å†³ClickableSpanä¸­ç‚¹å‡»åListViewä¸­itemçš„é•¿æŒ‰å†²çªçš„é—®é¢˜]]></title>
      <url>/2014/07/03/Android-%E8%A7%A3%E5%86%B3ClickableSpan%E4%B8%AD%E7%82%B9%E5%87%BB%E5%90%8EListView%E4%B8%ADitem%E7%9A%84%E9%95%BF%E6%8C%89%E5%86%B2%E7%AA%81%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>é¡¹ç›®ä¸­ç¢°åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œæƒ…æ™¯æ˜¯è¿™æ ·çš„ï¼š</p>
<p>æœ‰ä¸€ä¸ªListViewï¼Œæ¯ä¸ªitemä¸­æœ‰ä¸€ä¸ªTextViewï¼Œè¿™ä¸ªTextViewå®ç°äº†LongClickäº‹ä»¶ï¼Œè¿™ä¸ªTextViewä¸­åˆæ·»åŠ äº†ClickableSpanï¼Œå®ç°äº†æ–¹æ³•onClickã€‚</p>
<p>æˆ‘çš„éœ€æ±‚æ˜¯ç‚¹å‡»ClickableSpanï¼Œåˆ™å“åº”ClickableSpanäº‹ä»¶ï¼›é•¿æŒ‰ClickableSpanæ•ˆæœè·Ÿé•¿æŒ‰TextViewåº”è¯¥ä¸€æ ·ï¼Œéƒ½å“åº”TextViewçš„LongClickäº‹ä»¶ã€‚</p>
<p>ç„¶è€Œç»“æœæ˜¯ç‚¹å‡»ClickableSpanå“åº”æ­£å¸¸ï¼›ä½†æ˜¯é•¿æŒ‰ClickableSpanæ—¶é—®é¢˜å‡ºç°äº†ï¼šTextViewçš„é•¿æŒ‰äº‹ä»¶å“åº”äº†ï¼ŒClickableSpanç‚¹å‡»äº‹ä»¶ä¹Ÿå“åº”äº†ï¼</p>
<p>ç ”ç©¶äº†ä¸€ä¸‹ä»£ç ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p>ç»§æ‰¿LinkMovementMethodï¼Œç„¶åé‡å†™é‡Œé¢çš„onTouchEventæ–¹æ³•ï¼Œåœ¨é‡Œé¢åˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ˜¯é•¿æŒ‰çš„çŠ¶æ€ï¼Œåˆ™ä¸æ‰§è¡ŒClickableSpançš„onClickäº‹ä»¶ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.kanchufang.privatedoctor.util.spannableparser;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.text.Layout;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.text.Selection;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.text.Spannable;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.text.method.LinkMovementMethod;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.text.style.ClickableSpan;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.MotionEvent;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.TextView;<br><br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  Author: wangjie<br> <em> Email: tiantian.china.2@gmail.com
 </em> Date: 7/3/14.<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> LinkMovementClickMethod <span style="color: #0000ff;">extends</span><span style="color: #000000;"> LinkMovementMethod{<br><br>    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> lastClickTime;<br><br>    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">long</span> CLICK_DELAY = 500l<span style="color: #000000;">;<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> onTouchEvent(TextView widget, Spannable buffer, MotionEvent event) {<br>        </span><span style="color: #0000ff;">int</span> action =<span style="color: #000000;"> event.getAction();<br><br>        </span><span style="color: #0000ff;">if</span> (action == MotionEvent.ACTION_UP ||<span style="color: #000000;"><br>                action </span>==<span style="color: #000000;"> MotionEvent.ACTION_DOWN) {<br>            </span><span style="color: #0000ff;">int</span> x = (<span style="color: #0000ff;">int</span><span style="color: #000000;">) event.getX();<br>            </span><span style="color: #0000ff;">int</span> y = (<span style="color: #0000ff;">int</span><span style="color: #000000;">) event.getY();<br><br>            x </span>-=<span style="color: #000000;"> widget.getTotalPaddingLeft();<br>            y </span>-=<span style="color: #000000;"> widget.getTotalPaddingTop();<br><br>            x </span>+=<span style="color: #000000;"> widget.getScrollX();<br>            y </span>+=<span style="color: #000000;"> widget.getScrollY();<br><br>            Layout layout </span>=<span style="color: #000000;"> widget.getLayout();<br>            </span><span style="color: #0000ff;">int</span> line =<span style="color: #000000;"> layout.getLineForVertical(y);<br>            </span><span style="color: #0000ff;">int</span> off =<span style="color: #000000;"> layout.getOffsetForHorizontal(line, x);<br><br>            ClickableSpan[] link </span>= buffer.getSpans(off, off, ClickableSpan.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br><br>            </span><span style="color: #0000ff;">if</span> (link.length != 0<span style="color: #000000;">) {<br>                </span><span style="color: #0000ff;">if</span> (action ==<span style="color: #000000;"> MotionEvent.ACTION_UP) {<br>                    </span><span style="color: #0000ff;">if</span>(System.currentTimeMillis() - lastClickTime &lt;<span style="color: #000000;"> CLICK_DELAY){<br>                        link[</span>0<span style="color: #000000;">].onClick(widget);<br>                    }<br>                } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (action ==<span style="color: #000000;"> MotionEvent.ACTION_DOWN) {<br>                    Selection.setSelection(buffer,<br>                            buffer.getSpanStart(link[</span>0<span style="color: #000000;">]),<br>                            buffer.getSpanEnd(link[</span>0<span style="color: #000000;">]));<br>                    lastClickTime </span>=<span style="color: #000000;"> System.currentTimeMillis();<br>                }<br><br>                </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br>            } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {<br>                Selection.removeSelection(buffer);<br>            }<br>        }<br>        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">super</span><span style="color: #000000;">.onTouchEvent(widget, buffer, event);<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> LinkMovementClickMethod getInstance(){<br>        </span><span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> sInstance){<br>            sInstance </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> LinkMovementClickMethod();<br>        }<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> sInstance;<br>    }<br><br>    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> LinkMovementClickMethod sInstance;<br><br>}</span></pre><br></div>

<p>ä»£ç å¾ˆç®€å•ï¼ŒæŒ‰ä½è¶…è¿‡500msï¼Œåˆ™è®¤å®šä¸ºæ˜¯é•¿æŒ‰ï¼Œåˆ™ä¸æ‰§è¡ŒClickableSpançš„onClick</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ListView </tag>
            
            <tag> ClickableSpan </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]ç«–ç›´æ»‘åŠ¨é€‰æ‹©å™¨WheelViewçš„å®ç°]]></title>
      <url>/2014/07/01/Android-%E7%AB%96%E7%9B%B4%E6%BB%91%E5%8A%A8%E9%80%89%E6%8B%A9%E5%99%A8WheelView%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
      <content type="html"><![CDATA[<p>å…¬å¸é¡¹ç›®ä¸­æœ‰è¿™ä¹ˆä¸€ä¸ªéœ€æ±‚ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±å®ç°ä¸‹ã€‚æ•ˆæœç±»ä¼¼android4.0ä»¥ä¸ŠåŸç”Ÿçš„DatePickerè¿™ç§ã€‚</p>
<p>è¿™ä¸ªWheelViewæ§ä»¶æˆ‘å·²ç»æ”¾åœ¨githubä¸Šäº†ï¼Œå¤§å®¶æœ‰å…´è¶£å¯ä»¥çœ‹çœ‹ï¼Œåœ°å€ï¼š<a href="https://github.com/wangjiegulu/WheelView" target="_blank" rel="noopener">https://github.com/wangjiegulu/WheelView</a>ï¼Œæ¬¢è¿Staræˆ–è€…Forkå“¦ï¼ï¼ˆå»ºåº“çš„æ—¶å€™å¿˜äº†é€‰ignoreäº†ï¼ï¼ï¼Œæ‰€ä»¥æœ‰äº›genä»€ä¹ˆçš„ç›´æ¥æ— è§†æ‰ï¼Œæˆ‘ä¹Ÿæ‡’å¾—æ”¹äº†ï¼ï¼ï¼‰</p>
<p>&nbsp;</p>
<p>å…ˆè´´ä¸Šæ•ˆæœå›¾ï¼š</p>
<p><img src="http://images.cnitblog.com/i/378300/201407/012249013099471.png" alt="">&nbsp;<img src="http://images.cnitblog.com/i/378300/201407/012249532936951.png" alt="">&nbsp;<img src="http://images.cnitblog.com/i/378300/201407/012251028875647.png" alt=""></p>
<p>&nbsp;</p>
<p>è®²ä¸‹æ€è·¯å§ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ»šåŠ¨é€‰æ‹©å™¨ï¼Œæ‰€ä»¥é¦–å…ˆæƒ³åˆ°çš„æ˜¯å¯ä»¥åŸºäºListViewæˆ–è€…ScrollViewè‡ªå®šä¹‰ã€‚</p>
<p>åˆšå¼€å§‹æˆ‘ç”¨çš„æ˜¯ç»§æ‰¿ListViewæ¥å®ç°ï¼ŒæŠŠæ»‘åŠ¨é€‰æ‹©çš„æ¯ä¸ªitemä½œä¸ºlistviewä¸­çš„ä¸€ä¸ªitemï¼Œç„¶åæ ¹æ®FirstVisiblePositionã€LastVisiblePositionæ¥åˆ¤æ–­æŸä¸ªitemæ˜¯å¦åœ¨é€‰ä¸­çš„åŒºåŸŸï¼Œä½†æ˜¯åæ¥å‘ç°å¶å°”æœ‰æ—¶å€™è°ƒç”¨getFirstVisiblePositionå’ŒgetLastVisiblePositionçš„ç»“æœè·Ÿæˆ‘çœ‹åˆ°çš„ç•Œé¢æ˜¾ç¤ºçš„itemå¹¶ä¸ä¸€è‡´ï¼ˆæˆ‘æ˜¯åœ¨Adapterä¸­è°ƒç”¨çš„è¿™ä¸¤ä¸ªæ–¹æ³•ï¼‰ï¼Œåæ¥åˆ†æå¯èƒ½æ˜¯å› ä¸ºæˆ‘è°ƒç”¨äº†scrollToåæ²¡æœ‰åˆ·æ–°adapterçš„åŸå› å§ã€‚</p>
<p>å†åæ¥ï¼Œå°±æ‰“ç®—ä½¿ç”¨ScrollViewæ¥å®ç°äº†ï¼Œå…¶ä¸­çš„æ¯ä¸ªiteméƒ½æ˜¯ä¸€ä¸ªViewï¼ˆæˆ‘è¿™é‡Œä½¿ç”¨äº†TextViewï¼‰ã€‚å› ä¸ºè¿™ä¸ªé€‰ä¸­æ¡†æ˜¯åœ¨ä¸­é—´çš„ä½ç½®ï¼Œæ‰€ä»¥åˆšå¯åŠ¨æ—¶ç¬¬ä¸€ä¸ªitemåº”è¯¥éœ€è¦åœ¨ä¸­é—´é€‰ä¸­æ¡†æ˜¾ç¤ºï¼Œæ‰€ä»¥å‰é¢åº”è¯¥ä½¿ç”¨ç©ºç™½è¡¥å…¨ã€‚æœ€åä¸€ä¸ªä¹Ÿæ˜¯å¦‚æ­¤ï¼Œåé¢ä¹Ÿéœ€è¦ç©ºç™½è¡¥å…¨ã€‚</p>
<p>åœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­éœ€è¦å®ç°è¿™ç§åœºæ™¯ï¼šæ»‘åŠ¨ç»“æŸåï¼Œå¿…é¡»ä¸”åªæœ‰ä¸€ä¸ªitemå®Œæ•´æ˜¾ç¤ºåœ¨é€‰æ‹©æ¡†ä¸­ã€‚æ‰€ä»¥æˆ‘ä»¬å¿…é¡»è¦ç›‘å¬æ»šåŠ¨åœæ­¢çš„äº‹ä»¶ï¼Œç„¶ååœ¨æ»šåŠ¨åœæ­¢ååˆ¤æ–­æ˜¯ä¸æ˜¯æ»¡è¶³å‰é¢çš„åœºæ™¯ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™éœ€è¦ä»£ç ä¸­å®ç°æ»šåŠ¨åˆ°æ­£ç¡®ä½ç½®ã€‚ä½†æ˜¯ï¼Œè›‹ç–¼çš„æ˜¯ï¼Œsdkä¸­ç«Ÿç„¶æ²¡æœ‰æä¾›åŸç”Ÿçš„ç›‘å¬æ»šåŠ¨åœæ­¢çš„apiï¼Œç„¶ååœ¨ç½‘ä¸Šæ‰¾äº†å¾ˆä¹…ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯åªèƒ½å¦è¾Ÿè¹Šå¾„ï¼Œä½¿ç”¨äº†<a href="http://stackoverflow.com/questions/8181828/android-detect-when-scrollview-stops-scrolling/10198865#10198865" target="_blank" rel="noopener">stackoverflow</a>ä¸€ä¸ªç½‘å‹çš„åšæ³•é€šè¿‡ä¸»åŠ¨æ£€æµ‹æ˜¯å¦åœæ­¢æ»šåŠ¨çš„æ–¹æ³•å»å®ç°ï¼ˆæ€»è§‰å¾—æ–¹æ³•æœ‰ç‚¹å‘ï¼Œé¢ å¥½å§ ä½†æ˜¯æš‚æ—¶å…ˆç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼‰ã€‚</p>
<p>æ€è·¯å°±è®²åˆ°è¿™é‡Œäº†ã€‚</p>
<p>&nbsp;</p>
<p>ä½¿ç”¨æ–¹å¼ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  Author: wangjie<br> <em> Email: tiantian.china.2@gmail.com
 </em> Date: 7/1/14.<br> </span><span style="color: #008000;">*/</span><span style="color: #000000;"><br>@AILayout(R.layout.main)<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> AIActivity {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = MainActivity.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br><br>    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String[] PLANETS = <span style="color: #0000ff;">new</span> String[]{â€œMercuryâ€, â€œVenusâ€, â€œEarthâ€, â€œMarsâ€, â€œJupiterâ€, â€œUranusâ€, â€œNeptuneâ€, â€œPlutoâ€<span style="color: #000000;">};<br><br>    @AIView(R.id.main_wv)<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> WheelView wva;<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br><br>        wva.setOffset(</span>1<span style="color: #000000;">);<br>        wva.setItems(Arrays.asList(PLANETS));<br>        wva.setOnWheelViewListener(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> WheelView.OnWheelViewListener() {<br>            @Override<br>            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onSelected(<span style="color: #0000ff;">int</span><span style="color: #000000;"> selectedIndex, String item) {<br>                Logger.d(TAG, </span>â€œselectedIndex: â€œ + selectedIndex + â€œ, item: â€œ +<span style="color: #000000;"> item);<br>            }<br>        });<br><br>    }<br><br>    @AIClick({R.id.main_show_dialog_btn})<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClickCallbackSample(View view) {<br>        </span><span style="color: #0000ff;">switch</span><span style="color: #000000;"> (view.getId()) {<br>            </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.main_show_dialog_btn:<br>                View outerView </span>= LayoutInflater.from(context).inflate(R.layout.wheel_view, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br>                WheelView wv </span>=<span style="color: #000000;"> (WheelView) outerView.findViewById(R.id.wheel_view_wv);<br>                wv.setOffset(</span>2<span style="color: #000000;">);<br>                wv.setItems(Arrays.asList(PLANETS));<br>                wv.setSeletion(</span>3<span style="color: #000000;">);<br>                wv.setOnWheelViewListener(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> WheelView.OnWheelViewListener() {<br>                    @Override<br>                    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onSelected(<span style="color: #0000ff;">int</span><span style="color: #000000;"> selectedIndex, String item) {<br>                        Logger.d(TAG, </span>â€œ[Dialog]selectedIndex: â€œ + selectedIndex + â€œ, item: â€œ +<span style="color: #000000;"> item);<br>                    }<br>                });<br><br>                </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> AlertDialog.Builder(context)<br>                        .setTitle(</span>â€œWheelView in Dialogâ€<span style="color: #000000;">)<br>                        .setView(outerView)<br>                        .setPositiveButton(</span>â€œOKâ€, <span style="color: #0000ff;">null</span><span style="color: #000000;">)<br>                        .show();<br><br>                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br>        }<br>    }<br><br>}</span></pre><br></div>

<p>&nbsp;</p>
<p>æ³¨æ„ï¼šè¿™ä¸ªDemoåªæ˜¯ä¸€ä¸ªä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼Œæ¯”è¾ƒé€‚åˆé€‰é¡¹è¾ƒå°‘çš„æ—¶å€™ä½¿ç”¨ï¼Œæ¯”å¦‚é€‰æ‹©æ€§åˆ«ã€æ˜ŸæœŸç­‰ã€‚å› ä¸ºé‡Œé¢çš„ä¹°ä¸ªiteméƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„Viewï¼Œå¹¶æ²¡æœ‰å»å®ç°Viewçš„ç¼“å­˜å’Œé‡ç”¨ï¼Œæ‰€ä»¥å¤§å®¶è¿™ç‚¹éœ€è¦æ³¨æ„ä¸‹ã€‚å¦‚æœæœ‰æ—¶é—´æˆ‘ä¼šå®Œå–„ä¼˜åŒ–è¿™ä¸ªä»£ç ï¼Œå®ç°Viewçš„å¤ç”¨ã€‚å…³äºViewçš„å¤ç”¨ï¼Œå¤§å®¶å¯ä»¥forkåè‡ªå·±å°è¯•æ”¹å†™ï¼Œæˆ‘è®²ä¸‹ä¸»è¦çš„æ€è·¯ï¼ˆæˆ‘çš„æ€è·¯ï¼Œå½“ç„¶ä¸èƒ½ä»£è¡¨æ˜¯æœ€ä¼˜çš„æ–¹æ¡ˆï¼‰æ˜¯ï¼šå‡è®¾ï¼Œæ¯é¡µæ˜¾ç¤º5ä¸ªitemä»¥ä¾›é€‰æ‹©ï¼Œé‚£ä¹ˆåˆšå¼€å§‹åŠ è½½æ—¶ï¼Œå…ˆç”Ÿæˆ6ä¸ªitemï¼Œå…¶ä¸­6ä¸ªæ˜¯æ­£å¸¸çš„6ä¸ªé€‰é¡¹æ‰€newå‡ºæ¥çš„itemï¼Œæ³¨æ„ï¼å› ä¸ºæ¯é¡µæ˜¾ç¤º5ä¸ªitemï¼Œæ‰€ä»¥ç¬¬6ä¸ªitemä¸å¯è§ï¼Œä½†æ˜¯å´å·²ç»newå‡ºæ¥äº†ï¼Œå…¶å®å¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚ç„¶åå¾€ä¸‹æ»šåŠ¨æ—¶ï¼Œç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œç¬¬6ä¸ªå®Œå…¨æ˜¾ç¤ºæ—¶ï¼Œè¿™ä¸ªæ—¶å€™ç¬¬ä¸€ä¸ªitemå·²ç»ä¸å¯è§äº†ï¼Œæ‰€ä»¥å¯ä»¥é‡ç”¨è¯¥itemçš„viewã€‚æ‰€ä»¥å¦‚æœå¾€ä¸‹æ»šè¦æ˜¾ç¤ºç¬¬7ä¸ªitemæ—¶ï¼Œé‡ç”¨ç¬¬ä¸€ä¸ªitemçš„viewï¼Œä½œä¸ºç¬¬7ä¸ªitemçš„viewæ˜¾ç¤ºæ•°æ®ã€‚å†å¾€ä¸‹ä¹Ÿæ˜¯ä¸€æ ·ã€‚æ€»ä¹‹ï¼Œé‡ç”¨å½“å‰ä¸å¯è§çš„itemçš„viewç»™å³å°†æ˜¾ç¤ºçš„itemã€‚</p>
<p>&nbsp;</p>
<p>æ³¨æ„ï¼šé¡¹ç›®ä½¿ç”¨åˆ°äº†ä¸€éƒ¨åˆ†æ³¨è§£ã€æ—¥å¿—æ–¹é¢çš„ä¸œè¥¿ï¼Œè·Ÿå®ç°WheelViewæ²¡å…³ç³»ï¼Œä½†æ˜¯å¯ä»¥ç®€åŒ–ä»£ç ï¼Œæé«˜ç¼–ç æ•ˆç‡</p>
<p>AndroidInjectï¼š<a href="https://github.com/wangjiegulu/androidInject" target="_blank" rel="noopener">https://github.com/wangjiegulu/androidInject</a></p>
<p>AndroidBucketï¼š<a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> github </tag>
            
            <tag> library </tag>
            
            <tag> WheelView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidæ— çº¿è°ƒè¯•]]></title>
      <url>/2014/06/07/Android%E6%97%A0%E7%BA%BF%E8%B0%83%E8%AF%95/</url>
      <content type="html"><![CDATA[<p>æ–¹æ³•ä¸€ï¼š</p>
<p>1. ä½¿ç”¨USBæ•°æ®çº¿è¿æ¥è®¾å¤‡ã€‚</p>
<p>2. å‘½ä»¤è¾“å…¥adb tcpip 5555 ( 5555ä¸ºç«¯å£å·ï¼Œå¯ä»¥è‡ªç”±æŒ‡å®šï¼‰ã€‚</p>
<p>3. æ–­å¼€ USBæ•°æ®ï¼Œæ­¤æ—¶å¯ä»¥è¿æ¥ä½ éœ€è¦è¿æ¥çš„|USBè®¾å¤‡ã€‚</p>
<p>4. å†å‘½ä»¤è¾“å…¥ adb connect &lt;è®¾å¤‡çš„IPåœ°å€&gt;:5555</p>
<p>åé¢å°±å¯ä»¥ä½¿ç”¨ADB ï¼ŒDDMS æ¥è°ƒè¯•Androidåº”ç”¨æˆ–æ˜¾ç¤ºLogcat æ¶ˆæ¯ã€‚</p>
<p>5. å¦‚æœéœ€è¦æ¢å¤åˆ°USBæ•°æ®çº¿ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œè¾“å…¥adb usb</p>
<p>æ³¨ï¼š Androidè®¾å¤‡çš„IPåœ°å€å¯ä»¥åœ¨Settings-&gt;About Phone-&gt;Status æŸ¥åˆ°</p>
<p>å‚è€ƒï¼š<a href="http://blog.csdn.net/daditao/article/details/19077281" target="_blank" rel="noopener">http://blog.csdn.net/daditao/article/details/19077281</a></p>
<p>&nbsp;</p>
<p>æ–¹æ³•äºŒï¼š</p>
<p><span>é¦–å…ˆè®©æ‰‹æœºä¸ç”µè„‘å¤„äºåŒä¸€å±€åŸŸç½‘ä¸‹ï¼Œç„¶åä¸‹è½½ä¸€æ¬¾åä¸ºadbWirelessçš„åº”ç”¨ï¼ˆåˆ°Google Playå•†åº—å¯ä»¥æœç´¢åˆ°ï¼‰ï¼Œä¸‹è½½å®‰è£…åè¿è¡Œè½¯ä»¶ï¼Œä¼šæ˜¾ç¤ºæ‰‹æœºåœ¨å½“å‰å±€åŸŸç½‘çš„IPåœ°å€å’Œç«¯å£ï¼ˆå‰ææ˜¯æ‰‹æœºéœ€è¦ROOTï¼‰ï¼Œç„¶åå¯ä»¥çœ‹åˆ°æ‰‹æœºå‡ºç°äº†IPåœ°å€å’Œç«¯å£å·ã€‚</span></p>
<p><span><span>éšåæ‰“å¼€å‘½ä»¤è¡Œï¼Œè¿›å…¥å®‰è£…SDKçš„ç›®å½•ä¸­platform-toolsæ–‡ä»¶å¤¹å¹¶è¾“å…¥ï¼šadb connect æ‰‹æœºIPåœ°å€ï¼ˆæˆ‘çš„æ˜¯192.168.1.110ï¼‰</span></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> debug </tag>
            
            <tag> debuggable </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[IOS]ã€ŠA Swift Tourã€‹ç¿»è¯‘ï¼ˆä¸€ï¼‰]]></title>
      <url>/2014/06/04/IOS-%E3%80%8AA-Swift-Tour%E3%80%8B%E7%BF%BB%E8%AF%91%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>ç¢ç¢å¿µã€‚ã€‚ã€‚</p>
<p>Swiftæ˜¯è‹¹æœåœ¨WWDCåˆšå‘å¸ƒçš„æ–°è¯­è¨€ï¼Œæœ¬äººä¹Ÿæ²¡å­¦è¿‡ï¼Œç°åœ¨çœ‹è‹¹æœå®˜æ–¹æ–‡æ¡£ä¸€è¾¹ç¿»è¯‘ä¸€è¾¹å­¦ä¹ ï¼Œå†åŠ ä¸Šè‹±è¯­æ°´å¹³å’Œå¯¹ç¼–ç¨‹ç†è§£å¾ˆæœ‰é™ï¼Œæœ‰é”™è¯¯çš„åœ°æ–¹è¯·å¤§å®¶æŒ‡å‡ºï¼Œç¿»è¯‘åªä¾›å‚è€ƒï¼Œå»ºè®®é˜…è¯»<a href="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/Swift_Programming_Language/GuidedTour.html#//apple_ref/doc/uid/TP40014097-CH2-XID_1" target="_blank" rel="noopener">è‹¹æœSwiftå®˜æ–¹çš„æ–‡æ¡£</a></p>
<p>&nbsp;</p>
<p><span class="s1">Swift ä¹‹æ—…</span></p>
<p><span class="s1">æŒ‰ç…§ä¼ ç»Ÿï¼Œåœ¨å¼€å§‹å­¦ä¹ ä¸€é—¨æ–°çš„è¯­è¨€æ—¶å†™çš„ç¬¬ä¸€ä¸ªç¨‹åºåº”è¯¥æ˜¯åœ¨å±å¹•ä¸Šæ‰“å°&ldquo;Hello, World&rdquo;ï¼Œè¿™ä¸ªå¯ä»¥ç”¨ä¸€è¡Œæ¥å®Œæˆï¼š</span></p>
<p>&nbsp;</p>
<p><span class="s1">print(&ldquo;Hello, world&rdquo;)</span></p>
<p>&nbsp;</p>
<p><span class="s1">&nbsp;å¦‚æœä½ æœ‰å†™è¿‡Cæˆ–è€…Objective-Cçš„ç»éªŒï¼Œè¿™ä¸ªè¯­æ³•ä½ åº”è¯¥ä¼šæ„Ÿè§‰å¾ˆç†Ÿæ‚‰&mdash;&mdash;åœ¨Swiftä¸­ï¼Œè¿™è¡Œä»£ç å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¨‹åºã€‚ä½ ä¸éœ€è¦åƒè¾“å…¥è¾“å‡ºæµæˆ–è€…å­—ç¬¦ä¸²å¤„ç†ç­‰é‚£æ ·å»å¯¼å…¥å¦å¤–çš„å…·æœ‰åŠŸèƒ½æ€§çš„åº“ã€‚åœ¨å…¨å±€èŒƒå›´ç¼–å†™çš„ä»£ç å³æ˜¯ç¨‹åºçš„å…¥å£ç‚¹ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦ä¸€ä¸ªmainæ–¹æ³•ã€‚ä½ ä¹Ÿä¸éœ€è¦åœ¨æ¯ä¸ªè¯­å¥åé¢å†™ä¸Šåˆ†å·ã€‚</span></p>
<p><span class="s1">&nbsp; &nbsp; è¿™ä¸ªæ—…ç¨‹ä¼šå¸¦ç»™ä½ è¶³å¤Ÿçš„ä¿¡æ¯è®©ä½ ç”¨Swiftæ¥å®Œæˆå„ç§ç¼–ç¨‹ä»»åŠ¡ã€‚ä¸ç”¨æ‹…å¿ƒä½ æ˜¯å¦æ‡‚å¾—ä¸€äº›ç¼–ç¨‹&mdash;&mdash;è¿™æœ¬ä¹¦å¯¹å„ä¸ªæ–¹é¢éƒ½è¿›è¡Œæ¥è¯¦ç»†çš„ä»‹ç»ã€‚</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>åŸºæœ¬æ•°æ®</p>
<p><span class="s1">&nbsp; &nbsp; ä½¿ç”¨letæ¥è¡¨ç¤ºä¸€ä¸ªå¸¸é‡ï¼Œä½¿ç”¨varæ¥è¡¨ç¤ºä¸€ä¸ªå˜é‡ã€‚å¸¸é‡çš„å€¼ä¸éœ€è¦åœ¨ç¼–è¯‘æ—¶æœŸè¢«çŸ¥é“ï¼Œä½†æ˜¯ä½ å¿…é¡»ä¸”åªèƒ½ä¸€æ¬¡åˆ†é…ä¸€ä¸ªå€¼ç»™å®ƒã€‚è¿™è¡¨ç¤ºä½ ä¸€æ—¦ç»™è¿™ä¸ªå¸¸é‡åˆ†é…äº†ä¸€ä¸ªå€¼ï¼Œä½ å°±èƒ½åœ¨å¾ˆå¤šåœ°æ–¹ä½¿ç”¨å®ƒäº†ã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">var myVariable = 42;</span></p>
<p><span class="s1">myVariable = 50;</span></p>
<p><span class="s1">let myConstant = 42;</span></p>
<p>&nbsp;</p>
<p><span class="s1">ä¸€ä¸ªå¸¸é‡æˆ–è€…å˜é‡çš„ç±»å‹å¿…é¡»è¦è·Ÿä½ åˆ†é…ç»™å®ƒçš„å€¼çš„ç±»å‹ä¸€è‡´ã€‚ç„¶è€Œï¼Œä½ ä¸€èˆ¬ä¸éœ€è¦ç²¾ç¡®çš„å†™æ˜å®ƒçš„ç±»å‹ã€‚å½“ä½ åˆ›å»ºäº†ä¸€ä¸ªå¸¸é‡æˆ–è€…å˜é‡ï¼Œå¹¶èµ‹å€¼åï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ¨æ–­å‡ºå®ƒçš„ç±»å‹ã€‚æ¯”å¦‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¼–è¯‘å™¨ä¼šæ¨æ–­å‡ºmyVariableæ˜¯ä¸€ä¸ªintegerï¼Œå› ä¸ºå®ƒçš„åˆå§‹å€¼å°±æ˜¯ä¸€ä¸ªintegerã€‚</span></p>
<p><span class="s1">å¦‚æœåˆå§‹å€¼ä¸èƒ½æä¾›è¶³å¤Ÿçš„ä¿¡æ¯ï¼ˆæˆ–è€…å®ƒæ ¹æœ¬æ²¡æœ‰åˆå§‹å€¼ï¼‰ï¼Œå¯ä»¥åœ¨è¿™ä¸ªå˜é‡åé¢åŠ ä¸Šå†’å·ï¼Œç„¶åå†™ä¸ŠæŒ‡å®šç±»å‹ã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">let implicitInteger = 70</span></p>
<p><span class="s1">let implicitDouble = 70.0</span></p>
<p><span class="s1">let explicitDouble: Double = 70</span></p>
<p>&nbsp;</p>
<p><span class="s1">å€¼ä¸ä¼šéšå¼åœ°è¢«è½¬æ¢æˆå¦ä¸€ç§ç±»å‹ã€‚å¦‚æœä½ éœ€è¦è½¬æ¢æˆä¸€ä¸ªä¸åŒç±»å‹çš„å€¼ï¼Œæ˜¾ç¤ºåœ°ç”Ÿæˆä¸€ä¸ªæœŸæœ›ç±»å‹çš„å®ä¾‹ã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">let label = &ldquo;The width is &rdquo;</span></p>
<p><span class="s1">let width = 94</span></p>
<p><span class="s1">let widthLabel = label + String(width)</span></p>
<p>&nbsp;</p>
<p><span class="s1">è¿˜æœ‰ä¸€ä¸ªæ›´ç®€å•çš„æ–¹æ³•ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­åŒ…å«å˜é‡å€¼ï¼šå†™ä¸€å¯¹æ‹¬å·é‡Œé¢å†™ä¸€ä¸ªå˜é‡å€¼ï¼Œç„¶ååœ¨æ‹¬å·å‰é¢å†™ä¸€ä¸ªåæ–œæ ï¼Œä¸¾ä¸ªä¾‹å­ï¼š</span></p>
<p>&nbsp;</p>
<p><span class="s1">let apples = 3</span></p>
<p><span class="s1">let oranges = 5</span></p>
<p><span class="s1">let appleSummary = &ldquo;I have (apples) apples.&rdquo;</span></p>
<p><span class="s1">let fruitSummary = &ldquo;I have (apples + oranges) pieces of fruit.&rdquo;</span></p>
<p>&nbsp;</p>
<p><span class="s1">ä½¿ç”¨ä¸­æ‹¬å·ï¼ˆ[]ï¼‰æ¥åˆ›å»ºä¸€ä¸ªæ•°ç»„æˆ–è€…å­—å…¸ï¼Œä½¿ç”¨indexï¼ˆç´¢å¼•ï¼‰æˆ–è€…keyï¼ˆé”®ï¼‰è®¿é—®ä»–ä»¬çš„æŸä¸€é¡¹ã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">var shoppingList = [&ldquo;catfish&rdquo;, &ldquo;water&rdquo;, &ldquo;tulips&rdquo;, &ldquo;blue paint&rdquo;]</span></p>
<p><span class="s1">shoppingList[1] = &ldquo;bottle of water&rdquo;</span></p>
<p><span class="s1">var occupations = [</span></p>
<p><span class="s1">&ldquo;Malcolm&rdquo;: &ldquo;Captain&rdquo;,</span></p>
<p><span class="s1">&ldquo;Kaylee&rdquo;: &ldquo;Mechanic&rdquo;,</span></p>
<p><span class="s1">]</span></p>
<p><span class="s1">occupations[&ldquo;Jayne&rdquo;] = &ldquo;Public Relations&rdquo;</span></p>
<p>&nbsp;</p>
<p><span class="s1">ä½¿ç”¨åˆå§‹åŒ–å™¨çš„è¯­æ³•æ¥åˆ›å»ºä¸€ä¸ªç©ºçš„æ•°ç»„æˆ–è€…å­—å…¸ã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">let emptyArray = String<a href=""></a></span></p>
<p><span class="s1">let emptyDictionary = Dictionary&lt;String, Float&gt;()</span></p>
<p>&nbsp;</p>
<p><span class="s1">å¦‚æœç±»å‹ä¿¡æ¯æ˜¯å¯æ¨æ–­çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨[]åˆ›å»ºä¸€ä¸ªç©ºçš„æ•°ç»„ï¼Œä½¿ç”¨[:]æ¥åˆ›å»ºä¸€ä¸ªç©ºçš„å­—å…¸ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå½“ä½ è®¾ç½®ä¸€ä¸ªæ–°çš„å€¼æˆ–è€…å¾€æ–¹æ³•ä¸­ä¼ å…¥ä¸€ä¸ªå˜é‡ä½œä¸ºå‚æ•°</span></p>
<p>&nbsp;</p>
<p><span class="s1">shoppingList = []</span></p>
<p>&nbsp;</p>
<p><span class="s1">æ§åˆ¶è¯­å¥</span></p>
<p><span class="s1">ä½¿ç”¨ifå’Œswitchæ¥åˆ›å»ºä¸€ä¸ªæ¡ä»¶ï¼Œä½¿ç”¨for-inï¼Œforï¼Œwhileå’Œdo-whileæ¥åˆ›å»ºä¸€ä¸ªå¾ªç¯ã€‚</span></p>
<p><span class="s1">æ¡ä»¶å’Œå¾ªç¯å˜é‡ä¸Šçš„æ‹¬å·æ˜¯å¯é€‰çš„ã€‚ifåé¢å¤§æ‹¬å·å’Œå¾ªç¯ä½“çš„å¤§æ‹¬å·æ˜¯å¿…é¡»çš„ã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">let individualScores = [75, 43, 103, 87, 12]</span></p>
<p><span class="s1">var teamScore = 0</span></p>
<p><span class="s1">for score in individualScores{</span></p>
<p><span class="s1">if score &gt; 50{</span></p>
<p><span class="s1">teamScore += 3</span></p>
<p><span class="s1">}else{</span></p>
<p><span class="s1">teamScore += 1</span></p>
<p><span class="s1">}</span></p>
<p><span class="s1">}</span></p>
<p><span class="s1">teamScore</span></p>
<p>&nbsp;</p>
<p><span class="s1">åœ¨ä¸€ä¸ªifè¯­å¥ä¸­ï¼Œæ¡ä»¶å¿…é¡»æ˜¯ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„è¡¨è¾¾å¼&mdash;&mdash;è¿™è¡¨ç¤ºåƒif score { &hellip; }è¿™æ ·çš„ä»£ç æ˜¯é”™è¯¯çš„ï¼Œè¿™ä¸ªscoreå¹¶ä¸æ˜¯éšå¼åœ°å»è·Ÿ0æ¯”è¾ƒã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">ä½ å¯ä»¥åœ¨å€¼å¯èƒ½ä¸ºç©ºçš„æ—¶å€™åŒæ—¶ä½¿ç”¨ifå’Œletã€‚è¿™äº›å€¼å°±è¢«è¡¨ç¤ºä¸ºå¯é€‰åœ°ã€‚ä¸€ä¸ªå¯é€‰çš„å€¼å¯èƒ½åŒ…å«ä¸€ä¸ªå€¼æˆ–è€…åŒ…å«ä¸€ä¸ªnilï¼Œnilè¡¨ç¤ºè¿™ä¸ªå€¼æ˜¯ç©ºã€‚åœ¨è¿™ä¸ªå€¼çš„ç±»å‹åé¢å†™ä¸Šä¸€ä¸ªç–‘é—®ç¬¦å·ï¼ˆ?ï¼‰å¯ä»¥æŠŠè¿™ä¸ªå€¼æ ‡è®°ä¸ºå¯é€‰çš„ã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">var optionalString: String? = &ldquo;Hello&rdquo;</span></p>
<p><span class="s1">optionalString == nil</span></p>
<p>&nbsp;</p>
<p><span class="s1">var optionalName: String? = &ldquo;John Appleseed&rdquo;</span></p>
<p><span class="s1">var greeting = &ldquo;Hello!&rdquo;</span></p>
<p><span class="s1">if let name = optionalName{</span></p>
<p><span class="s1">greeting = &ldquo;Hello, (name)&rdquo;</span></p>
<p><span class="s1">}</span></p>
<p>&nbsp;</p>
<p><span class="s1">å¦‚æœå¯é€‰å€¼æ˜¯nilï¼Œé‚£ä¹ˆè¿™ä¸ªæ¡ä»¶å°±ä¸ºfalseï¼Œå¤§æ‹¬å·ä¸­ä»£ç å°±ä¼šè·³è¿‡ã€‚å¦åˆ™ï¼Œå¯é€‰å€¼æ‰§è¡Œåé¢ä»£ç å—ä¸­çš„ä»£ç å¹¶åˆ†é…ç»™letåé¢çš„å¸¸æ•°ã€‚</span></p>
<p><span class="s1">Switchesæ”¯æŒå„ç§æ•°æ®å’Œå„ç§å„æ ·çš„æ¯”è¾ƒæ“ä½œ&mdash;&mdash;å®ƒä»¬ä¸å±€é™äºintegerså’Œç›¸ç­‰å¼çš„æ¯”è¾ƒã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">let vegetable = &ldquo;red pepper&rdquo;</span></p>
<p><span class="s1">switch vegetable{</span></p>
<p><span class="s1">case &ldquo;celery&rdquo;:</span></p>
<p><span class="s1">let vegetableComment = &ldquo;Add some raisins and make ants on a log.&rdquo;</span></p>
<p><span class="s1">case &ldquo;cucumber&rdquo;, &ldquo;watercress&rdquo;:</span></p>
<p><span class="s1">let vegetableComment = &ldquo;That would make a good tea sandwich.&rdquo;</span></p>
<p><span class="s1">case let x where x.hasSuffix(&ldquo;pepper&rdquo;):</span></p>
<p><span class="s1">let vegetableComment = &ldquo;Is it a spicy (x)?&rdquo;</span></p>
<p><span class="s1">default:</span></p>
<p><span class="s1">let vegetableComment = &ldquo;Everything tastes good in soup.&rdquo;</span></p>
<p><span class="s1">}</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span class="s1">åœ¨åŒ¹é…çš„caseä¸­æ‰§è¡Œå®Œä»£ç åï¼Œç¨‹åºé€€å‡ºswitchè¯­å¥ã€‚æ‰§è¡Œä¸ä¼šåœ¨ä¸‹ä¸€ä¸ªcaseä¸­ç»§ç»­ï¼Œæ‰€ä»¥ä¸éœ€è¦æ˜¾ç¤ºçš„åœ¨æ¯ä¸ªcasesä¸­çš„æœ€åä¾æ¬¡å†™ä¸Šè·³å‡ºè¯¥switchçš„breakè¯­å¥ã€‚</span></p>
<p><span class="s1">ä½ å¯ä»¥ä½¿ç”¨for-inè¯­å¥æ¥è¿­ä»£é”®å€¼å¯¹å½¢å¼çš„å­—å…¸ä¸­çš„æ‰€æœ‰itemsã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">let interestingNumbers = [</span></p>
<p><span class="s1">&ldquo;Prime&rdquo;: [2, 3, 5, 7, 11, 13],</span></p>
<p><span class="s1">&ldquo;Fibonacci&rdquo;: [1, 1, 2, 3, 5, 8],</span></p>
<p><span class="s1">&ldquo;Square&rdquo;: [1, 4, 9, 16, 25],</span></p>
<p><span class="s1">]</span></p>
<p><span class="s1">var largest = 0</span></p>
<p><span class="s1">for(kind, numbers) in interestingNumbers{</span></p>
<p><span class="s1">for number in numbers{</span></p>
<p><span class="s1">if number &gt; largest{</span></p>
<p><span class="s1">largest = number</span></p>
<p><span class="s1">}</span></p>
<p><span class="s1">}</span></p>
<p><span class="s1">}</span></p>
<p><span class="s1">largest</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span class="s1">ä½¿ç”¨whileæ¥é‡å¤ä»£ç å—ä¸­çš„ä»£ç ï¼Œç›´åˆ°æ¡ä»¶æ”¹å˜ã€‚å¾ªç¯æ¡ä»¶ä¹Ÿå¯ä»¥æ”¾åœ¨æœ€åï¼Œå¯ä»¥ç¡®ä¿è¿™ä¸ªå¾ªç¯è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚</span></p>
<p>&nbsp;</p>
<p><span class="s1">var n = 2</span></p>
<p><span class="s1">while n &lt; 100{</span></p>
<p><span class="s1">n = n * 2</span></p>
<p><span class="s1">}</span></p>
<p><span class="s1">n</span></p>
<p>&nbsp;</p>
<p><span class="s1">var m = 2</span></p>
<p><span class="s1">do{</span></p>
<p><span class="s1">m = m * 2</span></p>
<p><span class="s1">} while m &lt; 100</span></p>
<p><span class="s1">m</span></p>
<p>&nbsp;</p>
<p><span class="s1">ä½ å¯ä»¥åœ¨å¾ªç¯ä¸­ä¿æŒä¸€ä¸ªç´¢å¼•index&mdash;&mdash;é€šè¿‡ä½¿ç”¨..æ¥é™å®šä¸€ä¸ªç´¢å¼•èŒƒå›´æˆ–è€…æŒ‡æ˜åˆå§‹å€¼ï¼Œæ¡ä»¶å’Œå¢é‡ã€‚ä¸‹é¢ä¸¤ä¸ªç»“æœä¸€æ ·çš„å¾ªç¯ï¼š</span></p>
<p>&nbsp;</p>
<p><span class="s1">var firstForLoop = 0</span></p>
<p><span class="s1">for i in 0..3{</span></p>
<p><span class="s1">firstForLoop += i</span></p>
<p><span class="s1">}</span></p>
<p><span class="s1">firstForLoop</span></p>
<p>&nbsp;</p>
<p><span class="s1">var secondForLoop = 0</span></p>
<p><span class="s1">for var i = 0; i &lt; 3; ++i{</span></p>
<p><span class="s1">secondForLoop += 1</span></p>
<p><span class="s1">}</span></p>
<p><span class="s1">secondForLoop</span></p>
<p>&nbsp;</p>
<p><span class="s1">ä½¿ç”¨..æ¥é™å®šèŒƒå›´ä¼šçœç•¥èŒƒå›´çš„ä¸Šé™å€¼ï¼Œä½¿ç”¨â€¦æ¥é™å®šèŒƒå›´ä¼šåŒ…å«æ‰€æœ‰é™å®šå€¼ã€‚ï¼ˆè¯‘è€…æ³¨ï¼š..æ˜¯å·¦é—­å³å¼€æ•´æ•°åŒºé—´ï¼Œ&hellip;æ˜¯å·¦é—­å³é—­æ•´æ•°åŒºé—´ï¼‰</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> ç¿»è¯‘ </tag>
            
            <tag> iOS </tag>
            
            <tag> swift </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android Property AnimationåŠ¨ç”»]]></title>
      <url>/2014/05/19/Android-Property-Animation%E5%8A%A8%E7%94%BB/</url>
      <content type="html"><![CDATA[<p>3.0ä»¥å‰ï¼Œandroidæ”¯æŒä¸¤ç§åŠ¨ç”»æ¨¡å¼ï¼Œtween animation,frame animationï¼Œåœ¨android3.0ä¸­åˆå¼•å…¥äº†ä¸€ä¸ªæ–°çš„åŠ¨ç”»ç³»ç»Ÿï¼šproperty animationï¼Œè¿™ä¸‰ç§åŠ¨ç”»æ¨¡å¼åœ¨SDKä¸­è¢«ç§°ä¸ºproperty animation,view animation,drawable animationã€‚ å¯é€šè¿‡<a href="http://nineoldandroids.com/" title="NineOldAndroids" target="_blank" rel="noopener">NineOldAndroids</a>é¡¹ç›®åœ¨3.0ä¹‹å‰çš„ç³»ç»Ÿä¸­ä½¿ç”¨Property Animation</p>
<h1 id="1-View-Animationï¼ˆTween-Animationï¼‰"><a href="#1-View-Animationï¼ˆTween-Animationï¼‰" class="headerlink" title="1. View Animationï¼ˆTween Animationï¼‰"></a>1. View Animationï¼ˆTween Animationï¼‰</h1><p>ã€€ã€€View Animationï¼ˆTween Animationï¼‰ï¼šè¡¥é—´åŠ¨ç”»ï¼Œç»™å‡ºä¸¤ä¸ªå…³é”®å¸§ï¼Œé€šè¿‡ä¸€äº›ç®—æ³•å°†ç»™å®šå±æ€§å€¼åœ¨ç»™å®šçš„æ—¶é—´å†…åœ¨ä¸¤ä¸ªå…³é”®å¸§é—´æ¸å˜ã€‚</p>
<p>ã€€ã€€View animationåªèƒ½åº”ç”¨äºViewå¯¹è±¡ï¼Œè€Œä¸”åªæ”¯æŒä¸€éƒ¨åˆ†å±æ€§ï¼Œå¦‚æ”¯æŒç¼©æ”¾æ—‹è½¬è€Œä¸æ”¯æŒèƒŒæ™¯é¢œè‰²çš„æ”¹å˜ã€‚</p>
<p>ã€€ã€€è€Œä¸”å¯¹äºView animationï¼Œå®ƒåªæ˜¯æ”¹å˜äº†Viewå¯¹è±¡ç»˜åˆ¶çš„ä½ç½®ï¼Œè€Œæ²¡æœ‰æ”¹å˜Viewå¯¹è±¡æœ¬èº«ï¼Œæ¯”å¦‚ï¼Œä½ æœ‰ä¸€ä¸ªButtonï¼Œåæ ‡ï¼ˆ100,100ï¼‰ï¼ŒWidth:200,Height:50ï¼Œè€Œä½ æœ‰ä¸€ä¸ªåŠ¨ç”»ä½¿å…¶å˜ä¸ºWidthï¼š100ï¼ŒHeightï¼š100ï¼Œä½ ä¼šå‘ç°åŠ¨ç”»è¿‡ç¨‹ä¸­è§¦å‘æŒ‰é’®ç‚¹å‡»çš„åŒºåŸŸä»æ˜¯(100,100)-(300,150)ã€‚</p>
<p>ã€€ã€€View Animationå°±æ˜¯ä¸€ç³»åˆ—Viewå½¢çŠ¶çš„å˜æ¢ï¼Œå¦‚å¤§å°çš„ç¼©æ”¾ï¼Œé€æ˜åº¦çš„æ”¹å˜ï¼Œä½ç½®çš„æ”¹å˜ï¼ŒåŠ¨ç”»çš„å®šä¹‰æ—¢å¯ä»¥ç”¨ä»£ç å®šä¹‰ä¹Ÿå¯ä»¥ç”¨XMLå®šä¹‰ï¼Œå½“ç„¶ï¼Œå»ºè®®ç”¨XMLå®šä¹‰ã€‚</p>
<p>ã€€ã€€å¯ä»¥ç»™ä¸€ä¸ªViewåŒæ—¶è®¾ç½®å¤šä¸ªåŠ¨ç”»ï¼Œæ¯”å¦‚ä»é€æ˜è‡³ä¸é€æ˜çš„æ·¡å…¥æ•ˆæœï¼Œä¸ä»å°åˆ°å¤§çš„æ”¾å¤§æ•ˆæœï¼Œè¿™äº›åŠ¨ç”»å¯ä»¥åŒæ—¶è¿›è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªå®Œæˆä¹‹åå¼€å§‹å¦ä¸€ä¸ªã€‚</p>
<p>ã€€ã€€ç”¨XMLå®šä¹‰çš„åŠ¨ç”»æ”¾åœ¨/res/anim/æ–‡ä»¶å¤¹å†…ï¼ŒXMLæ–‡ä»¶çš„æ ¹å…ƒç´ å¯ä»¥ä¸º&lt;alpha&gt;,&lt;scale&gt;,&lt;translate&gt;,&lt;rotate&gt;,interpolatorå…ƒç´ æˆ–&lt;set&gt;(è¡¨ç¤ºä»¥ä¸Šå‡ ä¸ªåŠ¨ç”»çš„é›†åˆï¼Œsetå¯ä»¥åµŒå¥—)ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰åŠ¨ç”»æ˜¯åŒæ—¶è¿›è¡Œçš„ï¼Œå¯ä»¥é€šè¿‡startOffsetå±æ€§è®¾ç½®å„ä¸ªåŠ¨ç”»çš„å¼€å§‹åç§»ï¼ˆå¼€å§‹æ—¶é—´ï¼‰æ¥è¾¾åˆ°åŠ¨ç”»é¡ºåºæ’­æ”¾çš„æ•ˆæœã€‚</p>
<p>ã€€ã€€å¯ä»¥é€šè¿‡è®¾ç½®interpolatorå±æ€§æ”¹å˜åŠ¨ç”»æ¸å˜çš„æ–¹å¼ï¼Œå¦‚AccelerateInterpolatorï¼Œå¼€å§‹æ—¶æ…¢ï¼Œç„¶åé€æ¸åŠ å¿«ã€‚é»˜è®¤ä¸ºAccelerateDecelerateInterpolatorã€‚</p>
<p>ã€€ã€€å®šä¹‰å¥½åŠ¨ç”»çš„XMLæ–‡ä»¶åï¼Œå¯ä»¥é€šè¿‡ç±»ä¼¼ä¸‹é¢çš„ä»£ç å¯¹æŒ‡å®šViewåº”ç”¨åŠ¨ç”»ã€‚</p>
<div class="cnblogs_code"><br><pre>ImageView spaceshipImage = (ImageView)findViewById(R.id.spaceshipImage);<br>Animation hyperspaceJumpAnimation=AnimationUtils.loadAnimation(<span>this</span>, R.anim.hyperspace_jump);<br>spaceshipImage.startAnimation(hyperspaceJumpAnimation);</pre><br></div>

<h1 id="2-Drawable-Animationï¼ˆFrame-Animationï¼‰"><a href="#2-Drawable-Animationï¼ˆFrame-Animationï¼‰" class="headerlink" title="2. Drawable Animationï¼ˆFrame Animationï¼‰"></a>2. Drawable Animationï¼ˆFrame Animationï¼‰</h1><p>ã€€ã€€Drawable Animationï¼ˆFrame Animationï¼‰ï¼šå¸§åŠ¨ç”»ï¼Œå°±åƒGIFå›¾ç‰‡ï¼Œé€šè¿‡ä¸€ç³»åˆ—Drawableä¾æ¬¡æ˜¾ç¤ºæ¥æ¨¡æ‹ŸåŠ¨ç”»çš„æ•ˆæœã€‚åœ¨XMLä¸­çš„å®šä¹‰æ–¹å¼å¦‚ä¸‹ï¼š</p>
<pre class="brush: xml; auto-links: true; collapse: false; first-line: 1; gutter: true; html-script: false; light: false; ruler: false; smart-tabs: true; tab-size: 4; toolbar: true;">&lt;animation-list xmlns:android="http://schemas.android.com/apk/res/android"
    android:oneshot="true"&gt;
    &lt;item android:drawable="@drawable/rocket_thrust1" android:duration="200" /&gt;
    &lt;item android:drawable="@drawable/rocket_thrust2" android:duration="200" /&gt;
    &lt;item android:drawable="@drawable/rocket_thrust3" android:duration="200" /&gt;
&lt;/animation-list&gt;</pre>

<p>ã€€ã€€å¿…é¡»ä»¥&lt;animation-list&gt;ä¸ºæ ¹å…ƒç´ ï¼Œä»¥&lt;item&gt;è¡¨ç¤ºè¦è½®æ¢æ˜¾ç¤ºçš„å›¾ç‰‡ï¼Œdurationå±æ€§è¡¨ç¤ºå„é¡¹æ˜¾ç¤ºçš„æ—¶é—´ã€‚XMLæ–‡ä»¶è¦æ”¾åœ¨/res/drawable/ç›®å½•ä¸‹ã€‚ç¤ºä¾‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span>protected</span> <span>void</span> onCreate(Bundle savedInstanceState) {<br>        <span>//</span><span> TODO Auto-generated method stub</span><span><br></span>        <span>super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.main);<br>        imageView = (ImageView) findViewById(R.id.imageView1);<br>        imageView.setBackgroundResource(R.drawable.drawable_anim);<br>        anim = (AnimationDrawable) imageView.getBackground();<br>    }<br><br>    <span>public</span> <span>boolean</span> onTouchEvent(MotionEvent event) {<br>        <span>if</span> (event.getAction() == MotionEvent.ACTION_DOWN) {<br>            anim.stop();<br>            anim.start();<br>            <span>return</span> <span>true</span>;<br>        }<br>        <span>return</span> <span>super</span>.onTouchEvent(event);<br>    }</pre><br></div>

<p>ã€€ã€€æˆ‘åœ¨å®éªŒä¸­é‡åˆ°ä¸¤ç‚¹é—®é¢˜ï¼š</p>
<ol>
<li>è¦åœ¨ä»£ç ä¸­è°ƒç”¨Imageviewçš„setBackgroundResourceæ–¹æ³•ï¼Œå¦‚æœç›´æ¥åœ¨XMLå¸ƒå±€æ–‡ä»¶ä¸­è®¾ç½®å…¶srcå±æ€§å½“è§¦å‘åŠ¨ç”»æ—¶ä¼šFCã€‚</li>
<li>åœ¨åŠ¨ç”»start()ä¹‹å‰è¦å…ˆstop()ï¼Œä¸ç„¶åœ¨ç¬¬ä¸€æ¬¡åŠ¨ç”»ä¹‹åä¼šåœåœ¨æœ€åä¸€å¸§ï¼Œè¿™æ ·åŠ¨ç”»å°±åªä¼šè§¦å‘ä¸€æ¬¡ã€‚</li>
<li>æœ€åä¸€ç‚¹æ˜¯SDKä¸­æåˆ°çš„ï¼Œä¸è¦åœ¨onCreateä¸­è°ƒç”¨startï¼Œå› ä¸ºAnimationDrawableè¿˜æ²¡æœ‰å®Œå…¨è·ŸWindowç›¸å…³è”ï¼Œå¦‚æœæƒ³è¦ç•Œé¢æ˜¾ç¤ºæ—¶å°±å¼€å§‹åŠ¨ç”»çš„è¯ï¼Œå¯ä»¥åœ¨onWindowFoucsChanged()ä¸­è°ƒç”¨start()ã€‚</li>
</ol>
<h1 id="3-Property-Animation"><a href="#3-Property-Animation" class="headerlink" title="3. Property Animation"></a>3. Property Animation</h1><p>ã€€ã€€å±æ€§åŠ¨ç”»ï¼Œè¿™ä¸ªæ˜¯åœ¨Android 3.0ä¸­æ‰å¼•è¿›çš„ï¼Œä»¥å‰å­¦WPFæ—¶é‡Œé¢çš„åŠ¨ç”»æœºåˆ¶å¥½åƒå°±æ˜¯è¿™ä¸ªï¼Œå®ƒæ›´æ”¹çš„æ˜¯å¯¹è±¡çš„å®é™…å±æ€§ï¼Œåœ¨View Animationï¼ˆTween Animationï¼‰ä¸­ï¼Œå…¶æ”¹å˜çš„æ˜¯Viewçš„ç»˜åˆ¶æ•ˆæœï¼ŒçœŸæ­£çš„Viewçš„å±æ€§ä¿æŒä¸å˜ï¼Œæ¯”å¦‚æ— è®ºä½ åœ¨å¯¹è¯ä¸­å¦‚ä½•ç¼©æ”¾Buttonçš„å¤§å°ï¼ŒButtonçš„æœ‰æ•ˆç‚¹å‡»åŒºåŸŸè¿˜æ˜¯æ²¡æœ‰åº”ç”¨åŠ¨ç”»æ—¶çš„åŒºåŸŸï¼Œå…¶ä½ç½®ä¸å¤§å°éƒ½ä¸å˜ã€‚è€Œåœ¨Property Animationä¸­ï¼Œæ”¹å˜çš„æ˜¯å¯¹è±¡çš„å®é™…å±æ€§ï¼Œå¦‚Buttonçš„ç¼©æ”¾ï¼ŒButtonçš„ä½ç½®ä¸å¤§å°å±æ€§å€¼éƒ½æ”¹å˜äº†ã€‚è€Œä¸”Property Animationä¸æ­¢å¯ä»¥åº”ç”¨äºViewï¼Œè¿˜å¯ä»¥åº”ç”¨äºä»»ä½•å¯¹è±¡ã€‚Property Animationåªæ˜¯è¡¨ç¤ºä¸€ä¸ªå€¼åœ¨ä¸€æ®µæ—¶é—´å†…çš„æ”¹å˜ï¼Œå½“å€¼æ”¹å˜æ—¶è¦åšä»€ä¹ˆäº‹æƒ…å®Œå…¨æ˜¯ä½ è‡ªå·±å†³å®šçš„ã€‚</p>
<p>åœ¨Property Animationä¸­ï¼Œå¯ä»¥å¯¹åŠ¨ç”»åº”ç”¨ä»¥ä¸‹å±æ€§ï¼š</p>
<ul>
<li>Durationï¼šåŠ¨ç”»çš„æŒç»­æ—¶é—´</li>
<li>TimeInterpolationï¼šå±æ€§å€¼çš„è®¡ç®—æ–¹å¼ï¼Œå¦‚å…ˆå¿«åæ…¢</li>
<li>TypeEvaluatorï¼šæ ¹æ®å±æ€§çš„å¼€å§‹ã€ç»“æŸå€¼ä¸TimeInterpolationè®¡ç®—å‡ºçš„å› å­è®¡ç®—å‡ºå½“å‰æ—¶é—´çš„å±æ€§å€¼</li>
<li>Repeat Count and behavoirï¼šé‡å¤æ¬¡æ•°ä¸æ–¹å¼ï¼Œå¦‚æ’­æ”¾3æ¬¡ã€5æ¬¡ã€æ— é™å¾ªç¯ï¼Œå¯ä»¥æ­¤åŠ¨ç”»ä¸€ç›´é‡å¤ï¼Œæˆ–æ’­æ”¾å®Œæ—¶å†åå‘æ’­æ”¾</li>
<li>Animation setsï¼šåŠ¨ç”»é›†åˆï¼Œå³å¯ä»¥åŒæ—¶å¯¹ä¸€ä¸ªå¯¹è±¡åº”ç”¨å‡ ä¸ªåŠ¨ç”»ï¼Œè¿™äº›åŠ¨ç”»å¯ä»¥åŒæ—¶æ’­æ”¾ä¹Ÿå¯ä»¥å¯¹ä¸åŒåŠ¨ç”»è®¾ç½®ä¸åŒå¼€å§‹åç§»</li>
<li>Frame refreash delayï¼šå¤šå°‘æ—¶é—´åˆ·æ–°ä¸€æ¬¡ï¼Œå³æ¯éš”å¤šå°‘æ—¶é—´è®¡ç®—ä¸€æ¬¡å±æ€§å€¼ï¼Œé»˜è®¤ä¸º10msï¼Œæœ€ç»ˆåˆ·æ–°æ—¶é—´è¿˜å—ç³»ç»Ÿè¿›ç¨‹è°ƒåº¦ä¸ç¡¬ä»¶çš„å½±å“</li>
</ul>
<h2 id="3-1-Property-Animationçš„å·¥ä½œæ–¹å¼"><a href="#3-1-Property-Animationçš„å·¥ä½œæ–¹å¼" class="headerlink" title="3.1 Property Animationçš„å·¥ä½œæ–¹å¼"></a>3.1 Property Animationçš„å·¥ä½œæ–¹å¼</h2><p>ã€€ã€€å¯¹äºä¸‹å›¾çš„åŠ¨ç”»ï¼Œè¿™ä¸ªå¯¹è±¡çš„Xåæ ‡åœ¨40mså†…ä»0ç§»åŠ¨åˆ°40 pixel.æŒ‰é»˜è®¤çš„10msåˆ·æ–°ä¸€æ¬¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šç§»åŠ¨4æ¬¡ï¼Œæ¯æ¬¡ç§»åŠ¨40/4=10pixelã€‚</p>
<p><img src="http://pic002.cnblogs.com/images/2011/168097/2011120119185844.png" alt=""></p>
<p>ã€€ã€€ä¹Ÿå¯ä»¥æ”¹å˜å±æ€§å€¼çš„æ”¹å˜æ–¹æ³•ï¼Œå³è®¾ç½®ä¸åŒçš„interpolationï¼Œåœ¨ä¸‹å›¾ä¸­è¿åŠ¨é€Ÿåº¦å…ˆé€æ¸å¢å¤§å†é€æ¸å‡å°</p>
<p><img src="http://pic002.cnblogs.com/images/2011/168097/2011120119190666.png" alt=""></p>
<p>ã€€ã€€ä¸‹å›¾æ˜¾ç¤ºäº†ä¸ä¸Šè¿°åŠ¨ç”»ç›¸å…³çš„å…³é”®å¯¹è±¡</p>
<p><img src="http://pic002.cnblogs.com/images/2011/168097/2011120119191590.png" alt=""></p>
<p>ValueAnimator &nbsp;è¡¨ç¤ºä¸€ä¸ªåŠ¨ç”»ï¼ŒåŒ…å«åŠ¨ç”»çš„å¼€å§‹å€¼ï¼Œç»“æŸå€¼ï¼ŒæŒç»­æ—¶é—´ç­‰å±æ€§ã€‚</p>
<p>ValueAnimatorå°è£…äº†ä¸€ä¸ªTimeInterpolatorï¼ŒTimeInterpolatorå®šä¹‰äº†å±æ€§å€¼åœ¨å¼€å§‹å€¼ä¸ç»“æŸå€¼ä¹‹é—´çš„æ’å€¼æ–¹æ³•ã€‚</p>
<p>ValueAnimatorè¿˜å°è£…äº†ä¸€ä¸ªTypeAnimatorï¼Œæ ¹æ®å¼€å§‹ã€ç»“æŸå€¼ä¸TimeIniterpolatorè®¡ç®—å¾—åˆ°çš„å€¼è®¡ç®—å‡ºå±æ€§å€¼ã€‚</p>
<p>ValueAnimatoræ ¹æ®åŠ¨ç”»å·²è¿›è¡Œçš„æ—¶é—´è·ŸåŠ¨ç”»æ€»æ—¶é—´ï¼ˆdurationï¼‰çš„æ¯”è®¡ç®—å‡ºä¸€ä¸ªæ—¶é—´å› å­ï¼ˆ0~1ï¼‰ï¼Œç„¶åæ ¹æ®TimeInterpolatorè®¡ç®—å‡ºå¦ä¸€ä¸ªå› å­ï¼Œæœ€åTypeAnimatoré€šè¿‡è¿™ä¸ªå› å­è®¡ç®—å‡ºå±æ€§å€¼ï¼Œå¦‚ä¸Šä¾‹ä¸­10msæ—¶ï¼š</p>
<p>é¦–å…ˆè®¡ç®—å‡ºæ—¶é—´å› å­ï¼Œå³ç»è¿‡çš„æ—¶é—´ç™¾åˆ†æ¯”ï¼št=10ms/40ms=0.25</p>
<p>ç»æ’å€¼è®¡ç®—(inteplator)åçš„æ’å€¼å› å­:å¤§çº¦ä¸º0.15ï¼Œä¸Šè¿°ä¾‹å­ä¸­ç”¨äº†AccelerateDecelerateInterpolatorï¼Œè®¡ç®—å…¬å¼ä¸ºï¼ˆinputå³ä¸ºæ—¶é—´å› å­ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre>(Math.cos((input + 1) * Math.PI) / 2.0f) + 0.5f;  </pre><br></div>

<p>æœ€åæ ¹æ®TypeEvaluatorè®¡ç®—å‡ºåœ¨10msæ—¶çš„å±æ€§å€¼ï¼š0.15*ï¼ˆ40-0ï¼‰=6pixelã€‚ä¸Šä¾‹ä¸­TypeEvaluatorä¸ºFloatEvaluatorï¼Œè®¡ç®—æ–¹æ³•ä¸º ï¼š</p>
<div class="cnblogs_code"><br><pre>public Float evaluate(<span>float</span><span> fraction, Number startValue, Number endValue) {<br>    </span><span>float</span> startFloat =<span> startValue.floatValue();<br>    </span><span>return</span> startFloat + fraction * (endValue.floatValue() -<span> startFloat);<br>}</span></pre><br></div>

<p>å‚æ•°åˆ†åˆ«ä¸ºä¸Šä¸€æ­¥çš„æ’å€¼å› å­ï¼Œå¼€å§‹å€¼ä¸ç»“æŸå€¼ã€‚</p>
<h2 id="3-2-ValueAnimator"><a href="#3-2-ValueAnimator" class="headerlink" title="3.2 ValueAnimator"></a>3.2 ValueAnimator</h2><p>ã€€ã€€ValueAnimatoråŒ…å«Property AnimationåŠ¨ç”»çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼Œå¦‚åŠ¨ç”»æ—¶é—´ï¼Œå¼€å§‹ã€ç»“æŸå±æ€§å€¼ï¼Œç›¸åº”æ—¶é—´å±æ€§å€¼è®¡ç®—æ–¹æ³•ç­‰ã€‚åº”ç”¨Property Animationæœ‰ä¸¤ä¸ªæ­¥èšï¼š</p>
<ol>
<li>è®¡ç®—å±æ€§å€¼</li>
<li>æ ¹æ®å±æ€§å€¼æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œï¼Œå¦‚æ”¹å˜å¯¹è±¡çš„æŸä¸€å±æ€§ã€‚</li>
</ol>
<p>ã€€ã€€ValuAnimiatoråªå®Œæˆäº†ç¬¬ä¸€æ­¥å·¥ä½œï¼Œå¦‚æœè¦å®Œæˆç¬¬äºŒæ­¥ï¼Œéœ€è¦å®ç°ValueAnimator.onUpdateListeneræ¥å£ï¼Œè¿™ä¸ªæ¥å£åªæœ‰ä¸€ä¸ªå‡½æ•°onAnimationUpdate()ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­ä¼šä¼ å…¥ValueAnimatorå¯¹è±¡åšä¸ºå‚æ•°ï¼Œé€šè¿‡è¿™ä¸ªValueAnimatorå¯¹è±¡çš„getAnimatedValue()å‡½æ•°å¯ä»¥å¾—åˆ°å½“å‰çš„å±æ€§å€¼å¦‚ï¼š</p>
<div class="cnblogs_code"><br><pre>ValueAnimator animation = ValueAnimator.ofFloat(0f, 1f);<br>animation.setDuration(1000);<br>animation.addUpdateListener(<span>new</span> AnimatorUpdateListener() {<br>    @Override<br>    <span>public</span> <span>void</span> onAnimationUpdate(ValueAnimator animation) {<br>        Log.i(â€œupdateâ€, ((Float) animation.getAnimatedValue()).toString());<br>    }<br>});<br>animation.setInterpolator(<span>new</span> CycleInterpolator(3));<br>animation.start();</pre><br></div>

<p>æ­¤ç¤ºä¾‹ä¸­åªæ˜¯å‘Logcatè¾“å‡ºäº†ä¸€äº›ä¿¡æ¯ï¼Œå¯ä»¥æ”¹ä¸ºæƒ³åšçš„å·¥ä½œã€‚</p>
<p><strong>Animator.AnimatorListener</strong></p>
<div class="cnblogs_code"><br><pre><span>onAnimationStart()<br><br>onAnimationEnd()<br><br>onAnimationRepeat()<br><br></span><span>//</span><span>å½“åŠ¨ç”»è¢«å–æ¶ˆæ—¶è°ƒç”¨ï¼ŒåŒæ—¶ä¼šè°ƒç”¨onAnimationEnd().</span><br>onAnimationCancel()</pre><br></div>

<p><strong>ValueAnimator.AnimatorUpdateListener</strong></p>
<div class="cnblogs_code"><br><pre>onAnimationUpdate()ã€€ã€€<span>//</span><span>é€šè¿‡ç›‘å¬è¿™ä¸ªäº‹ä»¶åœ¨å±æ€§çš„å€¼æ›´æ–°æ—¶æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼Œå¯¹äºValueAnimatorä¸€èˆ¬è¦ç›‘å¬æ­¤äº‹ä»¶æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œï¼Œä¸ç„¶Animationæ²¡æ„ä¹‰ï¼Œåœ¨ObjectAnimatorï¼ˆç»§æ‰¿è‡ªValueAnimatorï¼‰ä¸­ä¼šè‡ªåŠ¨æ›´æ–°å±æ€§ï¼Œå¦‚æ— å¿…è¦ä¸å¿…ç›‘å¬ã€‚åœ¨å‡½æ•°ä¸­ä¼šä¼ é€’ä¸€ä¸ªValueAnimatorå‚æ•°ï¼Œé€šè¿‡æ­¤å‚æ•°çš„getAnimatedValue()å–å¾—å½“å‰åŠ¨ç”»å±æ€§å€¼ã€‚</span></pre><br></div>

<p>ã€€ã€€å¯ä»¥ç»§æ‰¿AnimatorListenerAdapterè€Œä¸æ˜¯å®ç°AnimatorListeneræ¥å£æ¥ç®€åŒ–æ“ä½œï¼Œè¿™ä¸ªç±»å¯¹AnimatorListenerä¸­çš„å‡½æ•°éƒ½å®šä¹‰äº†ä¸€ä¸ªç©ºå‡½æ•°ä½“ï¼Œè¿™æ ·æˆ‘ä»¬å°±åªç”¨å®šä¹‰æƒ³ç›‘å¬çš„äº‹ä»¶è€Œä¸ç”¨å®ç°æ¯ä¸ªå‡½æ•°å´åªå®šä¹‰ä¸€ç©ºå‡½æ•°ä½“ã€‚</p>
<div class="cnblogs_code"><br><pre>ObjectAnimator oa=ObjectAnimator.ofFloat(tv, â€œalphaâ€<span>, 0f, 1f);<br>oa.setDuration(</span>3000<span>);<br>oa.addListener(</span><span>new</span><span> AnimatorListenerAdapter(){<br>    </span><span>public</span> <span>void</span><span> on AnimationEnd(Animator animation){<br>        Log.i(</span>â€œAnimationâ€,â€endâ€<span>);<br>    }<br>});<br>oa.start();</span></pre><br></div>

<h2 id="3-3-ObjectAnimator"><a href="#3-3-ObjectAnimator" class="headerlink" title="3.3 ObjectAnimator"></a>3.3 ObjectAnimator</h2><p>ã€€ã€€ç»§æ‰¿è‡ªValueAnimatorï¼Œè¦æŒ‡å®šä¸€ä¸ªå¯¹è±¡åŠè¯¥å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå½“å±æ€§å€¼è®¡ç®—å®Œæˆæ—¶è‡ªåŠ¨è®¾ç½®ä¸ºè¯¥å¯¹è±¡çš„ç›¸åº”å±æ€§ï¼Œå³å®Œæˆäº†Property Animationçš„å…¨éƒ¨ä¸¤æ­¥æ“ä½œã€‚å®é™…åº”ç”¨ä¸­ä¸€èˆ¬éƒ½ä¼šç”¨ObjectAnimatoræ¥æ”¹å˜æŸä¸€å¯¹è±¡çš„æŸä¸€å±æ€§ï¼Œä½†ç”¨ObjectAnimatoræœ‰ä¸€å®šçš„é™åˆ¶ï¼Œè¦æƒ³ä½¿ç”¨ObjectAnimatorï¼Œåº”è¯¥æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>å¯¹è±¡åº”è¯¥æœ‰ä¸€ä¸ªsetterå‡½æ•°ï¼šset&lt;PropertyName&gt;ï¼ˆé©¼å³°å‘½åæ³•ï¼‰</li>
<li>å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒåƒofFloatä¹‹ç±»çš„å·¥åœºæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå¯¹è±¡åï¼Œç¬¬äºŒä¸ªä¸ºå±æ€§åï¼Œåé¢çš„å‚æ•°ä¸ºå¯å˜å‚æ•°ï¼Œå¦‚æœvalues&hellip;å‚æ•°åªè®¾ç½®äº†ä¸€ä¸ªå€¼çš„è¯ï¼Œé‚£ä¹ˆä¼šå‡å®šä¸ºç›®çš„å€¼ï¼Œå±æ€§å€¼çš„å˜åŒ–èŒƒå›´ä¸ºå½“å‰å€¼åˆ°ç›®çš„å€¼ï¼Œä¸ºäº†è·å¾—å½“å‰å€¼ï¼Œè¯¥å¯¹è±¡è¦æœ‰ç›¸åº”å±æ€§çš„getteræ–¹æ³•ï¼šget&lt;PropertyName&gt;</li>
<li>å¦‚æœæœ‰getteræ–¹æ³•ï¼Œå…¶åº”è¿”å›å€¼ç±»å‹åº”ä¸ç›¸åº”çš„setteræ–¹æ³•çš„å‚æ•°ç±»å‹ä¸€è‡´ã€‚</li>
</ul>
<p>ã€€ã€€å¦‚æœä¸Šè¿°æ¡ä»¶ä¸æ»¡è¶³ï¼Œåˆ™ä¸èƒ½ç”¨ObjectAnimatorï¼Œåº”ç”¨ValueAnimatorä»£æ›¿ã€‚</p>
<div class="cnblogs_code"><br><pre>tv=<span>(TextView)findViewById(R.id.textview1);<br>btn</span>=<span>(Button)findViewById(R.id.button1);<br>btn.setOnClickListener(</span><span>new</span><span> OnClickListener() {<br>ã€€ã€€@Override<br>ã€€ã€€</span><span>public</span> <span>void</span><span> onClick(View v) {<br>ã€€ã€€ã€€ã€€ObjectAnimator oa</span>=ObjectAnimator.ofFloat(tv, â€œalphaâ€<span>, 0f, 1f);<br>ã€€ã€€ã€€ã€€oa.setDuration(</span>3000<span>);<br>ã€€ã€€ã€€ã€€oa.start();<br>ã€€ã€€}<br>});</span></pre><br></div>

<p>ã€€ã€€æŠŠä¸€ä¸ªTextViewçš„é€æ˜åº¦åœ¨3ç§’å†…ä»0å˜è‡³1ã€‚</p>
<p><strong>ã€€ã€€æ ¹æ®åº”ç”¨åŠ¨ç”»çš„å¯¹è±¡æˆ–å±æ€§çš„ä¸åŒï¼Œå¯èƒ½éœ€è¦åœ¨onAnimationUpdateå‡½æ•°ä¸­è°ƒç”¨invalidate()å‡½æ•°åˆ·æ–°è§†å›¾ã€‚</strong></p>
<h2 id="3-4-é€šè¿‡AnimationSetåº”ç”¨å¤šä¸ªåŠ¨ç”»"><a href="#3-4-é€šè¿‡AnimationSetåº”ç”¨å¤šä¸ªåŠ¨ç”»" class="headerlink" title="3.4 é€šè¿‡AnimationSetåº”ç”¨å¤šä¸ªåŠ¨ç”»"></a>3.4 é€šè¿‡AnimationSetåº”ç”¨å¤šä¸ªåŠ¨ç”»</h2><p>ã€€ã€€AnimationSetæä¾›äº†ä¸€ä¸ªæŠŠå¤šä¸ªåŠ¨ç”»ç»„åˆæˆä¸€ä¸ªç»„åˆçš„æœºåˆ¶ï¼Œå¹¶å¯è®¾ç½®ç»„ä¸­åŠ¨ç”»çš„æ—¶åºå…³ç³»ï¼Œå¦‚åŒæ—¶æ’­æ”¾ï¼Œé¡ºåºæ’­æ”¾ç­‰ã€‚</p>
<p>ã€€ã€€ä»¥ä¸‹ä¾‹å­åŒæ—¶åº”ç”¨5ä¸ªåŠ¨ç”»ï¼š</p>
<ol>
<li>æ’­æ”¾anim1ï¼›</li>
<li>åŒæ—¶æ’­æ”¾anim2,anim3,anim4ï¼›</li>
<li>æ’­æ”¾anim5ã€‚<div class="cnblogs_code"><br><pre>AnimatorSet bouncer = <span>new</span><span> AnimatorSet();<br>bouncer.play(anim1).before(anim2);<br>bouncer.play(anim2).with(anim3);<br>bouncer.play(anim2).with(anim4)<br>bouncer.play(anim5).after(amin2);<br>animatorSet.start();</span></pre><br></div>

</li>
</ol>
<h2 id="3-5-TypeEvalutors"><a href="#3-5-TypeEvalutors" class="headerlink" title="3.5 TypeEvalutors"></a>3.5 TypeEvalutors</h2><p>ã€€ã€€æ ¹æ®å±æ€§çš„å¼€å§‹ã€ç»“æŸå€¼ä¸TimeInterpolationè®¡ç®—å‡ºçš„å› å­è®¡ç®—å‡ºå½“å‰æ—¶é—´çš„å±æ€§å€¼ï¼Œandroidæä¾›äº†ä»¥ä¸‹å‡ ä¸ªevalutorï¼š</p>
<ul>
<li>IntEvaluatorï¼šå±æ€§çš„å€¼ç±»å‹ä¸ºintï¼›</li>
<li>FloatEvaluatorï¼šå±æ€§çš„å€¼ç±»å‹ä¸ºfloatï¼›</li>
<li>ArgbEvaluatorï¼šå±æ€§çš„å€¼ç±»å‹ä¸ºåå…­è¿›åˆ¶é¢œè‰²å€¼ï¼›</li>
<li>TypeEvaluatorï¼šä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥é€šè¿‡å®ç°è¯¥æ¥å£è‡ªå®šä¹‰Evaluatorã€‚</li>
</ul>
<p>ã€€ã€€è‡ªå®šä¹‰TypeEvalutorå¾ˆç®€å•ï¼Œåªéœ€è¦å®ç°ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚FloatEvalutorçš„å®šä¹‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span>public</span> <span>class</span> FloatEvaluator <span>implements</span><span> TypeEvaluator {<br>    </span><span>public</span> Object evaluate(<span>float</span><span> fraction, Object startValue, Object endValue) {<br>        </span><span>float</span> startFloat =<span> ((Number) startValue).floatValue();<br>        </span><span>return</span> startFloat + fraction * (((Number) endValue).floatValue() -<span> startFloat);<br>    }<br>}</span></pre><br></div>

<p>ã€€ã€€æ ¹æ®åŠ¨ç”»æ‰§è¡Œçš„æ—¶é—´è·Ÿåº”ç”¨çš„Interplatorï¼Œä¼šè®¡ç®—å‡ºä¸€ä¸ª0~1ä¹‹é—´çš„å› å­ï¼Œå³evaluteå‡½æ•°ä¸­çš„fractionå‚æ•°ï¼Œé€šè¿‡ä¸Šè¿°FloatEvaluatoråº”è¯¥å¾ˆå¥½çœ‹å‡ºå…¶æ„æ€ã€‚</p>
<h2 id="3-6-TimeInterplator"><a href="#3-6-TimeInterplator" class="headerlink" title="3.6 TimeInterplator"></a>3.6 TimeInterplator</h2><p>ã€€ã€€Time interplatorå®šä¹‰äº†å±æ€§å€¼å˜åŒ–çš„æ–¹å¼ï¼Œå¦‚çº¿æ€§å‡åŒ€æ”¹å˜ï¼Œå¼€å§‹æ…¢ç„¶åé€æ¸å¿«ç­‰ã€‚åœ¨Property Animationä¸­æ˜¯TimeInterplatorï¼Œåœ¨View Animationä¸­æ˜¯Interplatorï¼Œè¿™ä¸¤ä¸ªæ˜¯ä¸€æ ·çš„ï¼Œåœ¨3.0ä¹‹å‰åªæœ‰Interplatorï¼Œ3.0ä¹‹åå®ç°ä»£ç è½¬ç§»è‡³äº†TimeInterplatorã€‚Interplatorç»§æ‰¿è‡ªTimeInterplatorï¼Œå†…éƒ¨æ²¡æœ‰ä»»ä½•å…¶ä»–ä»£ç ã€‚</p>
<ul>
<li>AccelerateInterpolatorã€€ã€€ã€€ã€€ã€€ &nbsp; &nbsp; åŠ é€Ÿï¼Œå¼€å§‹æ—¶æ…¢ä¸­é—´åŠ é€Ÿ</li>
<li>DecelerateInterpolatorã€€ã€€ã€€ ã€€ã€€ &nbsp; å‡é€Ÿï¼Œå¼€å§‹æ—¶å¿«ç„¶åå‡é€Ÿ</li>
<li>AccelerateDecelerateInterolatorã€€ &nbsp; å…ˆåŠ é€Ÿåå‡é€Ÿï¼Œå¼€å§‹ç»“æŸæ—¶æ…¢ï¼Œä¸­é—´åŠ é€Ÿ</li>
<li>AnticipateInterpolatorã€€ã€€ã€€ã€€ã€€ã€€ &nbsp;åå‘ ï¼Œå…ˆå‘ç›¸åæ–¹å‘æ”¹å˜ä¸€æ®µå†åŠ é€Ÿæ’­æ”¾</li>
<li>AnticipateOvershootInterpolatorã€€ &nbsp; åå‘åŠ å›å¼¹ï¼Œå…ˆå‘ç›¸åæ–¹å‘æ”¹å˜ï¼Œå†åŠ é€Ÿæ’­æ”¾ï¼Œä¼šè¶…å‡ºç›®çš„å€¼ç„¶åç¼“æ…¢ç§»åŠ¨è‡³ç›®çš„å€¼</li>
<li>BounceInterpolatorã€€ã€€ã€€ã€€ã€€ã€€ã€€ &nbsp;è·³è·ƒï¼Œå¿«åˆ°ç›®çš„å€¼æ—¶å€¼ä¼šè·³è·ƒï¼Œå¦‚ç›®çš„å€¼100ï¼Œåé¢çš„å€¼å¯èƒ½ä¾æ¬¡ä¸º85ï¼Œ77ï¼Œ70ï¼Œ80ï¼Œ90ï¼Œ100</li>
<li>CycleIinterpolatorã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ å¾ªç¯ï¼ŒåŠ¨ç”»å¾ªç¯ä¸€å®šæ¬¡æ•°ï¼Œå€¼çš„æ”¹å˜ä¸ºä¸€æ­£å¼¦å‡½æ•°ï¼šMath.sin(2 <em> mCycles </em> Math.PI * input)</li>
<li>LinearInterpolatorã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ çº¿æ€§ï¼Œçº¿æ€§å‡åŒ€æ”¹å˜</li>
<li>OvershottInterpolatorã€€ã€€ã€€ã€€ã€€ã€€ &nbsp;å›å¼¹ï¼Œæœ€åè¶…å‡ºç›®çš„å€¼ç„¶åç¼“æ…¢æ”¹å˜åˆ°ç›®çš„å€¼</li>
<li>TimeInterpolatorã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ &nbsp; ä¸€ä¸ªæ¥å£ï¼Œå…è®¸ä½ è‡ªå®šä¹‰interpolatorï¼Œä»¥ä¸Šå‡ ä¸ªéƒ½æ˜¯å®ç°äº†è¿™ä¸ªæ¥å£</li>
</ul>
<h2 id="3-7-å½“Layoutæ”¹å˜æ—¶åº”ç”¨åŠ¨ç”»"><a href="#3-7-å½“Layoutæ”¹å˜æ—¶åº”ç”¨åŠ¨ç”»" class="headerlink" title="3.7 å½“Layoutæ”¹å˜æ—¶åº”ç”¨åŠ¨ç”»"></a>3.7 å½“Layoutæ”¹å˜æ—¶åº”ç”¨åŠ¨ç”»</h2><p>ã€€ã€€ViewGroupä¸­çš„å­å…ƒç´ å¯ä»¥é€šè¿‡setVisibilityä½¿å…¶Visibleã€Invisibleæˆ–Goneï¼Œå½“æœ‰å­å…ƒç´ å¯è§æ€§æ”¹å˜æ—¶(VISIBLEã€GONE)ï¼Œå¯ä»¥å‘å…¶åº”ç”¨åŠ¨ç”»ï¼Œé€šè¿‡LayoutTransitionç±»åº”ç”¨æ­¤ç±»åŠ¨ç”»ï¼š</p>
<div class="cnblogs_code"><br><pre>transition.setAnimator(LayoutTransition.DISAPPEARING, customDisappearingAnim);</pre><br></div>

<p>ã€€ã€€é€šè¿‡setAnimatoråº”ç”¨åŠ¨ç”»ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºåº”ç”¨çš„æƒ…å¢ƒï¼Œå¯ä»¥ä»¥ä¸‹4ç§ç±»å‹ï¼š</p>
<ul>
<li>APPEARINGã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€å½“ä¸€ä¸ªå…ƒç´ åœ¨å…¶çˆ¶å…ƒç´ ä¸­å˜ä¸ºVisibleæ—¶å¯¹è¿™ä¸ªå…ƒç´ åº”ç”¨åŠ¨ç”»</li>
<li>CHANGE_APPEARINGã€€ã€€ã€€ å½“ä¸€ä¸ªå…ƒç´ åœ¨å…¶çˆ¶å…ƒç´ ä¸­å˜ä¸ºVisibleæ—¶ï¼Œå› ç³»ç»Ÿè¦é‡æ–°å¸ƒå±€æœ‰ä¸€äº›å…ƒç´ éœ€è¦ç§»åŠ¨ï¼Œå¯¹è¿™äº›è¦ç§»åŠ¨çš„å…ƒç´ åº”ç”¨åŠ¨ç”»</li>
<li>DISAPPEARINGã€€ã€€ã€€ã€€ã€€ã€€ å½“ä¸€ä¸ªå…ƒç´ åœ¨å…¶çˆ¶å…ƒç´ ä¸­å˜ä¸ºGONEæ—¶å¯¹å…¶åº”ç”¨åŠ¨ç”»</li>
<li>CHANGE_DISAPPEARINGã€€ &nbsp;å½“ä¸€ä¸ªå…ƒç´ åœ¨å…¶çˆ¶å…ƒç´ ä¸­å˜ä¸ºGONEæ—¶ï¼Œå› ç³»ç»Ÿè¦é‡æ–°å¸ƒå±€æœ‰ä¸€äº›å…ƒç´ éœ€è¦ç§»åŠ¨ï¼Œè¿™äº›è¦ç§»åŠ¨çš„å…ƒç´ åº”ç”¨åŠ¨ç”».</li>
</ul>
<p>ã€€ã€€ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€Animatorã€‚</p>
<div class="cnblogs_code"><br><pre>mTransitioner.setStagger(LayoutTransition.CHANGE_APPEARING, 30);</pre><br></div>

<p>ã€€ã€€æ­¤å‡½æ•°è®¾ç½®åŠ¨ç”»å»¶è¿Ÿæ—¶é—´ï¼Œå‚æ•°åˆ†åˆ«ä¸ºç±»å‹ä¸æ—¶é—´ã€‚</p>
<h2 id="3-8-Keyframes"><a href="#3-8-Keyframes" class="headerlink" title="3.8 Keyframes"></a>3.8 Keyframes</h2><p>ã€€ã€€keyFrameæ˜¯ä¸€ä¸ª æ—¶é—´/å€¼ å¯¹ï¼Œé€šè¿‡å®ƒå¯ä»¥å®šä¹‰ä¸€ä¸ªåœ¨ç‰¹å®šæ—¶é—´çš„ç‰¹å®šçŠ¶æ€ï¼Œå³å…³é”®å¸§ï¼Œè€Œä¸”åœ¨ä¸¤ä¸ªkeyFrameä¹‹é—´å¯ä»¥å®šä¹‰ä¸åŒçš„Interpolatorï¼Œå°±å¥½åƒå¤šä¸ªåŠ¨ç”»çš„æ‹¼æ¥ï¼Œç¬¬ä¸€ä¸ªåŠ¨ç”»çš„ç»“æŸç‚¹æ˜¯ç¬¬äºŒä¸ªåŠ¨ç”»çš„å¼€å§‹ç‚¹ã€‚KeyFrameæ˜¯æŠ½è±¡ç±»ï¼Œè¦é€šè¿‡ofInt(),ofFloat(),ofObject()è·å¾—é€‚å½“çš„KeyFrameï¼Œç„¶åé€šè¿‡PropertyValuesHolder.ofKeyframeè·å¾—PropertyValuesHolderå¯¹è±¡ï¼Œå¦‚ä»¥ä¸‹ä¾‹å­ï¼š</p>
<div class="cnblogs_code"><br><pre>Keyframe kf0 = Keyframe.ofInt(0, 400<span>);<br>Keyframe kf1 </span>= Keyframe.ofInt(0.25f, 200<span>);<br>Keyframe kf2 </span>= Keyframe.ofInt(0.5f, 400<span>);<br>Keyframe kf4 </span>= Keyframe.ofInt(0.75f, 100<span>);<br>Keyframe kf3 </span>= Keyframe.ofInt(1f, 500<span>);<br>PropertyValuesHolder pvhRotation </span>= PropertyValuesHolder.ofKeyframe(â€œwidthâ€<span>, kf0, kf1, kf2, kf4, kf3);<br>ObjectAnimator rotationAnim </span>=<span> ObjectAnimator.ofPropertyValuesHolder(btn2, pvhRotation);<br>rotationAnim.setDuration(</span>2000);</pre><br></div>

<p>ã€€ã€€ä¸Šè¿°ä»£ç çš„æ„æ€ä¸ºï¼šè®¾ç½®btnå¯¹è±¡çš„widthå±æ€§å€¼ä½¿å…¶ï¼š</p>
<ul>
<li>å¼€å§‹æ—¶ Width=400</li>
<li>åŠ¨ç”»å¼€å§‹1/4æ—¶ Width=200</li>
<li>åŠ¨ç”»å¼€å§‹1/2æ—¶ Width=400</li>
<li>åŠ¨ç”»å¼€å§‹3/4æ—¶ Width=100</li>
<li>åŠ¨ç”»ç»“æŸæ—¶ Width=500<div>ã€€ã€€ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ—¶é—´ç™¾åˆ†æ¯”ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯åœ¨ç¬¬ä¸€ä¸ªå‚æ•°çš„æ—¶é—´æ—¶çš„å±æ€§å€¼ã€‚</div><br><div>ã€€ã€€å®šä¹‰äº†ä¸€äº›Keyframeåï¼Œé€šè¿‡PropertyValuesHolderç±»çš„æ–¹æ³•ofKeyframeä¸€ä¸ªPropertyValuesHolderå¯¹è±¡ï¼Œç„¶åé€šè¿‡ObjectAnimator.ofPropertyValuesHolderè·å¾—ä¸€ä¸ªAnimatorå¯¹è±¡ã€‚</div><br><div>ã€€ã€€ç”¨ä¸‹é¢çš„ä»£ç å¯ä»¥å®ç°åŒæ ·çš„æ•ˆæœï¼ˆä¸Šè¿°ä»£ç æ—¶é—´å€¼æ˜¯çº¿æ€§ï¼Œå˜åŒ–å‡åŒ€ï¼‰ï¼š</div><br><div><br><div class="cnblogs_code"><br><pre>ObjectAnimator oa=ObjectAnimator.ofInt(btn2, â€œwidthâ€, 400,200,400,100,500);<br>oa.setDuration(2000);<br>oa.start();</pre><br></div><br></div>

</li>
</ul>
<h2 id="3-9-Animating-Views"><a href="#3-9-Animating-Views" class="headerlink" title="3.9 Animating Views"></a>3.9 Animating Views</h2><p>ã€€ã€€åœ¨View Animationä¸­ï¼Œå¯¹Viewåº”ç”¨Animationå¹¶æ²¡æœ‰æ”¹å˜Viewçš„å±æ€§ï¼ŒåŠ¨ç”»çš„å®ç°æ˜¯é€šè¿‡å…¶Parent Viewå®ç°çš„ï¼Œåœ¨Viewè¢«drawnæ—¶Parents Viewæ”¹å˜å®ƒçš„ç»˜åˆ¶å‚æ•°ï¼Œdrawåå†æ”¹å˜å‚æ•°invalidateï¼Œè¿™æ ·è™½ç„¶Viewçš„å¤§å°æˆ–æ—‹è½¬è§’åº¦ç­‰æ”¹å˜äº†ï¼Œä½†Viewçš„å®é™…å±æ€§æ²¡å˜ï¼Œæ‰€ä»¥æœ‰æ•ˆåŒºåŸŸè¿˜æ˜¯åº”ç”¨åŠ¨ç”»ä¹‹å‰çš„åŒºåŸŸï¼Œæ¯”å¦‚ä½ æŠŠä¸€æŒ‰é’®æ”¾å¤§ä¸¤å€ï¼Œä½†è¿˜æ˜¯æ”¾å¤§è¿™å‰çš„åŒºåŸŸå¯ä»¥è§¦å‘ç‚¹å‡»äº‹ä»¶ã€‚ä¸ºäº†æ”¹å˜è¿™ä¸€ç‚¹ï¼Œåœ¨Android 3.0ä¸­ç»™Viewå¢åŠ äº†ä¸€äº›å‚æ•°å¹¶å¯¹è¿™äº›å‚æ•°å¢åŠ äº†ç›¸åº”çš„getter/setterå‡½æ•°ï¼ˆObjectAnimatorè¦ç”¨è¿™äº›å‡½æ•°æ”¹å˜è¿™äº›å±æ€§ï¼‰ï¼š</p>
<ul>
<li>translationX,translationY: Viewç›¸å¯¹äºåŸå§‹ä½ç½®çš„åç§»é‡</li>
<li>rotation,rotationX,rotationY: æ—‹è½¬ï¼Œrotationç”¨äº2Dæ—‹è½¬è§’åº¦ï¼Œ3Dä¸­ç”¨åˆ°åä¸¤ä¸ª</li>
<li>scaleX,scaleY: ç¼©æ”¾æ¯”</li>
<li>x,y: Viewçš„æœ€ç»ˆåæ ‡ï¼Œæ˜¯Viewçš„leftï¼Œtopä½ç½®åŠ ä¸ŠtranslationXï¼ŒtranslationY</li>
<li>alpha: é€æ˜åº¦<div>ã€€ã€€è·Ÿä½ç½®æœ‰å…³çš„å‚æ•°æœ‰3ä¸ªï¼Œä»¥Xåæ ‡ä¸ºä¾‹ï¼Œå¯ä»¥é€šè¿‡getLeft(),getX(),getTranslateX()è·å¾—ï¼Œè‹¥æœ‰ä¸€Button btn2ï¼Œå¸ƒå±€æ—¶å…¶åæ ‡ä¸ºï¼ˆ40,0ï¼‰ï¼š</div><br><div><br><div class="cnblogs_code"><br><pre><span>//</span><span>åº”ç”¨åŠ¨ç”»ä¹‹å‰</span><span><br></span>btn2.getLeft();    <span>//</span><span>40</span><span><br></span>btn2.getX();    <span>//</span><span>40</span><span><br></span>btn2.getTranslationX();    <span>//</span><span>0<br></span><span>//</span><span>åº”ç”¨translationXåŠ¨ç”»</span><span><br></span>ObjectAnimator oa=ObjectAnimator.ofFloat(btn2,â€translationXâ€, 200);<br>oa.setDuration(2000);<br>oa.start();<br><span>/<em></em></span><span>åº”ç”¨translationXåŠ¨ç”»å<br>btn2.getLeft();    //40<br>btn2.getX();    //240<br>btn2.getTranslationX();    //200<br></span><span>/</span><br><span>//</span><span>åº”ç”¨XåŠ¨ç”»ï¼Œå‡è®¾æ²¡æœ‰åº”ç”¨ä¹‹å‰çš„translationXåŠ¨ç”»</span><span><br></span>ObjectAnimator oa=ObjectAnimator.ofFloat(btn2, â€œxâ€, 200);<br>oa.setDuration(2000);<br>oa.start();<br><span>/<em></em></span><span>åº”ç”¨XåŠ¨ç”»å<br>btn2.getLeft();    //40<br>btn2.getX();    //200<br>btn2.getTranslationX();    //160<br></span><span>/</span></pre><br></div><br></div><br><div>ã€€ã€€æ— è®ºæ€æ ·åº”ç”¨åŠ¨ç”»ï¼ŒåŸæ¥çš„å¸ƒå±€æ—¶çš„ä½ç½®é€šè¿‡getLeft()è·å¾—ï¼Œä¿æŒä¸å˜ï¼›</div><br><div>ã€€ã€€Xæ˜¯Viewæœ€ç»ˆçš„ä½ç½®ï¼›</div><br><div>ã€€ã€€translationXä¸ºæœ€ç»ˆä½ç½®ä¸å¸ƒå±€æ—¶åˆå§‹ä½ç½®è¿™å·®ã€‚</div><br><div>ã€€ã€€æ‰€ä»¥è‹¥å°±ç”¨translationXå³ä¸ºåœ¨åŸæ¥åŸºç¡€ä¸Šç§»åŠ¨å¤šå°‘ï¼ŒXä¸ºæœ€ç»ˆå¤šå°‘</div><br><div>ã€€ã€€getX()çš„å€¼ä¸ºgetLeft()ä¸getTranslationX()çš„å’Œ</div><br><div>ã€€ã€€å¯¹äºXåŠ¨ç”»ï¼Œæºä»£ç æ˜¯è¿™æ ·çš„ï¼š</div><br><div><br><div class="cnblogs_code"><br><pre><span>case</span> X:<br>   info.mTranslationX = value - mView.mLeft;<br>   <span>break</span>;</pre><br></div><br></div>

</li>
</ul>
<p>ã€€ã€€Property Animationä¹Ÿå¯ä»¥åœ¨XMLä¸­å®šä¹‰</p>
<ul>
<li>&lt;set&gt; - AnimatorSet</li>
<li>&lt;animator&gt; -&nbsp;ValueAnimator</li>
<li>&lt;objectAnimator&gt; -&nbsp;ObjectAnimator<div>ã€€ã€€XMLæ–‡ä»¶åº”æ”¾å¤§/res/animator/ä¸­ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼åº”ç”¨åŠ¨ç”»ï¼š</div><br><div><br><div class="cnblogs_code"><br><pre>AnimatorSet set = (AnimatorSet) AnimatorInflater.loadAnimator(myContext, R.anim.property_animator);<br>set.setTarget(myObject);<br>set.start();</pre><br></div><br></div>

</li>
</ul>
<h2 id="3-10-ViewPropertyAnimator"><a href="#3-10-ViewPropertyAnimator" class="headerlink" title="3.10 ViewPropertyAnimator"></a>3.10 ViewPropertyAnimator</h2><p>ã€€ã€€å¦‚æœéœ€è¦å¯¹ä¸€ä¸ªViewçš„å¤šä¸ªå±æ€§è¿›è¡ŒåŠ¨ç”»å¯ä»¥ç”¨ViewPropertyAnimatorç±»ï¼Œè¯¥ç±»å¯¹å¤šå±æ€§åŠ¨ç”»è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä¼šåˆå¹¶ä¸€äº›invalidate()æ¥å‡å°‘åˆ·æ–°è§†å›¾ï¼Œè¯¥ç±»åœ¨3.1ä¸­å¼•å…¥ã€‚</p>
<p>ã€€ã€€ä»¥ä¸‹ä¸¤æ®µä»£ç å®ç°åŒæ ·çš„æ•ˆæœï¼šã€€</p>
<div class="cnblogs_code"><br><pre>PropertyValuesHolder pvhX = PropertyValuesHolder.ofFloat(â€œxâ€, 50f);<br>PropertyValuesHolder pvhY = PropertyValuesHolder.ofFloat(â€œyâ€, 100f);<br>ObjectAnimator.ofPropertyValuesHolder(myView, pvhX, pvyY).start();</pre><br></div><br><div class="cnblogs_code"><br><pre>myView.animate().x(50f).y(100f);</pre><br></div>

<p>&nbsp;</p>
<p>ä½œè€…ï¼šAngelDevil<br>å‡ºå¤„ï¼šwww.cnblogs.com/angeldevil</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> animator </tag>
            
            <tag> animation </tag>
            
            <tag> property animation </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]AndroidBucketå¢åŠ ç¢ç‰‡SubLayoutåŠŸèƒ½åŠAISubLayoutçš„æ³¨è§£æ”¯æŒ]]></title>
      <url>/2014/05/05/Android-AndroidBucket%E5%A2%9E%E5%8A%A0%E7%A2%8E%E7%89%87SubLayout%E5%8A%9F%E8%83%BD%E5%8F%8AAISubLayout%E7%9A%84%E6%B3%A8%E8%A7%A3%E6%94%AF%E6%8C%81/</url>
      <content type="html"><![CDATA[<p>ä¹‹å‰å†™è¿‡ä¸€ç¯‡åšå®¢ï¼Œæ˜¯ä½¿ç”¨Fragmentæ¥å®ç°TabHostçš„æ•ˆæœï¼Œå¹¶ä¸”æ¨¡æ‹ŸTabHostçš„åˆ‡æ¢å„ä¸ªfragmentç”Ÿå‘½å‘¨æœŸçš„è°ƒç”¨ï¼Œè§<a href="http://www.cnblogs.com/tiantianbyconan/p/3360938.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/3360938.html</a></p>
<p>ä½†æ˜¯å¦‚æœè¦å®ç°çš„æ•ˆæœæ˜¯ä¸¤çº§çš„Tabï¼Œæ¯”å¦‚åœ¨ç¬¬ä¸€çº§tabä¸­åˆæœ‰ä¸‰ä¸ªå­Tabåˆ‡æ¢ä¸åŒçš„å¸ƒå±€ï¼Œ</p>
<p>ç›¸å½“äºåœ¨Fragmentä¸­åµŒå¥—æ¥Fragmentï¼Œè¿™ä¸ªæ€ä¹ˆå®ç°ï¼Ÿ</p>
<p>ä¹Ÿæœ‰ä¸ªå®˜æ–¹çš„å®ç°æ–¹æ³•ï¼Œé€šè¿‡ä½¿ç”¨<span>android-support-v13.jaråŒ…ä¸­çš„<span>getChildFragmentManageræ–¹æ³•æ¥è·å–ä¸€ä¸ªManagerã€‚</span></span></p>
<p>è¿™é‡Œå¸¦æ¥æˆ‘å†™çš„ä¸€ä¸ªæ–°çš„æ–¹æ¡ˆï¼Œä½¿ç”¨SubLayoutæ¥å®ç°ã€‚</p>
<p>ç›¸å…³æºç ï¼š<a href="https://github.com/wangjiegulu/AndroidBucket/tree/master/src/com/wangjie/androidbucket/customviews/sublayout" target="_blank" rel="noopener">https://github.com/wangjiegulu/AndroidBucket/tree/master/src/com/wangjie/androidbucket/customviews/sublayout</a></p>
<p>ä¸‹é¢ä½¿ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´ä¸‹ä½¿ç”¨æ–¹æ³•ï¼Œå…ˆçœ‹ä¸‹æœ€åçš„æ•ˆæœï¼ˆé¡¹ç›®ä½¿ç”¨äº†æˆ‘çš„å¼€æº<strong><a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">AndroidBucket</a></strong>å’Œ<strong><a href="https://github.com/wangjiegulu/androidInject" target="_blank" rel="noopener">AndroidInject</a>&nbsp;è¯·å…ˆæ·»åŠ ä¾èµ–é¡¹ç›®ï¼Œæ¬¢è¿starï¼fork</strong>ï¼‰ï¼š</p>
<p><img src="http://images.cnitblog.com/i/378300/201405/051955327296296.png" alt=""></p>
<p>æ•ˆæœè·Ÿä»¥å‰çš„ä¾‹å­å¤§åŒå°å¼‚ï¼Œç‚¹å‡»ç¬¬ä¸€ä¸ªtabä¸Šçš„TextViewï¼Œç„¶åToastæç¤ºEditTextä¸Šçš„ä¿¡æ¯ï¼Œä½†æ˜¯ä½¿ç”¨æ–¹å¼å´æ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<p>å¤§ä½“çš„æ€è·¯æ˜¯åœ¨MainActivityå¸ƒå±€ä¸­å¢åŠ ä¸€ä¸ªFrameLayoutï¼Œç„¶ååœ¨åˆ‡æ¢è¿‡ç¨‹ä¸­ä¸åœçš„ç”¨ç›¸åº”çš„å¸ƒå±€å»æ›¿æ¢FrameLayoutä¸­ã€‚</p>
<p>main.xmlå¸ƒå±€å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><br><span style="color: #008080;"> 3</span> <span style="color: #ff0000;">              android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><br><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">              android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">              android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;"> 6</span>         <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">FrameLayout<br></span><span style="color: #008080;"> 9</span>             <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/main_content_viewâ€</span><br><span style="color: #008080;">10</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">11</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€0dpâ€</span><br><span style="color: #008080;">12</span> <span style="color: #ff0000;">            android:layout_weight</span><span style="color: #0000ff;">=â€1.0â€</span><br><span style="color: #008080;">13</span>             <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioGroup<br></span><span style="color: #008080;">16</span>             <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/main_tabs_rgâ€</span><br><span style="color: #008080;">17</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;">18</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€65dpâ€</span><br><span style="color: #008080;">19</span> <span style="color: #ff0000;">            android:background</span><span style="color: #0000ff;">=â€#aabbccâ€</span><br><span style="color: #008080;">20</span> <span style="color: #ff0000;">            android:gravity</span><span style="color: #0000ff;">=â€center_verticalâ€</span><br><span style="color: #008080;">21</span> <span style="color: #ff0000;">            android:orientation</span><span style="color: #0000ff;">=â€horizontalâ€</span> <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;">24</span>                 <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/main_tab_a_rbâ€</span><br><span style="color: #008080;">25</span> <span style="color: #ff0000;">                style</span><span style="color: #0000ff;">=â€@style/tab_item_backgroundâ€</span><br><span style="color: #008080;">26</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/ic_launcherâ€</span><br><span style="color: #008080;">27</span> <span style="color: #ff0000;">                android:paddingTop</span><span style="color: #0000ff;">=â€7dpâ€</span><br><span style="color: #008080;">28</span> <span style="color: #ff0000;">                android:textSize</span><span style="color: #0000ff;">=â€13spâ€</span><br><span style="color: #008080;">29</span> <span style="color: #ff0000;">                android:checked</span><span style="color: #0000ff;">=â€trueâ€</span><br><span style="color: #008080;">30</span>                 <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">31</span><br><span style="color: #008080;">32</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;">33</span>                 <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/main_tab_b_rbâ€</span><br><span style="color: #008080;">34</span> <span style="color: #ff0000;">                style</span><span style="color: #0000ff;">=â€@style/tab_item_backgroundâ€</span><br><span style="color: #008080;">35</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/ic_launcherâ€</span><br><span style="color: #008080;">36</span> <span style="color: #ff0000;">                android:paddingTop</span><span style="color: #0000ff;">=â€7dpâ€</span><br><span style="color: #008080;">37</span> <span style="color: #ff0000;">                android:textSize</span><span style="color: #0000ff;">=â€13spâ€</span><br><span style="color: #008080;">38</span>                 <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">39</span><br><span style="color: #008080;">40</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;">41</span>                 <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/main_tab_c_rbâ€</span><br><span style="color: #008080;">42</span> <span style="color: #ff0000;">                style</span><span style="color: #0000ff;">=â€@style/tab_item_backgroundâ€</span><br><span style="color: #008080;">43</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/ic_launcherâ€</span><br><span style="color: #008080;">44</span> <span style="color: #ff0000;">                android:paddingTop</span><span style="color: #0000ff;">=â€7dpâ€</span><br><span style="color: #008080;">45</span> <span style="color: #ff0000;">                android:textSize</span><span style="color: #0000ff;">=â€13spâ€</span><br><span style="color: #008080;">46</span>                 <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">47</span><br><span style="color: #008080;">48</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">RadioGroup</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">49</span><br><span style="color: #008080;">50</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>å¸ƒå±€å¾ˆç®€å•ï¼Œä¸€ä¸ªFrameLayoutç”¨äºå­˜æ”¾ä¸åŒç•Œé¢çš„å¸ƒå±€ï¼Œ3ä¸ªRadioButtonè¡¨ç¤ºä¸‹é¢çš„æ¯ä¸€é¡¹TabæŒ‰é’®ã€‚</p>
<p>åœ¨MainActivityä¸­ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #000000;">@AILayout(R.layout.main)<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> AIActivity {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = MainActivity.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br><br>    @AIView(R.id.main_content_view)<br>    ViewGroup contentView;<br><br>    @AIView(R.id.main_tabs_rg)<br>    RadioGroup rg;<br><br>    SubLayoutManager sbManager;<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br><br>        sbManager </span>= <span style="color: #0000ff;">new</span> SubLayoutManager&lt;SubLayout&gt;(context, contentView, TabASubLayout.<span style="color: #0000ff;">class</span>, TabBSubLayout.<span style="color: #0000ff;">class</span>, TabCSubLayout.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br><br>        sbManager.setSwitchListener(</span><span style="color: #0000ff;">new</span> SubLayoutManager.LayoutSwitchListener&lt;SubLayout&gt;<span style="color: #000000;">() {<br>            @Override<br>            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> switchSelf(SubLayout subLayout, <span style="color: #0000ff;">int</span><span style="color: #000000;"> position) {<br>                Logger.d(TAG, </span>â€œ[switch listener]switchSelf, subLayout: â€œ + subLayout + â€œ, position: â€œ +<span style="color: #000000;"> position);<br>            }<br><br>            @Override<br>            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> switchCompleted(SubLayout subLayout, <span style="color: #0000ff;">int</span><span style="color: #000000;"> position) {<br>                Logger.d(TAG, </span>â€œ[switch listener]switchCompleted, subLayout: â€œ + subLayout + â€œ, position: â€œ +<span style="color: #000000;"> position);<br>            }<br>        });<br><br>        rg.setOnCheckedChangeListener(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> RadioGroup.OnCheckedChangeListener() {<br>            @Override<br>            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCheckedChanged(RadioGroup radioGroup, <span style="color: #0000ff;">int</span><span style="color: #000000;"> i) {<br>                </span><span style="color: #0000ff;">int</span> index = -1<span style="color: #000000;">;<br>                </span><span style="color: #0000ff;">switch</span><span style="color: #000000;">(i){<br>                    </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.main_tab_a_rb:<br>                        index </span>= 0<span style="color: #000000;">;<br>                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br><br>                    </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.main_tab_b_rb:<br>                        index </span>= 1<span style="color: #000000;">;<br>                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br><br>                    </span><span style="color: #0000ff;">case</span><span style="color: #000000;"> R.id.main_tab_c_rb:<br>                        index </span>= 2<span style="color: #000000;">;<br>                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br>                }<br>                </span><span style="color: #0000ff;">if</span>(index &lt; 0 || index &gt;=<span style="color: #000000;"> sbManager.getSubLayoutSize()){<br>                    </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;<br>                }<br>                sbManager.switchLayout(index);<br>            }<br>        });<br><br>        sbManager.switchLayout(</span>0); <span style="color: #008000;">//</span><span style="color: #008000;"> é»˜è®¤åˆ‡æ¢ç¬¬ä¸€é¡µ</span><br><span style="color: #000000;"><br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDestroy() {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.onDestroy();<br>        sbManager.destoryClear();<br>        sbManager </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br><br>    }<br><br>}</span></pre><br></div>

<p>ä¸Šé¢çš„SubLayoutç›¸å½“äºä¸€ä¸ªFragmentï¼ŒSubLayoutManagerç”¨äºç®¡ç†å¤šä¸ªSubLayoutä¹‹é—´çš„åˆ‡æ¢ã€‚SubLayoutManagerå¯ä»¥é€šè¿‡newè·å–ã€‚</p>
<p>å…¶ä¸­æ„é€ æ–¹æ³•ä¸­ï¼š</p>
<p>public SubLayoutManager(Context context, ViewGroup contentView, Class&lt;? extends T&gt;â€¦ slszzs) {</p>
<p>å‚æ•°äºŒï¼šcontentViewè¡¨ç¤ºåœ¨MainActivityä¸­é¢„ç•™ç»™SubLayoutæ˜¾ç¤ºçš„FrameLayoutã€‚</p>
<p>å‚æ•°ä¸‰ï¼šæ˜¯ä¸ªå¯å˜é•¿å‚æ•°ï¼Œå¯ä»¥åœ¨åé¢ï¼ˆæœ‰åºï¼‰è¿½åŠ æ‰€æœ‰éœ€è¦åˆ‡æ¢çš„SubLayoutçš„Classå¯¹è±¡ã€‚</p>
<p>ç¬¬ä¸€æ¬¡åˆå§‹åŒ–åå„ä¸ªSubLayoutå¯¹è±¡ä¸ä¼šé©¬ä¸Šç”Ÿæˆï¼Œåªä¼šåœ¨åˆ‡æ¢åˆ°æ”¹é¡µé¢æ—¶æ‰ä¼šç”Ÿæˆè¯¥å¯¹è±¡ï¼Œä¼šæ‰§è¡ŒSubLayoutçš„initLayout()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼ˆç±»ä¼¼onCreate()æ–¹æ³•ï¼‰</p>
<p>éœ€è¦åˆ‡æ¢é¡µé¢æ—¶åªéœ€è¦æ‰§è¡ŒSubLayoutManagerçš„switchLayout()æ–¹æ³•ï¼Œä¼ å…¥SubLayoutçš„positionå°±å¯ä»¥äº†ï¼Œè¿™ä¸ªpositionè·Ÿå‚æ•°ä¸‰çš„é¡ºåºä¸€è‡´ã€‚</p>
<p>&nbsp;</p>
<p>æ¥ä¸‹æ¥çœ‹ä¸‹å‡ ä¸ªSubLayoutæ˜¯æ€ä¹ˆå»å®ç°çš„ï¼Œå› ä¸ºä¸‰ä¸ªSubLayoutå¤§è‡´ç›¸åŒï¼Œæ‰€ä»¥åªåˆ†æä¸€ä¸ªå°±å¯ä»¥äº†ï¼š</p>
<p>TabASubLayoutä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">@AILayout(R.layout.tab_a)<br></span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TabASubLayout <span style="color: #0000ff;">extends</span><span style="color: #000000;"> AISubLayout {<br></span><span style="color: #008080;"> 3</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = TabASubLayout.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span><br><span style="color: #008080;"> 6</span> <span style="color: #008000;">//</span><span style="color: #008000;">    @AIView(R.id.tab_a_tv)<br></span><span style="color: #008080;"> 7</span> <span style="color: #008000;">//</span><span style="color: #008000;">    TextView tv;</span><br><span style="color: #008080;"> 8</span> <span style="color: #000000;">    @AIView(R.id.tab_a_et)<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">    EditText et;<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> TabASubLayout(Context context) {<br></span><span style="color: #008080;">12</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context);<br></span><span style="color: #008080;">13</span> <span style="color: #008000;">//</span><span style="color: #008000;">        setContentView(R.layout.tab_a);</span><br><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">18</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> initLayout() {<br></span><span style="color: #008080;">19</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.initLayout();<br></span><span style="color: #008080;">20</span>         Logger.d(TAG, â€œinitLayoutâ€¦â€<span style="color: #000000;">);<br></span><span style="color: #008080;">21</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> <span style="color: #000000;">    @AIClick({R.id.tab_a_tv})<br></span><span style="color: #008080;">24</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClickCallbackSample(View view) {<br></span><span style="color: #008080;">25</span>         Toast.makeText(context, â€œclicked: â€œ + ((TextView)view).getText() + â€œ, â€œ +<span style="color: #000000;"> et.getText(), Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">26</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">27</span><br><span style="color: #008080;">28</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">29</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onResume() {<br></span><span style="color: #008080;">30</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onResume();<br></span><span style="color: #008080;">31</span>         Logger.d(TAG, â€œonResumeâ€¦â€<span style="color: #000000;">);<br></span><span style="color: #008080;">32</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">33</span><br><span style="color: #008080;">34</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">35</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onPause() {<br></span><span style="color: #008080;">36</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onPause();<br></span><span style="color: #008080;">37</span>         Logger.d(TAG, â€œonPauseâ€¦â€<span style="color: #000000;">);<br></span><span style="color: #008080;">38</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">39</span><br><span style="color: #008080;">40</span> }</pre><br></div>

<p>ä»£ç å¾ˆç®€å•ï¼Œç»§æ‰¿AISubLayoutå³å¯ï¼ŒAISubLayoutæ˜¯AndroidInjectä¸­AndroidBucketçš„å­ç±»ï¼Œå®ç°äº†SubLayoutçš„æ³¨è§£çš„æ”¯æŒã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥ç»§æ‰¿SubLayoutï¼Œè¿™æ ·çš„è¯å°±ä¸èƒ½ä½¿ç”¨æ³¨è§£äº†ï¼Œçœ‹ä¸Šé¢çš„è¢«æ³¨é‡Šçš„ä»£ç ï¼Œå¯ä»¥é€šè¿‡setContentViewæ¥è®¾ç½®å¯¹åº”çš„å¸ƒå±€ï¼Œå¯ä»¥é€šè¿‡findViewByIdæ¥è·å–æ§ä»¶å¯¹è±¡ã€‚</p>
<p>å®ƒä¹Ÿæœ‰onResumeå’ŒonPauseæ–¹æ³•ï¼Œå½“å‰é¡µAè¢«åˆ‡æ¢åˆ°Bçš„è¯ä¼šè°ƒç”¨Açš„onPauseï¼Œç„¶åè°ƒç”¨Bçš„onResumeï¼ˆå¦‚æœä¹‹å‰Bæ²¡æœ‰è¢«åˆå§‹åŒ–è¿‡ï¼Œåˆ™å…ˆè°ƒç”¨initLayoutå†è°ƒç”¨onResumeæ–¹æ³•ï¼‰</p>
<p>ä¸‹é¢æ¥çœ‹çœ‹logæ‰“å°çš„æ—¥å¿—ï¼š</p>
<p>&nbsp;</p>
<p>// ä»¥ä¸‹ä¸ºå¯åŠ¨åº”ç”¨ï¼Œé»˜è®¤åŠ è½½TabA</p>
<p><em>05-05 08:22:32.216 1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• â€”â€“switch startâ€”â€”â€”â€”â€”â€”â€”â€“<br>05-05 08:22:32.216    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• switch beforeâ€¦â€¦â€¦: [DelayObj{clazz=class com.wangjie.sublayouttest.TabASubLayout, delayObj=null}, DelayObj{clazz=class com.wangjie.sublayouttest.TabBSubLayout, delayObj=null}, DelayObj{clazz=class com.wangjie.sublayouttest.TabCSubLayout, delayObj=null}]<br>05-05 08:22:32.336    1086-1086/com.wangjie.sublayouttest D/TabASubLayoutï¹• initLayoutâ€¦<br>05-05 08:22:32.336    1086-1086/com.wangjie.sublayouttest D/TabASubLayoutï¹• onResumeâ€¦<br>05-05 08:22:32.336    1086-1086/com.wangjie.sublayouttest D/MainActivityï¹• [switch listener]switchCompleted, subLayout: com.wangjie.sublayouttest.TabASubLayout@b4dff088, position: 0<br>05-05 08:22:32.336    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• switch afterâ€¦â€¦â€¦: [DelayObj{clazz=class com.wangjie.sublayouttest.TabASubLayout, delayObj=com.wangjie.sublayouttest.TabASubLayout@b4dff088}, DelayObj{clazz=class com.wangjie.sublayouttest.TabBSubLayout, delayObj=null}, DelayObj{clazz=class com.wangjie.sublayouttest.TabCSubLayout, delayObj=null}]<br>05-05 08:22:32.336    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• â€”â€“switch endâ€”â€”â€”â€”â€”â€”â€”â€“</em></p>
<p><em><br>// TabAåˆ‡æ¢åˆ°TabB<br>05-05 08:22:37.926    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• â€”â€“switch startâ€”â€”â€”â€”â€”â€”â€”â€“<br>05-05 08:22:37.926    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• switch beforeâ€¦â€¦â€¦: [DelayObj{clazz=class com.wangjie.sublayouttest.TabASubLayout, delayObj=com.wangjie.sublayouttest.TabASubLayout@b4dff088}, DelayObj{clazz=class com.wangjie.sublayouttest.TabBSubLayout, delayObj=null}, DelayObj{clazz=class com.wangjie.sublayouttest.TabCSubLayout, delayObj=null}]<br>05-05 08:22:37.946    1086-1086/com.wangjie.sublayouttest D/TabASubLayoutï¹• onPauseâ€¦<br>05-05 08:22:37.986    1086-1086/com.wangjie.sublayouttest D/TabBSubLayoutï¹• initLayoutâ€¦<br>05-05 08:22:37.996    1086-1086/com.wangjie.sublayouttest D/TabBSubLayoutï¹• onResumeâ€¦<br>05-05 08:22:37.996    1086-1086/com.wangjie.sublayouttest D/MainActivityï¹• [switch listener]switchCompleted, subLayout: com.wangjie.sublayouttest.TabBSubLayout@b4de1d80, position: 1<br>05-05 08:22:37.996    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• switch afterâ€¦â€¦â€¦: [DelayObj{clazz=class com.wangjie.sublayouttest.TabASubLayout, delayObj=com.wangjie.sublayouttest.TabASubLayout@b4dff088}, DelayObj{clazz=class com.wangjie.sublayouttest.TabBSubLayout, delayObj=com.wangjie.sublayouttest.TabBSubLayout@b4de1d80}, DelayObj{clazz=class com.wangjie.sublayouttest.TabCSubLayout, delayObj=null}]<br>05-05 08:22:37.996    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• â€”â€“switch endâ€”â€”â€”â€”â€”â€”â€”â€“</em></p>
<p><em><br>// TabBåˆ‡æ¢åˆ°TabC<br>05-05 08:22:41.486    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• â€”â€“switch startâ€”â€”â€”â€”â€”â€”â€”â€“<br>05-05 08:22:41.486    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• switch beforeâ€¦â€¦â€¦: [DelayObj{clazz=class com.wangjie.sublayouttest.TabASubLayout, delayObj=com.wangjie.sublayouttest.TabASubLayout@b4dff088}, DelayObj{clazz=class com.wangjie.sublayouttest.TabBSubLayout, delayObj=com.wangjie.sublayouttest.TabBSubLayout@b4de1d80}, DelayObj{clazz=class com.wangjie.sublayouttest.TabCSubLayout, delayObj=null}]<br>05-05 08:22:41.496    1086-1086/com.wangjie.sublayouttest D/TabBSubLayoutï¹• onPauseâ€¦<br>05-05 08:22:41.516    1086-1086/com.wangjie.sublayouttest D/TabCSubLayoutï¹• initLayoutâ€¦<br>05-05 08:22:41.516    1086-1086/com.wangjie.sublayouttest D/TabCSubLayoutï¹• onResumeâ€¦<br>05-05 08:22:41.516    1086-1086/com.wangjie.sublayouttest D/MainActivityï¹• [switch listener]switchCompleted, subLayout: com.wangjie.sublayouttest.TabCSubLayout@b4e17840, position: 2<br>05-05 08:22:41.516    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• switch afterâ€¦â€¦â€¦: [DelayObj{clazz=class com.wangjie.sublayouttest.TabASubLayout, delayObj=com.wangjie.sublayouttest.TabASubLayout@b4dff088}, DelayObj{clazz=class com.wangjie.sublayouttest.TabBSubLayout, delayObj=com.wangjie.sublayouttest.TabBSubLayout@b4de1d80}, DelayObj{clazz=class com.wangjie.sublayouttest.TabCSubLayout, delayObj=com.wangjie.sublayouttest.TabCSubLayout@b4e17840}]<br>05-05 08:22:41.526    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• â€”â€“switch endâ€”â€”â€”â€”â€”â€”â€”â€“</em></p>
<p>&nbsp;</p>
<p>_// TabCåˆ‡æ¢åˆ°TabA<br>05-05 08:22:44.086    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• â€”â€“switch startâ€”â€”â€”â€”â€”â€”â€”â€“<br>05-05 08:22:44.086    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• switch beforeâ€¦â€¦â€¦: [DelayObj{clazz=class com.wangjie.sublayouttest.TabASubLayout, delayObj=com.wangjie.sublayouttest.TabASubLayout@b4dff088}, DelayObj{clazz=class com.wangjie.sublayouttest.TabBSubLayout, delayObj=com.wangjie.sublayouttest.TabBSubLayout@b4de1d80}, DelayObj{clazz=class com.wangjie.sublayouttest.TabCSubLayout, delayObj=com.wangjie.sublayouttest.TabCSubLayout@b4e17840}]<br>05-05 08:22:44.086    1086-1086/com.wangjie.sublayouttest D/TabCSubLayoutï¹• onPauseâ€¦<br>05-05 08:22:44.136    1086-1086/com.wangjie.sublayouttest D/TabASubLayoutï¹• onResumeâ€¦<br>05-05 08:22:44.136    1086-1086/com.wangjie.sublayouttest D/MainActivityï¹• [switch listener]switchCompleted, subLayout: com.wangjie.sublayouttest.TabASubLayout@b4dff088, position: 0<br>05-05 08:22:44.136    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• switch afterâ€¦â€¦â€¦: [DelayObj{clazz=class com.wangjie.sublayouttest.TabASubLayout, delayObj=com.wangjie.sublayouttest.TabASubLayout@b4dff088}, DelayObj{clazz=class com.wangjie.sublayouttest.TabBSubLayout, delayObj=com.wangjie.sublayouttest.TabBSubLayout@b4de1d80}, DelayObj{clazz=class com.wangjie.sublayouttest.TabCSubLayout, delayObj=com.wangjie.sublayouttest.TabCSubLayout@b4e17840}]<br>05-05 08:22:44.136    1086-1086/com.wangjie.sublayouttest D/SubLayoutManagerï¹• â€”â€“switch endâ€”â€”â€”â€”â€”â€”â€”â€“</p>
<p>_</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> library </tag>
            
            <tag> annotations </tag>
            
            <tag> android bucket </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å…³äºAndroid çš„å†…å­˜æ³„éœ²åŠåˆ†æ]]></title>
      <url>/2014/04/22/%E5%85%B3%E4%BA%8EAndroid-%E7%9A%84%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E5%8F%8A%E5%88%86%E6%9E%90/</url>
      <content type="html"><![CDATA[<p>ä¸€ã€ Androidçš„å†…å­˜æœºåˆ¶<br>Androidçš„ç¨‹åºç”±Javaè¯­è¨€ç¼–å†™ï¼Œæ‰€ä»¥Androidçš„å†…å­˜ç®¡ç†ä¸Javaçš„å†…å­˜ç®¡ç†ç›¸ä¼¼ã€‚ç¨‹åºå‘˜é€šè¿‡newä¸ºå¯¹è±¡åˆ†é…å†…å­˜ï¼Œæ‰€æœ‰å¯¹è±¡åœ¨javaå †å†…åˆ†é…ç©ºé—´ï¼›ç„¶è€Œå¯¹è±¡çš„é‡Šæ”¾æ˜¯ç”±åƒåœ¾å›æ”¶å™¨æ¥å®Œæˆçš„.<br>é‚£ä¹ˆGCæ€ä¹ˆèƒ½å¤Ÿç¡®è®¤æŸä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯å·²ç»è¢«åºŸå¼ƒäº†å‘¢ï¼ŸJavaé‡‡ç”¨äº†æœ‰å‘å›¾çš„åŸç†ã€‚Javaå°†å¼•ç”¨å…³ç³»è€ƒè™‘ä¸ºå›¾çš„æœ‰å‘è¾¹ï¼Œæœ‰å‘è¾¹ä»å¼•ç”¨è€…æŒ‡å‘å¼•ç”¨å¯¹è±¡ã€‚çº¿ç¨‹å¯¹è±¡å¯ä»¥ä½œä¸ºæœ‰å‘å›¾çš„èµ·å§‹é¡¶ç‚¹ï¼Œè¯¥å›¾å°±æ˜¯ä»èµ·å§‹é¡¶ç‚¹å¼€å§‹çš„ä¸€æ£µæ ‘ï¼Œæ ¹é¡¶ç‚¹å¯ä»¥åˆ°è¾¾çš„å¯¹è±¡éƒ½æ˜¯æœ‰æ•ˆå¯¹è±¡ï¼ŒGCä¸ä¼šå›æ”¶è¿™äº›å¯¹è±¡ã€‚å¦‚æœæŸä¸ªå¯¹è±¡ (è¿é€šå­å›¾)ä¸è¿™ä¸ªæ ¹é¡¶ç‚¹ä¸å¯è¾¾(æ³¨æ„ï¼Œè¯¥å›¾ä¸ºæœ‰å‘å›¾)ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¤ä¸ºè¿™ä¸ª(è¿™äº›)å¯¹è±¡ä¸å†è¢«å¼•ç”¨ï¼Œå¯ä»¥è¢«GCå›æ”¶ã€‚</p>
<p>äºŒã€Androidçš„å†…å­˜æº¢å‡º</p>
<p>1ã€å†…å­˜æ³„éœ²å¯¼è‡´</p>
<p>ç”±äºæˆ‘ä»¬ç¨‹åºçš„å¤±è¯¯ï¼Œé•¿æœŸä¿æŒæŸäº›èµ„æºï¼ˆå¦‚Contextï¼‰çš„å¼•ç”¨ï¼Œé€ æˆå†…å­˜æ³„éœ²ï¼Œèµ„æºé€ æˆå¾—ä¸åˆ°é‡Šæ”¾ã€‚&nbsp;</p>
<p>Android ä¸­å¸¸è§å°±æ˜¯Activity è¢«å¼•ç”¨æ²¡æœ‰åœ¨è°ƒç”¨finishä¹‹åå´æ²¡æœ‰é‡Šæ”¾ï¼Œç¬¬äºŒæ¬¡æ‰“å¼€activity åˆé‡æ–°åˆ›å»ºï¼Œè¿™æ ·çš„å†…å­˜æ³„éœ²åˆ™ä¼šå¯¼è‡´å†…å­˜çš„æº¢å‡ºã€‚<br>2ã€å ç”¨å†…å­˜è¾ƒå¤šçš„å¯¹è±¡</p>
<p>&nbsp;ä¿å­˜äº†å¤šä¸ªè€—ç”¨å†…å­˜è¿‡å¤§çš„å¯¹è±¡ï¼ˆå¦‚Bitmapï¼‰æˆ–åŠ è½½å•ä¸ªè¶…å¤§çš„å›¾ç‰‡ï¼Œé€ æˆå†…å­˜è¶…å‡ºé™åˆ¶ã€‚</p>
<p>ä¸‰ã€å¸¸è§çš„å†…å­˜æ³„æ¼<br><span>1.ä¸‡æ¶çš„static</span><br>&nbsp; staticæ˜¯Javaä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œå½“ç”¨å®ƒæ¥ä¿®é¥°æˆå‘˜å˜é‡æ—¶ï¼Œé‚£ä¹ˆè¯¥å˜é‡å°±å±äºè¯¥ç±»ï¼Œè€Œä¸æ˜¯è¯¥ç±»çš„å®ä¾‹ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; private static Activity mContext;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //çœç•¥&nbsp;</p>
<p>&nbsp;å¦‚ä½•æ‰èƒ½æœ‰æ•ˆçš„é¿å…è¿™ç§å¼•ç”¨çš„å‘ç”Ÿå‘¢ï¼Ÿ</p>
<p>&nbsp;&nbsp;&nbsp; ç¬¬ä¸€ï¼Œåº”è¯¥å°½é‡é¿å…staticæˆå‘˜å˜é‡å¼•ç”¨èµ„æºè€—è´¹è¿‡å¤šçš„å®ä¾‹ï¼Œæ¯”å¦‚Contextã€‚</p>
<p>&nbsp;&nbsp;&nbsp; ç¬¬äºŒã€Contextå°½é‡ä½¿ç”¨Application Contextï¼Œå› ä¸ºApplicationçš„Contextçš„ç”Ÿå‘½å‘¨æœŸæ¯”è¾ƒé•¿ï¼Œå¼•ç”¨å®ƒä¸ä¼šå‡ºç°å†…å­˜æ³„éœ²çš„é—®é¢˜ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; ç¬¬ä¸‰ã€ä½¿ç”¨WeakReferenceä»£æ›¿å¼ºå¼•ç”¨ã€‚æ¯”å¦‚å¯ä»¥ä½¿ç”¨WeakReference&lt;Context&gt; mContextRef;</p>
<p><span>2.çº¿ç¨‹æƒ¹çš„ç¥¸</span><br>çº¿ç¨‹ä¹Ÿæ˜¯é€ æˆå†…å­˜æ³„éœ²çš„ä¸€ä¸ªé‡è¦çš„æºå¤´ã€‚çº¿ç¨‹äº§ç”Ÿå†…å­˜æ³„éœ²çš„ä¸»è¦åŸå› åœ¨äºçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçš„ä¸å¯æ§ã€‚æˆ‘ä»¬æ¥è€ƒè™‘ä¸‹é¢ä¸€æ®µä»£ç ã€‚</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MyActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Activity {<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">@Override<br></span><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br></span><span style="color: #008080;"> 4</span>   <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br></span><span style="color: #008080;"> 5</span> <span style="color: #000000;">  setContentView(R.layout.main);<br></span><span style="color: #008080;"> 6</span>   <span style="color: #0000ff;">new</span><span style="color: #000000;"> MyThread().start();<br></span><span style="color: #008080;"> 7</span> <span style="color: #000000;">}<br></span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">class</span> MyThread <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Thread{<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">@Override<br></span><span style="color: #008080;">10</span>   <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> run() {<br></span><span style="color: #008080;">11</span>   <span style="color: #0000ff;">super</span><span style="color: #000000;">.run();<br></span><span style="color: #008080;">12</span>   <span style="color: #008000;">//</span><span style="color: #008000;">do somthing         </span><br><span style="color: #008080;">13</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">15</span> }  </pre><br></div>

<p><span>æˆ‘ä»¬æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå‡è®¾MyThreadçš„runå‡½æ•°æ˜¯ä¸€ä¸ªå¾ˆè´¹æ—¶çš„æ“ä½œï¼Œå½“è°ƒç”¨finishçš„æ—¶å€™Activity ä¼šé”€æ¯æ‰å—ï¼Ÿ</span></p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp;äº‹å®ä¸Šç”±äºæˆ‘ä»¬çš„çº¿ç¨‹æ˜¯Activityçš„å†…éƒ¨ç±»ï¼Œæ‰€ä»¥MyThreadä¸­ä¿å­˜äº†Activityçš„ä¸€ä¸ªå¼•ç”¨ï¼Œå½“MyThreadçš„runå‡½æ•°æ²¡æœ‰ç»“æŸæ—¶ï¼ŒMyThreadæ˜¯ä¸ä¼šè¢«é”€æ¯çš„ï¼Œå› æ­¤å®ƒæ‰€å¼•ç”¨çš„è€çš„Activityä¹Ÿä¸ä¼šè¢«é”€æ¯ï¼Œå› æ­¤å°±å‡ºç°äº†å†…å­˜æ³„éœ²çš„é—®é¢˜ã€‚</p>
<p>&nbsp;</p>
<p><span><strong>è§£å†³æ–¹æ¡ˆ</strong></span></p>
<p>&nbsp;&nbsp;&nbsp; ç¬¬ä¸€ã€å°†çº¿ç¨‹çš„å†…éƒ¨ç±»ï¼Œæ”¹ä¸ºé™æ€å†…éƒ¨ç±»ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; ç¬¬äºŒã€å¦‚æœéœ€è¦å¼•ç”¨Acitivityï¼Œä½¿ç”¨å¼±å¼•ç”¨ã€‚<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; å¦å¤–åœ¨ä½¿ç”¨handler çš„æ—¶å€™ï¼Œ å°¤å…¶ç”¨åˆ°å¾ªç¯è°ƒç”¨çš„æ—¶å€™ï¼Œåœ¨Activity é€€å‡ºçš„æ—¶å€™æ³¨æ„ç§»é™¤ã€‚å¦åˆ™ä¹Ÿä¼šå¯¼è‡´æ³„éœ²</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ThreadDemo <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Activity {<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = â€œThreadDemoâ€<span style="color: #000000;">;<br></span><span style="color: #008080;"> 3</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> count = 0<span style="color: #000000;">;<br></span><span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">private</span> Handler mHandler =  <span style="color: #0000ff;">new</span><span style="color: #000000;"> Handler();<br></span><span style="color: #008080;"> 5</span><br><span style="color: #008080;"> 6</span>     <span style="color: #0000ff;">private</span> Runnable mRunnable = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Runnable() {<br></span><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> run() {<br></span><span style="color: #008080;"> 9</span>             <span style="color: #008000;">//</span><span style="color: #008000;">ä¸ºäº†æ–¹ä¾¿ æŸ¥çœ‹ï¼Œæˆ‘ä»¬ç”¨Logæ‰“å°å‡ºæ¥   </span><br><span style="color: #008080;">10</span>             Log.e(TAG, Thread.currentThread().getName() + â€œ â€œ +<span style="color: #000000;">count);<br></span><span style="color: #008080;">11</span>             <span style="color: #008000;">//</span><span style="color: #008000;">æ¯2ç§’æ‰§è¡Œä¸€æ¬¡   </span><br><span style="color: #008080;">12</span>             mHandler.postDelayed(mRunnable, 2000<span style="color: #000000;">);<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">    };<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">16</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br></span><span style="color: #008080;">17</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br></span><span style="color: #008080;">18</span> <span style="color: #000000;">        setContentView(R.layout.main);<br></span><span style="color: #008080;">19</span>         <span style="color: #008000;">//</span><span style="color: #008000;">é€šè¿‡Handlerå¯åŠ¨çº¿ç¨‹   </span><br><span style="color: #008080;">20</span> <span style="color: #000000;">        mHandler.post(mRunnable);<br></span><span style="color: #008080;">21</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">24</span> <span style="color: #008000;">//</span><span style="color: #008000;">æ‰€ä»¥æˆ‘ä»¬åœ¨åº”ç”¨é€€å‡ºæ—¶ï¼Œè¦å°†çº¿ç¨‹é”€æ¯ï¼Œæˆ‘ä»¬åªè¦åœ¨Activityä¸­çš„ï¼ŒonDestory()æ–¹æ³•å¤„ç†ä¸€ä¸‹å°±OKäº†ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤º:</span><br><span style="color: #008080;">25</span> <span style="color: #000000;">@Override<br></span><span style="color: #008080;">26</span>   <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDestroy() {<br></span><span style="color: #008080;">27</span> <span style="color: #000000;">    mHandler.removeCallbacks(mRunnable);<br></span><span style="color: #008080;">28</span>     <span style="color: #0000ff;">super</span><span style="color: #000000;">.onDestroy();<br></span><span style="color: #008080;">29</span> <span style="color: #000000;">  }<br></span><span style="color: #008080;">30</span>  </pre><br></div>

<p><span>3.Bitmap</span><br>å¯ä»¥è¯´å‡ºç°OutOfMemoryé—®é¢˜çš„ç»å¤§å¤šæ•°äººï¼Œéƒ½æ˜¯å› ä¸ºBitmapçš„é—®é¢˜ã€‚å› ä¸ºBitmapå ç”¨çš„å†…å­˜å®åœ¨æ˜¯å¤ªå¤šäº†ï¼Œç‰¹åˆ«æ˜¯åˆ†è¾¨ç‡å¤§çš„å›¾ç‰‡ï¼Œå¦‚æœè¦æ˜¾ç¤ºå¤šå¼ é‚£é—®é¢˜å°±æ›´æ˜¾è‘—äº†ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; è§£å†³æ–¹æ¡ˆï¼š</p>
<p>&nbsp;&nbsp;&nbsp; ç¬¬ä¸€ã€åŠæ—¶çš„é”€æ¯ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; è™½ç„¶ï¼Œç³»ç»Ÿèƒ½å¤Ÿç¡®è®¤Bitmapåˆ†é…çš„å†…å­˜æœ€ç»ˆä¼šè¢«é”€æ¯ï¼Œä½†æ˜¯ç”±äºå®ƒå ç”¨çš„å†…å­˜è¿‡å¤šï¼Œæ‰€ä»¥å¾ˆå¯èƒ½ä¼šè¶…è¿‡javaå †çš„é™åˆ¶ã€‚å› æ­¤ï¼Œåœ¨ç”¨å®ŒBitmapæ—¶ï¼Œè¦åŠæ—¶çš„recycleæ‰ã€‚recycleå¹¶ä¸èƒ½ç¡®å®šç«‹å³å°±ä¼šå°†Bitmapé‡Šæ”¾æ‰ï¼Œä½†æ˜¯ä¼šç»™è™šæ‹Ÿæœºä¸€ä¸ªæš—ç¤ºï¼š&ldquo;è¯¥å›¾ç‰‡å¯ä»¥é‡Šæ”¾äº†&rdquo;ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; ç¬¬äºŒã€è®¾ç½®ä¸€å®šçš„é‡‡æ ·ç‡ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬è¦æ˜¾ç¤ºçš„åŒºåŸŸå¾ˆå°ï¼Œæ²¡æœ‰å¿…è¦å°†æ•´ä¸ªå›¾ç‰‡éƒ½åŠ è½½å‡ºæ¥ï¼Œè€Œåªéœ€è¦è®°è½½ä¸€ä¸ªç¼©å°è¿‡çš„å›¾ç‰‡ï¼Œè¿™æ—¶å€™å¯ä»¥è®¾ç½®ä¸€å®šçš„é‡‡æ ·ç‡ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¤§å¤§å‡å°å ç”¨çš„å†…å­˜ã€‚å¦‚ä¸‹é¢çš„ä»£ç ï¼š</p>
<p>private ImageView preview;&nbsp;&nbsp;</p>
<p>BitmapFactory.Options options = new BitmapFactory.Options();&nbsp;&nbsp;</p>
<p>options.inSampleSize = 2;//å›¾ç‰‡å®½é«˜éƒ½ä¸ºåŸæ¥çš„äºŒåˆ†ä¹‹ä¸€ï¼Œå³å›¾ç‰‡ä¸ºåŸæ¥çš„å››åˆ†ä¹‹ä¸€&nbsp;&nbsp;</p>
<p>Bitmap bitmap = BitmapFactory.decodeStream(cr.openInputStream(uri), null, options);&nbsp; preview.setImageBitmap(bitmap);&nbsp;</p>
<p>ç¬¬ä¸‰ã€å·§å¦™çš„è¿ç”¨è½¯å¼•ç”¨ï¼ˆSoftRefrenceï¼‰</p>
<p>&nbsp;&nbsp;&nbsp; æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨Bitmapåæ²¡æœ‰ä¿ç•™å¯¹å®ƒçš„å¼•ç”¨ï¼Œå› æ­¤å°±æ— æ³•è°ƒç”¨Recycleå‡½æ•°ã€‚è¿™æ—¶å€™å·§å¦™çš„è¿ç”¨è½¯å¼•ç”¨ï¼Œå¯ä»¥ä½¿Bitmapåœ¨å†…å­˜å¿«ä¸è¶³æ—¶å¾—åˆ°æœ‰æ•ˆçš„é‡Šæ”¾ã€‚<br>&nbsp;&nbsp;</p>
<p><span>4.è¡Œè¸ªè¯¡å¼‚çš„Cursor</span></p>
<p>&nbsp;&nbsp;&nbsp; Cursoræ˜¯AndroidæŸ¥è¯¢æ•°æ®åå¾—åˆ°çš„ä¸€ä¸ªç®¡ç†æ•°æ®é›†åˆçš„ç±»ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœæŸ¥è¯¢å¾—åˆ°çš„æ•°æ®é‡è¾ƒå°æ—¶ä¸ä¼šæœ‰å†…å­˜é—®é¢˜ï¼Œè€Œä¸”è™šæ‹Ÿæœºèƒ½å¤Ÿä¿è¯Cusoræœ€ç»ˆä¼šè¢«é‡Šæ”¾æ‰ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; ç„¶è€Œå¦‚æœCursorçš„æ•°æ®é‡ç‰¹è¡¨å¤§ï¼Œç‰¹åˆ«æ˜¯å¦‚æœé‡Œé¢æœ‰Blobä¿¡æ¯æ—¶ï¼Œåº”è¯¥ä¿è¯Cursorå ç”¨çš„å†…å­˜è¢«åŠæ—¶çš„é‡Šæ”¾æ‰ï¼Œè€Œä¸æ˜¯ç­‰å¾…GCæ¥å¤„ç†ã€‚å¹¶ä¸”Androidæ˜æ˜¾æ˜¯å€¾å‘äºç¼–ç¨‹è€…æ‰‹åŠ¨çš„å°†Cursor closeæ‰</p>
<p>&nbsp; è€Œä¸”androidæ•°æ®åº“ä¸­å¯¹Cursorèµ„æºçš„æ˜¯åˆé™åˆ¶ä¸ªæ•°çš„ï¼Œå¦‚æœä¸åŠæ—¶closeæ‰ï¼Œä¼šå¯¼è‡´åˆ«çš„åœ°æ–¹æ— æ³•è·å¾—<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><span>5.æ„é€ Adapteræ—¶ï¼Œæ²¡æœ‰ä½¿ç”¨ç¼“å­˜çš„ convertView&nbsp;</span><br>&nbsp; ä»¥æ„é€ ListViewçš„BaseAdapterä¸ºä¾‹ï¼Œåœ¨BaseAdapterä¸­æé«˜äº†æ–¹æ³•ï¼š<br>&nbsp; &nbsp;public View getView(int position, View convertView, ViewGroup parent)</p>
<p>&nbsp; AdapterView åœ¨ä½¿ç”¨Viewä¼šæœ‰ä¸€ä¸ªå¾ªç¯çš„Viewé˜Ÿåˆ—çš„ï¼ŒæŠŠä¸æ˜¾ç¤ºçš„Viewé‡æ–°æŠ•å…¥ä½¿ç”¨ï¼Œæ‰€ä»¥åœ¨<span>convertViewä¸ä¸ºç©ºçš„æ—¶å€™ï¼Œä¸è¦ç›´æ¥åˆ›å»ºæ–°çš„View</span></p>
<p>å°ç»“:</p>
<p>static:å¼•ç”¨äº†å¤§å¯¹è±¡å¦‚context</p>
<p>çº¿ç¨‹ï¼šåˆ‡å±æ—¶Activityå› ä¸ºçº¿ç¨‹å¼•ç”¨è€Œæ²¡æœ‰å¦‚æœŸè¢«é”€æ¯ï¼›handleræœ‰å…³ï¼ŒActivityæ„å¤–ç»ˆæ­¢ä½†çº¿ç¨‹è¿˜åœ¨</p>
<p>Bitmap:è¦åŠæ—¶recycle,é™ä½é‡‡æ ·ç‡</p>
<p>Cursor:è¦åŠæ—¶å…³é—­</p>
<p>Adapter:æ²¡æœ‰ä½¿ç”¨ç¼“å­˜çš„convertView</p>
<p>&nbsp;</p>
<p>å››ã€å†…å­˜æ³„æ¼è°ƒè¯•:<br>(1).å†…å­˜ç›‘æµ‹å·¥å…· DDMS â€“&gt; Heap<br>&nbsp;ç”¨ Heapç›‘æµ‹åº”ç”¨è¿›ç¨‹ä½¿ç”¨å†…å­˜æƒ…å†µçš„æ­¥éª¤å¦‚ä¸‹ï¼š<br>&nbsp; &nbsp; &nbsp; 1. åˆ‡æ¢åˆ°DDMSé€è§†å›¾ï¼Œå¹¶ç¡®è®¤Devicesè§†å›¾ã€Heapè§†å›¾éƒ½æ˜¯æ‰“å¼€çš„ï¼›<br>&nbsp; &nbsp; &nbsp; 2. æ­£å¸¸ä¸æ‰‹æœºé“¾æ¥æˆåŠŸåï¼Œåœ¨DDMSçš„Devicesè§†å›¾ä¸­å°†ä¼šæ˜¾ç¤ºæ‰‹æœºè®¾å¤‡çš„åºåˆ—å·ï¼Œä»¥åŠè®¾å¤‡ä¸­æ­£åœ¨è¿è¡Œçš„éƒ¨åˆ†è¿›ç¨‹ä¿¡æ¯ï¼›<br>&nbsp; &nbsp; &nbsp; 3. ç‚¹å‡»é€‰ä¸­æƒ³è¦ç›‘æµ‹çš„è¿›ç¨‹<br>&nbsp; &nbsp; &nbsp; 4. ç‚¹å‡»é€‰ä¸­Devicesè§†å›¾ç•Œé¢ä¸­æœ€ä¸Šæ–¹ä¸€æ’å›¾æ ‡ä¸­çš„&ldquo;Update Heap&rdquo;å›¾æ ‡ï¼›<br>&nbsp; &nbsp; &nbsp; 5. ç‚¹å‡»Heapè§†å›¾ä¸­çš„&ldquo;Cause GC&rdquo;æŒ‰é’®ï¼›<br>&nbsp; &nbsp; &nbsp; 6. æ­¤æ—¶åœ¨Heapè§†å›¾ä¸­å°±ä¼šçœ‹åˆ°å½“å‰é€‰ä¸­çš„è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨é‡çš„è¯¦ç»†æƒ…å†µã€‚<br>&nbsp; &nbsp;Heapè§†å›¾ç•Œé¢ä¼šå®šæ—¶åˆ·æ–°ï¼Œåœ¨å¯¹åº”ç”¨çš„ä¸æ–­çš„æ“ä½œè¿‡ç¨‹ä¸­å°±å¯ä»¥çœ‹åˆ°å†…å­˜ä½¿ç”¨çš„å˜åŒ–ï¼›<br>&nbsp; å¦‚ä½•æ‰èƒ½çŸ¥é“æˆ‘ä»¬çš„ç¨‹åºæ˜¯å¦æœ‰å†…å­˜æ³„æ¼çš„å¯èƒ½æ€§å‘¢ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªå€¼ï¼šHeapè§†å›¾ä¸­éƒ¨æœ‰ä¸€ä¸ªTypeå«åšdata objectï¼Œå³æ•°æ®å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç¨‹åºä¸­å¤§é‡å­˜åœ¨çš„ç±»ç±»å‹çš„å¯¹è±¡ã€‚åœ¨data objectä¸€è¡Œä¸­æœ‰ä¸€åˆ—æ˜¯&ldquo;Total Size&rdquo;ï¼Œå…¶å€¼å°±æ˜¯å½“å‰è¿›ç¨‹ä¸­æ‰€æœ‰Javaæ•°æ®å¯¹è±¡çš„å†…å­˜æ€»é‡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå€¼çš„å¤§å°å†³å®šäº†æ˜¯å¦ä¼šæœ‰å†…å­˜æ³„æ¼ã€‚å¯ä»¥è¿™æ ·åˆ¤æ–­ï¼š<br>&nbsp; &nbsp;a) ä¸æ–­çš„æ“ä½œå½“å‰åº”ç”¨ï¼ŒåŒæ—¶æ³¨æ„è§‚å¯Ÿdata objectçš„Total Sizeå€¼ï¼›<br>&nbsp; &nbsp;b) æ­£å¸¸æƒ…å†µä¸‹Total Sizeå€¼éƒ½ä¼šç¨³å®šåœ¨ä¸€ä¸ªæœ‰é™çš„èŒƒå›´å†…ï¼Œä¹Ÿå°±æ˜¯è¯´ç”±äºç¨‹åºä¸­çš„çš„ä»£ç è‰¯å¥½ï¼Œæ²¡æœ‰é€ æˆå¯¹è±¡ä¸è¢«åƒåœ¾å›æ”¶çš„æƒ…å†µï¼Œæ‰€ä»¥è¯´ &nbsp;è™½ç„¶æˆ‘ä»¬ä¸æ–­çš„æ“ä½œä¼šä¸æ–­çš„ç”Ÿæˆå¾ˆå¤šå¯¹è±¡ï¼Œè€Œåœ¨è™šæ‹Ÿæœºä¸æ–­çš„è¿›è¡ŒGCçš„è¿‡ç¨‹ä¸­ï¼Œè¿™äº›å¯¹è±¡éƒ½è¢«å›æ”¶äº†ï¼Œå†…å­˜å ç”¨é‡ä¼šä¼šè½åˆ°ä¸€ä¸ªç¨³å®šçš„æ°´å¹³ï¼›<br>&nbsp; &nbsp; c) åä¹‹å¦‚æœä»£ç ä¸­å­˜åœ¨æ²¡æœ‰é‡Šæ”¾å¯¹è±¡å¼•ç”¨çš„æƒ…å†µï¼Œåˆ™data objectçš„Total Sizeå€¼åœ¨æ¯æ¬¡GCåä¸ä¼šæœ‰æ˜æ˜¾çš„å›è½ï¼Œéšç€æ“ä½œæ¬¡æ•°çš„å¢å¤šTotal Sizeçš„å€¼ä¼šè¶Šæ¥è¶Šå¤§ï¼Œ</p>
<p><span>(2)</span><span>å†…å­˜åˆ†æå·¥å…· MAT(Memory Analyzer Tool)</span><br><span>&nbsp; è¿™é‡Œä»‹ç»ä¸€ä¸ªæå¥½çš„å†…å­˜åˆ†æå·¥å…· â€“ Memory Analyzer Tool(MAT)ã€‚</span><br><span>&nbsp;&nbsp;MATæ˜¯ä¸€ä¸ªEclipseæ’ä»¶ï¼ŒåŒæ—¶ä¹Ÿæœ‰å•ç‹¬çš„RCPå®¢æˆ·ç«¯ã€‚å®˜æ–¹ä¸‹è½½åœ°å€ã€MATä»‹ç»å’Œè¯¦ç»†çš„ä½¿ç”¨æ•™ç¨‹è¯·å‚è§ï¼š</span><a href="http://www.eclipse.org/mat" target="_blank" rel="noopener">www.eclipse.org/mat</a><span>ï¼Œåœ¨æ­¤ä¸è¿›è¡Œè¯´æ˜äº†ã€‚å¦å¤–åœ¨MATå®‰è£…åçš„å¸®åŠ©æ–‡æ¡£é‡Œä¹Ÿæœ‰å®Œå¤‡çš„ä½¿ç”¨æ•™ç¨‹ã€‚åœ¨æ­¤ä»…ä¸¾ä¾‹è¯´æ˜å…¶ä½¿ç”¨æ–¹æ³•ã€‚æˆ‘è‡ªå·±ä½¿ç”¨çš„æ˜¯MATçš„eclipseæ’ä»¶ï¼Œä½¿ç”¨æ’ä»¶è¦æ¯”RCPç¨å¾®æ–¹ä¾¿ä¸€äº›ã€‚æ’ä»¶å®‰è£…æˆåŠŸåï¼Œåˆ†ææ­¥éª¤ï¼ˆå®‰è£…æ–¹æ³•æœ‰å¤šé‡ï¼Œå¤§å®¶éšä¾¿ï¼‰</span><br><span>&nbsp;</span><br><span>&nbsp; &nbsp;(a) ç”Ÿæˆ.hprofæ–‡ä»¶</span><br><span>&nbsp;&nbsp;</span><br><span>&nbsp; &nbsp; &nbsp; 1. æ‰“å¼€eclipseå¹¶åˆ‡æ¢åˆ°DDMS</span><br><span>&nbsp; &nbsp; &nbsp; 2. ç‚¹å‡»é€‰ä¸­æƒ³è¦åˆ†æçš„åº”ç”¨çš„è¿›ç¨‹ï¼Œåœ¨Devicesè§†å›¾ä¸Šæ–¹çš„ä¸€è¡Œå›¾æ ‡æŒ‰é’®ä¸­ï¼Œé€‰ä¸­&ldquo;Update Heap&rdquo;ã€‚</span><br><span>&nbsp; &nbsp; &nbsp; 3. å½“å†…å­˜ä½ æ„Ÿè§‰å¼‚å¸¸çš„æ—¶å€™ï¼ŒæŒ‰ä¸‹&ldquo;Dump HPROF file&rdquo;æŒ‰é’®ï¼Œè¿™ä¸ªæ—¶å€™ä¼šæç¤ºè®¾ç½®hprofæ–‡ä»¶çš„ä¿å­˜è·¯å¾„ã€‚</span><br><span>(äºŒ) ä½¿ç”¨MATå¯¼å…¥.hprofæ–‡ä»¶</span><br><span>&nbsp; &nbsp; &nbsp;1. é€šè¿‡</span><span>/ANDROID_SDK/toolsç›®å½•ä¸‹çš„hprof-conv.exeå·¥å…·ï¼ˆä½¿ç”¨å‘½ä»¤åŒadbï¼‰ï¼Œè¾“å…¥å‘½ä»¤hprof-conv xxx.hprof yyy.hprofï¼Œå…¶ä¸­xxx.hprofä¸ºåŸå§‹æ–‡ä»¶ï¼Œyyy.hprofä¸ºè½¬æ¢è¿‡åçš„æ–‡ä»¶ã€‚</span><br><span>&nbsp; &nbsp; 2. åœ¨Eclipseä¸­ç‚¹å‡»Windows-&gt;Open Perspective-&gt;Other-&gt;Memory Analysis perspectiveç•Œé¢ã€‚åœ¨MATä¸­ç‚¹å‡»File-&gt;Open Fileï¼Œæµè§ˆå¹¶å¯¼å…¥åˆšåˆš è½¬æ¢è€Œå¾—åˆ°çš„.hprofæ–‡ä»¶ã€‚</span><br><span>(ä¸‰) ä½¿ç”¨MATçš„è§†å›¾å·¥å…·åˆ†æå†…å­˜</span><br><span>&nbsp;&nbsp;å¯¼å…¥.hprofæ–‡ä»¶ä»¥åï¼ŒMATä¼šè‡ªåŠ¨è§£æå¹¶ç”ŸæˆæŠ¥å‘Šï¼ŒæŠ¥å‘Šä¸­ä¼šåˆ—å‡ºä½¿ç”¨å†…å­˜è¿‡å¤šæˆ–è€…åˆå§‹åŒ–çš„å®ä¾‹è¿‡å¤šçš„ç±»ã€‚</span></p>
<p><span>&nbsp;ç‚¹å‡»Dominator Treeï¼Œå¹¶æŒ‰Packageåˆ†ç»„ï¼Œé€‰æ‹©æŠ¥å‘Šä¸­æåˆ°çš„å¯ç–‘å®ä¾‹çš„ç±»ï¼Œåœ¨å¼¹å‡ºèœå•ä¸­é€‰æ‹©List objects-&gt;With incoming referencesã€‚è¿™æ—¶ä¼šåˆ—å‡ºæ‰€æœ‰å¯ç–‘ç±»ï¼Œå³é”®ç‚¹å‡»æŸä¸€é¡¹ï¼Œå¹¶é€‰æ‹©Path to GC Roots -&gt; exclude weak/soft referencesï¼Œä¼šè¿›ä¸€æ­¥ç­›é€‰å‡ºè·Ÿç¨‹åºç›¸å…³çš„æ‰€æœ‰æœ‰å†…å­˜æ³„éœ²çš„ç±»ã€‚æ®æ­¤ï¼Œå¯ä»¥è¿½è¸ªåˆ°ä»£ç ä¸­çš„æŸä¸€ä¸ªäº§ç”Ÿæ³„éœ²çš„ç±»ã€‚</span><br><span><span>&nbsp;</span><span>&nbsp; ä¸»è¦æ˜¯çœ‹å¯ç–‘ç±»çš„å¼•ç”¨æ˜¯å› ä¸ºä»€ä¹ˆä»£ç çš„å¼•ç”¨è€Œå¯¼è‡´æ— æ³•é‡Šæ”¾çš„</span></span><br><span>&nbsp;&nbsp;æ€»ä¹‹ä½¿ç”¨MATåˆ†æå†…å­˜æŸ¥æ‰¾å†…å­˜æ³„æ¼çš„æ ¹æœ¬æ€è·¯ï¼Œå°±æ˜¯æ‰¾åˆ°å“ªä¸ªç±»çš„å¯¹è±¡çš„å¼•ç”¨æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œæ‰¾åˆ°æ²¡æœ‰è¢«é‡Šæ”¾çš„åŸå› ï¼Œä¹Ÿå°±å¯ä»¥å¾ˆå®¹æ˜“å®šä½ä»£ç ä¸­çš„å“ªäº›ç‰‡æ®µçš„é€»è¾‘æœ‰é—®é¢˜äº†ã€‚</span></p>
<p>&nbsp;</p>
<p>è½¬è‡ªï¼š<a href="http://blog.csdn.net/cs_epo/article/details/7843766" target="_blank" rel="noopener">http://blog.csdn.net/cs_epo/article/details/7843766</a></p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> memory leak </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]å¯¹BaseAdapterä¸­ViewHolderç¼–å†™ç®€åŒ–]]></title>
      <url>/2014/04/03/Android-%E5%AF%B9BaseAdapter%E4%B8%ADViewHolder%E7%BC%96%E5%86%99%E7%AE%80%E5%8C%96/</url>
      <content type="html"><![CDATA[<p>åœ¨Androidé¡¹ç›®ä¸­ï¼Œç»å¸¸éƒ½ä¼šç”¨åˆ°ListViewè¿™ä¸ªæ§ä»¶ï¼Œè€Œç›¸åº”çš„Adapterä¸­getView()æ–¹æ³•çš„ç¼–å†™æœ‰ä¸€ä¸ªæ ‡å‡†çš„å½¢å¼ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">@Override<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">public</span> View getView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position, View convertView, ViewGroup parent) {<br></span><span style="color: #008080;"> 3</span> <span style="color: #000000;">        ViewHolder holder;<br></span><span style="color: #008080;"> 4</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> convertView){<br></span><span style="color: #008080;"> 5</span>             holder = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ViewHolder();<br></span><span style="color: #008080;"> 6</span>             LayoutInflater mInflater =<span style="color: #000000;"> (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);<br></span><span style="color: #008080;"> 7</span>             convertView = mInflater.inflate(R.layout.item, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 8</span>             holder.btn =<span style="color: #000000;"> (Button) convertView.findViewById(R.id.btn);<br></span><span style="color: #008080;"> 9</span>             holder.tv =<span style="color: #000000;"> (TextView) convertView.findViewById(R.id.tv);<br></span><span style="color: #008080;">10</span>             holder.iv =<span style="color: #000000;"> (TextView) convertView.findViewById(R.id.iv);<br></span><span style="color: #008080;">11</span><br><span style="color: #008080;">12</span> <span style="color: #000000;">            convertView.setTag(holder);<br></span><span style="color: #008080;">13</span>         }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;">14</span>             holder =<span style="color: #000000;"> (ViewHolder) convertView.getTag();<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">16</span>         <span style="color: #0000ff;">final</span> HashMap&lt;String, Object&gt; map =<span style="color: #000000;"> list.get(position);<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>         holder.iv.setImageResource(Integer.valueOf(map.get(â€œivâ€<span style="color: #000000;">).toString()));<br></span><span style="color: #008080;">19</span>         holder.tv.setText(map.get(â€œtvâ€<span style="color: #000000;">).toString());<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>         holder.btn.setOnClickListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> View.OnClickListener() {<br></span><span style="color: #008080;">22</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">23</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClick(View v) {<br></span><span style="color: #008080;">24</span>                 Toast.makeText(context, map.get(â€œbtnâ€<span style="color: #000000;">).toString(), Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">26</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">27</span><br><span style="color: #008080;">28</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> convertView;<br></span><span style="color: #008080;">29</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span>     <span style="color: #0000ff;">class</span><span style="color: #000000;"> ViewHolder{<br></span><span style="color: #008080;">32</span> <span style="color: #000000;">        Button btn;<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">        ImageView iv;<br></span><span style="color: #008080;">34</span> <span style="color: #000000;">        TextView tv;<br></span><span style="color: #008080;">35</span><br><span style="color: #008080;">36</span>     }</pre><br></div>

<p>ä»¥ä¸‹æ˜¯ç¢ç¢å¿µï¼ˆæƒ³ç›´æ¥çœ‹ä»£ç çš„ï¼Œå°±è·³è¿‡è¿™æ®µå§-_-ï¼ï¼‰ï¼š</p>
<p>ä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡ç¼–å†™Adapteréƒ½éœ€è¦ç¼–å†™class ViewHolderâ€¦ã€if(null == convertView){â€¦ç­‰ç­‰ã€‚è¿™äº›ä»£ç è·Ÿä¸šåŠ¡é€»è¾‘å…³ç³»ä¸å¤§ï¼Œæ²¡æœ‰å¿…è¦æ¯æ¬¡éƒ½å†™é‡å¤ä»£ç ï¼Œ</p>
<p>æ‰€ä»¥ï¼Œæ˜¾ç„¶æœ‰ç®€åŒ–ä»£ç çš„ä½™åœ°ã€‚</p>
<p>æ—¢ç„¶æˆ‘ä»¬çš„éœ€æ±‚æ˜¯ä¸éœ€è¦é‡å¤ç¼–å†™ViewHolderç­‰å†…éƒ¨ç±»ï¼Œé‚£å°±æŠŠå®ƒç§»åˆ°çˆ¶ç±»å§ã€‚</p>
<p>ä½†æ˜¯ViewHolderä¸­åœ¨å®é™…é¡¹ç›®ä¸­æœ‰ä¸åŒçš„Viewï¼Œé‚£å°±ç”¨listå­˜æ”¾èµ·æ¥å§ï¼Œä½†æ˜¯æ”¾åœ¨listä¸­çš„è¯ï¼Œæ€ä¹ˆå–å‡ºæ¥ï¼Ÿç”¨indexï¼Ÿæ˜¾ç„¶ä¸æ˜¯å¥½çš„æ–¹æ³•ï¼Œä¸æ˜¯æœ‰Resource Idè¿™ç©æ„ï¼Œé€šè¿‡è¿™ä¸ªå–ä¸å°±å¥½äº†ä¹ˆï¼Ÿæ‰€ä»¥ä»¥Resource Idä¸ºkeyæ”¾åœ¨Mapä¸­æ¯”è¾ƒåˆé€‚ï¼Œä½†æ˜¯æ—¢ç„¶ä»¥intï¼ˆResource Idï¼‰ä¸ºkeyï¼Œé‚£è‡ªç„¶è€Œç„¶æƒ³åˆ°ä½¿ç”¨SparseArrayäº†ã€‚</p>
<p>ç„¶åå†æŠŠif(null == converView)â€¦è¿™äº›ä»£ç ç»Ÿç»Ÿç§»åˆ°çˆ¶ç±»ä¸­ã€‚</p>
<p>æ‰€ä»¥ABaseAdapterè¯ç”Ÿäº†ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;"> <em> å®ç°å¯¹BaseAdapterä¸­ViewHolderç›¸å…³çš„ç®€åŒ–<br></em></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">  Created with IntelliJ IDEA.<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;"> <em> Author: wangjie  email:tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 5</span> <span style="color: #008000;">  Date: 14-4-2<br></span><span style="color: #008080;"> 6</span> <span style="color: #008000;"> <em> Time: ä¸‹åˆ5:54<br></em></span><span style="color: #008080;"> 7</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span> ABaseAdapter <span style="color: #0000ff;">extends</span><span style="color: #000000;"> BaseAdapter{<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">    Context context;<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span>     <span style="color: #0000ff;">protected</span><span style="color: #000000;"> ABaseAdapter(Context context) {<br></span><span style="color: #008080;">12</span>         <span style="color: #0000ff;">this</span>.context =<span style="color: #000000;"> context;<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span>     <span style="color: #0000ff;">protected</span><span style="color: #000000;"> ABaseAdapter() {<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">19</span> <span style="color: #008000;">     <em> å„ä¸ªæ§ä»¶çš„ç¼“å­˜<br></em></span><span style="color: #008080;">20</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">21</span>     public <span style="color: #0000ff;">class</span><span style="color: #000000;"> ViewHolder{<br></span><span style="color: #008080;">22</span>         <span style="color: #0000ff;">public</span> SparseArray&lt;View&gt; views = <span style="color: #0000ff;">new</span> SparseArray&lt;View&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">23</span><br><span style="color: #008080;">24</span>         <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">25</span> <span style="color: #008000;">         <em> æŒ‡å®šresIdå’Œç±»å‹å³å¯è·å–åˆ°ç›¸åº”çš„view<br></em></span><span style="color: #008080;">26</span> <span style="color: #008000;">          </span><span style="color: #808080;">@param</span><span style="color: #008000;"> convertView<br></span><span style="color: #008080;">27</span> <span style="color: #008000;">         <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> resId<br></span><span style="color: #008080;">28</span> <span style="color: #008000;">          </span><span style="color: #808080;">@param</span><span style="color: #008000;"> &lt;T&gt;<br></span><span style="color: #008080;">29</span> <span style="color: #008000;">         <em> </em></span><span style="color: #808080;">@return</span><br><span style="color: #008080;">30</span>          <span style="color: #008000;">/</span><br><span style="color: #008080;">31</span>         <span style="color: #0000ff;">public</span> &lt;T <span style="color: #0000ff;">extends</span> View&gt; T obtainView(View convertView, <span style="color: #0000ff;">int</span><span style="color: #000000;"> resId){<br></span><span style="color: #008080;">32</span>             View v =<span style="color: #000000;"> views.get(resId);<br></span><span style="color: #008080;">33</span>             <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> v){<br></span><span style="color: #008080;">34</span>                 v =<span style="color: #000000;"> convertView.findViewById(resId);<br></span><span style="color: #008080;">35</span> <span style="color: #000000;">                views.put(resId, v);<br></span><span style="color: #008080;">36</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">37</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> (T)v;<br></span><span style="color: #008080;">38</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">39</span><br><span style="color: #008080;">40</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">41</span><br><span style="color: #008080;">42</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">43</span> <span style="color: #008000;">     <em> æ”¹æ–¹æ³•éœ€è¦å­ç±»å®ç°ï¼Œéœ€è¦è¿”å›itemå¸ƒå±€çš„resource id<br></em></span><span style="color: #008080;">44</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><br><span style="color: #008080;">45</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;">46</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> itemLayoutRes();<br></span><span style="color: #008080;">47</span><br><span style="color: #008080;">48</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">49</span>     <span style="color: #0000ff;">public</span> View getView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position, View convertView, ViewGroup parent) {<br></span><span style="color: #008080;">50</span> <span style="color: #000000;">        ViewHolder holder;<br></span><span style="color: #008080;">51</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> convertView){<br></span><span style="color: #008080;">52</span>             holder = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ViewHolder();<br></span><span style="color: #008080;">53</span>             convertView = LayoutInflater.from(context).inflate(itemLayoutRes(), <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br></span><span style="color: #008080;">54</span> <span style="color: #000000;">            convertView.setTag(holder);<br></span><span style="color: #008080;">55</span>         }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;">56</span>             holder =<span style="color: #000000;"> (ViewHolder) convertView.getTag();<br></span><span style="color: #008080;">57</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">58</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> getView(position, convertView, parent, holder);<br></span><span style="color: #008080;">59</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">60</span><br><span style="color: #008080;">61</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">62</span> <span style="color: #008000;">      ä½¿ç”¨è¯¥getViewæ–¹æ³•æ›¿æ¢åŸæ¥çš„getViewæ–¹æ³•ï¼Œéœ€è¦å­ç±»å®ç°<br></span><span style="color: #008080;">63</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> position<br></span><span style="color: #008080;">64</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> convertView<br></span><span style="color: #008080;">65</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> parent<br></span><span style="color: #008080;">66</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> holder<br></span><span style="color: #008080;">67</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><br><span style="color: #008080;">68</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">69</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> View getView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position, View convertView, ViewGroup parent, ViewHolder holder);<br></span><span style="color: #008080;">70</span><br><span style="color: #008080;">71</span> }</pre><br></div>

<p>å¦‚ä¸Šä»£ç ï¼šå¢åŠ äº†ä¸€ä¸ªitemLayoutRes()çš„æŠ½è±¡æ–¹æ³•ï¼Œè¯¥æŠ½è±¡æ–¹æ³•æä¾›ç»™å­ç±»å®ç°ï¼Œè¿”å›itemå¸ƒå±€çš„resource idï¼Œä¸ºåé¢çš„getViewæ–¹æ³•æä¾›è°ƒç”¨ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°ä¸Šè¿°ä»£ç ä¸­ï¼Œåœ¨ç³»ç»Ÿçš„getViewæ–¹æ³•ä¸­ï¼Œè¿›è¡Œæˆ‘ä»¬ä»¥å‰åœ¨BaseAdapterå®ç°ç±»ä¸­æ‰€åšçš„äº‹ï¼ˆåˆå§‹åŒ–converViewï¼Œå¹¶ç»‘å®šViewHolderä½œä¸ºtagï¼‰ï¼Œç„¶åæŠ›å¼ƒäº†ç³»ç»Ÿæä¾›çš„getViewæ–¹æ³•ï¼Œç›´æ¥å»è°ƒç”¨è‡ªå·±å†™çš„getViewæŠ½è±¡æ–¹æ³•ï¼Œè¿™ä¸ªgetViewæ–¹æ³•æ˜¯æä¾›ç»™å­ç±»å»å®ç°çš„ï¼Œä½œç”¨è·Ÿç³»ç»Ÿçš„getViewä¸€æ ·ï¼Œä½†æ˜¯è¿™ä¸ªgetViewæ–¹æ³•ä¸­æºå¸¦äº†ä¸€ä¸ªViewHolderå¯¹è±¡ï¼Œå­ç±»å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡è¿›è¡Œè·å–itemä¸­çš„æ§ä»¶ã€‚</p>
<p>å…·ä½“ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼Œæ¯”å¦‚åˆ›å»ºäº†MyAdapterå¹¶ç»§æ‰¿äº†ABaseAdapterï¼š</p>
<p>æ³¨æ„ï¼Œåœ¨æ„é€ æ–¹æ³•ä¸­éœ€è¦è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">public</span> MyAdapter(Context context, List&lt;HashMap&lt;String, Object&gt;&gt;<span style="color: #000000;"> list) {<br></span><span style="color: #008080;">2</span>     <span style="color: #0000ff;">super</span><span style="color: #000000;">(context);<br></span><span style="color: #008080;">3</span>     <span style="color: #0000ff;">this</span>.list =<span style="color: #000000;"> list;<br></span><span style="color: #008080;">4</span> }</pre><br></div>

<p>å³ï¼Œä»¥ä¸Šçš„&ldquo;super(context);&rdquo;å¿…é¡»è°ƒç”¨ã€‚</p>
<p>æ¥ç€å®ç°itemLayoutRes()æ–¹æ³•ï¼Œè¿”å›itemçš„å¸ƒå±€ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #000000;">@Override<br></span><span style="color: #008080;">2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> itemLayoutRes() {<br></span><span style="color: #008080;">3</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> R.layout.item;<br></span><span style="color: #008080;">4</span> }</pre><br></div>

<p>&nbsp;</p>
<p>getViewæ–¹æ³•ä¸­çš„å®ç°å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">@Override<br></span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">public</span> View getView(<span style="color: #0000ff;">int</span><span style="color: #000000;"> position, View convertView, ViewGroup parent, ViewHolder holder) {<br></span><span style="color: #008080;"> 3</span>     <span style="color: #0000ff;">final</span> HashMap&lt;String, Object&gt; map =<span style="color: #000000;"> list.get(position);<br></span><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span>     Button btn =<span style="color: #000000;"> holder.obtainView(convertView, R.id.item_btn);<br></span><span style="color: #008080;"> 6</span>     ImageView iv =<span style="color: #000000;"> holder.obtainView(convertView, R.id.item_iv);<br></span><span style="color: #008080;"> 7</span>     TextView tv =<span style="color: #000000;"> holder.obtainView(convertView, R.id.item_tv);<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span>      btn.setOnClickListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> View.OnClickListener() {<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">        @Override<br></span><span style="color: #008080;">11</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClick(View v) {<br></span><span style="color: #008080;">12</span>             Toast.makeText(context, map.get(â€œbtnâ€<span style="color: #000000;">).toString(), Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">         }<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">     });<br></span><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span>      iv.setImageResource(Integer.valueOf(map.get(â€œivâ€<span style="color: #000000;">).toString()));<br></span><span style="color: #008080;">17</span>      tv.setText(map.get(â€œtvâ€<span style="color: #000000;">).toString());<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> convertView;<br></span><span style="color: #008080;">20</span>     }</pre><br></div>

<p>å¦‚ä¸Šä»£ç ï¼šè°ƒç”¨holder.obtainViewæ–¹æ³•æ—¢å¯è·å–itemä¸­çš„æ§ä»¶ï¼›</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ListView </tag>
            
            <tag> best practices </tag>
            
            <tag> adapter </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidé«˜çº§æ¨¡ç³ŠæŠ€æœ¯[è½¬]]]></title>
      <url>/2014/03/28/Android%E9%AB%98%E7%BA%A7%E6%A8%A1%E7%B3%8A%E6%8A%80%E6%9C%AF-%E8%BD%AC/</url>
      <content type="html"><![CDATA[<p>ä»Šå¤©æˆ‘ä»¬æ¥æ›´æ·±å…¥äº†è§£ä¸€ä¸‹Androidå¼€å‘ä¸Šçš„æ¨¡ç³ŠæŠ€æœ¯ã€‚æˆ‘è¯»è¿‡å‡ ç¯‡æœ‰å…³çš„æ–‡ç« ï¼Œä¹Ÿåœ¨StackOverFlowä¸Šçœ‹è¿‡ä¸€äº›ç›¸å…³æ•™ç¨‹çš„å¸–å­ï¼Œæ‰€ä»¥æˆ‘æƒ³åœ¨è¿™é‡Œæ€»ç»“ä¸€ä¸‹å­¦åˆ°çš„ä¸œè¥¿ã€‚</p>
<h3 id="ä¸ºä»€ä¹ˆå­¦ä¹ è¿™ä¸ªæ¨¡ç³ŠæŠ€æœ¯ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå­¦ä¹ è¿™ä¸ªæ¨¡ç³ŠæŠ€æœ¯ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå­¦ä¹ è¿™ä¸ªæ¨¡ç³ŠæŠ€æœ¯ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå­¦ä¹ è¿™ä¸ªæ¨¡ç³ŠæŠ€æœ¯ï¼Ÿ</h3><p>ç°åœ¨è¶Šæ¥è¶Šå¤šçš„å¼€å‘è€…å–œæ¬¢åœ¨è‡ªå®šä¹‰æ§ä»¶çš„æ—¶å€™åŠ ä¸Šå„ç§æ¨¡ç³ŠèƒŒæ™¯ï¼Œçœ‹çœ‹RomanNurikå¼€å‘çš„<a href="https://play.google.com/store/apps/details?id=net.nurik.roman.muzei" target="_blank" rel="noopener">Muzei</a>æˆ–è€…Yahooçš„<a href="https://play.google.com/store/apps/details?id=com.yahoo.mobile.client.android.weather" target="_blank" rel="noopener">Weatheråº”ç”¨</a>appéƒ½éå¸¸ä¸é”™ã€‚æˆ‘éå¸¸å–œæ¬¢ä»–ä»¬çš„è®¾è®¡ã€‚</p>
<p>æˆ‘ä»<strong>Mark Allison</strong>çš„å¸–å­(<a href="http://blog.stylingandroid.com/archives/2304" target="_blank" rel="noopener">å¸–å­åœ°å€</a>)å¾—åˆ°å¯å‘ï¼Œç„¶åå†™äº†è¿™ç¯‡æ–‡ç« ã€‚</p>
<p>è¿™æ˜¯æˆ‘ä»¬éœ€è¦å®Œæˆä¸‹å›¾å±•ç¤ºçš„æ•ˆæœï¼š</p>
<p><a href="http://www.linuxeden.com/upimg/allimg/140328/0S1031332-0.png" title="Androidé«˜çº§æ¨¡ç³ŠæŠ€æœ¯" target="_blank" rel="noopener"><img src="http://www.linuxeden.com/upimg/allimg/140328/0S1031332-0.png" alt="1"></a></p>
<h3 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h3><p>é¦–å…ˆæè¿°ä¸€ä¸‹æˆ‘ä»¬éœ€è¦çš„æ–‡ä»¶ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸»<code>Activity</code>ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå«æœ‰å¤šä¸ª<code>Fragment</code>çš„<code>ViewPager</code>ï¼Œæ¯ä¸ª<code>Fragment</code>å±•ç¤ºä¸€ç§æ¨¡ç³ŠæŠ€æœ¯ã€‚</p>
<p><span>è¿™æ˜¯ä¸»</span><code>Activity</code><span>çš„å¸ƒå±€æ–‡ä»¶å†…å®¹ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">android.support.v4.view.ViewPager<br></span><span style="color: #008080;">2</span> <span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><br><span style="color: #008080;">3</span> <span style="color: #ff0000;">    xmlns:tools</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/tools" target="_blank" rel="noopener">http://schemas.android.com/tools</a>â€œ</span><br><span style="color: #008080;">4</span> <span style="color: #ff0000;">    android:id</span><span style="color: #0000ff;">=â€@+id/pagerâ€</span><br><span style="color: #008080;">5</span> <span style="color: #ff0000;">    android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">6</span> <span style="color: #ff0000;">    android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">7</span> <span style="color: #ff0000;">    tools:context</span><span style="color: #0000ff;">=â€com.paveldudka.MainActivityâ€</span> <span style="color: #0000ff;">/&gt;</span></pre><br></div>

<p><span>è¿™æ˜¯</span><code>Fragment</code><span>çš„å¸ƒå±€æ–‡ä»¶å†…å®¹ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">FrameLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><br><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">    android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">    android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">ImageView<br></span><span style="color: #008080;"> 8</span>         <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/pictureâ€</span><br><span style="color: #008080;"> 9</span> <span style="color: #ff0000;">        android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">10</span> <span style="color: #ff0000;">        android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">11</span> <span style="color: #ff0000;">        android:src</span><span style="color: #0000ff;">=â€@drawable/pictureâ€</span><br><span style="color: #008080;">12</span> <span style="color: #ff0000;">        android:scaleType</span><span style="color: #0000ff;">=â€centerCropâ€</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">13</span><br><span style="color: #008080;">14</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">TextView<br></span><span style="color: #008080;">15</span>         <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/textâ€</span><br><span style="color: #008080;">16</span> <span style="color: #ff0000;">        android:gravity</span><span style="color: #0000ff;">=â€center_horizontalâ€</span><br><span style="color: #008080;">17</span> <span style="color: #ff0000;">        android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">18</span> <span style="color: #ff0000;">        android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;">19</span> <span style="color: #ff0000;">        android:text</span><span style="color: #0000ff;">=â€My super textâ€</span><br><span style="color: #008080;">20</span> <span style="color: #ff0000;">        android:textColor</span><span style="color: #0000ff;">=â€&lt;a href=â€</span><span style="color: #ff0000;"><a href="http://www.jobbole.com/members/android/" target="_blank" rel="noopener">http://www.jobbole.com/members/android/</a>â€œ rel</span><span style="color: #0000ff;">=â€nofollowâ€</span><span style="color: #0000ff;">&gt;</span>@android<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">a</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">:color/whiteâ€<br></span><span style="color: #008080;">21</span> <span style="color: #000000;">        android:layout_gravity=â€center_verticalâ€<br></span><span style="color: #008080;">22</span> <span style="color: #000000;">        android:textStyle=â€boldâ€<br></span><span style="color: #008080;">23</span> <span style="color: #000000;">        android:textSize=â€48spâ€ /&gt;<br></span><span style="color: #008080;">24</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout<br></span><span style="color: #008080;">25</span>         <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/controlsâ€</span><br><span style="color: #008080;">26</span> <span style="color: #ff0000;">        android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">27</span> <span style="color: #ff0000;">        android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;">28</span> <span style="color: #ff0000;">        android:background</span><span style="color: #0000ff;">=â€#7f000000â€</span><br><span style="color: #008080;">29</span> <span style="color: #ff0000;">        android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><br><span style="color: #008080;">30</span> <span style="color: #ff0000;">        android:layout_gravity</span><span style="color: #0000ff;">=â€bottomâ€</span><span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">31</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">FrameLayout</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>æˆ‘ä»¬åªæ˜¯åœ¨å¸ƒå±€ä¸Šæ”¾äº†ä¸€ä¸ª<code>ImageView</code>ï¼Œç„¶ååœ¨ä¸­é—´åŠ ä¸€ä¸ª<code>TextView</code>ï¼Œè¿˜æœ‰ä¸€äº›ä½œä¸ºæ•ˆæœæ˜¾ç¤ºå’Œæµ‹è¯•çš„æ§ä»¶ï¼ˆå¦‚ @+id/controlsï¼‰ã€‚</p>
<p>æœ€æ™®éçš„æ¨¡ç³ŠæŠ€æœ¯æ˜¯è¿™æ ·åšçš„ï¼š</p>
<ul>
<li>ä»<code>TextView</code>çš„åä¸€å±‚èƒŒæ™¯ä¸­æˆªå–ä¸€éƒ¨åˆ†ï¼›</li>
<li>è¿›è¡Œæ¨¡ç³Šå¤„ç†ï¼›</li>
<li>æŠŠæ¨¡ç³Šå¤„ç†åçš„éƒ¨åˆ†è®¾ç½®ä¸º<code>TextView</code>çš„èƒŒæ™¯ã€‚</li>
</ul>
<h3 id="Renderscript"><a href="#Renderscript" class="headerlink" title="Renderscript"></a>Renderscript</h3><p>é‚£æ€ä¹ˆåœ¨Androidä¸­å®ç°æ¨¡ç³Šå¤„ç†å‘¢ï¼Ÿæœ€å¥½çš„ç­”æ¡ˆå°±æ˜¯Renderscriptã€‚è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å›¾å½¢å¤„ç†&ldquo;å¼•æ“&rdquo;ã€‚RenderScriptçš„åº•å±‚åŸç†å°±ä¸åšä»‹ç»äº†ï¼ˆå› ä¸ºæˆ‘ä¹Ÿä¸çŸ¥é“ï¼‰ï¼Œè€Œä¸”è¿™è¶…è¿‡äº†æˆ‘ä»¬è¿™ç¯‡æ–‡ç« çš„èŒƒå›´ã€‚</p>
<p>å…ˆçœ‹ä¸‹é¢çš„ä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">public class RSBlurFragment extends Fragment {<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">    private ImageView image;<br></span><span style="color: #008080;"> 3</span> <span style="color: #000000;">    private TextView text;<br></span><span style="color: #008080;"> 4</span> <span style="color: #000000;">    private TextView statusText;<br></span><span style="color: #008080;"> 5</span><br><span style="color: #008080;"> 6</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 7</span> <span style="color: #000000;">    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">        View view = inflater.inflate(R.layout.fragment_layout, container, false);<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">        image = (ImageView) view.findViewById(R.id.picture);<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">        text = (TextView) view.findViewById(R.id.text);<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">        statusText = addStatusText((ViewGroup) view.findViewById(R.id.controls));<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">        applyBlur();<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">        return view;<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span> <span style="color: #000000;">    private void applyBlur() {<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">        image.getViewTreeObserver().addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener() {<br></span><span style="color: #008080;">18</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">            public boolean onPreDraw() {<br></span><span style="color: #008080;">20</span> <span style="color: #000000;">                image.getViewTreeObserver().removeOnPreDrawListener(this);<br></span><span style="color: #008080;">21</span> <span style="color: #000000;">                image.buildDrawingCache();<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> <span style="color: #000000;">                Bitmap bmp = image.getDrawingCache();<br></span><span style="color: #008080;">24</span> <span style="color: #000000;">                blur(bmp, text);<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">                return true;<br></span><span style="color: #008080;">26</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">27</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">28</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">29</span><br><span style="color: #008080;">30</span> <span style="color: #000000;">    @TargetApi(Build.VERSION_CODES.JELLY_BEAN_MR1)<br></span><span style="color: #008080;">31</span> <span style="color: #000000;">    private void blur(Bitmap bkg, View view) {<br></span><span style="color: #008080;">32</span> <span style="color: #000000;">        long startMs = System.currentTimeMillis();<br></span><span style="color: #008080;">33</span><br><span style="color: #008080;">34</span> <span style="color: #000000;">        float radius = 20;<br></span><span style="color: #008080;">35</span><br><span style="color: #008080;">36</span> <span style="color: #000000;">        Bitmap overlay = Bitmap.createBitmap((int) (view.getMeasuredWidth()),<br></span><span style="color: #008080;">37</span> <span style="color: #000000;">                (int) (view.getMeasuredHeight()), Bitmap.Config.ARGB_8888);<br></span><span style="color: #008080;">38</span><br><span style="color: #008080;">39</span> <span style="color: #000000;">        Canvas canvas = new Canvas(overlay);<br></span><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span> <span style="color: #000000;">        canvas.translate(-view.getLeft(), -view.getTop());<br></span><span style="color: #008080;">42</span> <span style="color: #000000;">        canvas.drawBitmap(bkg, 0, 0, null);<br></span><span style="color: #008080;">43</span><br><span style="color: #008080;">44</span> <span style="color: #000000;">        RenderScript rs = RenderScript.create(getActivity());<br></span><span style="color: #008080;">45</span><br><span style="color: #008080;">46</span> <span style="color: #000000;">        Allocation overlayAlloc = Allocation.createFromBitmap(<br></span><span style="color: #008080;">47</span> <span style="color: #000000;">                rs, overlay);<br></span><span style="color: #008080;">48</span><br><span style="color: #008080;">49</span> <span style="color: #000000;">        ScriptIntrinsicBlur blur = ScriptIntrinsicBlur.create(<br></span><span style="color: #008080;">50</span> <span style="color: #000000;">                rs, overlayAlloc.getElement());<br></span><span style="color: #008080;">51</span><br><span style="color: #008080;">52</span> <span style="color: #000000;">        blur.setInput(overlayAlloc);<br></span><span style="color: #008080;">53</span><br><span style="color: #008080;">54</span> <span style="color: #000000;">        blur.setRadius(radius);<br></span><span style="color: #008080;">55</span><br><span style="color: #008080;">56</span> <span style="color: #000000;">        blur.forEach(overlayAlloc);<br></span><span style="color: #008080;">57</span><br><span style="color: #008080;">58</span> <span style="color: #000000;">        overlayAlloc.copyTo(overlay);<br></span><span style="color: #008080;">59</span><br><span style="color: #008080;">60</span> <span style="color: #000000;">        view.setBackground(new BitmapDrawable(<br></span><span style="color: #008080;">61</span> <span style="color: #000000;">                getResources(), overlay));<br></span><span style="color: #008080;">62</span><br><span style="color: #008080;">63</span> <span style="color: #000000;">        rs.destroy();<br></span><span style="color: #008080;">64</span> <span style="color: #000000;">        statusText.setText(System.currentTimeMillis() - startMs + â€œmsâ€);<br></span><span style="color: #008080;">65</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">66</span><br><span style="color: #008080;">67</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">68</span> <span style="color: #000000;">    public String toString() {<br></span><span style="color: #008080;">69</span> <span style="color: #000000;">        return â€œRenderScriptâ€;<br></span><span style="color: #008080;">70</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">71</span><br><span style="color: #008080;">72</span> <span style="color: #000000;">    private TextView addStatusText(ViewGroup container) {<br></span><span style="color: #008080;">73</span> <span style="color: #000000;">        TextView result = new TextView(getActivity());<br></span><span style="color: #008080;">74</span> <span style="color: #000000;">        result.setLayoutParams(new ViewGroup.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT));<br></span><span style="color: #008080;">75</span> <span style="color: #000000;">        result.setTextColor(0xFFFFFFFF);<br></span><span style="color: #008080;">76</span> <span style="color: #000000;">        container.addView(result);<br></span><span style="color: #008080;">77</span> <span style="color: #000000;">        return result;<br></span><span style="color: #008080;">78</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">79</span> }</pre><br></div>

<ul>
<li>åœ¨<code>Fragment</code>åˆ›å»ºçš„æ—¶å€™ï¼Œæˆ‘å…ˆè½½å…¥äº†å¸ƒå±€æ–‡ä»¶ï¼Œç„¶åæŠŠ<code>TextView</code>æ·»åŠ åˆ°æˆ‘åœ¨å¸ƒå±€æ–‡ä»¶ä¸­å®šä¹‰çš„LinearLayoutä¸­ï¼ˆç”¨æ¥æ˜¾ç¤ºæ¨¡ç³Šæ•ˆæœï¼Œè¿›è¡Œæ•ˆæœæµ‹è¯•ï¼‰ï¼Œæœ€åå¯¹å›¾ç‰‡åšæ¨¡ç³Šå¤„ç†ã€‚</li>
<li>åœ¨<code>applyBlur()</code>å‡½æ•°ä¸­æˆ‘æ³¨å†Œäº†<code>onPreDrawListener()</code>ã€‚å› ä¸ºåœ¨<code>applyBlur()</code>æ–¹æ³•è°ƒç”¨çš„æ—¶å€™ç•Œé¢è¿˜æ²¡æœ‰å¼€å§‹å¸ƒå±€ï¼Œæ‰€ä»¥æˆ‘éœ€è¦å®ç°è¿™ä¸ªç›‘å¬å™¨å¦åˆ™ä¸èƒ½è¿›è¡Œæ¨¡ç³Šå¤„ç†ã€‚éœ€è¦ç­‰åˆ°å¸ƒå±€æ–‡ä»¶å…¨éƒ½ç»è¿‡<strong>measured</strong>ã€<strong>laid out</strong>ã€<strong>displayed</strong>çš„æ—¶å€™ï¼Œæ‰èƒ½è¿›è¡Œæ“ä½œã€‚</li>
<li>åœ¨<code>onPreDraw()</code>å›è°ƒå‡½æ•°ä¸­ï¼Œæˆ‘é¦–å…ˆæŠŠè¿”å›å€¼<strong>false</strong>æ”¹æˆ<strong>true</strong>ã€‚è¿™ä¸ªå¾ˆé‡è¦ï¼Œå¦‚æœè¿”å›<strong>false</strong>çš„è¯ï¼Œåˆšå¼€å§‹å‡ºç°çš„é‚£ä¸€å¸§ç”»é¢ä¼šè¢«è·³è¿‡ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æ˜¾ç¤ºè¿™ç¬¬ä¸€å¸§ï¼Œæ‰€ä»¥è¦è¿”å›<strong>true</strong>ã€‚</li>
<li>æ¥ç€æˆ‘å»æ‰äº†é‡Œé¢çš„å›è°ƒæ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦ç›‘å¬å®ƒçš„<code>preDraw</code>äº‹ä»¶ã€‚</li>
<li>ç„¶åæˆ‘ä»¬éœ€è¦ä»<code>ImageView</code>ä¸­è·å–<code>Bitmap</code>ï¼Œç„¶åç”¨<code>getDrawingCache()</code>å‡½æ•°åˆ›å»º<strong>drawing cache</strong>å¹¶ä¿å­˜ã€‚</li>
<li>æœ€åå°±æ˜¯è¿›è¡Œæ¨¡ç³Šå¤„ç†äº†ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥ä¼šè¯¦ç»†è®¨è®ºè¿™ä¸ªç¯èŠ‚ã€‚</li>
</ul>
<p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæˆ‘çš„ä»£ç ä¸­åœ¨ä¸¤ç§æƒ…å†µä¸‹è€ƒè™‘ä¸æ˜¯å¾ˆå‘¨å…¨ï¼š</p>
<ul>
<li>åœ¨å¸ƒå±€æ–‡ä»¶æ”¹å˜æ—¶ä¸ä¼šå†è‡ªåŠ¨é‡æ–°æ¨¡ç³Šå¤„ç†ã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡æ³¨å†Œ<code>onGlobalLayoutListener</code>ç›‘å¬å™¨è§£å†³ï¼Œåœ¨å¸ƒå±€æ–‡ä»¶æ”¹å˜æ—¶é‡æ–°è¿›è¡Œæ¨¡ç³Šå¤„ç†å°±å¯ä»¥äº†ã€‚</li>
<li>è¿™ä¸ªæ¨¡ç³Šå¤„ç†æ“ä½œæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­è¿›è¡Œçš„ã€‚æˆ‘ä»¬çŸ¥é“åœ¨å®é™…å¼€å‘ä¸­ä¸ä¼šè¿™ä¹ˆåšï¼Œä½†æ˜¯ä¸ºäº†æ–¹ä¾¿æš‚æ—¶å…ˆè¿™ä¹ˆåšäº†ã€‚</li>
</ul>
<p>ç°åœ¨å›åˆ°<code>blur()</code>æ–¹æ³•ï¼š</p>
<ul>
<li>é¦–å…ˆæˆ‘åˆ›å»ºäº†ä¸€ä¸ªç©ºçš„bitmapï¼ŒæŠŠèƒŒæ™¯çš„ä¸€éƒ¨åˆ†å¤åˆ¶è¿›å»ï¼Œä¹‹åæˆ‘ä¼šå¯¹è¿™ä¸ªbitmapè¿›è¡Œæ¨¡ç³Šå¤„ç†å¹¶è®¾ç½®ä¸º<code>TextView</code>çš„èƒŒæ™¯ã€‚</li>
<li>é€šè¿‡è¿™ä¸ªbitmapä¿å­˜<code>Canvas</code>çš„çŠ¶æ€ï¼›</li>
<li>åœ¨çˆ¶å¸ƒå±€æ–‡ä»¶ä¸­æŠŠ<code>Canvas</code>ç§»åŠ¨åˆ°<code>TextView</code>çš„ä½ç½®ï¼›</li>
<li>æŠŠ<code>ImageView</code>çš„å†…å®¹ç»˜åˆ°bitmapä¸­ï¼›</li>
<li>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªå’Œ<code>TextView</code>ä¸€æ ·å¤§å°çš„bitmapï¼Œå®ƒåŒ…å«äº†<code>ImageView</code>çš„ä¸€éƒ¨åˆ†å†…å®¹ï¼Œä¹Ÿå°±æ˜¯<code>TextView</code>èƒŒåä¸€å±‚å¸ƒå±€çš„å†…å®¹ï¼›</li>
<li>åˆ›å»ºä¸€ä¸ªRenderscriptçš„å®ä¾‹ï¼›</li>
<li>æŠŠbitmapå¤åˆ¶ä¸€ä»½åˆ°Renderscriptéœ€è¦çš„æ•°æ®ç‰‡ä¸­ï¼›</li>
<li>åˆ›å»ºRenderscriptæ¨¡ç³Šå¤„ç†çš„å®ä¾‹ï¼›</li>
<li>è®¾ç½®è¾“å…¥ï¼ŒåŠå¾„èŒƒå›´ç„¶åè¿›è¡Œæ¨¡ç³Šå¤„ç†ï¼›</li>
<li>æŠŠå¤„ç†åçš„ç»“æœå¤åˆ¶å›ä¹‹å‰çš„bitmapä¸­ï¼›</li>
<li>å¥½äº†ï¼Œæˆ‘ä»¬å·²ç»æŠŠbitmapæƒŠé†’æ¨¡ç³Šå¤„ç†äº†ï¼Œå¯ä»¥å°†å®ƒè®¾ç½®ä¸º<code>TextView</code>èƒŒæ™¯äº†ï¼›</li>
</ul>
<p>è¿™æ˜¯æˆ‘ä»¬å¤„ç†åçš„æ•ˆæœï¼š</p>
<p><a href="http://www.linuxeden.com/upimg/allimg/140328/0S1032447-1.png" title="Androidé«˜çº§æ¨¡ç³ŠæŠ€æœ¯" target="_blank" rel="noopener"><img src="http://www.linuxeden.com/upimg/allimg/140328/0S1032447-1.png" alt="2"></a></p>
<p>å¯ä»¥çœ‹åˆ°æ•ˆæœè¿˜ä¸é”™ï¼Œä½†æ˜¯å®ƒç”¨äº†57msçš„æ—¶é—´ã€‚æˆ‘ä»¬çŸ¥é“åœ¨Androidä¸­æ¸²æŸ“ä¸€å¸§çš„æ—¶é—´åº”è¯¥ä¸è¶…è¿‡16msï¼ˆ60fpsï¼‰ï¼Œä½†å¦‚æœåœ¨UIçº¿ç¨‹ä¸­åšæ¨¡ç³Šå¤„ç†å°±ä¼šè®©å¸§ç‡é™åˆ°äº†17fpsã€‚æ˜¾ç„¶è¿™æ˜¯ä¸å¯æ¥å—çš„ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªæ“ä½œç§»åˆ°<strong>AsyncTask</strong>ä¸Šæˆ–è€…ä½¿ç”¨åˆ«çš„æœºåˆ¶å®ç°ã€‚</p>
<p>è€Œä¸”æœ‰å¿…è¦è¯´æ˜çš„æ˜¯ï¼Œ<strong>ScriptIntrinsicBlur</strong>åªæ”¯æŒAPI17ä»¥ä¸Šï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨Renderscriptçš„<strong>support lib</strong>é™ä½ä¸€äº›APIç‰ˆæœ¬çš„è¦æ±‚ã€‚</p>
<p>å¯æ˜¯æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æ”¯æŒä¸€äº›è€ä¸€äº›çš„APIç‰ˆæœ¬ï¼Œå®ƒä»¬ä¸æ”¯æŒRenderscriptï¼Œç°åœ¨æˆ‘ä»¬çœ‹çœ‹è¯¥æ€ä¹ˆåŠå§ã€‚</p>
<h3 id="FastBlur"><a href="#FastBlur" class="headerlink" title="FastBlur"></a>FastBlur</h3><p>å› ä¸ºæˆ‘ä»¬çŸ¥é“ï¼Œè¿™ç§æ¨¡ç³Šå¤„ç†çš„è¿‡ç¨‹ä¹Ÿå°±æ˜¯åƒç´ å¤„ç†è€Œå·²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•ç€æ‰‹åŠ¨è¿›è¡Œæ¨¡ç³Šæ“ä½œã€‚å¹¸è¿çš„æ˜¯ï¼ŒJavaä¸Šå·²ç»æœ‰äº†å¾ˆå¤šå®ç°æ¨¡ç³Šå¤„ç†æ–¹æ¡ˆçš„ä¾‹å­ã€‚æˆ‘ä»¬å”¯ä¸€è¦åšçš„å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªç›¸å¯¹å¿«é€Ÿçš„å®ç°æ–¹æ¡ˆã€‚</p>
<p>æ„Ÿè°¢åœ¨StackOverFlowä¸Šçš„ä¸€ç¯‡å¸–å­ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªèƒ½å¿«é€Ÿå®ç°æ¨¡ç³Šå¤„ç†çš„æ–¹æ¡ˆã€‚å…ˆçœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆæ ·çš„ã€‚</p>
<p>å› ä¸ºå¾ˆå¤šä»£ç éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¿™é‡Œåªè®¨è®ºå…³äºæ¨¡ç³Šå¤„ç†çš„å‡½æ•°ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">private void blur(Bitmap bkg, View view) {<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">    long startMs = System.currentTimeMillis();<br></span><span style="color: #008080;"> 3</span> <span style="color: #000000;">    float radius = 20;<br></span><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span> <span style="color: #000000;">    Bitmap overlay = Bitmap.createBitmap((int) (view.getMeasuredWidth()),<br></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">            (int) (view.getMeasuredHeight()), Bitmap.Config.ARGB_8888);<br></span><span style="color: #008080;"> 7</span> <span style="color: #000000;">    Canvas canvas = new Canvas(overlay);<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">    canvas.translate(-view.getLeft(), -view.getTop());<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">    canvas.drawBitmap(bkg, 0, 0, null);<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">    overlay = FastBlur.doBlur(overlay, (int)radius, true);<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">    view.setBackground(new BitmapDrawable(getResources(), overlay));<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">    statusText.setText(System.currentTimeMillis() - startMs + â€œmsâ€);<br></span><span style="color: #008080;">13</span> }</pre><br></div>

<p>å®ç°çš„æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><a href="http://www.linuxeden.com/upimg/allimg/140328/0S10323F-2.png" title="Androidé«˜çº§æ¨¡ç³ŠæŠ€æœ¯" target="_blank" rel="noopener"><img src="http://www.linuxeden.com/upimg/allimg/140328/0S10323F-2.png" alt="3"></a></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ¨¡ç³Šå¤„ç†çš„æ•ˆæœä¹Ÿç›¸å½“ä¸é”™ã€‚ä½¿ç”¨FastBlurçš„å¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å»æ‰å¯¹Renderscriptçš„ä¾èµ–ï¼ˆè¿˜æœ‰æœ€ä½APIç‰ˆæœ¬çš„é™åˆ¶ï¼‰ã€‚ä½†æ˜¯å¯æ¶çš„æ˜¯ï¼Œç†æ¨¡ç³Šæ“ä½œç«Ÿç„¶èŠ±è´¹äº†147msï¼è¿™è¿˜ä¸æ˜¯æœ€æ…¢çš„<strong>SW</strong>æ¨¡ç³Šç®—æ³•ï¼Œæˆ‘éƒ½ä¸æ•¢ç”¨é«˜æ–¯æ¨¡ç³Šäº†&hellip;</p>
<h3 id="ç»§ç»­æ·±å…¥"><a href="#ç»§ç»­æ·±å…¥" class="headerlink" title="ç»§ç»­æ·±å…¥"></a>ç»§ç»­æ·±å…¥</h3><p>ç°åœ¨æˆ‘ä»¬è¦æƒ³æƒ³è¯¥æ€ä¹ˆåšã€‚æ¨¡ç³Šå¤„ç†çš„è¿‡ç¨‹éƒ½ä¼šæœ‰ç²¾åº¦æŸå¤±ï¼Œä½ çŸ¥é“ä»€ä¹ˆæ˜¯ç²¾åº¦æŸå¤±å—ï¼Ÿå¯¹ï¼Œè¦é™ä½å°ºå¯¸ã€‚</p>
<p>æ—¢ç„¶è¿™æ ·ï¼Œä¸ºä»€ä¹ˆä¸æŠŠbitmapçš„å°ºå¯¸å…ˆé™ä½ç„¶åè¿›è¡Œæ¨¡ç³Šå¤„ç†ï¼Œç„¶åå†æ”¾å¤§å°ºå¯¸å‘¢ï¼Ÿæˆ‘è¯•ç€å®ç°äº†ä¸€ä¸‹è¿™ä¸ªæƒ³æ³•ï¼Œè¿™æ˜¯å¤„ç†åå¾—åˆ°çš„æ•ˆæœï¼š</p>
<p><a href="http://www.linuxeden.com/upimg/allimg/140328/0S10345Z-3.png" title="Androidé«˜çº§æ¨¡ç³ŠæŠ€æœ¯" target="_blank" rel="noopener"><img src="http://www.linuxeden.com/upimg/allimg/140328/0S10345Z-3.png" alt="4"></a></p>
<p>çœ‹åˆ°äº†å—ï¼Renderscriptåªç”¨äº†13msï¼ŒFastBluråªç”¨äº†2msï¼è¿˜ä¸é”™ã€‚</p>
<p>å†çœ‹çœ‹ä»£ç ã€‚è¿™é‡Œåªè®¨è®ºFastBlurç‰ˆæœ¬ï¼Œå› ä¸ºRenderscriptä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå…¨éƒ¨ä»£ç éƒ½å¯ä»¥ä»<span class="wp_keywordlink"><a href="http://blog.jobbole.com/6492/" title="GitHubå¦‚ä½•è¿ä½œç³»åˆ—æ–‡ç« " target="_blank" rel="noopener">GitHub</a></span>ä»“åº“ä¸­æ£€å‡ºã€‚</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">private void blur(Bitmap bkg, View view) {<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">    long startMs = System.currentTimeMillis();<br></span><span style="color: #008080;"> 3</span> <span style="color: #000000;">    float scaleFactor = 1;<br></span><span style="color: #008080;"> 4</span> <span style="color: #000000;">    float radius = 20;<br></span><span style="color: #008080;"> 5</span> <span style="color: #000000;">    if (downScale.isChecked()) {<br></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">        scaleFactor = 8;<br></span><span style="color: #008080;"> 7</span> <span style="color: #000000;">        radius = 2;<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #000000;">    Bitmap overlay = Bitmap.createBitmap((int) (view.getMeasuredWidth()/scaleFactor),<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">            (int) (view.getMeasuredHeight()/scaleFactor), Bitmap.Config.ARGB_8888);<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">    Canvas canvas = new Canvas(overlay);<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">    canvas.translate(-view.getLeft()/scaleFactor, -view.getTop()/scaleFactor);<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">    canvas.scale(1 / scaleFactor, 1 / scaleFactor);<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">    Paint paint = new Paint();<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    paint.setFlags(Paint.FILTER_BITMAP_FLAG);<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">    canvas.drawBitmap(bkg, 0, 0, paint);<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span> <span style="color: #000000;">    overlay = FastBlur.doBlur(overlay, (int)radius, true);<br></span><span style="color: #008080;">20</span> <span style="color: #000000;">    view.setBackground(new BitmapDrawable(getResources(), overlay));<br></span><span style="color: #008080;">21</span> <span style="color: #000000;">    statusText.setText(System.currentTimeMillis() - startMs + â€œmsâ€);<br></span><span style="color: #008080;">22</span> }</pre><br></div>

<p>æˆ‘ä»¬è¿‡ä¸€éè¿™ä¸ªä»£ç ï¼š</p>
<ul>
<li><strong>scaleFactor</strong>æä¾›äº†éœ€è¦ç¼©å°çš„ç­‰çº§ï¼Œåœ¨ä»£ç ä¸­æˆ‘æŠŠbitmapçš„å°ºå¯¸ç¼©å°åˆ°åŸå›¾çš„1/8ã€‚å› ä¸ºè¿™ä¸ªbitmapåœ¨æ¨¡ç³Šå¤„ç†æ—¶ä¼šå…ˆè¢«ç¼©å°ç„¶åå†æ”¾å¤§ï¼Œæ‰€ä»¥åœ¨æˆ‘çš„æ¨¡ç³Šç®—æ³•ä¸­å°±ä¸ç”¨<strong>radius</strong>è¿™ä¸ªå‚æ•°äº†ï¼Œæ‰€ä»¥æŠŠå®ƒè®¾æˆ2ã€‚</li>
<li>æ¥ç€éœ€è¦åˆ›å»ºbitmapï¼Œè¿™ä¸ªbitmapæ¯”æœ€åéœ€è¦çš„å°å…«å€ã€‚</li>
<li>è¯·æ³¨æ„æˆ‘ç»™<strong>Paint</strong>æä¾›äº†<strong>FILTER_BITMAP_FLAG</strong>æ ‡ç¤ºï¼Œè¿™æ ·çš„è¯åœ¨å¤„ç†bitmapç¼©æ”¾çš„æ—¶å€™ï¼Œå°±å¯ä»¥è¾¾åˆ°åŒç¼“å†²çš„æ•ˆæœï¼Œæ¨¡ç³Šå¤„ç†çš„è¿‡ç¨‹å°±æ›´åŠ é¡ºç•…äº†ã€‚</li>
<li>æ¥ä¸‹æ¥å’Œä¹‹å‰ä¸€æ ·è¿›è¡Œæ¨¡ç³Šå¤„ç†æ“ä½œï¼Œè¿™æ¬¡çš„å›¾ç‰‡å°äº†å¾ˆå¤šï¼Œå¹…åº¦ä¹Ÿé™ä½äº†å¾ˆå¤šï¼Œæ‰€ä»¥æ¨¡ç³Šè¿‡ç¨‹éå¸¸å¿«ã€‚</li>
<li>æŠŠæ¨¡ç³Šå¤„ç†åçš„å›¾ç‰‡ä½œä¸ºèƒŒæ™¯ï¼Œå®ƒä¼šè‡ªåŠ¨è¿›è¡Œæ”¾å¤§æ“ä½œçš„ã€‚</li>
</ul>
<p>ä¹‹å‰è¯´åˆ°FastBlurè¿›è¡Œæ¨¡ç³Šæ“ä½œæ¯”Renderscriptè¿˜è¦å¿«ï¼Œè¿™æ˜¯å› ä¸ºFastBluråœ¨è¿›è¡Œbitmapå¤åˆ¶æ“ä½œæ—¶è¿˜ä¼šåŒæ—¶è¿›è¡Œå…¶ä»–æ“ä½œï¼ŒèŠ‚çœäº†æ—¶é—´ã€‚ç»è¿‡äº†è¿™äº›å¤„ç†åï¼Œæˆ‘ä»¬åº”è¯¥å·²ç»æŒæ¡äº†ç›¸å¯¹å¿«é€Ÿçš„æ¨¡ç³Šå¤„ç†æ–¹æ¡ˆå’ŒåŸç†ï¼Œå¹¶å»æ‰äº†å¯¹Renderscriptçš„ä¾èµ–ã€‚</p>
<p>æœ¬æ–‡çš„ç¤ºä¾‹ä»£ç ï¼š<a href="https://github.com/paveldudka/blurring" target="_blank" rel="noopener">GitHub &ndash; blurring</a>ã€‚</p>
<p>&nbsp;</p>
<p><span>åŸæ–‡é“¾æ¥ï¼š&nbsp;</span><a href="http://trickyandroid.com/advanced-blurring-techniques/" target="_blank" rel="noopener">trickyandroid</a><span>&nbsp;&nbsp;&nbsp;ç¿»è¯‘ï¼š&nbsp;</span><a href="http://blog.jobbole.com/" target="_blank" rel="noopener">ä¼¯ä¹åœ¨çº¿&nbsp;</a><span>-&nbsp;</span><a href="http://blog.jobbole.com/author/chris/" target="_blank" rel="noopener">chris</a><br><span>è¯‘æ–‡é“¾æ¥ï¼š&nbsp;</span><a href="http://blog.jobbole.com/63894/" target="_blank" rel="noopener">http://blog.jobbole.com/63894/</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> blur </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]AndroidInjectå¢åŠ sqlite3æ•°æ®åº“æ˜ å°„æ³¨è§£(ORM)]]></title>
      <url>/2014/03/25/Android-AndroidInject%E5%A2%9E%E5%8A%A0sqlite3%E6%95%B0%E6%8D%AE%E5%BA%93%E6%98%A0%E5%B0%84%E6%B3%A8%E8%A7%A3-ORM/</url>
      <content type="html"><![CDATA[<p>AndroidInjecté¡¹ç›®æ˜¯æˆ‘å†™çš„ä¸€ä¸ªä½¿ç”¨æ³¨è§£æ³¨å…¥æ¥ç®€åŒ–ä»£ç çš„å¼€æºé¡¹ç›®</p>
<p><a href="https://github.com/wangjiegulu/androidInject" target="_blank" rel="noopener">https://github.com/wangjiegulu/androidInject</a></p>
<p>ä»Šå¤©æ–°å¢åŠŸèƒ½å¦‚ä¸‹ï¼š</p>
<p>1. å¢åŠ å¯¹sqlite3æ•°æ®åº“çš„ormæ³¨è§£æ”¯æŒï¼Œå¢åŠ @AIColumnã€@AIPrimaryKeyã€@AITableä¸‰ä¸ªæ³¨è§£æ¥æ˜ å°„åˆ°è¡¨ï¼ˆæœ‰å¾…æ”¹è¿›ï¼‰</p>
<p>2. ä½¿ç”¨åå°„æ¥å°è£…AIDbExecutorç±»ï¼Œå®ç°åŠè‡ªåŠ¨åŒ–ormï¼Œç±»ä¼¼mybatis</p>
<p><img src="http://images.cnitblog.com/i/378300/201403/251333009205565.png" alt=""></p>
<p>ã€€ã€€å…ˆè¯´è¯´ä½¿ç”¨çš„æ–¹å¼å§</p>
<p>ã€€ã€€ä¸€. æ–°å»ºDatabaseHelperï¼Œç»§æ‰¿AIDatabaseHelperï¼ˆAndroidInjectæä¾›ï¼Œç›´æ¥ç»§æ‰¿äº†SQLiteOpenHelperï¼‰ï¼Œåœ¨onCreateä¸­è°ƒç”¨å¦‚ä¸‹æ–¹æ³•æ¥æ–°å»ºè¡¨userï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #000000;">@Override<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(SQLiteDatabase db) {<br>        AIDbUtil.createTableIfNotExist(db,<br>                </span>â€œcreate table user(uid INTEGER PRIMARY KEY AUTOINCREMENT, â€œ +<br>                        â€œusername varchar(20), â€œ +<br>                        â€œpassword varchar(20), â€œ +<br>                        â€œcreatemillis long, â€œ +<br>                        â€œheight float, â€œ +<br>                        â€œweight double)â€<span style="color: #000000;">,<br>                </span>â€œuserâ€<span style="color: #000000;">);<br>}</span></pre><br></div>

<p>å…¶ä¸­æ–¹æ³•createTableIfNotExist (SQLiteDatabase db, String sql, String tableName) ç”¨äºæ–°å»ºè¡¨ï¼Œå¦‚æœå­˜åœ¨è¯¥è¡¨ï¼Œåˆ™ä¸åˆ›å»º&nbsp; &nbsp;&nbsp;</p>
<p>ã€€ã€€äºŒ. æ—¢ç„¶æ˜¯ORMï¼Œä¸ç®¡æ€ä¹ˆæ ·ï¼Œæ€»è¦åœ¨è¡¨ä¸æŒä¹…å±‚å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œæ‰€ä»¥æ–°å»ºè¡¨å®Œæ¯•ä¹‹åï¼Œå°±è¦æ–°å»ºç±»Userï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Created with IntelliJ IDEA.<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Author: wangjie  email:tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 14-3-25<br></span><span style="color: #008080;"> 5</span> <span style="color: #008000;"> <em> Time: ä¸Šåˆ10:04<br></em></span><span style="color: #008080;"> 6</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 7</span> <span style="color: #000000;">@AITable(â€œuserâ€)<br></span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> User <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Serializable{<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">    @AIColumn<br></span><span style="color: #008080;">10</span>     @AIPrimaryKey(insertable = <span style="color: #0000ff;">false</span><span style="color: #000000;">)<br></span><span style="color: #008080;">11</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> uid;<br></span><span style="color: #008080;">12</span>     @AIColumn(â€œusernameâ€<span style="color: #000000;">)<br></span><span style="color: #008080;">13</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String username;<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">    @AIColumn<br></span><span style="color: #008080;">15</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String password;<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    @AIColumn<br></span><span style="color: #008080;">17</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> createmillis;<br></span><span style="color: #008080;">18</span> <span style="color: #000000;">    @AIColumn<br></span><span style="color: #008080;">19</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">float</span><span style="color: #000000;"> height;<br></span><span style="color: #008080;">20</span> <span style="color: #000000;">    @AIColumn<br></span><span style="color: #008080;">21</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">double</span><span style="color: #000000;"> weight;<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String notCol;<br></span><span style="color: #008080;">24</span>     // getter/setterâ€¦<br><span style="color: #008080;">25</span> }</pre><br></div>

<p>å¦‚ä¸Šé¢çš„ä»£ç æ‰€ç¤ºï¼š</p>
<p>@AITable&nbsp;ç±»æ³¨è§£ï¼Œç”¨äºæ˜ å°„ç±»åˆ°è¡¨ï¼Œ value()è¡¨ç¤ºè¦æ˜ å°„åˆ°çš„è¡¨çš„åç§°ï¼Œä¸å¡«å†™æˆ–æœªå¢åŠ è¯¥æ³¨è§£åˆ™é»˜è®¤ä»¥ç±»åå°å†™ä¸ºè¡¨å</p>
<p>@AIPrimaryKey&nbsp;å±æ€§æ³¨è§£ï¼Œç”¨äºæŒ‡å®šå±æ€§ä¸ºä¸»é”®ï¼Œinsertable()è¡¨ç¤ºæ’å…¥æ•°æ®æ—¶æ˜¯å¦åŒæ—¶ä¹Ÿæ’å…¥ä¸»é”®åˆ°è¡¨ã€‚é»˜è®¤ä¸ºfalseï¼Œå³è¡¨çš„ä¸»é”®åº”è¯¥ä¸ºè‡ªåŠ¨ç”Ÿæˆ</p>
<p>@AIColumn&nbsp;å±æ€§æ³¨è§£ï¼Œç”¨äºæ˜ å°„å±æ€§åˆ°è¡¨å­—æ®µï¼Œvalue()è¡¨ç¤ºè¦æ˜ å°„åˆ°çš„è¡¨å­—æ®µåç§°ï¼Œä¸å¡«å†™åˆ™é»˜è®¤ä»¥å±æ€§åä½œä¸ºè¡¨å­—æ®µå</p>
<p>è¿™æ ·ï¼Œç±»å’Œè¡¨ä¹‹é—´å°±ç”¨ä»¥ä¸Šçš„å‡ ä¸ªæ³¨è§£è¿›è¡Œäº†æ˜ å°„ã€‚</p>
<p>&nbsp; &nbsp; ä¸‰. AndroidInjectæä¾›äº†ä¸€ä¸ªAIDbExecutoræŠ½è±¡ç±»æ¥å¯¹è¡¨æ•°æ®è¿›è¡Œæ“ä½œï¼Œä½¿ç”¨æ—¶éœ€è¦è‡ªå·±ç¼–å†™ä¸€ä¸ªDbExecutoræ¥ç»§æ‰¿AIDbExecutorï¼Œå¹¶å®ç°obtainDbHelper()æ–¹æ³•ï¼Œç”¨äºæä¾›ç»™DbExecutorä¸€ä¸ªAIDatabaseHelperã€‚å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> DbExecutor&lt;T&gt; <span style="color: #0000ff;">extends</span> AIDbExecutor&lt;T&gt;<span style="color: #000000;">{<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> String TAG = DbExecutor.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName();<br></span><span style="color: #008080;"> 3</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> String DB_NAME = â€œandroidinject_dbâ€<span style="color: #000000;">;<br></span><span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> VERSION = 1<span style="color: #000000;">;<br></span><span style="color: #008080;"> 5</span><br><span style="color: #008080;"> 6</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> DbExecutor(Context context) {<br></span><span style="color: #008080;"> 7</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context);<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">11</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> AIDatabaseHelper obtainDbHelper() {<br></span><span style="color: #008080;">12</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> DatabaseHelper(context, DB_NAME, VERSION);<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span> }</pre><br></div>

<p>&nbsp; &nbsp;æ¥ä¸‹æ¥å°±å¯ä»¥ç›´æ¥ä½¿ç”¨AIDbExecutoræ¥è¿›è¡Œæ•°æ®åº“çš„æ“ä½œäº†ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">//</span><span style="color: #008000;"> åˆ›å»ºä¸€ä¸ªç”¨äºæ“ä½œuserè¡¨çš„dbExecutorå¯¹è±¡</span><br>AIDbExecutor&lt;User&gt; userExecutor = <span style="color: #0000ff;">new</span> DbExecutor&lt;User&gt;<span style="color: #000000;">(context);<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;"> æ’å…¥ä¸€æ¡useræ•°æ®ï¼š</span><br>User dbUser = <span style="color: #0000ff;">new</span> User(â€œwangjieâ€ + rd.nextInt(10000), String.valueOf(rd.nextInt(10000) + 10000), System.currentTimeMillis(), rd.nextInt(80) + 120, rd.nextInt(80) + 120, â€œaaaaâ€<span style="color: #000000;">);<br>userExecutor.executeSave(dbUser);<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;"> æŸ¥è¯¢userè¡¨</span><br>List&lt;User&gt; users = userExecutor.executeQuery(â€œselect * from user where uid &gt; ?â€, <span style="color: #0000ff;">new</span> String[]{â€œ4â€}, User.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;"> åˆ é™¤userè¡¨ä¸­çš„ä¸€æ¡æ•°æ®</span><br>userExecutor.executeDelete(users.get(0<span style="color: #000000;">));<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;"> æ›´æ–°userè¡¨ä¸­çš„ä¸€æ¡æ•°æ®</span><br>User user = users.get(0<span style="color: #000000;">);<br>user.setUsername(user.getUsername().startsWith(</span>â€œwangjieâ€) ? â€œjiewangâ€ + rd.nextInt(10000) : â€œwangjieâ€ + rd.nextInt(10000<span style="color: #000000;">));<br>user.setPassword(user.getPassword().startsWith(</span>â€œ123456â€) ? â€œabcdefâ€ : â€œ123456â€<span style="color: #000000;">);<br>user.setCreatemillis(System.currentTimeMillis());<br>user.setHeight(rd.nextInt(</span>80) + 120<span style="color: #000000;">);<br>user.setWeight(rd.nextInt(</span>80) + 120<span style="color: #000000;">);<br>user.setNotCol(</span>â€œbbbâ€<span style="color: #000000;">);<br>userExecutor.executeUpdate(user, </span><span style="color: #0000ff;">null</span>, <span style="color: #0000ff;">new</span> String[]{â€œcreatemillisâ€});</pre><br></div>

<p>å››. AIDbExecutorç±»ä¸­æä¾›çš„æ–¹æ³•æœ‰ï¼š</p>
<p>1. public List&lt;T&gt; executeQuery(String sql, String[] selectionArgs, Class&lt;?&gt; clazz) throws Exception;</p>
<p>ç”¨äºæŸ¥è¯¢è¡¨ï¼Œå¹¶è‡ªåŠ¨å°è£…åˆ°List&lt;T&gt;ä¸­ï¼Œå‘Šåˆ«Cursor</p>
<p>2.&nbsp;public int executeSave(final T obj) throws Exception;</p>
<p>ç”¨äºä¿å­˜ä¸€æ¡æ•°æ®</p>
<p>3.&nbsp;public int executeUpdate(final T obj, final String[] includeParams, final String[] excludeParams) throws Exception;</p>
<p>ç”¨äºæ›´æ–°ä¸€æ¡æ•°æ®ï¼Œæ›´æ–°æ•°æ®æ—¶ï¼Œæ˜¯æ ¹æ®ä¸»é”®å»æ›´æ–°å…¶ä»–å­—æ®µçš„ã€‚å¯ä»¥å¯¹å…¶ä»–è¦æ›´æ–°çš„å­—æ®µè¿›è¡ŒåŒ…å«å’Œæ’é™¤ï¼ˆå¡«å†™ç±»çš„å±æ€§ï¼‰ã€‚</p>
<p>æ³¨æ„ï¼šåŒ…å«åœ¨includeParamsï¼Œå¹¶ä¸”ä¸åŒ…å«åœ¨excludeParamsä¸­æ‰ä¼šè¢«æ›´æ–°ã€‚</p>
<p>4.&nbsp;public int executeDelete(final T obj) throws Exception;</p>
<p>åˆ é™¤ä¸€æ¡æ•°æ®ï¼Œæ ¹æ®ä¸»é”®åˆ é™¤ä¸€æ¡æ•°æ®</p>
<p>5.&nbsp;public void executeSql(String sql, Object[] selectionArgs) throws Exception;</p>
<p>æ‰§è¡Œä¸€æ¡sqlè¯­å¥ï¼ˆinsertã€updateã€deleteï¼‰</p>
<p>6. åŒæ—¶æä¾›äº†ç”ŸæˆSQLiteDatabaseå¯¹è±¡çš„æ–¹æ³•</p>
<p>public SQLiteDatabase getReadableDatabase();</p>
<p>public SQLiteDatabase getWritableDatabase();</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> orm </tag>
            
            <tag> library </tag>
            
            <tag> database </tag>
            
            <tag> sqlite </tag>
            
            <tag> inject </tag>
            
            <tag> sqlite3 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java8 Lambdaè¡¨è¾¾å¼æ•™ç¨‹]]></title>
      <url>/2014/03/20/Java8-Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%95%99%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>è½¬è‡ªï¼š<a href="http://blog.csdn.net/ioriogami/article/details/12782141" target="_blank" rel="noopener">http://blog.csdn.net/ioriogami/article/details/12782141</a></p>
<p>&nbsp;</p>
<p><span><strong>1. ä»€ä¹ˆæ˜¯&lambda;è¡¨è¾¾å¼</strong></span></p>
<p>&lambda;è¡¨è¾¾å¼æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŒ¿åæ–¹æ³•ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; public int add(int x, int y) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return x + y;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>è½¬æˆ&lambda;è¡¨è¾¾å¼åæ˜¯è¿™ä¸ªæ ·å­ï¼š<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; (int x, int y) -&gt; x + y;</p>
<p>å‚æ•°ç±»å‹ä¹Ÿå¯ä»¥çœç•¥ï¼ŒJavaç¼–è¯‘å™¨ä¼šæ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­å‡ºæ¥ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; (x, y) -&gt; x + y; //è¿”å›ä¸¤æ•°ä¹‹å’Œ<br>&nbsp;<br>æˆ–è€…</p>
<p>&nbsp;&nbsp;&nbsp; (x, y) -&gt; { return x + y; } //æ˜¾å¼æŒ‡æ˜è¿”å›å€¼</p>
<p>å¯è§&lambda;è¡¨è¾¾å¼æœ‰ä¸‰éƒ¨åˆ†ç»„æˆï¼šå‚æ•°åˆ—è¡¨ï¼Œç®­å¤´ï¼ˆ-&gt;ï¼‰ï¼Œä»¥åŠä¸€ä¸ªè¡¨è¾¾å¼æˆ–è¯­å¥å—ã€‚</p>
<p>ä¸‹é¢è¿™ä¸ªä¾‹å­é‡Œçš„&lambda;è¡¨è¾¾å¼æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿæ²¡æœ‰è¿”å›å€¼ï¼ˆç›¸å½“äºä¸€ä¸ªæ–¹æ³•æ¥å—0ä¸ªå‚æ•°ï¼Œè¿”å›voidï¼Œå…¶å®å°±æ˜¯Runnableé‡Œrunæ–¹æ³•çš„ä¸€ä¸ªå®ç°ï¼‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; () -&gt; { System.out.println(â€œHello Lambda!â€); }</p>
<p>å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ä¸”å¯ä»¥è¢«Javaæ¨æ–­å‡ºç±»å‹ï¼Œé‚£ä¹ˆå‚æ•°åˆ—è¡¨çš„æ‹¬å·ä¹Ÿå¯ä»¥çœç•¥ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; c -&gt; { return c.size(); }</p>
<p>&nbsp;</p>
<p><span><strong>2. &lambda;è¡¨è¾¾å¼çš„ç±»å‹ï¼ˆå®ƒæ˜¯Objectå—ï¼Ÿï¼‰</strong></span></p>
<p>&lambda;è¡¨è¾¾å¼å¯ä»¥è¢«å½“åšæ˜¯ä¸€ä¸ªObjectï¼ˆæ³¨æ„æªè¾ï¼‰ã€‚&lambda;è¡¨è¾¾å¼çš„ç±»å‹ï¼Œå«åš&ldquo;ç›®æ ‡ç±»å‹ï¼ˆtarget typeï¼‰&rdquo;ã€‚&lambda;è¡¨è¾¾å¼çš„ç›®æ ‡ç±»å‹æ˜¯&ldquo;å‡½æ•°æ¥å£ï¼ˆfunctional interfaceï¼‰&rdquo;ï¼Œè¿™æ˜¯Java8æ–°å¼•å…¥çš„æ¦‚å¿µã€‚å®ƒçš„å®šä¹‰æ˜¯ï¼šä¸€ä¸ªæ¥å£ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªæ˜¾å¼å£°æ˜çš„æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªå‡½æ•°æ¥å£ã€‚ä¸€èˆ¬ç”¨@FunctionalInterfaceæ ‡æ³¨å‡ºæ¥ï¼ˆä¹Ÿå¯ä»¥ä¸æ ‡ï¼‰ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; @FunctionalInterface<br>&nbsp;&nbsp;&nbsp; public interface Runnable { void run(); }<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; public interface Callable&lt;V&gt; { V call() throws Exception; }<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; public interface ActionListener { void actionPerformed(ActionEvent e); }<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; public interface Comparator&lt;T&gt; { int compare(T o1, T o2); boolean equals(Object obj); }</p>
<p>æ³¨æ„æœ€åè¿™ä¸ªComparatoræ¥å£ã€‚å®ƒé‡Œé¢å£°æ˜äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œè²Œä¼¼ä¸ç¬¦åˆå‡½æ•°æ¥å£çš„å®šä¹‰ï¼Œä½†å®ƒçš„ç¡®æ˜¯å‡½æ•°æ¥å£ã€‚è¿™æ˜¯å› ä¸ºequalsæ–¹æ³•æ˜¯Objectçš„ï¼Œæ‰€æœ‰çš„æ¥å£éƒ½ä¼šå£°æ˜Objectçš„publicæ–¹æ³•&mdash;&mdash;è™½ç„¶å¤§å¤šæ˜¯éšå¼çš„ã€‚æ‰€ä»¥ï¼ŒComparatoræ˜¾å¼çš„å£°æ˜äº†equalsä¸å½±å“å®ƒä¾ç„¶æ˜¯ä¸ªå‡½æ•°æ¥å£ã€‚</p>
<p>ä½ å¯ä»¥ç”¨ä¸€ä¸ª&lambda;è¡¨è¾¾å¼ä¸ºä¸€ä¸ªå‡½æ•°æ¥å£èµ‹å€¼ï¼š<br>&nbsp;<br>&nbsp;&nbsp;&nbsp; Runnable r1 = () -&gt; {System.out.println(â€œHello Lambda!â€);};<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>ç„¶åå†èµ‹å€¼ç»™ä¸€ä¸ªObjectï¼š</p>
<p>&nbsp;&nbsp;&nbsp; Object obj = r1;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>ä½†å´ä¸èƒ½è¿™æ ·å¹²ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; Object obj = () -&gt; {System.out.println(â€œHello Lambda!â€);}; // ERROR! Object is not a functional interface!</p>
<p>å¿…é¡»æ˜¾å¼çš„è½¬å‹æˆä¸€ä¸ªå‡½æ•°æ¥å£æ‰å¯ä»¥ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; Object o = (Runnable) () -&gt; { System.out.println(â€œhiâ€); }; // correct<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>ä¸€ä¸ª&lambda;è¡¨è¾¾å¼åªæœ‰åœ¨è½¬å‹æˆä¸€ä¸ªå‡½æ•°æ¥å£åæ‰èƒ½è¢«å½“åšObjectä½¿ç”¨ã€‚æ‰€ä»¥ä¸‹é¢è¿™å¥ä¹Ÿä¸èƒ½ç¼–è¯‘ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; System.out.println( () -&gt; {} ); //é”™è¯¯! ç›®æ ‡ç±»å‹ä¸æ˜<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>å¿…é¡»å…ˆè½¬å‹:</p>
<p>&nbsp;&nbsp;&nbsp; System.out.println( (Runnable)() -&gt; {} ); // æ­£ç¡®</p>
<p>å‡è®¾ä½ è‡ªå·±å†™äº†ä¸€ä¸ªå‡½æ•°æ¥å£ï¼Œé•¿çš„è·ŸRunnableä¸€æ¨¡ä¸€æ ·ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; @FunctionalInterface<br>&nbsp;&nbsp;&nbsp; public interface MyRunnable {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void run();<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>é‚£ä¹ˆ</p>
<p>&nbsp;&nbsp;&nbsp; Runnable r1 =&nbsp;&nbsp;&nbsp; () -&gt; {System.out.println(â€œHello Lambda!â€);};<br>&nbsp;&nbsp;&nbsp; MyRunnable2 r2 = () -&gt; {System.out.println(â€œHello Lambda!â€);};</p>
<p>éƒ½æ˜¯æ­£ç¡®çš„å†™æ³•ã€‚è¿™è¯´æ˜ä¸€ä¸ª&lambda;è¡¨è¾¾å¼å¯ä»¥æœ‰å¤šä¸ªç›®æ ‡ç±»å‹ï¼ˆå‡½æ•°æ¥å£ï¼‰ï¼Œåªè¦å‡½æ•°åŒ¹é…æˆåŠŸå³å¯ã€‚<br>ä½†éœ€æ³¨æ„ä¸€ä¸ª&lambda;è¡¨è¾¾å¼å¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ªç›®æ ‡ç±»å‹ã€‚</p>
<p>JDKé¢„å®šä¹‰äº†å¾ˆå¤šå‡½æ•°æ¥å£ä»¥é¿å…ç”¨æˆ·é‡å¤å®šä¹‰ã€‚æœ€å…¸å‹çš„æ˜¯Functionï¼š</p>
<p>&nbsp;&nbsp;&nbsp; @FunctionalInterface<br>&nbsp;&nbsp;&nbsp; public interface Function&lt;T, R&gt; {&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; R apply(T t);<br>&nbsp;&nbsp;&nbsp; }</p>
<p>è¿™ä¸ªæ¥å£ä»£è¡¨ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªTç±»å‹çš„å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªRç±»å‹çš„è¿”å›å€¼ã€‚&nbsp;&nbsp;&nbsp;</p>
<p>å¦ä¸€ä¸ªé¢„å®šä¹‰å‡½æ•°æ¥å£å«åšConsumerï¼Œè·ŸFunctionçš„å”¯ä¸€ä¸åŒæ˜¯å®ƒæ²¡æœ‰è¿”å›å€¼ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; @FunctionalInterface<br>&nbsp;&nbsp;&nbsp; public interface Consumer&lt;T&gt; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void accept(T t);<br>&nbsp;&nbsp;&nbsp; }</p>
<p>è¿˜æœ‰ä¸€ä¸ªPredicateï¼Œç”¨æ¥åˆ¤æ–­æŸé¡¹æ¡ä»¶æ˜¯å¦æ»¡è¶³ã€‚ç»å¸¸ç”¨æ¥è¿›è¡Œç­›æ»¤æ“ä½œï¼š<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; @FunctionalInterface<br>&nbsp;&nbsp;&nbsp; public interface Predicate&lt;T&gt; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boolean test(T t);<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>ç»¼ä¸Šæ‰€è¿°ï¼Œä¸€ä¸ª&lambda;è¡¨è¾¾å¼å…¶å®å°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œåªä¸è¿‡è¿™ä¸ªæ–¹æ³•å¿…é¡»ç¬¦åˆè‡³å°‘ä¸€ä¸ªå‡½æ•°æ¥å£ã€‚<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><span><strong>3. &lambda;è¡¨è¾¾å¼çš„ä½¿ç”¨</strong></span></p>
<p><span><strong>3.1 &lambda;è¡¨è¾¾å¼ç”¨åœ¨ä½•å¤„</strong></span></p>
<p>&lambda;è¡¨è¾¾å¼ä¸»è¦ç”¨äºæ›¿æ¢ä»¥å‰å¹¿æ³›ä½¿ç”¨çš„å†…éƒ¨åŒ¿åç±»ï¼Œå„ç§å›è°ƒï¼Œæ¯”å¦‚äº‹ä»¶å“åº”å™¨ã€ä¼ å…¥Threadç±»çš„Runnableç­‰ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; Thread oldSchool = new Thread( new Runnable () {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Override<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void run() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(â€œThis is from an anonymous class.â€);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; } );<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; Thread gaoDuanDaQiShangDangCi = new Thread( () -&gt; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(â€œThis is from an anonymous method (lambda exp).â€);<br>&nbsp;&nbsp;&nbsp; } );</p>
<p>æ³¨æ„ç¬¬äºŒä¸ªçº¿ç¨‹é‡Œçš„&lambda;è¡¨è¾¾å¼ï¼Œä½ å¹¶ä¸éœ€è¦æ˜¾å¼åœ°æŠŠå®ƒè½¬æˆä¸€ä¸ªRunnableï¼Œå› ä¸ºJavaèƒ½æ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨æ¨æ–­å‡ºæ¥ï¼šä¸€ä¸ªThreadçš„æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªRunnableå‚æ•°ï¼Œè€Œä¼ å…¥çš„&lambda;è¡¨è¾¾å¼æ­£å¥½ç¬¦åˆå…¶run()å‡½æ•°ï¼Œæ‰€ä»¥Javaç¼–è¯‘å™¨æ¨æ–­å®ƒä¸ºRunnableã€‚</p>
<p>ä»å½¢å¼ä¸Šçœ‹ï¼Œ&lambda;è¡¨è¾¾å¼åªæ˜¯ä¸ºä½ èŠ‚çœäº†å‡ è¡Œä»£ç ã€‚ä½†å°†&lambda;è¡¨è¾¾å¼å¼•å…¥Javaçš„åŠ¨æœºå¹¶ä¸ä»…ä»…ä¸ºæ­¤ã€‚Java8æœ‰ä¸€ä¸ªçŸ­æœŸç›®æ ‡å’Œä¸€ä¸ªé•¿æœŸç›®æ ‡ã€‚çŸ­æœŸç›®æ ‡æ˜¯ï¼šé…åˆ&ldquo;é›†åˆç±»æ‰¹å¤„ç†æ“ä½œ&rdquo;çš„å†…éƒ¨è¿­ä»£å’Œå¹¶è¡Œå¤„ç†ï¼ˆä¸‹é¢å°†è¦è®²åˆ°ï¼‰ï¼›é•¿æœŸç›®æ ‡æ˜¯å°†Javaå‘å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€è¿™ä¸ªæ–¹å‘å¼•å¯¼ï¼ˆå¹¶ä¸æ˜¯è¦å®Œå…¨å˜æˆä¸€é—¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œåªæ˜¯è®©å®ƒæœ‰æ›´å¤šçš„å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„ç‰¹æ€§ï¼‰ï¼Œä¹Ÿæ­£æ˜¯ç”±äºè¿™ä¸ªåŸå› ï¼ŒOracleå¹¶æ²¡æœ‰ç®€å•åœ°ä½¿ç”¨å†…éƒ¨ç±»å»å®ç°&lambda;è¡¨è¾¾å¼ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€ç§æ›´åŠ¨æ€ã€æ›´çµæ´»ã€æ˜“äºå°†æ¥æ‰©å±•å’Œæ”¹å˜çš„ç­–ç•¥ï¼ˆinvokedynamicï¼‰ã€‚</p>
<p><span><strong>3.2 &lambda;è¡¨è¾¾å¼ä¸é›†åˆç±»æ‰¹å¤„ç†æ“ä½œï¼ˆæˆ–è€…å«å—æ“ä½œï¼‰</strong></span></p>
<p>ä¸Šæ–‡æåˆ°äº†é›†åˆç±»çš„æ‰¹å¤„ç†æ“ä½œã€‚è¿™æ˜¯Java8çš„å¦ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œå®ƒä¸&lambda;è¡¨è¾¾å¼çš„é…åˆä½¿ç”¨ä¹ƒæ˜¯Java8çš„æœ€ä¸»è¦ç‰¹æ€§ã€‚é›†åˆç±»çš„æ‰¹å¤„ç†æ“ä½œAPIçš„ç›®çš„æ˜¯å®ç°é›†åˆç±»çš„&ldquo;å†…éƒ¨è¿­ä»£&rdquo;ï¼Œå¹¶æœŸæœ›å……åˆ†åˆ©ç”¨ç°ä»£å¤šæ ¸CPUè¿›è¡Œå¹¶è¡Œè®¡ç®—ã€‚<br>Java8ä¹‹å‰é›†åˆç±»çš„è¿­ä»£ï¼ˆIterationï¼‰éƒ½æ˜¯å¤–éƒ¨çš„ï¼Œå³å®¢æˆ·ä»£ç ã€‚è€Œå†…éƒ¨è¿­ä»£æ„å‘³ç€æ”¹ç”±Javaç±»åº“æ¥è¿›è¡Œè¿­ä»£ï¼Œè€Œä¸æ˜¯å®¢æˆ·ä»£ç ã€‚ä¾‹å¦‚ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; for(Object o: list) { // å¤–éƒ¨è¿­ä»£<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(o);<br>&nbsp;&nbsp;&nbsp; }</p>
<p>å¯ä»¥å†™æˆï¼š</p>
<p>&nbsp;&nbsp;&nbsp; list.forEach(o -&gt; {System.out.println(o);}); //forEachå‡½æ•°å®ç°å†…éƒ¨è¿­ä»£</p>
<p>é›†åˆç±»ï¼ˆåŒ…æ‹¬Listï¼‰ç°åœ¨éƒ½æœ‰ä¸€ä¸ªforEachæ–¹æ³•ï¼Œå¯¹å…ƒç´ è¿›è¡Œè¿­ä»£ï¼ˆéå†ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦å†å†™forå¾ªç¯äº†ã€‚forEachæ–¹æ³•æ¥å—ä¸€ä¸ªå‡½æ•°æ¥å£Consumeråšå‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨&lambda;è¡¨è¾¾å¼ã€‚</p>
<p>è¿™ç§å†…éƒ¨è¿­ä»£æ–¹æ³•å¹¿æ³›å­˜åœ¨äºå„ç§è¯­è¨€ï¼Œå¦‚C++çš„STLç®—æ³•åº“ã€pythonã€rubyã€scalaç­‰ã€‚</p>
<p>Java8ä¸ºé›†åˆç±»å¼•å…¥äº†å¦ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼šæµï¼ˆstreamï¼‰ã€‚ä¸€ä¸ªæµé€šå¸¸ä»¥ä¸€ä¸ªé›†åˆç±»å®ä¾‹ä¸ºå…¶æ•°æ®æºï¼Œç„¶ååœ¨å…¶ä¸Šå®šä¹‰å„ç§æ“ä½œã€‚æµçš„APIè®¾è®¡ä½¿ç”¨äº†ç®¡é“ï¼ˆpipelinesï¼‰æ¨¡å¼ã€‚å¯¹æµçš„ä¸€æ¬¡æ“ä½œä¼šè¿”å›å¦ä¸€ä¸ªæµã€‚å¦‚åŒIOçš„APIæˆ–è€…StringBufferçš„appendæ–¹æ³•é‚£æ ·ï¼Œä»è€Œå¤šä¸ªä¸åŒçš„æ“ä½œå¯ä»¥åœ¨ä¸€ä¸ªè¯­å¥é‡Œä¸²èµ·æ¥ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; List&lt;Shape&gt; shapes = â€¦<br>&nbsp;&nbsp;&nbsp; shapes.stream()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .filter(s -&gt; s.getColor() == BLUE)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .forEach(s -&gt; s.setColor(RED));</p>
<p>é¦–å…ˆè°ƒç”¨streamæ–¹æ³•ï¼Œä»¥é›†åˆç±»å¯¹è±¡shapesé‡Œé¢çš„å…ƒç´ ä¸ºæ•°æ®æºï¼Œç”Ÿæˆä¸€ä¸ªæµã€‚ç„¶ååœ¨è¿™ä¸ªæµä¸Šè°ƒç”¨filteræ–¹æ³•ï¼ŒæŒ‘å‡ºè“è‰²çš„ï¼Œè¿”å›å¦ä¸€ä¸ªæµã€‚æœ€åè°ƒç”¨forEachæ–¹æ³•å°†è¿™äº›è“è‰²çš„ç‰©ä½“å–·æˆçº¢è‰²ã€‚ï¼ˆforEachæ–¹æ³•ä¸å†è¿”å›æµï¼Œè€Œæ˜¯ä¸€ä¸ªç»ˆç«¯æ–¹æ³•ï¼Œç±»ä¼¼äºStringBufferåœ¨è°ƒç”¨è‹¥å¹²appendä¹‹åçš„é‚£ä¸ªtoStringï¼‰</p>
<p>filteræ–¹æ³•çš„å‚æ•°æ˜¯Predicateç±»å‹ï¼ŒforEachæ–¹æ³•çš„å‚æ•°æ˜¯Consumerç±»å‹ï¼Œå®ƒä»¬éƒ½æ˜¯å‡½æ•°æ¥å£ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨&lambda;è¡¨è¾¾å¼ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•å«parallelStream()ï¼Œé¡¾åæ€ä¹‰å®ƒå’Œstream()ä¸€æ ·ï¼Œåªä¸è¿‡æŒ‡æ˜è¦å¹¶è¡Œå¤„ç†ï¼Œä»¥æœŸå……åˆ†åˆ©ç”¨ç°ä»£CPUçš„å¤šæ ¸ç‰¹æ€§ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; shapes.parallelStream(); // æˆ–shapes.stream().parallel()</p>
<p>æ¥çœ‹æ›´å¤šçš„ä¾‹å­ã€‚ä¸‹é¢æ˜¯å…¸å‹çš„å¤§æ•°æ®å¤„ç†æ–¹æ³•ï¼ŒFilter-Map-Reduceï¼š</p>
<p>&nbsp;&nbsp;&nbsp; //ç»™å‡ºä¸€ä¸ªStringç±»å‹çš„æ•°ç»„ï¼Œæ‰¾å‡ºå…¶ä¸­æ‰€æœ‰ä¸é‡å¤çš„ç´ æ•°<br>&nbsp;&nbsp;&nbsp; public void distinctPrimary(Stringâ€¦ numbers) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;String&gt; l = Arrays.asList(numbers);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;Integer&gt; r = l.stream()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .map(e -&gt; new Integer(e))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .filter(e -&gt; Primes.isPrime(e))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .distinct()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .collect(Collectors.toList());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(â€œdistinctPrimary result is: â€œ + r);<br>&nbsp;&nbsp;&nbsp; }</p>
<p>ç¬¬ä¸€æ­¥ï¼šä¼ å…¥ä¸€ç³»åˆ—Stringï¼ˆå‡è®¾éƒ½æ˜¯åˆæ³•çš„æ•°å­—ï¼‰ï¼Œè½¬æˆä¸€ä¸ªListï¼Œç„¶åè°ƒç”¨stream()æ–¹æ³•ç”Ÿæˆæµã€‚</p>
<p>ç¬¬äºŒæ­¥ï¼šè°ƒç”¨æµçš„mapæ–¹æ³•æŠŠæ¯ä¸ªå…ƒç´ ç”±Stringè½¬æˆIntegerï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æµã€‚mapæ–¹æ³•æ¥å—ä¸€ä¸ªFunctionç±»å‹çš„å‚æ•°ï¼Œä¸Šé¢ä»‹ç»äº†ï¼ŒFunctionæ˜¯ä¸ªå‡½æ•°æ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç”¨&lambda;è¡¨è¾¾å¼ã€‚</p>
<p>ç¬¬ä¸‰æ­¥ï¼šè°ƒç”¨æµçš„filteræ–¹æ³•ï¼Œè¿‡æ»¤é‚£äº›ä¸æ˜¯ç´ æ•°çš„æ•°å­—ï¼Œå¹¶å¾—åˆ°ä¸€ä¸ªæ–°æµã€‚filteræ–¹æ³•æ¥å—ä¸€ä¸ªPredicateç±»å‹çš„å‚æ•°ï¼Œä¸Šé¢ä»‹ç»äº†ï¼ŒPredicateæ˜¯ä¸ªå‡½æ•°æ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œç”¨&lambda;è¡¨è¾¾å¼ã€‚</p>
<p>ç¬¬å››æ­¥ï¼šè°ƒç”¨æµçš„distinctæ–¹æ³•ï¼Œå»æ‰é‡å¤ï¼Œå¹¶å¾—åˆ°ä¸€ä¸ªæ–°æµã€‚è¿™æœ¬è´¨ä¸Šæ˜¯å¦ä¸€ä¸ªfilteræ“ä½œã€‚</p>
<p>ç¬¬äº”æ­¥ï¼šç”¨collectæ–¹æ³•å°†æœ€ç»ˆç»“æœæ”¶é›†åˆ°ä¸€ä¸ªListé‡Œé¢å»ã€‚collectæ–¹æ³•æ¥å—ä¸€ä¸ªCollectorç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æŒ‡æ˜å¦‚ä½•æ”¶é›†æœ€ç»ˆç»“æœã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç»“æœç®€å•åœ°æ”¶é›†åˆ°ä¸€ä¸ªListä¸­ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨Collectors.toMap(e-&gt;e, e-&gt;e)æŠŠç»“æœæ”¶é›†åˆ°ä¸€ä¸ªMapä¸­ï¼Œå®ƒçš„æ„æ€æ˜¯ï¼šæŠŠç»“æœæ”¶åˆ°ä¸€ä¸ªMapï¼Œç”¨è¿™äº›ç´ æ•°è‡ªèº«æ—¢ä½œä¸ºé”®åˆä½œä¸ºå€¼ã€‚toMapæ–¹æ³•æ¥å—ä¸¤ä¸ªFunctionç±»å‹çš„å‚æ•°ï¼Œåˆ†åˆ«ç”¨ä»¥ç”Ÿæˆé”®å’Œå€¼ï¼ŒFunctionæ˜¯ä¸ªå‡½æ•°æ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œéƒ½ç”¨&lambda;è¡¨è¾¾å¼ã€‚</p>
<p>ä½ å¯èƒ½ä¼šè§‰å¾—åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼ŒList lè¢«è¿­ä»£äº†å¥½å¤šæ¬¡ï¼Œmapï¼Œfilterï¼Œdistinctéƒ½åˆ†åˆ«æ˜¯ä¸€æ¬¡å¾ªç¯ï¼Œæ•ˆç‡ä¼šä¸å¥½ã€‚å®é™…å¹¶éå¦‚æ­¤ã€‚è¿™äº›è¿”å›å¦ä¸€ä¸ªStreamçš„æ–¹æ³•éƒ½æ˜¯&ldquo;æ‡’ï¼ˆlazyï¼‰&rdquo;çš„ï¼Œè€Œæœ€åè¿”å›æœ€ç»ˆç»“æœçš„collectæ–¹æ³•åˆ™æ˜¯&ldquo;æ€¥ï¼ˆeagerï¼‰&rdquo;çš„ã€‚åœ¨é‡åˆ°eageræ–¹æ³•ä¹‹å‰ï¼Œlazyçš„æ–¹æ³•ä¸ä¼šæ‰§è¡Œã€‚</p>
<p>å½“é‡åˆ°eageræ–¹æ³•æ—¶ï¼Œå‰é¢çš„lazyæ–¹æ³•æ‰ä¼šè¢«ä¾æ¬¡æ‰§è¡Œã€‚è€Œä¸”æ˜¯ç®¡é“è´¯é€šå¼æ‰§è¡Œã€‚è¿™æ„å‘³ç€æ¯ä¸€ä¸ªå…ƒç´ ä¾æ¬¡é€šè¿‡è¿™äº›ç®¡é“ã€‚ä¾‹å¦‚æœ‰ä¸ªå…ƒç´ &ldquo;3&rdquo;ï¼Œé¦–å…ˆå®ƒè¢«mapæˆæ•´æ•°å‹3ï¼›ç„¶åé€šè¿‡filterï¼Œå‘ç°æ˜¯ç´ æ•°ï¼Œè¢«ä¿ç•™ä¸‹æ¥ï¼›åˆé€šè¿‡distinctï¼Œå¦‚æœå·²ç»æœ‰ä¸€ä¸ª3äº†ï¼Œé‚£ä¹ˆå°±ç›´æ¥ä¸¢å¼ƒï¼Œå¦‚æœè¿˜æ²¡æœ‰åˆ™ä¿ç•™ã€‚è¿™æ ·ï¼Œ3ä¸ªæ“ä½œå…¶å®åªç»è¿‡äº†ä¸€æ¬¡å¾ªç¯ã€‚</p>
<p>é™¤collectå¤–å…¶å®ƒçš„eageræ“ä½œè¿˜æœ‰forEachï¼ŒtoArrayï¼Œreduceç­‰ã€‚</p>
<p>ä¸‹é¢æ¥çœ‹ä¸€ä¸‹ä¹Ÿè®¸æ˜¯æœ€å¸¸ç”¨çš„æ”¶é›†å™¨æ–¹æ³•ï¼ŒgroupingByï¼š</p>
<p>&nbsp;&nbsp;&nbsp; //ç»™å‡ºä¸€ä¸ªStringç±»å‹çš„æ•°ç»„ï¼Œæ‰¾å‡ºå…¶ä¸­æ‰€æœ‰ä¸é‡å¤çš„ç´ æ•°ï¼Œå¹¶ç»Ÿè®¡å…¶å‡ºç°æ¬¡æ•°<br>&nbsp;&nbsp;&nbsp; public void primaryOccurrence(Stringâ€¦ numbers) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;String&gt; l = Arrays.asList(numbers);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Map&lt;Integer, Integer&gt; r = l.stream()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .map(e -&gt; new Integer(e))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .filter(e -&gt; Primes.isPrime(e))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .collect( Collectors.groupingBy(p-&gt;p, Collectors.summingInt(p-&gt;1)) );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(â€œprimaryOccurrence result is: â€œ + r);<br>&nbsp;&nbsp;&nbsp; }</p>
<p>æ³¨æ„è¿™ä¸€è¡Œï¼š</p>
<p>&nbsp;&nbsp;&nbsp; Collectors.groupingBy(p-&gt;p, Collectors.summingInt(p-&gt;1))</p>
<p>å®ƒçš„æ„æ€æ˜¯ï¼šæŠŠç»“æœæ”¶é›†åˆ°ä¸€ä¸ªMapä¸­ï¼Œç”¨ç»Ÿè®¡åˆ°çš„å„ä¸ªç´ æ•°è‡ªèº«ä½œä¸ºé”®ï¼Œå…¶å‡ºç°æ¬¡æ•°ä½œä¸ºå€¼ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªreduceçš„ä¾‹å­ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; //ç»™å‡ºä¸€ä¸ªStringç±»å‹çš„æ•°ç»„ï¼Œæ±‚å…¶ä¸­æ‰€æœ‰ä¸é‡å¤ç´ æ•°çš„å’Œ<br>&nbsp;&nbsp;&nbsp; public void distinctPrimarySum(Stringâ€¦ numbers) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;String&gt; l = Arrays.asList(numbers);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int sum = l.stream()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .map(e -&gt; new Integer(e))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .filter(e -&gt; Primes.isPrime(e))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .distinct()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .reduce(0, (x,y) -&gt; x+y); // equivalent to .sum()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(â€œdistinctPrimarySum result is: â€œ + sum);<br>&nbsp;&nbsp;&nbsp; }</p>
<p>reduceæ–¹æ³•ç”¨æ¥äº§ç”Ÿå•ä¸€çš„ä¸€ä¸ªæœ€ç»ˆç»“æœã€‚<br>æµæœ‰å¾ˆå¤šé¢„å®šä¹‰çš„reduceæ“ä½œï¼Œå¦‚sum()ï¼Œmax()ï¼Œmin()ç­‰ã€‚</p>
<p>å†ä¸¾ä¸ªç°å®ä¸–ç•Œé‡Œçš„æ —å­æ¯”å¦‚ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; // ç»Ÿè®¡å¹´é¾„åœ¨25-35å²çš„ç”·å¥³äººæ•°ã€æ¯”ä¾‹<br>&nbsp;&nbsp;&nbsp; public void boysAndGirls(List&lt;Person&gt; persons) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Map&lt;Integer, Integer&gt; result = persons.parallelStream().filter(p -&gt; p.getAge()&gt;=25 &amp;&amp; p.getAge()&lt;=35).<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; collect(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Collectors.groupingBy(p-&gt;p.getSex(), Collectors.summingInt(p-&gt;1))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.print(â€œboysAndGirls result is â€œ + result);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(â€œ, ratio (male : female) is â€œ + (float)result.get(Person.MALE)/result.get(Person.FEMALE));<br>&nbsp;&nbsp;&nbsp; }</p>
<p><strong><span>3.3 &lambda;è¡¨è¾¾å¼çš„æ›´å¤šç”¨æ³•</span></strong></p>
<p>&nbsp;&nbsp;&nbsp; // åµŒå¥—çš„&lambda;è¡¨è¾¾å¼<br>&nbsp;&nbsp;&nbsp; Callable&lt;Runnable&gt; c1 = () -&gt; () -&gt; { System.out.println(â€œNested lambdaâ€); };<br>&nbsp;&nbsp;&nbsp; c1.call().run();</p>
<p>&nbsp;&nbsp;&nbsp; // ç”¨åœ¨æ¡ä»¶è¡¨è¾¾å¼ä¸­<br>&nbsp;&nbsp;&nbsp; Callable&lt;Integer&gt; c2 = true ? (() -&gt; 42) : (() -&gt; 24);<br>&nbsp;&nbsp;&nbsp; System.out.println(c2.call());</p>
<p>&nbsp;&nbsp;&nbsp; // å®šä¹‰ä¸€ä¸ªé€’å½’å‡½æ•°<br>&nbsp;&nbsp;&nbsp; private UnaryOperator&lt;Integer&gt; factorial = i -&gt; { return i == 0 ? 1 : i * factorial.apply( i - 1 ); };<br>&nbsp;&nbsp;&nbsp; â€¦<br>&nbsp;&nbsp;&nbsp; System.out.println(factorial.apply(3));</p>
<p>åœ¨Javaä¸­ï¼Œéšå£°æ˜éšè°ƒç”¨çš„æ–¹å¼æ˜¯ä¸è¡Œçš„ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼Œå£°æ˜äº†ä¸€ä¸ª&lambda;è¡¨è¾¾å¼(x, y) -&gt; x + yï¼ŒåŒæ—¶ä¼å›¾é€šè¿‡ä¼ å…¥å®å‚(2, 3)æ¥è°ƒç”¨å®ƒï¼š</p>
<p>&nbsp;&nbsp;&nbsp; int five = ( (x, y) -&gt; x + y ) (2, 3); // ERROR! try to call a lambda in-place</p>
<p>è¿™åœ¨C++ä¸­æ˜¯å¯ä»¥çš„ï¼Œä½†Javaä¸­ä¸è¡Œã€‚Javaçš„&lambda;è¡¨è¾¾å¼åªèƒ½ç”¨ä½œèµ‹å€¼ã€ä¼ å‚ã€è¿”å›å€¼ç­‰ã€‚</p>
<p><span><strong>4. å…¶å®ƒç›¸å…³æ¦‚å¿µ</strong></span></p>
<p><strong><span>4.1 æ•è·ï¼ˆCaptureï¼‰</span></strong></p>
<p>æ•è·çš„æ¦‚å¿µåœ¨äºè§£å†³åœ¨&lambda;è¡¨è¾¾å¼ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å“ªäº›å¤–éƒ¨å˜é‡ï¼ˆå³é™¤äº†å®ƒè‡ªå·±çš„å‚æ•°å’Œå†…éƒ¨å®šä¹‰çš„æœ¬åœ°å˜é‡ï¼‰çš„é—®é¢˜ã€‚</p>
<p>ç­”æ¡ˆæ˜¯ï¼šä¸å†…éƒ¨ç±»éå¸¸ç›¸ä¼¼ï¼Œä½†æœ‰ä¸åŒç‚¹ã€‚ä¸åŒç‚¹åœ¨äºå†…éƒ¨ç±»æ€»æ˜¯æŒæœ‰ä¸€ä¸ªå…¶å¤–éƒ¨ç±»å¯¹è±¡çš„å¼•ç”¨ã€‚è€Œ&lambda;è¡¨è¾¾å¼å‘¢ï¼Œé™¤éåœ¨å®ƒå†…éƒ¨ç”¨åˆ°äº†å…¶å¤–éƒ¨ç±»ï¼ˆåŒ…å›´ç±»ï¼‰å¯¹è±¡çš„æ–¹æ³•æˆ–è€…æˆå‘˜ï¼Œå¦åˆ™å®ƒå°±ä¸æŒæœ‰è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚</p>
<p>åœ¨Java8ä»¥å‰ï¼Œå¦‚æœè¦åœ¨å†…éƒ¨ç±»è®¿é—®å¤–éƒ¨å¯¹è±¡çš„ä¸€ä¸ªæœ¬åœ°å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å¿…é¡»å£°æ˜ä¸ºfinalæ‰è¡Œã€‚åœ¨Java8ä¸­ï¼Œè¿™ç§é™åˆ¶è¢«å»æ‰äº†ï¼Œä»£ä¹‹ä»¥ä¸€ä¸ªæ–°çš„æ¦‚å¿µï¼Œ&ldquo;effectively final&rdquo;ã€‚å®ƒçš„æ„æ€æ˜¯ä½ å¯ä»¥å£°æ˜ä¸ºfinalï¼Œä¹Ÿå¯ä»¥ä¸å£°æ˜finalä½†æ˜¯æŒ‰ç…§finalæ¥ç”¨ï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡èµ‹å€¼æ°¸ä¸æ”¹å˜ã€‚æ¢å¥è¯è¯´ï¼Œä¿è¯å®ƒåŠ ä¸Šfinalå‰ç¼€åä¸ä¼šå‡ºç¼–è¯‘é”™è¯¯ã€‚</p>
<p>åœ¨Java8ä¸­ï¼Œå†…éƒ¨ç±»å’Œ&lambda;è¡¨è¾¾å¼éƒ½å¯ä»¥è®¿é—®effectively finalçš„æœ¬åœ°å˜é‡ã€‚&lambda;è¡¨è¾¾å¼çš„ä¾‹å­å¦‚ä¸‹ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; â€¦&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; int tmp1 = 1; //åŒ…å›´ç±»çš„æˆå‘˜å˜é‡<br>&nbsp;&nbsp;&nbsp; static int tmp2 = 2; //åŒ…å›´ç±»çš„é™æ€æˆå‘˜å˜é‡<br>&nbsp;&nbsp;&nbsp; public void testCapture() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int tmp3 = 3; //æ²¡æœ‰å£°æ˜ä¸ºfinalï¼Œä½†æ˜¯effectively finalçš„æœ¬åœ°å˜é‡<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; final int tmp4 = 4; //å£°æ˜ä¸ºfinalçš„æœ¬åœ°å˜é‡<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int tmp5 = 5; //æ™®é€šæœ¬åœ°å˜é‡<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Function&lt;Integer, Integer&gt; f1 = i -&gt; i + tmp1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Function&lt;Integer, Integer&gt; f2 = i -&gt; i + tmp2;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Function&lt;Integer, Integer&gt; f3 = i -&gt; i + tmp3;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Function&lt;Integer, Integer&gt; f4 = i -&gt; i + tmp4;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Function&lt;Integer, Integer&gt; f5 = i -&gt; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp5&nbsp; += i; // ç¼–è¯‘é”™ï¼å¯¹tmp5èµ‹å€¼å¯¼è‡´å®ƒä¸æ˜¯effectively finalçš„<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return tmp5;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; â€¦<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp5 = 9; // ç¼–è¯‘é”™ï¼å¯¹tmp5èµ‹å€¼å¯¼è‡´å®ƒä¸æ˜¯effectively finalçš„<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; â€¦</p>
<p>Javaè¦æ±‚æœ¬åœ°å˜é‡finalæˆ–è€…effectively finalçš„åŸå› æ˜¯å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜ã€‚å†…éƒ¨ç±»ã€&lambda;è¡¨è¾¾å¼éƒ½æœ‰å¯èƒ½åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹ä¸€ä¸ªæœ¬åœ°å˜é‡ä¸ç¬¦åˆJavaçš„è®¾è®¡ç†å¿µã€‚</p>
<p><strong><span>4.2 æ–¹æ³•å¼•ç”¨ï¼ˆMethod referenceï¼‰</span></strong></p>
<p>ä»»ä½•ä¸€ä¸ª&lambda;è¡¨è¾¾å¼éƒ½å¯ä»¥ä»£è¡¨æŸä¸ªå‡½æ•°æ¥å£çš„å”¯ä¸€æ–¹æ³•çš„åŒ¿åæè¿°ç¬¦ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æŸä¸ªç±»çš„æŸä¸ªå…·ä½“æ–¹æ³•æ¥ä»£è¡¨è¿™ä¸ªæè¿°ç¬¦ï¼Œå«åšæ–¹æ³•å¼•ç”¨ã€‚ä¾‹å¦‚ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; Integer::parseInt //é™æ€æ–¹æ³•å¼•ç”¨<br>&nbsp;&nbsp;&nbsp; System.out::print //å®ä¾‹æ–¹æ³•å¼•ç”¨<br>&nbsp;&nbsp;&nbsp; Person::new&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //æ„é€ å™¨å¼•ç”¨</p>
<p>ä¸‹é¢æ˜¯ä¸€ç»„ä¾‹å­ï¼Œæ•™ä½ ä½¿ç”¨æ–¹æ³•å¼•ç”¨ä»£æ›¿&lambda;è¡¨è¾¾å¼ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; //c1 ä¸ c2 æ˜¯ä¸€æ ·çš„ï¼ˆé™æ€æ–¹æ³•å¼•ç”¨ï¼‰<br>&nbsp;&nbsp;&nbsp; Comparator&lt;Integer&gt; c2 = (x, y) -&gt; Integer.compare(x, y);<br>&nbsp;&nbsp;&nbsp; Comparator&lt;Integer&gt; c1 = Integer::compare;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; //ä¸‹é¢ä¸¤å¥æ˜¯ä¸€æ ·çš„ï¼ˆå®ä¾‹æ–¹æ³•å¼•ç”¨1ï¼‰<br>&nbsp;&nbsp;&nbsp; persons.forEach(e -&gt; System.out.println(e));<br>&nbsp;&nbsp;&nbsp; persons.forEach(System.out::println);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; //ä¸‹é¢ä¸¤å¥æ˜¯ä¸€æ ·çš„ï¼ˆå®ä¾‹æ–¹æ³•å¼•ç”¨2ï¼‰<br>&nbsp;&nbsp;&nbsp; persons.forEach(person -&gt; person.eat());<br>&nbsp;&nbsp;&nbsp; persons.forEach(Person::eat);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; //ä¸‹é¢ä¸¤å¥æ˜¯ä¸€æ ·çš„ï¼ˆæ„é€ å™¨å¼•ç”¨ï¼‰<br>&nbsp;&nbsp;&nbsp; strList.stream().map(s -&gt; new Integer(s));<br>&nbsp;&nbsp;&nbsp; strList.stream().map(Integer::new);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>ä½¿ç”¨æ–¹æ³•å¼•ç”¨ï¼Œä½ çš„ç¨‹åºä¼šå˜å¾—æ›´çŸ­äº›ã€‚ç°åœ¨distinctPrimarySumæ–¹æ³•å¯ä»¥æ”¹å†™å¦‚ä¸‹ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; public void distinctPrimarySum(Stringâ€¦ numbers) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;String&gt; l = Arrays.asList(numbers);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int sum = l.stream().map(Integer::new).filter(Primes::isPrime).distinct().sum();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(â€œdistinctPrimarySum result is: â€œ + sum);<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„æ–¹æ³•å¼•ç”¨:</p>
<p>&nbsp;&nbsp;&nbsp; super::methName //å¼•ç”¨æŸä¸ªå¯¹è±¡çš„çˆ¶ç±»æ–¹æ³•<br>&nbsp;&nbsp;&nbsp; TypeName[]::new //å¼•ç”¨ä¸€ä¸ªæ•°ç»„çš„æ„é€ å™¨</p>
<p><strong><span>4.3 é»˜è®¤æ–¹æ³•ï¼ˆDefault methodï¼‰</span></strong></p>
<p>Java8ä¸­ï¼Œæ¥å£å£°æ˜é‡Œå¯ä»¥æœ‰æ–¹æ³•å®ç°äº†ï¼Œå«åšé»˜è®¤æ–¹æ³•ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæ¥å£é‡Œçš„æ–¹æ³•å…¨éƒ¨æ˜¯æŠ½è±¡æ–¹æ³•ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; public interface MyInterf {<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String m1();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default String m2() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return â€œHello default method!â€;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>è¿™å®é™…ä¸Šæœ‰ç‚¹æ··æ·†æ¥å£å’ŒæŠ½è±¡ç±»ï¼Œä½†ä¸€ä¸ªç±»ä»ç„¶å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œè€Œåªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ã€‚</p>
<p>è¿™ä¹ˆåšçš„åŸå› æ˜¯ï¼šç”±äºCollectionåº“éœ€è¦ä¸ºæ‰¹å¤„ç†æ“ä½œæ·»åŠ æ–°çš„æ–¹æ³•ï¼Œå¦‚forEach()ï¼Œstream()ç­‰ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹ç°æœ‰çš„Collectionæ¥å£&mdash;&mdash;å¦‚æœé‚£æ ·åšçš„è¯æ‰€æœ‰çš„å®ç°ç±»éƒ½è¦è¿›è¡Œä¿®æ”¹ï¼ŒåŒ…æ‹¬å¾ˆå¤šå®¢æˆ·è‡ªåˆ¶çš„å®ç°ç±»ã€‚</p>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±é¢ä¸´ä¸€ç§ç±»ä¼¼å¤šç»§æ‰¿çš„é—®é¢˜ã€‚å¦‚æœç±»Subç»§æ‰¿äº†ä¸¤ä¸ªæ¥å£ï¼ŒBase1å’ŒBase2ï¼Œè€Œè¿™ä¸¤ä¸ªæ¥å£æ°å¥½å…·æœ‰å®Œå…¨ç›¸åŒçš„ä¸¤ä¸ªé»˜è®¤æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿå†²çªã€‚è¿™æ—¶Subç±»å°±å¿…é¡»é€šè¿‡é‡è½½æ¥æ˜¾å¼æŒ‡æ˜è‡ªå·±è¦ä½¿ç”¨å“ªä¸€ä¸ªæ¥å£çš„å®ç°ï¼ˆæˆ–è€…æä¾›è‡ªå·±çš„å®ç°ï¼‰ï¼š<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; public class Sub implements Base1, Base2 {<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void hello() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Base1.super.hello(); //ä½¿ç”¨Base1çš„å®ç°<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>é™¤äº†é»˜è®¤æ–¹æ³•ï¼ŒJava8çš„æ¥å£ä¹Ÿå¯ä»¥æœ‰é™æ€æ–¹æ³•çš„å®ç°ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; public interface MyInterf {<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String m1();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default String m2() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return â€œHello default method!â€;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static String m3() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return â€œHello static method in Interface!â€;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><strong><span>4.4 ç”Ÿæˆå™¨å‡½æ•°ï¼ˆGenerator functionï¼‰</span></strong></p>
<p>æœ‰æ—¶å€™ä¸€ä¸ªæµçš„æ•°æ®æºä¸ä¸€å®šæ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„é›†åˆå¯¹è±¡ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸ª&ldquo;ç”Ÿæˆå™¨å‡½æ•°&rdquo;ã€‚ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ä¼šäº§ç”Ÿä¸€ç³»åˆ—å…ƒç´ ï¼Œä¾›ç»™ä¸€ä¸ªæµã€‚Stream.generate(Supplier&lt;T&gt; s)å°±æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ã€‚å…¶ä¸­å‚æ•°Supplieræ˜¯ä¸€ä¸ªå‡½æ•°æ¥å£ï¼Œé‡Œé¢æœ‰å”¯ä¸€çš„æŠ½è±¡æ–¹æ³• &lt;T&gt; get()ã€‚</p>
<p>ä¸‹é¢è¿™ä¸ªä¾‹å­ç”Ÿæˆå¹¶æ‰“å°5ä¸ªéšæœºæ•°ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; Stream.generate(Math::random).limit(5).forEach(System.out::println);</p>
<p>æ³¨æ„è¿™ä¸ªlimit(5)ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªè°ƒç”¨ï¼Œé‚£ä¹ˆè¿™æ¡è¯­å¥ä¼šæ°¸è¿œåœ°æ‰§è¡Œä¸‹å»ã€‚ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªç”Ÿæˆå™¨æ˜¯æ— ç©·çš„ã€‚è¿™ç§è°ƒç”¨å«åšç»ˆç»“æ“ä½œï¼Œæˆ–è€…çŸ­è·¯ï¼ˆshort-circuitingï¼‰æ“ä½œã€‚</p>
<p>&nbsp;</p>
<p><span><strong>å‚è€ƒèµ„æ–™ï¼š</strong></span><br><a href="http://openjdk.java.net/projects/lambda/" target="_blank" rel="noopener">http://openjdk.java.net/projects/lambda/</a><br><a href="http://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html" target="_blank" rel="noopener">http://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html</a></p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> lambda </tag>
            
            <tag> java8 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Android]å¼‚æ­¥åŠ è½½å›¾ç‰‡ï¼Œå†…å­˜ç¼“å­˜ï¼Œæ–‡ä»¶ç¼“å­˜ï¼Œimageviewæ˜¾ç¤ºå›¾ç‰‡æ—¶å¢åŠ æ·¡å…¥æ·¡å‡ºåŠ¨ç”»]]></title>
      <url>/2014/02/28/Android-%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E5%9B%BE%E7%89%87%EF%BC%8C%E5%86%85%E5%AD%98%E7%BC%93%E5%AD%98%EF%BC%8C%E6%96%87%E4%BB%B6%E7%BC%93%E5%AD%98%EF%BC%8Cimageview%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87%E6%97%B6%E5%A2%9E%E5%8A%A0%E6%B7%A1%E5%85%A5%E6%B7%A1%E5%87%BA%E5%8A%A8%E7%94%BB/</url>
      <content type="html"><![CDATA[<p>è¿™ä¸ªå¯ä»¥å®ç°ImageViewå¼‚æ­¥åŠ è½½å›¾ç‰‡ï¼Œå†…å­˜ç¼“å­˜ï¼Œæ–‡ä»¶ç¼“å­˜ï¼Œimageviewæ˜¾ç¤ºå›¾ç‰‡æ—¶å¢åŠ æ·¡å…¥æ·¡å‡ºåŠ¨ç”»ã€‚</p>
<p>githubåœ°å€ï¼š<a href="https://github.com/wangjiegulu/ImageLoaderSample" target="_blank" rel="noopener">https://github.com/wangjiegulu/ImageLoaderSample</a></p>
<p>è§£å†³äº†ï¼š</p>
<p>1. listviewåŠ è½½oomé—®é¢˜</p>
<p>2. listviewåŠ è½½æ—¶å¡é¡¿çš„ç°è±¡</p>
<p>3. listviewåŠ è½½æ—¶itemä¸­å›¾ç‰‡é‡å¤é”™ä½ç­‰æƒ…å†µ</p>
<p>å¯ä»¥é…ç½®ï¼š</p>
<p>1. è®¾ç½®åŠ è½½å›¾ç‰‡çš„æœ€å¤§å°ºå¯¸</p>
<p>2. è®¾ç½®é»˜è®¤å›¾ç‰‡çš„æ˜¾ç¤º</p>
<p>3. è®¾ç½®å›¾ç‰‡ä½å›¾æ¨¡å¼</p>
<p>4. è®¾ç½®å†…å­˜ç¼“å­˜çš„æœ€å¤§å€¼ã€‚</p>
<p>5. æ–‡ä»¶ç¼“å­˜ä¿å­˜çš„ç›®å½•</p>
<p>ã€€ã€€è¿™ä¸ªæ¡†æ¶åŸºæœ¬çš„ä»£ç æ˜¯å¾ˆä¹…ä»¥å‰ä¸çŸ¥é“å“ªé‡Œå¼„çš„ï¼Œé›¶é›¶ç¢ç¢çš„ï¼Œç°åœ¨å·²ç»ä¼˜åŒ–äº†å¾ˆå¤šï¼Œæ‰€ä»¥ç°åœ¨ä¸Šä¼ åˆ°githubä¸Šå…±äº«ã€‚</p>
<p>ã€€ã€€è®²è®²ä½¿ç”¨æ–¹å¼å§ï¼š</p>
<p>&nbsp;</p>
<p>é¦–å…ˆä½¿ç”¨å‰ä¸‹è½½æºç æˆ–è€…jaråŒ…ï¼ˆè§githubï¼š<a href="https://github.com/wangjiegulu/ImageLoaderSample" target="_blank" rel="noopener">https://github.com/wangjiegulu/ImageLoaderSample</a>ï¼‰</p>
<p>ç„¶åè¿›è¡Œå›¾ç‰‡åŠ è½½å™¨ï¼ˆImageLoaderï¼‰çš„é…ç½®å’Œåˆå§‹åŒ–ï¼Œæ¨èçš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p>æ–°å»ºMyApplicationç±»ï¼Œç»§æ‰¿Applicationï¼Œåœ¨onCreateä¸­å¢åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Created with IntelliJ IDEA.<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Author: wangjie  email:tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 14-2-27<br></span><span style="color: #008080;"> 5</span> <span style="color: #008000;"> <em> Time: ä¸Šåˆ11:25<br></em></span><span style="color: #008080;"> 6</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MyApplication <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Application{<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate() {<br></span><span style="color: #008080;">10</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate();<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">        ImageLoader.init(getApplicationContext(),<br></span><span style="color: #008080;">12</span>                 <span style="color: #0000ff;">new</span><span style="color: #000000;"> CacheConfig()<br></span><span style="color: #008080;">13</span>                     .setDefRequiredSize(600) <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®é»˜è®¤çš„åŠ è½½å›¾ç‰‡å°ºå¯¸ï¼ˆè¡¨ç¤ºå®½é«˜ä»»ä¸€ä¸è¶…è¿‡è¯¥å€¼ï¼Œé»˜è®¤æ˜¯70pxï¼‰</span><br><span style="color: #008080;">14</span>                     .setDefaultResId(R.drawable.ic_launcher) <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®æ˜¾ç¤ºçš„é»˜è®¤å›¾ç‰‡ï¼ˆé»˜è®¤æ˜¯0ï¼Œå³ç©ºç™½å›¾ç‰‡ï¼‰</span><br><span style="color: #008080;">15</span>                     .setBitmapConfig(Bitmap.Config.ARGB_8888) <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®å›¾ç‰‡ä½å›¾æ¨¡å¼ï¼ˆé»˜è®¤æ˜¯Bitmap.CacheConfig.ARGB_8888ï¼‰</span><br><span style="color: #008080;">16</span>                     .setMemoryCachelimit(Runtime.getRuntime().maxMemory() / 3) <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®å›¾ç‰‡å†…å­˜ç¼“å­˜å¤§å°ï¼ˆé»˜è®¤æ˜¯Runtime.getRuntime().maxMemory() / 4ï¼‰<br></span><span style="color: #008080;">17</span> <span style="color: #008000;">//</span><span style="color: #008000;">                  .setFileCachePath(Environment.getExternalStorageDirectory().toString() + â€œ/mycacheâ€) </span><span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®æ–‡ä»¶ç¼“å­˜ä¿å­˜ç›®å½•</span><br><span style="color: #008080;">18</span> <span style="color: #000000;">        );<br></span><span style="color: #008080;">19</span><br><span style="color: #008080;">20</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">21</span><br><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> <span style="color: #000000;">    &hellip;&hellip;<br></span><span style="color: #008080;">24</span> }</pre><br></div>

<p>&nbsp;</p>
<p>ç„¶åå†AndroidManifest.xmlä¸­æ·»åŠ ï¼š</p>
<div class="cnblogs_code"><br><pre>&lt;<span style="color: #000000;">application<br>            â€¦â€¦<br>            android:name</span>=â€MyApplicationâ€&gt;<span style="color: #000000;"><br>            â€¦â€¦<br></span>&lt;/application&gt;</pre><br></div>

<p>åˆ°æ­¤ï¼Œé…ç½®å·²ç»å…¨éƒ¨å®Œæˆï¼š</p>
<p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ImageLoaderæ¥åŠ è½½å›¾ç‰‡ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> holder.progress.setText(â€œ0%â€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">    holder.progress.setVisibility(View.VISIBLE);<br></span><span style="color: #008080;"> 3</span>     <span style="color: #0000ff;">final</span> ViewHolder vhr =<span style="color: #000000;"> holder;<br></span><span style="color: #008080;"> 4</span>     ImageLoader.getInstances().displayImage(list.get(position), holder.image, <span style="color: #0000ff;">new</span><span style="color: #000000;"> ImageLoader.OnImageLoaderListener() {<br></span><span style="color: #008080;"> 5</span> <span style="color: #000000;">        @Override<br></span><span style="color: #008080;"> 6</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onProgressImageLoader(ImageView imageView, <span style="color: #0000ff;">int</span> currentSize, <span style="color: #0000ff;">int</span><span style="color: #000000;"> totalSize) {<br></span><span style="color: #008080;"> 7</span>             vhr.progress.setText(currentSize * 100 / totalSize + â€œ%â€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #000000;">        @Override<br></span><span style="color: #008080;">11</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onFinishedImageLoader(ImageView imageView, Bitmap bitmap) {<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">            vhr.progress.setVisibility(View.GONE);<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">    });<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">    æˆ–è€…ï¼š<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    ImageLoader.getInstances().displayImage(url, imageIv);<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">    æˆ–è€…<br></span><span style="color: #008080;">18</span>     ImageLoader.getInstances().displayImage(url, imageIv, 100);</pre><br></div>

<p>å¤‡æ³¨ï¼š</p>
<p>ä¾‹å­ä¸­ï¼Œç”¨åˆ°äº†ä¸€éƒ¨åˆ†æ³¨è§£ï¼ˆä¸ImageLoaderåŠŸèƒ½æ— å…³ï¼Œä½†æ˜¯å¯ä»¥ç®€åŒ–ä»£ç çš„ç¼–å†™ï¼‰ å¯ä»¥ç‚¹ä¸‹é¢è¿æ¥è¿›å…¥ï¼š</p>
<p>githubï¼š<a href="https://github.com/wangjiegulu/androidInject" target="_blank" rel="noopener">https://github.com/wangjiegulu/androidInject</a></p>
<p>åšå®¢ï¼š</p>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/3459139.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/3459139.html</a></p>
<p><a href="http://www.cnblogs.com/tiantianbyconan/p/3540427.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/3540427.html</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ImageView </tag>
            
            <tag> ImageLoader </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hbase Java APIè¯¦è§£]]></title>
      <url>/2014/02/20/Hbase-Java-API%E8%AF%A6%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p>HBaseæ˜¯Hadoopçš„æ•°æ®åº“ï¼Œèƒ½å¤Ÿå¯¹å¤§æ•°æ®æä¾›éšæœºã€å®æ—¶è¯»å†™è®¿é—®ã€‚ä»–æ˜¯å¼€æºçš„ï¼Œåˆ†å¸ƒå¼çš„ï¼Œå¤šç‰ˆæœ¬çš„ï¼Œé¢å‘åˆ—çš„ï¼Œå­˜å‚¨æ¨¡å‹ã€‚</p>
<p>åœ¨è®²è§£çš„æ—¶å€™æˆ‘é¦–å…ˆç»™å¤§å®¶è®²è§£ä¸€ä¸‹HBaseçš„æ•´ä½“ç»“æ„ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://static.open-open.com/lib/uploadImg/20120717/20120717163859_417.jpg" alt=" HBase Java APIè¯¦è§£ "></p>
<p>HBase Masteræ˜¯æœåŠ¡å™¨è´Ÿè´£ç®¡ç†æ‰€æœ‰çš„HRegionæœåŠ¡å™¨ï¼ŒHBase Masterå¹¶ä¸å­˜å‚¨HBaseæœåŠ¡å™¨çš„ä»»ä½•æ•°æ®ï¼ŒHBaseé€»è¾‘ä¸Šçš„è¡¨å¯èƒ½ä¼šåˆ’åˆ†ä¸ºå¤šä¸ªHRegionï¼Œç„¶åå­˜å‚¨åœ¨HRegion Serverç¾¤ä¸­ï¼ŒHBase Master Serverä¸­å­˜å‚¨çš„æ˜¯ä»æ•°æ®åˆ°HRegion Serverçš„æ˜ å°„ã€‚</p>
<p>ä¸€å°æœºå™¨åªèƒ½è¿è¡Œä¸€ä¸ªHRegionæœåŠ¡å™¨ï¼Œæ•°æ®çš„æ“ä½œä¼šè®°å½•åœ¨Hlogä¸­ï¼Œåœ¨è¯»å–æ•°æ®æ—¶å€™ï¼ŒHRegionä¼šå…ˆè®¿é—®Hmemcacheç¼“å­˜ï¼Œå¦‚æœ ç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®æ‰å›åˆ°Hstoreä¸­ä¸Šæ‰¾ï¼Œæ²¡ä¸€ä¸ªåˆ—éƒ½ä¼šæœ‰ä¸€ä¸ªHstoreé›†åˆï¼Œæ¯ä¸ªHstoreé›†åˆåŒ…å«äº†å¾ˆå¤šå…·ä½“çš„HstoreFileæ–‡ä»¶ï¼Œè¿™äº›æ–‡ ä»¶æ˜¯Bæ ‘ç»“æ„çš„ï¼Œæ–¹ä¾¿å¿«é€Ÿè¯»å–ã€‚</p>
<p>&nbsp;</p>
<p>å†çœ‹ä¸‹HBaseæ•°æ®ç‰©ç†è§†å›¾å¦‚ä¸‹ï¼š</p>
<p>&nbsp;</p>
<table border="1" cellspacing="0" cellpadding="0"><br><tbody><br><tr><br><td rowspan="2" width="67"><strong>Row Key</strong></td><br><td rowspan="2" width="104"><strong>Timestamp</strong></td><br><td colspan="2" width="385"><strong>Column Family</strong></td><br></tr><br><tr><br><td width="227"><strong>URI</strong></td><br><td width="158"><strong>Parser</strong></td><br></tr><br><tr><br><td rowspan="3" width="67">r1</td><br><td width="104">t3</td><br><td width="227">url=<a href="http://www.taobao.com" target="_blank" rel="noopener">http://www.taobao.com</a></td><br><td width="158">title=å¤©å¤©ç‰¹ä»·</td><br></tr><br><tr><br><td width="104">t2</td><br><td width="227">host=taobao.com</td><br><td width="158">&nbsp;</td><br></tr><br><tr><br><td width="104">t1</td><br><td width="227">&nbsp;</td><br><td width="158">&nbsp;</td><br></tr><br><tr><br><td rowspan="2" width="67">r2</td><br><td width="104">t5</td><br><td width="227">url=<a href="http://www.alibaba.com" target="_blank" rel="noopener">http://www.alibaba.com</a></td><br><td width="158">content=æ¯å¤©&hellip;</td><br></tr><br><tr><br><td width="104">t4</td><br><td width="227">host=alibaba.com</td><br><td width="158">&nbsp;</td><br></tr><br></tbody><br></table>

<p><span>&Oslash;&nbsp;&nbsp;Row Key: è¡Œé”®ï¼ŒTableçš„ä¸»é”®ï¼ŒTableä¸­çš„è®°å½•æŒ‰ç…§Row Keyæ’åº</span></p>
<p><span>&Oslash;&nbsp;&nbsp;Timestamp: æ—¶é—´æˆ³ï¼Œæ¯æ¬¡æ•°æ®æ“ä½œå¯¹åº”çš„æ—¶é—´æˆ³ï¼Œå¯ä»¥çœ‹ä½œæ˜¯æ•°æ®çš„version number</span></p>
<p><span>&Oslash;&nbsp;&nbsp;Column Familyï¼šåˆ—ç°‡ï¼ŒTableåœ¨æ°´å¹³æ–¹å‘æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªColumn Familyç»„æˆï¼Œä¸€ä¸ªColumn Familyä¸­å¯ä»¥ç”±ä»»æ„å¤šä¸ªColumnç»„æˆï¼Œå³Column Familyæ”¯æŒåŠ¨æ€æ‰©å±•ï¼Œæ— éœ€é¢„å…ˆå®šä¹‰Columnçš„æ•°é‡ä»¥åŠç±»å‹ï¼Œæ‰€æœ‰Columnå‡ä»¥äºŒè¿›åˆ¶æ ¼å¼å­˜å‚¨ï¼Œç”¨æˆ·éœ€è¦è‡ªè¡Œè¿›è¡Œç±»å‹è½¬æ¢ã€‚</span></p>
<p>&nbsp;</p>
<p>äº†è§£äº†HBaseçš„ä½“ç³»ç»“æ„å’ŒHBaseæ•°æ®è§†å›¾å¤Ÿï¼Œç°åœ¨è®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹æ€æ ·é€šè¿‡Javaæ¥æ“ä½œHBaseæ•°æ®å§ï¼</p>
<p>å…ˆè¯´è¯´å…·ä½“çš„APIå…ˆï¼Œå¦‚ä¸‹</p>
<p>&nbsp;</p>
<p><span>HBaseConfiguration</span>æ˜¯æ¯ä¸€ä¸ªhbase clientéƒ½ä¼šä½¿ç”¨åˆ°çš„å¯¹è±¡ï¼Œå®ƒä»£è¡¨çš„<span>æ˜¯HBaseé…ç½®ä¿¡æ¯</span>ã€‚å®ƒæœ‰ä¸¤ç§æ„é€ æ–¹å¼ï¼š</p>
<p>public HBaseConfiguration()</p>
<p>public HBaseConfiguration(final Configuration c)</p>
<p>é»˜è®¤çš„æ„é€ æ–¹å¼ä¼šå°è¯•ä»hbase-default.xmlå’Œhbase-site.xmlä¸­è¯»å–é…ç½®ã€‚å¦‚æœclasspathæ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå°±éœ€è¦ä½ è‡ªå·±è®¾ç½®é…ç½®ã€‚</p>
<p>Configuration HBASE_CONFIG = new Configuration();</p>
<p>HBASE_CONFIG.set(&ldquo;hbase.zookeeper.quorum&rdquo;, &ldquo;zkServer&rdquo;);</p>
<p>HBASE_CONFIG.set(&ldquo;hbase.zookeeper.property.clientPort&rdquo;, &ldquo;2181&Prime;);</p>
<p>HBaseConfiguration cfg = new HBaseConfiguration(HBASE_CONFIG);</p>
<p>&nbsp;</p>
<p>åˆ›å»ºè¡¨</p>
<p><span>åˆ›å»ºè¡¨æ˜¯é€šè¿‡HBaseAdminå¯¹è±¡æ¥æ“ä½œçš„</span>ã€‚HBaseAdminè´Ÿè´£è¡¨çš„METAä¿¡æ¯å¤„ç†ã€‚HBaseAdminæä¾›äº†createTableè¿™ä¸ªæ–¹æ³•ï¼š</p>
<p>public void createTable(HTableDescriptor desc)</p>
<p><span>HTableDescriptor ä»£è¡¨çš„æ˜¯è¡¨çš„schema</span>, æä¾›çš„æ–¹æ³•ä¸­æ¯”è¾ƒæœ‰ç”¨çš„æœ‰</p>
<p>setMaxFileSizeï¼ŒæŒ‡å®šæœ€å¤§çš„region size</p>
<p>setMemStoreFlushSize æŒ‡å®šmemstore flushåˆ°HDFSä¸Šçš„æ–‡ä»¶å¤§å°</p>
<p>&nbsp;</p>
<p>å¢åŠ familyé€šè¿‡ addFamilyæ–¹æ³•</p>
<p>public void addFamily(final HColumnDescriptor family)</p>
<p>HColumnDescriptor ä»£è¡¨çš„æ˜¯columnçš„schemaï¼Œæä¾›çš„æ–¹æ³•æ¯”è¾ƒå¸¸ç”¨çš„æœ‰</p>
<p><span>setTimeToLive:æŒ‡å®šæœ€å¤§çš„TTL,å•ä½æ˜¯ms,è¿‡æœŸæ•°æ®ä¼šè¢«è‡ªåŠ¨åˆ é™¤</span>ã€‚</p>
<p>setInMemory:æŒ‡å®šæ˜¯å¦æ”¾åœ¨å†…å­˜ä¸­ï¼Œå¯¹å°è¡¨æœ‰ç”¨ï¼Œå¯ç”¨äºæé«˜æ•ˆç‡ã€‚é»˜è®¤å…³é—­</p>
<p>setBloomFilter:æŒ‡å®šæ˜¯å¦ä½¿ç”¨BloomFilter,å¯æé«˜éšæœºæŸ¥è¯¢æ•ˆç‡ã€‚é»˜è®¤å…³é—­</p>
<p>setCompressionType:è®¾å®šæ•°æ®å‹ç¼©ç±»å‹ã€‚é»˜è®¤æ— å‹ç¼©ã€‚</p>
<p>setMaxVersions:æŒ‡å®šæ•°æ®æœ€å¤§ä¿å­˜çš„ç‰ˆæœ¬ä¸ªæ•°ã€‚é»˜è®¤ä¸º3ã€‚</p>
<p>&nbsp;</p>
<p><span>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œåˆ›å»ºäº†4ä¸ªfamilyçš„è¡¨ï¼š</span></p>
<div class="cnblogs_code"><br><pre>HBaseAdmin hAdmin = <span style="color: #0000ff;">new</span><span style="color: #000000;"> HBaseAdmin(hbaseConfig);<br><br>HTableDescriptor t </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> HTableDescriptor(tableName);<br><br>t.addFamily(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> HColumnDescriptor(&ldquo;f1&Prime;));<br><br>t.addFamily(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> HColumnDescriptor(&ldquo;f2&Prime;));<br><br>t.addFamily(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> HColumnDescriptor(&ldquo;f3&Prime;));<br><br>t.addFamily(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> HColumnDescriptor(&ldquo;f4&Prime;));<br><br>hAdmin.createTable(t);</span></pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>åˆ é™¤è¡¨</p>
<p><span>åˆ é™¤è¡¨ä¹Ÿæ˜¯é€šè¿‡HBaseAdminæ¥æ“ä½œï¼Œåˆ é™¤è¡¨ä¹‹å‰é¦–å…ˆè¦disableè¡¨ã€‚</span>è¿™æ˜¯ä¸€ä¸ªéå¸¸è€—æ—¶çš„æ“ä½œï¼Œæ‰€ä»¥ä¸å»ºè®®é¢‘ç¹åˆ é™¤è¡¨ã€‚</p>
<p>disableTableå’ŒdeleteTableåˆ†åˆ«ç”¨æ¥disableå’Œdeleteè¡¨ã€‚</p>
<p>Example:</p>
<div class="cnblogs_code"><br><pre>HBaseAdmin hAdmin = <span style="color: #0000ff;">new</span><span style="color: #000000;"> HBaseAdmin(hbaseConfig);<br><br></span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (hAdmin.tableExists(tableName)) {<br><br>       hAdmin.disableTable(tableName);<br><br>       hAdmin.deleteTable(tableName);<br><br>}</span></pre><br></div>

<p><span style="line-height: 1.5;">&nbsp;</span></p>
<p>æŸ¥è¯¢æ•°æ®</p>
<p><span>æŸ¥è¯¢åˆ†ä¸ºå•æ¡éšæœºæŸ¥è¯¢å’Œæ‰¹é‡æŸ¥è¯¢ã€‚</span></p>
<p><span>å•æ¡æŸ¥è¯¢æ˜¯é€šè¿‡rowkeyåœ¨tableä¸­æŸ¥è¯¢æŸä¸€è¡Œçš„æ•°æ®</span>ã€‚HTableæä¾›äº†getæ–¹æ³•æ¥å®Œæˆå•æ¡æŸ¥è¯¢ã€‚</p>
<p><span>æ‰¹é‡æŸ¥è¯¢æ˜¯é€šè¿‡åˆ¶å®šä¸€æ®µrowkeyçš„èŒƒå›´æ¥æŸ¥è¯¢</span>ã€‚HTableæä¾›äº†ä¸ªgetScanneræ–¹æ³•æ¥å®Œæˆæ‰¹é‡æŸ¥è¯¢ã€‚</p>
<p>public Result get(final Get get)</p>
<p>public ResultScanner getScanner(final Scan scan)</p>
<p>Getå¯¹è±¡åŒ…å«äº†ä¸€ä¸ªGetæŸ¥è¯¢éœ€è¦çš„ä¿¡æ¯ã€‚å®ƒçš„æ„é€ æ–¹æ³•æœ‰ä¸¤ç§ï¼š</p>
<p>&nbsp; public Get(byte [] row)</p>
<p>&nbsp; public Get(byte [] row, RowLock rowLock)</p>
<p>Rowlockæ˜¯ä¸ºäº†ä¿è¯è¯»å†™çš„åŸå­æ€§ï¼Œä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªå·²ç»å­˜åœ¨Rowlockï¼Œå¦åˆ™HBaseä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ–°çš„rowlockã€‚</p>
<p>Scanå¯¹è±¡æä¾›äº†é»˜è®¤æ„é€ å‡½æ•°ï¼Œä¸€èˆ¬ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°ã€‚</p>
<p>&nbsp;</p>
<p>Get/Scançš„å¸¸ç”¨æ–¹æ³•æœ‰ï¼š</p>
<p>addFamily/addColumn:æŒ‡å®šéœ€è¦çš„familyæˆ–è€…column,å¦‚æœæ²¡æœ‰è°ƒç”¨ä»»ä½•addFamilyæˆ–è€…Column,ä¼šè¿”å›æ‰€æœ‰çš„columns.</p>
<p>setMaxVersions:æŒ‡å®šæœ€å¤§çš„ç‰ˆæœ¬ä¸ªæ•°ã€‚å¦‚æœä¸å¸¦ä»»ä½•å‚æ•°è°ƒç”¨setMaxVersions,è¡¨ç¤ºå–æ‰€æœ‰çš„ç‰ˆæœ¬ã€‚å¦‚æœä¸æ‰ç”¨setMaxVersions,åªä¼šå–åˆ°æœ€æ–°çš„ç‰ˆæœ¬ã€‚</p>
<p>setTimeRange:æŒ‡å®šæœ€å¤§çš„æ—¶é—´æˆ³å’Œæœ€å°çš„æ—¶é—´æˆ³ï¼Œåªæœ‰åœ¨æ­¤èŒƒå›´å†…çš„cellæ‰èƒ½è¢«è·å–ã€‚</p>
<p>setTimeStamp:æŒ‡å®šæ—¶é—´æˆ³ã€‚</p>
<p>setFilter:æŒ‡å®šFilteræ¥è¿‡æ»¤æ‰ä¸éœ€è¦çš„ä¿¡æ¯</p>
<p>&nbsp;</p>
<p>Scanç‰¹æœ‰çš„æ–¹æ³•ï¼š</p>
<p>setStartRow:æŒ‡å®šå¼€å§‹çš„è¡Œã€‚å¦‚æœä¸è°ƒç”¨ï¼Œåˆ™ä»è¡¨å¤´å¼€å§‹ã€‚</p>
<p>setStopRow:æŒ‡å®šç»“æŸçš„è¡Œï¼ˆä¸å«æ­¤è¡Œï¼‰ã€‚</p>
<p>setBatch:æŒ‡å®šæœ€å¤šè¿”å›çš„Cellæ•°ç›®ã€‚ç”¨äºé˜²æ­¢ä¸€è¡Œä¸­æœ‰è¿‡å¤šçš„æ•°æ®ï¼Œå¯¼è‡´OutofMemoryé”™è¯¯ã€‚</p>
<p>ResultScanneræ˜¯Resultçš„ä¸€ä¸ªå®¹å™¨ï¼Œæ¯æ¬¡è°ƒç”¨ResultScannerçš„nextæ–¹æ³•ï¼Œä¼šè¿”å›Result.</p>
<p>public Result next() throws IOException;</p>
<p>public Result [] next(int nbRows) throws IOException;</p>
<p>&nbsp;</p>
<p>Resultä»£è¡¨æ˜¯ä¸€è¡Œçš„æ•°æ®ã€‚å¸¸ç”¨æ–¹æ³•æœ‰ï¼š</p>
<p>getRow:è¿”å›rowkey</p>
<p>raw:è¿”å›æ‰€æœ‰çš„key valueæ•°ç»„ã€‚</p>
<p>getValue:æŒ‰ç…§columnæ¥è·å–cellçš„å€¼</p>
<p>&nbsp;</p>
<p>Example:</p>
<div class="cnblogs_code"><br><pre>Scan s = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Scan();<br><br>s.setMaxVersions();<br><br>ResultScanner ss </span>=<span style="color: #000000;"> table.getScanner(s);<br><br></span><span style="color: #0000ff;">for</span><span style="color: #000000;">(Result r:ss){<br><br>    System.out.println(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> String(r.getRow()));<br><br>    </span><span style="color: #0000ff;">for</span><span style="color: #000000;">(KeyValue kv:r.raw()){<br><br>       System.out.println(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> String(kv.getColumn()));<br><br>    }<br><br>}</span></pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span>æ’å…¥æ•°æ®</span></p>
<p>HTableé€šè¿‡putæ–¹æ³•æ¥æ’å…¥æ•°æ®ã€‚&nbsp;</p>
<p>public void put(final Put put) throws IOException</p>
<p>public void put(final List&nbsp;puts) throws IOException</p>
<p>å¯ä»¥ä¼ é€’å•ä¸ªæ‰¹Putå¯¹è±¡æˆ–è€…List putå¯¹è±¡æ¥åˆ†åˆ«å®ç°å•æ¡æ’å…¥å’Œæ‰¹é‡æ’å…¥ã€‚</p>
<p>Putæä¾›äº†3ç§æ„é€ æ–¹å¼ï¼š</p>
<p>public Put(byte [] row)</p>
<p>public Put(byte [] row, RowLock rowLock)</p>
<p>public Put(Put putToCopy)&nbsp;</p>
<p>&nbsp;</p>
<p>Putå¸¸ç”¨çš„æ–¹æ³•æœ‰ï¼š</p>
<p>add:å¢åŠ ä¸€ä¸ªCell</p>
<p>setTimeStamp:æŒ‡å®šæ‰€æœ‰cellé»˜è®¤çš„timestamp,å¦‚æœä¸€ä¸ªCellæ²¡æœ‰æŒ‡å®štimestamp,å°±ä¼šç”¨åˆ°è¿™ä¸ªå€¼ã€‚å¦‚æœæ²¡æœ‰è°ƒç”¨ï¼ŒHBaseä¼šå°†å½“å‰æ—¶é—´ä½œä¸ºæœªæŒ‡å®štimestampçš„cellçš„timestamp.</p>
<p>setWriteToWAL: WALæ˜¯Write Ahead Logçš„ç¼©å†™ï¼ŒæŒ‡çš„æ˜¯HBaseåœ¨æ’å…¥æ“ä½œå‰æ˜¯å¦å†™Logã€‚é»˜è®¤æ˜¯æ‰“å¼€ï¼Œå…³æ‰ä¼šæé«˜æ€§èƒ½ï¼Œä½†æ˜¯å¦‚æœç³»ç»Ÿå‡ºç°æ•…éšœ(è´Ÿè´£æ’å…¥çš„Region ServeræŒ‚æ‰)ï¼Œæ•°æ®å¯èƒ½ä¼šä¸¢å¤±ã€‚</p>
<p>å¦å¤–HTableä¹Ÿæœ‰ä¸¤ä¸ªæ–¹æ³•ä¹Ÿä¼šå½±å“æ’å…¥çš„æ€§èƒ½</p>
<p>setAutoFlash: AutoFlushæŒ‡çš„æ˜¯åœ¨æ¯æ¬¡è°ƒç”¨HBaseçš„Putæ“ä½œï¼Œæ˜¯å¦æäº¤åˆ°HBase Serverã€‚é»˜è®¤æ˜¯true,æ¯æ¬¡ä¼šæäº¤ã€‚å¦‚æœæ­¤æ—¶æ˜¯å•æ¡æ’å…¥ï¼Œå°±ä¼šæœ‰æ›´å¤šçš„IO,ä»è€Œé™ä½æ€§èƒ½.</p>
<p>setWriteBufferSize: Write Buffer Sizeåœ¨AutoFlushä¸ºfalseçš„æ—¶å€™èµ·ä½œç”¨ï¼Œé»˜è®¤æ˜¯2MB,ä¹Ÿå°±æ˜¯å½“æ’å…¥æ•°æ®è¶…è¿‡2MB,å°±ä¼šè‡ªåŠ¨æäº¤åˆ°Server</p>
<p>&nbsp;</p>
<p>Example:</p>
<div class="cnblogs_code"><br><pre>HTable table = <span style="color: #0000ff;">new</span><span style="color: #000000;"> HTable(hbaseConfig, tableName);<br><br>table.setAutoFlush(autoFlush);<br><br>List lp </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> ArrayList();<br><br></span><span style="color: #0000ff;">int</span> count = 10000<span style="color: #000000;">;<br><br></span><span style="color: #0000ff;">byte</span>[] buffer = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">byte</span>[1024<span style="color: #000000;">];<br><br>Random r </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Random();<br><br></span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 1; i &lt;= count; ++<span style="color: #000000;">i) {<br><br>       Put p </span>= <span style="color: #0000ff;">new</span> Put(String.format(&ldquo;row%<span style="color: #000000;">09d&rdquo;,i).getBytes());<br><br>       r.nextBytes(buffer);<br><br>       p.add(&ldquo;f1&Prime;.getBytes(), </span><span style="color: #0000ff;">null</span><span style="color: #000000;">, buffer);<br><br>       p.add(&ldquo;f2&Prime;.getBytes(), </span><span style="color: #0000ff;">null</span><span style="color: #000000;">, buffer);<br><br>       p.add(&ldquo;f3&Prime;.getBytes(), </span><span style="color: #0000ff;">null</span><span style="color: #000000;">, buffer);<br><br>       p.add(&ldquo;f4&Prime;.getBytes(), </span><span style="color: #0000ff;">null</span><span style="color: #000000;">, buffer);<br><br>       p.setWriteToWAL(wal);<br><br>       lp.add(p);<br><br>       </span><span style="color: #0000ff;">if</span>(i%1000==0<span style="color: #000000;">){<br><br>           table.put(lp);<br><br>           lp.clear();<br><br>       }<br><br>    }</span></pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span>åˆ é™¤æ•°æ®</span></p>
<p>HTable é€šè¿‡deleteæ–¹æ³•æ¥åˆ é™¤æ•°æ®ã€‚</p>
<p>&nbsp; public void delete(final Delete delete)&nbsp;</p>
<p>&nbsp;</p>
<p>Deleteæ„é€ æ–¹æ³•æœ‰ï¼š</p>
<p>public Delete(byte [] row)</p>
<p>public Delete(byte [] row, long timestamp, RowLock rowLock)</p>
<p>public Delete(final Delete d)</p>
<p>Deleteå¸¸ç”¨æ–¹æ³•æœ‰</p>
<p>deleteFamily/deleteColumns:æŒ‡å®šè¦åˆ é™¤çš„familyæˆ–è€…columnçš„æ•°æ®ã€‚å¦‚æœä¸è°ƒç”¨ä»»ä½•è¿™æ ·çš„æ–¹æ³•ï¼Œå°†ä¼šåˆ é™¤æ•´è¡Œã€‚</p>
<p>æ³¨æ„ï¼šå¦‚æœæŸä¸ªCellçš„timestampé«˜äºå½“å‰æ—¶é—´ï¼Œè¿™ä¸ªCellå°†ä¸ä¼šè¢«åˆ é™¤ï¼Œä»ç„¶å¯ä»¥æŸ¥å‡ºæ¥ã€‚</p>
<p>&nbsp;</p>
<p>Example:</p>
<div class="cnblogs_code"><br><pre>HTable table = <span style="color: #0000ff;">new</span><span style="color: #000000;"> HTable(hbaseConfig, &ldquo;mytest&rdquo;);<br><br>Delete d </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Delete(&ldquo;row1&Prime;.getBytes());<br><br>table.delete(d) </span></pre><br></div>

<p><span style="line-height: 1.5;">&nbsp;</span></p>
<p><span>åˆ‡åˆ†è¡¨</span></p>
<p>HBaseAdminæä¾›splitæ–¹æ³•æ¥å°†table è¿›è¡Œsplit.</p>
<p>public void split(final String tableNameOrRegionName)</p>
<p>&nbsp;</p>
<p>å¦‚æœæä¾›çš„tableNameï¼Œé‚£ä¹ˆä¼šå°†tableæ‰€æœ‰regionè¿›è¡Œsplit ;å¦‚æœæä¾›çš„region Nameï¼Œé‚£ä¹ˆåªä¼šsplitè¿™ä¸ªregion.</p>
<p>ç”±äºsplitæ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ç¡®åˆ‡çš„æ§åˆ¶regionçš„ä¸ªæ•°ã€‚</p>
<p>&nbsp;</p>
<p>Example:</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> split(String tableName,<span style="color: #0000ff;">int</span> number,<span style="color: #0000ff;">int</span> timeout) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {<br><br>    Configuration HBASE_CONFIG </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Configuration();<br><br>    HBASE_CONFIG.set(&ldquo;hbase.zookeeper.quorum&rdquo;, GlobalConf.ZOOKEEPER_QUORUM);<br><br>    HBASE_CONFIG.set(&ldquo;hbase.zookeeper.property.clientPort&rdquo;, GlobalConf.ZOOKEEPER_PORT);<br><br>    HBaseConfiguration cfg </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> HBaseConfiguration(HBASE_CONFIG);<br><br>    HBaseAdmin hAdmin </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> HBaseAdmin(cfg);<br><br>    HTable hTable </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> HTable(cfg,tableName);<br><br>    </span><span style="color: #0000ff;">int</span> oldsize = 0<span style="color: #000000;">;<br><br>    t </span>=<span style="color: #000000;">  System.currentTimeMillis();<br><br>    </span><span style="color: #0000ff;">while</span>(<span style="color: #0000ff;">true</span><span style="color: #000000;">){<br><br>       </span><span style="color: #0000ff;">int</span> size =<span style="color: #000000;"> hTable.getRegionsInfo().size();<br><br>       logger.info(&ldquo;the region number</span>=&rdquo;+<span style="color: #000000;">size);<br><br>       </span><span style="color: #0000ff;">if</span>(size&gt;=number ) <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br><br>       </span><span style="color: #0000ff;">if</span>(size!=<span style="color: #000000;">oldsize){<br><br>           hAdmin.split(hTable.getTableName());<br><br>           oldsize </span>=<span style="color: #000000;"> size;<br><br>       }       </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(System.currentTimeMillis()-t&gt;<span style="color: #000000;">timeout){<br><br>           </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;<br><br>       }<br><br>       Thread.sleep(</span>1000*10<span style="color: #000000;">);<br><br>    }<br><br>}</span></pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>æ¥è‡ªï¼š<a href="http://www.open-open.com/lib/view/open1342514370807.html" target="_blank" rel="noopener">http://www.open-open.com/lib/view/open1342514370807.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> j2ee </tag>
            
            <tag> java web </tag>
            
            <tag> java </tag>
            
            <tag> Hbase </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åœ¨Ubuntuä¸Šå®‰è£…Hadoopï¼ˆå•æœºæ¨¡å¼ï¼‰æ­¥éª¤]]></title>
      <url>/2014/02/17/%E5%9C%A8Ubuntu%E4%B8%8A%E5%AE%89%E8%A3%85Hadoop%EF%BC%88%E5%8D%95%E6%9C%BA%E6%A8%A1%E5%BC%8F%EF%BC%89%E6%AD%A5%E9%AA%A4/</url>
      <content type="html"><![CDATA[<p>1. å®‰è£…jdkï¼š<br>sudo apt-get install openjdk-6-jdk</p>
<p>2. é…ç½®sshï¼š<br>å®‰è£…sshï¼š<br>apt-get install openssh-server</p>
<p>ä¸ºè¿è¡Œhadoopçš„ç”¨æˆ·ç”Ÿæˆä¸€ä¸ªSSH keyï¼š<br>$ ssh-keygen -t rsa -P â€œâ€</p>
<p>è®©ä½ å¯ä»¥é€šè¿‡æ–°ç”Ÿæˆçš„keyæ¥ç™»å½•æœ¬åœ°æœºå™¨ï¼š<br>$ cp ~/.ssh/id_rsa.pub ~/.ssh/authorized_keys</p>
<p>3. å®‰è£…hadoopï¼š<br>ä¸‹è½½hadoop tar.gzåŒ…<br>å¹¶è§£å‹ï¼š<br>tar -zxvf hadoop-2.2.0.tar.gz</p>
<p>4. é…ç½®ï¼š</p>
<ul>
<li><p>åœ¨~/.bashrcæ–‡ä»¶ä¸­æ·»åŠ ï¼š<br>export HADOOP_HOME=/usr/local/hadoop<br>export JAVA_HOME=/usr/lib/jvm/java-6-openjdk-amd64<br>export PATH=$PATH:$HADOOP_HOME/bin<br>åœ¨ä¿®æ”¹å®Œæˆåä¿å­˜ï¼Œé‡æ–°ç™»å½•ï¼Œç›¸åº”çš„ç¯å¢ƒå˜é‡å°±é…ç½®å¥½äº†ã€‚</p>
</li>
<li><p>é…ç½®hadoop-env.shï¼š<br>export JAVA_HOME=/usr/lib/jvm/java-6-openjdk-amd64</p>
</li>
<li><p>é…ç½®hdfs-site.xmlï¼š<br>&lt;property&gt;</p>
<p>  &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</p>
<p>  &lt;value&gt;/app/hadoop/tmp&lt;/value&gt;<br>  &lt;description&gt;A base for other temporary directories.&lt;/description&gt;</p>
</li>
</ul>
<p>&lt;/property&gt;</p>
<p>&lt;property&gt;<br>    &lt;name&gt;fs.default.name&lt;/name&gt;</p>
<pre><code>&amp;lt;value&amp;gt;hdfs://localhost:9000&amp;lt;/value&amp;gt;
&amp;lt;description&amp;gt;The name of the default file system.  A URI whose
</code></pre><p>  scheme and </p>
<p>authority determine the FileSystem implementation.  The<br>  uriâ€™s scheme determines the </p>
<p>config property (fs.SCHEME.impl) naming<br>  the FileSystem implementation class.  The uriâ€™s </p>
<p>authority is used to<br>  determine the host, port, etc. for a filesystem.&lt;/description&gt;<br>&lt;/property&gt;</p>
<ul>
<li><p>é…ç½®mapred-site.xmlï¼š<br>&lt;property&gt;<br>&lt;name&gt;mapred.job.tracker&lt;/name&gt;<br>&lt;value&gt;localhost:9001&lt;/value&gt;<br>&lt;description&gt;The host and port that the MapReduce job tracker runs<br>at.  If â€œlocalâ€, then jobs are run in-process as a single map<br>and reduce task.<br>&lt;/description&gt;<br>&lt;/property&gt;</p>
</li>
<li><p>é…ç½®hdfs-site.xmlï¼š<br>&lt;property&gt;</p>
<p>  &lt;name&gt;dfs.replication&lt;/name&gt;</p>
<p>  &lt;value&gt;1&lt;/value&gt;<br>  &lt;description&gt;Default block replication.<br>The actual number of replications can be </p>
</li>
</ul>
<p>specified when the file is created.<br>  The default is used if replication is not specified </p>
<p>in create time.<br>  &lt;/description&gt;</p>
<p>&lt;/property&gt;</p>
<p>5. é€šè¿‡ NameNode æ¥æ ¼å¼åŒ– HDFS æ–‡ä»¶ç³»ç»Ÿ<br>$ /usr/local/hadoop/bin/hadoop namenode -format</p>
<p>6. è¿è¡Œhadoop<br>$ /usr/local/hadoop/sbin/start-all.sh</p>
<p>7. æ£€æŸ¥hadoopçš„è¿è¡ŒçŠ¶å†µ</p>
<ul>
<li><p>ä½¿ç”¨jpsæ¥æ£€æŸ¥hadoopçš„è¿è¡ŒçŠ¶å†µï¼š<br>$ jps</p>
</li>
<li><p>ä½¿ç”¨netstat å‘½ä»¤æ¥æ£€æŸ¥ hadoop æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š<br>$ sudo netstat -plten | grep java</p>
</li>
</ul>
<p>8. åœæ­¢è¿è¡Œhadoopï¼š<br>$ /usr/local/hadoop/bins/stop-all.sh</p>
]]></content>
      
        
        <tags>
            
            <tag> j2ee </tag>
            
            <tag> java web </tag>
            
            <tag> java </tag>
            
            <tag> ubuntu </tag>
            
            <tag> hadoop </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[android]äº²è‡ªç ´è§£Flappy Birdï¼ˆå»å¹¿å‘Š+æ°¸ç”Ÿï¼‰]]></title>
      <url>/2014/02/11/android-%E4%BA%B2%E8%87%AA%E7%A0%B4%E8%A7%A3Flappy-Bird%EF%BC%88%E5%8E%BB%E5%B9%BF%E5%91%8A-%E6%B0%B8%E7%94%9F%EF%BC%89/</url>
      <content type="html"><![CDATA[<p><span>å¬è¯´æœ€è¿‘Flappy Birdå¾ˆç«ï¼Œä½†æ˜¯éš¾åº¦ä»¤äººå‘æŒ‡ï¼Œäºæ˜¯æ€’äº†ï¼Œäº²è‡ªç ´è§£ï¼ˆå»å¹¿å‘Š+æ°¸ç”Ÿï¼‰</span></p>
<p><span>åªè¦ä¸ç¢°åˆ°åœ°ä¸Šï¼Œæ°¸è¿œä¸æ­»ï¼Œç›´æ¥ç©¿è¿‡ç®¡é“- -ï¼ä¸‹è½½åœ°å€ï¼š</span><a href="http://pan.baidu.com/s/1kT7bA55" target="_blank" rel="noopener">http://pan.baidu.com/s/1kT7bA55</a></p>
<p>æ³¨æ„ï¼šåªæ”¯æŒandroidç‰ˆæœ¬</p>
<p>æ•ˆæœå›¾ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201402/111729388451360.png" alt="">&nbsp;<img src="http://images.cnitblog.com/blog/378300/201402/111730054144409.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>åç¼–è¯‘åä¿®æ”¹smaliï¼š</p>
<p><span style="color: #ff0000;">å»å¹¿å‘Šï¼š</span></p>
<p>ä¿®æ”¹Flappy_Bird\smali\com\dotgears\a.smaliå’Œb.smaliä¸­run()æ–¹æ³•ä¸­å¯¹åº”ä¿®æ”¹ä¸ºï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #000000;">const/4 v1, 0x4<br><br>    invoke-virtual {v0, v1}, Lcom/google/ads/AdView;-&gt;setVisibility(I)V</span></pre><br></div>

<p>&nbsp;</p>
<p><span style="line-height: 1.5; color: #ff0000;">æ°¸ç”Ÿï¼ˆå–æ¶ˆç¢°æ’æ£€æµ‹å³å¯ï¼‰ï¼š</span></p>
<p>ä¿®æ”¹Flappy_Bird\smali\com\dotgears\flappy\c.smali</p>
<div class="cnblogs_code"><br><pre><span style="color: #000000;">.method public static a(IIIIIIII)Z<br>    .locals 1<br><br>    add-int v0, p0, p2<br><br>    if-lt v0, p4, :cond_0<br><br>    add-int v0, p4, p6<br><br>    if-gt p0, v0, :cond_0<br><br>    add-int v0, p1, p3<br><br>    if-lt v0, p5, :cond_0<br><br>    add-int v0, p5, p7<br><br>    if-le p1, v0, :cond_1<br><br>    :cond_0<br>    const/4 v0, 0x0<br><br>    :goto_0<br>    return v0<br><br>    :cond_1<br>    const/4 v0, 0x1<br><br>    goto :goto_0<br>.end method</span></pre><br></div>

<p>æ”¹ä¸ºï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #000000;">.method public static a(IIIIIIII)Z<br>    .locals 1<br><br>    :cond_0<br>    const/4 v0, 0x0<br><br>    :goto_0<br>    return v0<br><br>    :cond_1<br>    const/4 v0, 0x1<br><br>    goto :goto_0<br>.end method</span></pre><br></div>

<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ç ´è§£ </tag>
            
            <tag> Flappy Bird </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[AndroidInjecté¡¹ç›®ä½¿ç”¨åŠ¨æ€ä»£ç†å¢åŠ å¯¹ç½‘ç»œè¯·æ±‚çš„æ”¯æŒ]]></title>
      <url>/2014/02/08/AndroidInject%E9%A1%B9%E7%9B%AE%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E5%A2%9E%E5%8A%A0%E5%AF%B9%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E6%94%AF%E6%8C%81/</url>
      <content type="html"><![CDATA[<p>AndroidInjecté¡¹ç›®æ˜¯æˆ‘å†™çš„ä¸€ä¸ªä½¿ç”¨æ³¨è§£æ³¨å…¥æ¥ç®€åŒ–ä»£ç çš„å¼€æºé¡¹ç›®</p>
<p><a href="https://github.com/wangjiegulu/androidInject" target="_blank" rel="noopener">https://github.com/wangjiegulu/androidInject</a></p>
<p>ä»Šå¤©æ–°å¢åŠŸèƒ½å¦‚ä¸‹ï¼š</p>
<p>1. å¢åŠ @AIScreenSizeæ³¨è§£ï¼Œä½œç”¨äºå±æ€§ï¼Œç”¨äºæ³¨å…¥å½“å‰è®¾å¤‡çš„å±å¹•å¤§å°ï¼ˆå®½é«˜ï¼‰<br>2. å¢åŠ å¯¹ç½‘ç»œè¯·æ±‚çš„æ”¯æŒï¼Œä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°ï¼š@AIGetæ³¨è§£ï¼Œä½œç”¨äºæ¥å£æ–¹æ³•ï¼Œè¡¨ç¤ºä»¥GETæ¥è¯·æ±‚urlï¼›@AIPostæ³¨è§£ï¼Œä½œç”¨äºæ¥å£æ–¹æ³•ï¼Œè¡¨ç¤ºä»¥POSTæ¥è¯·æ±‚urlï¼›@AIParamï¼Œç”¨äºæ³¨å…¥è¯·æ±‚å‚æ•°<br>3. å¢åŠ @AINetWorkeræ³¨è§£ï¼Œä½œç”¨äºå±æ€§ï¼Œç”¨äºæ³¨å…¥ç½‘ç»œè¯·æ±‚æœåŠ¡<br>4. å¢åŠ GETæˆ–POSTè¯·æ±‚æ—¶è¯·æ±‚å‚æ•°å¯ä½¿ç”¨Paramsç±»ä¼ å…¥ï¼Œç®€åŒ–ä»£ç </p>
<p>&nbsp;</p>
<p>ä¸»è¦æ‰§è¡Œä»£ç å¦‚ä¸‹ï¼š</p>
<p>ç”¨@AINetWorkeræ³¨è§£æ³¨å…¥NetWorkeræ¥å£çš„å­ç±»ä»£ç†ï¼ˆåŠ¨æ€ä»£ç†æ¨¡å¼ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #000000;">@AINetWorker<br></span><span style="color: #008080;">2</span> <span style="color: #0000ff;">private</span> PersonWorker personWorker;</pre><br></div>

<p><span style="line-height: 1.5;">ç„¶åå¯åŠ¨çº¿ç¨‹ï¼Œåœ¨çº¿ç¨‹ä¸­è°ƒç”¨è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">new</span> Thread(<span style="color: #0000ff;">new</span><span style="color: #000000;"> Runnable() {<br></span><span style="color: #008080;">2</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">3</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> run() {<br></span><span style="color: #008080;">4</span> <span style="color: #008000;">//</span><span style="color: #008000;">        RetMessage&lt;Person&gt; retMsg = personWorker.getPersonsForGet(â€œa1â€, â€œb1â€, â€œc1â€);<br></span><span style="color: #008080;">5</span> <span style="color: #008000;">//</span><span style="color: #008000;">        RetMessage&lt;Person&gt; retMsg = personWorker.getPersonsForGet2(new Params().add(â€œaaâ€, â€œa1â€).add(â€œbbâ€, â€œb1â€).add(â€œccâ€, â€œc1â€));</span><br><span style="color: #008080;">6</span>         RetMessage&lt;Person&gt; retMsg = personWorker.getPersonsForPost2(<span style="color: #0000ff;">new</span> Params().add(â€œaaâ€, â€œa1â€).add(â€œbbâ€, â€œb1â€).add(â€œccâ€, â€œc1â€<span style="color: #000000;">));<br></span><span style="color: #008080;">7</span> <span style="color: #000000;">        System.out.println(retMsg.getList().toString());<br></span><span style="color: #008080;">8</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">9</span> }).start();</pre><br></div>

<p>è¯·æ±‚çš„ç»“æœå°è£…åœ¨RetMessageç±»ä¸­ï¼ˆAndroidInjectæ¡†æ¶æ‰€ä½œçš„äº‹å°±æ˜¯æ‰§è¡ŒGetæˆ–è€…Postè¯·æ±‚ï¼Œè·å¾—è¿”å›ç»“æœï¼Œç„¶åjsonè§£æåå°è£…åœ¨RetMessageä¸­ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.core.net;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.google.gson.Gson;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br><br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  Jsonå“åº”ç»“æœåŒ…è£…ç±»<br> <em> Created with IntelliJ IDEA.
 </em> Author: wangjie  email:tiantian.china.2@gmial.com<br> <em> Date: 14-2-7
 </em> Time: ä¸‹åˆ4:25<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> RetMessage&lt;T&gt;<span style="color: #000000;"><br>{<br>    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> resultCode; <span style="color: #008000;">//</span><span style="color: #008000;"> ç»“æœç ï¼Œå¿…é¡»åŒ…å«</span><br><br>    <span style="color: #0000ff;">private</span> List&lt;T&gt; list; <span style="color: #008000;">//</span><span style="color: #008000;"> è¿”å›çš„æ•°æ®</span><br><br>    <span style="color: #0000ff;">private</span> T obj; <span style="color: #008000;">//</span><span style="color: #008000;"> è¿”å›çš„æ•°æ®</span><br><br>    <span style="color: #0000ff;">private</span> Integer size; <span style="color: #008000;">//</span><span style="color: #008000;"> è¿”å›æ•°æ®é•¿åº¦</span><br><br>    <span style="color: #0000ff;">private</span> String errorMessage; <span style="color: #008000;">//</span><span style="color: #008000;"> è¿”å›é”™è¯¯ä¿¡æ¯</span><br><br>    <span style="color: #0000ff;">public</span><span style="color: #000000;"> String toJson(){<br>        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> Gson().toJson(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br>    }<br>    </span><span style="color: #008000;">//</span><span style="color: #008000;"> getterå’Œsetteræ–¹æ³•çœç•¥â€¦</span><span style="color: #000000;"><br>}</span></pre><br></div>

<p>æ¥ä¸‹æ¥çœ‹ä¸‹PersonWorkeræ¥å£ä¸­æ‰€ä½œçš„äº‹æƒ…ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.androidinject;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.annotations.net.AIGet;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.annotations.net.AIParam;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.annotations.net.AIPost;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.core.net.RetMessage;<br></span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.util.Params;<br></span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.model.Person;<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">11</span> <span style="color: #008000;">  Created with IntelliJ IDEA.<br></span><span style="color: #008080;">12</span> <span style="color: #008000;"> <em> Author: wangjie  email:tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;">13</span> <span style="color: #008000;">  Date: 14-2-7<br></span><span style="color: #008080;">14</span> <span style="color: #008000;"> <em> Time: ä¸‹åˆ1:44<br></em></span><span style="color: #008080;">15</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;">16</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> PersonWorker {<br></span><span style="color: #008080;">17</span>     @AIGet(â€œ<a href="http://192.168.2.198:8080/HelloSpringMVC/person/findPersons?aa=#{a3}&amp;bb=#{b3}&amp;cc=#{c3}" target="_blank" rel="noopener">http://192.168.2.198:8080/HelloSpringMVC/person/findPersons?aa=#{a3}&amp;bb=#{b3}&amp;cc=#{c3}</a>â€œ<span style="color: #000000;">)<br></span><span style="color: #008080;">18</span>     <span style="color: #0000ff;">public</span> RetMessage&lt;Person&gt; getPersonsForGet(@AIParam(â€œa3â€)String a2, @AIParam(â€œb3â€) String b2, @AIParam(â€œc3â€<span style="color: #000000;">) String c2);<br></span><span style="color: #008080;">19</span><br><span style="color: #008080;">20</span>     @AIPost(â€œ<a href="http://192.168.2.198:8080/HelloSpringMVC/person/findPersons" target="_blank" rel="noopener">http://192.168.2.198:8080/HelloSpringMVC/person/findPersons</a>â€œ<span style="color: #000000;">)<br></span><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span> RetMessage&lt;Person&gt; getPersonsForPost(@AIParam(â€œaaâ€)String a2, @AIParam(â€œbbâ€) String b2, @AIParam(â€œccâ€<span style="color: #000000;">) String c2);<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span>     @AIGet(â€œ<a href="http://192.168.2.198:8080/HelloSpringMVC/person/findPersons" target="_blank" rel="noopener">http://192.168.2.198:8080/HelloSpringMVC/person/findPersons</a>â€œ<span style="color: #000000;">)<br></span><span style="color: #008080;">24</span>     <span style="color: #0000ff;">public</span> RetMessage&lt;Person&gt;<span style="color: #000000;"> getPersonsForGet2(Params params);<br></span><span style="color: #008080;">25</span><br><span style="color: #008080;">26</span>     @AIPost(â€œ<a href="http://192.168.2.198:8080/HelloSpringMVC/person/findPersons" target="_blank" rel="noopener">http://192.168.2.198:8080/HelloSpringMVC/person/findPersons</a>â€œ<span style="color: #000000;">)<br></span><span style="color: #008080;">27</span>     <span style="color: #0000ff;">public</span> RetMessage&lt;Person&gt;<span style="color: #000000;"> getPersonsForPost2(Params params);<br></span><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span><br><span style="color: #008080;">30</span> }</pre><br></div>

<p>PersonWorkeræ˜¯è‡ªå·±å†™çš„ä¸€ä¸ªæ¥å£ï¼ˆä»¥åéœ€è¦æœ‰æ–°çš„ç½‘ç»œè¯·æ±‚ï¼Œéƒ½å¯ä»¥ç±»ä¼¼ç¼–å†™Workerï¼‰ï¼Œå£°æ˜äº†æ‰§è¡Œç½‘ç»œè¯·æ±‚çš„å„ç§æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•éœ€è¦åŠ ä¸Š@AIGetæˆ–è€…@AIPostæ³¨è§£ï¼Œç”¨äºå£°æ˜è¯·æ±‚æ–¹å¼ï¼Œå¹¶åœ¨æ­¤æ³¨è§£ä¸­çš„value()å€¼è®¾ç½®ä¸ºæ‰€è¦è¯·æ±‚çš„urlï¼ˆæ­¤æ³¨è§£çš„å…¶ä»–å±æ€§åç»­ä¼šé™†ç»­æ‰©å±•ï¼‰</p>
<p>æ–¹æ³•çš„@AIParamæ³¨è§£æ˜¯ä½œç”¨ä¸mybatisçš„@Paramæ³¨è§£ç±»ä¼¼ï¼Œå¯ä»¥è®¾ç½®è¯·æ±‚æºå¸¦çš„å‚æ•°</p>
<p>å¦‚æœå‚æ•°æ¯”è¾ƒå¤šï¼Œåˆ™æ¨èä½¿ç”¨Paramsæ¥å­˜æ”¾å‚æ•°ï¼Œä»¥æ­¤æ¥ç®€åŒ–ä»£ç ï¼ŒParamsç±»å®è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªHashMapï¼Œå­˜æ”¾å‚æ•°çš„é”®å€¼å¯¹å³å¯ã€‚</p>
<p>&nbsp;</p>
<p>æ¥ä¸‹æ¥åˆ†æä¸‹æ¡†æ¶æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå…¶å®ä¸Šé¢è®²è¿‡ï¼Œä¸»è¦æ˜¯ç”¨Annotaionå’ŒåŠ¨æ€ä»£ç†äº†</p>
<p>é¦–å…ˆçœ‹çœ‹PersonWorkerçš„æ³¨å…¥ï¼Œåœ¨AIActivityï¼ˆAIActivityï¼ŒAndroidInjectå¼€æºé¡¹ç›®ä¸­çš„Activityä½¿ç”¨æ³¨è§£çš„è¯ï¼Œä½ å†™çš„Activityå¿…é¡»ç»§æ‰¿AIActivityï¼Œå¦å¤–å¦‚æœè¦ä½¿ç”¨FragmentActivityï¼Œåˆ™éœ€è¦ç»§æ‰¿AISupportFragmentActivityï¼‰å¯åŠ¨æ—¶ï¼Œé¦–å…ˆä¼šå»è§£ææ·»åŠ çš„æ³¨è§£ï¼Œè¿™é‡Œè®¨è®º@AINetWorkeræ³¨è§£ï¼Œå†…éƒ¨ä»£ç å¾ˆç®€å•ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">2</span> <span style="color: #008000;">  æ³¨å…¥NetWorker<br></span><span style="color: #008080;">3</span> <span style="color: #008000;"> <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> field<br></span><span style="color: #008080;">4</span> <span style="color: #008000;">  </span><span style="color: #808080;">@throws</span><span style="color: #008000;"> Exception<br></span><span style="color: #008080;">5</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;">6</span>  <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> netWorkerBind(Field field) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception{<br></span><span style="color: #008080;">7</span>         field.setAccessible(<span style="color: #0000ff;">true</span><span style="color: #000000;">);<br></span><span style="color: #008080;">8</span> <span style="color: #000000;">        field.set(present, NetInvoHandler.getWorker(field.getType()));<br></span><span style="color: #008080;">9</span>  }</pre><br></div>

<p>é€šè¿‡ä»£ç å¯çŸ¥ï¼Œæ˜¯ä½¿ç”¨åå°„æ¥å®ç°çš„ï¼Œä¸»è¦çš„ä»£ç æ˜¯è¿™å¥ï¼š</p>
<div class="cnblogs_code"><br><pre>NetInvoHandler.getWorker(field.getType());</pre><br></div>

<p>è¿™å¥ä»£ç çš„ä½œç”¨æ˜¯é€šè¿‡Classè·å¾—ä¸€ä¸ªPersonWorkerå®ç°ç±»çš„ä»£ç†å¯¹è±¡ï¼Œè¿™é‡Œå¾ˆæ˜æ˜¾æ˜¯ä½¿ç”¨äº†åŠ¨æ€ä»£ç†ã€‚</p>
<p>æ‰€ä»¥ï¼Œæœ€æ ¸å¿ƒçš„ç±»åº”è¯¥æ˜¯NetInvoHandlerè¿™ä¸ªç±»ï¼Œè¿™ä¸ªç±»çš„ä»£ç å¦‚ä¸‹ï¼ˆç¯‡å¹…é—®é¢˜ï¼Œæ‰€ä»¥å°±æŠ˜å äº†ï¼‰ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('7d38bbca-82a1-429f-a5c2-68b2ebe85e58')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_7d38bbca-82a1-429f-a5c2-68b2ebe85e58" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.core.net;<br></span><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.text.TextUtils;<br></span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.google.gson.Gson;<br></span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.annotations.net.AIGet;<br></span><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.annotations.net.AIParam;<br></span><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.annotations.net.AIPost;<br></span><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.util.Params;<br></span><span style="color: #008080;">  9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.util.StringUtil;<br></span><span style="color: #008080;"> 10</span><br><span style="color: #008080;"> 11</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.annotation.Annotation;<br></span><span style="color: #008080;"> 12</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.InvocationHandler;<br></span><span style="color: #008080;"> 13</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Method;<br></span><span style="color: #008080;"> 14</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Proxy;<br></span><span style="color: #008080;"> 15</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.HashMap;<br></span><span style="color: #008080;"> 16</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Map;<br></span><span style="color: #008080;"> 17</span><br><span style="color: #008080;"> 18</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 19</span> <span style="color: #008000;">  Created with IntelliJ IDEA.<br></span><span style="color: #008080;"> 20</span> <span style="color: #008000;"> <em> Author: wangjie  email:tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 21</span> <span style="color: #008000;">  Date: 14-2-7<br></span><span style="color: #008080;"> 22</span> <span style="color: #008000;"> <em> Time: ä¸‹åˆ1:40<br></em></span><span style="color: #008080;"> 23</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 24</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> NetInvoHandler <span style="color: #0000ff;">implements</span><span style="color: #000000;"> InvocationHandler{<br></span><span style="color: #008080;"> 25</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> HashMap&lt;Class&lt;?&gt;, NetInvoHandler&gt; invoHandlers = <span style="color: #0000ff;">new</span> HashMap&lt;Class&lt;?&gt;, NetInvoHandler&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;"> 26</span><br><span style="color: #008080;"> 27</span>     <span style="color: #0000ff;">private</span> Object proxy; <span style="color: #008000;">//</span><span style="color: #008000;"> ä»£ç†å¯¹è±¡</span><br><span style="color: #008080;"> 28</span><br><span style="color: #008080;"> 29</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">synchronized</span>  <span style="color: #0000ff;">static</span>&lt;T&gt; T getWorker(Class&lt;T&gt;<span style="color: #000000;"> clazz){<br></span><span style="color: #008080;"> 30</span>         NetInvoHandler netInvoHandler =<span style="color: #000000;"> invoHandlers.get(clazz);<br></span><span style="color: #008080;"> 31</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> netInvoHandler){<br></span><span style="color: #008080;"> 32</span>             netInvoHandler = <span style="color: #0000ff;">new</span><span style="color: #000000;"> NetInvoHandler();<br></span><span style="color: #008080;"> 33</span>             netInvoHandler.setProxy(Proxy.newProxyInstance(clazz.getClassLoader(), <span style="color: #0000ff;">new</span><span style="color: #000000;"> Class[]{clazz}, netInvoHandler));<br></span><span style="color: #008080;"> 34</span> <span style="color: #000000;">            invoHandlers.put(clazz, netInvoHandler);<br></span><span style="color: #008080;"> 35</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 36</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> (T)netInvoHandler.getProxy();<br></span><span style="color: #008080;"> 37</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 38</span><br><span style="color: #008080;"> 39</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 40</span>     <span style="color: #0000ff;">public</span> Object invoke(Object proxy, Method method, Object[] args) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Throwable {<br></span><span style="color: #008080;"> 41</span><br><span style="color: #008080;"> 42</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> getè¯·æ±‚</span><br><span style="color: #008080;"> 43</span>         <span style="color: #0000ff;">if</span>(method.isAnnotationPresent(AIGet.<span style="color: #0000ff;">class</span><span style="color: #000000;">)){<br></span><span style="color: #008080;"> 44</span>             AIGet aiGet = method.getAnnotation(AIGet.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 45</span>             String url =<span style="color: #000000;"> aiGet.value();<br></span><span style="color: #008080;"> 46</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;">(TextUtils.isEmpty(url)){<br></span><span style="color: #008080;"> 47</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œnet work [â€œ + method.getName() + â€œ]@AIGet value()[url] is empty!!â€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 48</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 49</span>             Annotation[][] annotaions =<span style="color: #000000;"> method.getParameterAnnotations();<br></span><span style="color: #008080;"> 50</span>             <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 0; i &lt; args.length; i++<span style="color: #000000;">){<br></span><span style="color: #008080;"> 51</span>                 <span style="color: #0000ff;">if</span>(Params.<span style="color: #0000ff;">class</span>.isAssignableFrom(args[i].getClass())){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœå±æ€§ä¸ºParamsï¼Œåˆ™è¿½åŠ åœ¨åé¢</span><br><span style="color: #008080;"> 52</span>                     url =<span style="color: #000000;"> StringUtil.appendParamsAfterUrl(url, (Params)args[i]);<br></span><span style="color: #008080;"> 53</span>                 }<span style="color: #0000ff;">else</span>{ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœå±æ€§æ·»åŠ äº†@AIParamæ³¨è§£ï¼Œåˆ™æ›¿æ¢é“¾æ¥ä¸­#{xxx}</span><br><span style="color: #008080;"> 54</span>                     String repName = ((AIParam)annotaions[i][0<span style="color: #000000;">]).value();<br></span><span style="color: #008080;"> 55</span>                     url = url.replace(â€œ#{â€œ + repName + â€œ}â€, args[i] + â€œâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 56</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;"> 57</span><br><span style="color: #008080;"> 58</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 59</span>             StringBuilder sb =<span style="color: #000000;"> NetWork.getStringFromUrl(url);<br></span><span style="color: #008080;"> 60</span>             <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> sb){<br></span><span style="color: #008080;"> 61</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 62</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 63</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> Gson().fromJson(sb.toString(), method.getReturnType());<br></span><span style="color: #008080;"> 64</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 65</span><br><span style="color: #008080;"> 66</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> postè¯·æ±‚</span><br><span style="color: #008080;"> 67</span>         <span style="color: #0000ff;">if</span>(method.isAnnotationPresent(AIPost.<span style="color: #0000ff;">class</span><span style="color: #000000;">)){<br></span><span style="color: #008080;"> 68</span>             AIPost aiPost = method.getAnnotation(AIPost.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 69</span>             String url =<span style="color: #000000;"> aiPost.value();<br></span><span style="color: #008080;"> 70</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;">(TextUtils.isEmpty(url)){<br></span><span style="color: #008080;"> 71</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œnet work [â€œ + method.getName() + â€œ]@AIPost value()[url] is empty!!â€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 72</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 73</span>             Annotation[][] annotaions =<span style="color: #000000;"> method.getParameterAnnotations();<br></span><span style="color: #008080;"> 74</span>             Map&lt;String, String&gt; map = <span style="color: #0000ff;">new</span> HashMap&lt;String, String&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;"> 75</span>             <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 0; i &lt; args.length; i++<span style="color: #000000;">){<br></span><span style="color: #008080;"> 76</span>                 <span style="color: #0000ff;">if</span>(Params.<span style="color: #0000ff;">class</span>.isAssignableFrom(args[i].getClass())){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœå±æ€§ä¸ºParamsï¼Œåˆ™è¿½åŠ åœ¨åé¢</span><br><span style="color: #008080;"> 77</span> <span style="color: #000000;">                    map.putAll((Params)args[i]);<br></span><span style="color: #008080;"> 78</span>                 }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;"> 79</span>                     String repName = ((AIParam)annotaions[i][0<span style="color: #000000;">]).value();<br></span><span style="color: #008080;"> 80</span>                     map.put(repName, args[i] + â€œâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 81</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;"> 82</span><br><span style="color: #008080;"> 83</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 84</span>             StringBuilder sb =<span style="color: #000000;"> NetWork.postStringFromUrl(url, map);<br></span><span style="color: #008080;"> 85</span>             <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> sb){<br></span><span style="color: #008080;"> 86</span>                 <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 87</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 88</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> Gson().fromJson(sb.toString(), method.getReturnType());<br></span><span style="color: #008080;"> 89</span><br><span style="color: #008080;"> 90</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 91</span><br><span style="color: #008080;"> 92</span><br><span style="color: #008080;"> 93</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 94</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 95</span><br><span style="color: #008080;"> 96</span><br><span style="color: #008080;"> 97</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Object getProxy() {<br></span><span style="color: #008080;"> 98</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> proxy;<br></span><span style="color: #008080;"> 99</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">100</span><br><span style="color: #008080;">101</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setProxy(Object proxy) {<br></span><span style="color: #008080;">102</span>         <span style="color: #0000ff;">this</span>.proxy =<span style="color: #000000;"> proxy;<br></span><span style="color: #008080;">103</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">104</span> }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>é‡Œé¢çš„ä»£ç è¿˜æ²¡æœ‰å¥½å¥½çš„é‡æ„ï¼Œæ‰€ä»¥ï¼Œçœ‹èµ·æ¥ä¼šæ›´ç›´ç™½ï¼Œè¯¥ç±»å®ç°äº†InvocationHandlerï¼Œå¾ˆæ˜æ˜¾çš„åŠ¨æ€ä»£ç†ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡NetInvoHandlerçš„getWorkeré™æ€æ–¹æ³•ï¼Œæ¥è·å–ä¸€ä¸ªæŒ‡å®šClassçš„Workerå®ç°ç±»çš„ä»£ç†å¯¹è±¡ï¼Œç”±äºå®é™…åº”ç”¨æ—¶ï¼ŒWorkeræ¥å£åº”è¯¥ä¼šå¾ˆå¤šï¼Œä¸ºäº†ä¸é‡å¤ç”Ÿæˆç›¸åŒWorkerå®ç°ç±»çš„ä»£ç†å¯¹è±¡ï¼Œæ‰€ä»¥è¿™é‡Œåœ¨ç”Ÿæˆä¸€ä¸ªåï¼Œä¿å­˜èµ·æ¥ï¼Œç¡®ä¿ä¸€ä¸ªWorkeråªç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œä¸€ä¸ªNetInvoHandlerã€‚</p>
<p>è¿™é‡Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œä»¥å‰ä½¿ç”¨çš„åŠ¨æ€ä»£ç†ï¼Œéœ€è¦ä¸€ä¸ªRealSubjectï¼Œä¹Ÿå°±æ˜¯çœŸå®å¯¹è±¡ï¼Œæ˜¯Workerçš„å®ç°ç±»ã€‚è¿™æ ·ï¼Œåœ¨invokeæ–¹æ³•ä¸­å°±å¯ä»¥è°ƒç”¨çœŸå®å¯¹è±¡çš„å¯¹åº”æ–¹æ³•äº†ï¼Œä½†æ˜¯ç°åœ¨ï¼Œè¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œæˆ‘ä»¬æ²¡æœ‰å»å†™ä¸€ä¸ªç±»ç„¶åå®ç°PersonWorkeræ¥å£ï¼Œå› ä¸ºæ²¡æœ‰å¿…è¦ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨invokeæ–¹æ³•ä¸­å»æ‰§è¡Œç›¸åŒçš„ç½‘ç»œè¯·æ±‚ã€‚</p>
<p>è¯·æƒ³ä¸‹ï¼Œä¹‹æ‰€ä»¥éœ€è¦æ¡†æ¶çš„å­˜åœ¨ ä¸å°±æ˜¯ä¸ºäº†æŠŠä¸€äº›æ¨¡æ¿çš„ä¸œè¥¿ç»™ç®€åŒ–æ‰ä¹ˆï¼Ÿç°åœ¨çš„ç½‘ç»œè¯·æ±‚è¿™äº›æ­¥éª¤å°±æ˜¯ä¸€äº›æ¨¡æ¿è¯çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬éœ€è¦çš„å°±æ˜¯è°ƒç”¨æ–¹æ³•ï¼Œè‡ªåŠ¨è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼ˆæ¡†æ¶åšçš„äº‹ï¼‰ï¼Œç„¶åè¿”å›ç»™æˆ‘ç»“æœã€‚æ‰€ä»¥ç½‘ç»œè¯·æ±‚è¿™ä¸€æ­¥ï¼Œå†™åœ¨invokeæ–¹æ³•ä¸­å³å¯ã€‚</p>
<p>è€Œä¸æ˜¯æ‰€è°“çš„ç¼–å†™ä¸€ä¸ªç±»ï¼Œå®ç°PersonWorkeræ¥å£ï¼Œåœ¨è¿™ä¸ªå®ç°ç±»ä¸­è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œç„¶ååœ¨invokeæ–¹æ³•ä¸­è°ƒç”¨çœŸå®å¯¹è±¡çš„å¯¹åº”è¯¥æ–¹æ³•ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨Proxy.newProxyInstanceçš„interfacesä¸­å¡«å†™éœ€è¦å®ç°çš„æ¥å£ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨çš„PersonWorkerã€‚</p>
<p>&nbsp;</p>
<p>æ¥ä¸‹æ¥çœ‹ä¸‹invokeä¸­åšçš„äº‹æƒ…ï¼Œé¦–å…ˆæ ¹æ®æ–¹æ³•å¢åŠ çš„æ³¨è§£æ¥è¯†åˆ«æ˜¯GETè¯·æ±‚è¿˜æ˜¯POSTè¯·æ±‚ã€‚ç„¶åå„è‡ªæ‰§è¡Œè¯·æ±‚ï¼ˆå› ä¸ºæˆ‘è¯·æ±‚çš„æ‰§è¡Œï¼Œå†™åœ¨NetWorkä¸­äº†ï¼Œè¿™é‡Œç›´æ¥è¿”å›äº†è¯·æ±‚ç»“æœå­—ç¬¦ä¸²StringBuilder sbï¼‰ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨Gsonè¿™ä¸ªéœ¸æ°”çš„å·¥å…·ï¼Œä¸€é”®ä»jsonè§£æå°è£…æˆRetMessageå¯¹è±¡ã€‚ï¼ˆæ‰€ä»¥ï¼Œè¿™é‡Œæ˜¯éœ€è¦Gsonåº“çš„æ”¯æŒï¼Œå¤§å®¶ç½‘ä¸Šä¸‹è½½gson.jarï¼Œæˆ–è€…ä½¿ç”¨mavenï¼‰</p>
<p>å½“ç„¶ï¼Œè¦ä½¿ç”¨Gsonä¸€é”®è§£æå°è£…çš„å‰ææ˜¯æœåŠ¡å™¨ç«¯çš„ç¼–å†™éœ€è¦ä¿å­˜ä¸€è‡´æ€§ï¼Œä¸‹é¢æ˜¯æˆ‘æœåŠ¡å™¨ç«¯æµ‹è¯•çš„ä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> @RequestMapping(â€œ/findPersonsâ€<span style="color: #000000;">)<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> findPersons(HttpServletRequest request, HttpServletResponse response,<br></span><span style="color: #008080;"> 3</span>                                 @RequestParam(â€œaaâ€<span style="color: #000000;">) String aa,<br></span><span style="color: #008080;"> 4</span>                                 @RequestParam(â€œbbâ€<span style="color: #000000;">) String bb,<br></span><span style="color: #008080;"> 5</span>                                 @RequestParam(â€œccâ€) String cc) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> IOException{<br></span><span style="color: #008080;"> 6</span>         System.out.println(â€œaa: â€œ + aa + â€œ, bb: â€œ + bb + â€œ, cc: â€œ +<span style="color: #000000;"> cc);<br></span><span style="color: #008080;"> 7</span>         RetMessage&lt;Person&gt; rm = <span style="color: #0000ff;">new</span> RetMessage&lt;Person&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span>         rm.setResultCode(0<span style="color: #000000;">);<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span>         List&lt;Person&gt; persons = <span style="color: #0000ff;">new</span> ArrayList&lt;Person&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">12</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 0; i &lt; 5; i++<span style="color: #000000;">){<br></span><span style="color: #008080;">13</span>             Person p = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Person();<br></span><span style="color: #008080;">14</span>             p.setName(â€œwangjie_â€ +<span style="color: #000000;"> i);<br></span><span style="color: #008080;">15</span>             p.setAge(20 +<span style="color: #000000;"> i);<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">            persons.add(p);<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span> <span style="color: #000000;">        rm.setList(persons);<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> <span style="color: #000000;">        ServletUtil.obtinUTF8JsonWriter(response).write(rm.toJson());<br></span><span style="color: #008080;">22</span>     }</pre><br></div>

<p>æœåŠ¡å™¨ç«¯è¿”å›ç»“æœæ—¶ï¼Œä¹Ÿæ˜¯å°è£…åœ¨RetMessageç±»ä¸­ï¼Œè¿™ä¸ªç±»æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯æ˜¯ä¿æŒä¸€è‡´çš„ï¼Œæ‰€ä»¥å¯ä»¥ä¸€é”®è½¬æ¢ã€‚</p>
<p>å¦‚æœä½ åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼ŒRetMessageç±»ä¸­å°è£…çš„ä¸œè¥¿ä¸èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œå¯ä»¥è‡ªå·±ç¼–å†™ç»“æœç±»ï¼Œå½“ç„¶åœ¨Workerä¸­å£°æ˜æ–¹æ³•ä¸­è¿”å›å€¼å°±åº”è¯¥æ˜¯ä½ å†™çš„ç»“æœç±»äº†ã€‚</p>
<p>&nbsp;</p>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œè®²è§£å®Œæ¯•</p>
<p>å¦ï¼šå¦‚æœï¼Œä½ éœ€è¦å†™ä¸€ä¸ªæŸ¥è¯¢Userä¿¡æ¯çš„ç½‘ç»œè¯·æ±‚ï¼Œåº”è¯¥æ€ä¹ˆå†™ï¼Ÿ</p>
<p>åªéœ€ç¼–å†™UserWorkeræ¥å£ï¼Œç„¶åå£°æ˜æ–¹æ³•findUsers()ï¼Œå†™ä¸Š@AIGetæˆ–è€…@AIPostæ³¨è§£ï¼Œå†™æ˜urlå’Œè¯·æ±‚å‚æ•°ã€‚ç„¶åé€šè¿‡@AINetWorkeræ³¨è§£æ³¨å…¥userWorkerï¼Œç„¶åå¼€å¯çº¿ç¨‹ï¼Œè°ƒç”¨userWorkerçš„findUsers()æ–¹æ³•å³å¯ã€‚</p>
<p>å½“ç„¶UserWorkerä¹Ÿå¯ä»¥ä¸ä½¿ç”¨æ³¨è§£è·å¾—ï¼Œè€Œæ˜¯è°ƒç”¨&ldquo;NetInvoHandler.getWorker(UserWorker.class)&rdquo;è·å¾—ï¼</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> library </tag>
            
            <tag> annotations </tag>
            
            <tag> proxy </tag>
            
            <tag> http </tag>
            
            <tag> dynamic proxy </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[android]AndroidInjectæ¡†æ¶â€”â€”æˆ‘çš„ç¬¬ä¸€ä¸ªandroidå°å‹æ¡†æ¶]]></title>
      <url>/2013/12/05/android-AndroidInject%E6%A1%86%E6%9E%B6%E2%80%94%E2%80%94%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAandroid%E5%B0%8F%E5%9E%8B%E6%A1%86%E6%9E%B6/</url>
      <content type="html"><![CDATA[<p>ä½œä¸ºä¸€ä¸ªç§»åŠ¨åº”ç”¨å¼€å‘è€…ï¼Œéšç€éœ€æ±‚çš„æ—¥ç›Šå¢å¤šï¼ŒAndroidé¡¹ç›®çš„è¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œä»£ç é‡è¶Šæ¥è¶Šå¤§ï¼Œ</p>
<p>ç°åœ¨å†·é™ä¸‹æ¥å›å¤´çœ‹çœ‹æˆ‘ä»¬çš„ä»£ç ï¼Œæœ‰å¤šå°‘ä»£ç è·Ÿä¸šåŠ¡é€»è¾‘æ²¡ä»€ä¹ˆå…³ç³»çš„</p>
<p>&nbsp;</p>
<p>æ‰€ä»¥ï¼Œæœ¬äººè‡ªä¸é‡åŠ›ï¼Œåœ¨githubä¸Šå»ºäº†ä¸ªå¼€æºé¡¹ç›®ï¼Œå¸Œæœ›èƒ½ä¸€å®šç¨‹åº¦åœ°ç®€åŒ–æˆ‘çš„ä»£ç -ã€‚-</p>
<p>ç°åœ¨ç¬¬ä¸€ä¸ªç‰ˆæœ¬å®Œæˆï¼Œå¸Œæœ›æœ‰å…´è¶£çš„æœ‹å‹èƒ½åŠ å…¥ä¸€èµ·å®Œå–„ã€‚</p>
<p>æœ¬äººæ‰ç–å­¦æµ…ï¼Œä»£ç ä¸­æœ‰å†™å¾—ä¸å¦¥çš„åœ°æ–¹å¸Œæœ›å¤§å®¶ä¸åèµæ•™å“ˆï¼</p>
<p><strong>githubåœ°å€ï¼š</strong></p>
<p><a href="https://github.com/wangjiegulu/androidInject" target="_blank" rel="noopener">https://github.com/wangjiegulu/androidInject</a></p>
<p><strong>androidInject_1.0.jarï¼š</strong></p>
<p><a href="http://pan.baidu.com/s/1rcSiy" target="_blank" rel="noopener">http://pan.baidu.com/s/1rcSiy</a></p>
<p>&nbsp;</p>
<p>ä¸»è¦çš„æ€æƒ³å°±æ˜¯é€šè¿‡æ³¨è§£çš„æ–¹å¼ï¼ŒæŠŠæˆ‘ä»¬è¦åšçš„äº‹æƒ…ç›´æ¥æ³¨å…¥è¿›æ¥ç»™æˆ‘ä»¬ï¼Œ&ldquo;ä¸æ˜¯æˆ‘å»è°ƒç”¨å¯¹è±¡ï¼Œè€Œæ˜¯å¯¹è±¡è‡ªå·±æ¥æ‰¾æˆ‘&rdquo;</p>
<p>ç°åœ¨åˆšå†™å®Œäº†10ä¸ªæ³¨è§£ï¼š</p>
<p>@AINoTitleï¼Œ @AIFullScreenï¼Œ @AILayoutï¼Œ @AIViewï¼Œ @AIBeanï¼Œ @AISystemServiceï¼Œ @AIClickï¼Œ @AIItemClickï¼Œ @AILongClickï¼Œ @AIItemLongClick</p>
<p>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p>Activityä¸­ä½¿ç”¨ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('519219a9-a150-4491-a51e-2962ccedc68e')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_519219a9-a150-4491-a51e-2962ccedc68e" class="cnblogs_code_hide"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.androidinject;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.app.AlarmManager;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.content.Intent;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.location.LocationManager;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.Bundle;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.LayoutInflater;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br></span><span style="color: #0000ff;">import</span> android.widget.<em><span style="color: #000000;">;<br></span><span style="color: #0000ff;">import</span> com.wangjie.androidinject.annotation.annotations.</em><span style="color: #000000;">;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.present.AIActivity;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.model.Person;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.ArrayList;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.HashMap;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Map;<br><br>@AIFullScreen<br>@AINoTitle<br>@AILayout(R.layout.main)<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> AIActivity{<br><br>    @AIView(id </span>= R.id.btn1, clickMethod = â€œonClickCallbackâ€, longClickMethod = â€œonLongClickCallbackâ€<span style="color: #000000;">)<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Button btn1;<br><br>    @AIView(clickMethod </span>= â€œonClickCallbackâ€, longClickMethod = â€œonLongClickCallbackâ€<span style="color: #000000;">)<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Button btn2;<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;">    @AIView(id = R.id.btn3)<br></span><span style="color: #008000;">//</span><span style="color: #008000;">    private Button btn3;<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;">    @AIView(id = R.id.listView, itemClickMethod = â€œonItemClickCallbackâ€, itemLongClickMethod = â€œonItemLongClickCallbackForListViewâ€)</span><br>    @AIView(id =<span style="color: #000000;"> R.id.listView)<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> ListView listView;<br><br>    @AIBean<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Person person;<br><br>    @AISystemService<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> AlarmManager alarmManager;<br>    @AISystemService<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> LocationManager locationManager;<br>    @AISystemService<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> LayoutInflater inflater;<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br><br>        List</span>&lt;Map&lt;String, String&gt;&gt; list = <span style="color: #0000ff;">new</span> ArrayList&lt;Map&lt;String, String&gt;&gt;<span style="color: #000000;">();<br>        Map</span>&lt;String, String&gt;<span style="color: #000000;"> map;<br>        </span><span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 0; i &lt; 10; i++<span style="color: #000000;">){<br>            map </span>= <span style="color: #0000ff;">new</span> HashMap&lt;String, String&gt;<span style="color: #000000;">();<br>            map.put(</span>â€œtitleâ€, â€œitem_â€ +<span style="color: #000000;"> i);<br>            list.add(map);<br>        }<br><br>        SimpleAdapter adapter </span>= <span style="color: #0000ff;">new</span> SimpleAdapter(context, list, R.layout.list_item, <span style="color: #0000ff;">new</span> String[]{â€œtitleâ€}, <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">int</span><span style="color: #000000;">[]{R.id.list_item_title_tv});<br>        listView.setAdapter(adapter);<br><br>        person.setName(</span>â€œwangjieâ€<span style="color: #000000;">);<br>        person.setAge(</span>23<span style="color: #000000;">);<br>        System.out.println(person.toString());<br><br>        System.out.println(</span>â€œalarmManager: â€œ + alarmManager + â€œ, locationManager: â€œ + locationManager + â€œ, inflater: â€œ +<span style="color: #000000;"> inflater);<br><br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClickCallback(View view){<br>        </span><span style="color: #0000ff;">if</span>(view <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Button){<br>            Toast.makeText(context, </span>â€œonClickCallback: â€œ +<span style="color: #000000;"> ((Button)view).getText(), Toast.LENGTH_SHORT).show();<br>        }<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onLongClickCallback(View view){<br>        </span><span style="color: #0000ff;">if</span>(view <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Button){<br>            Toast.makeText(context, </span>â€œonLongClickCallback: â€œ +<span style="color: #000000;"> ((Button)view).getText(), Toast.LENGTH_SHORT).show();<br>        }<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onItemClickCallback(AdapterView&lt;?&gt; adapterView, View view, <span style="color: #0000ff;">int</span> i, <span style="color: #0000ff;">long</span><span style="color: #000000;"> l) {<br>        Toast.makeText(context, </span>â€œonItemClickCallback: â€œ + ((Map&lt;String, String&gt;)adapterView.getAdapter().getItem(i)).get(â€œtitleâ€<span style="color: #000000;">), Toast.LENGTH_SHORT).show();<br>    }<br><br>    @AIClick({R.id.btn3, R.id.toFragmentBtn})<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClickCallbackForBtn3(View view){<br>        </span><span style="color: #0000ff;">if</span>(view <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Button){<br>            Toast.makeText(context, </span>â€œonClickForBtn3: â€œ +<span style="color: #000000;"> ((Button)view).getText(), Toast.LENGTH_SHORT).show();<br>        }<br><br>        </span><span style="color: #0000ff;">if</span>(view.getId() ==<span style="color: #000000;"> R.id.toFragmentBtn){<br>            startActivity(</span><span style="color: #0000ff;">new</span> Intent(context, SecendActivity.<span style="color: #0000ff;">class</span><span style="color: #000000;">));<br>        }<br><br>    }<br><br>    @AILongClick({R.id.btn3})<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onLongClickCallbackForBtn3(View view){<br>        </span><span style="color: #0000ff;">if</span>(view <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Button){<br>            Toast.makeText(context, </span>â€œonLongClickCallbackForBtn3: â€œ +<span style="color: #000000;"> ((Button)view).getText(), Toast.LENGTH_SHORT).show();<br>        }<br>    }<br><br>    @AIItemClick({R.id.listView})<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onItemClickCallbackForListView(AdapterView&lt;?&gt; adapterView, View view, <span style="color: #0000ff;">int</span> i, <span style="color: #0000ff;">long</span><span style="color: #000000;"> l){<br>        Toast.makeText(context, </span>â€œonItemClickCallbackForListView: â€œ + ((Map&lt;String, String&gt;)adapterView.getAdapter().getItem(i)).get(â€œtitleâ€<span style="color: #000000;">), Toast.LENGTH_SHORT).show();<br>    }<br><br>    @AIItemLongClick(R.id.listView)<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span> onItemLongClickCallbackForListView(AdapterView&lt;?&gt; adapterView, View view, <span style="color: #0000ff;">int</span> i, <span style="color: #0000ff;">long</span><span style="color: #000000;"> l) {<br>        Toast.makeText(context, </span>â€œonItemLongClickCallbackForListView: â€œ + ((Map&lt;String, String&gt;)adapterView.getAdapter().getItem(i)).get(â€œtitleâ€<span style="color: #000000;">), Toast.LENGTH_SHORT).show();<br>        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br>    }<br><br>}</span></pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>Fragmentä¸­ä½¿ç”¨ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('456512ad-1927-42c5-b337-ab7c6067fadc')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_456512ad-1927-42c5-b337-ab7c6067fadc" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.androidinject;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.app.AlarmManager;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.Bundle;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span> android.widget.<em><span style="color: #000000;">;<br></span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span> com.wangjie.androidinject.annotation.annotations.</em><span style="color: #000000;">;<br></span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.annotation.present.AISupportFragment;<br></span><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> com.wangjie.androidinject.model.Person;<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.ArrayList;<br></span><span style="color: #008080;">12</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.HashMap;<br></span><span style="color: #008080;">13</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br></span><span style="color: #008080;">14</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Map;<br></span><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">17</span> <span style="color: #008000;">  Created with IntelliJ IDEA.<br></span><span style="color: #008080;">18</span> <span style="color: #008000;"> <em> Author: wangjie  email:wangjie@cyyun.com<br></em></span><span style="color: #008080;">19</span> <span style="color: #008000;">  Date: 13-12-4<br></span><span style="color: #008080;">20</span> <span style="color: #008000;"> <em> Time: ä¸‹åˆ4:37<br></em></span><span style="color: #008080;">21</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;">22</span> <span style="color: #000000;">@AILayout(R.layout.fragment_a)<br></span><span style="color: #008080;">23</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> FragmentA <span style="color: #0000ff;">extends</span><span style="color: #000000;"> AISupportFragment{<br></span><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span> <span style="color: #000000;">    @AIView<br></span><span style="color: #008080;">26</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Button fragmentABtn1;<br></span><span style="color: #008080;">27</span><br><span style="color: #008080;">28</span> <span style="color: #000000;">    @AIView<br></span><span style="color: #008080;">29</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> GridView fragmentGv;<br></span><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span> <span style="color: #000000;">    @AIBean<br></span><span style="color: #008080;">32</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Person person;<br></span><span style="color: #008080;">33</span><br><span style="color: #008080;">34</span> <span style="color: #000000;">    @AISystemService<br></span><span style="color: #008080;">35</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> AlarmManager alarmManager;<br></span><span style="color: #008080;">36</span><br><span style="color: #008080;">37</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">38</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onActivityCreated(Bundle savedInstanceState) {<br></span><span style="color: #008080;">39</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onActivityCreated(savedInstanceState);<br></span><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span>         List&lt;Map&lt;String, String&gt;&gt; list = <span style="color: #0000ff;">new</span> ArrayList&lt;Map&lt;String, String&gt;&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">42</span>         Map&lt;String, String&gt;<span style="color: #000000;"> map;<br></span><span style="color: #008080;">43</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 0; i &lt; 10; i++<span style="color: #000000;">){<br></span><span style="color: #008080;">44</span>             map = <span style="color: #0000ff;">new</span> HashMap&lt;String, String&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">45</span>             map.put(â€œtitleâ€, â€œfragment<em>item</em>â€œ +<span style="color: #000000;"> i);<br></span><span style="color: #008080;">46</span> <span style="color: #000000;">            list.add(map);<br></span><span style="color: #008080;">47</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">48</span><br><span style="color: #008080;">49</span>         SimpleAdapter adapter = <span style="color: #0000ff;">new</span> SimpleAdapter(context, list, R.layout.list_item, <span style="color: #0000ff;">new</span> String[]{â€œtitleâ€}, <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">int</span><span style="color: #000000;">[]{R.id.list_item_title_tv});<br></span><span style="color: #008080;">50</span> <span style="color: #000000;">        fragmentGv.setAdapter(adapter);<br></span><span style="color: #008080;">51</span><br><span style="color: #008080;">52</span>         person.setName(â€œandroidInjectâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">53</span>         person.setAge(1<span style="color: #000000;">);<br></span><span style="color: #008080;">54</span> <span style="color: #000000;">        System.out.println(person.toString());<br></span><span style="color: #008080;">55</span><br><span style="color: #008080;">56</span>         System.out.println(â€œalarmManager: â€œ +<span style="color: #000000;"> alarmManager);<br></span><span style="color: #008080;">57</span><br><span style="color: #008080;">58</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">59</span><br><span style="color: #008080;">60</span> <span style="color: #000000;">    @AIClick(R.id.fragmentABtn1)<br></span><span style="color: #008080;">61</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> btnOnclick(View view){<br></span><span style="color: #008080;">62</span>         <span style="color: #0000ff;">if</span>(view <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Button){<br></span><span style="color: #008080;">63</span>             Toast.makeText(context, â€œbtnOnclick: â€œ +<span style="color: #000000;"> ((Button)view).getText(), Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">64</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">65</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">66</span><br><span style="color: #008080;">67</span> <span style="color: #000000;">    @AILongClick(R.id.fragmentABtn1)<br></span><span style="color: #008080;">68</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> btnOnLongClick(View view){<br></span><span style="color: #008080;">69</span>         <span style="color: #0000ff;">if</span>(view <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Button){<br></span><span style="color: #008080;">70</span>             Toast.makeText(context, â€œbtnOnLongClick: â€œ +<span style="color: #000000;"> ((Button)view).getText(), Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">71</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">72</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">73</span><br><span style="color: #008080;">74</span> <span style="color: #000000;">    @AIItemClick(R.id.fragmentGv)<br></span><span style="color: #008080;">75</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> gvOnItemClick(AdapterView&lt;?&gt; adapterView, View view, <span style="color: #0000ff;">int</span> i, <span style="color: #0000ff;">long</span><span style="color: #000000;"> l){<br></span><span style="color: #008080;">76</span>         Toast.makeText(context, â€œgvOnItemClick: â€œ + ((Map&lt;String, String&gt;)adapterView.getAdapter().getItem(i)).get(â€œtitleâ€<span style="color: #000000;">), Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">77</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">78</span><br><span style="color: #008080;">79</span> <span style="color: #000000;">    @AIItemLongClick(R.id.fragmentGv)<br></span><span style="color: #008080;">80</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> gvOnItemLongClick(AdapterView&lt;?&gt; adapterView, View view, <span style="color: #0000ff;">int</span> i, <span style="color: #0000ff;">long</span><span style="color: #000000;"> l){<br></span><span style="color: #008080;">81</span>         Toast.makeText(context, â€œgvOnItemLongClick: â€œ + ((Map&lt;String, String&gt;)adapterView.getAdapter().getItem(i)).get(â€œtitleâ€<span style="color: #000000;">), Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">82</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">83</span><br><span style="color: #008080;">84</span><br><span style="color: #008080;">85</span> }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>&nbsp;</p>
<p>å…·ä½“æ³¨è§£å¦‚ä¸‹ï¼š</p>
<p>@AINoTitle: ç±»æ³¨è§£, åªé€‚ç”¨äºActivity(éœ€ç»§æ‰¿äºAIActivity), è®¾ç½®Activityä¸æ˜¾ç¤ºTitle</p>
<p>@AIFullScreen: ç±»æ³¨è§£, åªé€‚ç”¨äºActivity(éœ€ç»§æ‰¿äºAIActivity), è®¾ç½®Activityå…¨å±</p>
<p> @AILayout: ç±»æ³¨è§£<br>            value[int]: ç”¨äºè®¾ç½®è¯¥Activityçš„å¸ƒå±€ â€”- setContentView(resId);</p>
<pre><code>@AIView: å±æ€§æ³¨è§£
    id[int]: ç”¨äºç»‘å®šæ§ä»¶ ---- findViewById(resId);(default identifier[R.id.{field name}] if did not set id)
    clickMethod[String]: ç”¨äºè®¾ç½®æ§ä»¶ç‚¹å‡»äº‹ä»¶çš„å›è°ƒæ–¹æ³•, å¯é€‰, æ–¹æ³•åç§°ä»»æ„, å‚æ•°å¿…é¡»ä¸º(View view)
    longClickMethod[String]: ç”¨äºè®¾ç½®æ§ä»¶é•¿æŒ‰çš„å›è°ƒæ–¹æ³•, å¯é€‰, æ–¹æ³•åä»»æ„, å‚æ•°å¿…é¡»ä¸º(View view)
    itemClickMethod[String]: ç”¨äºè®¾ç½®æ§ä»¶itemç‚¹å‡»çš„å›è°ƒæ–¹æ³•, å¯é€‰, æ–¹æ³•åä»»æ„, å‚æ•°å¿…é¡»ä¸º(AdapterView, View, int, long)
    itemLongClickMethod[String]: ç”¨äºè®¾ç½®æ§ä»¶itemé•¿æŒ‰çš„å›è°ƒæ–¹æ³•, å¯é€‰, æ–¹æ³•åä»»æ„, å‚æ•°å¿…é¡»ä¸º(AdapterView, View, int, long)

@AIBean: å±æ€§æ³¨è§£, ä¸ºè¯¥å±æ€§ç”Ÿæˆä¸€ä¸ªå¯¹è±¡å¹¶æ³¨å…¥, è¯¥å¯¹è±¡å¿…é¡»æœ‰ä¸ªé»˜è®¤çš„ä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•

@AISystemService: å±æ€§æ³¨è§£ï¼Œä¸ºè¯¥å±æ€§æ³¨å…¥ç³»ç»ŸæœåŠ¡å¯¹è±¡

@AIClick: æ–¹æ³•æ³¨è§£
    value[int[], æ‰€è¦ç»‘å®šæ§ä»¶çš„id]: ç”¨äºç»‘å®šæ§ä»¶ç‚¹å‡»äº‹ä»¶çš„å›è°ƒæ–¹æ³•, æ–¹æ³•åç§°ä»»æ„, å‚æ•°å¿…é¡»ä¸º(View view)

@AIItemClick: æ–¹æ³•æ³¨è§£
    value[int[], æ‰€è¦ç»‘å®šæ§ä»¶çš„id]: ç”¨äºç»‘å®šæ§ä»¶itemç‚¹å‡»äº‹ä»¶çš„å›è°ƒæ–¹æ³•, æ–¹æ³•åç§°ä»»æ„, å‚æ•°å¿…é¡»ä¸º(AdapterView, View, int, long)

@AILongClick: æ–¹æ³•æ³¨è§£
    value[int[], æ‰€è¦ç»‘å®šæ§ä»¶çš„id]: ç”¨äºç»‘å®šæ§ä»¶é•¿æŒ‰äº‹ä»¶çš„å›è°ƒæ–¹æ³•, æ–¹æ³•åç§°ä»»æ„, å‚æ•°å¿…é¡»ä¸º(View view)

@AIItemLongClick: æ–¹æ³•æ³¨è§£
    value[int[], æ‰€è¦ç»‘å®šæ§ä»¶çš„id]: ç”¨äºç»‘å®šæ§ä»¶itemé•¿æŒ‰äº‹ä»¶çš„å›è°ƒæ–¹æ³•, æ–¹æ³•åç§°ä»»æ„, å‚æ•°å¿…é¡»ä¸º(AdapterView, View, int, long)
</code></pre><p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> library </tag>
            
            <tag> inject </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ios7 tableviewè¢«navigationbaræŒ¡ä½]]></title>
      <url>/2013/11/08/ios7-tableview%E8%A2%ABnavigationbar%E6%8C%A1%E4%BD%8F/</url>
      <content type="html"><![CDATA[<p><pre class="lang-c prettyprint prettyprinted"><span>ç”¨egoä¸‹æ‹‰åˆ·æ–°çš„æ—¶å€™ï¼Œæ¯æ¬¡åœ¨ios7æ—¶ï¼Œtableviewéƒ½ä¼šä¸Šç§»ã€‚ã€‚ã€‚å¯¼è‡´è¢«navagationbaræŒ¡ä½ã€‚<br>ios6æ˜¯æ­£å¸¸çš„ï¼Œäºæ˜¯åœ¨initçš„æ—¶å€™æ·»åŠ å¦‚ä¸‹ä»£ç ã€‚ã€‚ã€‚</span></pre></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> NSComparisonResult order = [[UIDevice currentDevice].systemVersion compare: <span style="color: #800000;">@â€</span><span style="color: #800000;">7.0</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> options: NSNumericSearch];<br></span><span style="color: #008080;">2</span> <span style="color: #0000ff;">if</span> (order == NSOrderedSame || order ==<span style="color: #000000;"> NSOrderedDescending)<br></span><span style="color: #008080;">3</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">4</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> OS version &gt;= 7.0</span><br><span style="color: #008080;">5</span>     self.edgesForExtendedLayout =<span style="color: #000000;"> UIRectEdgeNone;<br></span><span style="color: #008080;">6</span> }</pre><br></div>

<p>&nbsp;</p>
<p>è½¬è‡ªï¼š<a href="http://www.cnblogs.com/x1957/archive/2013/09/29/3345264.html" target="_blank" rel="noopener">http://www.cnblogs.com/x1957/archive/2013/09/29/3345264.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> iOS </tag>
            
            <tag> TableView </tag>
            
            <tag> NavigationBar </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€iosã€‘ä½¿ç”¨Blockå¯¹POSTå¼‚æ­¥æ“ä½œçš„ç®€å•å°è£…]]></title>
      <url>/2013/11/06/%E3%80%90ios%E3%80%91%E4%BD%BF%E7%94%A8Block%E5%AF%B9POST%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C%E7%9A%84%E7%AE%80%E5%8D%95%E5%B0%81%E8%A3%85/</url>
      <content type="html"><![CDATA[<p>ä¸€èˆ¬æƒ…å†µä¸‹çš„POSTå¼‚æ­¥æ“ä½œéœ€è¦å®ç°ä»¥ä¸‹å‡ æ­¥ï¼š</p>
<p>1. åœ¨controller.hä¸Šå®ç°&lt;NSURLConnectionDataDelegate&gt;åè®®</p>
<p>2. å®ç°åè®®çš„å‡ ä¸ªæ–¹æ³•ï¼Œ</p>
<ul>
<li><p>(<span class="s1">void</span>)connection:(<span class="s2">NSURLConnection</span> <em>)connection didReceiveResponse:(<span class="s2">NSURLResponse</span> </em>)response</p>
</li>
<li><p>(<span class="s1">void</span>)connection:(<span class="s2">NSURLConnection</span> <em>)connection didReceiveData:(<span class="s2">NSData</span> </em>)data</p>
</li>
<li><p>(<span class="s1">void</span>)connectionDidFinishLoading:(<span class="s2">NSURLConnection</span> *)connection</p>
</li>
</ul>
<p>3. ç¼–å†™æ‰§è¡Œpostè¯·æ±‚çš„ä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> NSURL <em>url = [NSURL URLWithString:urlStr]; <span style="color: #008000;">//</span><span style="color: #008000;"> ç”ŸæˆNSURLå¯¹è±¡<br></span><span style="color: #008080;">2</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> ç”ŸæˆRequestè¯·æ±‚å¯¹è±¡ï¼ˆå¹¶è®¾ç½®å®ƒçš„ç¼“å­˜åè®®ã€ç½‘ç»œè¯·æ±‚è¶…æ—¶é…ç½®ï¼‰</span><br><span style="color: #008080;">3</span>     NSMutableURLRequest </em>request = [[NSMutableURLRequest alloc] initWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:<span style="color: #800080;">30</span><span style="color: #000000;">];<br></span><span style="color: #008080;">4</span><br><span style="color: #008080;">5</span>     [request setHTTPBody:[<span style="color: #0000ff;">params</span> dataUsingEncoding:NSUTF8StringEncoding]]; <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®è¯·æ±‚å‚æ•°<br></span><span style="color: #008080;">6</span><br><span style="color: #008080;">7</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> æ‰§è¡Œè¯·æ±‚è¿æ¥</span><br><span style="color: #008080;">8</span>     NSURLConnection *conn = [[NSURLConnection alloc] initWithRequest:request <span style="color: #0000ff;">delegate</span>:executorDelegate];</pre><br></div>

<p>&nbsp;</p>
<p>å¦‚æœcontrolleræœ‰å¾ˆå¤šå¼‚æ­¥æ“ä½œï¼Œå¤„ç†å°±ä¼šå¾ˆéº»çƒ¦ï¼Œè€Œä¸”ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬åªéœ€è¦å¤„ç†å®Œæˆå’Œå¼‚å¸¸ï¼ˆæ¯”å¦‚è¶…æ—¶ï¼‰çš„æ—¶å€™çš„åé¦ˆå³å¯</p>
<p>æ‰€ä»¥ï¼Œæˆ‘éœ€è¦ç¼–å†™ä¸€ä¸ªpostè¯·æ±‚çš„å°è£…ç±»ï¼Œåªè¦ä¼ å…¥è¯·æ±‚çš„urlã€è¯·æ±‚å‚æ•°ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼‰ã€å®Œæˆæ—¶çš„å›è°ƒblock</p>
<p>é¦–å…ˆï¼Œæ–°å»ºç±»ï¼šHttpPostExecutorï¼Œ.hå¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">//</span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">//</span><span style="color: #008000;">  HttpPostExecutor.h<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">//</span><span style="color: #008000;">  HttpTest<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">//</span><br><span style="color: #008080;"> 5</span> <span style="color: #008000;">//</span><span style="color: #008000;">  Created by WANGJIE on 13-11-6.<br></span><span style="color: #008080;"> 6</span> <span style="color: #008000;">//</span><span style="color: #008000;">  Copyright (c) 2013å¹´ WANGJIE. All rights reserved.<br></span><span style="color: #008080;"> 7</span> <span style="color: #008000;">//<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">#import</span> &lt;Foundation/Foundation.h&gt;<br><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">@interface</span> HttpPostExecutor : NSObject&lt;NSURLConnectionDataDelegate&gt;<br><span style="color: #008080;">12</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">13</span>     NSMutableData <em>resultData; <span style="color: #008000;">//</span><span style="color: #008000;"> å­˜æ”¾è¯·æ±‚ç»“æœ</span><br><span style="color: #008080;">14</span>     <span style="color: #0000ff;">void</span> (^finishCallbackBlock)(NSString </em>); <span style="color: #008000;">//</span><span style="color: #008000;"> æ‰§è¡Œå®Œæˆåå›è°ƒçš„block</span><br><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">17</span> @property NSMutableData <em><span style="color: #000000;">resultData;<br></span><span style="color: #008080;">18</span> @property(strong) <span style="color: #0000ff;">void</span> (^finishCallbackBlock)(NSString </em><span style="color: #000000;">);<br></span><span style="color: #008080;">19</span><br><span style="color: #008080;">20</span> + (<span style="color: #0000ff;">void</span>)postExecuteWithUrlStr:(NSString <em>)urlStr Paramters:(NSString </em>)<span style="color: #0000ff;">params</span> FinishCallbackBlock:(<span style="color: #0000ff;">void</span> (^)(NSString *<span style="color: #000000;">))block;<br></span><span style="color: #008080;">21</span><br><span style="color: #008080;">22</span> <span style="color: #0000ff;">@end</span></pre><br></div>

<p>&nbsp;</p>
<p>å®ç°äº†&lt;NSURLConnectionDataDelegate&gt;åè®®ï¼Œå› ä¸ºå®ƒè¦æ¥æ”¶postè¯·æ±‚çš„å‡ ä¸ªå›è°ƒã€‚</p>
<p>æœ‰ä¸€ä¸ªNSMutableDataå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ç”¨äºå‚¨å­˜è¯·æ±‚çš„ç»“æœã€‚</p>
<p>ä¸€ä¸ªfinishCallbackBlockçš„blockï¼Œè¿™ä¸ªblockç”¨äºæ‰§è¡Œå®Œæˆåçš„å›è°ƒï¼Œè¿™ä¸ªblockä¼ å…¥çš„å‚æ•°å°±æ˜¯è¿”å›çš„ç»“æœï¼ˆè¿™ä¸ªç»“æœå·²è½¬æˆutf-8ç¼–ç çš„å­—ç¬¦ä¸²å½¢å¼ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªblockä¸­å»å¤„ç†è¯·æ±‚å®Œæˆåçš„é€»è¾‘</p>
<p>è¿˜æœ‰ä¸€ä¸ªç±»æ–¹æ³•ï¼Œè¿™ä¸ªç±»æ–¹æ³•æš´éœ²ç»™å¤–é¢ï¼Œè®©å¤–é¢è¿›è¡Œè°ƒç”¨</p>
<p>&nbsp;</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸‹å®ç°çš„æ–¹æ³•.mæ–‡ä»¶ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('5746940f-c0f2-458d-b9ae-6f828341562c')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_5746940f-c0f2-458d-b9ae-6f828341562c" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #008000;">//</span><br><span style="color: #008080;">  2</span> <span style="color: #008000;">//</span><span style="color: #008000;">  POSTå¼‚æ­¥è¯·æ±‚çš„å°è£…<br></span><span style="color: #008080;">  3</span> <span style="color: #008000;">//</span><span style="color: #008000;">  ä½¿ç”¨æ–¹æ³•ï¼Œåªéœ€ä¼ å…¥urlï¼Œå‚æ•°ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œæ‰§è¡Œå®Œæˆåçš„å›è°ƒblock<br></span><span style="color: #008080;">  4</span> <span style="color: #008000;">//</span><span style="color: #008000;">  å¦‚ä¸‹ï¼š<br></span><span style="color: #008080;">  5</span> <span style="color: #008000;">//</span><span style="color: #008000;">  [HttpPostExecutor postExecuteWithUrlStr:@â€</span><span style="color: #008000; text-decoration: underline;"><a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a></span><span style="color: #008000;">â€œ<br></span><span style="color: #008080;">  6</span> <span style="color: #008000;">//</span><span style="color: #008000;">                              Paramters:@â€â€<br></span><span style="color: #008080;">  7</span> <span style="color: #008000;">//</span><span style="color: #008000;">                    FinishCallbackBlock:^(NSString <em>result){  </em></span><span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®æ‰§è¡Œå®Œæˆçš„å›è°ƒblock<br></span><span style="color: #008080;">  8</span> <span style="color: #008000;">//</span><span style="color: #008000;">                        NSLog(@â€finish callback block, result: %@â€, result);<br></span><span style="color: #008080;">  9</span> <span style="color: #008000;">//</span><span style="color: #008000;">                    }];<br></span><span style="color: #008080;"> 10</span> <span style="color: #008000;">//</span><span style="color: #008000;">  postæäº¤çš„å‚æ•°ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š<br></span><span style="color: #008080;"> 11</span> <span style="color: #008000;">//</span><span style="color: #008000;">  å‚æ•°1åå­—=å‚æ•°1æ•°æ®&amp;å‚æ•°2åå­—ï¼å‚æ•°2æ•°æ®&amp;å‚æ•°3åå­—ï¼å‚æ•°3æ•°æ®&amp;â€¦<br></span><span style="color: #008080;"> 12</span> <span style="color: #008000;">//</span><br><span style="color: #008080;"> 13</span> <span style="color: #008000;">//</span><br><span style="color: #008080;"> 14</span> <span style="color: #008000;">//</span><span style="color: #008000;">  HttpPostExecutor.m<br></span><span style="color: #008080;"> 15</span> <span style="color: #008000;">//</span><span style="color: #008000;">  HttpTest<br></span><span style="color: #008080;"> 16</span> <span style="color: #008000;">//</span><br><span style="color: #008080;"> 17</span> <span style="color: #008000;">//</span><span style="color: #008000;">  Created by WANGJIE on 13-11-6.<br></span><span style="color: #008080;"> 18</span> <span style="color: #008000;">//</span><span style="color: #008000;">  Copyright (c) 2013å¹´ WANGJIE. All rights reserved.<br></span><span style="color: #008080;"> 19</span> <span style="color: #008000;">//<br></span><span style="color: #008080;"> 20</span><br><span style="color: #008080;"> 21</span> <span style="color: #0000ff;">#import</span> <span style="color: #800000;">â€œ</span><span style="color: #800000;">HttpPostExecutor.h</span><span style="color: #800000;">â€œ</span><br><span style="color: #008080;"> 22</span><br><span style="color: #008080;"> 23</span> <span style="color: #0000ff;">@implementation</span><span style="color: #000000;"> HttpPostExecutor<br></span><span style="color: #008080;"> 24</span> <span style="color: #0000ff;">@synthesize</span><span style="color: #000000;"> resultData, finishCallbackBlock;<br></span><span style="color: #008080;"> 25</span><br><span style="color: #008080;"> 26</span> <span style="color: #008000;">/</span><span style="color: #008000;"><em><br></em></span><span style="color: #008080;"> 27</span> <span style="color: #008000;">  æ‰§è¡ŒPOSTè¯·æ±‚<br></span><span style="color: #008080;"> 28</span>  <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 29</span> + (<span style="color: #0000ff;">void</span>)postExecuteWithUrlStr:(NSString )urlStr Paramters:(NSString <em>)<span style="color: #0000ff;">params</span> FinishCallbackBlock:(<span style="color: #0000ff;">void</span> (^)(NSString </em><span style="color: #000000;">))block<br></span><span style="color: #008080;"> 30</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 31</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> ç”Ÿæˆä¸€ä¸ªpostè¯·æ±‚å›è°ƒå§”æ‰˜å¯¹è±¡ï¼ˆå®ç°äº†&lt;NSURLConnectionDataDelegate&gt;åè®®ï¼‰</span><br><span style="color: #008080;"> 32</span>     HttpPostExecutor <em>executorDelegate =<span style="color: #000000;"> [[HttpPostExecutor alloc] init];<br></span><span style="color: #008080;"> 33</span>     executorDelegate.finishCallbackBlock = block; <span style="color: #008000;">//</span><span style="color: #008000;"> ç»‘å®šæ‰§è¡Œå®Œæˆæ—¶çš„block</span><br><span style="color: #008080;"> 34</span><br><span style="color: #008080;"> 35</span><br><span style="color: #008080;"> 36</span>     NSURL </em>url = [NSURL URLWithString:urlStr]; <span style="color: #008000;">//</span><span style="color: #008000;"> ç”ŸæˆNSURLå¯¹è±¡<br></span><span style="color: #008080;"> 37</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> ç”ŸæˆRequestè¯·æ±‚å¯¹è±¡ï¼ˆå¹¶è®¾ç½®å®ƒçš„ç¼“å­˜åè®®ã€ç½‘ç»œè¯·æ±‚è¶…æ—¶é…ç½®ï¼‰</span><br><span style="color: #008080;"> 38</span>     NSMutableURLRequest <em>request = [[NSMutableURLRequest alloc] initWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:<span style="color: #800080;">30</span><span style="color: #000000;">];<br></span><span style="color: #008080;"> 39</span><br><span style="color: #008080;"> 40</span>     [request setHTTPBody:[<span style="color: #0000ff;">params</span> dataUsingEncoding:NSUTF8StringEncoding]]; <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®è¯·æ±‚å‚æ•°<br></span><span style="color: #008080;"> 41</span><br><span style="color: #008080;"> 42</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> æ‰§è¡Œè¯·æ±‚è¿æ¥</span><br><span style="color: #008080;"> 43</span>     NSURLConnection </em>conn = [[NSURLConnection alloc] initWithRequest:request <span style="color: #0000ff;">delegate</span><span style="color: #000000;">:executorDelegate];<br></span><span style="color: #008080;"> 44</span><br><span style="color: #008080;"> 45</span>     NSLog(conn ? <span style="color: #800000;">@â€</span><span style="color: #800000;">è¿æ¥åˆ›å»ºæˆåŠŸ</span><span style="color: #800000;">â€œ</span> : <span style="color: #800000;">@â€</span><span style="color: #800000;">è¿æ¥åˆ›å»ºå¤±è´¥</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 46</span><br><span style="color: #008080;"> 47</span> <span style="color: #000000;">}<br></span><span style="color: #008080;"> 48</span><br><span style="color: #008080;"> 49</span><br><span style="color: #008080;"> 50</span> <span style="color: #008000;">/<em></em></span><span style="color: #008000;"><br></span><span style="color: #008080;"> 51</span> <span style="color: #008000;"> <em> æ¥æ”¶åˆ°æœåŠ¡å™¨å›åº”çš„æ—¶å›è°ƒ<br></em></span><span style="color: #008080;"> 52</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 53</span> - (<span style="color: #0000ff;">void</span>)connection:(NSURLConnection <em>)connection didReceiveResponse:(NSURLResponse </em><span style="color: #000000;">)response<br></span><span style="color: #008080;"> 54</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 55</span>     NSHTTPURLResponse <em>resp = (NSHTTPURLResponse </em><span style="color: #000000;">)response;<br></span><span style="color: #008080;"> 56</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> åˆå§‹åŒ–NSMutableDataå¯¹è±¡ï¼ˆç”¨äºä¿å­˜æ‰§è¡Œç»“æœï¼‰</span><br><span style="color: #008080;"> 57</span>     <span style="color: #0000ff;">if</span>(!<span style="color: #000000;">resultData){<br></span><span style="color: #008080;"> 58</span>         resultData =<span style="color: #000000;"> [[NSMutableData alloc] init];<br></span><span style="color: #008080;"> 59</span>     }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;"> 60</span>         [resultData setLength:<span style="color: #800080;">0</span><span style="color: #000000;">];<br></span><span style="color: #008080;"> 61</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 62</span><br><span style="color: #008080;"> 63</span>     <span style="color: #0000ff;">if</span><span style="color: #000000;"> ([response respondsToSelector:@selector(allHeaderFields)]) {<br></span><span style="color: #008080;"> 64</span><br><span style="color: #008080;"> 65</span>         NSDictionary <em>dictionary =<span style="color: #000000;"> [resp allHeaderFields];<br></span><span style="color: #008080;"> 66</span><br><span style="color: #008080;"> 67</span>         NSLog(<span style="color: #800000;">@â€</span><span style="color: #800000;">[network]allHeaderFields:%@</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">,[dictionary description]);<br></span><span style="color: #008080;"> 68</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 69</span><br><span style="color: #008080;"> 70</span> <span style="color: #000000;">}<br></span><span style="color: #008080;"> 71</span> <span style="color: #008000;">/</span></em><span style="color: #008000;"><em><br></em></span><span style="color: #008080;"> 72</span> <span style="color: #008000;">  æ¥æ”¶åˆ°æœåŠ¡å™¨ä¼ è¾“æ•°æ®çš„æ—¶å€™è°ƒç”¨ï¼Œæ­¤æ–¹æ³•æ ¹æ®æ•°æ®å¤§å°æ‰§è¡Œè‹¥å¹²æ¬¡<br></span><span style="color: #008080;"> 73</span>  <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 74</span> - (<span style="color: #0000ff;">void</span>)connection:(NSURLConnection )connection didReceiveData:(NSData <em><span style="color: #000000;">)data<br></span><span style="color: #008080;"> 75</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 76</span>     [resultData appendData:data]; <span style="color: #008000;">//</span><span style="color: #008000;"> è¿½åŠ ç»“æœ</span><br><span style="color: #008080;"> 77</span> <span style="color: #000000;">}<br></span><span style="color: #008080;"> 78</span> <span style="color: #008000;">/</span></em><span style="color: #008000;"><em><br></em></span><span style="color: #008080;"> 79</span> <span style="color: #008000;">  æ•°æ®ä¼ å®Œä¹‹åè°ƒç”¨æ­¤æ–¹æ³•<br></span><span style="color: #008080;"> 80</span>  <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 81</span> - (<span style="color: #0000ff;">void</span>)connectionDidFinishLoading:(NSURLConnection <span style="color: #000000;">)connection<br></span><span style="color: #008080;"> 82</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 83</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> æŠŠè¯·æ±‚ç»“æœä»¥UTF-8ç¼–ç è½¬æ¢æˆå­—ç¬¦ä¸²</span><br><span style="color: #008080;"> 84</span>     NSString <em>resultStr =<span style="color: #000000;"> [[NSString alloc] initWithData:[self resultData] encoding:NSUTF8StringEncoding];<br></span><span style="color: #008080;"> 85</span><br><span style="color: #008080;"> 86</span>     <span style="color: #0000ff;">if</span> (finishCallbackBlock) { <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœè®¾ç½®äº†å›è°ƒçš„blockï¼Œç›´æ¥è°ƒç”¨</span><br><span style="color: #008080;"> 87</span> <span style="color: #000000;">        finishCallbackBlock(resultStr);<br></span><span style="color: #008080;"> 88</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 89</span><br><span style="color: #008080;"> 90</span><br><span style="color: #008080;"> 91</span> <span style="color: #000000;">}<br></span><span style="color: #008080;"> 92</span> <span style="color: #008000;">/</span></em><span style="color: #008000;"><em><br></em></span><span style="color: #008080;"> 93</span> <span style="color: #008000;">  ç½‘ç»œè¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œå‡ºç°ä»»ä½•é”™è¯¯ï¼ˆæ–­ç½‘ï¼Œè¿æ¥è¶…æ—¶ç­‰ï¼‰ä¼šè¿›å…¥æ­¤æ–¹æ³•<br></span><span style="color: #008080;"> 94</span>  <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 95</span> - (<span style="color: #0000ff;">void</span>)connection:(NSURLConnection )connection didFailWithError:(NSError *<span style="color: #000000;">)error<br></span><span style="color: #008080;"> 96</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 97</span>     NSLog(<span style="color: #800000;">@â€</span><span style="color: #800000;">network error: %@</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">, [error localizedDescription]);<br></span><span style="color: #008080;"> 98</span><br><span style="color: #008080;"> 99</span>     <span style="color: #0000ff;">if</span> (finishCallbackBlock) { <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœè®¾ç½®äº†å›è°ƒçš„blockï¼Œç›´æ¥è°ƒç”¨</span><br><span style="color: #008080;">100</span> <span style="color: #000000;">        finishCallbackBlock(nil);<br></span><span style="color: #008080;">101</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">102</span><br><span style="color: #008080;">103</span><br><span style="color: #008080;">104</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">105</span> <span style="color: #0000ff;">@end</span></pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>åœ¨è¿™ä¸ªå®ç°ç±»ä¸­ï¼Œæˆ‘ä»¬åœ¨ç±»æ–¹æ³•ä¸­ï¼Œå…ˆç”Ÿæˆä¸€ä¸ªHttpPostExecutorå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ç”¨äºpostè¯·æ±‚çš„å›è°ƒï¼ˆå› ä¸ºå®ç°äº†&lt;NSURLConnectionDataDelegate&gt;åè®®ï¼‰ï¼Œç„¶åå»æ‰§è¡Œpostè¿æ¥ã€‚</p>
<p>æ¥ä¸‹æ¥å°±ç­‰ä¸‹é¢å®ç°çš„å›è°ƒæ–¹æ³•è¢«è‡ªåŠ¨è°ƒç”¨äº†ï¼Œä¸€æ—¦è°ƒç”¨</p>
<ul>
<li>(<span class="s1">void</span>)connection:(<span class="s2">NSURLConnection</span> <em>)connection didReceiveResponse:(<span class="s2">NSURLResponse</span> </em>)response</li>
</ul>
<p>è¿™ä¸ªæ–¹æ³•ï¼Œå°±å¯¹resultDataï¼ˆç”¨äºå­˜å‚¨postè¯·æ±‚ç»“æœï¼‰è¿›è¡Œåˆå§‹åŒ–æˆ–è€…æ¸…ç©ºï¼Œå› ä¸ºè¦å¼€å§‹çœŸæ­£å­˜å‚¨æ•°æ®äº†å˜›ï¼›</p>
<p>&nbsp;</p>
<ul>
<li>(<span class="s1">void</span>)connection:(<span class="s2">NSURLConnection</span> <em>)connection didReceiveData:(<span class="s2">NSData</span> </em>)data</li>
</ul>
<p>è¿™ä¸ªæ–¹æ³•è¿›è¡Œå›è°ƒçš„æ—¶å€™ï¼ŒæŠŠè¿”å›è¿‡æ¥çš„è¿™éƒ¨åˆ†æ•°æ®å­˜å‚¨åˆ°resultDataä¸­ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼›</p>
<p>&nbsp;</p>
<p>ä¸€æ—¦å›è°ƒ- (<span class="s1">void</span>)connectionDidFinishLoading:(<span class="s2">NSURLConnection</span> *)connectionè¿™ä¸ªæ–¹æ³•ï¼Œè¯´æ˜æ•°æ®ä¼ è¾“å®Œæ¯•äº†ï¼Œè¦åšçš„é€»è¾‘å°±æ˜¯æŠŠæ•°æ®è½¬æˆutf-8ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œç„¶åå›è°ƒæˆ‘ä»¬è®¾ç½®çš„å›è°ƒfinishCallbackBlockï¼ŒæŠŠè½¬å¥½çš„ç»“æœå­—ç¬¦ä¸²ä¼ è¿›å»ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨å›è°ƒblockæ–¹æ³•ä¸­å®ç°çš„é€»è¾‘å°±èƒ½æ­£å¸¸æ‰§è¡Œäº†ã€‚</p>
<p>&nbsp;</p>
<p>ä¸€æ—¦å›è°ƒ- (<span class="s1">void</span>)connection:(<span class="s2">NSURLConnection</span> <em>)connection didFailWithError:(<span class="s2">NSError</span> </em>)errorè¿™ä¸ªæ–¹æ³•ï¼Œè¯´æ˜è¯·æ±‚è¿‡ç¨‹ä¸­å‡ºé”™äº†ï¼Œæ¯”å¦‚æ–­ç”µã€è¶…æ—¶ç­‰ï¼Œè¿™æ—¶å€™ï¼Œä¹Ÿå›è°ƒæˆ‘ä»¬è®¾ç½®çš„å›è°ƒfinishCallbackBlockï¼Œnilä½œä¸ºç»“æœï¼Œè¿™æ ·æˆ‘ä»¬åœ¨finishCallbackBlockä¸­å°±èƒ½åˆ¤æ–­æ˜¯æ­£å¸¸çš„æ‰§è¡Œäº†postè¿˜æ˜¯å‡ºäº†é—®é¢˜ã€‚</p>
<p>&nbsp;</p>
<p>å¥½äº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å¤–é¢å»è°ƒç”¨äº†ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> [HttpPostExecutor postExecuteWithUrlStr:<span style="color: #800000;">@â€</span><span style="color: #800000;"><a href="http://www.baidu.com" target="_blank" rel="noopener">http://www.baidu.com</a></span><span style="color: #800000;">â€œ</span><br><span style="color: #008080;">2</span>                                   Paramters:<span style="color: #800000;">@â€â€</span><br><span style="color: #008080;">3</span>                         FinishCallbackBlock:^(NSString *<span style="color: #000000;">result){<br></span><span style="color: #008080;">4</span>                             <span style="color: #008000;">//</span><span style="color: #008000;"> æ‰§è¡Œpostè¯·æ±‚å®Œæˆåçš„é€»è¾‘</span><br><span style="color: #008080;">5</span>                             NSLog(<span style="color: #800000;">@â€</span><span style="color: #800000;">finish callback block, result: %@</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">, result);<br></span><span style="color: #008080;">6</span>                         }];</pre><br></div>

<p>è¿™æ ·ï¼Œä»¥åpostè¯·æ±‚åªéœ€è¦å»è°ƒç”¨ä¸Šé¢è¿™ä¸ªæ–¹æ³•ï¼Œåœ¨å›è°ƒblockä¸­å»å¤„ç†ç»“æœ</p>
<p>ä¹‹åï¼Œåœ¨æˆ‘ä»¬çš„ä»£ç ç¼–å†™ä¸­ï¼Œå°±å¯ä»¥åªå…³å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œä¸éœ€è¦å»åœ¨æ„è¯·æ±‚åè®®å’Œå›è°ƒäº†</p>
<p>&nbsp;</p>
<p><span style="color: #800000; font-size: 16px;"><strong><a href="http://pan.baidu.com/s/1uxVGh" target="_blank" rel="noopener"><span style="color: #800000;">æµ‹è¯•demoä¸‹è½½</span></a></strong></span></p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> iOS </tag>
            
            <tag> block </tag>
            
            <tag> post </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€IOSã€‘iosä¸­NSUserDefaultä¸androidä¸­çš„SharedPreferenceç”¨æ³•ç®€å•å¯¹æ¯”]]></title>
      <url>/2013/11/03/%E3%80%90IOS%E3%80%91ios%E4%B8%ADNSUserDefault%E4%B8%8Eandroid%E4%B8%AD%E7%9A%84SharedPreference%E7%94%A8%E6%B3%95%E7%AE%80%E5%8D%95%E5%AF%B9%E6%AF%94/</url>
      <content type="html"><![CDATA[<p>æœ‰Androidå¼€å‘ç»éªŒçš„æœ‹å‹å¯¹SharedPreferenceçš„ç”¨æ³•åº”è¯¥æ¯”è¾ƒäº²åˆ‡çš„å§ï¼Œå®ƒä¸€èˆ¬ç”¨æ¥ä¿å­˜å’Œè¯»å–ç”¨æˆ·çš„è®¾ç½®å‚æ•°ï¼Œæ¯”å¦‚ä¿å­˜ç”¨æˆ·åã€åŠ å¯†åçš„ç™»å½•å¯†ç ï¼Œæ˜¯å¦é€‰æ‹©äº†è‡ªåŠ¨ç™»å½•ï¼Œåº”ç”¨é€‰æ‹©äº†å“ªä¸€å¥—ä¸»é¢˜çš®è‚¤ç­‰ç”¨æˆ·é…ç½®ä¿¡æ¯ï¼Œä½¿ç”¨ä¹Ÿéå¸¸ç®€å•ï¼Œput/getå°±èƒ½ä¿å­˜/è¯»å–è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨xmlå½¢å¼ä¿å­˜åœ¨åº”ç”¨çš„ç›®å½•ä¸‹é¢</p>
<p>åœ¨iosä¸­ï¼Œä¹Ÿæœ‰è¿™ä¹ˆä¸€ä¸ªç±»ä¼¼çš„å·¥å…·&mdash;&mdash;NSUserDefaultï¼Œå®ƒæ”¯æŒçš„æ•°æ®æ ¼å¼æœ‰ï¼šNSNumberï¼ˆIntegerã€Floatã€Doubleï¼‰ï¼ŒNSStringï¼ŒNSDateï¼ŒNSArrayï¼ŒNSDictionaryï¼ŒBOOLç±»å‹ã€‚å®ƒæ˜¯å­˜å‚¨åœ¨/Library/Preferecesé‡Œé¢ï¼Œæœ‰ä¸ªplistæ–‡ä»¶ã€‚</p>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªdemoæ¥æµ‹è¯•ä¸‹ï¼š</p>
<p>ç•Œé¢å¾ˆç®€å•ï¼Œä¸¤ä¸ªbuttonï¼Œä¸€ä¸ªlabel</p>
<p>ç‚¹å‡»ç¬¬ä¸€ä¸ªbuttonç”¨æ¥ä¿å­˜æ•°æ®ï¼Œç‚¹å‡»ç¬¬äºŒä¸ªbuttonç”¨æ¥æ˜¾ç¤ºæ•°æ®åˆ°label</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> - (IBAction)buttonClicked:(<span style="color: #0000ff;">id</span><span style="color: #000000;">)sender {<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">switch</span><span style="color: #000000;"> ([sender tag]) {<br></span><span style="color: #008080;"> 3</span>         <span style="color: #0000ff;">case</span> <span style="color: #800080;">1</span>: <span style="color: #008000;">//</span><span style="color: #008000;"> ä¿å­˜æ•°æ®</span><br><span style="color: #008080;"> 4</span> <span style="color: #000000;">            [self saveData];<br></span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 6</span>         <span style="color: #0000ff;">case</span> <span style="color: #800080;">2</span>: <span style="color: #008000;">//</span><span style="color: #008000;"> æ˜¾ç¤ºæ•°æ®</span><br><span style="color: #008080;"> 7</span> <span style="color: #000000;">            [self showData];<br></span><span style="color: #008080;"> 8</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span>         <span style="color: #0000ff;">default</span><span style="color: #000000;">:<br></span><span style="color: #008080;">11</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span> - (<span style="color: #0000ff;">void</span><span style="color: #000000;">)saveData<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">18</span>     NSUserDefaults <em>userDef =<span style="color: #000000;"> [NSUserDefaults standardUserDefaults];<br></span><span style="color: #008080;">19</span><br><span style="color: #008080;">20</span>     [userDef setObject:<span style="color: #800000;">@â€</span><span style="color: #800000;">wangjie</span><span style="color: #800000;">â€œ</span> forKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">name</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">];<br></span><span style="color: #008080;">21</span>     [userDef setInteger:<span style="color: #800080;">23</span> forKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">age</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">];<br></span><span style="color: #008080;">22</span>     [userDef setBool:YES forKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">isAutoLogin</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">];<br></span><span style="color: #008080;">23</span>     [userDef setDouble:<span style="color: #800080;">115.0</span> forKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">weight</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">];<br></span><span style="color: #008080;">24</span>     [userDef setFloat:<span style="color: #800080;">171.2</span> forKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">height</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">];<br></span><span style="color: #008080;">25</span><br><span style="color: #008080;">26</span> <span style="color: #000000;">    [userDef synchronize];<br></span><span style="color: #008080;">27</span>     NSLog(<span style="color: #800000;">@â€</span><span style="color: #800000;">save success!</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">);<br></span><span style="color: #008080;">28</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">29</span><br><span style="color: #008080;">30</span> - (<span style="color: #0000ff;">void</span><span style="color: #000000;">)showData<br></span><span style="color: #008080;">31</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">32</span>     NSUserDefaults </em>userDef =<span style="color: #000000;"> [NSUserDefaults standardUserDefaults];<br></span><span style="color: #008080;">33</span>     NSString *content = [NSString stringWithFormat:<span style="color: #800000;">@â€</span><span style="color: #800000;">name: %@; age: %d; isAutoLogin: %hhd; weight: %f; height: %f</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">,<br></span><span style="color: #008080;">34</span>                          [userDef stringForKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">name</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">],<br></span><span style="color: #008080;">35</span>                          [userDef integerForKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">age</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">],<br></span><span style="color: #008080;">36</span>                          [userDef boolForKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">isAutoLogin</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">],<br></span><span style="color: #008080;">37</span>                          [userDef doubleForKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">weight</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">],<br></span><span style="color: #008080;">38</span>                          [userDef floatForKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">height</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">]<br></span><span style="color: #008080;">39</span> <span style="color: #000000;">                         ];<br></span><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span> <span style="color: #000000;">    [[self showLb] setText:content];<br></span><span style="color: #008080;">42</span>     NSLog(<span style="color: #800000;">@â€</span><span style="color: #800000;">%@</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">, [[self showLb] text]);<br></span><span style="color: #008080;">43</span> }</pre><br></div>

<p>ä¸€ï¼šå¯åŠ¨åº”ç”¨ç¨‹åºåç›´æ¥ç‚¹å‡»ç¬¬äºŒä¸ªbuttonï¼Œå› ä¸ºæ•°æ®ä¹‹å‰æ²¡æœ‰è¢«ä¿å­˜ï¼Œæ‰€ä»¥æ˜¾ç¤ºçš„æ•°æ®éƒ½æ˜¯é»˜è®¤çš„æ•°æ®ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201311/03193439-fb31db723c6f47598890193e5f312773.png" alt=""></p>
<p>äºŒï¼šç‚¹å‡»ç¬¬ä¸€ä¸ªbuttonï¼ˆæ•°æ®ä¼šè¢«æ’å…¥ï¼‰ï¼Œå†ç‚¹å‡»ç¬¬äºŒä¸ªbuttonï¼ˆå·²æœ‰æ•°æ®å¯ä»¥æ˜¾ç¤ºï¼‰ï¼Œæ­¤æ—¶æƒ…å†µå¦‚ä¸‹ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201311/03193549-8ad8294a8e8b46d49770631d4937e47f.png" alt=""></p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> iOS </tag>
            
            <tag> NSUserDefault </tag>
            
            <tag> SharedPreference </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ã€IOSã€‘ä»androidè§’åº¦æ¥å®ç°(ç†è§£)IOSçš„UITableView]]></title>
      <url>/2013/11/02/%E3%80%90IOS%E3%80%91%E4%BB%8Eandroid%E8%A7%92%E5%BA%A6%E6%9D%A5%E5%AE%9E%E7%8E%B0-%E7%90%86%E8%A7%A3-IOS%E7%9A%84UITableView/</url>
      <content type="html"><![CDATA[<p>æœ¬äººä»åœ¨å­¦æ ¡å¼€å§‹åˆ°ç°åœ¨ä¸Šç­ï¼ˆ13å¹´æ¯•ä¸šï¼‰ä¸€ç›´åšwebå’Œandroidæ–¹é¢çš„å¼€å‘ï¼Œæœ€è¿‘æ‰å¼€å­¦ä¹ åŠiosçš„å¼€å‘ï¼Œæ‰€ä»¥ioså­¦ä¹ ä¸­æœ‰ä¸å½“ä¹‹å¤„ï¼Œè¯·å¤§å®¶ç•™è¨€æŒ‡ç‚¹</p>
<p>ä»¥å‰ä»æ¥æ²¡æœ‰æ¥è§¦è¿‡Objective-Cè¿™é—¨è¯­è¨€ï¼Œä¸è¿‡æˆ‘æƒ³é¢å‘å¯¹è±¡ç¼–ç¨‹åº”è¯¥å¤§ä½“æ€æƒ³éƒ½å·®ä¸å¤š</p>
<p>åœ¨iosä¸­çš„UITableViewå­¦ä¹ ä¸­ï¼Œå¼€å‘è¿‡androidçš„æœ‹å‹åº”è¯¥é©¬ä¸Šä¼šè”æƒ³åˆ°ListViewå’ŒGridViewè¿™ä¸¤ä¸ªæ§ä»¶ï¼Œæ¥ä¸‹æ¥ä»¥ListViewä¸ºä¾‹å­ï¼Œè·ŸUITableViewåšä¸ªå¯¹æ¯”ï¼Œçœ‹çœ‹å®ƒä»¬å®ç°çš„æ–¹å¼æœ‰ä»€ä¹ˆç›¸åŒä¹‹å¤„ã€‚æ€ä¹ˆæ ·èƒ½è®©æœ‰androidå¼€å‘ç»éªŒçš„æœ‹å‹ï¼Œé©¬ä¸ŠæŒæ¡UITableViewè¿™ä¸ªæ§ä»¶</p>
<p>å…ˆæ–°å»ºä¸€ä¸ªdemoï¼Œå–åTabViewTestï¼ˆåŸè°…æˆ‘å§- -ï¼Œæœ¬æ¥è¦å–åTableViewTestï¼Œè°çŸ¥è„‘æŠ½æ–°å»ºé¡¹ç›®çš„æ—¶å€™å†™é”™äº†ï¼Œè¯¶ã€‚ã€‚ã€‚ç®—äº†ï¼Œå°†é”™å°±é”™å§- -ï¼‰</p>
<p><img src="http://images.cnitblog.com/blog/378300/201311/02004946-2ab5264ce0bc47dfb40b97a3911a7079.png" alt=""></p>
<p>iosæ²¡æœ‰å‘½åç©ºé—´çš„æ¦‚å¿µï¼Œæ²¡æœ‰åŒ…æ¦‚å¿µï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆiosä¸­çš„ç±»éƒ½æœ‰å‰ç¼€çš„åŸå› ï¼Œæ¯”å¦‚NSç­‰ï¼‰ï¼Œæ‰€ä»¥ä¸Šé¢åƒ&ldquo;åŒ…&rdquo;ä¸€æ ·çš„æ–‡ä»¶å¤¹éƒ½æ˜¯æˆ‘è‡ªå·±æ–°å»ºçš„&ldquo;group&rdquo;ï¼Œåªæ˜¯ä¸ºäº†çœ‹èµ·æ¥æ¯”è¾ƒæœ‰åˆ†å±‚çš„æ¦‚å¿µè€Œå·²ï¼Œæ‰“å¼€finderï¼Œåˆ°é¡¹ç›®æ–‡ä»¶é‡Œä¸€çœ‹å¦‚ä¸‹å›¾ï¼Œå¦ˆå‘€- -ï¼Œæ‰€æœ‰çš„ç±»éƒ½æŒ¤åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹é‡Œé¢ã€‚ã€‚ã€‚è¿™æ˜¯æˆ‘è§‰å¾—è›‹ç–¼çš„åœ°æ–¹ä¹‹ä¸€-ã€‚-</p>
<p><img src="http://images.cnitblog.com/blog/378300/201311/02005325-69347d3e30f24d08bfe4d313ca0895f0.png" alt=""></p>
<p>&nbsp;</p>
<p>å†å›æ¥çœ‹çœ‹æˆ‘ä»¬é¡¹ç›®ç»“æ„ï¼Œæˆ‘åˆ†çš„å‡ ä¸ªgroupï¼Œå¦‚æœæˆ‘æŠŠcontrollerè¿™ä¸ªgroupçš„åå­—æ”¹æˆ&ldquo;activity&rdquo;ï¼Œandroidå¼€å‘è€…è‚¯å®šæœ‰ç§ä¼¼æ›¾ç›¸è¯†çš„æ„Ÿè§‰äº†ï¼š</p>
<p>controllerï¼šæ§åˆ¶å±‚groupï¼Œç›¸å½“äºandroidä¸­çš„activity</p>
<p>layoutï¼šå¸ƒå±€groupï¼Œç›¸å½“äºandroidä¸­resç›®å½•ä¸‹çš„layoutï¼ˆxmlå¸ƒå±€æ–‡ä»¶ï¼‰</p>
<p>modelï¼šè¿™ä¸ªä¸ç”¨è¯´å°±çŸ¥é“æ”¾äº†ä»€ä¹ˆä¸œè¥¿äº†ï¼Œç»å…¸çš„Personè¿™ä¸ªæµ‹è¯•ç”¨çš„æ•°æ®ç»“æ„</p>
<p>adapterï¼šä¸ºäº†è¿˜å¿µandroidä¸­çš„é€‚é…å™¨ï¼Œç„¶åæˆ‘å°±å–äº†è¿™ä¹ˆä¸ªgroupåå­—</p>
<p>&nbsp;</p>
<p>å¥½äº†ï¼Œç°åœ¨æ­£å¼å¼€å§‹ä»£ç çš„ç¼–å†™</p>
<p>æ‰“å¼€MainAppDelegate.mï¼Œå®ƒå®ç°äº†UIApplicationDelegateåè®®ï¼Œæ‰€ä»¥å¯ä»¥åœ¨è¯¥ç±»ä¸­å®ç°åº”ç”¨çŠ¶æ€çš„å›è°ƒå‡½æ•°</p>
<p>åœ¨application:didFinishLaunchingWithOptions:æ–¹æ³•ï¼ˆåº”ç”¨ç¨‹åºå¯åŠ¨æ—¶å›è°ƒè¯¥æ–¹æ³•ï¼‰ä¸­æ¥è®¾ç½®å®ƒçš„RootControllerï¼ˆæ ¹æ§åˆ¶å™¨ï¼Œä¸çŸ¥é“è¿™æ ·ç¿»è¯‘ä¸“ä¸ä¸“ä¸š- -ï¼‰ï¼Œæˆ‘çš„å®ç°æ˜¯ç”Ÿæˆä¸€ä¸ªUINavigationControllerä½œä¸ºå®ƒçš„root controllerï¼Œç„¶åæŠŠè‡ªå·±æ–°å»ºçš„ä¸€ä¸ªNaviRootControllerï¼ˆåœ¨è¿™ä¸ªControllerä¸­æ”¾å…¥ä¸€ä¸ªUITableViewï¼Œå…·ä½“ä¸‹é¢ä¼šè®²åˆ°ï¼‰ä½œä¸ºUINavigationControllerçš„root viewï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼ˆè¿™ä¸ªä¸æ˜¯æˆ‘ä»¬æœ¬æ¬¡çš„é‡ç‚¹ï¼Œæ‰€ä»¥ä¸€ç¬”å¸¦è¿‡ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> - (BOOL)application:(UIApplication <em>)application didFinishLaunchingWithOptions:(NSDictionary </em><span style="color: #000000;">)launchOptions<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 3</span>     self.window =<span style="color: #000000;"> [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];<br></span><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> ç”ŸæˆUINavigationControllerå¯¹è±¡ï¼Œå¹¶è®¾ç½®å®ƒçš„RootController</span><br><span style="color: #008080;"> 6</span>     UINavigationController *naviController =<span style="color: #000000;"> [[UINavigationController alloc] initWithRootViewController:[[NaviRootController alloc] init]];<br></span><span style="color: #008080;"> 7</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> ç„¶åæŠŠNavigationControllerè®¾ç½®ä¸ºwindowçš„RootViewController</span><br><span style="color: #008080;"> 8</span> <span style="color: #000000;">    [self.window setRootViewController:naviController];<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span>     self.window.backgroundColor =<span style="color: #000000;"> [UIColor whiteColor];<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">    [self.window makeKeyAndVisible];<br></span><span style="color: #008080;">12</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> YES;<br></span><span style="color: #008080;">13</span> }</pre><br></div>

<p>ç„¶åï¼Œé‡ç‚¹å°±æ˜¯NaviRootControllerè¿™ä¸ªControlleräº†ï¼Œ</p>
<p>æ–°å»ºNaviRootControllerï¼Œç»§æ‰¿UIViewControllerï¼Œåœ¨.hæ–‡ä»¶ä¸­ï¼š</p>
<p>å£°æ˜ä¸€ä¸ªNSMutableArrayå¯¹è±¡dataä½œä¸ºtableViewçš„æ•°æ®æºï¼ˆ<span style="color: #993366;"><strong>ç›¸å½“äºåœ¨androidä¸­ç»å¸¸ç”¨åˆ°çš„ArrayList&lt;Person&gt; dataã€‚NSMutableArrayæ˜¯æ•°ç»„ï¼ŒArrayListåœ¨javaä¸­çš„åº•å±‚å®ç°æœ¬æ¥ç”¨çš„å°±æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥å¾ˆå¥½ç†è§£</strong></span>ï¼‰</p>
<p>å£°æ˜ä¸€ä¸ªç”¨äºé€‚é…å’Œç»‘å®štableViewæ•°æ®çš„é€‚é…å™¨TableViewAdapter<span class="s1"> <em>adapterï¼ˆè¿™ä¸ªç±»æ˜¯æˆ‘è‡ªå·±å†™çš„ï¼Œä¸‹é¢ä¼šè®²åˆ°ã€‚<em>*<span style="color: #993366;">javaä¸­è¦å®ç°ListViewä¸­çš„æ•°æ®ç»‘å®šé€‚é…ï¼Œä¹Ÿè¦é€šè¿‡ä¸€ä¸ªç»§æ‰¿äºBaseAdapterçš„é€‚é…å™¨è¿›è¡Œæ•°æ®çš„é€‚é…å§ï¼Œä¹Ÿå¾ˆå¥½ç†è§£</span></em></em>ï¼‰</span></p>
<p><span class="s1">å£°æ˜ä¸€ä¸ªUITableViewå¯¹è±¡ï¼ˆ<strong><span style="color: #993366;">ç›¸å½“äºandroidä¸­ï¼Œåœ¨activityä¸­å£°æ˜ä¸€ä¸ªprivate ListView listView;</span></strong>ï¼‰</span></p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('d9c08616-f985-42b7-8567-4e754559345f')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_d9c08616-f985-42b7-8567-4e754559345f" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">//</span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">//</span><span style="color: #008000;">  NaviRootController.h<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">//</span><span style="color: #008000;">  TabViewTest<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">//</span><br><span style="color: #008080;"> 5</span> <span style="color: #008000;">//</span><span style="color: #008000;">  Created by WANGJIE on 13-10-31.<br></span><span style="color: #008080;"> 6</span> <span style="color: #008000;">//</span><span style="color: #008000;">  Copyright (c) 2013å¹´ WANGJIE. All rights reserved.<br></span><span style="color: #008080;"> 7</span> <span style="color: #008000;">//<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">#import</span> &lt;UIKit/UIKit.h&gt;<br><span style="color: #008080;">10</span> <span style="color: #0000ff;">@class</span><span style="color: #000000;"> TableViewAdapter;<br></span><span style="color: #008080;">11</span> <span style="color: #0000ff;">@interface</span><span style="color: #000000;"> NaviRootController : UIViewController<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">13</span>     NSMutableArray <em><span style="color: #000000;">data;<br></span><span style="color: #008080;">14</span>     TableViewAdapter </em><span style="color: #000000;">adapter;<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span> @property (weak, nonatomic) IBOutlet UITableView <em><span style="color: #000000;">tableView;<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span><br><span style="color: #008080;">20</span> @property NSMutableArray </em><span style="color: #000000;">data;<br></span><span style="color: #008080;">21</span> @property(strong, nonatomic) TableViewAdapter *<span style="color: #000000;">adapter;<br></span><span style="color: #008080;">22</span> <span style="color: #0000ff;">@end</span></pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>å¥½äº†ï¼Œå£°æ˜éƒ¨åˆ†åˆ°æ­¤ä¸ºæ­¢ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å®ç°éƒ¨åˆ†</p>
<p><span class="s1">åˆšåˆšåœ¨</span>MainAppDelegateä¸­ï¼Œç”Ÿæˆäº†ä¸€ä¸ªNaviRootControllerå¯¹è±¡ï¼Œç„¶åæŠŠè¿™ä¸ªå¯¹è±¡åŠ å…¥åˆ°äº†UINavigationControllerå¯¹è±¡çš„rootViewControllerã€‚ç”ŸæˆNaviRootControllerå¯¹è±¡çš„æ—¶å€™ï¼Œè°ƒç”¨äº†initæ–¹æ³•ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨initæ–¹æ³•é‡Œé¢å»åˆå§‹åŒ–å¸ƒå±€ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('a6fdcec3-37ba-4d77-9aef-f331f7e32fea')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_a6fdcec3-37ba-4d77-9aef-f331f7e32fea" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> - (<span style="color: #0000ff;">id</span><span style="color: #000000;">)init<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 3</span>     self = [self initWithNibName:<span style="color: #800000;">@â€</span><span style="color: #800000;">navi_root</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> bundle:nil];<br></span><span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> self;<br></span><span style="color: #008080;"> 5</span> <span style="color: #000000;">}<br></span><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span> - (<span style="color: #0000ff;">id</span>)initWithNibName:(NSString <em>)nibNameOrNil bundle:(NSBundle </em><span style="color: #000000;">)nibBundleOrNil<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 9</span>     self =<span style="color: #000000;"> [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];<br></span><span style="color: #008080;">10</span>     <span style="color: #0000ff;">if</span><span style="color: #000000;"> (self) {<br></span><span style="color: #008080;">11</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è·å¾—å½“å‰å¯¼èˆªæ å¯¹è±¡</span><br><span style="color: #008080;">12</span>         UINavigationItem <em>item =<span style="color: #000000;"> [self navigationItem];<br></span><span style="color: #008080;">13</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®å¯¼èˆªæ å·¦æŒ‰é’®</span><br><span style="color: #008080;">14</span>         UIBarButtonItem </em>leftButton = [[UIBarButtonItem alloc] initWithTitle:<span style="color: #800000;">@â€</span><span style="color: #800000;">leftButton</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> style:UIBarButtonItemStylePlain target:self action:@selector(buttonClickedAction:)];<br></span><span style="color: #008080;">15</span>         [leftButton setTag:<span style="color: #800080;">0</span><span style="color: #000000;">];<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">        [item setLeftBarButtonItem:leftButton animated:YES];<br></span><span style="color: #008080;">17</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®å¯¼èˆªæ å³æŒ‰é’®</span><br><span style="color: #008080;">18</span>         UIBarButtonItem *rightButton = [[UIBarButtonItem alloc] initWithTitle:<span style="color: #800000;">@â€</span><span style="color: #800000;">rightButton</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> style:UIBarButtonItemStyleDone target:self action:@selector(buttonClickedAction:)];<br></span><span style="color: #008080;">19</span>         [rightButton setTag:<span style="color: #800080;">1</span><span style="color: #000000;">];<br></span><span style="color: #008080;">20</span> <span style="color: #000000;">        [item setRightBarButtonItem:rightButton animated:YES];<br></span><span style="color: #008080;">21</span><br><span style="color: #008080;">22</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">23</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> self;<br></span><span style="color: #008080;">24</span> }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>æˆ‘ä»¬åœ¨initæ–¹æ³•ä¸­è°ƒç”¨äº†initWithNibName:bundle:æ–¹æ³•ï¼Œä¼ å…¥äº†NibNameè¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªæ˜¯ä»€ä¹ˆï¼Ÿ<strong><span style="color: #993366;">Nibæ˜¯iosé‡Œé¢çš„å¸ƒå±€æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºandroidä¸­ç±»ä¼¼main.xmlè¿™ç§å¸ƒå±€æ–‡ä»¶å§ï¼Œç°åœ¨ä¼ è¿›å»çš„æ—¶nibnameï¼Œä¹Ÿå°±æ˜¯å¸ƒå±€æ–‡ä»¶çš„åç§°ã€‚</span></strong>æ‰€ä»¥ï¼Œæ²¡é”™ï¼Œä¼ å…¥è¿™ä¸ªå‚æ•°åï¼Œå½“å‰çš„controllerï¼ˆä¹Ÿå°±æ˜¯NaviRootControllerå°±è·Ÿä¼ å…¥çš„è¿™ä¸ªå¸ƒå±€æ–‡ä»¶ç»‘å®šèµ·æ¥äº†ï¼Œ<strong><span style="color: #993366;">ç±»ä¼¼äºandroidä¸­activityä¸­ç†Ÿæ‚‰çš„setContentView(R.layout.main)ä¸€æ ·ï¼</span></strong>ï¼‰</p>
<p>ç„¶åæˆ‘ä»¬é¡ºä¾¿çœ‹çœ‹navi_root.xibè¿™ä¸ªå¸ƒå±€æ–‡ä»¶ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201311/02020218-ffb5db3c54c54a6184439f8ed617d17d.png" alt=""></p>
<p>æ•´ä¸ªç•Œé¢å°±ä¸€ä¸ªUITableViewï¼Œå¯¹äº†ï¼Œåˆ«å¿˜äº†åœ¨Fileâ€™s Ownerä¸­æŠŠcustom classæ”¹æˆNaviRootControllerã€‚é”®ç›˜æŒ‰ä½controlï¼Œç”¨é¼ æ ‡æ‹–åŠ¨å·¦è¾¹æ çš„&ldquo;Table View&rdquo;åˆ°NaviRootController.hä¸­ï¼Œä¼šè‡ªåŠ¨ç”ŸæˆUITableViewå£°æ˜ï¼Œå¹¶è‡ªåŠ¨ç»‘å®šã€‚</p>
<p>æ¥ä¸‹æ¥å›åˆ°NaviRootControllerçš„åˆå§‹åŒ–æ–¹æ³•ä¸­ã€‚</p>
<p>initWithNibName:bundle:æ–¹æ³•ä¸­åé¢çš„UINavigationItemç›¸å…³çš„ä»£ç æ˜¯ç”¨æ¥è®¾ç½®å¯¼èˆªæ å·¦è¾¹å’Œå³è¾¹çš„æŒ‰é’®ï¼Œæ—¢ç„¶æ˜¯ä¸ªdemoï¼Œæ‰€ä»¥ä¹Ÿæ²¡ä»€ä¹ˆç‰¹åˆ«çš„åŠŸèƒ½ï¼Œå°±æ˜¯ç‚¹å‡»ä¸‹ï¼Œè·³å‡ºä¸€ä¸ªUIAlertViewæç¤ºä¸‹ï¼Œæ‰€ä»¥ä¸€ç¬”å¸¦è¿‡ã€‚</p>
<p>æ­¤æ—¶ç•Œé¢å¸ƒå±€å’Œcontrollerå·²ç»ç»‘å®šèµ·æ¥äº†ï¼Œç°åœ¨çš„ä»»åŠ¡åº”è¯¥æ˜¯åˆå§‹åŒ–UITableViewçš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„dataå±æ€§ï¼Œä½†æ˜¯åœ¨å“ªé‡Œåˆå§‹åŒ–æ¯”è¾ƒå¥½å‘¢ï¼Ÿ</p>
<p>åˆšå¼€å§‹ï¼Œæˆ‘æ˜¯ç›´æ¥åœ¨initæ–¹æ³•ä¸­ç›´æ¥å»åˆå§‹åŒ–æ•°æ®ï¼Œä½†æ˜¯å¤±è´¥äº†ï¼Œä¸ç®¡åœ¨initæ–¹æ³•ä¸­åˆå§‹åŒ–å¤šå°‘æ¬¡ï¼ˆdataè°ƒç”¨å¤šå°‘æ¬¡addObjectæ–¹æ³•ï¼‰ï¼Œdataçš„å€¼æ°¸è¿œéƒ½æ˜¯nilï¼ˆç›¸å½“äºåœ¨androidä¸­ï¼Œä¸ç®¡è°ƒç”¨å¤šå°‘æ¬¡list.add(â€¦)æ–¹æ³•ï¼Œlistä¸­ä¸€æ¡æ•°æ®ä¹Ÿæ²¡æœ‰åŠ å…¥ï¼ï¼‰ï¼ŒçŒœæµ‹æ˜¯å› ä¸ºåœ¨initæ–¹æ³•ä¸­çš„æ—¶å€™å±æ€§å’Œæ§ä»¶éƒ½è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ã€‚</p>
<p>æœ€åæˆ‘çš„è§£å†³åŠæ³•å°±æ˜¯åœ¨viewDidLoadæ–¹æ³•ä¸­å»åŠ è½½æ•°æ®ã€‚viewDidLoadè¿™ä¸ªå›è°ƒæ–¹æ³•æ˜¯ä¼šåœ¨æ§ä»¶åŠ è½½å®Œæ¯•åè°ƒç”¨ï¼Œæ‰€ä»¥ï¼Œæˆ‘è®¤ä¸ºåœ¨è¿™é‡Œå»åŠ è½½æ•°æ®å’Œåšæ§ä»¶çš„åˆå§‹åŒ–æ“ä½œæ˜¯æ¯”è¾ƒåˆç†çš„ã€‚</p>
<p>viewDidLoadæ–¹æ³•å®ç°å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('c37254db-2ea2-4e96-a9e5-0ecddbd3c8cc')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_c37254db-2ea2-4e96-a9e5-0ecddbd3c8cc" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> - (<span style="color: #0000ff;">void</span><span style="color: #000000;">)viewDidLoad<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 3</span><br><span style="color: #008080;"> 4</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> Do any additional setup after loading the view.</span><br><span style="color: #008080;"> 5</span> <span style="color: #000000;">    [super viewDidLoad];<br></span><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">adapter) {<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">        [self initData];<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> ç”Ÿæˆé€‚é…å™¨å§”æ‰˜å¯¹è±¡</span><br><span style="color: #008080;">11</span>         adapter =<span style="color: #000000;"> [[TableViewAdapter alloc] initWithSource:data Controller:self];<br></span><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®é€‚é…å™¨å§”æ‰˜å¯¹è±¡</span><br><span style="color: #008080;">14</span> <span style="color: #000000;">        [[self tableView] setDelegate:adapter];<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">        [[self tableView] setDataSource:adapter];<br></span><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">18</span> }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>å¦‚ä¸Šï¼Œåœ¨viewDidLoadä¸­ï¼Œæˆ‘å…ˆå»åˆå§‹åŒ–æ•°æ®ï¼ˆdemoä¸­çš„å®ç°å…¶å®å°±æ˜¯å¾ªç¯äº†14æ¬¡ï¼Œå¾€dataä¸­åŠ äº†14ä¸ªPersonå¯¹è±¡ï¼‰ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªé€‚é…å™¨å§”æ‰˜å¯¹è±¡ï¼Œä¼ å…¥dataï¼ˆæ•°æ®æºï¼‰å’Œselfï¼ˆå½“å‰controllerå¯¹è±¡ï¼‰ï¼Œ<strong><span style="color: #993366;">ç›¸å½“äºandroidä¸­çš„ adapter = new MyAdapter(list, this);æœ‰æœ¨æœ‰ï¼Ÿï¼Ÿï¼ï¼</span></strong></p>
<p>ç„¶åï¼ŒsetDelegateç”¨æ¥è®¾ç½®å§”æ‰˜å¯¹è±¡ï¼ˆ<strong><span style="color: #993366;">ç›¸å½“äºandroidä¸­çš„listView.setAdapter(adapter)</span></strong>ï¼‰ï¼ŒsetDataSourceç”¨æ¥è®¾ç½®æ•°æ®æºã€‚</p>
<p>è¿™é‡Œï¼Œå®Œæ•´åœ°åˆ—å‡ºNaviRootControllerçš„ä»£ç ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('2b006d06-4ce6-4ae1-bd35-7ec3abe88e1e')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_2b006d06-4ce6-4ae1-bd35-7ec3abe88e1e" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #008000;">//</span><br><span style="color: #008080;">  2</span> <span style="color: #008000;">//</span><span style="color: #008000;">  NaviRootController.m<br></span><span style="color: #008080;">  3</span> <span style="color: #008000;">//</span><span style="color: #008000;">  TabViewTest<br></span><span style="color: #008080;">  4</span> <span style="color: #008000;">//</span><br><span style="color: #008080;">  5</span> <span style="color: #008000;">//</span><span style="color: #008000;">  Created by WANGJIE on 13-10-31.<br></span><span style="color: #008080;">  6</span> <span style="color: #008000;">//</span><span style="color: #008000;">  Copyright (c) 2013å¹´ WANGJIE. All rights reserved.<br></span><span style="color: #008080;">  7</span> <span style="color: #008000;">//<br></span><span style="color: #008080;">  8</span><br><span style="color: #008080;">  9</span> <span style="color: #0000ff;">#import</span> <span style="color: #800000;">â€œ</span><span style="color: #800000;">NaviRootController.h</span><span style="color: #800000;">â€œ</span><br><span style="color: #008080;"> 10</span> <span style="color: #0000ff;">#import</span> <span style="color: #800000;">â€œ</span><span style="color: #800000;">Person.h</span><span style="color: #800000;">â€œ</span><br><span style="color: #008080;"> 11</span> <span style="color: #0000ff;">#import</span> <span style="color: #800000;">â€œ</span><span style="color: #800000;">TableViewAdapter.h</span><span style="color: #800000;">â€œ</span><br><span style="color: #008080;"> 12</span><br><span style="color: #008080;"> 13</span> <span style="color: #0000ff;">@interface</span><span style="color: #000000;"> NaviRootController ()<br></span><span style="color: #008080;"> 14</span><br><span style="color: #008080;"> 15</span> <span style="color: #0000ff;">@end</span><br><span style="color: #008080;"> 16</span><br><span style="color: #008080;"> 17</span> <span style="color: #0000ff;">@implementation</span><span style="color: #000000;"> NaviRootController<br></span><span style="color: #008080;"> 18</span> <span style="color: #0000ff;">@synthesize</span><span style="color: #000000;"> data, adapter;<br></span><span style="color: #008080;"> 19</span><br><span style="color: #008080;"> 20</span> - (<span style="color: #0000ff;">id</span><span style="color: #000000;">)init<br></span><span style="color: #008080;"> 21</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 22</span>     self = [self initWithNibName:<span style="color: #800000;">@â€</span><span style="color: #800000;">navi_root</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> bundle:nil];<br></span><span style="color: #008080;"> 23</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> self;<br></span><span style="color: #008080;"> 24</span> <span style="color: #000000;">}<br></span><span style="color: #008080;"> 25</span><br><span style="color: #008080;"> 26</span> - (<span style="color: #0000ff;">id</span>)initWithNibName:(NSString <em>)nibNameOrNil bundle:(NSBundle </em><span style="color: #000000;">)nibBundleOrNil<br></span><span style="color: #008080;"> 27</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 28</span>     self =<span style="color: #000000;"> [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];<br></span><span style="color: #008080;"> 29</span>     <span style="color: #0000ff;">if</span><span style="color: #000000;"> (self) {<br></span><span style="color: #008080;"> 30</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Custom initialization<br></span><span style="color: #008080;"> 31</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è·å¾—å½“å‰å¯¼èˆªæ å¯¹è±¡</span><br><span style="color: #008080;"> 32</span>         UINavigationItem <em>item =<span style="color: #000000;"> [self navigationItem];<br></span><span style="color: #008080;"> 33</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®å¯¼èˆªæ å·¦æŒ‰é’®</span><br><span style="color: #008080;"> 34</span>         UIBarButtonItem </em>leftButton = [[UIBarButtonItem alloc] initWithTitle:<span style="color: #800000;">@â€</span><span style="color: #800000;">leftButton</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> style:UIBarButtonItemStylePlain target:self action:@selector(buttonClickedAction:)];<br></span><span style="color: #008080;"> 35</span>         [leftButton setTag:<span style="color: #800080;">0</span><span style="color: #000000;">];<br></span><span style="color: #008080;"> 36</span> <span style="color: #000000;">        [item setLeftBarButtonItem:leftButton animated:YES];<br></span><span style="color: #008080;"> 37</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®å¯¼èˆªæ å³æŒ‰é’®</span><br><span style="color: #008080;"> 38</span>         UIBarButtonItem <em>rightButton = [[UIBarButtonItem alloc] initWithTitle:<span style="color: #800000;">@â€</span><span style="color: #800000;">rightButton</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> style:UIBarButtonItemStyleDone target:self action:@selector(buttonClickedAction:)];<br></span><span style="color: #008080;"> 39</span>         [rightButton setTag:<span style="color: #800080;">1</span><span style="color: #000000;">];<br></span><span style="color: #008080;"> 40</span> <span style="color: #000000;">        [item setRightBarButtonItem:rightButton animated:YES];<br></span><span style="color: #008080;"> 41</span><br><span style="color: #008080;"> 42</span><br><span style="color: #008080;"> 43</span><br><span style="color: #008080;"> 44</span><br><span style="color: #008080;"> 45</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 46</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> self;<br></span><span style="color: #008080;"> 47</span> <span style="color: #000000;">}<br></span><span style="color: #008080;"> 48</span><br><span style="color: #008080;"> 49</span> <span style="color: #008000;">/</span></em><span style="color: #008000;"><em><br></em></span><span style="color: #008080;"> 50</span> <span style="color: #008000;">  åˆå§‹åŒ–åˆ—è¡¨æ•°æ®<br></span><span style="color: #008080;"> 51</span>  <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 52</span> - (<span style="color: #0000ff;">void</span><span style="color: #000000;">)initData<br></span><span style="color: #008080;"> 53</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 54</span>     data =<span style="color: #000000;"> [[NSMutableArray alloc] init];<br></span><span style="color: #008080;"> 55</span>     NSLog(<span style="color: #800000;">@â€</span><span style="color: #800000;">%@</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">, NSStringFromSelector(_cmd));<br></span><span style="color: #008080;"> 56</span>     Person <span style="color: #000000;">person;<br></span><span style="color: #008080;"> 57</span>     <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; <span style="color: #800080;">14</span>; i++<span style="color: #000000;">) {<br></span><span style="color: #008080;"> 58</span>         person =<span style="color: #000000;"> [[Person alloc] init];<br></span><span style="color: #008080;"> 59</span>         [person setName:[<span style="color: #800000;">@â€</span><span style="color: #800000;">name</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> stringByAppendingString:<br></span><span style="color: #008080;"> 60</span>                          [NSString stringWithFormat:<span style="color: #800000;">@â€</span><span style="color: #800000;">%d</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">, i]<br></span><span style="color: #008080;"> 61</span> <span style="color: #000000;">                         ]<br></span><span style="color: #008080;"> 62</span> <span style="color: #000000;">         ];<br></span><span style="color: #008080;"> 63</span><br><span style="color: #008080;"> 64</span>         [person setAge:i + <span style="color: #800080;">10</span><span style="color: #000000;">];<br></span><span style="color: #008080;"> 65</span><br><span style="color: #008080;"> 66</span>         [person setPic:[UIImage imageNamed:<span style="color: #800000;">@â€</span><span style="color: #800000;">Hypno.png</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">]];<br></span><span style="color: #008080;"> 67</span><br><span style="color: #008080;"> 68</span> <span style="color: #000000;">        [data addObject:person];<br></span><span style="color: #008080;"> 69</span><br><span style="color: #008080;"> 70</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 71</span> <span style="color: #000000;">}<br></span><span style="color: #008080;"> 72</span><br><span style="color: #008080;"> 73</span><br><span style="color: #008080;"> 74</span> - (<span style="color: #0000ff;">void</span><span style="color: #000000;">)viewDidLoad<br></span><span style="color: #008080;"> 75</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 76</span><br><span style="color: #008080;"> 77</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> Do any additional setup after loading the view.</span><br><span style="color: #008080;"> 78</span> <span style="color: #000000;">    [super viewDidLoad];<br></span><span style="color: #008080;"> 79</span><br><span style="color: #008080;"> 80</span>     <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">adapter) {<br></span><span style="color: #008080;"> 81</span> <span style="color: #000000;">        [self initData];<br></span><span style="color: #008080;"> 82</span><br><span style="color: #008080;"> 83</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> ç”Ÿæˆé€‚é…å™¨å§”æ‰˜å¯¹è±¡</span><br><span style="color: #008080;"> 84</span>         adapter =<span style="color: #000000;"> [[TableViewAdapter alloc] initWithSource:data Controller:self];<br></span><span style="color: #008080;"> 85</span><br><span style="color: #008080;"> 86</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®é€‚é…å™¨å§”æ‰˜å¯¹è±¡</span><br><span style="color: #008080;"> 87</span> <span style="color: #000000;">        [[self tableView] setDelegate:adapter];<br></span><span style="color: #008080;"> 88</span> <span style="color: #000000;">        [[self tableView] setDataSource:adapter];<br></span><span style="color: #008080;"> 89</span><br><span style="color: #008080;"> 90</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 91</span><br><span style="color: #008080;"> 92</span><br><span style="color: #008080;"> 93</span><br><span style="color: #008080;"> 94</span> <span style="color: #000000;">}<br></span><span style="color: #008080;"> 95</span><br><span style="color: #008080;"> 96</span> - (<span style="color: #0000ff;">void</span><span style="color: #000000;">)viewWillAppear:(BOOL)animated<br></span><span style="color: #008080;"> 97</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 98</span> <span style="color: #000000;">    [super viewWillAppear:YES];<br></span><span style="color: #008080;"> 99</span><br><span style="color: #008080;">100</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">101</span><br><span style="color: #008080;">102</span> - (<span style="color: #0000ff;">void</span><span style="color: #000000;">)didReceiveMemoryWarning<br></span><span style="color: #008080;">103</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">104</span> <span style="color: #000000;">    [super didReceiveMemoryWarning];<br></span><span style="color: #008080;">105</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> Dispose of any resources that can be recreated.</span><br><span style="color: #008080;">106</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">107</span><br><span style="color: #008080;">108</span> <span style="color: #008000;">//</span><span style="color: #008000;"> æŒ‰é’®ç‚¹å‡»äº‹ä»¶å›è°ƒ</span><br><span style="color: #008080;">109</span> - (<span style="color: #0000ff;">void</span>)buttonClickedAction:(<span style="color: #0000ff;">id</span><span style="color: #000000;">)sender<br></span><span style="color: #008080;">110</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">111</span><br><span style="color: #008080;">112</span>     NSString <em><span style="color: #000000;">message;<br></span><span style="color: #008080;">113</span>     <span style="color: #0000ff;">switch</span><span style="color: #000000;"> ([sender tag]) {<br></span><span style="color: #008080;">114</span>         <span style="color: #0000ff;">case</span> <span style="color: #800080;">0</span><span style="color: #000000;">:<br></span><span style="color: #008080;">115</span>             message = <span style="color: #800000;">@â€</span><span style="color: #800000;">left button clicked!</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">;<br></span><span style="color: #008080;">116</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">117</span>         <span style="color: #0000ff;">case</span> <span style="color: #800080;">1</span><span style="color: #000000;">:<br></span><span style="color: #008080;">118</span>             message = <span style="color: #800000;">@â€</span><span style="color: #800000;">right button clicked!</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">;<br></span><span style="color: #008080;">119</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">120</span>         <span style="color: #0000ff;">default</span><span style="color: #000000;">:<br></span><span style="color: #008080;">121</span>             message = <span style="color: #800000;">@â€</span><span style="color: #800000;">unknow button clicked!</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">;<br></span><span style="color: #008080;">122</span>             <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;">123</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">124</span><br><span style="color: #008080;">125</span>     UIAlertView </em>alert = [[UIAlertView alloc] initWithTitle:<span style="color: #800000;">@â€</span><span style="color: #800000;">alert view</span><span style="color: #800000;">â€œ</span> message:message <span style="color: #0000ff;">delegate</span>:self cancelButtonTitle:<span style="color: #800000;">@â€</span><span style="color: #800000;">cancel</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> otherButtonTitles:nil, nil];<br></span><span style="color: #008080;">126</span> <span style="color: #000000;">    [alert show];<br></span><span style="color: #008080;">127</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">128</span><br><span style="color: #008080;">129</span><br><span style="color: #008080;">130</span><br><span style="color: #008080;">131</span><br><span style="color: #008080;">132</span> <span style="color: #0000ff;">@end</span></pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>&nbsp;</p>
<p>å¥½äº†ï¼ŒUITableViewçš„åˆå§‹åŒ–å‡†å¤‡å·¥ä½œåˆ°æ­¤å°±åšå®Œäº†ï¼Œç°åœ¨å¹²å˜›ï¼Ÿ</p>
<p>å½“ç„¶å»ç¼–å†™TableViewAdapterè¿™ä¸ªç±»å•Šã€‚æ•°æ®æºæœ‰äº†ï¼ˆå¹¶ä¸”åˆå§‹åŒ–å®Œæ¯•ï¼‰ï¼Œç”¨ä»¥æ˜¾ç¤ºçš„æ§ä»¶ï¼ˆUITableViewï¼‰æœ‰äº†ï¼ˆå¹¶ä¸”åˆå§‹åŒ–å®Œæ¯•ï¼‰ï¼Œè€Œä¸”ä¸¤ä¸ªè¿˜å·²ç»ç»‘å®šèµ·æ¥äº†ã€‚ä½†æ˜¯è¿˜ç¼ºçš„å°±æ˜¯ä¸€ä¸ªè§’è‰²ï¼Œè¿™ä¸ªè§’è‰²å¯ä»¥æŠŠæ•°æ®æºä¸­çš„æ•°æ®è·Ÿæ§ä»¶ä¸­æŸä¸ªç›¸åº”çš„å­æ§ä»¶é€‚é…èµ·æ¥ã€‚æ¯”å¦‚æ•°æ®æºä¸­æœ‰4ä¸ªæ•°æ®ï¼ŒAã€Bã€Cã€Dï¼Œæ§ä»¶æœ‰oneã€twoã€threeã€fourè¿™4ä¸ªæ§ä»¶ï¼Œè¿™ä¸ªè§’è‰²çš„ä»»åŠ¡å°±æ˜¯å‘Šè¯‰oneï¼šä½ è¦æ˜¾ç¤ºçš„æ•°æ®æ˜¯Aï¼›å‘Šè¯‰twoï¼šä½ è¦æ˜¾ç¤ºçš„æ•°æ®æ˜¯Bï¼›å‘Šè¯‰threeï¼šä½ è¦æ˜¾ç¤ºçš„æ•°æ®æ˜¯Cï¼›å‘Šè¯‰fourï¼šä½ è¦æ˜¾ç¤ºçš„æ•°æ®æ˜¯Dï¼</p>
<p>è¿™ä¸ªè§’è‰²å°±æ˜¯é€‚é…å™¨ï¼ä¹Ÿå°±æ˜¯ä¸‹é¢è¦è¯´çš„é‚£ä¸ªTableViewAdapter</p>
<p>æ–°å»ºTableViewAdapterï¼Œå®ç°<span class="s1">&lt;</span>UITableViewDataSource<span class="s1">, </span>UITableViewDelegate<span class="s1">&gt;è¿™ä¸¤ä¸ªåè®®ï¼ˆ<strong><span style="color: #993366;">androidä¸­é€‚é…å™¨ä¸åŒçš„æ˜¯è¦ç»§æ‰¿BaseAdapterç±»</span></strong>ï¼‰ã€‚å£°æ˜ä¸€ä¸ªæ•°æ®æºdataï¼Œè¿™ä¸ªæ•°æ®æºæ˜¯ä»NaviRootControllerä¸­ä¼ è¿‡æ¥çš„å·²ç»åˆå§‹åŒ–å¥½äº†çš„æ•°æ®æºï¼Œè¿˜æœ‰ä¸€ä¸ªå£°æ˜æ˜¯</span>NaviRootControllerå¯¹è±¡ä¼ è¿‡æ¥çš„selfï¼ˆéœ€è¦ä»€ä¹ˆï¼Œå°±è®©è°ƒç”¨è€…ä¼ ä»€ä¹ˆè¿‡æ¥ï¼Œè¿™ä¸ªåº”è¯¥éƒ½æ‡‚çš„-ã€‚-ï¼‰ï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªè‡ªå·±å†™çš„åˆå§‹åŒ–æ–¹æ³•ï¼ˆè‡ªå·±å†™åˆå§‹åŒ–æ–¹æ³•initæ‰“å¤´çš„æ–¹æ³•å°±è¡Œï¼Œä¸åƒjavaä¸­çš„æ„é€ æ–¹æ³•ï¼Œæ–¹æ³•åè¦è·Ÿç±»åç›¸åŒï¼Œä¸è¿‡è¿™äº›éƒ½æ˜¯æ¢æ±¤ä¸æ¢è¯ï¼‰</p>
<p><span class="s1">ç„¶åçœ‹çœ‹TableViewAdapterçš„å®ç°ç±»ï¼ˆ.mï¼‰</span></p>
<p><span class="s1">å®ç°äº†è¿™ä¸¤ä¸ªåè®®åï¼Œä½ å°±èƒ½è¦†å†™é‡Œé¢çš„ä¸€äº›UITableViewçš„å›è°ƒæ–¹æ³•äº†ï¼Œæ¯”å¦‚ï¼š</span></p>
<p>tableView:numberOfRowsInSection:æ–¹æ³•ï¼Œè¿”å›æ•°æ®æºçš„æ•°é‡å°±è¡Œäº†ï¼ˆ<strong><span style="color: #993366;">ç±»ä¼¼androidçš„adapterä¸­è‡ªå·±è¦å®ç°çš„getCount()æ–¹æ³•ï¼</span></strong>ï¼‰</p>
<p>tableView:cellForRowAtIndexPath:è¿™ä¸ªæ˜¯æ–¹æ³•æ˜¯è¿™é‡Œæœ€å…³é”®çš„ä¸€ä¸ªæ–¹æ³•äº†ï¼Œå°±æ˜¯åœ¨è¿™é‡Œè¿›è¡Œæ•°æ®çš„é€‚é…å·¥ä½œï¼ˆ<strong><span style="color: #993366;">ç±»ä¼¼androidçš„adapterä¸­è‡ªå·±è¦å®ç°çš„getView()æ–¹æ³•ï¼</span></strong>ï¼‰ï¼Œè¿™é‡Œè¿”å›çš„UITableViewCellå°±æ˜¯ç±»è¡¨ä¸­çš„ä¸€é¡¹ï¼ˆ<strong><span style="color: #993366;">ç±»ä¼¼androidä¸­listviewçš„ä¸€ä¸ªitem</span></strong>ï¼‰ï¼Œè¿™ä¸ªä¸€é¡¹çš„å¸ƒå±€ï¼Œå·²ç»åœ¨table_cell.xibæ–‡ä»¶ä¸­å¸ƒå±€å®Œæ¯•ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201311/02023019-1ef72e95265e49d892e83e1a84ef423c.png" alt=""></p>
<p>è®¾ç½®Fileâ€™s Ownerä¸ºTableViewAdapterï¼Œè®¾ç½®Table View Cellçš„identifierè®¾ç½®ä¸º&ldquo;MyTableCell&rdquo;ï¼Œè¿™ä¸ªå¯ä»¥ä»»æ„å–åï¼Œä½†æ˜¯è¦è·Ÿåé¢çš„æ–¹æ³•å®ç°ä¸­ç»Ÿä¸€ï¼ˆè·Ÿå“ªé‡Œç»Ÿä¸€ï¼Ÿä½œç”¨æ˜¯ç¥é©¬ï¼Ÿè¿™äº›ä¸‹é¢ä¼šè®²åˆ°ï¼Œåˆ«æ€¥-ã€‚-ï¼‰ï¼Œæ¥ç€è®¾ç½®ImageViewçš„tagä¸º1ï¼ŒnameLabelçš„tagä¸º2ï¼ŒageLabelçš„tagä¸º3ï¼ˆtagçš„ä½œç”¨ï¼Œä¸‹é¢ä¹Ÿä¼šè®²åˆ°ï¼‰ã€‚</p>
<p>æ¥ç€ï¼Œå›åˆ°tableView:cellForRowAtIndexPath:è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒçš„å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> - (UITableViewCell <em>)tableView:(UITableView </em>)tableView cellForRowAtIndexPath:(NSIndexPath <em><span style="color: #000000;">)indexPath<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">{<br></span><span style="color: #008080;"> 3</span>     Person </em>p =<span style="color: #000000;"> [data objectAtIndex:[indexPath row]];<br></span><span style="color: #008080;"> 4</span>     UITableViewCell <em>cell = [tableView dequeueReusableCellWithIdentifier:<span style="color: #800000;">@â€</span><span style="color: #800000;">MyTableCell</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">];<br></span><span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">cell) {<br></span><span style="color: #008080;"> 6</span>         NSArray </em>nibViews = [[NSBundle mainBundle] loadNibNamed:<span style="color: #800000;">@â€</span><span style="color: #800000;">table_cell</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> owner:self options:nil];<br></span><span style="color: #008080;"> 7</span>         cell = [nibViews objectAtIndex:<span style="color: #800080;">0</span><span style="color: #000000;">];<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span>     UIImageView <em>picIv = (UIImageView </em>)[cell viewWithTag:<span style="color: #800080;">1</span><span style="color: #000000;">];<br></span><span style="color: #008080;">11</span>     UILabel <em>nameLb = (UILabel </em>)[cell viewWithTag:<span style="color: #800080;">2</span><span style="color: #000000;">];<br></span><span style="color: #008080;">12</span>     UILabel <em>ageLb = (UILabel </em>)[cell viewWithTag:<span style="color: #800080;">3</span><span style="color: #000000;">];<br></span><span style="color: #008080;">13</span><br><span style="color: #008080;">14</span> <span style="color: #000000;">    [nameLb setText:[p name]];<br></span><span style="color: #008080;">15</span>     [ageLb setText:[NSString stringWithFormat:<span style="color: #800000;">@â€</span><span style="color: #800000;">%d</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">, [p age]]];<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    [picIv setImage:[p pic]];<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> cell;<br></span><span style="color: #008080;">19</span> }</pre><br></div>

<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼š</p>
<p>ç¬¬3è¡Œï¼Œæ˜¯ç”¨äºè·å¾—æ‰€è¦æ˜¾ç¤ºçš„æ•°æ®Personå¯¹è±¡ï¼ˆ<strong><span style="color: #993366;">è¿™é‡Œçš„[indexPath row]ç›¸å½“äºandroidçš„adapterçš„getViewæ–¹æ³•çš„positionå‚æ•°</span></strong>ã€‚indexPathä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œrowå’Œsectionï¼Œè¡¨ç¤ºè¡Œå’Œåˆ—ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨æ˜¯è¦æ˜¾ç¤ºä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥åªéœ€è¦rowè¿™ä¸ªå‚æ•°å°±å¯ä»¥äº†ï¼‰</p>
<p><span class="s1">ç¬¬4è¡Œï¼Œæ˜¯ç”¨äºèµ„æºçš„é‡å¤åˆ©ç”¨ï¼Œæ ¹æ®æ ‡ç¤ºç¬¦&ldquo;MyTableCell&rdquo;å»è·å¾—ä¸€ä¸ªå¯å†åˆ©ç”¨çš„UITableViewCellï¼ˆè¿™é‡Œçš„æ ‡ç¤ºç¬¦å°±è¦è·Ÿå‰é¢åœ¨xibæ–‡ä»¶ä¸­è®¾ç½®çš„æ ‡ç¤ºç¬¦è¦ä¸€è‡´ï¼Œè¿™æ ·æ‰èƒ½è¢«è¯†åˆ«åˆ°ï¼Œç„¶ååœ¨è¿™é‡Œè¢«è·å–åˆ°ï¼‰ï¼Œå¦‚æœæ²¡æœ‰è·å¾—åˆ°ï¼Œå°±å»æ–°åˆ›å»ºä¸€ä¸ªUITableViewCellã€‚</span></p>
<p><span class="s1">ç¬¬6ã€7è¡Œï¼Œæ˜¯åˆ›å»ºæ–°çš„UITableViewCellçš„ä»£ç ï¼Œé€šè¿‡mianBundleçš„loadNibNamed:owner:optionsæ–¹æ³•æ ¹æ®xibçš„åå­—å»åˆ›å»ºï¼ˆ<strong><span style="color: #993366;">è·Ÿ</span></strong></span><strong><span style="color: #993366;">android<span class="s1">ä¸­çš„</span>LayoutInflater.inflate()</span></strong><span class="s1"><strong><span style="color: #993366;">æ–¹æ³•é€šè¿‡R.layout.xxxçš„æ–¹æ³•åˆ›å»ºç±»ä¼¼</span></strong>ï¼‰ï¼ŒloadNibNamed:owner:optionsè¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªå°±æ˜¯UITableViewCelläº†ã€‚</span></p>
<p><span class="s1">ç¬¬10ã€11ã€12è¡Œï¼Œæ˜¯è·å–åˆ°æˆ–è€…æ–°å»ºçš„cellé€šè¿‡æ§ä»¶ä¹‹å‰è®¾ç½®çš„tagæ¥è·å¾—ç›¸åº”åœ°å­æ§ä»¶ï¼ˆç°åœ¨çŸ¥é“ä¹‹å‰ä¸ºä»€ä¹ˆè¦è®¾ç½®xibæ–‡ä»¶ä¸­æ§ä»¶çš„tagäº†å§ï¼Ÿ<strong><span style="color: #993366;">è¿™ä¸ªè·Ÿ</span></strong></span><strong><span style="color: #993366;">android<span class="s1">ä¸­çš„</span>findViewByTag/findViewByIdåˆæ˜¯å¾ˆç±»ä¼¼çš„ï¼</span></strong><span class="s1">ï¼‰</span></p>
<p><span class="s1">ç¬¬14ã€15ã€16è¡Œï¼Œæ˜¯ä¸ºåˆšåˆšè·å¾—çš„cellä¸­çš„å­æ§ä»¶é€‚é…æ•°æ®ï¼Œè®©å®ƒå¯ä»¥æŠŠæ•°æ®æ˜¾ç¤ºå‡ºæ¥ã€‚</span></p>
<p><span class="s1">ç¬¬18è¡Œï¼ŒæŠŠç”Ÿæˆæ•°æ®é€‚é…å®Œæ¯•çš„UITableViewCellè¿”å›å‡ºå»ï¼ˆ<strong><span style="color: #993366;">è¿™è·Ÿandroidä¸­çš„ä¹Ÿæ˜¯å¾ˆç±»ä¼¼</span></strong>ï¼‰</span></p>
<p>TableViewAdapterä»£ç å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('ec009a67-93fe-4bda-989e-4fcd65ed3131')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_ec009a67-93fe-4bda-989e-4fcd65ed3131" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">//</span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">//</span><span style="color: #008000;">  TableViewAdapter.m<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">//</span><span style="color: #008000;">  TabViewTest<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">//</span><br><span style="color: #008080;"> 5</span> <span style="color: #008000;">//</span><span style="color: #008000;">  Created by WANGJIE on 13-10-31.<br></span><span style="color: #008080;"> 6</span> <span style="color: #008000;">//</span><span style="color: #008000;">  Copyright (c) 2013å¹´ WANGJIE. All rights reserved.<br></span><span style="color: #008080;"> 7</span> <span style="color: #008000;">//<br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">#import</span> <span style="color: #800000;">â€œ</span><span style="color: #800000;">TableViewAdapter.h</span><span style="color: #800000;">â€œ</span><br><span style="color: #008080;">10</span> <span style="color: #0000ff;">#import</span> <span style="color: #800000;">â€œ</span><span style="color: #800000;">Person.h</span><span style="color: #800000;">â€œ</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">#import</span> <span style="color: #800000;">â€œ</span><span style="color: #800000;">NaviRootController.h</span><span style="color: #800000;">â€œ</span><br><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> <span style="color: #0000ff;">@implementation</span><span style="color: #000000;"> TableViewAdapter<br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> - (<span style="color: #0000ff;">id</span>)initWithSource:(NSMutableArray <em>)source Controller:(NaviRootController </em><span style="color: #000000;">)context<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">17</span>     NSLog(<span style="color: #800000;">@â€</span><span style="color: #800000;">initWithSourceâ€¦</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">);<br></span><span style="color: #008080;">18</span>     self =<span style="color: #000000;"> [super init];<br></span><span style="color: #008080;">19</span>     <span style="color: #0000ff;">if</span><span style="color: #000000;"> (self) {<br></span><span style="color: #008080;">20</span>         data =<span style="color: #000000;"> source;<br></span><span style="color: #008080;">21</span>         controller =<span style="color: #000000;"> context;<br></span><span style="color: #008080;">22</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">23</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> self;<br></span><span style="color: #008080;">24</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">25</span><br><span style="color: #008080;">26</span> - (NSInteger)tableView:(UITableView <em><span style="color: #000000;">)tableView numberOfRowsInSection:(NSInteger)section<br></span><span style="color: #008080;">27</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> [data count];<br></span><span style="color: #008080;">30</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">31</span><br><span style="color: #008080;">32</span> - (UITableViewCell </em>)tableView:(UITableView <em>)tableView cellForRowAtIndexPath:(NSIndexPath </em><span style="color: #000000;">)indexPath<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">34</span>     NSLog(<span style="color: #800000;">@â€</span><span style="color: #800000;">%@</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">, NSStringFromSelector(_cmd));<br></span><span style="color: #008080;">35</span> <span style="color: #008000;">//</span><span style="color: #008000;">    UITableViewCell <em>cell = [tableView dequeueReusableCellWithIdentifier:@â€UITableViewCellâ€];<br></em></span><span style="color: #008080;">36</span> <span style="color: #008000;">//</span><span style="color: #008000;">    if (!cell) {<br></span><span style="color: #008080;">37</span> <span style="color: #008000;">//</span><span style="color: #008000;">        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@â€UITableViewCellâ€];<br></span><span style="color: #008080;">38</span> <span style="color: #008000;">//</span><span style="color: #008000;">    }<br></span><span style="color: #008080;">39</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> è·å¾—å½“å‰è¦æ˜¾ç¤ºçš„æ•°æ®</span><br><span style="color: #008080;">40</span>     Person p =<span style="color: #000000;"> [data objectAtIndex:[indexPath row]];<br></span><span style="color: #008080;">41</span> <span style="color: #008000;">//</span><br><span style="color: #008080;">42</span> <span style="color: #008000;">//</span><span style="color: #008000;">    [[cell textLabel] setText:[p name]];<br></span><span style="color: #008080;">43</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> è®°å¾—åœ¨cell.xibæ–‡ä»¶ä¸­è®¾ç½®identifierä»¥è¾¾åˆ°é‡ç”¨çš„ç›®çš„</span><br><span style="color: #008080;">44</span>     UITableViewCell <em>cell = [tableView dequeueReusableCellWithIdentifier:<span style="color: #800000;">@â€</span><span style="color: #800000;">MyTableCell</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">];<br></span><span style="color: #008080;">45</span>     <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">cell) {<br></span><span style="color: #008080;">46</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> é€šè¿‡mainBundleçš„loadNibNamedæ–¹æ³•å»åŠ è½½å¸ƒå±€ï¼Œç±»ä¼¼androidä¸­çš„LayoutInflater.inflate()æ–¹æ³•</span><br><span style="color: #008080;">47</span>         NSArray </em>nibViews = [[NSBundle mainBundle] loadNibNamed:<span style="color: #800000;">@â€</span><span style="color: #800000;">table_cell</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> owner:self options:nil];<br></span><span style="color: #008080;">48</span>         cell = [nibViews objectAtIndex:<span style="color: #800080;">0</span><span style="color: #000000;">];<br></span><span style="color: #008080;">49</span> <span style="color: #008000;">//</span><span style="color: #008000;">        cell.selectionStyle = UITableViewCellSelectionStyleNone;</span><br><span style="color: #008080;">50</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">51</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> é€šè¿‡åœ¨cell.xibä¸­å„æ§ä»¶è®¾ç½®çš„tagæ¥è·å¾—æ§ä»¶ï¼Œç±»ä¼¼androidä¸­çš„findViewByTag/findViewById</span><br><span style="color: #008080;">52</span>     UIImageView <em>picIv = (UIImageView </em>)[cell viewWithTag:<span style="color: #800080;">1</span><span style="color: #000000;">];<br></span><span style="color: #008080;">53</span>     UILabel <em>nameLb = (UILabel </em>)[cell viewWithTag:<span style="color: #800080;">2</span><span style="color: #000000;">];<br></span><span style="color: #008080;">54</span>     UILabel <em>ageLb = (UILabel </em>)[cell viewWithTag:<span style="color: #800080;">3</span><span style="color: #000000;">];<br></span><span style="color: #008080;">55</span><br><span style="color: #008080;">56</span> <span style="color: #000000;">    [nameLb setText:[p name]];<br></span><span style="color: #008080;">57</span>     [ageLb setText:[NSString stringWithFormat:<span style="color: #800000;">@â€</span><span style="color: #800000;">%d</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">, [p age]]];<br></span><span style="color: #008080;">58</span> <span style="color: #000000;">    [picIv setImage:[p pic]];<br></span><span style="color: #008080;">59</span><br><span style="color: #008080;">60</span><br><span style="color: #008080;">61</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> cell;<br></span><span style="color: #008080;">62</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">63</span><br><span style="color: #008080;">64</span><br><span style="color: #008080;">65</span> - (<span style="color: #0000ff;">void</span>)tableView:(UITableView <em>)tableView didSelectRowAtIndexPath:(NSIndexPath </em><span style="color: #000000;">)indexPath<br></span><span style="color: #008080;">66</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">67</span>     Person <em>person =<span style="color: #000000;"> [data objectAtIndex:[indexPath row]];<br></span><span style="color: #008080;">68</span>     UIAlertView </em>alert = [[UIAlertView alloc] initWithTitle:<span style="color: #800000;">@â€</span><span style="color: #800000;">cell clicked!</span><span style="color: #800000;">â€œ</span> message:[NSString stringWithFormat:<span style="color: #800000;">@â€</span><span style="color: #800000;">%@ clicked!</span><span style="color: #800000;">â€œ</span>, [person name]]<span style="color: #0000ff;">delegate</span>:self cancelButtonTitle:<span style="color: #800000;">@â€</span><span style="color: #800000;">cancel</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> otherButtonTitles:nil, nil];<br></span><span style="color: #008080;">69</span> <span style="color: #000000;">    [alert show];<br></span><span style="color: #008080;">70</span><br><span style="color: #008080;">71</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">72</span><br><span style="color: #008080;">73</span> - (CGFloat)tableView:(UITableView <em>)tableView heightForRowAtIndexPath:(NSIndexPath </em><span style="color: #000000;">)indexPath<br></span><span style="color: #008080;">74</span> <span style="color: #000000;">{<br></span><span style="color: #008080;">75</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> [self tableView:tableView cellForRowAtIndexPath:indexPath].frame.size.height;<br></span><span style="color: #008080;">76</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">77</span><br><span style="color: #008080;">78</span><br><span style="color: #008080;">79</span> <span style="color: #0000ff;">@end</span></pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>&nbsp;</p>
<p>å¥½äº†ï¼åˆ°æ­¤ä¸ºæ­¢æ•´ä¸ªUITableViewå®ç°çš„æµç¨‹åŸºæœ¬å®Œæˆäº†ï¼Œå¯ä»¥çœ‹å‡ºè·Ÿandroidçš„ListViewå’ŒGridViewçš„å®ç°æµç¨‹å¾ˆç›¸ä¼¼ï¼Œç†è§£äº†å…¶ä¸­ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªä¹Ÿèƒ½å¾ˆå¥½çš„ç†è§£å®ƒçš„å·¥ä½œæµç¨‹ã€‚</p>
<p>æœ€åæ¥ä¸€å¼ æ•ˆæœå›¾ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201311/02030600-2d2805ccefc04db9b4e0085845980d43.png" alt=""></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> iOS </tag>
            
            <tag> UITableView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android NDKç¯å¢ƒæ­å»ºåŠè°ƒç”¨JNIçš„ç®€å•æ­¥éª¤]]></title>
      <url>/2013/10/30/Android-NDK%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%8F%8A%E8%B0%83%E7%94%A8JNI%E7%9A%84%E7%AE%80%E5%8D%95%E6%AD%A5%E9%AA%A4/</url>
      <content type="html"><![CDATA[<p><span>Java Native Interface (JNI)æ ‡å‡†æ˜¯javaå¹³å°çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå…è®¸Javaä»£ç å’Œå…¶ä»–è¯­è¨€å†™çš„ä»£ç è¿›è¡Œäº¤äº’ã€‚JNI æ˜¯æœ¬åœ°ç¼–ç¨‹æ¥å£ï¼Œå®ƒä½¿å¾—åœ¨ Java è™šæ‹Ÿæœº (VM) å†…éƒ¨è¿è¡Œçš„ Java ä»£ç èƒ½å¤Ÿä¸ç”¨å…¶å®ƒç¼–ç¨‹è¯­è¨€(å¦‚ Cã€C++ å’Œæ±‡ç¼–è¯­è¨€)ç¼–å†™çš„åº”ç”¨ç¨‹åºå’Œåº“è¿›è¡Œäº¤äº’æ“ä½œã€‚</span></p>
<p>1. ä¸‹è½½NDKï¼ˆ<a href="http://developer.android.com/tools/sdk/ndk/index.html" target="_blank" rel="noopener">http://developer.android.com/tools/sdk/ndk/index.html</a>ï¼‰ï¼Œå¹¶è§£å‹ï¼Œé…ç½®Pathè·¯å¾„</p>
<p>&nbsp;</p>
<p>2. åœ¨é¡¹ç›®ä¸­æ–°å»ºä¸€ä¸ªåä¸ºjniçš„æ–‡ä»¶å¤¹ï¼Œåœ¨jniä¸­æ–°å¢Android.mkæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="cnblogs_Highlighter"><br><pre class="brush:html;gutter:false;">LOCAL_PATH := $(call my-dir)<br>include $(CLEAR_VARS)<br>LOCAL_MODULE    := PhotoUtil<br>LOCAL_SRC_FILES := PhotoUtil.c<br>LOCAL_LDLIBS    := -llog -ljnigraphics<br>include $(BUILD_SHARED_LIBRARY)<br></pre><br></div>

<p><span>LOCAL_MODULEï¼šå½“å‰æ¨¡å—çš„åç§°</span></p>
<p><span><span>LOCAL_SHARED_LIBRARIESï¼šå½“å‰æ¨¡å—éœ€è¦ä¾èµ–çš„å…±äº«åº“ã€‚&nbsp;</span></span></p>
<p><span><span>LOCAL_SRC_FILESï¼šæ‰€è¦è°ƒç”¨çš„Cæºç </span></span></p>
<p>&nbsp;</p>
<p><span><span>3. æŠŠPhotoUtil.cæ–‡ä»¶å¤åˆ¶åˆ°jniç›®å½•ä¸‹</span></span></p>
<p><span><span>PhotoUtil.cï¼ŒåŒ…å«ä¸€ä¸ªå›¾ç‰‡å¤„ç†æ–¹æ³•ï¼š</span></span></p>
<div class="cnblogs_code"><br><pre>JNIEXPORT <span style="color: #0000ff;">void</span> JNICALL Java_com_wangjie_customviews_PicturesDialog_functionToBlur(JNIEnv*<span style="color: #000000;"> env, jobject obj, jobject bitmapIn, jobject bitmapOut, jint radius) {<br>    &hellip;&hellip;<br>}</span></pre><br></div>

<p>æ–¹æ³•Java_com_wangjie_customviews_PicturesDialog_functionToBlurçš„å–åæ–¹å¼ï¼š</p>
<p>Java_ï¼šå›ºå®š<br>com_wangjie_customviewsï¼šjavaåŒ…å<br>PicturesDialogï¼šjavaç±»å<br>functionToBlurï¼šjavaä½¿ç”¨çš„æ–¹æ³•å</p>
<p>&nbsp;</p>
<p>4. ç¼–è¯‘Cæºç ï¼Œç”Ÿäº§soåº“æ–‡ä»¶</p>
<p>è¿›å…¥jniç›®å½•ï¼š</p>
<p>ndk-build æˆ–è€…</p>
<p><span>ndk-build&nbsp;APP_PLATFORM=android-8</span></p>
<div class="cnblogs_Highlighter"><br><pre class="brush:html;gutter:true;">â€œCompile thumb : PhotoUtil &lt;= PhotoUtil.c<br>SharedLibrary  : libPhotoUtil.so<br>Install        : libPhotoUtil.so =&gt; libs/armeabi/libPhotoUtil.so</pre><br></div>

<p><span>æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œandroidé¡¹ç›®çš„libsç›®å½•ä¸‹å°±ä¼šç”Ÿæˆsoæ–‡ä»¶ï¼š</span></p>
<p><span>\libs\armeabi\libPhotoUtil.so</span></p>
<p><span><span>5. åœ¨androidä¸­javaä»£ç è°ƒç”¨ï¼š</span></span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">static</span><span style="color: #000000;">{<br>      System.loadLibrary(</span>â€œPhotoUtilâ€<span style="color: #000000;">);<br>}</span></pre><br></div>

<p>åŠ è½½photoUtilåº“ï¼ˆlibPhotoUtil.soï¼‰</p>
<p>å¹¶æ·»åŠ ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">native</span> <span style="color: #0000ff;">void</span> functionToBlur(Bitmap bitmapIn, Bitmap bitmapOut, <span style="color: #0000ff;">int</span> radius);</pre><br></div>

<p>ç„¶ååœ¨å…¶ä»–åœ°æ–¹åªéœ€è¦è°ƒç”¨è¯¥functionToBlur()æ–¹æ³•å³å¯ï¼š</p>
<div class="cnblogs_code"><br><pre>functionToBlur(bgBitmap, bitmapOut, 50);</pre><br></div>

<p>&nbsp;</p>
<p>å‚è€ƒï¼š</p>
<p><a href="http://www.ibm.com/developerworks/opensource/tutorials/os-androidndk/section5.html" target="_blank" rel="noopener">http://www.ibm.com/developerworks/opensource/tutorials/os-androidndk/section5.html</a></p>
<p><a href="http://developer.android.com/tools/sdk/ndk/index.html#Installing" target="_blank" rel="noopener">http://developer.android.com/tools/sdk/ndk/index.html#Installing</a></p>
<p><a href="http://stackoverflow.com/questions/2067955/fast-bitmap-blur-for-android-sdk" target="_blank" rel="noopener">http://stackoverflow.com/questions/2067955/fast-bitmap-blur-for-android-sdk</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ndk </tag>
            
            <tag> jni </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidä½¿ç”¨Fragmentæ¥å®ç°ViewPagerçš„åŠŸèƒ½ï¼ˆè§£å†³åˆ‡æ¢FragmentçŠ¶æ€ä¸ä¿å­˜ï¼‰ä»¥åŠå„ä¸ªFragmentä¹‹é—´çš„é€šä¿¡]]></title>
      <url>/2013/10/12/Android%E4%BD%BF%E7%94%A8Fragment%E6%9D%A5%E5%AE%9E%E7%8E%B0ViewPager%E7%9A%84%E5%8A%9F%E8%83%BD%EF%BC%88%E8%A7%A3%E5%86%B3%E5%88%87%E6%8D%A2Fragment%E7%8A%B6%E6%80%81%E4%B8%8D%E4%BF%9D%E5%AD%98%EF%BC%89%E4%BB%A5%E5%8F%8A%E5%90%84%E4%B8%AAFragment%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/</url>
      <content type="html"><![CDATA[<p>æˆ‘å‰ä¸¤å¤©å†™è¿‡ä¸€ç¯‡åšå®¢ã€ŠAndroidä½¿ç”¨Fragmentæ¥å®ç°TabHostçš„åŠŸèƒ½ï¼ˆè§£å†³åˆ‡æ¢FragmentçŠ¶æ€ä¸ä¿å­˜ï¼‰ä»¥åŠå„ä¸ªFragmentä¹‹é—´çš„é€šä¿¡ã€‹ï¼ˆ<a href="http://www.cnblogs.com/tiantianbyconan/p/3360938.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/p/3360938.html</a>ï¼‰ï¼Œå®ç°äº†Tabåˆ‡æ¢æ—¶ä¿ç•™å½“å‰FragmentçŠ¶æ€ï¼Œå¹¶åœ¨åˆ‡æ¢å‰è‡ªåŠ¨å›è°ƒonPause()æ–¹æ³•ï¼Œåœ¨åˆ‡æ¢åè‡ªåŠ¨è°ƒç”¨onResume()ï¼Œè¿™æ ·å°±åšåˆ°äº†è·ŸTahHostä¸€æ ·çš„åŠŸèƒ½ã€‚</p>
<p>ä»Šå¤©æ¥å®ç°ä¸‹ViewPagerçš„åŠŸèƒ½ï¼Œgoogleæä¾›äº†ä¸€ä¸ªFragmentPagerAdapterè¿™ä¹ˆä¸€ä¸ªé€‚é…å™¨ï¼Œè›‹ç–¼çš„æ˜¯ï¼Œç¢°åˆ°äº†è·Ÿä¸Šæ¬¡ç±»ä¼¼çš„é—®é¢˜ã€‚æ¯”å¦‚ViewPageræœ‰5ä¸ªpageï¼Œåˆšæ‰“å¼€çš„æ—¶å€™ï¼Œä¼šåŠ è½½page1å’Œpage2ï¼Œæˆ‘ä»¬æ‰‹åŠ¨åˆ‡æ¢åˆ°page2çš„æ—¶å€™ï¼Œä¼šåŠ è½½page3ï¼Œåˆ‡æ¢åˆ°page3çš„æ—¶å€™ï¼ŒåŠ è½½page4çš„åŒæ—¶ä¼šdestoryæ‰page1ï¼Œæ‰€ä»¥ï¼Œè¿˜æ˜¯é¢ä¸´åŒæ ·çš„é—®é¢˜ï¼Œpageçš„çŠ¶æ€æ— æ³•ä¿å­˜ï¼Œäºæ˜¯ï¼Œå’±è¿˜æ˜¯è‡ªå·±æ¥å®ç°ä¸‹å¥½äº†ï¼Œè‡ªå·±åŠ¨æ‰‹ï¼Œä¸°è¡£è¶³é£Ÿå˜›ï¼ï¼ˆåŒæ ·&nbsp;<span>æœ‰æœ‹å‹çŸ¥é“è§£å†³åŠæ³•çš„è¯ï¼Œå¸Œæœ›è”ç³»æˆ‘ï¼Œèµæ•™ä¸‹å“ˆ</span>ï¼‰</p>
<p>å…ˆæ¥çœ‹ä¸‹æ•´ä¸ªdemoçš„ç»“æ„ï¼Œè·Ÿä¸Šæ¬¡å®ç°TabHostçš„ä¾‹å­å·®ä¸å¤šï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201310/12093410-5a0bb7a1077d4614898ce8b0fbb85d07.jpg" alt=""></p>
<p><span>TabAFmåˆ°TabEFméƒ½æ˜¯Fragmentï¼Œå¹¶ä¸”æ¯ä¸ªFragmentå¯¹åº”ä¸€ä¸ªå¸ƒå±€æ–‡ä»¶ã€‚</span></p>
<p><span><span>TabAFm.javaï¼š</span></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('9a8422d4-8368-43fb-ba86-2c66b20d04f0')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_9a8422d4-8368-43fb-ba86-2c66b20d04f0" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.fragmentviewpagertest;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.app.Activity;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.Bundle;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.Fragment;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.LayoutInflater;<br></span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br></span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.ViewGroup;<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">11</span> <span style="color: #008000;">  Created with IntelliJ IDEA.<br></span><span style="color: #008080;">12</span> <span style="color: #008000;"> <em> Author: wangjie  email:tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;">13</span> <span style="color: #008000;">  Date: 13-6-14<br></span><span style="color: #008080;">14</span> <span style="color: #008000;"> <em> Time: ä¸‹åˆ2:39<br></em></span><span style="color: #008080;">15</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;">16</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TabAFm <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Fragment{<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">18</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onAttach(Activity activity) {<br></span><span style="color: #008080;">19</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onAttach(activity);<br></span><span style="color: #008080;">20</span>         System.out.println(â€œAAAAAAAAAA<strong><strong>onAttachâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">21</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">24</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br></span><span style="color: #008080;">25</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br></span><span style="color: #008080;">26</span>         System.out.println(â€œAAAAAAAAAA</strong></strong>onCreateâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">27</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">30</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {<br></span><span style="color: #008080;">31</span>         System.out.println(â€œAAAAAAAAAA<strong><strong>onCreateViewâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">32</span>         <span style="color: #0000ff;">return</span> inflater.inflate(R.layout.tab_a, container, <span style="color: #0000ff;">false</span><span style="color: #000000;">);<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">34</span><br><span style="color: #008080;">35</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">36</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onActivityCreated(Bundle savedInstanceState) {<br></span><span style="color: #008080;">37</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onActivityCreated(savedInstanceState);<br></span><span style="color: #008080;">38</span>         System.out.println(â€œAAAAAAAAAA</strong></strong>onActivityCreatedâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">39</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">42</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onStart() {<br></span><span style="color: #008080;">43</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onStart();<br></span><span style="color: #008080;">44</span>         System.out.println(â€œAAAAAAAAAA<strong><strong>onStartâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">48</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onResume() {<br></span><span style="color: #008080;">49</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onResume();<br></span><span style="color: #008080;">50</span>         System.out.println(â€œAAAAAAAAAA</strong></strong>onResumeâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">51</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">52</span><br><span style="color: #008080;">53</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">54</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onPause() {<br></span><span style="color: #008080;">55</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onPause();<br></span><span style="color: #008080;">56</span>         System.out.println(â€œAAAAAAAAAA<strong><strong>onPauseâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">57</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">58</span><br><span style="color: #008080;">59</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">60</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onStop() {<br></span><span style="color: #008080;">61</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onStop();<br></span><span style="color: #008080;">62</span>         System.out.println(â€œAAAAAAAAAA</strong></strong>onStopâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">63</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">64</span><br><span style="color: #008080;">65</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">66</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDestroyView() {<br></span><span style="color: #008080;">67</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onDestroyView();<br></span><span style="color: #008080;">68</span>         System.out.println(â€œAAAAAAAAAA<strong><strong>onDestroyViewâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">69</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">70</span><br><span style="color: #008080;">71</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">72</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDestroy() {<br></span><span style="color: #008080;">73</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onDestroy();<br></span><span style="color: #008080;">74</span>         System.out.println(â€œAAAAAAAAAA</strong></strong>onDestroyâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">75</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">76</span><br><span style="color: #008080;">77</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">78</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDetach() {<br></span><span style="color: #008080;">79</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onDetach();<br></span><span style="color: #008080;">80</span>         System.out.println(â€œAAAAAAAAAA____onDetachâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">81</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">82</span> }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>å¦‚ä¸Šè¿°ä»£ç æ‰€ç¤ºï¼ŒTabAFmæ˜¯ä¸€ä¸ªFragmentï¼Œå¯¹åº”çš„å¸ƒå±€æ–‡ä»¶æ˜¯tab_a.xmlï¼Œå¹¶å®ç°äº†ä»–çš„æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°å¹¶æ‰“å°ï¼Œä¾¿äºè°ƒè¯•</p>
<p>tab_a.xmlå¸ƒå±€ä¸­æœ‰ä¸ªEditText</p>
<p>å…¶ä»–çš„Fragmentå¤§åŒå°å¼‚ï¼Œè¿™é‡Œå°±ä¸è´´å‡ºä»£ç äº†</p>
<p>&nbsp;</p>
<p><span>ç°åœ¨æ¥çœ‹MainActivityï¼š</span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('dbc347d7-5a93-47e3-90cc-e45cae3803c7')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_dbc347d7-5a93-47e3-90cc-e45cae3803c7" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.fragmentviewpagertest;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.Bundle;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.Fragment;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.FragmentActivity;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.view.ViewPager;<br></span><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.ArrayList;<br></span><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> FragmentActivity {<br></span><span style="color: #008080;">12</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> ViewPager viewPager;<br></span><span style="color: #008080;">13</span>     <span style="color: #0000ff;">public</span> List&lt;Fragment&gt; fragments = <span style="color: #0000ff;">new</span> ArrayList&lt;Fragment&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">14</span>     <span style="color: #0000ff;">public</span> String hello = â€œhello â€œ<span style="color: #000000;">;<br></span><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br></span><span style="color: #008080;">18</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">        setContentView(R.layout.main);<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>         fragments.add(<span style="color: #0000ff;">new</span><span style="color: #000000;"> TabAFm());<br></span><span style="color: #008080;">22</span>         fragments.add(<span style="color: #0000ff;">new</span><span style="color: #000000;"> TabBFm());<br></span><span style="color: #008080;">23</span>         fragments.add(<span style="color: #0000ff;">new</span><span style="color: #000000;"> TabCFm());<br></span><span style="color: #008080;">24</span>         fragments.add(<span style="color: #0000ff;">new</span><span style="color: #000000;"> TabDFm());<br></span><span style="color: #008080;">25</span>         fragments.add(<span style="color: #0000ff;">new</span><span style="color: #000000;"> TabEFm());<br></span><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span>         viewPager =<span style="color: #000000;"> (ViewPager) findViewById(R.id.viewPager);<br></span><span style="color: #008080;">28</span>         FragmentViewPagerAdapter adapter = <span style="color: #0000ff;">new</span> FragmentViewPagerAdapter(<span style="color: #0000ff;">this</span><span style="color: #000000;">.getSupportFragmentManager(), viewPager,fragments);<br></span><span style="color: #008080;">29</span>         adapter.setOnExtraPageChangeListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> FragmentViewPagerAdapter.OnExtraPageChangeListener(){<br></span><span style="color: #008080;">30</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">31</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onExtraPageSelected(<span style="color: #0000ff;">int</span><span style="color: #000000;"> i) {<br></span><span style="color: #008080;">32</span>                 System.out.println(â€œExtraâ€¦i: â€œ +<span style="color: #000000;"> i);<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">34</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">35</span><br><span style="color: #008080;">36</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">37</span><br><span style="color: #008080;">38</span> }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>MainActivityä¸Šè¿°ä»£ç æ‰€ç¤º</p>
<p>MainActivityæ˜¯åŒ…å«Fragmentçš„Activityï¼ˆä¹Ÿå°±æ˜¯è¿™é‡Œçš„5ä¸ªFragmentï¼‰</p>
<p>ä»–ç»§æ‰¿äº†FragmentActivityï¼ˆå› ä¸ºæˆ‘è¿™é‡Œç”¨çš„æ˜¯android-support-v4.jarï¼‰</p>
<p>ç”¨ä¸€ä¸ªList&lt;Fragment&gt;å»ç»´æŠ¤5ä¸ªFragmentï¼Œä¹Ÿå°±æ˜¯5ä¸ªpageã€‚</p>
<p>MainActivityçš„å¸ƒå±€å¾ˆç®€å•ï¼Œå°±ä¸€ä¸ªViewPagerï¼Œmain.xmlå¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('0e611c66-2fd1-4dc0-9690-f0b0cbcacee6')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_0e611c66-2fd1-4dc0-9690-f0b0cbcacee6" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><br><span style="color: #008080;"> 3</span> <span style="color: #ff0000;">              android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><br><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">              android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">              android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;"> 6</span>         <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">android.support.v4.view.ViewPager<br></span><span style="color: #008080;"> 8</span>         <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/viewPagerâ€</span><br><span style="color: #008080;"> 9</span> <span style="color: #ff0000;">        android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">10</span> <span style="color: #ff0000;">        android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><br><span style="color: #008080;">11</span>         <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span></pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>&nbsp;</p>
<p><span>ç°åœ¨å›åˆ°MainActivityä¸­ï¼Œä¸‹é¢è¿™ä¸ªFragmentViewPagerAdapterç±»æ˜¯å…³é”®ï¼Œæ˜¯æˆ‘è‡ªå·±ç¼–å†™çš„ç”¨äºç»‘å®šå’Œå¤„ç†fragmentså’ŒViewPagerä¹‹é—´çš„é€»è¾‘å…³ç³»</span></p>
<div class="cnblogs_code"><br><pre>FragmentViewPagerAdapter adapter = <span style="color: #0000ff;">new</span> FragmentViewPagerAdapter(<span style="color: #0000ff;">this</span>.getSupportFragmentManager(), viewPager,fragments);</pre><br></div>

<p>&nbsp;</p>
<p><span>ç°åœ¨çœ‹ä¸‹FragmentViewPagerAdapterï¼š</span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('f1a422a5-1bf1-44e2-9205-f1cf67fe1843')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_f1a422a5-1bf1-44e2-9205-f1cf67fe1843" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.fragmentviewpagertest;<br></span><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.Fragment;<br></span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.FragmentManager;<br></span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.FragmentTransaction;<br></span><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.view.PagerAdapter;<br></span><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.view.ViewPager;<br></span><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br></span><span style="color: #008080;">  9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.ViewGroup;<br></span><span style="color: #008080;"> 10</span><br><span style="color: #008080;"> 11</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br></span><span style="color: #008080;"> 12</span><br><span style="color: #008080;"> 13</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 14</span> <span style="color: #008000;"> <em> ä¸ºViewPageræ·»åŠ å¸ƒå±€ï¼ˆFragmentï¼‰ï¼Œç»‘å®šå’Œå¤„ç†fragmentså’Œviewpagerä¹‹é—´çš„é€»è¾‘å…³ç³»<br></em></span><span style="color: #008080;"> 15</span> <span style="color: #008000;"> <br></span><span style="color: #008080;"> 16</span> <span style="color: #008000;"> <em> Created with IntelliJ IDEA.<br></em></span><span style="color: #008080;"> 17</span> <span style="color: #008000;">  Author: wangjie  email:tiantian.china.2@gmail.com<br></span><span style="color: #008080;"> 18</span> <span style="color: #008000;"> <em> Date: 13-10-11<br></em></span><span style="color: #008080;"> 19</span> <span style="color: #008000;">  Time: ä¸‹åˆ3:03<br></span><span style="color: #008080;"> 20</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 21</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> FragmentViewPagerAdapter <span style="color: #0000ff;">extends</span> PagerAdapter <span style="color: #0000ff;">implements</span><span style="color: #000000;"> ViewPager.OnPageChangeListener{<br></span><span style="color: #008080;"> 22</span>     <span style="color: #0000ff;">private</span> List&lt;Fragment&gt; fragments; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯ä¸ªFragmentå¯¹åº”ä¸€ä¸ªPage</span><br><span style="color: #008080;"> 23</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> FragmentManager fragmentManager;<br></span><span style="color: #008080;"> 24</span>     <span style="color: #0000ff;">private</span> ViewPager viewPager; <span style="color: #008000;">//</span><span style="color: #008000;"> viewPagerå¯¹è±¡</span><br><span style="color: #008080;"> 25</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> currentPageIndex = 0; <span style="color: #008000;">//</span><span style="color: #008000;"> å½“å‰pageç´¢å¼•ï¼ˆåˆ‡æ¢ä¹‹å‰ï¼‰</span><br><span style="color: #008080;"> 26</span><br><span style="color: #008080;"> 27</span>     <span style="color: #0000ff;">private</span> OnExtraPageChangeListener onExtraPageChangeListener; <span style="color: #008000;">//</span><span style="color: #008000;"> ViewPageråˆ‡æ¢é¡µé¢æ—¶çš„é¢å¤–åŠŸèƒ½æ·»åŠ æ¥å£</span><br><span style="color: #008080;"> 28</span><br><span style="color: #008080;"> 29</span>     <span style="color: #0000ff;">public</span> FragmentViewPagerAdapter(FragmentManager fragmentManager, ViewPager viewPager , List&lt;Fragment&gt;<span style="color: #000000;"> fragments) {<br></span><span style="color: #008080;"> 30</span>         <span style="color: #0000ff;">this</span>.fragments =<span style="color: #000000;"> fragments;<br></span><span style="color: #008080;"> 31</span>         <span style="color: #0000ff;">this</span>.fragmentManager =<span style="color: #000000;"> fragmentManager;<br></span><span style="color: #008080;"> 32</span>         <span style="color: #0000ff;">this</span>.viewPager =<span style="color: #000000;"> viewPager;<br></span><span style="color: #008080;"> 33</span>         <span style="color: #0000ff;">this</span>.viewPager.setAdapter(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 34</span>         <span style="color: #0000ff;">this</span>.viewPager.setOnPageChangeListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 35</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 36</span><br><span style="color: #008080;"> 37</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 38</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getCount() {<br></span><span style="color: #008080;"> 39</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> fragments.size();<br></span><span style="color: #008080;"> 40</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 41</span><br><span style="color: #008080;"> 42</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 43</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isViewFromObject(View view, Object o) {<br></span><span style="color: #008080;"> 44</span>         <span style="color: #0000ff;">return</span> view ==<span style="color: #000000;"> o;<br></span><span style="color: #008080;"> 45</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 46</span><br><span style="color: #008080;"> 47</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 48</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> destroyItem(ViewGroup container, <span style="color: #0000ff;">int</span><span style="color: #000000;"> position, Object object) {<br></span><span style="color: #008080;"> 49</span>         container.removeView(fragments.get(position).getView()); <span style="color: #008000;">//</span><span style="color: #008000;"> ç§»å‡ºviewpagerä¸¤è¾¹ä¹‹å¤–çš„pageå¸ƒå±€</span><br><span style="color: #008080;"> 50</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 51</span><br><span style="color: #008080;"> 52</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 53</span>     <span style="color: #0000ff;">public</span> Object instantiateItem(ViewGroup container, <span style="color: #0000ff;">int</span><span style="color: #000000;"> position) {<br></span><span style="color: #008080;"> 54</span>         Fragment fragment =<span style="color: #000000;"> fragments.get(position);<br></span><span style="color: #008080;"> 55</span>         <span style="color: #0000ff;">if</span>(!fragment.isAdded()){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœfragmentè¿˜æ²¡æœ‰added</span><br><span style="color: #008080;"> 56</span>             FragmentTransaction ft =<span style="color: #000000;"> fragmentManager.beginTransaction();<br></span><span style="color: #008080;"> 57</span> <span style="color: #000000;">            ft.add(fragment, fragment.getClass().getSimpleName());<br></span><span style="color: #008080;"> 58</span> <span style="color: #000000;">            ft.commit();<br></span><span style="color: #008080;"> 59</span>             <span style="color: #008000;">/</span><br><span style="color: #008080;"> 60</span> <span style="color: #008000;">             <em> åœ¨ç”¨FragmentTransaction.commit()æ–¹æ³•æäº¤FragmentTransactionå¯¹è±¡å<br></em></span><span style="color: #008080;"> 61</span> <span style="color: #008000;">              ä¼šåœ¨è¿›ç¨‹çš„ä¸»çº¿ç¨‹ä¸­ï¼Œç”¨å¼‚æ­¥çš„æ–¹å¼æ¥æ‰§è¡Œã€‚<br></span><span style="color: #008080;"> 62</span> <span style="color: #008000;">             <em> å¦‚æœæƒ³è¦ç«‹å³æ‰§è¡Œè¿™ä¸ªç­‰å¾…ä¸­çš„æ“ä½œï¼Œå°±è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ˆåªèƒ½åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ï¼‰ã€‚<br></em></span><span style="color: #008080;"> 63</span> <span style="color: #008000;">              è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰€æœ‰çš„å›è°ƒå’Œç›¸å…³çš„è¡Œä¸ºéƒ½ä¼šåœ¨è¿™ä¸ªè°ƒç”¨ä¸­è¢«æ‰§è¡Œå®Œæˆï¼Œå› æ­¤è¦ä»”ç»†ç¡®è®¤è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨ä½ç½®ã€‚<br></span><span style="color: #008080;"> 64</span>              <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 65</span> <span style="color: #000000;">            fragmentManager.executePendingTransactions();<br></span><span style="color: #008080;"> 66</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 67</span><br><span style="color: #008080;"> 68</span>         <span style="color: #0000ff;">if</span>(fragment.getView().getParent() == <span style="color: #0000ff;">null</span><span style="color: #000000;">){<br></span><span style="color: #008080;"> 69</span>             container.addView(fragment.getView()); <span style="color: #008000;">//</span><span style="color: #008000;"> ä¸ºviewpagerå¢åŠ å¸ƒå±€</span><br><span style="color: #008080;"> 70</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 71</span><br><span style="color: #008080;"> 72</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> fragment.getView();<br></span><span style="color: #008080;"> 73</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 74</span><br><span style="color: #008080;"> 75</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 76</span> <span style="color: #008000;">      å½“å‰pageç´¢å¼•ï¼ˆåˆ‡æ¢ä¹‹å‰ï¼‰<br></span><span style="color: #008080;"> 77</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><br><span style="color: #008080;"> 78</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 79</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getCurrentPageIndex() {<br></span><span style="color: #008080;"> 80</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> currentPageIndex;<br></span><span style="color: #008080;"> 81</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 82</span><br><span style="color: #008080;"> 83</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> OnExtraPageChangeListener getOnExtraPageChangeListener() {<br></span><span style="color: #008080;"> 84</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> onExtraPageChangeListener;<br></span><span style="color: #008080;"> 85</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 86</span><br><span style="color: #008080;"> 87</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 88</span> <span style="color: #008000;">     <em> è®¾ç½®é¡µé¢åˆ‡æ¢é¢å¤–åŠŸèƒ½ç›‘å¬å™¨<br></em></span><span style="color: #008080;"> 89</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> onExtraPageChangeListener<br></span><span style="color: #008080;"> 90</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 91</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setOnExtraPageChangeListener(OnExtraPageChangeListener onExtraPageChangeListener) {<br></span><span style="color: #008080;"> 92</span>         <span style="color: #0000ff;">this</span>.onExtraPageChangeListener =<span style="color: #000000;"> onExtraPageChangeListener;<br></span><span style="color: #008080;"> 93</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 94</span><br><span style="color: #008080;"> 95</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 96</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onPageScrolled(<span style="color: #0000ff;">int</span> i, <span style="color: #0000ff;">float</span> v, <span style="color: #0000ff;">int</span><span style="color: #000000;"> i2) {<br></span><span style="color: #008080;"> 97</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> != onExtraPageChangeListener){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœè®¾ç½®äº†é¢å¤–åŠŸèƒ½æ¥å£</span><br><span style="color: #008080;"> 98</span> <span style="color: #000000;">            onExtraPageChangeListener.onExtraPageScrolled(i, v, i2);<br></span><span style="color: #008080;"> 99</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">100</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">101</span><br><span style="color: #008080;">102</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">103</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onPageSelected(<span style="color: #0000ff;">int</span><span style="color: #000000;"> i) {<br></span><span style="color: #008080;">104</span>         fragments.get(currentPageIndex).onPause(); <span style="color: #008000;">//</span><span style="color: #008000;"> è°ƒç”¨åˆ‡æ¢å‰Fargmentçš„onPause()<br></span><span style="color: #008080;">105</span> <span style="color: #008000;">//</span><span style="color: #008000;">        fragments.get(currentPageIndex).onStop(); </span><span style="color: #008000;">//</span><span style="color: #008000;"> è°ƒç”¨åˆ‡æ¢å‰Fargmentçš„onStop()</span><br><span style="color: #008080;">106</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;">(fragments.get(i).isAdded()){<br></span><span style="color: #008080;">107</span> <span style="color: #008000;">//</span><span style="color: #008000;">            fragments.get(i).onStart(); </span><span style="color: #008000;">//</span><span style="color: #008000;"> è°ƒç”¨åˆ‡æ¢åFargmentçš„onStart()</span><br><span style="color: #008080;">108</span>             fragments.get(i).onResume(); <span style="color: #008000;">//</span><span style="color: #008000;"> è°ƒç”¨åˆ‡æ¢åFargmentçš„onResume()</span><br><span style="color: #008080;">109</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">110</span>         currentPageIndex =<span style="color: #000000;"> i;<br></span><span style="color: #008080;">111</span><br><span style="color: #008080;">112</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> != onExtraPageChangeListener){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœè®¾ç½®äº†é¢å¤–åŠŸèƒ½æ¥å£</span><br><span style="color: #008080;">113</span> <span style="color: #000000;">            onExtraPageChangeListener.onExtraPageSelected(i);<br></span><span style="color: #008080;">114</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">115</span><br><span style="color: #008080;">116</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">117</span><br><span style="color: #008080;">118</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">119</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onPageScrollStateChanged(<span style="color: #0000ff;">int</span><span style="color: #000000;"> i) {<br></span><span style="color: #008080;">120</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> != onExtraPageChangeListener){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœè®¾ç½®äº†é¢å¤–åŠŸèƒ½æ¥å£</span><br><span style="color: #008080;">121</span> <span style="color: #000000;">            onExtraPageChangeListener.onExtraPageScrollStateChanged(i);<br></span><span style="color: #008080;">122</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">123</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">124</span><br><span style="color: #008080;">125</span><br><span style="color: #008080;">126</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">127</span> <span style="color: #008000;">     <em> pageåˆ‡æ¢é¢å¤–åŠŸèƒ½æ¥å£<br></em></span><span style="color: #008080;">128</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">129</span>     <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> OnExtraPageChangeListener{<br></span><span style="color: #008080;">130</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onExtraPageScrolled(<span style="color: #0000ff;">int</span> i, <span style="color: #0000ff;">float</span> v, <span style="color: #0000ff;">int</span><span style="color: #000000;"> i2){}<br></span><span style="color: #008080;">131</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onExtraPageSelected(<span style="color: #0000ff;">int</span><span style="color: #000000;"> i){}<br></span><span style="color: #008080;">132</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onExtraPageScrollStateChanged(<span style="color: #0000ff;">int</span><span style="color: #000000;"> i){}<br></span><span style="color: #008080;">133</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">134</span><br><span style="color: #008080;">135</span><br><span style="color: #008080;">136</span> }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p><span>è¿™é‡Œè§£å†³Fragmentåˆ‡æ¢é‡æ–°åŠ è½½å¸ƒå±€çš„åŠæ³•ï¼Œç”¨çš„æ˜¯æŠŠå‡ ä¸ªFragmentå…¨éƒ¨Addï¼Œç„¶åæ ¹æ®è¦æ˜¾ç¤ºçš„å“ªä¸ªFragmentå°±æŠŠå“ªä¸ªFragmentçš„Viewç»™æ·»åŠ åˆ°&ldquo;ViewGroup container&rdquo;ä¸Šå»ã€‚</span></p>
<p><span>æ•ˆæœè¾“å‡ºï¼š</span></p>
<p><span>// ä»¥ä¸‹æ‰“å¼€ç¨‹åºåï¼ŒåŠ è½½PageAå’ŒPageB</span></p>
<p>10-12 09:42:46.671: INFO/System.out(27248): AAAAAAAAAA<strong><strong>onAttach<br>10-12 09:42:46.671: INFO/System.out(27248): AAAAAAAAAA</strong></strong>onCreate<br>10-12 09:42:46.671: INFO/System.out(27248): AAAAAAAAAA<strong><strong>onCreateView<br>10-12 09:42:46.761: INFO/System.out(27248): AAAAAAAAAA</strong></strong>onActivityCreated<br>10-12 09:42:46.765: INFO/System.out(27248): AAAAAAAAAA<strong><strong>onStart<br>10-12 09:42:46.765: INFO/System.out(27248): AAAAAAAAAA</strong></strong>onResume<br>10-12 09:42:46.847: INFO/System.out(27248): BBBBBBBBBBB<strong><strong>onAttach<br>10-12 09:42:46.847: INFO/System.out(27248): BBBBBBBBBBB</strong></strong>onCreate<br>10-12 09:42:46.851: INFO/System.out(27248): BBBBBBBBBBB<strong><strong>onCreateView<br>10-12 09:42:46.867: INFO/System.out(27248): BBBBBBBBBBB</strong></strong>onActivityCreated<br>10-12 09:42:46.867: INFO/System.out(27248): BBBBBBBBBBB<strong><strong>onStart<br>10-12 09:42:46.867: INFO/System.out(27248): BBBBBBBBBBB</strong></strong>onResume</p>
<p>// ä»¥ä¸‹åˆ‡æ¢åˆ°PageB</p>
<p>10-12 09:42:57.285: INFO/System.out(27248): AAAAAAAAAA<strong><strong>onPauseã€€ã€€ã€€ã€€// åˆ‡æ¢åˆ°PageBå‰ä¼šè°ƒç”¨PageAçš„onPause()æ–¹æ³•<br>10-12 09:42:57.285: INFO/System.out(27248): BBBBBBBBBBB</strong></strong>onResumeã€€ã€€// åˆ‡æ¢åˆ°PageBåä¼šè°ƒç”¨PageBçš„onResume()æ–¹æ³•<br>10-12 09:42:57.285: INFO/System.out(27248): Extraâ€¦i: 1ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// åˆ‡æ¢é¡µé¢æ—¶ä¼šè°ƒç”¨åˆ‡æ¢é¢å¤–åŠŸèƒ½æ¥å£ï¼ˆç”¨æˆ·å¯ä»¥è‡ªå·±å†™éœ€è¦çš„é€»è¾‘ï¼‰<br>10-12 09:42:57.582: INFO/System.out(27248): CCCCCCCCCC<strong><strong>onAttachã€€ã€€ã€€ã€€// åˆ‡æ¢åˆ°PageBåä¼šåŠ è½½PageC<br>10-12 09:42:57.586: INFO/System.out(27248): CCCCCCCCCC</strong></strong>onCreate<br>10-12 09:42:57.586: INFO/System.out(27248): CCCCCCCCCC<strong><strong>onCreateView<br>10-12 09:42:57.675: INFO/System.out(27248): CCCCCCCCCC</strong></strong>onActivityCreated<br>10-12 09:42:57.675: INFO/System.out(27248): CCCCCCCCCC<strong><strong>onStart<br>10-12 09:42:57.675: INFO/System.out(27248): CCCCCCCCCC</strong></strong>onResume</p>
<p>// ä»¥ä¸‹åˆ‡æ¢åˆ°PageC</p>
<p>10-12 09:43:18.261: INFO/System.out(27248): BBBBBBBBBBB<strong><strong>onPause&nbsp;ã€€ã€€ã€€ã€€// åˆ‡æ¢åˆ°PageCå‰ä¼šè°ƒç”¨PageBçš„onPause()æ–¹æ³•<br>10-12 09:43:18.261: INFO/System.out(27248): CCCCCCCCCC</strong></strong>onResumeã€€ã€€ã€€ã€€// åˆ‡æ¢åˆ°PageCåä¼šè°ƒç”¨PageCçš„onResume()æ–¹æ³•<br>10-12 09:43:18.261: INFO/System.out(27248): Extraâ€¦i: 2ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// åˆ‡æ¢é¡µé¢æ—¶ä¼šè°ƒç”¨åˆ‡æ¢é¢å¤–åŠŸèƒ½æ¥å£ï¼ˆç”¨æˆ·å¯ä»¥è‡ªå·±å†™éœ€è¦çš„é€»è¾‘ï¼‰<br>10-12 09:43:18.726: INFO/System.out(27248): DDDDDDDDD<strong><strong>onAttachã€€ã€€ã€€ã€€ã€€ã€€// åˆ‡æ¢åˆ°PageCåä¼šåŠ è½½PageD<br>10-12 09:43:18.726: INFO/System.out(27248): DDDDDDDDD</strong></strong>onCreate<br>10-12 09:43:18.726: INFO/System.out(27248): DDDDDDDDD<strong><strong>onCreateView<br>10-12 09:43:18.738: INFO/System.out(27248): DDDDDDDDD</strong></strong>onActivityCreated<br>10-12 09:43:18.738: INFO/System.out(27248): DDDDDDDDD<strong><strong>onStart<br>10-12 09:43:18.742: INFO/System.out(27248): DDDDDDDDD</strong></strong>onResume</p>
<p>// ä»¥ä¸‹åˆ‡æ¢åˆ°PageB<br>10-12 09:43:20.742: INFO/System.out(27248): CCCCCCCCCC<strong><strong>onPauseã€€ã€€ã€€ã€€ã€€ã€€// åˆ‡æ¢åˆ°PageBå‰ä¼šè°ƒç”¨PageCçš„onPause()æ–¹æ³•<br>10-12 09:43:20.742: INFO/System.out(27248): BBBBBBBBBBB</strong></strong>onResumeã€€ã€€ã€€ã€€//&nbsp;åˆ‡æ¢åˆ°PageBåä¼šè°ƒç”¨PageBçš„onResume()æ–¹æ³•<br>10-12 09:43:20.746: INFO/System.out(27248): Extraâ€¦i: 1ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€// åˆ‡æ¢é¡µé¢æ—¶ä¼šè°ƒç”¨åˆ‡æ¢é¢å¤–åŠŸèƒ½æ¥å£ï¼ˆç”¨æˆ·å¯ä»¥è‡ªå·±å†™éœ€è¦çš„é€»è¾‘ï¼‰</p>
<p>&nbsp;</p>
<p>å¥½äº†ï¼Œåˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ç”¨Fragmentå®ç°äº†ViewPagerçš„åŠŸèƒ½äº†ï¼ŒåŒæ ·ï¼Œä¸‹é¢æ¥çœ‹ä¸‹å„ä¸ªFragmentä¹‹é—´çš„é€šä¿¡</p>
<p>ç°åœ¨çš„æƒ…å†µæ˜¯TabAFmä¸­æœ‰ä¸ªEditTextï¼ŒTabBFmä¸­æœ‰ä¸ªButtonï¼ŒMainActivityä¸­æœ‰ä¸ªå˜é‡&ldquo;hello&rdquo;</p>
<p>è¦åšçš„æ˜¯ï¼Œåˆ‡æ¢åˆ°Aï¼Œè¾“å…¥&ldquo;Iâ€™m PageA&rdquo;ï¼Œåˆ‡æ¢åˆ°Bï¼Œç‚¹å‡»Buttonåï¼ŒToastæ˜¾ç¤º&ldquo;hello Iâ€™m PageA&rdquo;</p>
<p>MainActivityä¸­æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±ä¸€ä¸ªhelloå˜é‡ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> String hello = â€œhello â€œ;</pre><br></div>

<p><span>TabBFmä¸­ï¼š</span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('0e5b4cd8-d376-4ab8-aae2-68446bfeb227')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_0e5b4cd8-d376-4ab8-aae2-68446bfeb227" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">@Override<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onActivityCreated(Bundle savedInstanceState) {<br></span><span style="color: #008080;"> 3</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onActivityCreated(savedInstanceState);<br></span><span style="color: #008080;"> 4</span>         System.out.println(â€œBBBBBBBBBBB____onActivityCreatedâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 5</span>         <span style="color: #0000ff;">this</span>.getView().findViewById(R.id.clickme).setOnClickListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> View.OnClickListener() {<br></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClick(View view) {<br></span><span style="color: #008080;"> 8</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> è·å¾—ç»‘å®šçš„FragmentActivity</span><br><span style="color: #008080;"> 9</span>                 MainActivity activity =<span style="color: #000000;"> ((MainActivity)getActivity());<br></span><span style="color: #008080;">10</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> è·å¾—TabAFmçš„æ§ä»¶</span><br><span style="color: #008080;">11</span>                 EditText editText = (EditText) activity.fragments.get(0<span style="color: #000000;">).getView().findViewById(R.id.edit);<br></span><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span>                 Toast.makeText(activity, activity.hello +<span style="color: #000000;"> editText.getText(), Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">16</span>     }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>&nbsp;</p>
<p>æœ€ç»ˆæ•ˆæœå›¾ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201310/12095728-8961829b190244259fb98e23eb7f59b5.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000;"><strong>demoä¸‹è½½ï¼š<a href="http://pan.baidu.com/s/1stGQ7" target="_blank" rel="noopener">http://pan.baidu.com/s/1stGQ7</a></strong></span></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> fragment </tag>
            
            <tag> ViewPager </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidä½¿ç”¨Fragmentæ¥å®ç°TabHostçš„åŠŸèƒ½ï¼ˆè§£å†³åˆ‡æ¢FragmentçŠ¶æ€ä¸ä¿å­˜ï¼‰ä»¥åŠå„ä¸ªFragmentä¹‹é—´çš„é€šä¿¡]]></title>
      <url>/2013/10/10/Android%E4%BD%BF%E7%94%A8Fragment%E6%9D%A5%E5%AE%9E%E7%8E%B0TabHost%E7%9A%84%E5%8A%9F%E8%83%BD%EF%BC%88%E8%A7%A3%E5%86%B3%E5%88%87%E6%8D%A2Fragment%E7%8A%B6%E6%80%81%E4%B8%8D%E4%BF%9D%E5%AD%98%EF%BC%89%E4%BB%A5%E5%8F%8A%E5%90%84%E4%B8%AAFragment%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/</url>
      <content type="html"><![CDATA[<p><img src="http://images.cnitblog.com/blog/378300/201310/10104944-40b5dbc296894475bdaf8914a59d0498.png" alt=""></p>
<p>å¦‚æ–°æµªå¾®åšä¸‹é¢çš„æ ‡ç­¾åˆ‡æ¢åŠŸèƒ½ï¼Œæˆ‘ä»¥å‰ä¹Ÿå†™è¿‡ä¸€ç¯‡åšæ–‡ï¼ˆ<a href="http://www.cnblogs.com/tiantianbyconan/archive/2012/02/24/2366237.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/archive/2012/02/24/2366237.html</a>ï¼‰ï¼Œå¯ä»¥å®ç°ï¼Œç”¨çš„æ˜¯TabHostã€‚ä½†æ˜¯androidå‘å±•æ¯”è¾ƒè¿…é€Ÿï¼ŒTabHostè¿™ç©æ„ç°åœ¨å·²ç»è¢«å¼ƒç”¨äº†ï¼Œè™½è¯´ç”¨ç°åœ¨ä¹Ÿèƒ½ç”¨ï¼Œä½†æ˜¯è¢«å¼ƒç”¨çš„ä¸œè¥¿è¿˜æ˜¯å°‘ç”¨ä¸ºå¦™ã€‚</p>
<p>å®˜æ–¹æœ‰ä¸ªFragmentTabHostè¿™ä¹ˆä¸€ä¸ªæ›¿ä»£å“ï¼Œäºæ˜¯è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°æ¯æ¬¡åˆ‡æ¢tabï¼Œéƒ½ä¼šè°ƒç”¨<span>onCreateView()æ–¹æ³•ï¼Œæ§ä»¶è¢«é‡æ–°åŠ è½½ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ ä»tab1åˆ‡æ¢åˆ°åˆ«çš„tabåï¼Œå†åˆ‡æ¢å›æ¥ï¼Œtab1çš„çŠ¶æ€å¹¶æ²¡æœ‰ä¿å­˜ï¼Œé‡æ–°åŠ è½½äº†æ§ä»¶ã€‚</span></p>
<p><span>æäº†åŠå¤©ï¼Œæš‚æ—¶æ²¡æœ‰å¥½çš„è§£å†³åŠæ³•ï¼ˆæœ‰æœ‹å‹çŸ¥é“è§£å†³åŠæ³•çš„è¯ï¼Œå¸Œæœ›è”ç³»æˆ‘ï¼Œèµæ•™ä¸‹å“ˆï¼‰</span></p>
<p><span style="line-height: 1.5;">äºæ˜¯ï¼Œæ€’äº†ï¼Œè‡ªå·±å®ç°ä¸€ä¸ªå§- -</span></p>
<p>&nbsp;</p>
<p><span style="line-height: 1.5;">å…ˆæ¥çœ‹çœ‹æ•´ä¸ªdemoçš„ç»“æ„ï¼š</span></p>
<p><span style="line-height: 1.5;"><img src="http://images.cnitblog.com/blog/378300/201310/10110710-b8f18222f40441d4b46f9ae54fc2c83f.jpg" alt=""></span></p>
<p><span style="line-height: 1.5;">TabAFmåˆ°TabEFméƒ½æ˜¯Fragmentï¼Œå¹¶ä¸”æ¯ä¸ªFragmentå¯¹åº”ä¸€ä¸ªå¸ƒå±€æ–‡ä»¶ã€‚</span></p>
<p><span style="line-height: 1.5;">TabAFm.javaï¼š</span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('85262c98-765c-40bc-8095-dbdf4707c217')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_85262c98-765c-40bc-8095-dbdf4707c217" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.fragmenttabhost;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.app.Activity;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.Bundle;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.Fragment;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.LayoutInflater;<br></span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br></span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.ViewGroup;<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">11</span> <span style="color: #008000;">  Created with IntelliJ IDEA.<br></span><span style="color: #008080;">12</span> <span style="color: #008000;"> <em> Author: wangjie  email:tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;">13</span> <span style="color: #008000;">  Date: 13-6-14<br></span><span style="color: #008080;">14</span> <span style="color: #008000;"> <em> Time: ä¸‹åˆ2:39<br></em></span><span style="color: #008080;">15</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;">16</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TabAFm <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Fragment{<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">18</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onAttach(Activity activity) {<br></span><span style="color: #008080;">19</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onAttach(activity);<br></span><span style="color: #008080;">20</span>         System.out.println(â€œAAAAAAAAAA<strong><strong>onAttachâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">21</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">24</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br></span><span style="color: #008080;">25</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br></span><span style="color: #008080;">26</span>         System.out.println(â€œAAAAAAAAAA</strong></strong>onCreateâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">27</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">30</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {<br></span><span style="color: #008080;">31</span>         System.out.println(â€œAAAAAAAAAA<strong><strong>onCreateViewâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">32</span>         <span style="color: #0000ff;">return</span> inflater.inflate(R.layout.tab_a, container, <span style="color: #0000ff;">false</span><span style="color: #000000;">);<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">34</span><br><span style="color: #008080;">35</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">36</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onActivityCreated(Bundle savedInstanceState) {<br></span><span style="color: #008080;">37</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onActivityCreated(savedInstanceState);<br></span><span style="color: #008080;">38</span>         System.out.println(â€œAAAAAAAAAA</strong></strong>onActivityCreatedâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">39</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">42</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onStart() {<br></span><span style="color: #008080;">43</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onStart();<br></span><span style="color: #008080;">44</span>         System.out.println(â€œAAAAAAAAAA<strong><strong>onStartâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">48</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onResume() {<br></span><span style="color: #008080;">49</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onResume();<br></span><span style="color: #008080;">50</span>         System.out.println(â€œAAAAAAAAAA</strong></strong>onResumeâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">51</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">52</span><br><span style="color: #008080;">53</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">54</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onPause() {<br></span><span style="color: #008080;">55</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onPause();<br></span><span style="color: #008080;">56</span>         System.out.println(â€œAAAAAAAAAA<strong><strong>onPauseâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">57</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">58</span><br><span style="color: #008080;">59</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">60</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onStop() {<br></span><span style="color: #008080;">61</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onStop();<br></span><span style="color: #008080;">62</span>         System.out.println(â€œAAAAAAAAAA</strong></strong>onStopâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">63</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">64</span><br><span style="color: #008080;">65</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">66</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDestroyView() {<br></span><span style="color: #008080;">67</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onDestroyView();<br></span><span style="color: #008080;">68</span>         System.out.println(â€œAAAAAAAAAA<strong><strong>onDestroyViewâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">69</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">70</span><br><span style="color: #008080;">71</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">72</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDestroy() {<br></span><span style="color: #008080;">73</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onDestroy();<br></span><span style="color: #008080;">74</span>         System.out.println(â€œAAAAAAAAAA</strong></strong>onDestroyâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">75</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">76</span><br><span style="color: #008080;">77</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">78</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDetach() {<br></span><span style="color: #008080;">79</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onDetach();<br></span><span style="color: #008080;">80</span>         System.out.println(â€œAAAAAAAAAA____onDetachâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">81</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">82</span> }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>å¦‚ä¸Šè¿°ä»£ç æ‰€ç¤ºï¼ŒTabAFmæ˜¯ä¸€ä¸ªFragmentï¼Œå¯¹åº”çš„å¸ƒå±€æ–‡ä»¶æ˜¯tab_a.xmlï¼Œå¹¶å®ç°äº†ä»–çš„æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°å¹¶æ‰“å°ï¼Œä¾¿äºè°ƒè¯•</p>
<p>tab_a.xmlå¸ƒå±€ä¸­æœ‰ä¸ªEditText</p>
<p>å…¶ä»–çš„Fragmentå¤§åŒå°å¼‚ï¼Œè¿™é‡Œå°±ä¸è´´å‡ºä»£ç äº†</p>
<p>&nbsp;</p>
<p>ç°åœ¨æ¥çœ‹MainActivityï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('fd8312f8-350d-43e1-95d2-8e9f8c7ec8dc')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_fd8312f8-350d-43e1-95d2-8e9f8c7ec8dc" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.fragmenttabhost;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.Bundle;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.Fragment;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.FragmentActivity;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.RadioGroup;<br></span><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.ArrayList;<br></span><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> FragmentActivity {<br></span><span style="color: #008080;">12</span>     <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">13</span> <span style="color: #008000;">      Called when the activity is first created.<br></span><span style="color: #008080;">14</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">15</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> RadioGroup rgs;<br></span><span style="color: #008080;">16</span>     <span style="color: #0000ff;">public</span> List&lt;Fragment&gt; fragments = <span style="color: #0000ff;">new</span> ArrayList&lt;Fragment&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">public</span> String hello = â€œhello â€œ<span style="color: #000000;">;<br></span><span style="color: #008080;">19</span><br><span style="color: #008080;">20</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br></span><span style="color: #008080;">22</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br></span><span style="color: #008080;">23</span> <span style="color: #000000;">        setContentView(R.layout.main);<br></span><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span>         fragments.add(<span style="color: #0000ff;">new</span><span style="color: #000000;"> TabAFm());<br></span><span style="color: #008080;">26</span>         fragments.add(<span style="color: #0000ff;">new</span><span style="color: #000000;"> TabBFm());<br></span><span style="color: #008080;">27</span>         fragments.add(<span style="color: #0000ff;">new</span><span style="color: #000000;"> TabCFm());<br></span><span style="color: #008080;">28</span>         fragments.add(<span style="color: #0000ff;">new</span><span style="color: #000000;"> TabDFm());<br></span><span style="color: #008080;">29</span>         fragments.add(<span style="color: #0000ff;">new</span><span style="color: #000000;"> TabEFm());<br></span><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span><br><span style="color: #008080;">32</span>         rgs =<span style="color: #000000;"> (RadioGroup) findViewById(R.id.tabs_rg);<br></span><span style="color: #008080;">33</span><br><span style="color: #008080;">34</span>         FragmentTabAdapter tabAdapter = <span style="color: #0000ff;">new</span> FragmentTabAdapter(<span style="color: #0000ff;">this</span><span style="color: #000000;">, fragments, R.id.tab_content, rgs);<br></span><span style="color: #008080;">35</span>         tabAdapter.setOnRgsExtraCheckedChangedListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> FragmentTabAdapter.OnRgsExtraCheckedChangedListener(){<br></span><span style="color: #008080;">36</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">37</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> OnRgsExtraCheckedChanged(RadioGroup radioGroup, <span style="color: #0000ff;">int</span> checkedId, <span style="color: #0000ff;">int</span><span style="color: #000000;"> index) {<br></span><span style="color: #008080;">38</span>                 System.out.println(â€œExtraâ€”- â€œ + index + â€œ checked!!! â€œ<span style="color: #000000;">);<br></span><span style="color: #008080;">39</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">40</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">41</span><br><span style="color: #008080;">42</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">43</span><br><span style="color: #008080;">44</span> }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>MainActivityä¸Šè¿°ä»£ç æ‰€ç¤º</p>
<p>MainActivityæ˜¯åŒ…å«Fragmentçš„Activityï¼ˆä¹Ÿå°±æ˜¯è¿™é‡Œçš„5ä¸ªFragmentï¼‰</p>
<p>ä»–ç»§æ‰¿äº†FragmentActivityï¼ˆå› ä¸ºæˆ‘è¿™é‡Œç”¨çš„æ˜¯android-support-v4.jarï¼‰</p>
<p>ç”¨ä¸€ä¸ªList&lt;Fragment&gt;å»ç»´æŠ¤5ä¸ªFragmentï¼Œä¹Ÿå°±æ˜¯5ä¸ªtab</p>
<p>mainå¸ƒå±€ä¸­æœ‰ä¸€ä¸ªidä¸ºtab_contentçš„FrameLayoutï¼Œç”¨æ¥å­˜æ”¾è¦æ˜¾ç¤ºçš„Fragmentã€‚åº•éƒ¨æœ‰ä¸€ä¸ªRadioGroupï¼Œç”¨äºtabçš„åˆ‡æ¢ï¼Œå¦‚ä¸‹ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('1616a5c6-aec1-4ccd-98f6-7d115ad2bef5')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_1616a5c6-aec1-4ccd-98f6-7d115ad2bef5" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;">  2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><br><span style="color: #008080;">  3</span> <span style="color: #ff0000;">              android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><br><span style="color: #008080;">  4</span> <span style="color: #ff0000;">              android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;">  5</span> <span style="color: #ff0000;">              android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;">  6</span> <span style="color: #ff0000;">              android:background</span><span style="color: #0000ff;">=â€@android:color/whiteâ€</span><br><span style="color: #008080;">  7</span>         <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">  8</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout<br></span><span style="color: #008080;">  9</span>             <span style="color: #ff0000;">android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;"> 10</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;"> 11</span> <span style="color: #ff0000;">            android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><br><span style="color: #008080;"> 12</span>         <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 13</span><br><span style="color: #008080;"> 14</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">FrameLayout<br></span><span style="color: #008080;"> 15</span>             <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/tab_contentâ€</span><br><span style="color: #008080;"> 16</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;"> 17</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€0dpâ€</span><br><span style="color: #008080;"> 18</span> <span style="color: #ff0000;">            android:layout_weight</span><span style="color: #0000ff;">=â€1.0â€</span><br><span style="color: #008080;"> 19</span> <span style="color: #ff0000;">            android:background</span><span style="color: #0000ff;">=â€#77557799â€</span><br><span style="color: #008080;"> 20</span>             <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;"> 21</span><br><span style="color: #008080;"> 22</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioGroup<br></span><span style="color: #008080;"> 23</span>             <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/tabs_rgâ€</span><br><span style="color: #008080;"> 24</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;"> 25</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;"> 26</span> <span style="color: #ff0000;">            android:orientation</span><span style="color: #0000ff;">=â€horizontalâ€</span><br><span style="color: #008080;"> 27</span> <span style="color: #ff0000;">            android:gravity</span><span style="color: #0000ff;">=â€centerâ€</span><br><span style="color: #008080;"> 28</span> <span style="color: #ff0000;">            android:paddingTop</span><span style="color: #0000ff;">=â€7dpâ€</span><br><span style="color: #008080;"> 29</span> <span style="color: #ff0000;">            android:paddingBottom</span><span style="color: #0000ff;">=â€7dpâ€</span><br><span style="color: #008080;"> 30</span>             <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 31</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;"> 32</span>                 <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/tab_rb_aâ€</span><br><span style="color: #008080;"> 33</span> <span style="color: #ff0000;">                android:layout_width</span><span style="color: #0000ff;">=â€0dpâ€</span><br><span style="color: #008080;"> 34</span> <span style="color: #ff0000;">                android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;"> 35</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/tablatestalertâ€</span><br><span style="color: #008080;"> 36</span> <span style="color: #ff0000;">                android:button</span><span style="color: #0000ff;">=â€@nullâ€</span><br><span style="color: #008080;"> 37</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€Tab1â€</span><br><span style="color: #008080;"> 38</span> <span style="color: #ff0000;">                android:textColor</span><span style="color: #0000ff;">=â€#000000â€</span><br><span style="color: #008080;"> 39</span> <span style="color: #ff0000;">                android:textSize</span><span style="color: #0000ff;">=â€13spâ€</span><br><span style="color: #008080;"> 40</span> <span style="color: #ff0000;">                android:layout_weight</span><span style="color: #0000ff;">=â€1.0â€</span><br><span style="color: #008080;"> 41</span> <span style="color: #ff0000;">                android:gravity</span><span style="color: #0000ff;">=â€centerâ€</span><br><span style="color: #008080;"> 42</span> <span style="color: #ff0000;">                android:singleLine</span><span style="color: #0000ff;">=â€trueâ€</span><br><span style="color: #008080;"> 43</span> <span style="color: #ff0000;">                android:checked</span><span style="color: #0000ff;">=â€trueâ€</span><br><span style="color: #008080;"> 44</span> <span style="color: #ff0000;">                android:background</span><span style="color: #0000ff;">=â€@drawable/selector_tabâ€</span><br><span style="color: #008080;"> 45</span>                 <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;"> 46</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;"> 47</span>                 <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/tab_rb_bâ€</span><br><span style="color: #008080;"> 48</span> <span style="color: #ff0000;">                android:layout_width</span><span style="color: #0000ff;">=â€0dpâ€</span><br><span style="color: #008080;"> 49</span> <span style="color: #ff0000;">                android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;"> 50</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/tabsearchâ€</span><br><span style="color: #008080;"> 51</span> <span style="color: #ff0000;">                android:button</span><span style="color: #0000ff;">=â€@nullâ€</span><br><span style="color: #008080;"> 52</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€Tab2â€</span><br><span style="color: #008080;"> 53</span> <span style="color: #ff0000;">                android:textColor</span><span style="color: #0000ff;">=â€#000000â€</span><br><span style="color: #008080;"> 54</span> <span style="color: #ff0000;">                android:textSize</span><span style="color: #0000ff;">=â€13spâ€</span><br><span style="color: #008080;"> 55</span> <span style="color: #ff0000;">                android:layout_weight</span><span style="color: #0000ff;">=â€1.0â€</span><br><span style="color: #008080;"> 56</span> <span style="color: #ff0000;">                android:gravity</span><span style="color: #0000ff;">=â€centerâ€</span><br><span style="color: #008080;"> 57</span> <span style="color: #ff0000;">                android:singleLine</span><span style="color: #0000ff;">=â€trueâ€</span><br><span style="color: #008080;"> 58</span> <span style="color: #ff0000;">                android:background</span><span style="color: #0000ff;">=â€@drawable/selector_tabâ€</span><br><span style="color: #008080;"> 59</span>                 <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;"> 60</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;"> 61</span>                 <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/tab_rb_câ€</span><br><span style="color: #008080;"> 62</span> <span style="color: #ff0000;">                android:layout_width</span><span style="color: #0000ff;">=â€0dpâ€</span><br><span style="color: #008080;"> 63</span> <span style="color: #ff0000;">                android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;"> 64</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/tabrecommdâ€</span><br><span style="color: #008080;"> 65</span> <span style="color: #ff0000;">                android:button</span><span style="color: #0000ff;">=â€@nullâ€</span><br><span style="color: #008080;"> 66</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€Tab3â€</span><br><span style="color: #008080;"> 67</span> <span style="color: #ff0000;">                android:textColor</span><span style="color: #0000ff;">=â€#000000â€</span><br><span style="color: #008080;"> 68</span> <span style="color: #ff0000;">                android:textSize</span><span style="color: #0000ff;">=â€13spâ€</span><br><span style="color: #008080;"> 69</span> <span style="color: #ff0000;">                android:layout_weight</span><span style="color: #0000ff;">=â€1.0â€</span><br><span style="color: #008080;"> 70</span> <span style="color: #ff0000;">                android:gravity</span><span style="color: #0000ff;">=â€centerâ€</span><br><span style="color: #008080;"> 71</span> <span style="color: #ff0000;">                android:singleLine</span><span style="color: #0000ff;">=â€trueâ€</span><br><span style="color: #008080;"> 72</span> <span style="color: #ff0000;">                android:background</span><span style="color: #0000ff;">=â€@drawable/selector_tabâ€</span><br><span style="color: #008080;"> 73</span>                 <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;"> 74</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;"> 75</span>                 <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/tab_rb_dâ€</span><br><span style="color: #008080;"> 76</span> <span style="color: #ff0000;">                android:layout_width</span><span style="color: #0000ff;">=â€0dpâ€</span><br><span style="color: #008080;"> 77</span> <span style="color: #ff0000;">                android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;"> 78</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/tabconfigiconâ€</span><br><span style="color: #008080;"> 79</span> <span style="color: #ff0000;">                android:button</span><span style="color: #0000ff;">=â€@nullâ€</span><br><span style="color: #008080;"> 80</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€Tab4â€</span><br><span style="color: #008080;"> 81</span> <span style="color: #ff0000;">                android:textColor</span><span style="color: #0000ff;">=â€#000000â€</span><br><span style="color: #008080;"> 82</span> <span style="color: #ff0000;">                android:textSize</span><span style="color: #0000ff;">=â€13spâ€</span><br><span style="color: #008080;"> 83</span> <span style="color: #ff0000;">                android:layout_weight</span><span style="color: #0000ff;">=â€1.0â€</span><br><span style="color: #008080;"> 84</span> <span style="color: #ff0000;">                android:gravity</span><span style="color: #0000ff;">=â€centerâ€</span><br><span style="color: #008080;"> 85</span> <span style="color: #ff0000;">                android:singleLine</span><span style="color: #0000ff;">=â€trueâ€</span><br><span style="color: #008080;"> 86</span> <span style="color: #ff0000;">                android:background</span><span style="color: #0000ff;">=â€@drawable/selector_tabâ€</span><br><span style="color: #008080;"> 87</span>                 <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;"> 88</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;"> 89</span>                 <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/tab_rb_eâ€</span><br><span style="color: #008080;"> 90</span> <span style="color: #ff0000;">                android:layout_width</span><span style="color: #0000ff;">=â€0dpâ€</span><br><span style="color: #008080;"> 91</span> <span style="color: #ff0000;">                android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;"> 92</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/tababoutusâ€</span><br><span style="color: #008080;"> 93</span> <span style="color: #ff0000;">                android:button</span><span style="color: #0000ff;">=â€@nullâ€</span><br><span style="color: #008080;"> 94</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€Tab5â€</span><br><span style="color: #008080;"> 95</span> <span style="color: #ff0000;">                android:textColor</span><span style="color: #0000ff;">=â€#000000â€</span><br><span style="color: #008080;"> 96</span> <span style="color: #ff0000;">                android:textSize</span><span style="color: #0000ff;">=â€13spâ€</span><br><span style="color: #008080;"> 97</span> <span style="color: #ff0000;">                android:layout_weight</span><span style="color: #0000ff;">=â€1.0â€</span><br><span style="color: #008080;"> 98</span> <span style="color: #ff0000;">                android:gravity</span><span style="color: #0000ff;">=â€centerâ€</span><br><span style="color: #008080;"> 99</span> <span style="color: #ff0000;">                android:singleLine</span><span style="color: #0000ff;">=â€trueâ€</span><br><span style="color: #008080;">100</span> <span style="color: #ff0000;">                android:background</span><span style="color: #0000ff;">=â€@drawable/selector_tabâ€</span><br><span style="color: #008080;">101</span>                 <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">102</span><br><span style="color: #008080;">103</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">RadioGroup</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">104</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">105</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span></pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>ç°åœ¨å›åˆ°MainActivityä¸­ï¼Œä¸‹é¢è¿™ä¸ªFragmentTabAdapterç±»æ˜¯å…³é”®ï¼Œæ˜¯æˆ‘è‡ªå·±ç¼–å†™çš„ç”¨äºç»‘å®šå’Œå¤„ç†fragmentså’ŒRadioGroupä¹‹é—´çš„é€»è¾‘å…³ç³»</p>
<div class="cnblogs_code"><br><pre>FragmentTabAdapter tabAdapter = <span style="color: #0000ff;">new</span> FragmentTabAdapter(<span style="color: #0000ff;">this</span>, fragments, R.id.tab_content, rgs);</pre><br></div>

<p>&nbsp;</p>
<p>ç°åœ¨çœ‹ä¸‹FragmentTabAdapterï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('1827caab-5f05-4ffc-9974-0616b027aa79')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_1827caab-5f05-4ffc-9974-0616b027aa79" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.fragmenttabhost;<br></span><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.Fragment;<br></span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.FragmentActivity;<br></span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.support.v4.app.FragmentTransaction;<br></span><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.RadioGroup;<br></span><span style="color: #008080;">  7</span><br><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br></span><span style="color: #008080;">  9</span><br><span style="color: #008080;"> 10</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 11</span> <span style="color: #008000;"> <em> Created with IntelliJ IDEA.<br></em></span><span style="color: #008080;"> 12</span> <span style="color: #008000;">  Author: wangjie  email:tiantian.china.2@gmail.com<br></span><span style="color: #008080;"> 13</span> <span style="color: #008000;"> <em> Date: 13-10-10<br></em></span><span style="color: #008080;"> 14</span> <span style="color: #008000;">  Time: ä¸Šåˆ9:25<br></span><span style="color: #008080;"> 15</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 16</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> FragmentTabAdapter <span style="color: #0000ff;">implements</span><span style="color: #000000;"> RadioGroup.OnCheckedChangeListener{<br></span><span style="color: #008080;"> 17</span>     <span style="color: #0000ff;">private</span> List&lt;Fragment&gt; fragments; <span style="color: #008000;">//</span><span style="color: #008000;"> ä¸€ä¸ªtabé¡µé¢å¯¹åº”ä¸€ä¸ªFragment</span><br><span style="color: #008080;"> 18</span>     <span style="color: #0000ff;">private</span> RadioGroup rgs; <span style="color: #008000;">//</span><span style="color: #008000;"> ç”¨äºåˆ‡æ¢tab</span><br><span style="color: #008080;"> 19</span>     <span style="color: #0000ff;">private</span> FragmentActivity fragmentActivity; <span style="color: #008000;">//</span><span style="color: #008000;"> Fragmentæ‰€å±çš„Activity</span><br><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> fragmentContentId; <span style="color: #008000;">//</span><span style="color: #008000;"> Activityä¸­æ‰€è¦è¢«æ›¿æ¢çš„åŒºåŸŸçš„id</span><br><span style="color: #008080;"> 21</span><br><span style="color: #008080;"> 22</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> currentTab; <span style="color: #008000;">//</span><span style="color: #008000;"> å½“å‰Tabé¡µé¢ç´¢å¼•</span><br><span style="color: #008080;"> 23</span><br><span style="color: #008080;"> 24</span>     <span style="color: #0000ff;">private</span> OnRgsExtraCheckedChangedListener onRgsExtraCheckedChangedListener; <span style="color: #008000;">//</span><span style="color: #008000;"> ç”¨äºè®©è°ƒç”¨è€…åœ¨åˆ‡æ¢tabæ—¶å€™å¢åŠ æ–°çš„åŠŸèƒ½</span><br><span style="color: #008080;"> 25</span><br><span style="color: #008080;"> 26</span>     <span style="color: #0000ff;">public</span> FragmentTabAdapter(FragmentActivity fragmentActivity, List&lt;Fragment&gt; fragments, <span style="color: #0000ff;">int</span><span style="color: #000000;"> fragmentContentId, RadioGroup rgs) {<br></span><span style="color: #008080;"> 27</span>         <span style="color: #0000ff;">this</span>.fragments =<span style="color: #000000;"> fragments;<br></span><span style="color: #008080;"> 28</span>         <span style="color: #0000ff;">this</span>.rgs =<span style="color: #000000;"> rgs;<br></span><span style="color: #008080;"> 29</span>         <span style="color: #0000ff;">this</span>.fragmentActivity =<span style="color: #000000;"> fragmentActivity;<br></span><span style="color: #008080;"> 30</span>         <span style="color: #0000ff;">this</span>.fragmentContentId =<span style="color: #000000;"> fragmentContentId;<br></span><span style="color: #008080;"> 31</span><br><span style="color: #008080;"> 32</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> é»˜è®¤æ˜¾ç¤ºç¬¬ä¸€é¡µ</span><br><span style="color: #008080;"> 33</span>         FragmentTransaction ft =<span style="color: #000000;"> fragmentActivity.getSupportFragmentManager().beginTransaction();<br></span><span style="color: #008080;"> 34</span>         ft.add(fragmentContentId, fragments.get(0<span style="color: #000000;">));<br></span><span style="color: #008080;"> 35</span> <span style="color: #000000;">        ft.commit();<br></span><span style="color: #008080;"> 36</span><br><span style="color: #008080;"> 37</span>         rgs.setOnCheckedChangeListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">);<br></span><span style="color: #008080;"> 38</span><br><span style="color: #008080;"> 39</span><br><span style="color: #008080;"> 40</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 41</span><br><span style="color: #008080;"> 42</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 43</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCheckedChanged(RadioGroup radioGroup, <span style="color: #0000ff;">int</span><span style="color: #000000;"> checkedId) {<br></span><span style="color: #008080;"> 44</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 0; i &lt; rgs.getChildCount(); i++<span style="color: #000000;">){<br></span><span style="color: #008080;"> 45</span>             <span style="color: #0000ff;">if</span>(rgs.getChildAt(i).getId() ==<span style="color: #000000;"> checkedId){<br></span><span style="color: #008080;"> 46</span>                 Fragment fragment =<span style="color: #000000;"> fragments.get(i);<br></span><span style="color: #008080;"> 47</span>                 FragmentTransaction ft =<span style="color: #000000;"> obtainFragmentTransaction(i);<br></span><span style="color: #008080;"> 48</span><br><span style="color: #008080;"> 49</span>                 getCurrentFragment().onPause(); <span style="color: #008000;">//</span><span style="color: #008000;"> æš‚åœå½“å‰tab<br></span><span style="color: #008080;"> 50</span> <span style="color: #008000;">//</span><span style="color: #008000;">                getCurrentFragment().onStop(); </span><span style="color: #008000;">//</span><span style="color: #008000;"> æš‚åœå½“å‰tab</span><br><span style="color: #008080;"> 51</span><br><span style="color: #008080;"> 52</span>                 <span style="color: #0000ff;">if</span><span style="color: #000000;">(fragment.isAdded()){<br></span><span style="color: #008080;"> 53</span> <span style="color: #008000;">//</span><span style="color: #008000;">                    fragment.onStart(); </span><span style="color: #008000;">//</span><span style="color: #008000;"> å¯åŠ¨ç›®æ ‡tabçš„onStart()</span><br><span style="color: #008080;"> 54</span>                     fragment.onResume(); <span style="color: #008000;">//</span><span style="color: #008000;"> å¯åŠ¨ç›®æ ‡tabçš„onResume()</span><br><span style="color: #008080;"> 55</span>                 }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;"> 56</span> <span style="color: #000000;">                    ft.add(fragmentContentId, fragment);<br></span><span style="color: #008080;"> 57</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;"> 58</span>                 showTab(i); <span style="color: #008000;">//</span><span style="color: #008000;"> æ˜¾ç¤ºç›®æ ‡tab</span><br><span style="color: #008080;"> 59</span> <span style="color: #000000;">                ft.commit();<br></span><span style="color: #008080;"> 60</span><br><span style="color: #008080;"> 61</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœè®¾ç½®äº†åˆ‡æ¢tabé¢å¤–åŠŸèƒ½åŠŸèƒ½æ¥å£</span><br><span style="color: #008080;"> 62</span>                 <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> onRgsExtraCheckedChangedListener){<br></span><span style="color: #008080;"> 63</span> <span style="color: #000000;">                    onRgsExtraCheckedChangedListener.OnRgsExtraCheckedChanged(radioGroup, checkedId, i);<br></span><span style="color: #008080;"> 64</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;"> 65</span><br><span style="color: #008080;"> 66</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 67</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 68</span><br><span style="color: #008080;"> 69</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 70</span><br><span style="color: #008080;"> 71</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 72</span> <span style="color: #008000;">     <em> åˆ‡æ¢tab<br></em></span><span style="color: #008080;"> 73</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> idx<br></span><span style="color: #008080;"> 74</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 75</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> showTab(<span style="color: #0000ff;">int</span><span style="color: #000000;"> idx){<br></span><span style="color: #008080;"> 76</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 0; i &lt; fragments.size(); i++<span style="color: #000000;">){<br></span><span style="color: #008080;"> 77</span>             Fragment fragment =<span style="color: #000000;"> fragments.get(i);<br></span><span style="color: #008080;"> 78</span>             FragmentTransaction ft =<span style="color: #000000;"> obtainFragmentTransaction(idx);<br></span><span style="color: #008080;"> 79</span><br><span style="color: #008080;"> 80</span>             <span style="color: #0000ff;">if</span>(idx ==<span style="color: #000000;"> i){<br></span><span style="color: #008080;"> 81</span> <span style="color: #000000;">                ft.show(fragment);<br></span><span style="color: #008080;"> 82</span>             }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;"> 83</span> <span style="color: #000000;">                ft.hide(fragment);<br></span><span style="color: #008080;"> 84</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 85</span> <span style="color: #000000;">            ft.commit();<br></span><span style="color: #008080;"> 86</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 87</span>         currentTab = idx; <span style="color: #008000;">//</span><span style="color: #008000;"> æ›´æ–°ç›®æ ‡tabä¸ºå½“å‰tab</span><br><span style="color: #008080;"> 88</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 89</span><br><span style="color: #008080;"> 90</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 91</span> <span style="color: #008000;">      è·å–ä¸€ä¸ªå¸¦åŠ¨ç”»çš„FragmentTransaction<br></span><span style="color: #008080;"> 92</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> index<br></span><span style="color: #008080;"> 93</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><br><span style="color: #008080;"> 94</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 95</span>     <span style="color: #0000ff;">private</span> FragmentTransaction obtainFragmentTransaction(<span style="color: #0000ff;">int</span><span style="color: #000000;"> index){<br></span><span style="color: #008080;"> 96</span>         FragmentTransaction ft =<span style="color: #000000;"> fragmentActivity.getSupportFragmentManager().beginTransaction();<br></span><span style="color: #008080;"> 97</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®åˆ‡æ¢åŠ¨ç”»</span><br><span style="color: #008080;"> 98</span>         <span style="color: #0000ff;">if</span>(index &gt;<span style="color: #000000;"> currentTab){<br></span><span style="color: #008080;"> 99</span> <span style="color: #000000;">            ft.setCustomAnimations(R.anim.slide_left_in, R.anim.slide_left_out);<br></span><span style="color: #008080;">100</span>         }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;">101</span> <span style="color: #000000;">            ft.setCustomAnimations(R.anim.slide_right_in, R.anim.slide_right_out);<br></span><span style="color: #008080;">102</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">103</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> ft;<br></span><span style="color: #008080;">104</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">105</span><br><span style="color: #008080;">106</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getCurrentTab() {<br></span><span style="color: #008080;">107</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> currentTab;<br></span><span style="color: #008080;">108</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">109</span><br><span style="color: #008080;">110</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Fragment getCurrentFragment(){<br></span><span style="color: #008080;">111</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> fragments.get(currentTab);<br></span><span style="color: #008080;">112</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">113</span><br><span style="color: #008080;">114</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> OnRgsExtraCheckedChangedListener getOnRgsExtraCheckedChangedListener() {<br></span><span style="color: #008080;">115</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> onRgsExtraCheckedChangedListener;<br></span><span style="color: #008080;">116</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">117</span><br><span style="color: #008080;">118</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setOnRgsExtraCheckedChangedListener(OnRgsExtraCheckedChangedListener onRgsExtraCheckedChangedListener) {<br></span><span style="color: #008080;">119</span>         <span style="color: #0000ff;">this</span>.onRgsExtraCheckedChangedListener =<span style="color: #000000;"> onRgsExtraCheckedChangedListener;<br></span><span style="color: #008080;">120</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">121</span><br><span style="color: #008080;">122</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">123</span> <span style="color: #008000;">       åˆ‡æ¢tabé¢å¤–åŠŸèƒ½åŠŸèƒ½æ¥å£<br></span><span style="color: #008080;">124</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">125</span>     <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> OnRgsExtraCheckedChangedListener{<br></span><span style="color: #008080;">126</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> OnRgsExtraCheckedChanged(RadioGroup radioGroup, <span style="color: #0000ff;">int</span> checkedId, <span style="color: #0000ff;">int</span><span style="color: #000000;"> index){<br></span><span style="color: #008080;">127</span><br><span style="color: #008080;">128</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">129</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">130</span><br><span style="color: #008080;">131</span> }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div>

<p>è¿™é‡Œè§£å†³Fragmentåˆ‡æ¢é‡æ–°åŠ è½½å¸ƒå±€çš„åŠæ³•ï¼Œç”¨çš„æ˜¯æŠŠå‡ ä¸ªFragmentå…¨éƒ¨Addï¼Œç„¶åæ ¹æ®è¦æ˜¾ç¤ºçš„å“ªä¸ªFragmentè®¾ç½®showæˆ–è€…hide</p>
<p>æ•ˆæœè¾“å‡ºï¼š</p>
<p>10-10 11:55:41.168: INFO/System.out(18368): AAAAAAAAAA<strong><strong>onAttachã€€ã€€ã€€ã€€ã€€ã€€<span style="color: #0000ff;">// ç¬¬ä¸€æ¬¡è¿›å…¥ï¼Œæ˜¾ç¤ºTabA</span><br>10-10 11:55:41.168: INFO/System.out(18368): AAAAAAAAAA</strong></strong>onCreate<br>10-10 11:55:41.168: INFO/System.out(18368): AAAAAAAAAA<strong><strong>onCreateView<br>10-10 11:55:41.175: INFO/System.out(18368): AAAAAAAAAA</strong></strong>onActivityCreated<br>10-10 11:55:41.179: INFO/System.out(18368): AAAAAAAAAA<strong><strong>onStart<br>10-10 11:55:41.179: INFO/System.out(18368): AAAAAAAAAA</strong></strong>onResume<br>10-10 11:55:44.980: INFO/System.out(18368): AAAAAAAAAA<strong><strong>onPauseã€€ã€€ã€€ã€€ã€€ã€€<span style="color: #0000ff;">// ä»TabAåˆ‡æ¢åˆ°TabBï¼ˆTabAè°ƒç”¨onPauseï¼‰</span><br>10-10 11:55:44.980: INFO/System.out(18368): Extraâ€”- 1 checked!!!<br>10-10 11:55:44.996: INFO/System.out(18368): BBBBBBBBBBB</strong></strong>onAttach<br>10-10 11:55:44.996: INFO/System.out(18368): BBBBBBBBBBB<strong><strong>onCreate<br>10-10 11:55:44.996: INFO/System.out(18368): BBBBBBBBBBB</strong></strong>onCreateView<br>10-10 11:55:45.004: INFO/System.out(18368): BBBBBBBBBBB<strong><strong>onActivityCreated<br>10-10 11:55:45.004: INFO/System.out(18368): BBBBBBBBBBB</strong></strong>onStart<br>10-10 11:55:45.004: INFO/System.out(18368): BBBBBBBBBBB<strong><strong>onResume<br>10-10 11:55:52.062: INFO/System.out(18368): BBBBBBBBBBB</strong></strong>onPauseã€€ã€€ã€€ã€€ã€€ã€€<span style="color: #0000ff;">// ä»TabBåˆ‡æ¢åˆ°TabCï¼ˆTabBè°ƒç”¨onPauseï¼‰</span><br>10-10 11:55:52.062: INFO/System.out(18368): Extraâ€”- 2 checked!!!<br>10-10 11:55:52.082: INFO/System.out(18368): CCCCCCCCCC<strong><strong>onAttach<br>10-10 11:55:52.082: INFO/System.out(18368): CCCCCCCCCC</strong></strong>onCreate<br>10-10 11:55:52.086: INFO/System.out(18368): CCCCCCCCCC<strong><strong>onCreateView<br>10-10 11:55:52.090: INFO/System.out(18368): CCCCCCCCCC</strong></strong>onActivityCreated<br>10-10 11:55:52.090: INFO/System.out(18368): CCCCCCCCCC<strong><strong>onStart<br>10-10 11:55:52.090: INFO/System.out(18368): CCCCCCCCCC</strong></strong>onResume<br>10-10 11:56:06.535: INFO/System.out(18368): CCCCCCCCCC<strong><strong>onPauseã€€ã€€ã€€ã€€ã€€ã€€<span style="color: #0000ff;">// ä»TabCåˆ‡æ¢åˆ°TabBï¼ˆTabCè°ƒç”¨onPauseï¼‰</span><br>10-10 11:56:06.535: INFO/System.out(18368): BBBBBBBBBBB</strong></strong>onResumeã€€ã€€ã€€ã€€<span style="color: #0000ff;">//&nbsp;ä»TabCåˆ‡æ¢åˆ°TabBï¼ˆTabBè°ƒç”¨onResumeï¼‰</span><br>10-10 11:56:06.535: INFO/System.out(18368): Extraâ€”- 1 checked!!!</p>
<p>&nbsp;</p>
<p>å¥½äº†ï¼Œåˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ç”¨Fragmentå®ç°äº†ç±»ä¼¼TabHostçš„åŠŸèƒ½äº†ï¼Œä¸‹é¢æ¥çœ‹ä¸‹å„ä¸ªFragmentä¹‹é—´çš„é€šä¿¡</p>
<p>ç°åœ¨çš„æƒ…å†µæ˜¯TabAFmä¸­æœ‰ä¸ªEditTextï¼ŒTabBFmä¸­æœ‰ä¸ªButtonï¼ŒMainActivityä¸­æœ‰ä¸ªå˜é‡&ldquo;hello&rdquo;</p>
<p>è¦åšçš„æ˜¯ï¼Œåˆ‡æ¢åˆ°TabAï¼Œè¾“å…¥&ldquo;Iâ€™m TabA&rdquo;ï¼Œåˆ‡æ¢åˆ°Bï¼Œç‚¹å‡»Buttonåï¼ŒToastæ˜¾ç¤º&ldquo;hello Iâ€™m TabA&rdquo;</p>
<p>MainActivityä¸­æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±ä¸€ä¸ªhelloå˜é‡ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> String hello = â€œhello â€œ;</pre><br></div>

<p>TabAFmåœ¨å¸ƒå±€æ–‡ä»¶tab_a.xmlä¸­åŠ ä¸ªEditTextï¼Œè®¾ç½®ä¸ªidå°±å¯ä»¥äº†</p>
<p>TabBFmä¸­ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('584d6f2a-4f17-4bc3-b261-291e61788031')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><br><div id="cnblogs_code_open_584d6f2a-4f17-4bc3-b261-291e61788031" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">@Override<br></span><span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onActivityCreated(Bundle savedInstanceState) {<br></span><span style="color: #008080;"> 3</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onActivityCreated(savedInstanceState);<br></span><span style="color: #008080;"> 4</span>         System.out.println(â€œBBBBBBBBBBB____onActivityCreatedâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 5</span>         <span style="color: #0000ff;">this</span>.getView().findViewById(R.id.clickme).setOnClickListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> View.OnClickListener() {<br></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onClick(View view) {<br></span><span style="color: #008080;"> 8</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> è·å¾—ç»‘å®šçš„FragmentActivity</span><br><span style="color: #008080;"> 9</span>                 MainActivity activity =<span style="color: #000000;"> ((MainActivity)getActivity());<br></span><span style="color: #008080;">10</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> è·å¾—TabAFmçš„æ§ä»¶</span><br><span style="color: #008080;">11</span>                 EditText editText = (EditText) activity.fragments.get(0<span style="color: #000000;">).getView().findViewById(R.id.edit);<br></span><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span>                 Toast.makeText(activity, activity.hello +<span style="color: #000000;"> editText.getText(), Toast.LENGTH_SHORT).show();<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">16</span>     }</pre><br></div><br><span class="cnblogs_code_collapse">View Code </span></div><br><div class="cnblogs_code"><br><pre><span style="color: #008000;">//</span><span style="color: #008000;"> è·å¾—ç»‘å®šçš„FragmentActivity</span><br>MainActivity activity = ((MainActivity)getActivity());</pre><br></div>

<p>é€šè¿‡getActivity()å³å¯å¾—åˆ°Fragmentæ‰€åœ¨çš„FragmentActivity</p>
<p>&nbsp;</p>
<p>æœ€ç»ˆæ•ˆæœå›¾ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201310/10114324-42b27a496916463e91d7400c5c3d1884.png" alt=""></p>
<p><span style="color: #ff0000;"><strong>demoä¸‹è½½åœ°å€ï¼š<a href="http://pan.baidu.com/s/1wxsIX" target="_blank" rel="noopener"><span style="color: #ff0000;">http://pan.baidu.com/s/1wxsIX</span></a></strong></span></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> TabHost </tag>
            
            <tag> fragment </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hibernate3æ³¨è§£[è½¬]]]></title>
      <url>/2013/10/08/Hibernate3%E6%B3%A8%E8%A7%A3-%E8%BD%AC/</url>
      <content type="html"><![CDATA[<p>&nbsp;Hibernate3æ³¨è§£ æ”¶è—&nbsp;<br>1ã€@Entity(name=â€EntityNameâ€)&nbsp;<br>å¿…é¡»,nameä¸ºå¯é€‰,å¯¹åº”æ•°æ®åº“ä¸­ä¸€çš„ä¸ªè¡¨</p>
<p>2ã€@Table(name=â€â€,catalog=â€â€,schema=â€â€)&nbsp;<br>å¯é€‰,é€šå¸¸å’Œ@Entityé…åˆä½¿ç”¨,åªèƒ½æ ‡æ³¨åœ¨å®ä½“çš„classå®šä¹‰å¤„,è¡¨ç¤ºå®ä½“å¯¹åº”çš„æ•°æ®åº“è¡¨çš„ä¿¡æ¯&nbsp;<br>name:å¯é€‰,è¡¨ç¤ºè¡¨çš„åç§°.é»˜è®¤åœ°,è¡¨åå’Œå®ä½“åç§°ä¸€è‡´,åªæœ‰åœ¨ä¸ä¸€è‡´çš„æƒ…å†µä¸‹æ‰éœ€è¦æŒ‡å®šè¡¨å&nbsp;<br>catalog:å¯é€‰,è¡¨ç¤ºCatalogåç§°,é»˜è®¤ä¸ºCatalog(â€œâ€).&nbsp;<br>schema:å¯é€‰,è¡¨ç¤ºSchemaåç§°,é»˜è®¤ä¸ºSchema(â€œâ€).</p>
<p>3ã€@id&nbsp;<br>å¿…é¡»&nbsp;<br>@idå®šä¹‰äº†æ˜ å°„åˆ°æ•°æ®åº“è¡¨çš„ä¸»é”®çš„å±æ€§,ä¸€ä¸ªå®ä½“åªèƒ½æœ‰ä¸€ä¸ªå±æ€§è¢«æ˜ å°„ä¸ºä¸»é”®.ç½®äºgetXxxx()å‰.</p>
<p>4ã€@GeneratedValue(strategy=GenerationType,generator=â€â€)&nbsp;<br>å¯é€‰&nbsp;<br>strategy:è¡¨ç¤ºä¸»é”®ç”Ÿæˆç­–ç•¥,æœ‰AUTO,INDENTITY,SEQUENCE å’Œ TABLE 4ç§,åˆ†åˆ«è¡¨ç¤ºè®©ORMæ¡†æ¶è‡ªåŠ¨é€‰æ‹©,&nbsp;<br>æ ¹æ®æ•°æ®åº“çš„Identityå­—æ®µç”Ÿæˆ,æ ¹æ®æ•°æ®åº“è¡¨çš„Sequenceå­—æ®µç”Ÿæˆ,ä»¥æœ‰æ ¹æ®ä¸€ä¸ªé¢å¤–çš„è¡¨ç”Ÿæˆä¸»é”®,é»˜è®¤ä¸ºAUTO&nbsp;<br>generator:è¡¨ç¤ºä¸»é”®ç”Ÿæˆå™¨çš„åç§°,è¿™ä¸ªå±æ€§é€šå¸¸å’ŒORMæ¡†æ¶ç›¸å…³,ä¾‹å¦‚,Hibernateå¯ä»¥æŒ‡å®šuuidç­‰ä¸»é”®ç”Ÿæˆæ–¹å¼.&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; @Id&nbsp;<br>&nbsp;&nbsp;&nbsp; @GeneratedValues(strategy=StrategyType.SEQUENCE)&nbsp;<br>&nbsp;&nbsp;&nbsp; public int getPk() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return pk;&nbsp;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>5ã€@Basic(fetch=FetchType,optional=true)&nbsp;<br>å¯é€‰&nbsp;<br>@Basicè¡¨ç¤ºä¸€ä¸ªç®€å•çš„å±æ€§åˆ°æ•°æ®åº“è¡¨çš„å­—æ®µçš„æ˜ å°„,å¯¹äºæ²¡æœ‰ä»»ä½•æ ‡æ³¨çš„getXxxx()æ–¹æ³•,é»˜è®¤å³ä¸º@Basic&nbsp;<br>fetch: è¡¨ç¤ºè¯¥å±æ€§çš„è¯»å–ç­–ç•¥,æœ‰EAGERå’ŒLAZYä¸¤ç§,åˆ†åˆ«è¡¨ç¤ºä¸»æ”¯æŠ“å–å’Œå»¶è¿ŸåŠ è½½,é»˜è®¤ä¸ºEAGER.&nbsp;<br>optional:è¡¨ç¤ºè¯¥å±æ€§æ˜¯å¦å…è®¸ä¸ºnull,é»˜è®¤ä¸ºtrue&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; @Basic(optional=false)&nbsp;<br>&nbsp;&nbsp;&nbsp; public String getAddress() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return address;&nbsp;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>6ã€@Column&nbsp;<br>å¯é€‰&nbsp;<br>@Columnæè¿°äº†æ•°æ®åº“è¡¨ä¸­è¯¥å­—æ®µçš„è¯¦ç»†å®šä¹‰,è¿™å¯¹äºæ ¹æ®JPAæ³¨è§£ç”Ÿæˆæ•°æ®åº“è¡¨ç»“æ„çš„å·¥å…·éå¸¸æœ‰ä½œç”¨.&nbsp;<br>name:è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­è¯¥å­—æ®µçš„åç§°,é»˜è®¤æƒ…å½¢å±æ€§åç§°ä¸€è‡´&nbsp;<br>nullable:è¡¨ç¤ºè¯¥å­—æ®µæ˜¯å¦å…è®¸ä¸ºnull,é»˜è®¤ä¸ºtrue&nbsp;<br>unique:è¡¨ç¤ºè¯¥å­—æ®µæ˜¯å¦æ˜¯å”¯ä¸€æ ‡è¯†,é»˜è®¤ä¸ºfalse&nbsp;<br>length:è¡¨ç¤ºè¯¥å­—æ®µçš„å¤§å°,ä»…å¯¹Stringç±»å‹çš„å­—æ®µæœ‰æ•ˆ&nbsp;<br>insertable:è¡¨ç¤ºåœ¨ORMæ¡†æ¶æ‰§è¡Œæ’å…¥æ“ä½œæ—¶,è¯¥å­—æ®µæ˜¯å¦åº”å‡ºç°INSETRTè¯­å¥ä¸­,é»˜è®¤ä¸ºtrue&nbsp;<br>updateable:è¡¨ç¤ºåœ¨ORMæ¡†æ¶æ‰§è¡Œæ›´æ–°æ“ä½œæ—¶,è¯¥å­—æ®µæ˜¯å¦åº”è¯¥å‡ºç°åœ¨UPDATEè¯­å¥ä¸­,é»˜è®¤ä¸ºtrue.å¯¹äºä¸€ç»åˆ›å»ºå°±ä¸å¯ä»¥æ›´æ”¹çš„å­—æ®µ,è¯¥å±æ€§éå¸¸æœ‰ç”¨,å¦‚å¯¹äºbirthdayå­—æ®µ.&nbsp;<br>columnDefinition:è¡¨ç¤ºè¯¥å­—æ®µåœ¨æ•°æ®åº“ä¸­çš„å®é™…ç±»å‹.é€šå¸¸ORMæ¡†æ¶å¯ä»¥æ ¹æ®å±æ€§ç±»å‹è‡ªåŠ¨åˆ¤æ–­æ•°æ®åº“ä¸­å­—æ®µçš„ç±»å‹,ä½†æ˜¯å¯¹äºDateç±»å‹ä»æ— æ³•ç¡®å®šæ•°æ®åº“ä¸­å­—æ®µç±»å‹ç©¶ç«Ÿæ˜¯DATE,TIMEè¿˜æ˜¯TIMESTAMP.æ­¤å¤–,Stringçš„é»˜è®¤æ˜ å°„ç±»å‹ä¸ºVARCHAR,å¦‚æœè¦å°†Stringç±»å‹æ˜ å°„åˆ°ç‰¹å®šæ•°æ®åº“çš„BLOBæˆ–TEXTå­—æ®µç±»å‹,è¯¥å±æ€§éå¸¸æœ‰ç”¨.&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; @Column(name=â€BIRTHâ€,nullable=â€falseâ€,columnDefinition=â€DATEâ€)&nbsp;<br>&nbsp;&nbsp;&nbsp; public String getBithday() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return birthday;&nbsp;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>7ã€@Transient&nbsp;<br>å¯é€‰&nbsp;<br>@Transientè¡¨ç¤ºè¯¥å±æ€§å¹¶éä¸€ä¸ªåˆ°æ•°æ®åº“è¡¨çš„å­—æ®µçš„æ˜ å°„,ORMæ¡†æ¶å°†å¿½ç•¥è¯¥å±æ€§.&nbsp;<br>å¦‚æœä¸€ä¸ªå±æ€§å¹¶éæ•°æ®åº“è¡¨çš„å­—æ®µæ˜ å°„,å°±åŠ¡å¿…å°†å…¶æ ‡ç¤ºä¸º@Transient,å¦åˆ™,ORMæ¡†æ¶é»˜è®¤å…¶æ³¨è§£ä¸º@Basic&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; //æ ¹æ®birthè®¡ç®—å‡ºageå±æ€§&nbsp;<br>&nbsp;&nbsp;&nbsp; @Transient&nbsp;<br>&nbsp;&nbsp;&nbsp; public int getAge() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return getYear(new Date()) - getYear(birth);&nbsp;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>8ã€@ManyToOne(fetch=FetchType,cascade=CascadeType)&nbsp;<br>å¯é€‰&nbsp;<br>@ManyToOneè¡¨ç¤ºä¸€ä¸ªå¤šå¯¹ä¸€çš„æ˜ å°„,è¯¥æ³¨è§£æ ‡æ³¨çš„å±æ€§é€šå¸¸æ˜¯æ•°æ®åº“è¡¨çš„å¤–é”®&nbsp;<br>optional:æ˜¯å¦å…è®¸è¯¥å­—æ®µä¸ºnull,è¯¥å±æ€§åº”è¯¥æ ¹æ®æ•°æ®åº“è¡¨çš„å¤–é”®çº¦æŸæ¥ç¡®å®š,é»˜è®¤ä¸ºtrue&nbsp;<br>fetch:è¡¨ç¤ºæŠ“å–ç­–ç•¥,é»˜è®¤ä¸ºFetchType.EAGER&nbsp;<br>cascade:è¡¨ç¤ºé»˜è®¤çš„çº§è”æ“ä½œç­–ç•¥,å¯ä»¥æŒ‡å®šä¸ºALL,PERSIST,MERGE,REFRESHå’ŒREMOVEä¸­çš„è‹¥å¹²ç»„åˆ,é»˜è®¤ä¸ºæ— çº§è”æ“ä½œ&nbsp;<br>targetEntity:è¡¨ç¤ºè¯¥å±æ€§å…³è”çš„å®ä½“ç±»å‹.è¯¥å±æ€§é€šå¸¸ä¸å¿…æŒ‡å®š,ORMæ¡†æ¶æ ¹æ®å±æ€§ç±»å‹è‡ªåŠ¨åˆ¤æ–­targetEntity.&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; //è®¢å•Orderå’Œç”¨æˆ·Useræ˜¯ä¸€ä¸ªManyToOneçš„å…³ç³»&nbsp;<br>&nbsp;&nbsp;&nbsp; //åœ¨Orderç±»ä¸­å®šä¹‰&nbsp;<br>&nbsp;&nbsp;&nbsp; @ManyToOne()&nbsp;<br>&nbsp;&nbsp;&nbsp; @JoinColumn(name=â€USERâ€)&nbsp;<br>&nbsp;&nbsp;&nbsp; public User getUser() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return user;&nbsp;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>9ã€@JoinColumn&nbsp;<br>å¯é€‰&nbsp;<br>@JoinColumnå’Œ@Columnç±»ä¼¼,ä»‹é‡æè¿°çš„ä¸æ˜¯ä¸€ä¸ªç®€å•å­—æ®µ,è€Œä¸€ä¸€ä¸ªå…³è”å­—æ®µ,ä¾‹å¦‚.æè¿°ä¸€ä¸ª@ManyToOneçš„å­—æ®µ.&nbsp;<br>name:è¯¥å­—æ®µçš„åç§°.ç”±äº@JoinColumnæè¿°çš„æ˜¯ä¸€ä¸ªå…³è”å­—æ®µ,å¦‚ManyToOne,åˆ™é»˜è®¤çš„åç§°ç”±å…¶å…³è”çš„å®ä½“å†³å®š.&nbsp;<br>ä¾‹å¦‚,å®ä½“Orderæœ‰ä¸€ä¸ªuserå±æ€§æ¥å…³è”å®ä½“User,åˆ™Orderçš„userå±æ€§ä¸ºä¸€ä¸ªå¤–é”®,&nbsp;<br>å…¶é»˜è®¤çš„åç§°ä¸ºå®ä½“Userçš„åç§°+ä¸‹åˆ’çº¿+å®ä½“Userçš„ä¸»é”®åç§°&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; è§@ManyToOne</p>
<p>10ã€@OneToMany(fetch=FetchType,cascade=CascadeType)&nbsp;<br>å¯é€‰&nbsp;<br>@OneToManyæè¿°ä¸€ä¸ªä¸€å¯¹å¤šçš„å…³è”,è¯¥å±æ€§åº”è¯¥ä¸ºé›†ä½“ç±»å‹,åœ¨æ•°æ®åº“ä¸­å¹¶æ²¡æœ‰å®é™…å­—æ®µ.&nbsp;<br>fetch:è¡¨ç¤ºæŠ“å–ç­–ç•¥,é»˜è®¤ä¸ºFetchType.LAZY,å› ä¸ºå…³è”çš„å¤šä¸ªå¯¹è±¡é€šå¸¸ä¸å¿…ä»æ•°æ®åº“é¢„å…ˆè¯»å–åˆ°å†…å­˜&nbsp;<br>cascade:è¡¨ç¤ºçº§è”æ“ä½œç­–ç•¥,å¯¹äºOneToManyç±»å‹çš„å…³è”éå¸¸é‡è¦,é€šå¸¸è¯¥å®ä½“æ›´æ–°æˆ–åˆ é™¤æ—¶,å…¶å…³è”çš„å®ä½“ä¹Ÿåº”å½“è¢«æ›´æ–°æˆ–åˆ é™¤&nbsp;<br>ä¾‹å¦‚:å®ä½“Userå’ŒOrderæ˜¯OneToManyçš„å…³ç³»,åˆ™å®ä½“Userè¢«åˆ é™¤æ—¶,å…¶å…³è”çš„å®ä½“Orderä¹Ÿåº”è¯¥è¢«å…¨éƒ¨åˆ é™¤&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; @OneTyMany(cascade=ALL)&nbsp;<br>&nbsp;&nbsp;&nbsp; public List getOrders() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return orders;&nbsp;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>11ã€@OneToOne(fetch=FetchType,cascade=CascadeType)&nbsp;<br>å¯é€‰&nbsp;<br>@OneToOneæè¿°ä¸€ä¸ªä¸€å¯¹ä¸€çš„å…³è”&nbsp;<br>fetch:è¡¨ç¤ºæŠ“å–ç­–ç•¥,é»˜è®¤ä¸ºFetchType.LAZY&nbsp;<br>cascade:è¡¨ç¤ºçº§è”æ“ä½œç­–ç•¥&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; @OneToOne(fetch=FetchType.LAZY)&nbsp;<br>&nbsp;&nbsp;&nbsp; public Blog getBlog() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return blog;&nbsp;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>12ã€@ManyToMany&nbsp;<br>å¯é€‰&nbsp;<br>@ManyToMany æè¿°ä¸€ä¸ªå¤šå¯¹å¤šçš„å…³è”.å¤šå¯¹å¤šå…³è”ä¸Šæ˜¯ä¸¤ä¸ªä¸€å¯¹å¤šå…³è”,ä½†æ˜¯åœ¨ManyToManyæè¿°ä¸­,ä¸­é—´è¡¨æ˜¯ç”±ORMæ¡†æ¶è‡ªåŠ¨å¤„ç†&nbsp;<br>targetEntity:è¡¨ç¤ºå¤šå¯¹å¤šå…³è”çš„å¦ä¸€ä¸ªå®ä½“ç±»çš„å…¨å,ä¾‹å¦‚:package.Book.class&nbsp;<br>mappedBy:è¡¨ç¤ºå¤šå¯¹å¤šå…³è”çš„å¦ä¸€ä¸ªå®ä½“ç±»çš„å¯¹åº”é›†åˆå±æ€§åç§°&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; Userå®ä½“è¡¨ç¤ºç”¨æˆ·,Bookå®ä½“è¡¨ç¤ºä¹¦ç±,ä¸ºäº†æè¿°ç”¨æˆ·æ”¶è—çš„ä¹¦ç±,å¯ä»¥åœ¨Userå’ŒBookä¹‹é—´å»ºç«‹ManyToManyå…³è”&nbsp;<br>&nbsp;&nbsp;&nbsp; @Entity&nbsp;<br>&nbsp;&nbsp;&nbsp; public class User {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private List books;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ManyToMany(targetEntity=package.Book.class)&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public List getBooks() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return books;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void setBooks(List books) {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.books=books;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<br>&nbsp;&nbsp;&nbsp; }&nbsp;<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; @Entity&nbsp;<br>&nbsp;&nbsp;&nbsp; public class Book {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private List users;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ManyToMany(targetEntity=package.Users.class, mappedBy=â€booksâ€)&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public List getUsers() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return users;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void setUsers(List users) {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.users=users;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<br>&nbsp;&nbsp;&nbsp; }&nbsp;<br>ä¸¤ä¸ªå®ä½“é—´ç›¸äº’å…³è”çš„å±æ€§å¿…é¡»æ ‡è®°ä¸º@ManyToMany,å¹¶ç›¸äº’æŒ‡å®štargetEntityå±æ€§,&nbsp;<br>éœ€è¦æ³¨æ„çš„æ˜¯,æœ‰ä¸”åªæœ‰ä¸€ä¸ªå®ä½“çš„@ManyToManyæ³¨è§£éœ€è¦æŒ‡å®šmappedByå±æ€§,æŒ‡å‘targetEntityçš„é›†åˆå±æ€§åç§°&nbsp;<br>åˆ©ç”¨ORMå·¥å…·è‡ªåŠ¨ç”Ÿæˆçš„è¡¨é™¤äº†Userå’ŒBookè¡¨å¤–,è¿˜è‡ªåŠ¨ç”Ÿæˆäº†ä¸€ä¸ªUser_Bookè¡¨,ç”¨äºå®ç°å¤šå¯¹å¤šå…³è”</p>
<p>13ã€@MappedSuperclass&nbsp;<br>å¯é€‰&nbsp;<br>@MappedSuperclasså¯ä»¥å°†è¶…ç±»çš„JPAæ³¨è§£ä¼ é€’ç»™å­ç±»,ä½¿å­ç±»èƒ½å¤Ÿç»§æ‰¿è¶…ç±»çš„JPAæ³¨è§£&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; @MappedSuperclass&nbsp;<br>&nbsp;&nbsp;&nbsp; public class Employee() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; â€¦.&nbsp;<br>&nbsp;&nbsp;&nbsp; }&nbsp;<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp; @Entity&nbsp;<br>&nbsp;&nbsp;&nbsp; public class Engineer extends Employee {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; â€¦..&nbsp;<br>&nbsp;&nbsp;&nbsp; }&nbsp;<br>&nbsp;&nbsp;&nbsp; @Entity&nbsp;<br>&nbsp;&nbsp;&nbsp; public class Manager extends Employee {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; â€¦..&nbsp;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>14ã€@Embedded&nbsp;<br>å¯é€‰&nbsp;<br>@Embeddedå°†å‡ ä¸ªå­—æ®µç»„åˆæˆä¸€ä¸ªç±»,å¹¶ä½œä¸ºæ•´ä¸ªEntityçš„ä¸€ä¸ªå±æ€§.&nbsp;<br>ä¾‹å¦‚UseråŒ…æ‹¬id,name,city,street,zipå±æ€§.&nbsp;<br>æˆ‘ä»¬å¸Œæœ›city,street,zipå±æ€§æ˜ å°„ä¸ºAddresså¯¹è±¡.è¿™æ ·,Userå¯¹è±¡å°†å…·æœ‰id,nameå’Œaddressè¿™ä¸‰ä¸ªå±æ€§.&nbsp;<br>Addresså¯¹è±¡å¿…é¡»å®šä¹‰ä¸º@Embededable&nbsp;<br>ç¤ºä¾‹:&nbsp;<br>&nbsp;&nbsp;&nbsp; @Embeddable&nbsp;<br>&nbsp;&nbsp;&nbsp; public class Address {city,street,zip}&nbsp;<br>&nbsp;&nbsp;&nbsp; @Entity&nbsp;<br>&nbsp;&nbsp;&nbsp; public class User {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Embedded&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Address getAddress() {&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; â€¦â€¦â€¦.&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<br>&nbsp;&nbsp;&nbsp; }</p>
<p>ã€€ã€€ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥åŠ¨æ‰‹ä½¿ç”¨Hibernate Annotationã€‚</p>
<p>å®‰è£… Hibernate Annotation&nbsp;<br>ã€€ã€€è¦ä½¿ç”¨ Hibernate Annotationï¼Œæ‚¨è‡³å°‘éœ€è¦å…·å¤‡ Hibernate 3.2å’ŒJava 5ã€‚å¯ä»¥ä» Hibernate ç«™ç‚¹ ä¸‹è½½ Hibernate 3.2 å’Œ Hibernate Annotationåº“ã€‚é™¤äº†æ ‡å‡†çš„ Hibernate JAR å’Œä¾èµ–é¡¹ä¹‹å¤–ï¼Œæ‚¨è¿˜éœ€è¦ Hibernate Annotations .jar æ–‡ä»¶ï¼ˆhibernate-annotations.jarï¼‰ã€Java æŒä¹…æ€§ API ï¼ˆlib/ejb3-persistence.jarï¼‰ã€‚å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Mavenï¼Œåªéœ€è¦å‘ POM æ–‡ä»¶æ·»åŠ ç›¸åº”çš„ä¾èµ–é¡¹å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>&nbsp;&nbsp;&nbsp; â€¦&nbsp;<br>&lt;dependency&gt;&nbsp;<br>&lt;groupId&gt;org.hibernate&lt;/groupId&gt;&nbsp;<br>&lt;artifactId&gt;hibernate&lt;/artifactId&gt;&nbsp;<br>&lt;version&gt;3.2.1.ga&lt;/version&gt;&nbsp;<br>&lt;/dependency&gt;&nbsp;<br>&lt;dependency&gt;&nbsp;<br>&lt;groupId&gt;org.hibernate&lt;/groupId&gt;&nbsp;<br>&lt;artifactId&gt;hibernate-annotations&lt;/artifactId&gt;&nbsp;<br>&lt;version&gt;3.2.0.ga&lt;/version&gt;&nbsp;<br>&lt;/dependency&gt;&nbsp;<br>&lt;dependency&gt;&nbsp;<br>&lt;groupId&gt;javax.persistence&lt;/groupId&gt;&nbsp;<br>&lt;artifactId&gt;persistence-api&lt;/artifactId&gt;&nbsp;<br>&lt;version&gt;1.0&lt;/version&gt;&nbsp;<br>&lt;/dependency&gt;&nbsp;<br>â€¦&nbsp;<br>ã€€ã€€ä¸‹ä¸€æ­¥å°±æ˜¯è·å– Hibernate ä¼šè¯å·¥å‚ã€‚å°½ç®¡æ— éœ€æƒŠå¤©çš„ä¿®æ”¹ï¼Œä½†è¿™ä¸€å·¥ä½œä¸ä½¿ç”¨ Hibernate Annotationsæœ‰æ‰€ä¸åŒã€‚æ‚¨éœ€è¦ä½¿ç”¨ AnnotationConfiguration ç±»æ¥å»ºç«‹ä¼šè¯å·¥å‚ï¼š</p>
<p>sessionFactory = new&nbsp;<br>AnnotationConfiguration().buildSessionFactory();&nbsp;<br>ã€€ã€€å°½ç®¡é€šå¸¸ä½¿ç”¨ &lt;mapping&gt; å…ƒç´ æ¥å£°æ˜æŒä¹…æ€§ç±»ï¼Œæ‚¨è¿˜æ˜¯éœ€è¦åœ¨ Hibernate é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ hibernate.cfg.xmlï¼‰ä¸­å£°æ˜æŒä¹…æ€§ç±»ï¼š</p>
<p>&lt;!DOCTYPE hibernate-configuration PUBLIC&nbsp;<br>â€œ-//Hibernate/Hibernate Configuration DTD 3.0//ENâ€&nbsp;<br>â€œ<a href="http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd" target="_blank" rel="noopener">http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd</a>â€œ&gt;&nbsp;<br>&lt;hibernate-configuration&gt;&nbsp;<br>&lt;session-factory&gt;&nbsp;<br>&lt;mapping class=â€com.onjava.modelplanes.domain.PlaneTypeâ€/&gt;&nbsp;<br>&lt;mapping class=â€com.onjava.modelplanes.domain.ModelPlaneâ€/&gt;&nbsp;<br>&lt;/session-factory&gt;&nbsp;<br>&lt;/hibernate-configuration&gt;&nbsp;<br>ã€€ã€€è¿‘æœŸçš„è®¸å¤š Java é¡¹ç›®éƒ½ä½¿ç”¨äº†è½»é‡çº§çš„åº”ç”¨æ¡†æ¶ï¼Œä¾‹å¦‚ Springã€‚å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Spring æ¡†æ¶ï¼Œå¯ä»¥ä½¿ç”¨ AnnotationSessionFactoryBean ç±»è½»æ¾å»ºç«‹ä¸€ä¸ªåŸºäºæ³¨é‡Šçš„ Hibernate ä¼šè¯å·¥å‚ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>&lt;!â€“ Hibernate session factory â€“&gt;&nbsp;<br>&lt;bean id=â€sessionFactoryâ€&nbsp;<br>class=â€org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBeanâ€&gt;&nbsp;<br>&lt;property name=â€dataSourceâ€&gt;&nbsp;<br>&lt;ref bean=â€dataSourceâ€/&gt;&nbsp;<br>&lt;/property&gt;&nbsp;<br>&lt;property name=â€hibernatePropertiesâ€&gt;&nbsp;<br>&lt;props&gt;&nbsp;<br>&lt;prop key=â€hibernate.dialectâ€&gt;org.hibernate.dialect.DerbyDialect&lt;/prop&gt;&nbsp;<br>&lt;prop key=â€hibernate.hbm2ddl.autoâ€&gt;create&lt;/prop&gt;&nbsp;<br>â€¦&nbsp;<br>&lt;/props&gt;&nbsp;<br>&lt;/property&gt;&nbsp;<br>&lt;property name=â€annotatedClassesâ€&gt;&nbsp;<br>&lt;list&gt;&nbsp;<br>&lt;value&gt;com.onjava.modelplanes.domain.PlaneType&lt;/value&gt;&nbsp;<br>&lt;value&gt;com.onjava.modelplanes.domain.ModelPlane&lt;/value&gt;&nbsp;<br>â€¦&nbsp;<br>&lt;/list&gt;&nbsp;<br>&lt;/property&gt;&nbsp;<br>&lt;/bean&gt;&nbsp;<br>ç¬¬ä¸€ä¸ªæŒä¹…æ€§ç±»&nbsp;<br>ã€€ã€€æ—¢ç„¶å·²ç»çŸ¥é“äº†å¦‚ä½•è·å¾—æ³¨é‡Šæ‰€æ”¯æŒçš„ Hibernate ä¼šè¯ï¼Œä¸‹é¢è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹å¸¦æ³¨é‡Šçš„æŒä¹…æ€§ç±»çš„æƒ…å†µï¼š</p>
<p>ã€€ã€€åƒåœ¨å…¶ä»–ä»»ä½• Hibernateåº”ç”¨ç¨‹åºä¸­ä¸€æ ·ï¼Œå¸¦æ³¨é‡Šçš„æŒä¹…æ€§ç±»ä¹Ÿæ˜¯æ™®é€š POJOã€‚å·®ä¸å¤šå¯ä»¥è¯´æ˜¯ã€‚æ‚¨éœ€è¦å‘ Java æŒä¹…æ€§ API ï¼ˆjavax.persistence.<em>ï¼‰æ·»åŠ ä¾èµ–é¡¹ï¼Œå¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ä»»ä½•ç‰¹å®šäº Hibernateçš„æ‰©å±•ï¼Œé‚£å¾ˆå¯èƒ½å°±æ˜¯ Hibernate Annotation ç¨‹åºåŒ…ï¼ˆorg.hibernate.annotations.</em>ï¼‰ï¼Œä½†é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒä»¬åªæ˜¯å…·å¤‡äº†æŒä¹…æ€§æ³¨é‡Šçš„æ™®é€š POJO ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<p>@Entity&nbsp;<br>public class ModelPlane {&nbsp;<br>private Long id;&nbsp;<br>private String name;&nbsp;<br>@Id&nbsp;<br>public Long getId() {&nbsp;<br>return id;&nbsp;<br>}&nbsp;<br>public void setId(Long id) {&nbsp;<br>this.id = id;&nbsp;<br>}&nbsp;<br>public String getName() {&nbsp;<br>return name;&nbsp;<br>}&nbsp;<br>public void setName(String name) {&nbsp;<br>this.name = name;&nbsp;<br>}&nbsp;<br>}&nbsp;<br>ã€€ã€€æ­£åƒæˆ‘ä»¬æ‰€æåˆ°çš„ï¼Œè¿™éå¸¸ç®€å•ã€‚@Entity æ³¨é‡Šå£°æ˜è¯¥ç±»ä¸ºæŒä¹…ç±»ã€‚@Id æ³¨é‡Šå¯ä»¥è¡¨æ˜å“ªç§å±æ€§æ˜¯è¯¥ç±»ä¸­çš„ç‹¬ç‰¹æ ‡è¯†ç¬¦ã€‚äº‹å®ä¸Šï¼Œæ‚¨æ—¢å¯ä»¥ä¿æŒå­—æ®µï¼ˆæ³¨é‡Šæˆå‘˜å˜é‡ï¼‰ï¼Œä¹Ÿå¯ä»¥ä¿æŒå±æ€§ï¼ˆæ³¨é‡Šgetteræ–¹æ³•ï¼‰çš„æŒä¹…æ€§ã€‚åæ–‡ä¸­å°†ä½¿ç”¨åŸºäºå±æ€§çš„æ³¨é‡Šã€‚åŸºäºæ³¨é‡Šçš„æŒä¹…æ€§çš„ä¼˜ç‚¹ä¹‹ä¸€åœ¨äºå¤§é‡ä½¿ç”¨äº†é»˜è®¤å€¼ï¼ˆæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ &ldquo;æƒ¯ä¾‹ä¼˜å…ˆåŸåˆ™ï¼ˆconvention over configurationï¼‰&rdquo;ï¼‰ã€‚ä¾‹å¦‚ï¼Œæ‚¨æ— éœ€è¯´æ˜æ¯ä¸ªå±æ€§çš„æŒä¹…æ€§&mdash;&mdash;ä»»ä½•å±æ€§éƒ½è¢«å‡å®šä¸ºæŒä¹…çš„ï¼Œé™¤éæ‚¨ä½¿ç”¨ @Transient æ³¨é‡Šæ¥è¯´æ˜å…¶ä»–æƒ…å†µã€‚è¿™ç®€åŒ–äº†ä»£ç ï¼Œç›¸å¯¹ä½¿ç”¨è€çš„ XML æ˜ å°„æ–‡ä»¶è€Œè¨€ä¹Ÿå¤§å¹…åœ°å‡å°‘äº†è¾“å…¥å·¥ä½œé‡ã€‚</p>
<p>ç”Ÿæˆä¸»é”®&nbsp;<br>ã€€ã€€Hibernate èƒ½å¤Ÿå‡ºè‰²åœ°è‡ªåŠ¨ç”Ÿæˆä¸»é”®ã€‚Hibernate/EBJ 3 æ³¨é‡Šä¹Ÿå¯ä»¥ä¸ºä¸»é”®çš„è‡ªåŠ¨ç”Ÿæˆæä¾›ä¸°å¯Œçš„æ”¯æŒï¼Œå…è®¸å®ç°å„ç§ç­–ç•¥ã€‚ä¸‹é¢çš„ç¤ºä¾‹è¯´æ˜äº†ä¸€ç§å¸¸ç”¨çš„æ–¹æ³•ï¼Œå…¶ä¸­ Hibernate å°†ä¼šæ ¹æ®åº•å±‚æ•°æ®åº“æ¥ç¡®å®šä¸€ç§æ°å½“çš„é”®ç”Ÿæˆç­–ç•¥ï¼š</p>
<p>@Id&nbsp;<br>@GeneratedValue(strategy=GenerationType.AUTO)&nbsp;<br>public Long getId() {&nbsp;<br>return id;&nbsp;<br>}&nbsp;<br>å®šåˆ¶è¡¨å’Œå­—æ®µæ˜ å°„&nbsp;<br>ã€€ã€€é»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernate ä¼šå°†æŒä¹…ç±»ä»¥åŒ¹é…çš„åç§°æ˜ å°„åˆ°è¡¨å’Œå­—æ®µä¸­ã€‚ä¾‹å¦‚ï¼Œå‰ä¸€ä¸ªç±»å¯ä»¥ä¸æ˜ å°„åˆ°ä»¥å¦‚ä¸‹ä»£ç åˆ›å»ºçš„è¡¨ä¸­ï¼š</p>
<p>CREATE TABLE MODELPLANE&nbsp;<br>(&nbsp;<br>ID long,&nbsp;<br>NAME varchar&nbsp;<br>)&nbsp;<br>ã€€ã€€å¦‚æœæ‚¨æ˜¯è‡ªå·±ç”Ÿæˆå¹¶ç»´æŠ¤æ•°æ®åº“ï¼Œé‚£ä¹ˆè¿™ç§æ–¹æ³•å¾ˆæœ‰æ•ˆï¼Œé€šè¿‡çœç•¥ä»£ç å¯ä»¥å¤§å¤§ç®€åŒ–ä»£ç ç»´æŠ¤ã€‚ç„¶è€Œï¼Œè¿™å¹¶ä¸èƒ½æ»¡è¶³æ‰€æœ‰äººçš„éœ€æ±‚ã€‚æœ‰äº›åº”ç”¨ç¨‹åºéœ€è¦è®¿é—®å¤–éƒ¨æ•°æ®åº“ï¼Œè€Œå¦ä¸€äº›å¯èƒ½éœ€è¦éµä»å…¬å¸çš„æ•°æ®åº“å‘½åæƒ¯ä¾‹ã€‚å¦‚æœæœ‰å¿…è¦ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ @Table å’Œ @Column æ³¨é‡Šæ¥å®šåˆ¶æ‚¨è‡ªå·±çš„æŒä¹…æ€§æ˜ å°„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>@Entity&nbsp;<br>@Table(name=â€T_MODEL_PLANEâ€)&nbsp;<br>public class ModelPlane {&nbsp;<br>private Long id;&nbsp;<br>private String name;&nbsp;<br>@Id&nbsp;<br>@Column(name=â€PLANE_IDâ€)&nbsp;<br>public Long getId() {&nbsp;<br>return id;&nbsp;<br>}&nbsp;<br>public void setId(Long id) {&nbsp;<br>this.id = id;&nbsp;<br>}&nbsp;<br>@Column(name=â€PLANE_NAMEâ€)&nbsp;<br>public String getName() {&nbsp;<br>return name;&nbsp;<br>}&nbsp;<br>public void setName(String name) {&nbsp;<br>this.name = name;&nbsp;<br>}&nbsp;<br>}&nbsp;<br>ã€€ã€€è¯¥å†…å®¹å°†æ˜ å°„åˆ°ä¸‹è¡¨ä¸­ï¼š</p>
<p>CREATE TABLE T_MODEL_PLANE&nbsp;<br>(&nbsp;<br>PLANE_ID long,&nbsp;<br>PLANE_NAME varchar&nbsp;<br>)&nbsp;<br>ã€€ã€€ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–å›¾å’Œåˆ—çš„å±æ€§æ¥å®šåˆ¶æ˜ å°„ã€‚è¿™ä½¿æ‚¨å¯ä»¥æŒ‡å®šè¯¸å¦‚åˆ—é•¿åº¦ã€éç©ºçº¦æŸç­‰è¯¦ç»†å†…å®¹ã€‚Hibernateæ”¯æŒå¤§é‡é’ˆå¯¹è¿™äº›æ³¨é‡Šçš„å±æ€§ã€‚ä¸‹ä¾‹ä¸­å°±åŒ…å«äº†å‡ ç§å±æ€§ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; â€¦&nbsp;<br>@Column(name=â€PLANE_IDâ€, length=80, nullable=true)&nbsp;<br>public String getName() {&nbsp;<br>return name;&nbsp;<br>}&nbsp;<br>â€¦&nbsp;<br>æ˜ å°„å…³ç³»&nbsp;<br>ã€€ã€€Java æŒä¹…æ€§æ˜ å°„è¿‡ç¨‹ä¸­æœ€é‡è¦å’Œæœ€å¤æ‚çš„ä¸€ç¯å°±æ˜¯ç¡®å®šå¦‚ä½•æ˜ å°„è¡¨é—´çš„å…³ç³»ã€‚åƒå…¶ä»–äº§å“ä¸€æ ·ï¼Œ Hibernate åœ¨è¯¥é¢†åŸŸä¸­æä¾›äº†é«˜åº¦çš„çµæ´»æ€§ï¼Œä½†å´æ˜¯ä»¥å¤æ‚åº¦çš„å¢åŠ ä¸ºä»£ä»·ã€‚æˆ‘ä»¬å°†é€šè¿‡ç ”ç©¶å‡ ä¸ªå¸¸è§æ¡ˆä¾‹æ¥äº†è§£å¦‚ä½•ä½¿ç”¨æ³¨é‡Šæ¥å¤„ç†è¿™ä¸€é—®é¢˜ã€‚</p>
<p>ã€€ã€€å…¶ä¸­ä¸€ç§æœ€å¸¸ç”¨çš„å…³ç³»å°±æ˜¯å¤šå¯¹ä¸€çš„å…³ç³»ã€‚å‡å®šåœ¨ä»¥ä¸Šç¤ºä¾‹ä¸­æ¯ä¸ª ModelPlane é€šè¿‡å¤šå¯¹ä¸€çš„å…³ç³»ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªé£æœºæ¨¡å‹åªä¸ä¸€ç§é£æœºç±»å‹å»ºç«‹è”ç³»ï¼Œå°½ç®¡æŒ‡å®šçš„é£æœºç±»å‹å¯ä»¥ä¸ä¸ƒç§é£æœºæ¨¡å‹å»ºç«‹è”ç³»ï¼‰æ¥ä¸ PlaneType å»ºç«‹è”ç³»ã€‚å¯å¦‚ä¸‹è¿›è¡Œæ˜ å°„ï¼š</p>
<p>&nbsp;&nbsp;&nbsp; @ManyToOne( cascade = {CascadeType.PERSIST, CascadeType.MERGE} )&nbsp;<br>public PlaneType getPlaneType() {&nbsp;<br>return planeType;&nbsp;<br>}&nbsp;<br>ã€€ã€€CascadeType å€¼è¡¨æ˜ Hibernate åº”å¦‚ä½•å¤„ç†çº§è”æ“ä½œã€‚</p>
<p>ã€€ã€€å¦ä¸€ç§å¸¸ç”¨çš„å…³ç³»ä¸ä¸Šè¿°å…³ç³»ç›¸åï¼šä¸€å¯¹å¤šå†å¯¹ä¸€å…³ç³»ï¼Œä¹Ÿç§°ä¸ºé›†åˆã€‚åœ¨è€å¼çš„ Hibernate ç‰ˆæœ¬ä¸­è¿›è¡Œæ˜ å°„æˆ–ä½¿ç”¨æ³¨é‡Šæ—¶ï¼Œé›†åˆä»¤äººå¤´ç–¼ï¼Œè¿™é‡Œæˆ‘ä»¬å°†ç®€è¦åŠ ä»¥æ¢è®¨ï¼Œä»¥ä½¿æ‚¨äº†è§£å¦‚ä½•å¤„ç†é›†åˆï¼Œä¾‹å¦‚ï¼Œåœ¨ä»¥ä¸Šç¤ºä¾‹ä¸­æ¯ä¸ª PlaneType å¯¹è±¡éƒ½å¯èƒ½ä¼šåŒ…å«ä¸€ä¸ª ModelPlanes é›†åˆã€‚å¯æ˜ å°„å¦‚ä¸‹ï¼š</p>
<p>@OneToMany(mappedBy=â€planeTypeâ€,&nbsp;<br>cascade=CascadeType.ALL,&nbsp;<br>fetch=FetchType.EAGER)&nbsp;<br>@OrderBy(â€œnameâ€)&nbsp;<br>public List&lt;ModelPlane&gt; getModelPlanes() {&nbsp;<br>return modelPlanes;&nbsp;<br>}&nbsp;<br>å‘½åæŸ¥è¯¢&nbsp;<br>ã€€ã€€Hibernate æœ€ä¼˜ç§€çš„åŠŸèƒ½ä¹‹ä¸€å°±åœ¨äºå®ƒèƒ½å¤Ÿåœ¨æ‚¨çš„æ˜ å°„æ–‡ä»¶ä¸­å£°æ˜å‘½åæŸ¥è¯¢ã€‚éšåå³å¯é€šè¿‡ä»£ç ä¸­çš„åç§°è°ƒç”¨æ­¤ç±»æŸ¥è¯¢ï¼Œè¿™ä½¿æ‚¨å¯ä»¥ä¸“æ³¨äºæŸ¥è¯¢ï¼Œè€Œé¿å…äº† SQL æˆ–è€… HQL ä»£ç åˆ†æ•£äºæ•´ä¸ªåº”ç”¨ç¨‹åºä¸­çš„æƒ…å†µã€‚</p>
<p>ã€€ã€€ä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨é‡Šæ¥å®ç°å‘½åæŸ¥è¯¢ï¼Œå¯ä»¥ä½¿ç”¨ @NamedQueries å’Œ @NamedQuery æ³¨é‡Šï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>@NamedQueries(&nbsp;<br>{&nbsp;<br>@NamedQuery(&nbsp;<br>name=â€planeType.findByIdâ€,&nbsp;<br>query=â€select p from PlaneType p left join fetch p.modelPlanes where id=:idâ€&nbsp;<br>),&nbsp;<br>@NamedQuery(&nbsp;<br>name=â€planeType.findAllâ€,&nbsp;<br>query=â€select p from PlaneType pâ€&nbsp;<br>),&nbsp;<br>@NamedQuery(&nbsp;<br>name=â€planeType.deleteâ€,&nbsp;<br>query=â€delete from PlaneType where id=:idâ€&nbsp;<br>)&nbsp;<br>}&nbsp;<br>)&nbsp;<br>ã€€ã€€ä¸€æ—¦å®Œæˆäº†å®šä¹‰ï¼Œæ‚¨å°±å¯ä»¥åƒè°ƒç”¨å…¶ä»–ä»»ä½•å…¶ä»–å‘½åæŸ¥è¯¢ä¸€æ ·æ¥è°ƒç”¨å®ƒä»¬ã€‚</p>
<p>ç»“æŸè¯­&nbsp;<br>ã€€ã€€Hibernate 3 æ³¨é‡Šæä¾›äº†å¼ºå¤§è€Œç²¾è‡´çš„ APIï¼Œç®€åŒ–äº† Java æ•°æ®åº“ä¸­çš„æŒä¹…æ€§ä»£ç ï¼Œæœ¬æ–‡ä¸­åªè¿›è¡Œäº†ç®€å•çš„è®¨è®ºã€‚æ‚¨å¯ä»¥é€‰æ‹©éµä»æ ‡å‡†å¹¶ä½¿ç”¨ Java æŒä¹…æ€§ APIï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ç‰¹å®šäº Hibernateçš„æ‰©å±•ï¼Œè¿™äº›åŠŸèƒ½ä»¥æŸå¤±å¯ç§»æ¤æ€§ä¸ºä»£ä»·æä¾›äº†æ›´ä¸ºå¼ºå¤§çš„åŠŸèƒ½å’Œæ›´é«˜çš„çµæ´»æ€§ã€‚æ— è®ºå¦‚ä½•ï¼Œé€šè¿‡æ¶ˆé™¤å¯¹ XML æ˜ å°„æ–‡ä»¶çš„éœ€æ±‚ï¼ŒHibernate æ³¨é‡Šå°†ç®€åŒ–åº”ç”¨ç¨‹åºçš„ç»´æŠ¤ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä½¿æ‚¨å¯¹EJB 3 æœ‰åˆæ­¥è®¤è¯†ã€‚æ¥è¯•è¯•å§ï¼&nbsp;<br>&nbsp;<br>&nbsp;<br>æœ¬æ–‡æ¥è‡ªCSDNåšå®¢ï¼Œè½¬è½½è¯·æ ‡æ˜å‡ºå¤„ï¼š<a href="http://blog.csdn.net/dingqinghu/archive/2011/03/25/6275798.aspx" target="_blank" rel="noopener">http://blog.csdn.net/dingqinghu/archive/2011/03/25/6275798.aspx</a></p>
]]></content>
      
        
        <tags>
            
            <tag> orm </tag>
            
            <tag> j2ee </tag>
            
            <tag> java web </tag>
            
            <tag> Hibernate </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javaä½¿ç”¨åŠ¨æ€ä»£ç†æ¥å®ç°AOPï¼ˆæ—¥å¿—è®°å½•ï¼‰]]></title>
      <url>/2013/09/24/java%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E6%9D%A5%E5%AE%9E%E7%8E%B0AOP%EF%BC%88%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%EF%BC%89/</url>
      <content type="html"><![CDATA[<p><span style="line-height: 1.5;">AOPï¼ˆé¢å‘æ–¹é¢ï¼‰çš„æ€æƒ³ï¼Œå°±æ˜¯æŠŠé¡¹ç›®å…±åŒçš„é‚£éƒ¨åˆ†åŠŸèƒ½åˆ†ç¦»å¼€æ¥ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ï¼Œé¿å…åœ¨ä¸šåŠ¡é€»è¾‘é‡Œé¢å¤¹æ‚ç€è·Ÿä¸šåŠ¡é€»è¾‘æ— å…³çš„ä»£ç ã€‚</span></p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªAOPå®ç°çš„ç®€å•ä¾‹å­ï¼š</p>
<p><img src="http://images.cnitblog.com/blog/378300/201309/24111801-c8f719406a074bf5805d2a94ac2dcccb.jpg" alt=""></p>
<p>é¦–å…ˆå®šä¹‰ä¸€äº›ä¸šåŠ¡æ–¹æ³•ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;"> <em> Created with IntelliJ IDEA.<br></em></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">  Author: wangjie  email:tiantian.china.2@gmail.com<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;"> <em> Date: 13-9-23<br></em></span><span style="color: #008080;"> 5</span> <span style="color: #008000;">  Time: ä¸‹åˆ3:49<br></span><span style="color: #008080;"> 6</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> BussinessService {<br></span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String login(String username, String password);<br></span><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String find();<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">11</span><br><span style="color: #008080;">12</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> BussinessServiceImpl <span style="color: #0000ff;">implements</span><span style="color: #000000;"> BussinessService {<br></span><span style="color: #008080;">13</span>     <span style="color: #0000ff;">private</span> Logger logger = Logger.getLogger(<span style="color: #0000ff;">this</span><span style="color: #000000;">.getClass().getSimpleName());<br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">16</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String login(String username, String password) {<br></span><span style="color: #008080;">17</span>         <span style="color: #0000ff;">return</span> â€œlogin successâ€<span style="color: #000000;">;<br></span><span style="color: #008080;">18</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">19</span><br><span style="color: #008080;">20</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String find() {<br></span><span style="color: #008080;">22</span>         <span style="color: #0000ff;">return</span> â€œfind successâ€<span style="color: #000000;">;<br></span><span style="color: #008080;">23</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span> }</pre><br></div><br><div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/</span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;"> <em> Created with IntelliJ IDEA.<br></em></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">  Author: wangjie  email:tiantian.china.2@gmail.com<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;"> <em> Date: 13-9-24<br></em></span><span style="color: #008080;"> 5</span> <span style="color: #008000;">  Time: ä¸Šåˆ10:27<br></span><span style="color: #008080;"> 6</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> WorkService {<br></span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String work();<br></span><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String sleep();<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">}<br></span><span style="color: #008080;">11</span><br><span style="color: #008080;">12</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> WorkServiceImpl <span style="color: #0000ff;">implements</span><span style="color: #000000;"> WorkService{<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">14</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String work() {<br></span><span style="color: #008080;">15</span>         <span style="color: #0000ff;">return</span> â€œwork successâ€<span style="color: #000000;">;<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">19</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> String sleep() {<br></span><span style="color: #008080;">20</span>         <span style="color: #0000ff;">return</span> â€œsleep successâ€<span style="color: #000000;">;<br></span><span style="color: #008080;">21</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">22</span> }</pre><br></div>

<p>å®ç°InvocationHandleræ¥å£ï¼Œä½¿ç”¨mapæ¥å­˜å‚¨ä¸åŒçš„InvocationHandlerå¯¹è±¡ï¼Œé¿å…ç”Ÿæˆè¿‡å¤šã€‚</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.aoptest2.invohandler;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.InvocationHandler;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Method;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Proxy;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Arrays;<br></span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.HashMap;<br></span><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.logging.Logger;<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">11</span> <span style="color: #008000;"> <em> Created with IntelliJ IDEA.<br></em></span><span style="color: #008080;">12</span> <span style="color: #008000;">  Author: wangjie  email:tiantian.china.2@gmail.com<br></span><span style="color: #008080;">13</span> <span style="color: #008000;"> <em> Date: 13-9-23<br></em></span><span style="color: #008080;">14</span> <span style="color: #008000;">  Time: ä¸‹åˆ3:47<br></span><span style="color: #008080;">15</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;">16</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> LogInvoHandler <span style="color: #0000ff;">implements</span><span style="color: #000000;"> InvocationHandler{<br></span><span style="color: #008080;">17</span>     <span style="color: #0000ff;">private</span> Logger logger = Logger.getLogger(<span style="color: #0000ff;">this</span><span style="color: #000000;">.getClass().getSimpleName());<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span>     <span style="color: #0000ff;">private</span> Object target; <span style="color: #008000;">//</span><span style="color: #008000;"> ä»£ç†ç›®æ ‡</span><br><span style="color: #008080;">20</span>     <span style="color: #0000ff;">private</span> Object proxy; <span style="color: #008000;">//</span><span style="color: #008000;"> ä»£ç†å¯¹è±¡</span><br><span style="color: #008080;">21</span><br><span style="color: #008080;">22</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> HashMap&lt;Class&lt;?&gt;, LogInvoHandler&gt; invoHandlers = <span style="color: #0000ff;">new</span> HashMap&lt;Class&lt;?&gt;, LogInvoHandler&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">23</span><br><span style="color: #008080;">24</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> LogInvoHandler() {<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">28</span> <span style="color: #008000;">     <em> é€šè¿‡Classæ¥ç”ŸæˆåŠ¨æ€ä»£ç†å¯¹è±¡Proxy<br></em></span><span style="color: #008080;">29</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> clazz<br></span><span style="color: #008080;">30</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><br><span style="color: #008080;">31</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">32</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">synchronized</span> <span style="color: #0000ff;">static</span>&lt;T&gt; T getProxyInstance(Class&lt;T&gt;<span style="color: #000000;"> clazz){<br></span><span style="color: #008080;">33</span>         LogInvoHandler invoHandler =<span style="color: #000000;"> invoHandlers.get(clazz);<br></span><span style="color: #008080;">34</span><br><span style="color: #008080;">35</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> invoHandler){<br></span><span style="color: #008080;">36</span>             invoHandler = <span style="color: #0000ff;">new</span><span style="color: #000000;"> LogInvoHandler();<br></span><span style="color: #008080;">37</span>             <span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">38</span>                 T tar =<span style="color: #000000;"> clazz.newInstance();<br></span><span style="color: #008080;">39</span> <span style="color: #000000;">                invoHandler.setTarget(tar);<br></span><span style="color: #008080;">40</span> <span style="color: #000000;">                invoHandler.setProxy(Proxy.newProxyInstance(tar.getClass().getClassLoader(),<br></span><span style="color: #008080;">41</span> <span style="color: #000000;">                        tar.getClass().getInterfaces(), invoHandler));<br></span><span style="color: #008080;">42</span>             } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {<br></span><span style="color: #008080;">43</span> <span style="color: #000000;">                e.printStackTrace();<br></span><span style="color: #008080;">44</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">            invoHandlers.put(clazz, invoHandler);<br></span><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">48</span><br><span style="color: #008080;">49</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> (T)invoHandler.getProxy();<br></span><span style="color: #008080;">50</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">51</span><br><span style="color: #008080;">52</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">53</span>     <span style="color: #0000ff;">public</span> Object invoke(Object proxy, Method method, Object[] args) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Throwable {<br></span><span style="color: #008080;">54</span><br><span style="color: #008080;">55</span>         Object result = method.invoke(target, args); <span style="color: #008000;">//</span><span style="color: #008000;"> æ‰§è¡Œä¸šåŠ¡å¤„ç†<br></span><span style="color: #008080;">56</span><br><span style="color: #008080;">57</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> æ‰“å°æ—¥å¿—</span><br><span style="color: #008080;">58</span>         logger.info(â€œ____invoke method: â€œ +<span style="color: #000000;"> method.getName()<br></span><span style="color: #008080;">59</span>                     + â€œ; args: â€œ + (<span style="color: #0000ff;">null</span> == args ? â€œnullâ€<span style="color: #000000;"> : Arrays.asList(args).toString())<br></span><span style="color: #008080;">60</span>                     + â€œ; return: â€œ +<span style="color: #000000;"> result);<br></span><span style="color: #008080;">61</span><br><span style="color: #008080;">62</span><br><span style="color: #008080;">63</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> result;<br></span><span style="color: #008080;">64</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">65</span><br><span style="color: #008080;">66</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Object getTarget() {<br></span><span style="color: #008080;">67</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> target;<br></span><span style="color: #008080;">68</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">69</span><br><span style="color: #008080;">70</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setTarget(Object target) {<br></span><span style="color: #008080;">71</span>         <span style="color: #0000ff;">this</span>.target =<span style="color: #000000;"> target;<br></span><span style="color: #008080;">72</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">73</span><br><span style="color: #008080;">74</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Object getProxy() {<br></span><span style="color: #008080;">75</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> proxy;<br></span><span style="color: #008080;">76</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">77</span><br><span style="color: #008080;">78</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setProxy(Object proxy) {<br></span><span style="color: #008080;">79</span>         <span style="color: #0000ff;">this</span>.proxy =<span style="color: #000000;"> proxy;<br></span><span style="color: #008080;">80</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">81</span> }</pre><br></div>

<p>&nbsp;</p>
<p>ç„¶åç¼–å†™ä¸€ä¸ªTestç±»æµ‹è¯•ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">  Created with IntelliJ IDEA.<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;"> <em> Author: wangjie  email:tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Date: 13-9-24<br></span><span style="color: #008080;"> 5</span> <span style="color: #008000;"> <em> Time: ä¸Šåˆ9:54<br></em></span><span style="color: #008080;"> 6</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Test {<br></span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Logger logger = Logger.getLogger(Test.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getSimpleName());<br></span><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {<br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span>         BussinessService bs = LogInvoHandler.getProxyInstance(BussinessServiceImpl.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br></span><span style="color: #008080;">12</span>         bs.login(â€œzhangsanâ€, â€œ123456â€<span style="color: #000000;">);<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">        bs.find();<br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span>         logger.info(â€œâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“â€<span style="color: #000000;">);<br></span><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span>         WorkService ws = LogInvoHandler.getProxyInstance(WorkServiceImpl.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br></span><span style="color: #008080;">18</span> <span style="color: #000000;">        ws.work();<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">        ws.sleep();<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>         logger.info(â€œâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“â€<span style="color: #000000;">);<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span>         BussinessService bss = LogInvoHandler.getProxyInstance(BussinessServiceImpl.<span style="color: #0000ff;">class</span><span style="color: #000000;">);<br></span><span style="color: #008080;">24</span>         bss.login(â€œlisiâ€, â€œ654321â€<span style="color: #000000;">);<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">        bss.find();<br></span><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">28</span> }</pre><br></div>

<p>ä»¥åéœ€è¦æ·»åŠ æ–°çš„ä¸šåŠ¡é€»è¾‘XXXServiceï¼Œåªéœ€è¦è°ƒç”¨</p>
<p>XXXService xs = LogInvoHandler.getProxyInstance(XXXServiceImpl.class);</p>
<p>å³å¯ã€‚</p>
<p>ä¹Ÿå¯ä»¥æ¨¡ä»¿Springç­‰æ¡†æ¶çš„é…ç½®ï¼ŒæŠŠbeançš„ç±»åé…ç½®åœ¨xmlæ–‡ä»¶ä¸­ï¼Œå¦‚ï¼š</p>
<p>&lt;bean id=â€bussinessServiceâ€ class=â€com.wangjie.aoptest2.service.impl.BussinessServiceImplâ€&gt;</p>
<p>ç„¶ååœ¨javaä»£ç ä¸­è§£æxmlï¼Œé€šè¿‡Class.forName(â€œcom.wangjie.aoptest2.service.impl.BussinessServiceImplâ€);è·å¾—Classå¯¹è±¡</p>
<p>ç„¶åé€šè¿‡LogInvoHandler.getProxyInstance(Class.forName(â€œcom.wangjie.aoptest2.service.impl.BussinessServiceImplâ€));è·å¾—ä»£ç†å¯¹è±¡Proxy</p>
<p>å†ä½¿ç”¨åå°„å»è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<p>&nbsp;</p>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p>ä¹æœˆ 24, 2013 11:08:03 ä¸Šåˆ com.wangjie.aoptest2.invohandler.LogInvoHandler invoke<br>INFO: <strong><strong>invoke method: login; args: [zhangsan, 123456]; return: login success<br>ä¹æœˆ 24, 2013 11:08:03 ä¸Šåˆ com.wangjie.aoptest2.invohandler.LogInvoHandler invoke<br>INFO: </strong></strong>invoke method: find; args: null; return: find success<br>ä¹æœˆ 24, 2013 11:08:03 ä¸Šåˆ com.wangjie.aoptest2.Test main<br>INFO: â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“<br>ä¹æœˆ 24, 2013 11:08:03 ä¸Šåˆ com.wangjie.aoptest2.invohandler.LogInvoHandler invoke<br>INFO: <strong><strong>invoke method: work; args: null; return: work success<br>ä¹æœˆ 24, 2013 11:08:03 ä¸Šåˆ com.wangjie.aoptest2.invohandler.LogInvoHandler invoke<br>INFO: </strong></strong>invoke method: sleep; args: null; return: sleep success<br>ä¹æœˆ 24, 2013 11:08:03 ä¸Šåˆ com.wangjie.aoptest2.Test main<br>INFO: â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“<br>ä¹æœˆ 24, 2013 11:08:03 ä¸Šåˆ com.wangjie.aoptest2.invohandler.LogInvoHandler invoke<br>INFO: <strong><strong>invoke method: login; args: [lisi, 654321]; return: login success<br>ä¹æœˆ 24, 2013 11:08:03 ä¸Šåˆ com.wangjie.aoptest2.invohandler.LogInvoHandler invoke<br>INFO: </strong></strong>invoke method: find; args: null; return: find success</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> aop </tag>
            
            <tag> dynamic proxy </tag>
            
            <tag> log </tag>
            
            <tag> logger </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidè‡ªå®šä¹‰ScrollViewåˆ†æ®µåŠ è½½å¤§æ–‡æœ¬æ•°æ®åˆ°TextView]]></title>
      <url>/2013/09/10/Android%E8%87%AA%E5%AE%9A%E4%B9%89ScrollView%E5%88%86%E6%AE%B5%E5%8A%A0%E8%BD%BD%E5%A4%A7%E6%96%87%E6%9C%AC%E6%95%B0%E6%8D%AE%E5%88%B0TextView/</url>
      <content type="html"><![CDATA[<p>è¿™æ˜¯æˆ‘ç°åœ¨ç¢°åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœéœ€è¦åœ¨TextViewä¸­åŠ è½½å¤§æ–‡æœ¬çš„æ—¶å€™ï¼Œæ¯”å¦‚å‡ Mçš„txtæ–‡ä»¶æ—¶ï¼ŒTextViewè½½å…¥çš„æ—¶å€™ä¼šå‡ºç°å¡æ­»çš„ç°è±¡ï¼Œç”šè‡³ä¼šå‡ºç°å¼‚å¸¸ç­‰å¾…é€€å‡ºå‡ºç°ã€‚</p>
<p>è§£å†³åŠæ³•ä¹‹ä¸€å°±æ˜¯é€šè¿‡&ldquo;åˆ†æ®µ&rdquo;æˆ–&ldquo;åˆ†é¡µ&rdquo;æ¥æ˜¾ç¤ºæ•°æ®ï¼Œåœ¨TextViewï¼ˆåµŒå…¥åœ¨ScrollViewä¹‹ä¸­å®ç°äº†TextViewçš„æ»šåŠ¨ï¼‰ä¸­æ»šåŠ¨åˆ°åº•éƒ¨çš„æ—¶å€™ï¼Œå†å»åŠ è½½ä¸‹ä¸€éƒ¨åˆ†çš„æ•°æ®ï¼Œä¾æ¬¡ç±»æ¨ï¼Œè¿™æ ·æ¯æ¬¡åŠ è½½çš„æ•°æ®ç›¸å¯¹æ¥è¯´éƒ½æ¯”è¾ƒå°ï¼Œä¸ä¼šå‡ºç°å¡é¡¿çš„ç°è±¡ã€‚</p>
<p>é‡åˆ°çš„é—®é¢˜æ˜¯ï¼Œå¦‚ä½•ç›‘å¬ScrollViewæ»šåŠ¨çš„ä½ç½®ï¼ˆæ»šåŠ¨åˆ°é¡¶éƒ¨è¿˜æ˜¯åº•éƒ¨ï¼Ÿï¼‰ã€‚</p>
<p>&nbsp;</p>
<p>å¦‚ä¸‹ï¼Œé€šè¿‡è‡ªå®šä¹‰ScrollViewç±»(BorderScrollView)ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.bigtextloadtest;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.content.Context;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.graphics.Rect;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.util.AttributeSet;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.ScrollView;<br></span><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 9</span> <span style="color: #008000;"> <em> Created with IntelliJ IDEA.<br></em></span><span style="color: #008080;">10</span> <span style="color: #008000;">  Author: wangjie  email:tiantian.china.2@gmail.com<br></span><span style="color: #008080;">11</span> <span style="color: #008000;"> <em> Date: 13-9-6<br></em></span><span style="color: #008080;">12</span> <span style="color: #008000;">  Time: ä¸‹åˆ2:06<br></span><span style="color: #008080;">13</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;">14</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> BorderScrollView <span style="color: #0000ff;">extends</span><span style="color: #000000;"> ScrollView{<br></span><span style="color: #008080;">15</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> millis;<br></span><span style="color: #008080;">16</span>     <span style="color: #008000;">//</span><span style="color: #008000;"> æ»šåŠ¨ç›‘å¬è€…</span><br><span style="color: #008080;">17</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> OnScrollChangedListener onScrollChangedListener;<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> BorderScrollView(Context context) {<br></span><span style="color: #008080;">20</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context);<br></span><span style="color: #008080;">21</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> BorderScrollView(Context context, AttributeSet attrs) {<br></span><span style="color: #008080;">24</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, attrs);<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span>     <span style="color: #0000ff;">public</span> BorderScrollView(Context context, AttributeSet attrs, <span style="color: #0000ff;">int</span><span style="color: #000000;"> defStyle) {<br></span><span style="color: #008080;">28</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">(context, attrs, defStyle);<br></span><span style="color: #008080;">29</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">32</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> onScrollChanged(<span style="color: #0000ff;">int</span> l, <span style="color: #0000ff;">int</span> t, <span style="color: #0000ff;">int</span> oldl, <span style="color: #0000ff;">int</span><span style="color: #000000;"> oldt) {<br></span><span style="color: #008080;">33</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onScrollChanged(l, t, oldl, oldt);<br></span><span style="color: #008080;">34</span><br><span style="color: #008080;">35</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> onScrollChangedListener){<br></span><span style="color: #008080;">36</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;">37</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">38</span><br><span style="color: #008080;">39</span>         <span style="color: #0000ff;">long</span> now =<span style="color: #000000;"> System.currentTimeMillis();<br></span><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> é€šçŸ¥ç›‘å¬è€…å½“å‰æ»šåŠ¨çš„å…·ä½“ä¿¡æ¯</span><br><span style="color: #008080;">42</span> <span style="color: #000000;">        onScrollChangedListener.onScrollChanged(l, t, oldl, oldt);<br></span><span style="color: #008080;">43</span><br><span style="color: #008080;">44</span>         <span style="color: #0000ff;">if</span>(now - millis &gt; 1000l<span style="color: #000000;">){<br></span><span style="color: #008080;">45</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> æ»šåŠ¨åˆ°åº•éƒ¨ï¼ˆå‰æï¼šä»ä¸æ˜¯åº•éƒ¨æ»šåŠ¨åˆ°åº•éƒ¨ï¼‰</span><br><span style="color: #008080;">46</span>             <span style="color: #0000ff;">if</span>((<span style="color: #0000ff;">this</span>.getHeight() + oldt) != <span style="color: #0000ff;">this</span><span style="color: #000000;">.getTotalVerticalScrollRange()<br></span><span style="color: #008080;">47</span>                     &amp;&amp; (<span style="color: #0000ff;">this</span>.getHeight() + t) == <span style="color: #0000ff;">this</span><span style="color: #000000;">.getTotalVerticalScrollRange()){<br></span><span style="color: #008080;">48</span><br><span style="color: #008080;">49</span>                 onScrollChangedListener.onScrollBottom(); <span style="color: #008000;">//</span><span style="color: #008000;"> é€šçŸ¥ç›‘å¬è€…æ»šåŠ¨åˆ°åº•éƒ¨</span><br><span style="color: #008080;">50</span><br><span style="color: #008080;">51</span>                 millis =<span style="color: #000000;"> now;<br></span><span style="color: #008080;">52</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">53</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">54</span><br><span style="color: #008080;">55</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> æ»šåŠ¨åˆ°é¡¶éƒ¨ï¼ˆå‰æï¼šä»ä¸æ˜¯é¡¶éƒ¨æ»šåŠ¨åˆ°é¡¶éƒ¨ï¼‰</span><br><span style="color: #008080;">56</span>         <span style="color: #0000ff;">if</span>(oldt != 0 &amp;&amp; t == 0<span style="color: #000000;">){<br></span><span style="color: #008080;">57</span>             onScrollChangedListener.onScrollTop(); <span style="color: #008000;">//</span><span style="color: #008000;"> é€šçŸ¥ç›‘å¬è€…æ»šåŠ¨åˆ°é¡¶éƒ¨</span><br><span style="color: #008080;">58</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">59</span><br><span style="color: #008080;">60</span><br><span style="color: #008080;">61</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">62</span><br><span style="color: #008080;">63</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> OnScrollChangedListener getOnScrollChangedListener() {<br></span><span style="color: #008080;">64</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> onScrollChangedListener;<br></span><span style="color: #008080;">65</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">66</span><br><span style="color: #008080;">67</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setOnScrollChangedListener(OnScrollChangedListener onScrollChangedListener) {<br></span><span style="color: #008080;">68</span>         <span style="color: #0000ff;">this</span>.onScrollChangedListener =<span style="color: #000000;"> onScrollChangedListener;<br></span><span style="color: #008080;">69</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">70</span><br><span style="color: #008080;">71</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">72</span> <span style="color: #008000;">     <em> è·å¾—æ»šåŠ¨æ€»é•¿åº¦<br></em></span><span style="color: #008080;">73</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><br><span style="color: #008080;">74</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">75</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getTotalVerticalScrollRange() {<br></span><span style="color: #008080;">76</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">.computeVerticalScrollRange();<br></span><span style="color: #008080;">77</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">78</span><br><span style="color: #008080;">79</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">80</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> computeScrollDeltaToGetChildRectOnScreen(Rect rect) {<br></span><span style="color: #008080;">81</span>         <span style="color: #0000ff;">return</span> 0; <span style="color: #008000;">//</span><span style="color: #008000;"> ç¦æ­¢ScrollViewåœ¨å­æ§ä»¶çš„å¸ƒå±€æ”¹å˜æ—¶è‡ªåŠ¨æ»šåŠ¨</span><br><span style="color: #008080;">82</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">83</span><br><span style="color: #008080;">84</span> }</pre><br></div>

<p>&nbsp;</p>
<p>æ»šåŠ¨ç›‘å¬å™¨æ¥å£OnScrollChangedListenerï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.bigtextloadtest;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 4</span> <span style="color: #008000;"> <em> Created with IntelliJ IDEA.<br></em></span><span style="color: #008080;"> 5</span> <span style="color: #008000;">  Author: wangjie  email:tiantian.china.2@gmail.com<br></span><span style="color: #008080;"> 6</span> <span style="color: #008000;"> <em> Date: 13-9-6<br></em></span><span style="color: #008080;"> 7</span> <span style="color: #008000;">  Time: ä¸‹åˆ2:53<br></span><span style="color: #008080;"> 8</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> OnScrollChangedListener {<br></span><span style="color: #008080;">10</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">11</span> <span style="color: #008000;">     <em> ç›‘å¬æ»šåŠ¨å˜åŒ–<br></em></span><span style="color: #008080;">12</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> l<br></span><span style="color: #008080;">13</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> t<br></span><span style="color: #008080;">14</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> oldl<br></span><span style="color: #008080;">15</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> oldt<br></span><span style="color: #008080;">16</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onScrollChanged(<span style="color: #0000ff;">int</span> l, <span style="color: #0000ff;">int</span> t, <span style="color: #0000ff;">int</span> oldl, <span style="color: #0000ff;">int</span><span style="color: #000000;"> oldt);<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">20</span> <span style="color: #008000;">     <em> ç›‘å¬æ»šåŠ¨åˆ°é¡¶éƒ¨<br></em></span><span style="color: #008080;">21</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">22</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onScrollTop();<br></span><span style="color: #008080;">23</span><br><span style="color: #008080;">24</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">25</span> <span style="color: #008000;">     <em> ç›‘å¬æ»šåŠ¨åˆ°åº•éƒ¨<br></em></span><span style="color: #008080;">26</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">27</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onScrollBottom();<br></span><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span> }</pre><br></div>

<p>&nbsp;</p>
<p>æ»šåŠ¨ç›‘å¬å™¨çš„ç©ºå®ç°OnScrollChangedListenerSimpleï¼ˆç®€æ´çœŸæ­£ç”¨æ—¶å€™çš„ä»£ç ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.bigtextloadtest;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 4</span> <span style="color: #008000;">  Created with IntelliJ IDEA.<br></span><span style="color: #008080;"> 5</span> <span style="color: #008000;"> <em> Author: wangjie  email:tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;"> 6</span> <span style="color: #008000;">  Date: 13-9-9<br></span><span style="color: #008080;"> 7</span> <span style="color: #008000;"> <em> Time: ä¸‹åˆ2:39<br></em></span><span style="color: #008080;"> 8</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> OnScrollChangedListenerSimple <span style="color: #0000ff;">implements</span><span style="color: #000000;"> OnScrollChangedListener{<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">11</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onScrollChanged(<span style="color: #0000ff;">int</span> l, <span style="color: #0000ff;">int</span> t, <span style="color: #0000ff;">int</span> oldl, <span style="color: #0000ff;">int</span><span style="color: #000000;"> oldt) {}<br></span><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">14</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onScrollTop() {}<br></span><span style="color: #008080;">15</span><br><span style="color: #008080;">16</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onScrollBottom() {}<br></span><span style="color: #008080;">18</span> }</pre><br></div>

<p>&nbsp;</p>
<p>å¼‚æ­¥åŠ è½½åˆ†æ®µæ–‡æœ¬ï¼ˆè¿™é‡Œæ¯æ¬¡åŠ è½½50è¡Œï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.bigtextloadtest;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.content.Context;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.AsyncTask;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.Handler;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.view.View;<br></span><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span> java.io.<em><span style="color: #000000;">;<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #008000;">/**</span><br><span style="color: #008080;">11</span> <span style="color: #008000;"> </span></em> Created with IntelliJ IDEA.<br><span style="color: #008080;">12</span> <span style="color: #008000;"> <em> Author: wangjie  email:tiantian.china.2@gmail.com<br></em></span><span style="color: #008080;">13</span> <span style="color: #008000;">  Date: 13-9-6<br></span><span style="color: #008080;">14</span> <span style="color: #008000;"> <em> Time: ä¸Šåˆ11:34<br></em></span><span style="color: #008080;">15</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;">16</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> AsyncTextLoadTask <span style="color: #0000ff;">extends</span> AsyncTask&lt;Object, String, String&gt;<span style="color: #000000;"> {<br></span><span style="color: #008080;">17</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Context context;<br></span><span style="color: #008080;">18</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> MainActivity activity;<br></span><span style="color: #008080;">19</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> BufferedReader br;<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> AsyncTextLoadTask(Context context, BufferedReader br) {<br></span><span style="color: #008080;">22</span>         <span style="color: #0000ff;">this</span>.context =<span style="color: #000000;"> context;<br></span><span style="color: #008080;">23</span>         <span style="color: #0000ff;">this</span>.br =<span style="color: #000000;"> br;<br></span><span style="color: #008080;">24</span>         activity =<span style="color: #000000;"> (MainActivity)context;<br></span><span style="color: #008080;">25</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">28</span>     <span style="color: #0000ff;">protected</span><span style="color: #000000;"> String doInBackground(Objectâ€¦ params) {<br></span><span style="color: #008080;">29</span>         StringBuilder paragraph = <span style="color: #0000ff;">new</span><span style="color: #000000;"> StringBuilder();<br></span><span style="color: #008080;">30</span>         <span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">31</span><br><span style="color: #008080;">32</span>             String line = â€œâ€<span style="color: #000000;">;<br></span><span style="color: #008080;">33</span><br><span style="color: #008080;">34</span>             <span style="color: #0000ff;">int</span> index = 0<span style="color: #000000;">;<br></span><span style="color: #008080;">35</span>             <span style="color: #0000ff;">while</span>(index &lt; 50 &amp;&amp; (line = br.readLine()) != <span style="color: #0000ff;">null</span><span style="color: #000000;">){<br></span><span style="color: #008080;">36</span>                 paragraph.append(line + â€œ\nâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">37</span>                 index++<span style="color: #000000;">;<br></span><span style="color: #008080;">38</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">39</span><br><span style="color: #008080;">40</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException e) {<br></span><span style="color: #008080;">41</span> <span style="color: #000000;">            e.printStackTrace();<br></span><span style="color: #008080;">42</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">43</span><br><span style="color: #008080;">44</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> paragraph.toString();<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span><br><span style="color: #008080;">48</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">49</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onPreExecute() {<br></span><span style="color: #008080;">50</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onPreExecute();<br></span><span style="color: #008080;">51</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">52</span><br><span style="color: #008080;">53</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">54</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onPostExecute(String result) {<br></span><span style="color: #008080;">55</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onPostExecute(result);<br></span><span style="color: #008080;">56</span> <span style="color: #000000;">        activity.contentTv.setText(result);<br></span><span style="color: #008080;">57</span>         <span style="color: #0000ff;">new</span> Handler().postDelayed(<span style="color: #0000ff;">new</span><span style="color: #000000;"> Runnable() {<br></span><span style="color: #008080;">58</span><br><span style="color: #008080;">59</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">60</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> run() {<br></span><span style="color: #008080;">61</span>                 activity.contentScroll.scrollTo(0, 0); <span style="color: #008000;">//</span><span style="color: #008000;"> è®°è½½å®Œæ–°æ•°æ®åæ»šåŠ¨åˆ°é¡¶éƒ¨</span><br><span style="color: #008080;">62</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">63</span>         }, 100<span style="color: #000000;">);<br></span><span style="color: #008080;">64</span>         activity.isLoading = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">65</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">66</span><br><span style="color: #008080;">67</span> }</pre><br></div>

<p>&nbsp;</p>
<p>çœŸæ­£ä½¿ç”¨åˆ†æ®µåŠ è½½æ•°æ®Activityï¼ˆè¿™é‡ŒåŠ è½½ä¸€æœ¬å°è¯´ã€Šç™¾å¹´å­¤ç‹¬ã€‹ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.bigtextloadtest;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.app.Activity;<br></span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.content.Context;<br></span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.os.Bundle;<br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> android.widget.TextView;<br></span><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.BufferedReader;<br></span><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.IOException;<br></span><span style="color: #008080;">10</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.InputStream;<br></span><span style="color: #008080;">11</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.InputStreamReader;<br></span><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainActivity <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Activity {<br></span><span style="color: #008080;">14</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> BorderScrollView contentScroll;<br></span><span style="color: #008080;">15</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> TextView contentTv;<br></span><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> BufferedReader br;<br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Context context;<br></span><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isLoading;<br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span><br><span style="color: #008080;">24</span>     <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">25</span> <span style="color: #008000;">      Called when the activity is first created.<br></span><span style="color: #008080;">26</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">27</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">28</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCreate(Bundle savedInstanceState) {<br></span><span style="color: #008080;">29</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onCreate(savedInstanceState);<br></span><span style="color: #008080;">30</span> <span style="color: #000000;">        setContentView(R.layout.main);<br></span><span style="color: #008080;">31</span>         context = <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;">32</span><br><span style="color: #008080;">33</span>         contentTv =<span style="color: #000000;"> (TextView) findViewById(R.id.content);<br></span><span style="color: #008080;">34</span>         contentScroll =<span style="color: #000000;"> (BorderScrollView) findViewById(R.id.contentScroll);<br></span><span style="color: #008080;">35</span><br><span style="color: #008080;">36</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> æ³¨å†Œåˆšå†™çš„æ»šåŠ¨ç›‘å¬å™¨</span><br><span style="color: #008080;">37</span>         contentScroll.setOnScrollChangedListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> OnScrollChangedListenerSimple(){<br></span><span style="color: #008080;">38</span> <span style="color: #000000;">            @Override<br></span><span style="color: #008080;">39</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onScrollBottom() {<br></span><span style="color: #008080;">40</span>                 <span style="color: #0000ff;">synchronized</span> (MainActivity.<span style="color: #0000ff;">class</span><span style="color: #000000;">){<br></span><span style="color: #008080;">41</span>                     <span style="color: #0000ff;">if</span>(!<span style="color: #000000;">isLoading){<br></span><span style="color: #008080;">42</span>                         isLoading = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">43</span>                         <span style="color: #0000ff;">new</span><span style="color: #000000;"> AsyncTextLoadTask(context, br).execute();<br></span><span style="color: #008080;">44</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">46</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">47</span> <span style="color: #000000;">        });<br></span><span style="color: #008080;">48</span><br><span style="color: #008080;">49</span>         <span style="color: #0000ff;">try</span><span style="color: #000000;">{<br></span><span style="color: #008080;">50</span>             InputStream is = context.getAssets().open(â€œbngd.txtâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">51</span>             br = <span style="color: #0000ff;">new</span> BufferedReader(<span style="color: #0000ff;">new</span><span style="color: #000000;"> InputStreamReader(is));<br></span><span style="color: #008080;">52</span><br><span style="color: #008080;">53</span>             <span style="color: #0000ff;">new</span><span style="color: #000000;"> AsyncTextLoadTask(context, br).execute();<br></span><span style="color: #008080;">54</span><br><span style="color: #008080;">55</span>         }<span style="color: #0000ff;">catch</span><span style="color: #000000;">(Exception ex){<br></span><span style="color: #008080;">56</span> <span style="color: #000000;">            ex.printStackTrace();<br></span><span style="color: #008080;">57</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">58</span><br><span style="color: #008080;">59</span><br><span style="color: #008080;">60</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">61</span><br><span style="color: #008080;">62</span><br><span style="color: #008080;">63</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;">64</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onDestroy() {<br></span><span style="color: #008080;">65</span>         <span style="color: #0000ff;">super</span><span style="color: #000000;">.onDestroy();<br></span><span style="color: #008080;">66</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> br){<br></span><span style="color: #008080;">67</span>             <span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">68</span> <span style="color: #000000;">                br.close();<br></span><span style="color: #008080;">69</span>             } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException e) {<br></span><span style="color: #008080;">70</span> <span style="color: #000000;">                e.printStackTrace();<br></span><span style="color: #008080;">71</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">72</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">73</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">74</span><br><span style="color: #008080;">75</span> }</pre><br></div>

<p>&nbsp;</p>
<p>è´´ä¸Šå¸ƒå±€ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><br><span style="color: #008080;"> 3</span> <span style="color: #ff0000;">              android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><br><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">              android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">              android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;"> 6</span>         <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">com.wangjie.bigtextloadtest.BorderScrollView<br></span><span style="color: #008080;"> 8</span>             <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/contentScrollâ€</span><br><span style="color: #008080;"> 9</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;">10</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;">11</span>             <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">12</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout<br></span><span style="color: #008080;">13</span>                 <span style="color: #ff0000;">android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><br><span style="color: #008080;">14</span> <span style="color: #ff0000;">                android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;">15</span> <span style="color: #ff0000;">                android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;">16</span>                 <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">17</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">TextView<br></span><span style="color: #008080;">18</span>                     <span style="color: #ff0000;">android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;">19</span> <span style="color: #ff0000;">                    android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;">20</span> <span style="color: #ff0000;">                    android:text</span><span style="color: #0000ff;">=â€asdfasdfâ€</span><br><span style="color: #008080;">21</span>                     <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">22</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">TextView<br></span><span style="color: #008080;">23</span>                     <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/contentâ€</span><br><span style="color: #008080;">24</span> <span style="color: #ff0000;">                    android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><br><span style="color: #008080;">25</span> <span style="color: #ff0000;">                    android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><br><span style="color: #008080;">26</span> <span style="color: #ff0000;">                    android:text</span><span style="color: #0000ff;">=â€Hello World, MainActivityâ€</span><br><span style="color: #008080;">27</span>                     <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">28</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">29</span><br><span style="color: #008080;">30</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">com.wangjie.bigtextloadtest.BorderScrollView</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">31</span><br><span style="color: #008080;">32</span><br><span style="color: #008080;">33</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ScrollView </tag>
            
            <tag> TextView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[IOSæ¨é€åŠŸèƒ½çš„å®ç°ï¼ˆjavapnsï¼‰]]></title>
      <url>/2013/06/06/IOS%E6%8E%A8%E9%80%81%E5%8A%9F%E8%83%BD%E7%9A%84%E5%AE%9E%E7%8E%B0%EF%BC%88javapns%EF%BC%89/</url>
      <content type="html"><![CDATA[<h2 id="IOSçš„æ¨é€å®ç°ç”±è¿™æ ·å‡ æ­¥æ¥å®Œæˆ"><a href="#IOSçš„æ¨é€å®ç°ç”±è¿™æ ·å‡ æ­¥æ¥å®Œæˆ" class="headerlink" title="IOSçš„æ¨é€å®ç°ç”±è¿™æ ·å‡ æ­¥æ¥å®Œæˆ:"></a>IOSçš„æ¨é€å®ç°ç”±è¿™æ ·å‡ æ­¥æ¥å®Œæˆ:</h2><ol>
<li>åˆ›å»ºPush SSL Certification</li>
<li>IOSå®¢æˆ·ç«¯æ³¨å†ŒPushåŠŸèƒ½å¹¶è·å¾—DeviceToken</li>
<li>ä½¿ç”¨Providerå‘APNSå‘é€Pushæ¶ˆæ¯</li>
<li>IOSå®¢æˆ·ç«¯æ¥æ”¶å¤„ç†ç”±APNSå‘æ¥çš„æ¶ˆæ¯</li>
</ol>
<h2 id="åˆ›å»ºPush-SSL-Certification"><a href="#åˆ›å»ºPush-SSL-Certification" class="headerlink" title="åˆ›å»ºPush SSL Certification"></a><a name="t1"></a>åˆ›å»ºPush SSL Certification</h2><p>&nbsp;&nbsp;&nbsp; ç™»å½•developer.apple.comï¼Œåˆ›å»ºæ–°çš„App IDï¼Œè¦æ±‚æ­¤IDçš„Bundle Identifierä¸åŒ…å«é€šé…ç¬¦ï¼Œå¦åˆ™ä¸èƒ½å¯ç”¨Pushä»¥åŠIAPåŠŸèƒ½ã€‚ä¾‹å¦‚ com.soso.sosoimageã€‚</p>
<p>&nbsp;&nbsp;&nbsp; åœ¨App IDsåˆ—è¡¨é¡µé¢ï¼Œç‚¹å‡»åˆšåˆ›å»ºçš„app idå³é¢çš„Configureé“¾æ¥ï¼Œè¿›å…¥Configure App IDç•Œé¢ï¼Œé€‰ä¸­â€Enable for App Push Notification serviceâ€ã€‚ç‚¹å‡»Development Push SSL Certificateä¸€è¡Œçš„ConfigureæŒ‰é’®ï¼Œå¼¹å‡ºâ€Apple Push Notification service SSL Certificate Assistantâ€å¯¹è¯æ¡†ï¼Œä¾å¯¹è¯æ¡†æ“ä½œï¼Œç±»ä¼¼äºåˆ›å»ºå¼€å‘æˆ–å‘å¸ƒç”¨çš„Certificateã€‚</p>
<p>&nbsp;&nbsp;&nbsp; æœ€ç»ˆå°†Development Push SSL Certificateä¸‹è½½å¹¶å®‰è£…åˆ°æœ¬åœ°Keychain Accessã€‚å¯¼å‡ºæˆp12æ–‡ä»¶ï¼Œå¤‡ç”¨ã€‚å¯¼å‡ºæ—¶éœ€è¦è®¾ç½®å¯†ç ï¼Œä¸å¾—ä¸ºç©ºã€‚</p>
<p>&nbsp;&nbsp;&nbsp; åœ¨developer.apple.comï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„Provisioning Profileï¼Œä½¿ç”¨æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„æ”¯æŒPushåŠŸèƒ½çš„App IDã€‚ä¸‹è½½å¹¶å®‰è£…åˆ°æœ¬åœ°ã€‚</p>
<p>&nbsp;</p>
<h2 id="IOSå®¢æˆ·ç«¯æ³¨å†ŒPushåŠŸèƒ½å¹¶è·å¾—DeviceToken"><a href="#IOSå®¢æˆ·ç«¯æ³¨å†ŒPushåŠŸèƒ½å¹¶è·å¾—DeviceToken" class="headerlink" title="IOSå®¢æˆ·ç«¯æ³¨å†ŒPushåŠŸèƒ½å¹¶è·å¾—DeviceToken"></a><a name="t2"></a>IOSå®¢æˆ·ç«¯æ³¨å†ŒPushåŠŸèƒ½å¹¶è·å¾—DeviceToken</h2><p><span>&nbsp;&nbsp;&nbsp; åˆ›å»ºæœ¬åœ°å·¥ç¨‹ï¼Œinfo.plistä¸­è®¾ç½®Bundle identifierä¸ºåˆšåˆšåˆ›å»ºçš„Bundle Idã€‚Com.soso.sosoimageã€‚è®¾å®šCode Signing Identityä¸ºåˆšåˆšåˆ›å»ºçš„Provisioning Profileã€‚</span></p>
<p>&nbsp;&nbsp;&nbsp; ç¨‹åºç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œè°ƒç”¨å¦‚ä¸‹ä»£ç .</p>
<div class="cnblogs_code"><br><pre>[[UIApplication sharedApplication] registerForRemoteNotificationTypes:(UIRemoteNotificationTypeAlert | UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeSound)];</pre><br></div>

<p>ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨æ¶ˆæ¯ï¼ˆæ¨ªå¹…æˆ–æé†’ï¼Œç”±ç”¨æˆ·Settingå†³å®šï¼Œç¨‹åºä¸å¯æ›´æ”¹ï¼‰ã€æ•°å­—æ ‡è®°ã€å£°éŸ³ã€‚</p>
<p><span>åœ¨AppDelegate.mä¸­æ·»åŠ ä¸¤ä¸ªæ–¹æ³•.</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">//</span><span style="color: #008000;">iPhone ä»APNsæœåŠ¡å™¨è·å–deviceTokenåå›è°ƒæ­¤æ–¹æ³•</span><br>- (<span style="color: #0000ff;">void</span>)application:(UIApplication <em>)app didRegisterForRemoteNotificationsWithDeviceToken:(NSData </em><span style="color: #000000;">)deviceToken<br>{<br>    NSString</span><em> dt = [[deviceToken description] stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:<span style="color: #800000;">@â€</span><span style="color: #800000;">&lt;&gt;</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">]];<br>    NSLog(</span><span style="color: #800000;">@â€</span><span style="color: #800000;">deviceToken:%@</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">, dt);<br>}<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;">æ³¨å†ŒpushåŠŸèƒ½å¤±è´¥ å è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæ‰§è¡Œç›¸åº”çš„å¤„ç†</span><br>- (<span style="color: #0000ff;">void</span>)application:(UIApplication </em>)app didFailToRegisterForRemoteNotificationsWithError:(NSError *<span style="color: #000000;">)err<br>{<br>    NSLog(</span><span style="color: #800000;">@â€</span><span style="color: #800000;">Push Register Error:%@</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">, err.description);<br>}</span></pre><br></div>

<p><span>è·å–DeviceTokenåï¼Œå°†å…¶ä¼ ç»™Providerã€‚</span></p>
<h2 id="ä½¿ç”¨Providerå‘APNSå‘é€Pushæ¶ˆæ¯"><a href="#ä½¿ç”¨Providerå‘APNSå‘é€Pushæ¶ˆæ¯" class="headerlink" title="ä½¿ç”¨Providerå‘APNSå‘é€Pushæ¶ˆæ¯"></a><a name="t3"></a>ä½¿ç”¨Providerå‘APNSå‘é€Pushæ¶ˆæ¯</h2><p> <span>Providerï¼Œå°†æ¨é€ä¿¡æ¯å‘é€ç»™APNSï¼ˆè‹¹æœæ¨é€æœåŠ¡å™¨ï¼‰çš„ç¨‹åºã€‚æœ‰å¾ˆå¤šå¼€æºçš„å®ç°ï¼Œæˆ‘ä»¬ä½¿ç”¨javapns ( <a href="http://code.google.com/p/javapns/" target="_blank" rel="noopener">http://code.google.com/p/javapns/</a> )ã€‚</span><br><span>é¦–å…ˆï¼ŒProviderè¦æœ‰ç›®æ ‡DeviceTokenï¼Œè¿™æ˜¯å‘é€ç›®æ ‡ï¼Œç”±å®¢æˆ·ç«¯ä¼ ç»™Providerä¹‹åå­˜åœ¨æŸå¤„ã€‚</span><br><span>å®‰è£…javapnsï¼Œéœ€è¦å¯¼å…¥çš„jarä¸ºbcprov-jdk15-146.jar, log4j-1.2.15.jar, JavaPNS_2.3_Alpha_5.jarã€‚</span><br><span>å°†å‰é¢å¯¼å‡ºçš„P12æ–‡ä»¶æ”¾åœ¨Providerçš„å·¥ç¨‹ç›®å½•ä¸‹ã€‚</span><br><span>Providerå‘APNSå‘é€æ¶ˆæ¯å¯ä»¥å‚è€ƒjavapnsä¸­NotificationTest.javaã€‚ä¹Ÿå¯ä»¥å‚è€ƒå¦‚ä¸‹ä¾‹å­ã€‚</span></p>
<h3 id="1-ä½¿å®¢æˆ·ç«¯å›¾æ ‡æ˜¾ç¤ºæ•°å­—æ ‡è®°"><a href="#1-ä½¿å®¢æˆ·ç«¯å›¾æ ‡æ˜¾ç¤ºæ•°å­—æ ‡è®°" class="headerlink" title="(1)ä½¿å®¢æˆ·ç«¯å›¾æ ‡æ˜¾ç¤ºæ•°å­—æ ‡è®°"></a><a name="t4"></a>(1)ä½¿å®¢æˆ·ç«¯å›¾æ ‡æ˜¾ç¤ºæ•°å­—æ ‡è®°</h3><div class="cnblogs_code"><br><pre>Push.badge(2, keystore, password, <span style="color: #0000ff;">false</span>, â€œ7bb8d508e32df651c6c239439737dbd40a88d2461ad2ac1e5dbe49ecea5ccc67â€);</pre><br></div>

<p><span>å…¶ä¸­ï¼Œ2ä¸ºè¦æ˜¾ç¤ºçš„æ•°å­—ï¼›</span></p>
<div class="cnblogs_code"><br><pre>String keystore = â€œPushCertificates.p12â€;     <span style="color: #008000;">//</span><span style="color: #008000;">P12æ–‡ä»¶çš„è·¯å¾„ï¼›</span><br>String password = â€œsosoimageâ€;                <span style="color: #008000;">//</span><span style="color: #008000;">P12æ–‡ä»¶çš„å¯†ç ï¼›</span></pre><br></div>

<p><span>falseï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨æµ‹è¯•ç¯å¢ƒï¼Œä½¿ç”¨æ­£å¼äº§å“ç¯å¢ƒåº”ä¼ å…¥true.</span><br><span>â€œ7bb8d508e32df651c6c239439737dbd40a88d2461ad2ac1e5dbe49ecea5ccc67â€ä¸ºå®¢æˆ·ç«¯è·å¾—å¹¶ä¼ ç»™Providerçš„DeviceTokenï¼Œæ­¤å‚æ•°è¿˜å¯ä»¥ä¼ å…¥String[]å¯¹è±¡ï¼Œä»¥åŒæ—¶å‘å¤šä¸ªå®¢æˆ·ç«¯Pushæ¶ˆæ¯ã€‚</span></p>
<h3 id="2-ä½¿å®¢æˆ·ç«¯æ˜¾ç¤ºæ¨ªå¹…æˆ–æé†’"><a href="#2-ä½¿å®¢æˆ·ç«¯æ˜¾ç¤ºæ¨ªå¹…æˆ–æé†’" class="headerlink" title="(2)ä½¿å®¢æˆ·ç«¯æ˜¾ç¤ºæ¨ªå¹…æˆ–æé†’"></a><a name="t5"></a>(2)ä½¿å®¢æˆ·ç«¯æ˜¾ç¤ºæ¨ªå¹…æˆ–æé†’</h3><p>Providerå¯ä»¥å‘å®¢æˆ·ç«¯Pushä¸€æ¡Messageï¼Œä½†å®¢æˆ·ç«¯æœ‰æƒé™å†³å®šè¿™æ¡Messageçš„æ˜¾ç¤ºæ–¹å¼ï¼ˆæ— ã€æ¨ªå¹…ã€æé†’ï¼‰ã€‚</p>
<div class="cnblogs_code"><br><pre>Push.alert(â€œA Messageâ€, keystore, password, )<span style="color: #0000ff;">false</span>, â€œ7bb8d508e32df651c6c239439737dbd40a88d2461ad2ac1e5dbe49ecea5ccc67â€);</pre><br></div>

<h3 id="3-æ··åˆæ–¹å¼"><a href="#3-æ··åˆæ–¹å¼" class="headerlink" title="(3)æ··åˆæ–¹å¼"></a>(3)æ··åˆæ–¹å¼</h3><p><span>å¯ä»¥åœ¨ä¸€ä¸ªPushæ¶ˆæ¯é‡Œé™„å¸¦å¤šç§ä¿¡æ¯ï¼ŒMessage, æ ‡è®°ï¼Œå£°éŸ³ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç .</span></p>
<div class="cnblogs_code"><br><pre>PushNotificationPayload payload =<span style="color: #000000;"> PushNotificationPayload.complex();<br>payload.addAlert(</span>â€œA Messageâ€<span style="color: #000000;">);<br>payload.addBadge(</span>2<span style="color: #000000;">);<br>payload.addSound(</span>â€œtest.aiffâ€<span style="color: #000000;">);<br>Push.payload(payload, , keystore, password, </span><span style="color: #0000ff;">false</span>, â€œ7bb8d508e32df651c6c239439737dbd40a88d2461ad2ac1e5dbe49ecea5ccc67â€);</pre><br></div>

<p><span>ä¸Šé¢çš„ä»£ç éƒ½æœ‰å¯èƒ½ä¼šæœ‰ç›¸åº”çš„ExceptionæŠ›å‡ºæ¥ï¼Œéœ€è¦å¤„ç†ã€‚æ›´å¤šçš„ä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒ <a href="http://code.google.com/p/javapns/&amp;nbsp" target="_blank" rel="noopener">http://code.google.com/p/javapns/&amp;nbsp</a>;</span></p>
<h2 id="IOSå®¢æˆ·ç«¯æ¥æ”¶å¤„ç†ç”±APNSå‘æ¥çš„æ¶ˆæ¯"><a href="#IOSå®¢æˆ·ç«¯æ¥æ”¶å¤„ç†ç”±APNSå‘æ¥çš„æ¶ˆæ¯" class="headerlink" title="IOSå®¢æˆ·ç«¯æ¥æ”¶å¤„ç†ç”±APNSå‘æ¥çš„æ¶ˆæ¯"></a><a name="t7"></a>IOSå®¢æˆ·ç«¯æ¥æ”¶å¤„ç†ç”±APNSå‘æ¥çš„æ¶ˆæ¯</h2><p><span>(1)å½“ç¨‹åºæœªå¯åŠ¨ï¼Œç”¨æˆ·æ¥æ”¶åˆ°æ¶ˆæ¯ã€‚éœ€è¦åœ¨AppDelegateä¸­çš„didFinishLaunchingWithOptionså¾—åˆ°æ¶ˆæ¯å†…å®¹ã€‚ä»£ç å¦‚ä¸‹ï¼Œ</span></p>
<div class="cnblogs_code"><br><pre>- (BOOL)application:(UIApplication <em>)application didFinishLaunchingWithOptions:(NSDictionary </em><span style="color: #000000;">)launchOptions<br>{<br>    â€¦<br><br>    NSDictionary</span>* payload =<span style="color: #000000;"> [launchOptions objectForKey:UIApplicationLaunchOptionsRemoteNotificationKey];<br>    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (payload)<br>    {<br>    â€¦<br>    }<br><br>    </span><span style="color: #000000;">â€¦<br>}</span></pre><br></div>

<p><span>(2)å½“ç¨‹åºåœ¨å‰å°è¿è¡Œï¼Œæ¥æ”¶åˆ°æ¶ˆæ¯ä¸ä¼šæœ‰æ¶ˆæ¯æç¤ºï¼ˆæç¤ºæ¡†æˆ–æ¨ªå¹…ï¼‰ã€‚å½“ç¨‹åºè¿è¡Œåœ¨åå°ï¼Œæ¥æ”¶åˆ°æ¶ˆæ¯ä¼šæœ‰æ¶ˆæ¯æç¤ºï¼Œç‚¹å‡»æ¶ˆæ¯åè¿›å…¥ç¨‹åºï¼ŒAppDelegateçš„didReceiveRemoteNotificationå‡½æ•°ä¼šè¢«è°ƒç”¨ï¼ˆéœ€è¦è‡ªå·±é‡å†™ï¼‰ï¼Œæ¶ˆæ¯åšä¸ºæ­¤å‡½æ•°çš„å‚æ•°ä¼ å…¥ï¼Œä»£ç å¦‚ä¸‹</span></p>
<div class="cnblogs_code"><br><pre>- (<span style="color: #0000ff;">void</span>)application:(UIApplication <em>)application didReceiveRemoteNotification:(NSDictionary </em><span style="color: #000000;">)payload<br>{<br>    â€¦<br>}</span></pre><br></div>

<p><span>(3)æ— è®ºåœ¨å“ªä¸ªå‡½æ•°ä¼ å…¥ï¼Œæ¶ˆæ¯æ€»æ˜¯ä¸€ä¸ªNSDictionaryå¯¹è±¡ï¼Œå¤„ç†æ–¹å¼å¯ä»¥å‚è€ƒå¦‚ä¸‹ä»£ç </span></p>
<div class="cnblogs_code"><br><pre>- (<span style="color: #0000ff;">void</span>)application:(UIApplication <em>)application didReceiveRemoteNotification:(NSDictionary </em><span style="color: #000000;">)payload<br>{<br>    NSLog(</span><span style="color: #800000;">@â€</span><span style="color: #800000;">remote notification: %@</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">,[payload description]);<br>    NSString</span><em> alertStr =<span style="color: #000000;"> nil;<br>    NSDictionary </span></em>apsInfo = [payload objectForKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">aps</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">];<br>    NSObject </span><em>alert = [apsInfo objectForKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">alert</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">];<br>    </span><span style="color: #0000ff;">if</span> ([alert isKindOfClass:[NSString <span style="color: #0000ff;">class</span><span style="color: #000000;">]])<br>    {<br>        alertStr </span>= (NSString</em><span style="color: #000000;">)alert;<br>    }<br>    </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> ([alert isKindOfClass:[NSDictionary <span style="color: #0000ff;">class</span><span style="color: #000000;">]])<br>    {<br>        NSDictionary</span><em> alertDict = (NSDictionary</em><span style="color: #000000;">)alert;<br>        alertStr </span>= [alertDict objectForKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">body</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">];<br>    }<br>    application.applicationIconBadgeNumber </span>= [[apsInfo objectForKey:<span style="color: #800000;">@â€</span><span style="color: #800000;">badge</span><span style="color: #800000;">â€œ</span><span style="color: #000000;">] integerValue];<br>    </span><span style="color: #0000ff;">if</span> ([application applicationState] == UIApplicationStateActive &amp;&amp; alertStr !=<span style="color: #000000;"> nil)<br>    {<br>        UIAlertView</span>* alertView = [[UIAlertView alloc] initWithTitle:<span style="color: #800000;">@â€</span><span style="color: #800000;">Pushed Message</span><span style="color: #800000;">â€œ</span> message:alertStr <span style="color: #0000ff;">delegate</span>:nil cancelButtonTitle:<span style="color: #800000;">@â€</span><span style="color: #800000;">OK</span><span style="color: #800000;">â€œ</span><span style="color: #000000;"> otherButtonTitles:nil];<br>        [alertView show];<br>    }<br>}</span></pre><br></div>

<p>&nbsp;</p>
<p>æ¥è‡ªï¼š<a href="http://blog.csdn.net/worldmatrix/article/details/7634596" target="_blank" rel="noopener">http://blog.csdn.net/worldmatrix/article/details/7634596</a></p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> iOS </tag>
            
            <tag> push </tag>
            
            <tag> javapns </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[IntelliJ IDEA 12 åˆ›å»ºWebé¡¹ç›® æ•™ç¨‹ è¶…è¯¦ç»†ç‰ˆ]]></title>
      <url>/2013/05/18/IntelliJ-IDEA-12-%E5%88%9B%E5%BB%BAWeb%E9%A1%B9%E7%9B%AE-%E6%95%99%E7%A8%8B-%E8%B6%85%E8%AF%A6%E7%BB%86%E7%89%88/</url>
      <content type="html"><![CDATA[<p>IntelliJ IDEA 12&nbsp;æ–°ç‰ˆæœ¬å‘å¸ƒ ç¬¬ä¸€æ—¶é—´å»å®˜ç½‘çœ‹äº†ä¸‹&nbsp;&nbsp;é»‘è‰²çš„ä¸»é¢˜ å¾ˆç»™åŠ› å¤§ä½“ä½¿ç”¨äº†ä¸‹&nbsp;&nbsp;å¯¹äºä¸€å¼€å§‹å°±æ˜¯ç”¨eclipseçš„ç«¥é‹ä»¬</p>
<p>ä¼°è®¡å¾ˆéš¾ä»eclipseä¸­èµ°å‡ºæ¥&nbsp;å½“ç„¶ æˆ‘ä¹Ÿå¾ˆè‰°éš¾çš„èµ°åœ¨è·¯ä¸Š â€¦</p>
<p><strong><span>é¦–å…ˆè¦è¯´ä¸€ç‚¹ï¼Œåœ¨IntelliJ IDEAé‡Œé¢&ldquo;new Project&rdquo; å°±ç›¸å½“äºæˆ‘ä»¬eclipseçš„&ldquo;workspace&rdquo;ï¼Œè€Œ&ldquo;new Module&rdquo;æ‰æ˜¯åˆ›å»ºä¸€ä¸ªå·¥ç¨‹ã€‚</span></strong></p>
<p><strong><span>è¿™ä¸ªå’ŒEclipseæœ‰å¾ˆå¤§çš„åŒºåˆ«</span></strong></p>
<p>&nbsp;</p>
<p><strong>1.å®˜ç½‘ä¸‹è½½ä¸‹æ¥çš„é»˜è®¤ä¸æ˜¯é»‘è‰²çš„ä¸»é¢˜&nbsp;è¿™é‡Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹&nbsp;å·¥å…·æ ä¸Šçš„æ‰³æ‰‹å›¾æ ‡ æˆ–è€…æ˜¯ç”¨ctrl+alt+sæ‰“å¼€è®¾ç½®çª—å£</strong></p>
<p><strong>åœ¨æ‰“å¼€çª—å£çš„å·¦ä¾§&nbsp; æ‰¾åˆ°Appearance&gt;Theme é€‰æ‹©Darculaä¸»é¢˜ åº”ç”¨&nbsp; é‡å¯å°±okäº†</strong></p>
<p><strong>2.ä¸­æ–‡ä¹±ç é—®é¢˜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; è½¯ä»¶æ— è®ºæ˜¯æ‰“å¼€é¡¹ç›®ç©ºé—´è¿˜æ˜¯å…¶ä»–çš„&nbsp;&nbsp;&nbsp;&nbsp; å­—ä½“æ˜¾ç¤ºä¸å…¨ ä¸­æ–‡éƒ½æ˜¯å£å£&nbsp;</strong></p>
<p><strong>è§£å†³æ–¹æ³•:</strong></p>
<p><strong>Appearance&gt;Override default fonts by(not recommended)&nbsp;å‰é¢æ‰“å‹¾</strong></p>
<p><strong>æ­¤æ—¶ä¸‹æ–¹çš„nameä¸‹æ‹‰æ¡†ä¸ºå¯é€‰çŠ¶æ€&nbsp;&nbsp;æ‰¾åˆ°Name:DialogInput.plain - Size:12&nbsp;&nbsp; åº”ç”¨å°±okäº†</strong></p>
<p>&nbsp;</p>
<p><strong>ä¸‹é¢å¼€å§‹ä¸€æ­¥æ­¥çš„æ¥åˆ›å»ºä¸€ä¸ªwebé¡¹ç›®</strong></p>
<p><span><strong>1.é¦–å…ˆ åˆ›å»ºä¸€ä¸ªProject&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**</strong>ä¹Ÿå°±æ˜¯é¡¹ç›®ç©ºé—´**</span></p>
<p><strong><img src="http://images.cnitblog.com/blog/355865/201301/29152002-599bc4776245421f9309c080241deb40.gif" alt=""></strong></p>
<p>2.é€‰æ‹©é¡¹ç›®ç±»å‹&nbsp;è¿™é‡Œé€‰Java Module&nbsp; è‡ªå®šä¹‰å·¥ä½œç©ºé—´åç§° å’Œè·¯å¾„</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29152128-8f769e2278e0466082619fa750448237.png" alt=""></p>
<p>3.é€‰æ‹©éœ€è¦ç”¨åˆ°çš„æ¡†æ¶ç»„ä»¶&nbsp;è¿™é‡Œåªé€‰äº†ç¬¬ä¸€ä¸ª&nbsp;Web Application &gt; Finish</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29152333-404c8da875d945ec845fbec85b3c5b36.gif" alt=""></p>
<p>4.åˆ›å»ºå®Œå·¥ä½œç©ºé—´&nbsp;é»˜è®¤ä¼šæ˜¯ä¸€ä¸ªModuleä¹Ÿå°±æ˜¯ä¸€ä¸ªé¡¹ç›® ä½†æ˜¯ä¸æ¨èä½¿ç”¨è¯¥é¡¹ç›®è¿›è¡Œå¼€å‘</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29152650-dab203ebafa04bddbcb6be16ebfa5ee1.png" alt=""></p>
<p>5.åœ¨è¯¥é¡¹ç›®ç©ºé—´ä¸­&nbsp;æ·»åŠ æ–°çš„å·¥ç¨‹ é€‰ä¸­å·¥ä½œç©ºé—´&nbsp;å³é”®Open Module Settings æˆ–è€…æ˜¯æŒ‰ä¸‹F4</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29153307-89ea6cef216f45319017b50159edd604.png" alt=""></p>
<p>6.æ·»åŠ å·¥ç¨‹</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29154653-eda8d28c584048b6b346d7514ba3d515.png" alt=""></p>
<p>&nbsp;</p>
<p><strong><img src="http://images.cnitblog.com/blog/355865/201301/29154807-49eacbe0dc524460b3f177b6a2668b34.png" alt=""></strong></p>
<p>ç„¶åFinish&nbsp;&nbsp;æ‰¾åˆ°æ–°å»ºå·¥ç¨‹çš„web&gt;WEB-INFä¸‹åˆ›å»º&nbsp;classes å’Œlibæ–‡ä»¶å¤¹&nbsp;</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29155004-ac0e1d8b9d6f4edb99597a88db0f136f.png" alt=""></p>
<p>ä¿®æ”¹ç¼–è¯‘è¾“å‡ºç›®å½•&nbsp; Paths&gt;Use module compile output path è½¬åˆ°è‡ªå®šä¹‰çš„classesæ–‡ä»¶å¤¹</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29155259-15fc13084bea4b95936b158d6f546473.png" alt=""></p>
<p>åŒæ ·å¯ä»¥æŒ‡å®šlibåº“ç›®å½•&nbsp;&nbsp;æ·»åŠ &gt;jars or directories æŒ‡å‘åˆ›å»ºçš„libæ–‡ä»¶å¤¹&nbsp; å¼¹å‡ºçª—å£é€‰æ‹©jar directory<img src="http://images.cnitblog.com/blog/355865/201301/29155450-beee086f18d148ebb5480a7686cc9b8f.png" alt=""></p>
<p>&nbsp;</p>
<p>æ¥ä¸‹æ¥&nbsp;éƒ¨ç½²æµ‹è¯•&nbsp; é…ç½®tomcatæœåŠ¡å™¨&nbsp; ç‚¹å‡»å›¾&nbsp;ç®­å¤´æ–¹å‘ é‚£ä¸ªä¸‹æ‹‰åœ°æ–¹&nbsp;æœ‰ä¸ªç¼–è¾‘æœåŠ¡å™¨çš„ å¼¹å‡ºå³ä¾§çª—å£</p>
<p>ç‚¹å‡»ç»¿è‰²çš„æ·»åŠ æŒ‰é’® &gt;&nbsp;é€‰æ‹©tomcatæœåŠ¡å™¨ &gt;local</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29160928-b7ce076af8e949178a877ac0d554bd68.png" alt=""></p>
<p>é€‰æ‹©éƒ¨ç½²çš„åº”ç”¨</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29162337-0e28706311fd4e34b8cc51c63b4cac58.png" alt=""></p>
<p>&nbsp;</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29162455-100451324e694e2f81aac0b53423ce0d.png" alt=""></p>
<p>&nbsp;</p>
<p>å¯åŠ¨æµ‹è¯•â€¦</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29162525-3b11e6a77d8f42aeadd6beb5a7edf59e.png" alt=""></p>
<p>ok &gt;</p>
<p><img src="http://images.cnitblog.com/blog/355865/201301/29162653-328ea1b084644954a1980cde7c504a3b.png" alt=""></p>
<p>è½¬è‡ª&nbsp;<a href="http://www.cnblogs.com/cnjava/archive/2013/01/29/2881654.html" target="_blank" rel="noopener">http://www.cnblogs.com/cnjava/archive/2013/01/29/2881654.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> Intellij IDEA </tag>
            
            <tag> j2ee </tag>
            
            <tag> java web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java Collection]]></title>
      <url>/2013/04/11/Java-Collection/</url>
      <content type="html"><![CDATA[<p><span>åœ¨ Java2ä¸­ï¼Œæœ‰ä¸€å¥—è®¾è®¡ä¼˜è‰¯çš„æ¥å£å’Œç±»ç»„æˆäº†Javaé›†åˆæ¡†æ¶Collectionï¼Œä½¿ç¨‹åºå‘˜æ“ä½œæˆæ‰¹çš„æ•°æ®æˆ–å¯¹è±¡å…ƒç´ æä¸ºæ–¹ä¾¿ã€‚è¿™äº›æ¥å£å’Œç±»æœ‰å¾ˆå¤šå¯¹æŠ½è±¡æ•°æ®ç±»å‹æ“ä½œçš„APIï¼Œè€Œè¿™æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ä¸”åœ¨æ•°æ®ç»“æ„ä¸­ç†ŸçŸ¥çš„ã€‚ä¾‹å¦‚Mapï¼ŒSetï¼ŒListç­‰ã€‚å¹¶ä¸”Javaç”¨é¢å‘å¯¹è±¡çš„è®¾è®¡å¯¹è¿™äº›æ•°æ®ç»“æ„å’Œç®—æ³•è¿›è¡Œäº†å°è£…ï¼Œè¿™å°±æå¤§çš„å‡åŒ–äº†ç¨‹åºå‘˜ç¼–ç¨‹æ—¶çš„è´Ÿæ‹…ã€‚ç¨‹åºå‘˜ä¹Ÿå¯ä»¥ä»¥è¿™ä¸ªé›†åˆæ¡†æ¶ä¸ºåŸºç¡€ï¼Œå®šä¹‰æ›´é«˜çº§åˆ«çš„æ•°æ®æŠ½è±¡ï¼Œæ¯”å¦‚æ ˆã€é˜Ÿåˆ—å’Œçº¿ç¨‹å®‰å…¨çš„é›†åˆç­‰ï¼Œä»è€Œæ»¡è¶³è‡ªå·±çš„éœ€è¦ã€‚&nbsp;</span></p>
<p><span>Java2çš„é›†åˆæ¡†æ¶ï¼ŒæŠ½å…¶æ ¸å¿ƒï¼Œä¸»è¦æœ‰ä¸‰ç§ï¼šListã€Setå’ŒMapã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&nbsp;</span></p>
<p><span>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„ Collectionã€Listã€Setå’ŒMapéƒ½æ˜¯æ¥å£ï¼ˆInterfaceï¼‰ï¼Œä¸æ˜¯å…·ä½“çš„ç±»å®ç°ã€‚ List lst = new ArrayList(); è¿™æ˜¯æˆ‘ä»¬å¹³å¸¸ç»å¸¸ä½¿ç”¨çš„åˆ›å»ºä¸€ä¸ªæ–°çš„Listçš„è¯­å¥ï¼Œåœ¨è¿™é‡Œï¼Œ Listæ˜¯æ¥å£ï¼ŒArrayListæ‰æ˜¯å…·ä½“çš„ç±»ã€‚&nbsp;</span></p>
<p><span>å¸¸ç”¨é›†åˆç±»çš„ç»§æ‰¿ç»“æ„å¦‚ä¸‹ï¼š&nbsp;</span><br><span>Collection&lt;â€“List&lt;â€“Vector&nbsp;</span><br><span>Collection&lt;â€“List&lt;â€“ArrayList&nbsp;</span><br><span>Collection&lt;â€“List&lt;â€“LinkedList&nbsp;</span><br><span>Collection&lt;â€“Set&lt;â€“HashSet&nbsp;</span><br><span>Collection&lt;â€“Set&lt;â€“HashSet&lt;â€“LinkedHashSet&nbsp;</span><br><span>Collection&lt;â€“Set&lt;â€“SortedSet&lt;â€“TreeSet&nbsp;</span><br><span>Map&lt;â€“SortedMap&lt;â€“TreeMap&nbsp;</span><br><span>Map&lt;â€“HashMap&nbsp;</span></p>
<p><span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“SBåˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&nbsp;</span></p>
<p><span>Listï¼š</span><span>&nbsp;</span><br><span>Listæ˜¯æœ‰åºçš„Collectionï¼Œä½¿ç”¨æ­¤æ¥å£èƒ½å¤Ÿç²¾ç¡®çš„æ§åˆ¶æ¯ä¸ªå…ƒç´ æ’å…¥çš„ä½ç½®ã€‚ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨ç´¢å¼•ï¼ˆå…ƒç´ åœ¨Listä¸­çš„ä½ç½®ï¼Œç±»ä¼¼äºæ•°ç»„ä¸‹ &gt;æ ‡ï¼‰æ¥è®¿é—®Listä¸­çš„å…ƒç´ ï¼Œè¿™ç±»ä¼¼äºJavaçš„æ•°ç»„ã€‚&nbsp;</span></p>
<p><span>Vectorï¼š</span><span>&nbsp;</span><br><span>åŸºäºæ•°ç»„ï¼ˆArrayï¼‰çš„Listï¼Œå…¶å®å°±æ˜¯å°è£…äº†æ•°ç»„æ‰€ä¸å…·å¤‡çš„ä¸€äº›åŠŸèƒ½æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒéš¾æ˜“é¿å…æ•°ç»„çš„é™åˆ¶ï¼ŒåŒæ—¶æ€§èƒ½ä¹Ÿä¸å¯èƒ½è¶…è¶Šæ•°ç»„ã€‚æ‰€ä»¥ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¦å¤šè¿ç”¨æ•°ç»„ã€‚å¦å¤–å¾ˆé‡è¦çš„ä¸€ç‚¹å°±æ˜¯Vectoræ˜¯çº¿ç¨‹åŒæ­¥çš„(sychronized)çš„ï¼Œè¿™ä¹Ÿæ˜¯Vectorå’ŒArrayList çš„ä¸€ä¸ªçš„é‡è¦åŒºåˆ«ã€‚&nbsp;</span></p>
<p><span>ArrayListï¼š</span><span>&nbsp;</span><br><span>åŒVectorä¸€æ ·æ˜¯ä¸€ä¸ªåŸºäºæ•°ç»„ä¸Šçš„é“¾è¡¨ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ArrayListä¸æ˜¯åŒæ­¥çš„ã€‚æ‰€ä»¥åœ¨æ€§èƒ½ä¸Šè¦æ¯”Vectorå¥½ä¸€äº›ï¼Œä½†æ˜¯å½“è¿è¡Œåˆ°å¤šçº¿ç¨‹ç¯å¢ƒä¸­æ—¶ï¼Œå¯éœ€è¦è‡ªå·±åœ¨ç®¡ç†çº¿ç¨‹çš„åŒæ­¥é—®é¢˜ã€‚&nbsp;</span></p>
<p><span>LinkedListï¼š</span><span>&nbsp;</span><br><span>LinkedListä¸åŒäºå‰é¢ä¸¤ç§Listï¼Œå®ƒä¸æ˜¯åŸºäºæ•°ç»„çš„ï¼Œæ‰€ä»¥ä¸å—æ•°ç»„æ€§èƒ½çš„é™åˆ¶ã€‚&nbsp;</span><br><span>å®ƒæ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆNodeï¼‰éƒ½åŒ…å«ä¸¤æ–¹é¢çš„å†…å®¹ï¼š&nbsp;</span><br><span>1.èŠ‚ç‚¹æœ¬èº«çš„æ•°æ®ï¼ˆdataï¼‰ï¼›&nbsp;</span><br><span>2.ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯ï¼ˆnextNodeï¼‰ã€‚&nbsp;</span><br><span>æ‰€ä»¥å½“å¯¹LinkedListåšæ·»åŠ ï¼Œåˆ é™¤åŠ¨ä½œçš„æ—¶å€™å°±ä¸ç”¨åƒåŸºäºæ•°ç»„çš„ArrayListä¸€æ ·ï¼Œå¿…é¡»è¿›è¡Œå¤§é‡çš„æ•°æ®ç§»åŠ¨ã€‚åªè¦æ›´æ”¹nextNodeçš„ç›¸å…³ä¿¡æ¯å°±å¯ä»¥å®ç°äº†ï¼Œè¿™æ˜¯LinkedListçš„ä¼˜åŠ¿ã€‚&nbsp;</span></p>
<p><span>Listæ€»ç»“ï¼š</span><span>&nbsp;</span></p>
<ul>
<li>æ‰€æœ‰çš„Listä¸­åªèƒ½å®¹çº³å•ä¸ªä¸åŒç±»å‹çš„å¯¹è±¡ç»„æˆçš„è¡¨ï¼Œè€Œä¸æ˜¯Keyï¼Valueé”®å€¼å¯¹ã€‚ä¾‹å¦‚ï¼š[ tom,1,c ]</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>æ‰€æœ‰çš„Listä¸­å¯ä»¥æœ‰ç›¸åŒçš„å…ƒç´ ï¼Œä¾‹å¦‚Vectorä¸­å¯ä»¥æœ‰ [ tom,koo,too,koo ]</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>æ‰€æœ‰çš„Listä¸­å¯ä»¥æœ‰nullå…ƒç´ ï¼Œä¾‹å¦‚[ tom,null,1 ]</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>åŸºäºArrayçš„Listï¼ˆVectorï¼ŒArrayListï¼‰é€‚åˆæŸ¥è¯¢ï¼Œè€ŒLinkedList é€‚åˆæ·»åŠ ï¼Œåˆ é™¤æ“ä½œ</li>
</ul>
<p><span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“NBåˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&nbsp;</span></p>
<p><span>Setï¼š</span><span>&nbsp;</span><br><span>Setæ˜¯ä¸€ç§ä¸åŒ…å«é‡å¤çš„å…ƒç´ çš„æ— åºCollectionã€‚&nbsp;</span></p>
<p><span>HashSetï¼š</span><span>&nbsp;</span><br><span>è™½ç„¶SetåŒListéƒ½å®ç°äº†Collectionæ¥å£ï¼Œä½†æ˜¯ä»–ä»¬çš„å®ç°æ–¹å¼å´å¤§ä¸ä¸€æ ·ã€‚ListåŸºæœ¬ä¸Šéƒ½æ˜¯ä»¥Arrayä¸ºåŸºç¡€ã€‚ä½†æ˜¯Setåˆ™æ˜¯åœ¨ HashMapçš„åŸºç¡€ä¸Šæ¥å®ç°çš„ï¼Œè¿™ä¸ªå°±æ˜¯Setå’ŒListçš„æ ¹æœ¬åŒºåˆ«ã€‚HashSetçš„å­˜å‚¨æ–¹å¼æ˜¯æŠŠHashMapä¸­çš„Keyä½œä¸ºSetçš„å¯¹åº”å­˜å‚¨é¡¹ã€‚çœ‹çœ‹ HashSetçš„addï¼ˆObject objï¼‰æ–¹æ³•çš„å®ç°å°±å¯ä»¥ä¸€ç›®äº†ç„¶äº†ã€‚&nbsp;</span></p>
<div id="" class="dp-highlighter"><br><div class="bar"><br><div class="tools">Javaä»£ç &nbsp;&nbsp;<a href="http://www.cnblogs.com/tiantianbyconan/admin/" title="æ”¶è—è¿™æ®µä»£ç " target="_blank" rel="noopener"><img src="http://skyuck.iteye.com/images/icon_star.png" alt="æ”¶è—ä»£ç "></a></div>

<p></p></div><p></p>
<ol>
<li><span><span class="keyword">public</span>&nbsp;<span class="keyword">boolean</span>&nbsp;add(Object&nbsp;obj)&nbsp;{&nbsp;&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;map.put(obj,&nbsp;PRESENT)&nbsp;==&nbsp;<span class="keyword">null</span>;&nbsp;&nbsp;&nbsp;</span></li>
<li><span>}&nbsp;&nbsp;&nbsp;</span></li></ol></div>

<p><span>è¿™ä¸ªä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨Setä¸­ä¸èƒ½åƒåœ¨Listä¸­ä¸€æ ·æœ‰é‡å¤çš„é¡¹çš„æ ¹æœ¬åŸå› ï¼Œå› ä¸ºHashMapçš„keyæ˜¯ä¸èƒ½æœ‰é‡å¤çš„ã€‚&nbsp;</span></p>
<p><span>LinkedHashSetï¼š</span><span>&nbsp;</span><br><span>HashSetçš„ä¸€ä¸ªå­ç±»ï¼Œä¸€ä¸ªé“¾è¡¨ã€‚&nbsp;</span></p>
<p><span>TreeSetï¼š</span><span>&nbsp;</span><br><span>SortedSetçš„å­ç±»ï¼Œå®ƒä¸åŒäºHashSetçš„æ ¹æœ¬å°±æ˜¯TreeSetæ˜¯æœ‰åºçš„ã€‚å®ƒæ˜¯é€šè¿‡SortedMapæ¥å®ç°çš„ã€‚&nbsp;</span></p>
<p><span>Setæ€»ç»“ï¼š</span><span>&nbsp;</span></p>
<ul>
<li>Setå®ç°çš„åŸºç¡€æ˜¯Mapï¼ˆHashMapï¼‰</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>Setä¸­çš„å…ƒç´ æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œå¦‚æœä½¿ç”¨add(Object obj)æ–¹æ³•æ·»åŠ å·²ç»å­˜åœ¨çš„å¯¹è±¡ï¼Œåˆ™ä¼šè¦†ç›–å‰é¢çš„å¯¹è±¡</li>
</ul>
<p><span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“2Båˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&nbsp;</span></p>
<p><span>Mapï¼š</span><span>&nbsp;</span><br><span>Map æ˜¯ä¸€ç§æŠŠé”®å¯¹è±¡å’Œå€¼å¯¹è±¡è¿›è¡Œå…³è”çš„å®¹å™¨ï¼Œè€Œä¸€ä¸ªå€¼å¯¹è±¡åˆå¯ä»¥æ˜¯ä¸€ä¸ªMapï¼Œä¾æ¬¡ç±»æ¨ï¼Œè¿™æ ·å°±å¯å½¢æˆä¸€ä¸ªå¤šçº§æ˜ å°„ã€‚å¯¹äºé”®å¯¹è±¡æ¥è¯´ï¼ŒåƒSetä¸€æ ·ï¼Œä¸€ä¸ª Mapå®¹å™¨ä¸­çš„é”®å¯¹è±¡ä¸å…è®¸é‡å¤ï¼Œè¿™æ˜¯ä¸ºäº†ä¿æŒæŸ¥æ‰¾ç»“æœçš„ä¸€è‡´æ€§;å¦‚æœæœ‰ä¸¤ä¸ªé”®å¯¹è±¡ä¸€æ ·ï¼Œé‚£ä½ æƒ³å¾—åˆ°é‚£ä¸ªé”®å¯¹è±¡æ‰€å¯¹åº”çš„å€¼å¯¹è±¡æ—¶å°±æœ‰é—®é¢˜äº†ï¼Œå¯èƒ½ä½ å¾—åˆ°çš„å¹¶ä¸æ˜¯ä½ æƒ³çš„é‚£ä¸ªå€¼å¯¹è±¡ï¼Œç»“æœä¼šé€ æˆæ··ä¹±ï¼Œæ‰€ä»¥é”®çš„å”¯ä¸€æ€§å¾ˆé‡è¦ï¼Œä¹Ÿæ˜¯ç¬¦åˆé›†åˆçš„æ€§è´¨çš„ã€‚å½“ç„¶åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼ŒæŸä¸ªé”®æ‰€å¯¹åº”çš„å€¼å¯¹è±¡å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™æ—¶ä¼šæŒ‰ç…§æœ€åä¸€æ¬¡ä¿®æ”¹çš„å€¼å¯¹è±¡ä¸é”®å¯¹åº”ã€‚å¯¹äºå€¼å¯¹è±¡åˆ™æ²¡æœ‰å”¯ä¸€æ€§çš„è¦æ±‚ï¼Œä½ å¯ä»¥å°†ä»»æ„å¤šä¸ªé”®éƒ½æ˜ å°„åˆ°ä¸€ä¸ªå€¼å¯¹è±¡ä¸Šï¼Œè¿™ä¸ä¼šå‘ç”Ÿä»»ä½•é—®é¢˜ï¼ˆä¸è¿‡å¯¹ä½ çš„ä½¿ç”¨å´å¯èƒ½ä¼šé€ æˆä¸ä¾¿ï¼Œä½ ä¸çŸ¥é“ä½ å¾—åˆ°çš„åˆ°åº•æ˜¯é‚£ä¸€ä¸ªé”®æ‰€å¯¹åº”çš„å€¼å¯¹è±¡ï¼‰ã€‚&nbsp;</span></p>
<p><span>Mapæœ‰ä¸¤ç§æ¯”è¾ƒå¸¸ç”¨çš„å®ç°ï¼šHashMapå’ŒTreeMapã€‚&nbsp;</span></p>
<p><span>HashMapä¹Ÿç”¨åˆ°äº†å“ˆå¸Œç çš„ç®—æ³•ï¼Œä»¥ä¾¿å¿«é€ŸæŸ¥æ‰¾ä¸€ä¸ªé”®ï¼Œ&nbsp;</span></p>
<p><span>TreeMapåˆ™æ˜¯å¯¹é”®æŒ‰åºå­˜æ”¾ï¼Œå› æ­¤å®ƒä¾¿æœ‰ä¸€äº›æ‰©å±•çš„æ–¹æ³•ï¼Œæ¯”å¦‚firstKey(),lastKey()ç­‰ï¼Œä½ è¿˜å¯ä»¥ä»TreeMapä¸­æŒ‡å®šä¸€ä¸ªèŒƒå›´ä»¥å–å¾—å…¶å­Mapã€‚&nbsp;</span><br><span>é”®å’Œå€¼çš„å…³è”å¾ˆç®€å•ï¼Œç”¨put(Object key,Object value)æ–¹æ³•å³å¯å°†ä¸€ä¸ªé”®ä¸ä¸€ä¸ªå€¼å¯¹è±¡ç›¸å…³è”ã€‚ç”¨get(Object key)å¯å¾—åˆ°ä¸æ­¤keyå¯¹è±¡æ‰€å¯¹åº”çš„å€¼å¯¹è±¡ã€‚&nbsp;</span></p>
<p><span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“JBåˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&nbsp;</span></p>
<p><span>å…¶å®ƒï¼š</span><span>&nbsp;</span><br><span>ä¸€ã€å‡ ä¸ªå¸¸ç”¨ç±»çš„åŒºåˆ«&nbsp;</span><br><span>1ï¼ArrayList: å…ƒç´ å•ä¸ªï¼Œæ•ˆç‡é«˜ï¼Œå¤šç”¨äºæŸ¥è¯¢&nbsp;</span><br><span>2ï¼Vector: å…ƒç´ å•ä¸ªï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå¤šç”¨äºæŸ¥è¯¢&nbsp;</span><br><span>3ï¼LinkedList:å…ƒç´ å•ä¸ªï¼Œå¤šç”¨äºæ’å…¥å’Œåˆ é™¤&nbsp;</span><br><span>4ï¼HashMap: å…ƒç´ æˆå¯¹ï¼Œå…ƒç´ å¯ä¸ºç©º&nbsp;</span><br><span>5ï¼HashTable: å…ƒç´ æˆå¯¹ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå…ƒç´ ä¸å¯ä¸ºç©º&nbsp;</span></p>
<p><span>äºŒã€Vectorã€ArrayListå’ŒLinkedList&nbsp;</span><br><span>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä»æ€§èƒ½ä¸Šæ¥è¯´ArrayListæœ€å¥½ï¼Œä½†æ˜¯å½“é›†åˆå†…çš„å…ƒç´ éœ€è¦é¢‘ç¹æ’å…¥ã€åˆ é™¤æ—¶LinkedListä¼šæœ‰æ¯”è¾ƒå¥½çš„è¡¨ç°ï¼Œä½†æ˜¯å®ƒä»¬ä¸‰ä¸ªæ€§èƒ½éƒ½æ¯”ä¸ä¸Šæ•°ç»„ï¼Œå¦å¤–Vectoræ˜¯çº¿ç¨‹åŒæ­¥çš„ã€‚æ‰€ä»¥ï¼š&nbsp;</span><br><span>å¦‚æœèƒ½ç”¨æ•°ç»„çš„æ—¶å€™(å…ƒç´ ç±»å‹å›ºå®šï¼Œæ•°ç»„é•¿åº¦å›ºå®š)ï¼Œè¯·å°½é‡ä½¿ç”¨æ•°ç»„æ¥ä»£æ›¿Listï¼›&nbsp;</span><br><span>å¦‚æœæ²¡æœ‰é¢‘ç¹çš„åˆ é™¤æ’å…¥æ“ä½œï¼Œåˆä¸ç”¨è€ƒè™‘å¤šçº¿ç¨‹é—®é¢˜ï¼Œä¼˜å…ˆé€‰æ‹©ArrayListï¼›&nbsp;</span><br><span>å¦‚æœåœ¨å¤šçº¿ç¨‹æ¡ä»¶ä¸‹ä½¿ç”¨ï¼Œå¯ä»¥è€ƒè™‘Vectorï¼›&nbsp;</span><br><span>å¦‚æœéœ€è¦é¢‘ç¹åœ°åˆ é™¤æ’å…¥ï¼ŒLinkedListå°±æœ‰äº†ç”¨æ­¦ä¹‹åœ°ï¼›&nbsp;</span><br><span>å¦‚æœä½ ä»€ä¹ˆéƒ½ä¸çŸ¥é“ï¼Œç”¨ArrayListæ²¡é”™ã€‚&nbsp;</span></p>
<p><span>ä¸‰ã€Collectionså’ŒArrays&nbsp;</span><br><span>åœ¨ Javaé›†åˆç±»æ¡†æ¶é‡Œæœ‰ä¸¤ä¸ªç±»å«åšCollectionsï¼ˆæ³¨æ„ï¼Œä¸æ˜¯Collectionï¼ï¼‰å’ŒArraysï¼Œè¿™æ˜¯JCFé‡Œé¢åŠŸèƒ½å¼ºå¤§çš„å·¥å…·ï¼Œä½†åˆå­¦è€…å¾€å¾€ä¼šå¿½è§†ã€‚æŒ‰JCFæ–‡æ¡£çš„è¯´æ³•ï¼Œè¿™ä¸¤ä¸ªç±»æä¾›äº†å°è£…å™¨å®ç°ï¼ˆWrapper Implementationsï¼‰ã€æ•°æ®ç»“æ„ç®—æ³•å’Œæ•°ç»„ç›¸å…³çš„åº”ç”¨ã€‚&nbsp;</span><br><span>æƒ³å¿…å¤§å®¶ä¸ä¼šå¿˜è®°ä¸Šé¢è°ˆåˆ°çš„&ldquo;æŠ˜åŠæŸ¥æ‰¾&rdquo;ã€&ldquo;æ’åº&rdquo;ç­‰ç»å…¸ç®—æ³•å§ï¼ŒCollectionsç±»æä¾›äº†ä¸°å¯Œçš„é™æ€æ–¹æ³•å¸®åŠ©æˆ‘ä»¬è½»æ¾å®Œæˆè¿™äº›åœ¨æ•°æ®ç»“æ„è¯¾ä¸Šçƒ¦äººçš„å·¥ä½œï¼š&nbsp;</span><br><span>binarySearchï¼šæŠ˜åŠæŸ¥æ‰¾ã€‚&nbsp;</span></p>
<p><span>sortï¼šæ’åºï¼Œè¿™é‡Œæ˜¯ä¸€ç§ç±»ä¼¼äºå¿«é€Ÿæ’åºçš„æ–¹æ³•ï¼Œæ•ˆç‡ä»ç„¶æ˜¯O(n * log n)ï¼Œä½†å´æ˜¯ä¸€ç§ç¨³å®šçš„æ’åºæ–¹æ³•ã€‚&nbsp;</span></p>
<p><span>reverseï¼šå°†çº¿æ€§è¡¨è¿›è¡Œé€†åºæ“ä½œï¼Œè¿™ä¸ªå¯æ˜¯ä»å‰æ•°æ®ç»“æ„çš„ç»å…¸è€ƒé¢˜å“¦ï¼&nbsp;</span></p>
<p><span>rotateï¼šä»¥æŸä¸ªå…ƒç´ ä¸ºè½´å¿ƒå°†çº¿æ€§è¡¨&ldquo;æ—‹è½¬&rdquo;ã€‚&nbsp;</span></p>
<p><span>swapï¼šäº¤æ¢ä¸€ä¸ªçº¿æ€§è¡¨ä¸­ä¸¤ä¸ªå…ƒç´ çš„ä½ç½®ã€‚&nbsp;</span><br><span>&hellip;&hellip;&nbsp;</span><br><span>Collectionsè¿˜æœ‰ä¸€ä¸ªé‡è¦åŠŸèƒ½å°±æ˜¯&ldquo;å°è£…å™¨&rdquo;ï¼ˆWrapperï¼‰ï¼Œå®ƒæä¾›äº†ä¸€äº›æ–¹æ³•å¯ä»¥æŠŠä¸€ä¸ªé›†åˆè½¬æ¢æˆä¸€ä¸ªç‰¹æ®Šçš„é›†åˆï¼Œå¦‚ä¸‹ï¼š&nbsp;</span></p>
<p><span>unmodifiableXXXï¼šè½¬æ¢æˆåªè¯»é›†åˆï¼Œè¿™é‡ŒXXXä»£è¡¨å…­ç§åŸºæœ¬é›†åˆæ¥å£ï¼šCollectionã€Listã€Mapã€Setã€SortedMapå’ŒSortedSetã€‚å¦‚æœä½ å¯¹åªè¯»é›†åˆè¿›è¡Œæ’å…¥åˆ é™¤æ“ä½œï¼Œå°†ä¼šæŠ›å‡ºUnsupportedOperationExceptionå¼‚å¸¸ã€‚&nbsp;</span></p>
<p><span>synchronizedXXXï¼šè½¬æ¢æˆåŒæ­¥é›†åˆã€‚&nbsp;</span></p>
<p><span>singletonï¼šåˆ›å»ºä¸€ä¸ªä»…æœ‰ä¸€ä¸ªå…ƒç´ çš„é›†åˆï¼Œè¿™é‡Œsingletonç”Ÿæˆçš„æ˜¯å•å…ƒç´ Setï¼Œ&nbsp;</span><br><span>singletonListå’ŒsingletonMapåˆ†åˆ«ç”Ÿæˆå•å…ƒç´ çš„Listå’ŒMapã€‚&nbsp;</span></p>
<p><span>ç©ºé›†ï¼šç”±Collectionsçš„é™æ€å±æ€§EMPTY_SETã€EMPTY_LISTå’ŒEMPTY_MAPè¡¨ç¤ºã€‚&nbsp;</span></p>
<p><span>è¿™æ¬¡å…³äºJavaé›†åˆç±»æ¦‚è¿°å°±åˆ°è¿™é‡Œï¼Œä¸‹ä¸€æ¬¡æˆ‘ä»¬æ¥è®²è§£Javaé›†åˆç±»çš„å…·ä½“åº”ç”¨ï¼Œå¦‚Listæ’åºã€åˆ é™¤é‡å¤å…ƒç´ ã€‚</span></p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Javaæ•°æ®ç»“æ„å’Œç®—æ³•â€”â€”æ±‰è¯ºå¡”é—®é¢˜]]></title>
      <url>/2013/03/04/Java%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95%E2%80%94%E2%80%94%E6%B1%89%E8%AF%BA%E5%A1%94%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.tiantian.algorithms;<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
     _|<em>1              |                |<br> <em>   <strong>|</strong>2             |                |
 </em>  __</em>|<strong>_3            |                |            (1).æŠŠAä¸Šçš„4ä¸ªæœ¨å—ç§»åŠ¨åˆ°Cä¸Šã€‚<br> * __</strong>|<strong>_<em>4           |                |<br> <em>     A                B                C
 </em><br> <em>     |                |                |
 </em>     |               </em>|_1              |<br> *     |              </strong>|<strong>2             |            è¦å®Œæˆ(1)çš„æ•ˆæœï¼Œå¿…é¡»è¦æŠŠ1ã€2ã€3æœ¨å—ç§»åŠ¨åˆ°Bï¼Œè¿™æ ·æ‰èƒ½æŠŠ4ç§»åŠ¨åˆ°C<br> * __</strong>|<strong>_<em>4        </em></strong>|<strong><em>3            |            å¦‚ï¼šä»£ç ä¸­çš„&ldquo;è°ƒç”¨(XX)&rdquo;<br> <em>     A                B                C
 </em><br> <em>     |                |                |
 </em>     |               </em>|_1              |<br> *     |              </strong>|<strong>2             |            æ­¤æ—¶ï¼Œé¢˜ç›®å°±å˜æˆäº†æŠŠBä¸Šçš„3ä¸ªæœ¨å—ç§»åŠ¨åˆ°Cä¸Šï¼Œå›åˆ°äº†é¢˜ç›®(1)<br> *     |             _</strong>|<strong>_3        __</strong>|____4        å¦‚ï¼šä»£ç ä¸­çš„&ldquo;è°ƒç”¨(YY)&rdquo;<br> <em>     A                B                C
 </em><br> <em>     ç„¶åå¾ªç¯è¿™ä¸ªè¿‡ç¨‹
 </em><br> <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie
  </span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2013-3-4 ä¸‹åˆ4:09:53<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> HanoiTowerTest {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {<br>        doTowers(</span>4, â€˜Aâ€™, â€˜Bâ€™, â€˜Câ€™<span style="color: #000000;">);<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> doTowers(<span style="color: #0000ff;">int</span> topN, <span style="color: #0000ff;">char</span> from, <span style="color: #0000ff;">char</span> inter, <span style="color: #0000ff;">char</span><span style="color: #000000;"> to){<br>        </span><span style="color: #0000ff;">if</span>(topN == 1<span style="color: #000000;">){<br>            System.out.println(</span>â€œæœ€åæŠŠæœ¨å—1ä»â€ + from + â€œç§»åŠ¨åˆ°â€ +<span style="color: #000000;"> to);<br>        }</span><span style="color: #0000ff;">else</span><span style="color: #000000;">{<br>            doTowers(topN </span>- 1, from, to, inter); <span style="color: #008000;">//</span><span style="color: #008000;"> è°ƒç”¨(XX)</span><br>            System.out.println(â€œæŠŠæœ¨å—â€ + topN + â€œä»â€ + from + â€œç§»åŠ¨åˆ°â€ +<span style="color: #000000;"> to);<br>            doTowers(topN </span>- 1, inter, from ,to); <span style="color: #008000;">//</span><span style="color: #008000;"> è°ƒç”¨(YY)</span><br><span style="color: #000000;">        }<br><br>    }<br>}</span></pre><br></div>

<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Struts+iBatis+Spring+mysqlæ•´åˆå¼€å‘]]></title>
      <url>/2013/03/03/Struts-iBatis-Spring-mysql%E6%95%B4%E5%90%88%E5%BC%80%E5%8F%91/</url>
      <content type="html"><![CDATA[<p><span style="line-height: 1.5;">æœ¬æ–‡ä½¿ç”¨Struts+iBatis+Springä¸‰å±‚æ¡†æ¶å¼€å®ç°å¯¹userè¡¨çš„CRUDã€‚</span></p>
<p><span style="line-height: 1.5;">åˆ†å±‚å¦‚ä¸‹ï¼š</span></p>
<p><img src="http://images.cnitblog.com/blog/378300/201303/03145921-9115e3b0b60448bab6e391c5233f80c8.jpg" alt=""></p>
<p>&nbsp;</p>
<p><span style="line-height: 1.5;">iBatisé…ç½®æ–‡ä»¶ï¼ˆsqlMapConfig.xmlï¼‰ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€UTF-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE sqlMapConfig<br>    PUBLIC â€œ-//ibatis.apache.org//DTD SQL Map Config 2.0//ENâ€<br>    â€œ<a href="http://ibatis.apache.org/dtd/sql-map-config-2.dtd" target="_blank" rel="noopener">http://ibatis.apache.org/dtd/sql-map-config-2.dtd</a>â€œ</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">sqlMapConfig</span><span style="color: #0000ff;">&gt;</span><br><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">settings </span><span style="color: #ff0000;">cacheModelsEnabled</span><span style="color: #0000ff;">=â€trueâ€</span><span style="color: #ff0000;"> enhancementEnabled</span><span style="color: #0000ff;">=â€trueâ€</span><span style="color: #ff0000;"><br>        lazyLoadingEnabled</span><span style="color: #0000ff;">=â€trueâ€</span><span style="color: #ff0000;"> errorTracingEnabled</span><span style="color: #0000ff;">=â€trueâ€</span><span style="color: #ff0000;"> maxRequests</span><span style="color: #0000ff;">=â€32â€</span><span style="color: #ff0000;"><br>        maxSessions</span><span style="color: #0000ff;">=â€10â€</span><span style="color: #ff0000;"> maxTransactions</span><span style="color: #0000ff;">=â€5â€</span><span style="color: #ff0000;"> useStatementNamespaces</span><span style="color: #0000ff;">=â€falseâ€</span> <span style="color: #0000ff;">/&gt;</span><br><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">sqlMap </span><span style="color: #ff0000;">resource</span><span style="color: #0000ff;">=â€com/tiantian/ibatis/model/user.xmlâ€</span> <span style="color: #0000ff;">/&gt;</span><br><br><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">sqlMapConfig</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>&nbsp;</p>
<p>struts.xmlï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€UTF-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE struts PUBLIC<br>    â€œ-//Apache Software Foundation//DTD Struts Configuration 2.3//ENâ€<br>    â€œ<a href="http://struts.apache.org/dtds/struts-2.3.dtd" target="_blank" rel="noopener">http://struts.apache.org/dtds/struts-2.3.dtd</a>â€œ</span><span style="color: #0000ff;">&gt;</span><br><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">struts</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">package </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€ibatis_testâ€</span><span style="color: #ff0000;"> extends</span><span style="color: #0000ff;">=â€struts-defaultâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> æ³¨å†ŒUser action </span><span style="color: #008000;">â€“&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">action </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€registerUserâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€registerUserActionâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">action</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> åˆ é™¤User action </span><span style="color: #008000;">â€“&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">action </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€deleteUserâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€deleteUserActionâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">action</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> æ›´æ–°User action </span><span style="color: #008000;">â€“&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">action </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€updateUserâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€updateUserActionâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">action</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> æŸ¥è¯¢æ‰€æœ‰User action </span><span style="color: #008000;">â€“&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">action </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€findAllUsersâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€findAllUsersActionâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">action</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> æŸ¥è¯¢æŒ‡å®šidçš„User action </span><span style="color: #008000;">â€“&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">action </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€findUserByIdâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€findUserByIdActionâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">action</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> æ¨¡ç³ŠæŸ¥è¯¢User action </span><span style="color: #008000;">â€“&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">action </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€findUsersBykeywordâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€findUsersBykeywordActionâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">action</span><span style="color: #0000ff;">&gt;</span><br><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">package</span><span style="color: #0000ff;">&gt;</span><br><br><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">struts</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>&nbsp;</p>
<p>user.xmlé…ç½®æ–‡ä»¶ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€UTF-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE sqlMap<br>    PUBLIC â€œ-//ibatis.apache.org//DTD SQL Map 2.0//ENâ€<br>    â€œ<a href="http://ibatis.apache.org/dtd/sql-map-2.dtd" target="_blank" rel="noopener">http://ibatis.apache.org/dtd/sql-map-2.dtd</a>â€œ</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">sqlMap</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> ä¸ºStudentç±»å–ä¸ªåˆ«å </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">typeAlias </span><span style="color: #ff0000;">alias</span><span style="color: #0000ff;">=â€UserAliasâ€</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">=â€com.tiantian.ibatis.model.Userâ€</span><span style="color: #0000ff;">/&gt;</span><br><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> é…ç½®è¡¨å’Œå®ä½“Beanä¹‹é—´çš„æ˜ å°„å…³ç³» </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">resultMap </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€userMapâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€com.tiantian.ibatis.model.Userâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">property</span><span style="color: #0000ff;">=â€idâ€</span><span style="color: #ff0000;"> column</span><span style="color: #0000ff;">=â€idâ€</span><span style="color: #0000ff;">/&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">property</span><span style="color: #0000ff;">=â€usernameâ€</span><span style="color: #ff0000;"> column</span><span style="color: #0000ff;">=â€usernameâ€</span><span style="color: #0000ff;">/&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">property</span><span style="color: #0000ff;">=â€passwordâ€</span><span style="color: #ff0000;"> column</span><span style="color: #0000ff;">=â€passwordâ€</span><span style="color: #0000ff;">/&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">result </span><span style="color: #ff0000;">property</span><span style="color: #0000ff;">=â€ageâ€</span><span style="color: #ff0000;"> column</span><span style="color: #0000ff;">=â€ageâ€</span><span style="color: #0000ff;">/&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">resultMap</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> æ·»åŠ æ•°æ® </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">insert </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€registerUserâ€</span><span style="color: #ff0000;"> parameterClass</span><span style="color: #0000ff;">=â€UserAliasâ€</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"><br>        INSERT INTO user VALUES (NULL, #username#, #password#, #age#);<br>    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">insert</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> åˆ é™¤æŒ‡å®šidçš„æ•°æ® </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">delete </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€deleteUserâ€</span><span style="color: #ff0000;"> parameterClass</span><span style="color: #0000ff;">=â€UserAliasâ€</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"><br>        DELETE FROM user WHERE id = #id#;<br>    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">delete</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> ä¿®æ”¹æŒ‡å®šidçš„æ•°æ® </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">update </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€updateUserâ€</span><span style="color: #ff0000;"> parameterClass</span><span style="color: #0000ff;">=â€UserAliasâ€</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"><br>        UPDATE user<br>        SET username = #username#, password = #password#, age = #age#<br>        WHERE id = #id#;<br>    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">update</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> æŸ¥è¯¢æ‰€æœ‰Userä¿¡æ¯ </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€findAllUsersâ€</span><span style="color: #ff0000;"> resultMap</span><span style="color: #0000ff;">=â€userMapâ€</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"><br>        SELECT <em> FROM user;<br>    </em></span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> æŸ¥è¯¢æŒ‡å®šidçš„Userä¿¡æ¯ </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€findUserByIdâ€</span><span style="color: #ff0000;"> resultMap</span><span style="color: #0000ff;">=â€userMapâ€</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"><br>        SELECT  FROM user WHERE id = #id#;<br>    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> æ¨¡ç³ŠæŸ¥è¯¢ </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€findUsersByKeywordâ€</span><span style="color: #ff0000;"> resultMap</span><span style="color: #0000ff;">=â€userMapâ€</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"><br>        SELECT * FROM user WHERE username LIKE â€˜%$keyword$%â€™;<br>    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span><br><br><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">sqlMap</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>&nbsp;</p>
<p>applicationContext.xmlé…ç½®æ–‡ä»¶ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€UTF-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">beans </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">=â€<a href="http://www.springframework.org/schema/beans" target="_blank" rel="noopener">http://www.springframework.org/schema/beans</a>â€œ</span><span style="color: #ff0000;"><br>    xmlns:xsi</span><span style="color: #0000ff;">=â€<a href="http://www.w3.org/2001/XMLSchema-instance" target="_blank" rel="noopener">http://www.w3.org/2001/XMLSchema-instance</a>â€œ</span><span style="color: #ff0000;"> xmlns:p</span><span style="color: #0000ff;">=â€<a href="http://www.springframework.org/schema/p" target="_blank" rel="noopener">http://www.springframework.org/schema/p</a>â€œ</span><span style="color: #ff0000;"><br>    xsi:schemaLocation</span><span style="color: #0000ff;">=â€<a href="http://www.springframework.org/schema/beans" target="_blank" rel="noopener">http://www.springframework.org/schema/beans</a> <a href="http://www.springframework.org/schema/beans/spring-beans-3.0.xsd" target="_blank" rel="noopener">http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</a>â€œ</span><span style="color: #0000ff;">&gt;</span><br><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€dataSourceâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€org.apache.commons.dbcp.BasicDataSourceâ€</span><span style="color: #ff0000;"><br>        destroy-method</span><span style="color: #0000ff;">=â€closeâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€driverClassNameâ€</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">=â€com.mysql.jdbc.Driverâ€</span> <span style="color: #0000ff;">/&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€urlâ€</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">=â€jdbc:mysql://localhost:3306/testâ€</span> <span style="color: #0000ff;">/&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€usernameâ€</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">=â€rootâ€</span> <span style="color: #0000ff;">/&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€passwordâ€</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">=â€XXXXâ€</span> <span style="color: #0000ff;">/&gt;</span><br><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€validationQueryâ€</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">=â€select user.id from userâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€maxIdleâ€</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">=â€15â€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€maxActiveâ€</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">=â€15â€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€maxWaitâ€</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">=â€1000â€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€sqlMapClientâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€org.springframework.orm.ibatis.SqlMapClientFactoryBeanâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€configLocationâ€</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">=â€classpath:sqlMapConfig.xmlâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€dataSourceâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€dataSourceâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> äº‹åŠ¡ç®¡ç† </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€transactionManagerâ€</span><span style="color: #ff0000;"><br>        class</span><span style="color: #0000ff;">=â€org.springframework.jdbc.datasource.DataSourceTransactionManagerâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€dataSourceâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€dataSourceâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> å£°æ˜å¼äº‹åŠ¡ç®¡ç† </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€baseTransactionProxyâ€</span><span style="color: #ff0000;"><br>        class</span><span style="color: #0000ff;">=â€org.springframework.transaction.interceptor.TransactionProxyFactoryBeanâ€</span><span style="color: #ff0000;"><br>        abstract</span><span style="color: #0000ff;">=â€trueâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€transactionManagerâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€transactionManagerâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€transactionAttributesâ€</span><span style="color: #0000ff;">&gt;</span><br>            <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">props</span><span style="color: #0000ff;">&gt;</span><br>                <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"><br>                    è¡¨ç¤ºè®¾ç½®äº‹åŠ¡å±æ€§æ‰€æœ‰ä»¥â€findâ€å’Œâ€getâ€å¼€å¤´çš„æ–¹æ³•ï¼š<br>                    - PROPAGATION_REQUIRED: å½“å‰å­˜åœ¨äº‹åŠ¡åˆ™ä½¿ç”¨å­˜åœ¨çš„äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡<br>                    - readOnly:è¡¨ç¤ºåªè¯»çš„äº‹åŠ¡<br>                 </span><span style="color: #008000;">â€“&gt;</span><br>                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">prop </span><span style="color: #ff0000;">key</span><span style="color: #0000ff;">=â€find<em>â€œ</em></span><span style="color: #0000ff;">&gt;</span>PROPAGATION_REQUIRED,readOnly<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">prop</span><span style="color: #0000ff;">&gt;</span><br>                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">prop </span><span style="color: #ff0000;">key</span><span style="color: #0000ff;">=â€getâ€œ</span><span style="color: #0000ff;">&gt;</span>PROPAGATION_REQUIRED,readOnly<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">prop</span><span style="color: #0000ff;">&gt;</span><br>                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">prop </span><span style="color: #ff0000;">key</span><span style="color: #0000ff;">=â€<em>â€œ</em></span><span style="color: #0000ff;">&gt;</span>PROPAGATION_REQUIRED<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">prop</span><span style="color: #0000ff;">&gt;</span><br>            <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">props</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong>ä»¥ä¸Šä¸€èˆ¬åªéœ€ä¿®æ”¹æ•°æ®åº“é…ç½®<strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong> </span><span style="color: #008000;">â€“&gt;</span><br><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong> </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong></strong>DAO<strong><strong><strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong></strong></strong> </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong> </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> DAOã€Serviceä¸€èˆ¬éƒ½é…ç½®æˆsingletonï¼ˆå¯ä»¥ä¸å†™ï¼Œå› ä¸ºé»˜è®¤æ˜¯singletonï¼‰ </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€userDaoâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€com.tiantian.ibatis.dao.impl.UserDaoImplâ€</span><span style="color: #ff0000;"> scope</span><span style="color: #0000ff;">=â€singletonâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€sqlMapClientâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€sqlMapClientâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong> </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong></strong>Service<strong><strong><strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong></strong></strong> </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong> </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> Serviceï¼Œæ²¡æœ‰äº‹åŠ¡åŠŸèƒ½ </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€userServiceTargetâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€com.tiantian.ibatis.service.impl.UserServiceImplâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€userDaoâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€userDaoâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> Serviceçš„ä»£ç†ï¼Œç›®çš„æ˜¯ä¸ºServiceæ·»åŠ äº‹åŠ¡çš„åŠŸèƒ½ </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #ff0000;"> parent</span><span style="color: #0000ff;">=â€baseTransactionProxyâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€targetâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€userServiceTargetâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong> </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong></strong>Action<strong><strong><strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong></strong></strong> </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>**</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong> </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> Actionä¸€èˆ¬éƒ½é…ç½®æˆprototypeï¼ˆå¿…é¡»è¦å†™!ï¼‰ </span><span style="color: #008000;">â€“&gt;</span><br><span style="color: #008000;">&lt;!â€“</span><span style="color: #008000;"> <strong>User Actions</strong> </span><span style="color: #008000;">â€“&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€registerUserActionâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€com.tiantian.ibatis.action.user.RegisterUserActionâ€</span><span style="color: #ff0000;"> scope</span><span style="color: #0000ff;">=â€prototypeâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€deleteUserActionâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€com.tiantian.ibatis.action.user.DeleteUserActionâ€</span><span style="color: #ff0000;"> scope</span><span style="color: #0000ff;">=â€prototypeâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€updateUserActionâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€com.tiantian.ibatis.action.user.UpdateUserActionâ€</span><span style="color: #ff0000;"> scope</span><span style="color: #0000ff;">=â€prototypeâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€findAllUsersActionâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€com.tiantian.ibatis.action.user.FindAllUsersActionâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€findUserByIdActionâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€com.tiantian.ibatis.action.user.FindUserByIdActionâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">bean </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=â€findUsersBykeywordActionâ€</span><span style="color: #ff0000;"> class</span><span style="color: #0000ff;">=â€com.tiantian.ibatis.action.user.FindUsersByKeywordActionâ€</span><span style="color: #0000ff;">&gt;</span><br>        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">property </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #ff0000;"> ref</span><span style="color: #0000ff;">=â€userServiceâ€</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">property</span><span style="color: #0000ff;">&gt;</span><br>    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">bean</span><span style="color: #0000ff;">&gt;</span><br><br><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">beans</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>&nbsp;</p>
<p>DAOæ¥å£ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2013-3-1 ä¸‹åˆ5:44:21<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> UserDao {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> registerUser(User user);<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> deleteUser(User user);<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> updateUser(User user);<br>    </span><span style="color: #0000ff;">public</span> List&lt;User&gt;<span style="color: #000000;"> findAllUsers();<br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> User findUserById(User user);<br>    </span><span style="color: #0000ff;">public</span> List&lt;User&gt;<span style="color: #000000;"> findUsersByKeyword(String keyword);<br>}</span></pre><br></div>

<p>DAOå®ç°ç±»ï¼ˆæ‰§è¡Œå„ä¸ªActionæ‰€éœ€çš„æ•°æ®åº“æŸ¥è¯¢æ“ä½œï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.tiantian.ibatis.dao.impl;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.orm.ibatis.support.SqlMapClientDaoSupport;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.tiantian.ibatis.dao.UserDao;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.tiantian.ibatis.model.User;<br><br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2013-3-1 ä¸‹åˆ6:09:53<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> UserDaoImpl <span style="color: #0000ff;">extends</span> SqlMapClientDaoSupport <span style="color: #0000ff;">implements</span><span style="color: #000000;"> UserDao{<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> registerUser(User user) {<br>        getSqlMapClientTemplate().insert(</span>â€œregisterUserâ€<span style="color: #000000;">, user);<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> deleteUser(User user) {<br>        </span><span style="color: #0000ff;">boolean</span> result = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br>        </span><span style="color: #0000ff;">int</span> effectedRow = getSqlMapClientTemplate().delete(â€œdeleteUserâ€<span style="color: #000000;">, user);<br>        System.out.println(</span>â€œdelete effectedRow: â€œ +<span style="color: #000000;"> effectedRow);<br>        result </span>= effectedRow &gt; 0 ? <span style="color: #0000ff;">true</span> : <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> result;<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> updateUser(User user) {<br>        </span><span style="color: #0000ff;">boolean</span> result = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br>        </span><span style="color: #0000ff;">int</span> effectedRow = getSqlMapClientTemplate().update(â€œupdateUserâ€<span style="color: #000000;">, user);<br>        System.out.println(</span>â€œupdate effectedRow: â€œ +<span style="color: #000000;"> effectedRow);<br>        result </span>= effectedRow &gt; 0 ? <span style="color: #0000ff;">true</span> : <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> result;<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> List&lt;User&gt;<span style="color: #000000;"> findAllUsers() {<br>        </span><span style="color: #0000ff;">return</span> (List&lt;User&gt;)getSqlMapClientTemplate().queryForList(â€œfindAllUsersâ€<span style="color: #000000;">);<br>    }<br><br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> User findUserById(User user) {<br>        </span><span style="color: #0000ff;">return</span> (User) getSqlMapClientTemplate().queryForObject(â€œfindUserByIdâ€<span style="color: #000000;">, user);<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> List&lt;User&gt;<span style="color: #000000;"> findUsersByKeyword(String keyword) {<br>        </span><span style="color: #0000ff;">return</span> (List&lt;User&gt;)getSqlMapClientTemplate().queryForList(â€œfindUsersByKeywordâ€<span style="color: #000000;">, keyword);<br>    }<br><br>}</span></pre><br></div>

<p>Actionç±»ï¼ˆä»¥RegisterUserActionä¸ºä¾‹ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.tiantian.ibatis.action.user;<br><br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.opensymphony.xwork2.ActionSupport;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.tiantian.ibatis.model.User;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.tiantian.ibatis.service.UserService;<br></span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.tiantian.ibatis.service.impl.UserServiceImpl;<br><br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2013-3-2 ä¸‹åˆ11:26:18<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> RegisterUserAction <span style="color: #0000ff;">extends</span><span style="color: #000000;"> ActionSupport{<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> UserService userService;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> User user;<br><br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> User getUser() {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> user;<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setUser(User user) {<br>        </span><span style="color: #0000ff;">this</span>.user =<span style="color: #000000;"> user;<br>    }<br><br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> UserService getUserService() {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> userService;<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setUserService(UserService userService) {<br>        </span><span style="color: #0000ff;">this</span>.userService =<span style="color: #000000;"> userService;<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> String execute() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {<br>        userService.registerUser(user);<br>        System.out.println(</span>â€œæ•°æ®å·²ç»æ’å…¥â€<span style="color: #000000;">);<br>        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br>    }<br>}</span></pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> database </tag>
            
            <tag> j2ee </tag>
            
            <tag> java web </tag>
            
            <tag> mysql </tag>
            
            <tag> struts </tag>
            
            <tag> ibatis </tag>
            
            <tag> spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[svnçš„ä½¿ç”¨]]></title>
      <url>/2013/02/27/svn%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>æ–°å»ºå¦‚ä¸‹ç»“æ„çš„æ–‡ä»¶å¤¹ï¼š<br>sv_workspace<br>    |â€“svn_repos<br>    |â€“svn_imports<br>    |â€“svn_checkouts</p>
<p>svn_reposï¼šä¸­åˆ›å»ºå„ç§ç‰ˆæœ¬åº“ï¼ˆä¸€ä¸ªé¡¹ç›®ä½¿ç”¨ä¸€ä¸ªç‰ˆæœ¬åº“ï¼‰<br>svn_importsï¼šå¯¼å…¥æœ€åˆå§‹çš„é¡¹ç›®<br>svn_checkoutsï¼šä»ç‰ˆæœ¬åº“ä¸­æ£€å‡ºçš„é¡¹ç›®ï¼ŒçœŸæ­£çš„å·¥ä½œç›®å½•</p>
<p>1.å…ˆåœ¨svn_reposä¸­æ–°å»ºç‰ˆæœ¬åº“ï¼Œå¦‚ï¼šinfolife_repoï¼Œå³é”®åœ¨æ­¤åˆ›å»ºç‰ˆæœ¬åº“ã€‚<br>2.åœ¨svn_importsæ–‡ä»¶å¤¹ä¸­æ–°å»ºå¯¹åº”çš„æ–‡ä»¶å¤¹æ£€å‡ºï¼Œå¦‚ï¼šinfolife_importã€‚<br>å³é”®æ£€å‡ºï¼Œæ­¤æ—¶è¯¥æ–‡ä»¶å¤¹ä¼šç”Ÿæˆbranchesã€tagsã€trunkå’Œä¸€ä¸ª.svnçš„æ–‡ä»¶å¤¹<br>3ã€‚.åœ¨eclipseä¸­æ–°å»ºé¡¹ç›®åï¼ŒæŠŠé¡¹ç›®å¤åˆ¶åˆ°svn_importsç›®å½•çš„truckç›®å½•ä¸‹ï¼Œ</p>
<p>ç„¶åå³é”®å¯¼å…¥ï¼Œurlå†™ç‰ˆæœ¬åº“çš„truckç›®å½•</p>
<p>4.æœ€ååœ¨å·¥ä½œç›®å½•ï¼ˆsvn_checkoutsï¼‰æ–°å»ºä¸€ä¸ªç›®å½•æ¯”å¦‚c:\svnclient\rolex</p>
<p>\trunkï¼Œç„¶ååœ¨trunkä¸Šcheckoutå‡ºsvn://IP/infolife/trunkä¸Šçš„å†…å®¹ã€‚<br>æˆ–è€…åœ¨ä½¿ç”¨eclipseçš„importï¼Œæ£€å‡ºç›®å½•é€‰æ‹©svn_checkoutså³å¯</p>
]]></content>
      
        
        <tags>
            
            <tag> svn </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[çœ‹ä¹¦ç¬”è®°]ã€Šæ·±å…¥javaè™šæ‹Ÿæœºã€‹â€”â€”javaä½“ç³»ç»“æ„ï¼ˆäºŒï¼‰]]></title>
      <url>/2013/02/24/%E7%9C%8B%E4%B9%A6%E7%AC%94%E8%AE%B0-%E3%80%8A%E6%B7%B1%E5%85%A5java%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%8B%E2%80%94%E2%80%94java%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>javaè™šæ‹Ÿæœºçš„ä¸‰ç§å«ä¹‰ï¼š</p>
<ul>
<li>æŠ½è±¡çš„è§„èŒƒ</li>
<li>ä¸€ä¸ªå…·ä½“çš„å®ç°</li>
<li>ä¸€ä¸ªè¿è¡Œä¸­çš„è™šæ‹Ÿæœºå®ä¾‹</li>
</ul>
<p>â€”â€”â€”â€”â€”â€”â€”javaè™šæ‹Ÿæœºçš„ç”Ÿå‘½å‘¨æœŸï¼š<br>javaè™šæ‹Ÿæœºå®ä¾‹çš„å¤©èŒå°±æ˜¯è´Ÿè´£è¿è¡Œä¸€ä¸ªjavaç¨‹åºã€‚<br>å¯åŠ¨ä¸€ä¸ªjavaç¨‹åºï¼Œä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹è¯ç”Ÿäº†ï¼›ç¨‹åºå…³é—­é€€å‡ºï¼Œè™šæ‹Ÿæœºæ¶ˆäº¡ã€‚<br>æœ‰å‡ ä¸ªjavaç¨‹åºæ­£åœ¨è¿è¡Œï¼Œå°±æœ‰å‡ ä¸ªjavaè™šæ‹Ÿæœºå®ä¾‹ã€‚æ¯ä¸ªjavaç¨‹åºéƒ½è¿è¡Œåœ¨è‡ªå·±çš„javaè™šæ‹Ÿæœºå®ä¾‹ä¸­ã€‚</p>
<p>javaè™šæ‹Ÿæœºä¸­æœ‰ä¸¤ç§çº¿ç¨‹ï¼š</p>
<ul>
<li>å®ˆæŠ¤çº¿ç¨‹ï¼šç”±è™šæ‹Ÿæœºè‡ªå·±ä½¿ç”¨çš„ï¼ˆæ‰§è¡Œåƒåœ¾æ”¶é›†çº¿ç¨‹ï¼‰ï¼Œjavaç¨‹åºä¹Ÿå¯ä»¥æŠŠä»»ä½•çº¿ç¨‹æ ‡è®°ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</li>
<li>éå®ˆæŠ¤çº¿ç¨‹ï¼šmain()è¿™ç§ã€‚</li>
</ul>
<p>éå®ˆæŠ¤çº¿ç¨‹éƒ½ç»ˆæ­¢æ—¶ï¼Œè™šæ‹Ÿæœºå®ä¾‹æ‰è‡ªåŠ¨é€€å‡ºã€‚ï¼ˆä¹Ÿå¯ä»¥è°ƒç”¨Runtimeæˆ–Systemçš„exit()æ–¹æ³•é€€å‡ºç¨‹åºï¼‰ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”javaè™šæ‹Ÿæœºçš„ä½“ç³»ç»“æ„ï¼š<br>è§åŒç›®å½•ç¬¬äº”ç« .Javaè™šæ‹Ÿæœº-ä½“ç³»ç»“æ„å›¾ï¼<br>æ–¹æ³•åŒºå’Œå †æ˜¯è¯¥è™šæ‹Ÿæœºå®ä¾‹çš„æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ã€‚<br>å½“è™šæ‹Ÿæœºè£…è½½ä¸€ä¸ªclassæ–‡ä»¶æ—¶ï¼Œä»–ä¼šä»è¿™ä¸ªclassæ–‡ä»¶åŒ…å«çš„äºŒè¿›åˆ¶æ•°æ®ä¸­è§£æç±»å‹ä¿¡æ¯ï¼Œç„¶åæŠŠè¿™äº›ç±»å‹ä¿¡æ¯æ”¾åˆ°æ–¹æ³•åŒºä¸­ã€‚<br>å½“ç¨‹åºè¿è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºä¼šæŠŠæ‰€æœ‰è¯¥ç¨‹åºåœ¨è¿è¡Œæ—¶åˆ›å»ºçš„å¯¹è±¡éƒ½æ”¾åˆ°å †ä¸­ã€‚</p>
<p>æ¯ä¸ªæ–°çº¿ç¨‹è¢«åˆ›å»ºæ—¶ï¼Œä»–éƒ½å°†å¾—åˆ°å®ƒè‡ªå·±çš„PCå¯„å­˜å™¨ä»¥åŠä¸€ä¸ªjavaæ ˆï¼ˆä¸æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼‰ã€‚<br>javaè™šæ‹Ÿæœºä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºå†…å­˜åŒºï¼Œè¿™äº›å†…å­˜åŒºåŸŸæ˜¯ç§æœ‰çš„ï¼Œä»»ä½•çº¿ç¨‹éƒ½ä¸èƒ½è®¿é—®å¦ä¸€ä¸ªçº¿ç¨‹çš„PCå¯„å­˜å™¨æˆ–è€…javaæ ˆã€‚<br>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªjavaæ–¹æ³•ï¼ˆéæœ¬åœ°æ–¹æ³•ï¼‰ï¼Œé‚£ä¹ˆPCå¯„å­˜å™¨çš„å€¼å°†æ€»æ˜¯æŒ‡ç¤ºä¸‹ä¸€æ¡å°†è¢«æ‰§è¡Œçš„æŒ‡ä»¤ã€‚<br>javaæ ˆåˆ™æ€»æ˜¯å­˜å‚¨è¯¥çº¿ç¨‹ä¸­javaæ–¹æ³•è°ƒç”¨çš„çŠ¶æ€ï¼ˆå±€éƒ¨å˜é‡ã€è¢«è°ƒç”¨æ—¶ä¼ è¿›æ¥çš„å‚æ•°ã€è¿”å›å€¼ã€è¿ç®—çš„ä¸­é—´ç»“æœï¼‰</p>
<p>æœ¬åœ°æ–¹æ³•è°ƒç”¨çš„çŠ¶æ€åˆ™æ˜¯ä»¥æŸç§ä¾èµ–äºå…·ä½“å®ç°çš„æ–¹å¼å­˜å‚¨åœ¨æœ¬åœ°æ–¹æ³•æ ˆä¸­ï¼Œä¹Ÿå¯èƒ½åœ¨å¯„å­˜å™¨æˆ–è€…å…¶ä»–æŸäº›ç‰¹å®šå®ç°ç›¸å…³çš„å†…å­˜åŒºä¸­ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”æ ˆå¸§ï¼ˆ1ï¼‰ï¼š<br>javaæ ˆä¸Šç”±è®¸å¤šæ ˆå¸§ï¼ˆå¸§ï¼‰ç»„æˆçš„ï¼Œä¸€ä¸ªæ ˆå¸§åŒ…å«ä¸€ä¸ªjavaæ–¹æ³•è°ƒç”¨çš„çŠ¶æ€ã€‚<br>å½“çº¿ç¨‹è°ƒç”¨ä¸€ä¸ªjavaæ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºå‹å…¥ä¸€ä¸ªæ–°çš„æ ˆå¸§åˆ°è¯¥çº¿ç¨‹çš„javaæ ˆä¸­ï¼›å½“æ–¹æ³•è¿”å›æ—¶ï¼Œè¿™ä¸ªæ ˆå¸§è¢«ä»javaæ ˆä¸­å¼¹å‡ºå¹¶æŠ›å¼ƒã€‚</p>
<p>javaè™šæ‹Ÿæœºæ²¡æœ‰å¯„å­˜å™¨ï¼Œå…¶æŒ‡ä»¤é›†ä½¿ç”¨javaæ ˆæ¥å­˜å‚¨ä¸­é—´æ•°æ®ï¼ˆä¸ºäº†å¹³å°æ— å…³æ€§ï¼‰ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”ç±»å‹æ•°æ®<br>ç±»å‹æ•°æ®åˆ†ä¸ºæ¥é‚£ä¸ªä¸­ï¼š<br>åŸºæœ¬ç±»å‹ï¼šfloatã€doubleã€byteã€shortã€intã€longã€charã€boolean<br>å¼•ç”¨ç±»å‹ï¼šreferenceï¼ˆç±»å¼•ç”¨ã€æ¥å£å¼•ç”¨ã€æ•°ç»„å¼•ç”¨ï¼‰<br>æ³¨æ„ï¼šç¼–è¯‘æˆå­—èŠ‚ç æ—¶booleanç”¨intè¡¨ç¤ºï¼Œ</p>
<p>javaè™šæ‹Ÿæœºä¸­ï¼Œæœ€åŸºæœ¬çš„æ•°æ®å•å…ƒå°±æ˜¯å­—ï¼Œè‡³å°‘é€‰æ‹©32ä½ä½œä¸ºå­—é•¿ã€‚<br>è¿è¡Œæ—¶æ•°æ®åŒºçš„å¤§éƒ¨åˆ†å†…å®¹ï¼Œéƒ½æ˜¯åŸºäº&ldquo;å­—&rdquo;è¿™ä¸ªæŠ½è±¡æ¦‚å¿µçš„ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”ç±»è£…è½½å™¨å­ç³»ç»Ÿï¼š<br>ç±»è£…è½½å™¨çš„è£…è½½ã€è¿æ¥å’Œåˆå§‹åŒ–ï¼š</p>
<ul>
<li>è£…è½½ï¼šæŸ¥æ‰¾å¹¶è£…è½½ç±»å‹çš„äºŒè¿›åˆ¶æ•°æ®</li>
<li>è¿æ¥ï¼šæ‰§è¡ŒéªŒè¯ï¼Œå‡†å¤‡ï¼Œä»¥åŠè§£æï¼ˆå¯é€‰ï¼‰ã€‚<br>  éªŒè¯ï¼šç¡®ä¿è¢«å¯¼å…¥ç±»å‹çš„æ­£ç¡®æ€§ã€‚<br>  å‡†å¤‡ï¼šä¸ºé™æ€å˜é‡åˆ†é…å†…å­˜ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸ºé»˜è®¤å€¼ã€‚<br>  è§£æï¼šæŠŠç±»å‹ä¸­çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ã€‚</li>
<li>åˆå§‹åŒ–ï¼šæŠŠé™æ€å˜é‡åˆå§‹åŒ–ä¸ºæ­£ç¡®åˆå§‹å€¼ã€‚</li>
</ul>
<p>å¯åŠ¨ç±»è£…è½½å™¨ï¼š<br>åªè¦æ˜¯ç¬¦åˆjava classæ–‡ä»¶æ ¼å¼çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œjavaè™šæ‹Ÿæœºå®ç°éƒ½å¿…é¡»èƒ½å¤Ÿä»ä¸­è¾¨åˆ«å¹¶è£…è½½å™¨ä¸­çš„ç±»å’Œæ¥å£ã€‚æ¯ä¸ªjavaè™šæ‹Ÿæœºå®ç°å¿…é¡»æœ‰ä¸€ä¸ªå¯åŠ¨ç±»åŠ è½½å™¨æ¥åŠ è½½å—ä¿¡ä»»çš„ç±»ï¼Œæ¯”å¦‚java APIã€‚</p>
<p>ç”¨æˆ·è‡ªå®šä¹‰ç±»è£…è½½å™¨ï¼š<br>ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»è£…è½½å™¨æ˜¯æ™®é€šçš„javaå¯¹è±¡ï¼Œå®ƒçš„ç±»å¿…é¡»æ´¾ç”Ÿè‡ªjava.lang.ClassLoaderç±»ã€‚ClassLoaderç±»ä¸­å®šä¹‰çš„æ–¹æ³•ä¸ºç¨‹åºæä¾›äº†è®¿é—®ç±»è£…è½½å™¨æœºåˆ¶çš„æ¥å£ã€‚<br>ç”¨æˆ·è‡ªå®šä¹‰ç±»è£…è½½å™¨å’ŒClassç±»çš„å®ä¾‹éƒ½æ”¾åœ¨å†…å­˜ä¸­çš„å †åŒºï¼Œè€Œè£…è½½çš„ç±»å‹ä¿¡æ¯åˆ™éƒ½ä½äºæ–¹æ³•åŒºã€‚</p>
<p>ClassLoaderç±»çš„å››ä¸ªé€šå¾€javaè™šæ‹Ÿæœºçš„æ–¹æ³•ï¼š<br>protected final Class defineClass(String name, byte data[], int offset, int length);<br>æ¥æ”¶ä¸€ä¸ªåä¸ºdata[]çš„å­—èŠ‚æ•°ç»„ï¼Œå¹¶ä¸”åœ¨data[offset]åˆ°data[data+length]ä¹‹é—´çš„äºŒè¿›åˆ¶æ•°æ®å¿…é¡»ç¬¦åˆjava classæ ¼å¼ï¼ˆè¡¨ç¤ºä¸€ä¸ªæ–°çš„å¯ç”¨ç±»ï¼‰ï¼Œnameæ˜¯è¯¥ç±»å‹çš„å…¨é™å®šåï¼Œå¹¶å°†èµ‹ä»¥é»˜è®¤çš„ä¿æŠ¤åŸŸã€‚æ³¨æ„ï¼šè¯¥æ–¹æ³•è¿”å›Classå¯¹è±¡å®ä¾‹æ—¶è¡¨ç¤ºæŒ‡å®šçš„classæ–‡ä»¶å·²ç»è¢«æ‰¾åˆ°å¹¶è£…è½½åˆ°äº†æ–¹æ³•åŒºï¼ˆä¸ä¸€å®šè¿æ¥å’Œåˆå§‹åŒ–ï¼‰</p>
<p>protected final Class defineClass(String name, byte data[], int offset, int length,<br>ProtectionDomain protectionDomain);<br>ä¸å‰é¢ä¸€æ ·ï¼Œåªæ˜¯ï¼Œè¯¥ç±»å‹çš„ä¿æŠ¤åŸŸå°†ç”±å®ƒçš„protectionDomainå‚æ•°æŒ‡å®šã€‚</p>
<p>protected final Class findSystemClass(String name);<br>æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²nameï¼ˆè¯¥ç±»å‹çš„å…¨é™å®šåï¼‰ï¼Œç”¨äºå¯åŠ¨ç³»ç»Ÿç±»è£…è½½å™¨ï¼ˆå¿…é¡»ä¿è¯èƒ½å¯åŠ¨ï¼‰ã€‚</p>
<p>protected final void resolveClass(Class c);<br>æ¥æ”¶ä¸€ä¸ªClasså®ä¾‹çš„å¼•ç”¨ä½œä¸ºå‚æ•°ï¼Œå®ƒå°†å¯¹è¯¥Classå®ä¾‹è¡¨ç¤ºçš„ç±»å‹æ‰§è¡Œè¿æ¥åŠ¨ä½œï¼ˆå¿…é¡»ä¿è¯èƒ½æ‰§è¡Œè¿æ¥åŠ¨ä½œï¼‰ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”æ–¹æ³•åŒºï¼š<br>æ‰€æœ‰çº¿ç¨‹éƒ½å…±äº«æ–¹æ³•åŒºï¼Œæ‰€ä»¥å®ƒä»¬å¯¹æ–¹æ³•åŒºæ•°æ®çš„è®¿é—®å¿…é¡»è¢«è®¾è®¡ä¸ºæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚<br>æ–¹æ³•åŒºçš„å¤§å°ä¸å¿…è¯´å›ºå®šçš„ï¼Œè™šæ‹Ÿæœºå¯ä»¥æ ¹æ®åº”ç”¨çš„éœ€è¦åŠ¨æ€è°ƒæ•´ã€‚<br>æ–¹æ³•åŒºä¸å¿…æ˜¯è¿ç»­çš„ã€‚<br>æ–¹æ³•åŒºä¹Ÿå¯ä»¥è¢«åƒåœ¾æ”¶é›†ã€‚</p>
<p>ç±»å‹ä¿¡æ¯ï¼š<br>å¯¹æ¯ä¸ªè£…è½½çš„ç±»å‹ï¼Œè™šæ‹Ÿæœºéƒ½ä¼šåœ¨æ–¹æ³•åŒºä¸­å­˜å‚¨ä¸€ä¸‹ç±»å‹ä¿¡æ¯ï¼š</p>
<ul>
<li>è¯¥ç±»å‹å…¨é™å®šå</li>
<li>è¯¥ç±»å‹çš„ç›´æ¥è¶…ç±»çš„å…¨é™å®šåï¼ˆé™¤éæ˜¯Objectç±»ï¼Œæ²¡æœ‰è¶…ç±»ï¼‰</li>
<li>è¯¥ç±»å‹æ˜¯ç±»ç±»å‹è¿˜æ˜¯æ¥å£ç±»å‹</li>
<li>è¯¥ç±»å‹çš„è®¿é—®ä¿®é¥°ç¬¦ï¼ˆpublicã€abstractã€finalçš„æŸä¸ªå­é›†ï¼‰</li>
<li><p>ä»»ä½•å‹ç›´æ¥è¶…æ¥å£çš„å…¨é™å®šåçš„æœ‰åºåˆ—è¡¨</p>
</li>
<li><p>è¯¥ç±»å‹çš„å¸¸é‡æ± ã€æ ¸å¿ƒã€‘ï¼šæ‰€æœ‰å¸¸é‡çš„ç±»å‹å­—æ®µæ–¹æ³•çš„ç¬¦å·å¼•ç”¨(ç´¢å¼•è®¿é—®)</p>
</li>
<li>å­—æ®µä¿¡æ¯ï¼šå­—æ®µåï¼Œå­—æ®µç±»å‹ï¼Œå­—æ®µä¿®é¥°ç¬¦</li>
<li>æ–¹æ³•ä¿¡æ¯ï¼šæ–¹æ³•åï¼Œè¿”å›ç±»å‹ï¼Œå‚æ•°æ•°é‡å’Œç±»å‹(æŒ‰åº)ï¼Œæ–¹æ³•ä¿®é¥°ç¬¦</li>
<li>é™¤äº†å¸¸é‡ä»¥å¤–çš„é™æ€å˜é‡</li>
<li>ä¸€ä¸ªåˆ°ç±»ClassLoaderçš„å¼•ç”¨ï¼šè·Ÿè¸ªä¿å­˜è¯¥ç±»åŠ è½½æ—¶æ‰€ç”¨çš„åŠ è½½å™¨çš„ç±»åˆ«</li>
<li>ä¸€ä¸ªåˆ°Classç±»çš„å¼•ç”¨ï¼šè™šæ‹Ÿæœºä¼šåˆ›å»ºä¸€ä¸ªç›¸åº”çš„java.lang.Classç±»çš„å®ä¾‹</li>
</ul>
<p>â€”â€”â€”â€”â€”â€”â€”æ–¹æ³•è¡¨ï¼š<br>æ–¹æ³•è¡¨ï¼šç±»å‹æ•°æ®ç»“æ„<br>è™šæ‹Ÿæœºä¸ºæ¯ä¸ªéæŠ½è±¡ç±»éƒ½ç”Ÿæˆä¸€ä¸ªè¡¨ï¼ŒæŠŠå®ƒä½œä¸ºç±»ä¿¡æ¯çš„ä¸€éƒ¨åˆ†ä¿å­˜åœ¨æ–¹æ³•åŒºã€‚<br>æ–¹æ³•è¡¨æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ æ˜¯æ‰€æœ‰å®ƒçš„å®ä¾‹å¯èƒ½è¢«è°ƒç”¨çš„å®ä¾‹æ–¹æ³•çš„ç›´æ¥å¼•ç”¨<br>ï¼ŒåŒ…æ‹¬æ˜¯è¶…ç±»ç›´æ¥ç»§æ‰¿è¿‡æ¥çš„æ–¹æ³•ã€‚è¿è¡Œæ—¶å¯ä»¥é€šè¿‡æ–¹æ³•è¡¨å¿«é€Ÿæœå¯»åœ¨å¯¹è±¡ä¸­è°ƒç”¨çš„å®ä¾‹æ–¹æ³•ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”å †ï¼š<br>javaç¨‹åºåœ¨è¿è¡Œæ—¶åˆ›å»ºçš„æ‰€æœ‰ç±»å®ä¾‹æˆ–æ•°ç»„éƒ½æ”¾åœ¨åŒä¸€ä¸ªå †ä¸­ï¼ˆè¦è€ƒè™‘çº¿ç¨‹åŒæ­¥é—®é¢˜ï¼‰ã€‚<br>å’Œæ–¹æ³•åŒºä¸€æ ·ï¼Œå †ç©ºé—´ä¹Ÿä¸æ˜¯è¿ç»­çš„å†…å­˜åŒºã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”æ•°ç»„ï¼š<br>æ•°ç»„çš„å†…éƒ¨è¡¨ç¤ºï¼š<br>åœ¨javaä¸­ï¼Œæ•°ç»„æ‰æ˜¯çœŸæ­£çš„å¯¹è±¡<br>å’Œå…¶ä»–å¯¹è±¡ä¸€æ ·ï¼Œæ•°ç»„æ€»æ˜¯å­˜å‚¨åœ¨å †ä¸­ã€‚<br>å’Œå…¶ä»–å¯¹è±¡ä¸€æ ·ï¼Œæ•°ç»„ä¹Ÿæœ‰ä¸€ä¸ªä¸ä»–ä»¬çš„ç±»å…³è”çš„Classå®ä¾‹ï¼Œæ‰€æœ‰å…·æœ‰ç›¸åŒç»´åº¦å’Œç±»å‹çš„æ•°ç»„éƒ½æ˜¯åŒä¸€ä¸ªç±»çš„å®ä¾‹ï¼ˆä¸ç®¡æ•°ç»„çš„é•¿åº¦æ˜¯å¤šå°‘ï¼‰ã€‚</p>
<p>æ•°ç»„ç±»çš„åç§°ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œæ¯ä¸€ç»´åº¦ç”¨ä¸€ä¸ªâ€[â€œè¡¨ç¤ºï¼Œç”¨å­—ç¬¦æˆ–å­—ç¬¦ä¸²è¡¨ç¤ºå…ƒç´ ç±»å‹ã€‚å¦‚&ldquo;[[Ljava/lang/Object&rdquo;è¡¨ç¤ºå…ƒç´ ä¸ºObjectçš„äºŒç»´æ•°ç»„ã€‚</p>
<p>åœ¨å †ä¸­ï¼Œæ¯ä¸€ä¸ªæ•°ç»„å¯¹è±¡è¿˜å¿…é¡»è¦ä¿å­˜æ•°ç»„çš„é•¿åº¦ã€æ•°ç»„æ•°æ®ä»¥åŠæŸäº›æŒ‡å‘æ•°ç»„çš„ç±»æ•°æ®çš„å¼•ç”¨ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”ç¨‹åºè®¡æ•°å™¨ï¼ˆPCå¯„å­˜å™¨ï¼‰ï¼š<br>æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„PCå¯„å­˜å™¨ï¼Œå®ƒæ˜¯åœ¨è¯¥çº¿ç¨‹å¯åŠ¨çš„æ—¶å€™åˆ›å»ºçš„ã€‚<br>PCå¯„å­˜å™¨çš„å¤§å°æ˜¯å­—é•¿ï¼Œå› æ­¤èƒ½å¤ŸæŒæœ‰ä¸€ä¸ªæœ¬åœ°æŒ‡é’ˆï¼Œä¹Ÿèƒ½å¤ŸæŒæœ‰ä¸€ä¸ªreturnAddressã€‚å½“çº¿ç¨‹æ‰§è¡ŒæŸä¸ªjavaæ–¹æ³•æ—¶ï¼ŒPCå¯„å­˜å™¨çš„å†…å®¹æ€»æ˜¯å†™ä¸€æ¡å°†è¢«æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€ï¼Œè¿™é‡Œçš„åœ°å€å¯ä»¥æ˜¯ä¸ªæœ¬åœ°æŒ‡é’ˆï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨æ–¹æ³•å­—èŠ‚ç ä¸­ç›¸å¯¹äºè¯¥æ–¹æ³•å…¶å®æŒ‡ä»¤çš„åç§»é‡ã€‚å¦‚æœè¯¥çº¿ç¨‹æ­£åœ¨æ‰§è¡Œä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œæ­¤æ—¶PCå¯„å­˜å™¨çš„å€¼æ˜¯&ldquo;undefined&rdquo;ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”Javaæ ˆï¼š<br>æ¯å½“å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹æ—¶ï¼Œjavaè™šæ‹Ÿæœºéƒ½ä¼šä¸ºå®ƒåˆ†é…ä¸€ä¸ªjavaæ ˆã€‚<br>è™šæ‹Ÿæœºæ™ºæ…§ç›´æ¥å¯¹javaæ ˆæ‰§è¡Œä¸¤ç§æ“ä½œï¼šä»¥å¸§ä¸ºå•ä½çš„å‹æ ˆæˆ–å‡ºæ ˆã€‚<br>æ¯å½“çº¿ç¨‹è°ƒç”¨ä¸€ä¸ªjavaæ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºéƒ½ä¼šåœ¨è¯¥javaæ ˆä¸­å‹å…¥ä¸€ä¸ªæ–°å¸§ã€‚<br>javaæ–¹æ³•ä¸ç®¡æ˜¯æ­£å¸¸è¿”å›è¿˜æ˜¯æŠ›å¼‚å¸¸ä¸­æ­¢ï¼Œè™šæ‹Ÿæœºéƒ½ä¼šå°†å½“å‰æ ˆå¼¹å‡ºjavaæ ˆï¼Œç„¶åé‡Šæ”¾å†…å­˜ã€‚</p>
<p>javaæ ˆå’Œæ ˆå¸§åœ¨å†…å­˜ä¸­ä¹Ÿä¸å¿…è¯´è¿ç»­çš„ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”æ ˆå¸§ï¼ˆ2ï¼‰ï¼š<br>æ ˆå¸§çš„æ„æˆï¼š</p>
<ul>
<li><p>å±€éƒ¨å˜é‡åŒºï¼š</p>
<pre><code>æ˜¯ä¸€ä¸ªä»¥å­—é•¿ä¸ºå•ä½ï¼Œä»0å¼€å§‹è®¡æ•°çš„æ•°ç»„ã€‚å­—èŠ‚ç æŒ‡ä»¤é€šè¿‡ä»0å¼€å§‹çš„ç´¢å¼•æ¥ä½¿ç”¨å…¶ä¸­çš„æ•°æ®ã€‚
 intã€floatã€referenceå’ŒreturnAddressçš„å€¼åœ¨æ•°ç»„ä¸­åªå ä¸€é¡¹ï¼›
 byteã€shortã€charçš„å€¼åœ¨å­˜å…¥æ•°ç»„å‰éƒ½è¢«è½¬æ¢æˆintï¼Œæ‰€ä»¥ä¹Ÿåªå ä¸€é¡¹ï¼›
 booleanè™šæ‹Ÿæœºä¸æ”¯æŒï¼Œç”¨intæ¥è¡¨ç¤ºï¼Œæ‰€ä»¥ä¹Ÿåªå ä¸€é¡¹ï¼›
 longã€doubleçš„å€¼åœ¨æ•°ç»„ä¸­å ä¸¤é¡¹ï¼ˆä½¿ç”¨åªè¦æŒ‡å‡ºç¬¬ä¸€é¡¹ç´¢å¼•å€¼ï¼‰ã€‚
 å±€éƒ¨å˜é‡åŒºåŒ…å«å¯¹åº”çš„æ–¹æ³•å‚æ•°å’Œå±€éƒ¨å˜é‡ã€‚
 æŒ‰å‚æ•°çš„é¡ºåºæ¥å­˜å…¥å±€éƒ¨å˜é‡æ•°ç»„ä¸­ã€‚çœŸæ­£çš„å±€éƒ¨å˜é‡é¡ºåºä»»æ„ã€‚
</code></pre></li>
<li><p>æ“ä½œæ•°æ ˆï¼š</p>
<pre><code>æ˜¯ä¸€ä¸ªä»¥å­—èŠ‚ä¸ºå•ä½çš„æ•°ç»„ï¼ˆä¸æ˜¯é€šè¿‡ç´¢å¼•æ¥è®¿é—®ï¼‰ï¼Œæ˜¯é€šè¿‡æ ‡å‡†çš„æ ˆæ“ä½œï¼ˆå‹æ ˆå’Œå‡ºæ ˆï¼‰æ¥è®¿é—®ã€‚
å­˜å‚¨çš„æ•°æ®ç±»å‹å’Œå±€éƒ¨å˜é‡åŒºçš„ä¸€æ ·ã€‚
è™šæ‹ŸæœºæŠŠæ“ä½œæ•°æ ˆä½œä¸ºä»–çš„å·¥ä½œåŒºï¼Œå¤§å¤šæ•°æŒ‡ä»¤éƒ½è¦ä»è¿™é‡Œå¼¹å‡ºæ•°æ®ï¼Œæ‰§è¡Œè®¡ç®—ï¼Œç„¶åæŠŠç»“æœå‹å›åˆ°æ“ä½œæ•°æ ˆä¸­ã€‚
</code></pre></li>
<li><p>å¸§æ•°æ®åŒºï¼š</p>
<pre><code>å¸¸é‡æ± è§£æã€æ­£å¸¸æ–¹æ³•è¿”å›ã€å¼‚å¸¸æ´¾å‘æœºåˆ¶ã€‚
æ¯å½“è™šæ‹Ÿæœºè¦æ‰§è¡ŒæŸä¸ªéœ€è¦ç”¨åˆ°å¸¸é‡æ± æ•°æ®çš„æŒ‡ä»¤æ—¶ï¼Œå®ƒéƒ½ä¼šé€šè¿‡å¸§æ•°æ®åŒºä¸­æŒ‡å‘å¸¸é‡æ± çš„æŒ‡é’ˆæ¥è®¿é—®å®ƒã€‚
å¸§æ•°æ®åŒºè¿˜è¦å¸®åŠ©è™šæ‹Ÿæœºå¤„ç†javaæ–¹æ³•çš„æ­£å¸¸ç»“æŸæˆ–å¼‚å¸¸ä¸­æ­¢ï¼š
å¦‚æœæ­£å¸¸ç»“æŸï¼šè™šæ‹Ÿæœºå¿…é¡»æ¢å¤å‘èµ·è°ƒç”¨çš„æ–¹æ³•çš„ï¼ˆä¸Šä¸€ä¸ªï¼‰æ ˆå¸§ï¼Œè°ƒç”¨å®Œæˆæ–¹æ³•çš„æŒ‡ä»¤çš„ä¸‹ä¸€ä¸ªæŒ‡ä»¤ã€‚å¦‚æœæœ‰è¿”å›å€¼ï¼Œè™šæ‹Ÿæœºå°†æŠŠè¿”å›å€¼å‹å€’å‘
</code></pre></li>
</ul>
<p>èµ·è°ƒç”¨çš„æ–¹æ³•çš„æ“ä½œæ•°æ ˆã€‚<br>         å¦‚æœæŠ›å‡ºå¼‚å¸¸ï¼Œæ ¹æ®å¸§æ•°æ®åŒºçš„å¼‚å¸¸è¡¨æ¥å¤„ç†ã€‚å¦‚æœæœ‰catchè¯­å¥ï¼Œå°±ä¼šäº¤ç»™catchä¸­çš„ä»£ç ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ç«‹å³å¼‚å¸¸ä¸­æ­¢ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”æœ¬åœ°æ–¹æ³•æ ˆï¼š<br>å½“çº¿ç¨‹è°ƒç”¨æœ¬åœ°æ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºä¼šä¿æŒjavaæ ˆä¸å˜ï¼Œä¸å†åœ¨çº¿ç¨‹çš„javaæ ˆä¸­å‹å…¥æ–°çš„å¸§ï¼Œè™šæ‹Ÿæœºåªæ˜¯ç®€å•åœ°åŠ¨æ€è¿æ¥å¹¶ç›´æ¥è°ƒç”¨æŒ‡å®šçš„æœ¬åœ°æ–¹æ³•ã€‚</p>
<p>å°±åƒå…¶ä»–è¿è¡Œæ—¶å†…å­˜åŒºä¸€æ ·ï¼Œæœ¬åœ°æ–¹æ³•æ ˆå ç”¨çš„å†…å­˜åŒºä¹Ÿä¸å¿…è¯´å›ºå®šå¤§å°çš„ï¼Œå®ƒå¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€æ‰©å±•æˆ–è€…æ”¶ç¼©ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”æ‰§è¡Œå¼•æ“ï¼š<br>ä»»ä½•javaè™šæ‹Ÿæœºå®ç°çš„æ ¸å¿ƒéƒ½æ˜¯å®ƒçš„æ‰§è¡Œå¼•æ“ã€‚<br>åœ¨javaè™šæ‹Ÿæœºè§„èŒƒä¸­ï¼Œæ‰§è¡Œå¼•æ“çš„è¡Œä¸ºä½¿ç”¨æŒ‡ä»¤é›†æ¥å®šä¹‰ã€‚<br>ä½œä¸ºè¿è¡Œæ—¶å®ä¾‹çš„æ‰§è¡Œå¼•æ“å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ã€‚<br>è¿è¡Œä¸­javaç¨‹åºçš„æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è™šæ‹Ÿæœºæ‰§è¡Œå¼•æ“çš„å®ä¾‹ã€‚ä»ç”Ÿå‘½å‘¨æœŸçš„å¼€å§‹åˆ°ç»“æŸï¼Œå®ƒè¦ä¹ˆåœ¨æ‰§è¡Œå­—èŠ‚ç ï¼Œè¦ä¹ˆåœ¨æ‰§è¡Œæœ¬åœ°æ–¹æ³•ã€‚</p>
<p><img src="http://images.cnitblog.com/blog/378300/201302/24100155-fc24aa95237c49d8b70f462592324040.jpg" alt=""></p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> JVM </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[lucene ä½¿ç”¨æ•™ç¨‹]]></title>
      <url>/2013/02/24/lucene-%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p><span>1 luceneç®€ä»‹&nbsp;</span><br><span>1.1 ä»€ä¹ˆæ˜¯lucene&nbsp;</span><br><span>Luceneæ˜¯ä¸€ä¸ªå…¨æ–‡æœç´¢æ¡†æ¶ï¼Œè€Œä¸æ˜¯åº”ç”¨äº§å“ã€‚å› æ­¤å®ƒå¹¶ä¸åƒ</span><a href="http://www.baidu.com/" target="_blank" rel="noopener"><span>http://www.baidu.com/</span></a><span>&nbsp;æˆ–è€…google Desktopé‚£ä¹ˆæ‹¿æ¥å°±èƒ½ç”¨ï¼Œå®ƒåªæ˜¯æä¾›äº†ä¸€ç§å·¥å…·è®©ä½ èƒ½å®ç°è¿™äº›äº§å“ã€‚</span></p>
<p><span>1.2 luceneèƒ½åšä»€ä¹ˆ&nbsp;</span><br><span>è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œå…ˆè¦äº†è§£luceneçš„æœ¬è´¨ã€‚å®é™…ä¸Šluceneçš„åŠŸèƒ½å¾ˆå•ä¸€ï¼Œè¯´åˆ°åº•ï¼Œå°±æ˜¯ä½ ç»™å®ƒè‹¥å¹²ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åå®ƒä¸ºä½ æä¾›ä¸€ä¸ªå…¨æ–‡æœç´¢æœåŠ¡ï¼Œå‘Šè¯‰ä½ ä½ è¦æœç´¢çš„å…³é”®è¯å‡ºç°åœ¨å“ªé‡Œã€‚çŸ¥é“äº†è¿™ä¸ªæœ¬è´¨ï¼Œä½ å°±å¯ä»¥å‘æŒ¥æƒ³è±¡åšä»»ä½•ç¬¦åˆè¿™ä¸ªæ¡ä»¶çš„äº‹æƒ…äº†ã€‚ä½ å¯ä»¥æŠŠç«™å†…æ–°é—»éƒ½ç´¢å¼•äº†ï¼Œåšä¸ªèµ„æ–™åº“ï¼›ä½ å¯ä»¥æŠŠä¸€ä¸ªæ•°æ®åº“è¡¨çš„è‹¥å¹²ä¸ªå­—æ®µç´¢å¼•èµ·æ¥ï¼Œé‚£å°±ä¸ç”¨å†æ‹…å¿ƒå› ä¸º&ldquo;%like%&rdquo;è€Œé”è¡¨äº†ï¼›ä½ ä¹Ÿå¯ä»¥å†™ä¸ªè‡ªå·±çš„æœç´¢å¼•æ“&hellip;&hellip;</span></p>
<p><span>1.3 ä½ è¯¥ä¸è¯¥é€‰æ‹©lucene&nbsp;</span><br><span>ä¸‹é¢ç»™å‡ºä¸€äº›æµ‹è¯•æ•°æ®ï¼Œå¦‚æœä½ è§‰å¾—å¯ä»¥æ¥å—ï¼Œé‚£ä¹ˆå¯ä»¥é€‰æ‹©ã€‚&nbsp;</span><br><span>æµ‹è¯•ä¸€ï¼š250ä¸‡è®°å½•ï¼Œ300Må·¦å³æ–‡æœ¬ï¼Œç”Ÿæˆç´¢å¼•380Må·¦å³ï¼Œ800çº¿ç¨‹ä¸‹å¹³å‡å¤„ç†æ—¶é—´300msã€‚&nbsp;</span><br><span>æµ‹è¯•äºŒï¼š37000è®°å½•ï¼Œç´¢å¼•æ•°æ®åº“ä¸­çš„ä¸¤ä¸ªvarcharå­—æ®µï¼Œç´¢å¼•æ–‡ä»¶2.6Mï¼Œ800çº¿ç¨‹ä¸‹å¹³å‡å¤„ç†æ—¶é—´1.5msã€‚</span></p>
<p><span>2 luceneçš„å·¥ä½œæ–¹å¼&nbsp;</span><br><span>luceneæä¾›çš„æœåŠ¡å®é™…åŒ…å«ä¸¤éƒ¨åˆ†ï¼šä¸€å…¥ä¸€å‡ºã€‚æ‰€è°“å…¥æ˜¯å†™å…¥ï¼Œå³å°†ä½ æä¾›çš„æºï¼ˆæœ¬è´¨æ˜¯å­—ç¬¦ä¸²ï¼‰å†™å…¥ç´¢å¼•æˆ–è€…å°†å…¶ä»ç´¢å¼•ä¸­åˆ é™¤ï¼›æ‰€è°“å‡ºæ˜¯è¯»å‡ºï¼Œå³å‘ç”¨æˆ·æä¾›å…¨æ–‡æœç´¢æœåŠ¡ï¼Œè®©ç”¨æˆ·å¯ä»¥é€šè¿‡å…³é”®è¯å®šä½æºã€‚</span></p>
<p><span>2.1å†™å…¥æµç¨‹&nbsp;</span><br><span>æºå­—ç¬¦ä¸²é¦–å…ˆç»è¿‡analyzerå¤„ç†ï¼ŒåŒ…æ‹¬ï¼šåˆ†è¯ï¼Œåˆ†æˆä¸€ä¸ªä¸ªå•è¯ï¼›å»é™¤stopwordï¼ˆå¯é€‰ï¼‰ã€‚&nbsp;</span><br><span>å°†æºä¸­éœ€è¦çš„ä¿¡æ¯åŠ å…¥Documentçš„å„ä¸ªFieldä¸­ï¼Œå¹¶æŠŠéœ€è¦ç´¢å¼•çš„Fieldç´¢å¼•èµ·æ¥ï¼ŒæŠŠéœ€è¦å­˜å‚¨çš„Fieldå­˜å‚¨èµ·æ¥ã€‚&nbsp;</span><br><span>å°†ç´¢å¼•å†™å…¥å­˜å‚¨å™¨ï¼Œå­˜å‚¨å™¨å¯ä»¥æ˜¯å†…å­˜æˆ–ç£ç›˜ã€‚</span></p>
<p><span>2.2è¯»å‡ºæµç¨‹&nbsp;</span><br><span>ç”¨æˆ·æä¾›æœç´¢å…³é”®è¯ï¼Œç»è¿‡analyzerå¤„ç†ã€‚&nbsp;</span><br><span>å¯¹å¤„ç†åçš„å…³é”®è¯æœç´¢ç´¢å¼•æ‰¾å‡ºå¯¹åº”çš„Documentã€‚&nbsp;</span><br><span>ç”¨æˆ·æ ¹æ®éœ€è¦ä»æ‰¾åˆ°çš„Documentä¸­æå–éœ€è¦çš„Fieldã€‚</span></p>
<p><span>3 ä¸€äº›éœ€è¦çŸ¥é“çš„æ¦‚å¿µ&nbsp;</span><br><span>luceneç”¨åˆ°ä¸€äº›æ¦‚å¿µï¼Œäº†è§£å®ƒä»¬çš„å«ä¹‰ï¼Œæœ‰åˆ©äºä¸‹é¢çš„è®²è§£ã€‚</span></p>
<p><span>3.1 analyzer&nbsp;</span><br><span>Analyzer æ˜¯åˆ†æå™¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠä¸€ä¸ªå­—ç¬¦ä¸²æŒ‰æŸç§è§„åˆ™åˆ’åˆ†æˆä¸€ä¸ªä¸ªè¯è¯­ï¼Œå¹¶å»é™¤å…¶ä¸­çš„æ— æ•ˆè¯è¯­ï¼Œè¿™é‡Œè¯´çš„æ— æ•ˆè¯è¯­æ˜¯æŒ‡è‹±æ–‡ä¸­çš„&ldquo;of&rdquo;ã€ &ldquo;the&rdquo;ï¼Œä¸­æ–‡ä¸­çš„ &ldquo;çš„&rdquo;ã€&ldquo;åœ°&rdquo;ç­‰è¯è¯­ï¼Œè¿™äº›è¯è¯­åœ¨æ–‡ç« ä¸­å¤§é‡å‡ºç°ï¼Œä½†æ˜¯æœ¬èº«ä¸åŒ…å«ä»€ä¹ˆå…³é”®ä¿¡æ¯ï¼Œå»æ‰æœ‰åˆ©äºç¼©å°ç´¢å¼•æ–‡ä»¶ã€æé«˜æ•ˆç‡ã€æé«˜å‘½ä¸­ç‡ã€‚&nbsp;</span><br><span>åˆ†è¯çš„è§„åˆ™åƒå˜ä¸‡åŒ–ï¼Œä½†ç›®çš„åªæœ‰ä¸€ä¸ªï¼šæŒ‰è¯­ä¹‰åˆ’åˆ†ã€‚è¿™ç‚¹åœ¨è‹±æ–‡ä¸­æ¯”è¾ƒå®¹æ˜“å®ç°ï¼Œå› ä¸ºè‹±æ–‡æœ¬èº«å°±æ˜¯ä»¥å•è¯ä¸ºå•ä½çš„ï¼Œå·²ç»ç”¨ç©ºæ ¼åˆ†å¼€ï¼›è€Œä¸­æ–‡åˆ™å¿…é¡»ä»¥æŸç§æ–¹æ³•å°†è¿æˆä¸€ç‰‡çš„å¥å­åˆ’åˆ†æˆä¸€ä¸ªä¸ªè¯è¯­ã€‚å…·ä½“åˆ’åˆ†æ–¹æ³•ä¸‹é¢å†è¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œåªéœ€äº†è§£åˆ†æå™¨çš„æ¦‚å¿µå³å¯ã€‚</span></p>
<p><span>3.2 document&nbsp;</span><br><span>ç”¨æˆ·æä¾›çš„æºæ˜¯ä¸€æ¡æ¡è®°å½•ï¼Œå®ƒä»¬å¯ä»¥æ˜¯æ–‡æœ¬æ–‡ä»¶ã€å­—ç¬¦ä¸²æˆ–è€…æ•°æ®åº“è¡¨çš„ä¸€æ¡è®°å½•ç­‰ç­‰ã€‚ä¸€æ¡è®°å½•ç»è¿‡ç´¢å¼•ä¹‹åï¼Œå°±æ˜¯ä»¥ä¸€ä¸ªDocumentçš„å½¢å¼å­˜å‚¨åœ¨ç´¢å¼•æ–‡ä»¶ä¸­çš„ã€‚ç”¨æˆ·è¿›è¡Œæœç´¢ï¼Œä¹Ÿæ˜¯ä»¥Documentåˆ—è¡¨çš„å½¢å¼è¿”å›ã€‚</span></p>
<p><span>3.3 field&nbsp;</span><br><span>ä¸€ä¸ªDocumentå¯ä»¥åŒ…å«å¤šä¸ªä¿¡æ¯åŸŸï¼Œä¾‹å¦‚ä¸€ç¯‡æ–‡ç« å¯ä»¥åŒ…å«&ldquo;æ ‡é¢˜&rdquo;ã€&ldquo;æ­£æ–‡&rdquo;ã€&ldquo;æœ€åä¿®æ”¹æ—¶é—´&rdquo;ç­‰ä¿¡æ¯åŸŸï¼Œè¿™äº›ä¿¡æ¯åŸŸå°±æ˜¯é€šè¿‡Fieldåœ¨Documentä¸­å­˜å‚¨çš„ã€‚&nbsp;</span><br><span>Fieldæœ‰ä¸¤ä¸ªå±æ€§å¯é€‰ï¼šå­˜å‚¨å’Œç´¢å¼•ã€‚é€šè¿‡å­˜å‚¨å±æ€§ä½ å¯ä»¥æ§åˆ¶æ˜¯å¦å¯¹è¿™ä¸ªFieldè¿›è¡Œå­˜å‚¨ï¼›é€šè¿‡ç´¢å¼•å±æ€§ä½ å¯ä»¥æ§åˆ¶æ˜¯å¦å¯¹è¯¥Fieldè¿›è¡Œç´¢å¼•ã€‚è¿™çœ‹èµ·æ¥ä¼¼ä¹æœ‰äº›åºŸè¯ï¼Œäº‹å®ä¸Šå¯¹è¿™ä¸¤ä¸ªå±æ€§çš„æ­£ç¡®ç»„åˆå¾ˆé‡è¦ï¼Œä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼š&nbsp;</span><br><span>è¿˜æ˜¯ä»¥åˆšæ‰çš„æ–‡ç« ä¸ºä¾‹å­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ ‡é¢˜å’Œæ­£æ–‡è¿›è¡Œå…¨æ–‡æœç´¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠç´¢å¼•å±æ€§è®¾ç½®ä¸ºçœŸï¼ŒåŒæ—¶æˆ‘ä»¬å¸Œæœ›èƒ½ç›´æ¥ä»æœç´¢ç»“æœä¸­æå–æ–‡ç« æ ‡é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæ ‡é¢˜åŸŸçš„å­˜å‚¨å±æ€§è®¾ç½®ä¸ºçœŸï¼Œä½†æ˜¯ç”±äºæ­£æ–‡åŸŸå¤ªå¤§äº†ï¼Œæˆ‘ä»¬ä¸ºäº†ç¼©å°ç´¢å¼•æ–‡ä»¶å¤§å°ï¼Œå°†æ­£æ–‡åŸŸçš„å­˜å‚¨å±æ€§è®¾ç½®ä¸ºå‡ï¼Œå½“éœ€è¦æ—¶å†ç›´æ¥è¯»å–æ–‡ä»¶ï¼›æˆ‘ä»¬åªæ˜¯å¸Œæœ›èƒ½ä»æœç´¢è§£æœä¸­æå–æœ€åä¿®æ”¹æ—¶é—´ï¼Œä¸éœ€è¦å¯¹å®ƒè¿›è¡Œæœç´¢ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæœ€åä¿®æ”¹æ—¶é—´åŸŸçš„å­˜å‚¨å±æ€§è®¾ç½®ä¸ºçœŸï¼Œç´¢å¼•å±æ€§è®¾ç½®ä¸ºå‡ã€‚ä¸Šé¢çš„ä¸‰ä¸ªåŸŸæ¶µç›–äº†ä¸¤ä¸ªå±æ€§çš„ä¸‰ç§ç»„åˆï¼Œè¿˜æœ‰ä¸€ç§å…¨ä¸ºå‡çš„æ²¡æœ‰ç”¨åˆ°ï¼Œäº‹å®ä¸ŠFieldä¸å…è®¸ä½ é‚£ä¹ˆè®¾ç½®ï¼Œå› ä¸ºæ—¢ä¸å­˜å‚¨åˆä¸ç´¢å¼•çš„åŸŸæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚</span></p>
<p><span>3.4 term&nbsp;</span><br><span>termæ˜¯æœç´¢çš„æœ€å°å•ä½ï¼Œå®ƒè¡¨ç¤ºæ–‡æ¡£çš„ä¸€ä¸ªè¯è¯­ï¼Œtermç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šå®ƒè¡¨ç¤ºçš„è¯è¯­å’Œè¿™ä¸ªè¯è¯­æ‰€å‡ºç°çš„fieldã€‚</span></p>
<p><span>3.5 tocken&nbsp;</span><br><span>tockenæ˜¯termçš„ä¸€æ¬¡å‡ºç°ï¼Œå®ƒåŒ…å«tremæ–‡æœ¬å’Œç›¸åº”çš„èµ·æ­¢åç§»ï¼Œä»¥åŠä¸€ä¸ªç±»å‹å­—ç¬¦ä¸²ã€‚ä¸€å¥è¯ä¸­å¯ä»¥å‡ºç°å¤šæ¬¡ç›¸åŒçš„è¯è¯­ï¼Œå®ƒä»¬éƒ½ç”¨åŒä¸€ä¸ªtermè¡¨ç¤ºï¼Œä½†æ˜¯ç”¨ä¸åŒçš„tockenï¼Œæ¯ä¸ªtockenæ ‡è®°è¯¥è¯è¯­å‡ºç°çš„åœ°æ–¹ã€‚</span></p>
<p><span>3.6 segment&nbsp;</span><br><span>æ·»åŠ ç´¢å¼•æ—¶å¹¶ä¸æ˜¯æ¯ä¸ªdocumentéƒ½é©¬ä¸Šæ·»åŠ åˆ°åŒä¸€ä¸ªç´¢å¼•æ–‡ä»¶ï¼Œå®ƒä»¬é¦–å…ˆè¢«å†™å…¥åˆ°ä¸åŒçš„å°æ–‡ä»¶ï¼Œç„¶åå†åˆå¹¶æˆä¸€ä¸ªå¤§ç´¢å¼•æ–‡ä»¶ï¼Œè¿™é‡Œæ¯ä¸ªå°æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªsegmentã€‚</span></p>
<p><span>4 luceneçš„ç»“æ„&nbsp;</span><br><span>luceneåŒ…æ‹¬coreå’Œsandboxä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­coreæ˜¯luceneç¨³å®šçš„æ ¸å¿ƒéƒ¨åˆ†ï¼ŒsandboxåŒ…å«äº†ä¸€äº›é™„åŠ åŠŸèƒ½ï¼Œä¾‹å¦‚highlighterã€å„ç§åˆ†æå™¨ã€‚&nbsp;</span><br><span>Lucene coreæœ‰ä¸ƒä¸ªåŒ…ï¼šanalysisï¼Œdocumentï¼Œindexï¼ŒqueryParserï¼Œsearchï¼Œstoreï¼Œutilã€‚&nbsp;</span><br><span>4.1 analysis&nbsp;</span><br><span>AnalysisåŒ…å«ä¸€äº›å†…å»ºçš„åˆ†æå™¨ï¼Œä¾‹å¦‚æŒ‰ç©ºç™½å­—ç¬¦åˆ†è¯çš„WhitespaceAnalyzerï¼Œæ·»åŠ äº†stopwrodè¿‡æ»¤çš„StopAnalyzerï¼Œæœ€å¸¸ç”¨çš„StandardAnalyzerã€‚&nbsp;</span><br><span>4.2 document&nbsp;</span><br><span>DocumentåŒ…å«æ–‡æ¡£çš„æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚Documentç±»å®šä¹‰äº†å­˜å‚¨æ–‡æ¡£çš„æ•°æ®ç»“æ„ï¼ŒFieldç±»å®šä¹‰äº†Documentçš„ä¸€ä¸ªåŸŸã€‚&nbsp;</span><br><span>4.3 index&nbsp;</span><br><span>Index åŒ…å«äº†ç´¢å¼•çš„è¯»å†™ç±»ï¼Œä¾‹å¦‚å¯¹ç´¢å¼•æ–‡ä»¶çš„segmentè¿›è¡Œå†™ã€åˆå¹¶ã€ä¼˜åŒ–çš„IndexWriterç±»å’Œå¯¹ç´¢å¼•è¿›è¡Œè¯»å–å’Œåˆ é™¤æ“ä½œçš„ IndexReaderç±»ï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ä¸è¦è¢«IndexReaderè¿™ä¸ªåå­—è¯¯å¯¼ï¼Œä»¥ä¸ºå®ƒæ˜¯ç´¢å¼•æ–‡ä»¶çš„è¯»å–ç±»ï¼Œå®é™…ä¸Šåˆ é™¤ç´¢å¼•ä¹Ÿæ˜¯ç”±å®ƒå®Œæˆï¼Œ IndexWriteråªå…³å¿ƒå¦‚ä½•å°†ç´¢å¼•å†™å…¥ä¸€ä¸ªä¸ªsegmentï¼Œå¹¶å°†å®ƒä»¬åˆå¹¶ä¼˜åŒ–ï¼›IndexReaderåˆ™å…³æ³¨ç´¢å¼•æ–‡ä»¶ä¸­å„ä¸ªæ–‡æ¡£çš„ç»„ç»‡å½¢å¼ã€‚&nbsp;</span><br><span>4.4 queryParser&nbsp;</span><br><span>QueryParser åŒ…å«äº†è§£ææŸ¥è¯¢è¯­å¥çš„ç±»ï¼Œluceneçš„æŸ¥è¯¢è¯­å¥å’Œsqlè¯­å¥æœ‰ç‚¹ç±»ä¼¼ï¼Œæœ‰å„ç§ä¿ç•™å­—ï¼ŒæŒ‰ç…§ä¸€å®šçš„è¯­æ³•å¯ä»¥ç»„æˆå„ç§æŸ¥è¯¢ã€‚ Luceneæœ‰å¾ˆå¤šç§ Queryç±»ï¼Œå®ƒä»¬éƒ½ç»§æ‰¿è‡ªQueryï¼Œæ‰§è¡Œå„ç§ç‰¹æ®Šçš„æŸ¥è¯¢ï¼ŒQueryParserçš„ä½œç”¨å°±æ˜¯è§£ææŸ¥è¯¢è¯­å¥ï¼ŒæŒ‰é¡ºåºè°ƒç”¨å„ç§ Queryç±»æŸ¥æ‰¾å‡ºç»“æœã€‚&nbsp;</span><br><span>4.5 search&nbsp;</span><br><span>SearchåŒ…å«äº†ä»ç´¢å¼•ä¸­æœç´¢ç»“æœçš„å„ç§ç±»ï¼Œä¾‹å¦‚åˆšæ‰è¯´çš„å„ç§Queryç±»ï¼ŒåŒ…æ‹¬TermQueryã€BooleanQueryç­‰å°±åœ¨è¿™ä¸ªåŒ…é‡Œã€‚&nbsp;</span><br><span>4.6 store&nbsp;</span><br><span>StoreåŒ…å«äº†ç´¢å¼•çš„å­˜å‚¨ç±»ï¼Œä¾‹å¦‚Directoryå®šä¹‰äº†ç´¢å¼•æ–‡ä»¶çš„å­˜å‚¨ç»“æ„ï¼ŒFSDirectoryä¸ºå­˜å‚¨åœ¨æ–‡ä»¶ä¸­çš„ç´¢å¼•ï¼ŒRAMDirectoryä¸ºå­˜å‚¨åœ¨å†…å­˜ä¸­çš„ç´¢å¼•ï¼ŒMmapDirectoryä¸ºä½¿ç”¨å†…å­˜æ˜ å°„çš„ç´¢å¼•ã€‚&nbsp;</span><br><span>4.7 util&nbsp;</span><br><span>UtilåŒ…å«ä¸€äº›å…¬å…±å·¥å…·ç±»ï¼Œä¾‹å¦‚æ—¶é—´å’Œå­—ç¬¦ä¸²ä¹‹é—´çš„è½¬æ¢å·¥å…·ã€‚</span></p>
<p><span>5 å¦‚ä½•å»ºç´¢å¼•&nbsp;</span><br><span>5.1 æœ€ç®€å•çš„èƒ½å®Œæˆç´¢å¼•çš„ä»£ç ç‰‡æ–­</span></p>
<p><span>IndexWriter writer = new IndexWriter(&ldquo;/data/index/&rdquo;, new StandardAnalyzer(), true);&nbsp;</span><br><span>Document doc = new Document();&nbsp;</span><br><span>doc.add(new Field(â€œtitleâ€, â€œlucene introductionâ€, Field.Store.YES, Field.Index.TOKENIZED));&nbsp;</span><br><span>doc.add(new Field(â€œcontentâ€, â€œlucene works wellâ€, Field.Store.YES, Field.Index.TOKENIZED));&nbsp;</span><br><span>writer.addDocument(doc);&nbsp;</span><br><span>writer.optimize();&nbsp;</span><br><span>writer.close();</span></p>
<p><span>ä¸‹é¢æˆ‘ä»¬åˆ†æä¸€ä¸‹è¿™æ®µä»£ç ã€‚&nbsp;</span><br><span>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªwriterï¼Œå¹¶æŒ‡å®šå­˜æ”¾ç´¢å¼•çš„ç›®å½•ä¸º&ldquo;/data/index&rdquo;ï¼Œä½¿ç”¨çš„åˆ†æå™¨ä¸ºStandardAnalyzerï¼Œç¬¬ä¸‰ä¸ªå‚æ•°è¯´æ˜å¦‚æœå·²ç»æœ‰ç´¢å¼•æ–‡ä»¶åœ¨ç´¢å¼•ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬å°†è¦†ç›–å®ƒä»¬ã€‚&nbsp;</span><br><span>ç„¶åæˆ‘ä»¬æ–°å»ºä¸€ä¸ªdocumentã€‚&nbsp;</span><br><span>æˆ‘ä»¬å‘documentæ·»åŠ ä¸€ä¸ªfieldï¼Œåå­—æ˜¯&ldquo;title&rdquo;ï¼Œå†…å®¹æ˜¯&ldquo;lucene introduction&rdquo;ï¼Œå¯¹å®ƒè¿›è¡Œå­˜å‚¨å¹¶ç´¢å¼•ã€‚&nbsp;</span><br><span>å†æ·»åŠ ä¸€ä¸ªåå­—æ˜¯&ldquo;content&rdquo;çš„fieldï¼Œå†…å®¹æ˜¯&ldquo;lucene works well&rdquo;ï¼Œä¹Ÿæ˜¯å­˜å‚¨å¹¶ç´¢å¼•ã€‚&nbsp;</span><br><span>ç„¶åæˆ‘ä»¬å°†è¿™ä¸ªæ–‡æ¡£æ·»åŠ åˆ°ç´¢å¼•ä¸­ï¼Œå¦‚æœæœ‰å¤šä¸ªæ–‡æ¡£ï¼Œå¯ä»¥é‡å¤ä¸Šé¢çš„æ“ä½œï¼Œåˆ›å»ºdocumentå¹¶æ·»åŠ ã€‚&nbsp;</span><br><span>æ·»åŠ å®Œæ‰€æœ‰documentï¼Œæˆ‘ä»¬å¯¹ç´¢å¼•è¿›è¡Œä¼˜åŒ–ï¼Œä¼˜åŒ–ä¸»è¦æ˜¯å°†å¤šä¸ªsegmentåˆå¹¶åˆ°ä¸€ä¸ªï¼Œæœ‰åˆ©äºæé«˜ç´¢å¼•é€Ÿåº¦ã€‚&nbsp;</span><br><span>éšåå°†writerå…³é—­ï¼Œè¿™ç‚¹å¾ˆé‡è¦ã€‚</span></p>
<p><span>å¯¹ï¼Œåˆ›å»ºç´¢å¼•å°±è¿™ä¹ˆç®€å•ï¼&nbsp;</span><br><span>å½“ç„¶ä½ å¯èƒ½ä¿®æ”¹ä¸Šé¢çš„ä»£ç è·å¾—æ›´å…·ä¸ªæ€§åŒ–çš„æœåŠ¡ã€‚</span></p>
<p><span>5.2 å°†ç´¢å¼•ç›´æ¥å†™åœ¨å†…å­˜&nbsp;</span><br><span>ä½ éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªRAMDirectoryï¼Œå¹¶å°†å…¶ä¼ ç»™writerï¼Œä»£ç å¦‚ä¸‹ï¼š</span></p>
<p><span>Directory dir = new RAMDirectory();&nbsp;</span><br><span>IndexWriter writer = new IndexWriter(dir, new StandardAnalyzer(), true);&nbsp;</span><br><span>Document doc = new Document();&nbsp;</span><br><span>doc.add(new Field(â€œtitleâ€, â€œlucene introductionâ€, Field.Store.YES, Field.Index.TOKENIZED));&nbsp;</span><br><span>doc.add(new Field(â€œcontentâ€, â€œlucene works wellâ€, Field.Store.YES, Field.Index.TOKENIZED));&nbsp;</span><br><span>writer.addDocument(doc);&nbsp;</span><br><span>writer.optimize();&nbsp;</span><br><span>writer.close();</span></p>
<p><span>5.3 ç´¢å¼•æ–‡æœ¬æ–‡ä»¶&nbsp;</span><br><span>å¦‚æœä½ æƒ³æŠŠçº¯æ–‡æœ¬æ–‡ä»¶ç´¢å¼•èµ·æ¥ï¼Œè€Œä¸æƒ³è‡ªå·±å°†å®ƒä»¬è¯»å…¥å­—ç¬¦ä¸²åˆ›å»ºfieldï¼Œä½ å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç åˆ›å»ºfieldï¼š</span></p>
<p><span>Field field = new Field(â€œcontentâ€, new FileReader(file));</span></p>
<p><span>è¿™é‡Œçš„fileå°±æ˜¯è¯¥æ–‡æœ¬æ–‡ä»¶ã€‚è¯¥æ„é€ å‡½æ•°å®é™…ä¸Šæ˜¯è¯»å»æ–‡ä»¶å†…å®¹ï¼Œå¹¶å¯¹å…¶è¿›è¡Œç´¢å¼•ï¼Œä½†ä¸å­˜å‚¨ã€‚</span></p>
<p><span>6 å¦‚ä½•ç»´æŠ¤ç´¢å¼•&nbsp;</span><br><span>ç´¢å¼•çš„ç»´æŠ¤æ“ä½œéƒ½æ˜¯ç”±IndexReaderç±»æä¾›ã€‚</span></p>
<p><span>6.1 å¦‚ä½•åˆ é™¤ç´¢å¼•&nbsp;</span><br><span>luceneæä¾›äº†ä¸¤ç§ä»ç´¢å¼•ä¸­åˆ é™¤documentçš„æ–¹æ³•ï¼Œä¸€ç§æ˜¯</span></p>
<p><span>void deleteDocument(int docNum)</span></p>
<p><span>è¿™ç§æ–¹æ³•æ˜¯æ ¹æ®documentåœ¨ç´¢å¼•ä¸­çš„ç¼–å·æ¥åˆ é™¤ï¼Œæ¯ä¸ªdocumentåŠ è¿›ç´¢å¼•åéƒ½ä¼šæœ‰ä¸ªå”¯ä¸€ç¼–å·ï¼Œæ‰€ä»¥æ ¹æ®ç¼–å·åˆ é™¤æ˜¯ä¸€ç§ç²¾ç¡®åˆ é™¤ï¼Œä½†æ˜¯è¿™ä¸ªç¼–å·æ˜¯ç´¢å¼•çš„å†…éƒ¨ç»“æ„ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¸ä¼šçŸ¥é“æŸä¸ªæ–‡ä»¶çš„ç¼–å·åˆ°åº•æ˜¯å‡ ï¼Œæ‰€ä»¥ç”¨å¤„ä¸å¤§ã€‚å¦ä¸€ç§æ˜¯</span></p>
<p><span>void deleteDocuments(Term term)</span></p>
<p><span>è¿™ç§æ–¹æ³•å®é™…ä¸Šæ˜¯é¦–å…ˆæ ¹æ®å‚æ•°termæ‰§è¡Œä¸€ä¸ªæœç´¢æ“ä½œï¼Œç„¶åæŠŠæœç´¢åˆ°çš„ç»“æœæ‰¹é‡åˆ é™¤äº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æä¾›ä¸€ä¸ªä¸¥æ ¼çš„æŸ¥è¯¢æ¡ä»¶ï¼Œè¾¾åˆ°åˆ é™¤æŒ‡å®šdocumentçš„ç›®çš„ã€‚&nbsp;</span><br><span>ä¸‹é¢ç»™å‡ºä¸€ä¸ªä¾‹å­ï¼š</span></p>
<p><span>Directory dir = FSDirectory.getDirectory(PATH, false);&nbsp;</span><br><span>IndexReader reader = IndexReader.open(dir);&nbsp;</span><br><span>Term term = new Term(field, key);&nbsp;</span><br><span>reader.deleteDocuments(term);&nbsp;</span><br><span>reader.close();</span></p>
<p><span>6.2 å¦‚ä½•æ›´æ–°ç´¢å¼•&nbsp;</span><br><span>luceneå¹¶æ²¡æœ‰æä¾›ä¸“é—¨çš„ç´¢å¼•æ›´æ–°æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†ç›¸åº”çš„documentåˆ é™¤ï¼Œç„¶åå†å°†æ–°çš„documentåŠ å…¥ç´¢å¼•ã€‚ä¾‹å¦‚ï¼š</span></p>
<p><span>Directory dir = FSDirectory.getDirectory(PATH, false);&nbsp;</span><br><span>IndexReader reader = IndexReader.open(dir);&nbsp;</span><br><span>Term term = new Term(&ldquo;title&rdquo;, &ldquo;lucene introduction&rdquo;);&nbsp;</span><br><span>reader.deleteDocuments(term);&nbsp;</span><br><span>reader.close();</span></p>
<p><span>IndexWriter writer = new IndexWriter(dir, new StandardAnalyzer(), true);&nbsp;</span><br><span>Document doc = new Document();&nbsp;</span><br><span>doc.add(new Field(â€œtitleâ€, â€œlucene introductionâ€, Field.Store.YES, Field.Index.TOKENIZED));&nbsp;</span><br><span>doc.add(new Field(â€œcontentâ€, â€œlucene is funnyâ€, Field.Store.YES, Field.Index.TOKENIZED));&nbsp;</span><br><span>writer.addDocument(doc);&nbsp;</span><br><span>writer.optimize();&nbsp;</span><br><span>writer.close();</span></p>
<p><span>7 å¦‚ä½•æœç´¢&nbsp;</span><br><span>lucene çš„æœç´¢ç›¸å½“å¼ºå¤§ï¼Œå®ƒæä¾›äº†å¾ˆå¤šè¾…åŠ©æŸ¥è¯¢ç±»ï¼Œæ¯ä¸ªç±»éƒ½ç»§æ‰¿è‡ªQueryç±»ï¼Œå„è‡ªå®Œæˆä¸€ç§ç‰¹æ®Šçš„æŸ¥è¯¢ï¼Œä½ å¯ä»¥åƒæ­ç§¯æœ¨ä¸€æ ·å°†å®ƒä»¬ä»»æ„ç»„åˆä½¿ç”¨ï¼Œå®Œæˆä¸€äº›å¤æ‚æ“ä½œï¼›å¦å¤–luceneè¿˜æä¾›äº†Sortç±»å¯¹ç»“æœè¿›è¡Œæ’åºï¼Œæä¾›äº†Filterç±»å¯¹æŸ¥è¯¢æ¡ä»¶è¿›è¡Œé™åˆ¶ã€‚ä½ æˆ–è®¸ä¼šä¸è‡ªè§‰åœ°æ‹¿å®ƒè·ŸSQLè¯­å¥è¿›è¡Œæ¯”è¾ƒï¼š &ldquo;luceneèƒ½æ‰§è¡Œandã€orã€order byã€whereã€like &lsquo;%xx%&rsquo;æ“ä½œå—ï¼Ÿ&rdquo;å›ç­”æ˜¯ï¼š&ldquo;å½“ç„¶æ²¡é—®é¢˜ï¼&rdquo;</span></p>
<p><span>7.1 å„ç§å„æ ·çš„Query&nbsp;</span><br><span>ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹luceneåˆ°åº•å…è®¸æˆ‘ä»¬è¿›è¡Œå“ªäº›æŸ¥è¯¢æ“ä½œï¼š</span></p>
<p><span>7.1.1 TermQuery&nbsp;</span><br><span>é¦–å…ˆä»‹ç»æœ€åŸºæœ¬çš„æŸ¥è¯¢ï¼Œå¦‚æœä½ æƒ³æ‰§è¡Œä¸€ä¸ªè¿™æ ·çš„æŸ¥è¯¢ï¼š&ldquo;åœ¨contentåŸŸä¸­åŒ…å«&lsquo;lucene&rsquo;çš„document&rdquo;ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç”¨TermQueryï¼š</span></p>
<p><span>Term t = new Term(â€œcontentâ€, â€œ luceneâ€;&nbsp;</span><br><span>Query query = new TermQuery(t);</span></p>
<p><span>7.1.2 BooleanQuery&nbsp;</span><br><span>å¦‚æœä½ æƒ³è¿™ä¹ˆæŸ¥è¯¢ï¼š&ldquo;åœ¨contentåŸŸä¸­åŒ…å«javaæˆ–perlçš„document&rdquo;ï¼Œé‚£ä¹ˆä½ å¯ä»¥å»ºç«‹ä¸¤ä¸ªTermQueryå¹¶æŠŠå®ƒä»¬ç”¨BooleanQueryè¿æ¥èµ·æ¥ï¼š</span></p>
<p><span>TermQuery termQuery1 = new TermQuery(new Term(â€œcontentâ€, â€œjavaâ€);&nbsp;</span><br><span>TermQuery termQuery 2 = new TermQuery(new Term(â€œcontentâ€, â€œperlâ€);&nbsp;</span><br><span>BooleanQuery booleanQuery = new BooleanQuery();&nbsp;</span><br><span>booleanQuery.add(termQuery 1, BooleanClause.Occur.SHOULD);&nbsp;</span><br><span>booleanQuery.add(termQuery 2, BooleanClause.Occur.SHOULD);</span></p>
<p><span>7.1.3 WildcardQuery&nbsp;</span><br><span>å¦‚æœä½ æƒ³å¯¹æŸå•è¯è¿›è¡Œé€šé…ç¬¦æŸ¥è¯¢ï¼Œä½ å¯ä»¥ç”¨WildcardQueryï¼Œé€šé…ç¬¦åŒ…æ‹¬&rsquo;?&rsquo;åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦å’Œ&rsquo;<em>&rsquo;åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦ï¼Œä¾‹å¦‚ä½ æœç´¢&rsquo;use</em>&rsquo;ï¼Œä½ å¯èƒ½æ‰¾åˆ°&rsquo;useful&rsquo;æˆ–è€…&rsquo;useless&rsquo;ï¼š</span></p>
<p><span>Query query = new WildcardQuery(new Term(â€œcontentâ€, â€œuse*â€);</span></p>
<p><span>7.1.4 PhraseQuery&nbsp;</span><br><span>ä½ å¯èƒ½å¯¹ä¸­æ—¥å…³ç³»æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œæƒ³æŸ¥æ‰¾&lsquo;ä¸­&rsquo;å’Œ&lsquo;æ—¥&rsquo;æŒ¨å¾—æ¯”è¾ƒè¿‘ï¼ˆ5ä¸ªå­—çš„è·ç¦»å†…ï¼‰çš„æ–‡ç« ï¼Œè¶…è¿‡è¿™ä¸ªè·ç¦»çš„ä¸äºˆè€ƒè™‘ï¼Œä½ å¯ä»¥ï¼š</span></p>
<p><span>PhraseQuery query = new PhraseQuery();&nbsp;</span><br><span>query.setSlop(5);&nbsp;</span><br><span>query.add(new Term(â€œcontent â€œ, &ldquo;ä¸­&rdquo;));&nbsp;</span><br><span>query.add(new Term(&ldquo;content&rdquo;, &ldquo;æ—¥&rdquo;));</span></p>
<p><span>é‚£ä¹ˆå®ƒå¯èƒ½æœåˆ°&ldquo;ä¸­æ—¥åˆä½œ&hellip;&hellip;&rdquo;ã€&ldquo;ä¸­æ–¹å’Œæ—¥æ–¹&hellip;&hellip;&rdquo;ï¼Œä½†æ˜¯æœä¸åˆ°&ldquo;ä¸­å›½æŸé«˜å±‚é¢†å¯¼è¯´æ—¥æœ¬æ¬ æ‰&rdquo;ã€‚</span></p>
<p><span>7.1.5 PrefixQuery&nbsp;</span><br><span>å¦‚æœä½ æƒ³æœä»¥&lsquo;ä¸­&rsquo;å¼€å¤´çš„è¯è¯­ï¼Œä½ å¯ä»¥ç”¨PrefixQueryï¼š</span></p>
<p><span>PrefixQuery query = new PrefixQuery(new Term(â€œcontent â€œ, â€œä¸­â€);</span></p>
<p><span>7.1.6 FuzzyQuery&nbsp;</span><br><span>FuzzyQueryç”¨æ¥æœç´¢ç›¸ä¼¼çš„termï¼Œä½¿ç”¨Levenshteinç®—æ³•ã€‚å‡è®¾ä½ æƒ³æœç´¢è·Ÿ&lsquo;wuzza&rsquo;ç›¸ä¼¼çš„è¯è¯­ï¼Œä½ å¯ä»¥ï¼š</span></p>
<p><span>Query query = new FuzzyQuery(new Term(â€œcontentâ€, â€œwuzzaâ€);</span></p>
<p><span>ä½ å¯èƒ½å¾—åˆ°&lsquo;fuzzy&rsquo;å’Œ&lsquo;wuzzy&rsquo;ã€‚</span></p>
<p><span>7.1.7 RangeQuery&nbsp;</span><br><span>å¦ä¸€ä¸ªå¸¸ç”¨çš„Queryæ˜¯RangeQueryï¼Œä½ ä¹Ÿè®¸æƒ³æœç´¢æ—¶é—´åŸŸä»20060101åˆ°20060130ä¹‹é—´çš„documentï¼Œä½ å¯ä»¥ç”¨RangeQueryï¼š</span></p>
<p><span>RangeQuery query = new RangeQuery(new Term(&ldquo;time&rdquo;, &ldquo;20060101&rdquo;), new Term(&ldquo;time&rdquo;, &ldquo;20060130&rdquo;), true);</span></p>
<p><span>æœ€åçš„trueè¡¨ç¤ºç”¨é—­åˆåŒºé—´ã€‚</span></p>
<p><span>7.2 QueryParser&nbsp;</span><br><span>çœ‹äº†è¿™ä¹ˆå¤šQueryï¼Œä½ å¯èƒ½ä¼šé—®ï¼š&ldquo;ä¸ä¼šè®©æˆ‘è‡ªå·±ç»„åˆå„ç§Queryå§ï¼Œå¤ªéº»çƒ¦äº†ï¼&rdquo;å½“ç„¶ä¸ä¼šï¼Œluceneæä¾›äº†ä¸€ç§ç±»ä¼¼äºSQLè¯­å¥çš„æŸ¥è¯¢è¯­å¥ï¼Œæˆ‘ä»¬å§‘ä¸”å«å®ƒluceneè¯­å¥ï¼Œé€šè¿‡å®ƒï¼Œä½ å¯ä»¥æŠŠå„ç§æŸ¥è¯¢ä¸€å¥è¯æå®šï¼Œluceneä¼šè‡ªåŠ¨æŠŠå®ƒä»¬æŸ¥åˆ†æˆå°å—äº¤ç»™ç›¸åº”Queryæ‰§è¡Œã€‚ä¸‹é¢æˆ‘ä»¬å¯¹åº”æ¯ç§ Queryæ¼”ç¤ºä¸€ä¸‹ï¼š&nbsp;</span><br><span>TermQueryå¯ä»¥ç”¨&ldquo;field:key&rdquo;æ–¹å¼ï¼Œä¾‹å¦‚&ldquo;content:lucene&rdquo;ã€‚&nbsp;</span><br><span>BooleanQueryä¸­&lsquo;ä¸&rsquo;ç”¨&lsquo;+&rsquo;ï¼Œ&lsquo;æˆ–&rsquo;ç”¨&lsquo; &rsquo;ï¼Œä¾‹å¦‚&ldquo;content:java contenterl&rdquo;ã€‚&nbsp;</span><br><span>WildcardQueryä»ç„¶ç”¨&lsquo;?&rsquo;å’Œ&lsquo;<em>&rsquo;ï¼Œä¾‹å¦‚&ldquo;content:use</em>&rdquo;ã€‚&nbsp;</span><br><span>PhraseQueryç”¨&lsquo;~&rsquo;ï¼Œä¾‹å¦‚&ldquo;content:â€ä¸­æ—¥â€~5&rdquo;ã€‚&nbsp;</span><br><span>PrefixQueryç”¨&lsquo;<em>&rsquo;ï¼Œä¾‹å¦‚&ldquo;ä¸­</em>&rdquo;ã€‚&nbsp;</span><br><span>FuzzyQueryç”¨&lsquo;~&rsquo;ï¼Œä¾‹å¦‚&ldquo;content: wuzza ~&rdquo;ã€‚&nbsp;</span><br><span>RangeQueryç”¨&lsquo;[]&rsquo;æˆ–&lsquo;{}&rsquo;ï¼Œå‰è€…è¡¨ç¤ºé—­åŒºé—´ï¼Œåè€…è¡¨ç¤ºå¼€åŒºé—´ï¼Œä¾‹å¦‚&ldquo;time:[20060101 TO 20060130]&rdquo;ï¼Œæ³¨æ„TOåŒºåˆ†å¤§å°å†™ã€‚&nbsp;</span><br><span>ä½ å¯ä»¥ä»»æ„ç»„åˆquery stringï¼Œå®Œæˆå¤æ‚æ“ä½œï¼Œä¾‹å¦‚&ldquo;æ ‡é¢˜æˆ–æ­£æ–‡åŒ…æ‹¬luceneï¼Œå¹¶ä¸”æ—¶é—´åœ¨20060101åˆ°20060130ä¹‹é—´çš„æ–‡ç« &rdquo;å¯ä»¥è¡¨ç¤ºä¸ºï¼š&ldquo;+ (title:lucene content:lucene) +time:[20060101 TO 20060130]&rdquo;ã€‚ä»£ç å¦‚ä¸‹ï¼š</span></p>
<p><span>Directory dir = FSDirectory.getDirectory(PATH, false);&nbsp;</span><br><span>IndexSearcher is = new IndexSearcher(dir);&nbsp;</span><br><span>QueryParser parser = new QueryParser(â€œcontentâ€, new StandardAnalyzer());&nbsp;</span><br><span>Query query = parser.parse(â€œ+(title:lucene content:lucene) +time:[20060101 TO 20060130]â€;&nbsp;</span><br><span>Hits hits = is.search(query);&nbsp;</span><br><span>for (int i = 0; i &lt; hits.length(); i++)&nbsp;</span><br><span>{&nbsp;</span><br><span>Document doc = hits.doc(i);&nbsp;</span><br><span>System.out.println(doc.get(â€œtitleâ€);&nbsp;</span><br><span>}&nbsp;</span><br><span>is.close();</span></p>
<p><span>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåœ¨æŒ‡å®šæ–‡ä»¶ç›®å½•ä¸Šçš„IndexSearcherã€‚&nbsp;</span><br><span>ç„¶ååˆ›å»ºä¸€ä¸ªä½¿ç”¨StandardAnalyzerä½œä¸ºåˆ†æå™¨çš„QueryParserï¼Œå®ƒé»˜è®¤æœç´¢çš„åŸŸæ˜¯contentã€‚&nbsp;</span><br><span>æ¥ç€æˆ‘ä»¬ç”¨QueryParseræ¥parseæŸ¥è¯¢å­—ä¸²ï¼Œç”Ÿæˆä¸€ä¸ªQueryã€‚&nbsp;</span><br><span>ç„¶ååˆ©ç”¨è¿™ä¸ªQueryå»æŸ¥æ‰¾ç»“æœï¼Œç»“æœä»¥Hitsçš„å½¢å¼è¿”å›ã€‚&nbsp;</span><br><span>è¿™ä¸ªHitså¯¹è±¡åŒ…å«ä¸€ä¸ªåˆ—è¡¨ï¼Œæˆ‘ä»¬æŒ¨ä¸ªæŠŠå®ƒçš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥ã€‚</span></p>
<p><span>7.3 Filter&nbsp;</span><br><span>filter çš„ä½œç”¨å°±æ˜¯é™åˆ¶åªæŸ¥è¯¢ç´¢å¼•çš„æŸä¸ªå­é›†ï¼Œå®ƒçš„ä½œç”¨æœ‰ç‚¹åƒSQLè¯­å¥é‡Œçš„whereï¼Œä½†åˆæœ‰åŒºåˆ«ï¼Œå®ƒä¸æ˜¯æ­£è§„æŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ï¼Œåªæ˜¯å¯¹æ•°æ®æºè¿›è¡Œé¢„å¤„ç†ï¼Œç„¶åäº¤ç»™æŸ¥è¯¢è¯­å¥ã€‚æ³¨æ„å®ƒæ‰§è¡Œçš„æ˜¯é¢„å¤„ç†ï¼Œè€Œä¸æ˜¯å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œè¿‡æ»¤ï¼Œæ‰€ä»¥ä½¿ç”¨filterçš„ä»£ä»·æ˜¯å¾ˆå¤§çš„ï¼Œå®ƒå¯èƒ½ä¼šä½¿ä¸€æ¬¡æŸ¥è¯¢è€—æ—¶æé«˜ä¸€ç™¾å€ã€‚&nbsp;</span><br><span>æœ€å¸¸ç”¨çš„filteræ˜¯RangeFilterå’ŒQueryFilterã€‚RangeFilteræ˜¯è®¾å®šåªæœç´¢æŒ‡å®šèŒƒå›´å†…çš„ç´¢å¼•ï¼›QueryFilteræ˜¯åœ¨ä¸Šæ¬¡æŸ¥è¯¢çš„ç»“æœä¸­æœç´¢ã€‚&nbsp;</span><br><span>Filterçš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œä½ åªéœ€åˆ›å»ºä¸€ä¸ªfilterå®ä¾‹ï¼Œç„¶åæŠŠå®ƒä¼ ç»™searcherã€‚ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼ŒæŸ¥è¯¢&ldquo;æ—¶é—´åœ¨20060101åˆ°20060130ä¹‹é—´çš„æ–‡ç« &rdquo;é™¤äº†å°†é™åˆ¶å†™åœ¨query stringä¸­ï¼Œä½ è¿˜å¯ä»¥å†™åœ¨RangeFilterä¸­ï¼š</span></p>
<p><span>Directory dir = FSDirectory.getDirectory(PATH, false);&nbsp;</span><br><span>IndexSearcher is = new IndexSearcher(dir);&nbsp;</span><br><span>QueryParser parser = new QueryParser(â€œcontentâ€, new StandardAnalyzer());&nbsp;</span><br><span>Query query = parser.parse(â€œtitle:lucene content:luceneâ€;&nbsp;</span><br><span>RangeFilter filter = new RangeFilter(â€œtimeâ€, â€œ20060101â€, â€œ20060230â€, true, true);&nbsp;</span><br><span>Hits hits = is.search(query, filter);&nbsp;</span><br><span>for (int i = 0; i &lt; hits.length(); i++)&nbsp;</span><br><span>{&nbsp;</span><br><span>Document doc = hits.doc(i);&nbsp;</span><br><span>System.out.println(doc.get(â€œtitleâ€);&nbsp;</span><br><span>}&nbsp;</span><br><span>is.close();</span></p>
<p><span>7.4 Sort&nbsp;</span><br><span>æœ‰æ—¶ä½ æƒ³è¦ä¸€ä¸ªæ’å¥½åºçš„ç»“æœé›†ï¼Œå°±åƒSQLè¯­å¥çš„&ldquo;order by&rdquo;ï¼Œluceneèƒ½åšåˆ°ï¼šé€šè¿‡Sortã€‚&nbsp;</span><br><span>Sort sort = new Sort(&ldquo;time&rdquo;); //ç›¸å½“äºSQLçš„&ldquo;order by time&rdquo;&nbsp;</span><br><span>Sort sort = new Sort(&ldquo;time&rdquo;, true); // ç›¸å½“äºSQLçš„&ldquo;order by time desc&rdquo;&nbsp;</span><br><span>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼š</span></p>
<p><span>Directory dir = FSDirectory.getDirectory(PATH, false);&nbsp;</span><br><span>IndexSearcher is = new IndexSearcher(dir);&nbsp;</span><br><span>QueryParser parser = new QueryParser(â€œcontentâ€, new StandardAnalyzer());&nbsp;</span><br><span>Query query = parser.parse(â€œtitle:lucene content:luceneâ€;&nbsp;</span><br><span>RangeFilter filter = new RangeFilter(â€œtimeâ€, â€œ20060101â€, â€œ20060230â€, true, true);&nbsp;</span><br><span>Sort sort = new Sort(&ldquo;time&rdquo;);&nbsp;</span><br><span>Hits hits = is.search(query, filter, sort);&nbsp;</span><br><span>for (int i = 0; i &lt; hits.length(); i++)&nbsp;</span><br><span>{&nbsp;</span><br><span>Document doc = hits.doc(i);&nbsp;</span><br><span>System.out.println(doc.get(â€œtitleâ€);&nbsp;</span><br><span>}&nbsp;</span><br><span>is.close();</span></p>
<p><span>8 åˆ†æå™¨&nbsp;</span><br><span>åœ¨å‰é¢çš„æ¦‚å¿µä»‹ç»ä¸­æˆ‘ä»¬å·²ç»çŸ¥é“äº†åˆ†æå™¨çš„ä½œç”¨ï¼Œå°±æ˜¯æŠŠå¥å­æŒ‰ç…§è¯­ä¹‰åˆ‡åˆ†æˆä¸€ä¸ªä¸ªè¯è¯­ã€‚è‹±æ–‡åˆ‡åˆ†å·²ç»æœ‰äº†å¾ˆæˆç†Ÿçš„åˆ†æå™¨ï¼š StandardAnalyzerï¼Œå¾ˆå¤šæƒ…å†µä¸‹StandardAnalyzeræ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ç”šè‡³ä½ ä¼šå‘ç°StandardAnalyzerä¹Ÿèƒ½å¯¹ä¸­æ–‡è¿›è¡Œåˆ†è¯ã€‚&nbsp;</span><br><span>ä½†æ˜¯æˆ‘ä»¬çš„ç„¦ç‚¹æ˜¯ä¸­æ–‡åˆ†è¯ï¼ŒStandardAnalyzerèƒ½æ”¯æŒä¸­æ–‡åˆ†è¯å—ï¼Ÿå®è·µè¯æ˜æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æ•ˆæœå¹¶ä¸å¥½ï¼Œæœç´¢&ldquo;å¦‚æœ&rdquo; ä¼šæŠŠ&ldquo;ç‰›å¥¶ä¸å¦‚æœæ±å¥½å–&rdquo;ä¹Ÿæœç´¢å‡ºæ¥ï¼Œè€Œä¸”ç´¢å¼•æ–‡ä»¶å¾ˆå¤§ã€‚é‚£ä¹ˆæˆ‘ä»¬æ‰‹å¤´ä¸Šè¿˜æœ‰ä»€ä¹ˆåˆ†æå™¨å¯ä»¥ä½¿ç”¨å‘¢ï¼Ÿcoreé‡Œé¢æ²¡æœ‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨sandboxé‡Œé¢æ‰¾åˆ°ä¸¤ä¸ªï¼š ChineseAnalyzerå’ŒCJKAnalyzerã€‚ä½†æ˜¯å®ƒä»¬åŒæ ·éƒ½æœ‰åˆ†è¯ä¸å‡†çš„é—®é¢˜ã€‚ç›¸æ¯”ä¹‹ä¸‹ç”¨StandardAnalyzerå’Œ ChineseAnalyzerå»ºç«‹ç´¢å¼•æ—¶é—´å·®ä¸å¤šï¼Œç´¢å¼•æ–‡ä»¶å¤§å°ä¹Ÿå·®ä¸å¤šï¼ŒCJKAnalyzerè¡¨ç°ä¼šå·®äº›ï¼Œç´¢å¼•æ–‡ä»¶å¤§ä¸”è€—æ—¶æ¯”è¾ƒé•¿ã€‚&nbsp;</span><br><span>è¦è§£å†³é—®é¢˜ï¼Œé¦–å…ˆåˆ†æä¸€ä¸‹è¿™ä¸‰ä¸ªåˆ†æå™¨çš„åˆ†è¯æ–¹å¼ã€‚StandardAnalyzerå’ŒChineseAnalyzeréƒ½æ˜¯æŠŠå¥å­æŒ‰å•ä¸ªå­—åˆ‡åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´ &ldquo;ç‰›å¥¶ä¸å¦‚æœæ±å¥½å–&rdquo;ä¼šè¢«å®ƒä»¬åˆ‡åˆ†æˆ&ldquo;ç‰› å¥¶ ä¸ å¦‚ æœ æ± å¥½ å–&rdquo;ï¼›è€ŒCJKAnalyzeråˆ™ä¼šåˆ‡åˆ†æˆ&ldquo;ç‰›å¥¶ å¥¶ä¸ ä¸å¦‚ å¦‚æœ æœæ± æ±å¥½å¥½å–&rdquo;ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆæœç´¢&ldquo;æœæ±&rdquo;éƒ½èƒ½åŒ¹é…è¿™ä¸ªå¥å­ã€‚&nbsp;</span><br><span>ä»¥ä¸Šåˆ†è¯çš„ç¼ºç‚¹è‡³å°‘æœ‰ä¸¤ä¸ªï¼šåŒ¹é…ä¸å‡†ç¡®å’Œç´¢å¼•æ–‡ä»¶å¤§ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°†ä¸Šé¢çš„å¥å­åˆ†è§£æˆ &ldquo;ç‰›å¥¶ ä¸å¦‚ æœæ±å¥½å–&rdquo;ã€‚è¿™é‡Œçš„å…³é”®å°±æ˜¯è¯­ä¹‰è¯†åˆ«ï¼Œæˆ‘ä»¬å¦‚ä½•è¯†åˆ«&ldquo;ç‰›å¥¶&rdquo;æ˜¯ä¸€ä¸ªè¯è€Œ&ldquo;å¥¶ä¸&rdquo;ä¸æ˜¯è¯è¯­ï¼Ÿæˆ‘ä»¬å¾ˆè‡ªç„¶ä¼šæƒ³åˆ°åŸºäºè¯åº“çš„åˆ†è¯æ³•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å…ˆå¾—åˆ°ä¸€ä¸ªè¯åº“ï¼Œé‡Œé¢åˆ—ä¸¾äº†å¤§éƒ¨åˆ†è¯è¯­ï¼Œæˆ‘ä»¬æŠŠå¥å­æŒ‰æŸç§æ–¹å¼åˆ‡åˆ†ï¼Œå½“å¾—åˆ°çš„è¯è¯­ä¸è¯åº“ä¸­çš„é¡¹åŒ¹é…æ—¶ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºè¿™ç§åˆ‡åˆ†æ˜¯æ­£ç¡®çš„ã€‚è¿™æ ·åˆ‡è¯çš„è¿‡ç¨‹å°±è½¬å˜æˆåŒ¹é…çš„è¿‡ç¨‹ï¼Œè€ŒåŒ¹é…çš„æ–¹å¼æœ€ç®€å•çš„æœ‰æ­£å‘æœ€å¤§åŒ¹é…å’Œé€†å‘æœ€å¤§åŒ¹é…ä¸¤ç§ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªä»å¥å­å¼€å¤´å‘åè¿›è¡ŒåŒ¹é…ï¼Œä¸€ä¸ªä»å¥å­æœ«å°¾å‘å‰è¿›è¡ŒåŒ¹é…ã€‚åŸºäºè¯åº“çš„åˆ†è¯è¯åº“éå¸¸é‡è¦ï¼Œè¯åº“çš„å®¹é‡ç›´æ¥å½±å“æœç´¢ç»“æœï¼Œåœ¨ç›¸åŒè¯åº“çš„å‰æä¸‹ï¼Œæ®è¯´é€†å‘æœ€å¤§åŒ¹é…ä¼˜äºæ­£å‘æœ€å¤§åŒ¹é…ã€‚&nbsp;</span><br><span>å½“ç„¶è¿˜æœ‰åˆ«çš„åˆ†è¯æ–¹æ³•ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ä¸ªå­¦ç§‘ï¼Œæˆ‘è¿™é‡Œä¹Ÿæ²¡æœ‰æ·±å…¥ç ”ç©¶ã€‚å›åˆ°å…·ä½“åº”ç”¨ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯èƒ½æ‰¾åˆ°æˆç†Ÿçš„ã€ç°æˆçš„åˆ†è¯å·¥å…·ï¼Œé¿å…é‡æ–°å‘æ˜è½¦è½®ã€‚ç»è¿‡ç½‘ä¸Šæœç´¢ï¼Œç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯ä¸­ç§‘é™¢çš„ ICTCLASå’Œä¸€ä¸ªä¸å¼€æ”¾æºç ä½†æ˜¯å…è´¹çš„JE-Analysisã€‚ICTCLASæœ‰ä¸ªé—®é¢˜æ˜¯å®ƒæ˜¯ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ï¼Œ javaè°ƒç”¨éœ€è¦æœ¬åœ°æ–¹æ³•è°ƒç”¨ï¼Œä¸æ–¹ä¾¿ä¹Ÿæœ‰å®‰å…¨éšæ‚£ï¼Œè€Œä¸”å£ç¢‘ä¹Ÿç¡®å®ä¸å¤§å¥½ã€‚JE-Analysisæ•ˆæœè¿˜ä¸é”™ï¼Œå½“ç„¶ä¹Ÿä¼šæœ‰åˆ†è¯ä¸å‡†çš„åœ°æ–¹ï¼Œç›¸æ¯”æ¯”è¾ƒæ–¹ä¾¿æ”¾å¿ƒã€‚</span></p>
<p><span>9 æ€§èƒ½ä¼˜åŒ–&nbsp;</span><br><span>ä¸€ç›´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜æ˜¯åœ¨è®¨è®ºæ€ä¹ˆæ ·ä½¿luceneè·‘èµ·æ¥ï¼Œå®ŒæˆæŒ‡å®šä»»åŠ¡ã€‚åˆ©ç”¨å‰é¢è¯´çš„ä¹Ÿç¡®å®èƒ½å®Œæˆå¤§éƒ¨åˆ†åŠŸèƒ½ã€‚ä½†æ˜¯æµ‹è¯•è¡¨æ˜luceneçš„æ€§èƒ½å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œåœ¨å¤§æ•°æ®é‡å¤§å¹¶å‘çš„æ¡ä»¶ä¸‹ç”šè‡³ä¼šæœ‰åŠåˆ†é’Ÿè¿”å›çš„æƒ…å†µã€‚å¦å¤–å¤§æ•°æ®é‡çš„æ•°æ®åˆå§‹åŒ–å»ºç«‹ç´¢å¼•ä¹Ÿæ˜¯ä¸€ä¸ªååˆ†è€—æ—¶çš„è¿‡ç¨‹ã€‚é‚£ä¹ˆå¦‚ä½•æé«˜luceneçš„æ€§èƒ½å‘¢ï¼Ÿä¸‹é¢ä»ä¼˜åŒ–åˆ›å»ºç´¢å¼•æ€§èƒ½å’Œä¼˜åŒ–æœç´¢æ€§èƒ½ä¸¤æ–¹é¢ä»‹ç»ã€‚</span></p>
<p><span>9.1 ä¼˜åŒ–åˆ›å»ºç´¢å¼•æ€§èƒ½&nbsp;</span><br><span>è¿™æ–¹é¢çš„ä¼˜åŒ–é€”å¾„æ¯”è¾ƒæœ‰é™ï¼ŒIndexWriteræä¾›äº†ä¸€äº›æ¥å£å¯ä»¥æ§åˆ¶å»ºç«‹ç´¢å¼•çš„æ“ä½œï¼Œå¦å¤–æˆ‘ä»¬å¯ä»¥å…ˆå°†ç´¢å¼•å†™å…¥RAMDirectoryï¼Œå†æ‰¹é‡å†™å…¥FSDirectoryï¼Œä¸ç®¡æ€æ ·ï¼Œç›®çš„éƒ½æ˜¯å°½é‡å°‘çš„æ–‡ä»¶IOï¼Œå› ä¸ºåˆ›å»ºç´¢å¼•çš„æœ€å¤§ç“¶é¢ˆåœ¨äºç£ç›˜IOã€‚å¦å¤–é€‰æ‹©ä¸€ä¸ªè¾ƒå¥½çš„åˆ†æå™¨ä¹Ÿèƒ½æé«˜ä¸€äº›æ€§èƒ½ã€‚</span></p>
<p><span>9.1.1 é€šè¿‡è®¾ç½®IndexWriterçš„å‚æ•°ä¼˜åŒ–ç´¢å¼•å»ºç«‹&nbsp;</span><br><span>setMaxBufferedDocs(int maxBufferedDocs)&nbsp;</span><br><span>æ§åˆ¶å†™å…¥ä¸€ä¸ªæ–°çš„segmentå‰å†…å­˜ä¸­ä¿å­˜çš„documentçš„æ•°ç›®ï¼Œè®¾ç½®è¾ƒå¤§çš„æ•°ç›®å¯ä»¥åŠ å¿«å»ºç´¢å¼•é€Ÿåº¦ï¼Œé»˜è®¤ä¸º10ã€‚&nbsp;</span><br><span>setMaxMergeDocs(int maxMergeDocs)&nbsp;</span><br><span>æ§åˆ¶ä¸€ä¸ªsegmentä¸­å¯ä»¥ä¿å­˜çš„æœ€å¤§documentæ•°ç›®ï¼Œå€¼è¾ƒå°æœ‰åˆ©äºè¿½åŠ ç´¢å¼•çš„é€Ÿåº¦ï¼Œé»˜è®¤Integer.MAX_VALUEï¼Œæ— éœ€ä¿®æ”¹ã€‚&nbsp;</span><br><span>setMergeFactor(int mergeFactor)&nbsp;</span><br><span>æ§åˆ¶å¤šä¸ªsegmentåˆå¹¶çš„é¢‘ç‡ï¼Œå€¼è¾ƒå¤§æ—¶å»ºç«‹ç´¢å¼•é€Ÿåº¦è¾ƒå¿«ï¼Œé»˜è®¤æ˜¯10ï¼Œå¯ä»¥åœ¨å»ºç«‹ç´¢å¼•æ—¶è®¾ç½®ä¸º100ã€‚</span></p>
<p><span>9.1.2 é€šè¿‡RAMDirectoryç¼“å†™æé«˜æ€§èƒ½&nbsp;</span><br><span>æˆ‘ä»¬å¯ä»¥å…ˆæŠŠç´¢å¼•å†™å…¥RAMDirectoryï¼Œè¾¾åˆ°ä¸€å®šæ•°é‡æ—¶å†æ‰¹é‡å†™è¿›FSDirectoryï¼Œå‡å°‘ç£ç›˜IOæ¬¡æ•°ã€‚</span></p>
<p><span>FSDirectory fsDir = FSDirectory.getDirectory(â€œ/data/indexâ€, true);&nbsp;</span><br><span>RAMDirectory ramDir = new RAMDirectory();&nbsp;</span><br><span>IndexWriter fsWriter = new IndexWriter(fsDir, new StandardAnalyzer(), true);&nbsp;</span><br><span>IndexWriter ramWriter = new IndexWriter(ramDir, new StandardAnalyzer(), true);&nbsp;</span><br><span>while (there are documents to index)&nbsp;</span><br><span>{&nbsp;</span><br><span>â€¦ create Document â€¦&nbsp;</span><br><span>ramWriter.addDocument(doc);&nbsp;</span><br><span>if (condition for flushing memory to disk has been met)&nbsp;</span><br><span>{&nbsp;</span><br><span>fsWriter.addIndexes(new Directory[] { ramDir });&nbsp;</span><br><span>ramWriter.close();&nbsp;</span><br><span>ramWriter = new IndexWriter(ramDir, new StandardAnalyzer(), true);&nbsp;</span><br><span>}&nbsp;</span><br><span>}</span></p>
<p><span>9.1.3 é€‰æ‹©è¾ƒå¥½çš„åˆ†æå™¨&nbsp;</span><br><span>è¿™ä¸ªä¼˜åŒ–ä¸»è¦æ˜¯å¯¹ç£ç›˜ç©ºé—´çš„ä¼˜åŒ–ï¼Œå¯ä»¥å°†ç´¢å¼•æ–‡ä»¶å‡å°å°†è¿‘ä¸€åŠï¼Œç›¸åŒæµ‹è¯•æ•°æ®ä¸‹ç”±600Må‡å°‘åˆ°380Mã€‚ä½†æ˜¯å¯¹æ—¶é—´å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œç”šè‡³ä¼šéœ€è¦æ›´é•¿æ—¶é—´ï¼Œå› ä¸ºè¾ƒå¥½çš„åˆ†æå™¨éœ€è¦åŒ¹é…è¯åº“ï¼Œä¼šæ¶ˆè€—æ›´å¤šcpuï¼Œæµ‹è¯•æ•°æ®ç”¨StandardAnalyzerè€—æ—¶133åˆ†é’Ÿï¼›ç”¨MMAnalyzerè€—æ—¶150åˆ†é’Ÿã€‚</span></p>
<p><span>9.2 ä¼˜åŒ–æœç´¢æ€§èƒ½&nbsp;</span><br><span>è™½ç„¶å»ºç«‹ç´¢å¼•çš„æ“ä½œéå¸¸è€—æ—¶ï¼Œä½†æ˜¯é‚£æ¯•ç«Ÿåªåœ¨æœ€åˆåˆ›å»ºæ—¶æ‰éœ€è¦ï¼Œå¹³æ—¶åªæ˜¯å°‘é‡çš„ç»´æŠ¤æ“ä½œï¼Œæ›´ä½•å†µè¿™äº›å¯ä»¥æ”¾åˆ°ä¸€ä¸ªåå°è¿›ç¨‹å¤„ç†ï¼Œå¹¶ä¸å½±å“ç”¨æˆ·æœç´¢ã€‚æˆ‘ä»¬åˆ›å»ºç´¢å¼•çš„ç›®çš„å°±æ˜¯ç»™ç”¨æˆ·æœç´¢ï¼Œæ‰€ä»¥æœç´¢çš„æ€§èƒ½æ‰æ˜¯æˆ‘ä»¬æœ€å…³å¿ƒçš„ã€‚ä¸‹é¢å°±æ¥æ¢è®¨ä¸€ä¸‹å¦‚ä½•æé«˜æœç´¢æ€§èƒ½ã€‚</span></p>
<p><span>9.2.1 å°†ç´¢å¼•æ”¾å…¥å†…å­˜&nbsp;</span><br><span>è¿™æ˜¯ä¸€ä¸ªæœ€ç›´è§‚çš„æƒ³æ³•ï¼Œå› ä¸ºå†…å­˜æ¯”ç£ç›˜å¿«å¾ˆå¤šã€‚Luceneæä¾›äº†RAMDirectoryå¯ä»¥åœ¨å†…å­˜ä¸­å®¹çº³ç´¢å¼•ï¼š</span></p>
<p><span>Directory fsDir = FSDirectory.getDirectory(&ldquo;/data/index/&rdquo;, false);&nbsp;</span><br><span>Directory ramDir = new RAMDirectory(fsDir);&nbsp;</span><br><span>Searcher searcher = new IndexSearcher(ramDir);</span></p>
<p><span>ä½†æ˜¯å®è·µè¯æ˜RAMDirectoryå’ŒFSDirectoryé€Ÿåº¦å·®ä¸å¤šï¼Œå½“æ•°æ®é‡å¾ˆå°æ—¶ä¸¤è€…éƒ½éå¸¸å¿«ï¼Œå½“æ•°æ®é‡è¾ƒå¤§æ—¶ï¼ˆç´¢å¼•æ–‡ä»¶400Mï¼‰RAMDirectoryç”šè‡³æ¯”FSDirectoryè¿˜è¦æ…¢ä¸€ç‚¹ï¼Œè¿™ç¡®å®è®©äººå‡ºä¹æ„æ–™ã€‚&nbsp;</span><br><span>è€Œä¸”luceneçš„æœç´¢éå¸¸è€—å†…å­˜ï¼Œå³ä½¿å°†400Mçš„ç´¢å¼•æ–‡ä»¶è½½å…¥å†…å­˜ï¼Œåœ¨è¿è¡Œä¸€æ®µæ—¶é—´åéƒ½ä¼šout of memoryï¼Œæ‰€ä»¥ä¸ªäººè®¤ä¸ºè½½å…¥å†…å­˜çš„ä½œç”¨å¹¶ä¸å¤§ã€‚</span></p>
<p><span>9.2.2 ä¼˜åŒ–æ—¶é—´èŒƒå›´é™åˆ¶&nbsp;</span><br><span>æ—¢ç„¶è½½å…¥å†…å­˜å¹¶ä¸èƒ½æé«˜æ•ˆç‡ï¼Œä¸€å®šæœ‰å…¶å®ƒç“¶é¢ˆï¼Œç»è¿‡æµ‹è¯•å‘ç°æœ€å¤§çš„ç“¶é¢ˆå±…ç„¶æ˜¯æ—¶é—´èŒƒå›´é™åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ€æ ·ä½¿æ—¶é—´èŒƒå›´é™åˆ¶çš„ä»£ä»·æœ€å°å‘¢ï¼Ÿ&nbsp;</span><br><span>å½“éœ€è¦æœç´¢æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„ç»“æœæ—¶ï¼Œå¯ä»¥ï¼š&nbsp;</span><br><span>1ã€ç”¨RangeQueryï¼Œè®¾ç½®èŒƒå›´ï¼Œä½†æ˜¯RangeQueryçš„å®ç°å®é™…ä¸Šæ˜¯å°†æ—¶é—´èŒƒå›´å†…çš„æ—¶é—´ç‚¹å±•å¼€ï¼Œç»„æˆä¸€ä¸ªä¸ªBooleanClauseåŠ å…¥åˆ° BooleanQueryä¸­æŸ¥è¯¢ï¼Œå› æ­¤æ—¶é—´èŒƒå›´ä¸å¯èƒ½è®¾ç½®å¤ªå¤§ï¼Œç»æµ‹è¯•ï¼ŒèŒƒå›´è¶…è¿‡ä¸€ä¸ªæœˆå°±ä¼šæŠ› BooleanQuery.TooManyClausesï¼Œå¯ä»¥é€šè¿‡è®¾ç½® BooleanQuery.setMaxClauseCount (int maxClauseCount)æ‰©å¤§ï¼Œä½†æ˜¯æ‰©å¤§ä¹Ÿæ˜¯æœ‰é™çš„ï¼Œå¹¶ä¸”éšç€maxClauseCountæ‰©å¤§ï¼Œå ç”¨å†…å­˜ä¹Ÿæ‰©å¤§&nbsp;</span><br><span>2ã€ç”¨ RangeFilterä»£æ›¿RangeQueryï¼Œç»æµ‹è¯•é€Ÿåº¦ä¸ä¼šæ¯”RangeQueryæ…¢ï¼Œä½†æ˜¯ä»ç„¶æœ‰æ€§èƒ½ç“¶é¢ˆï¼ŒæŸ¥è¯¢çš„90%ä»¥ä¸Šæ—¶é—´è€—è´¹åœ¨ RangeFilterï¼Œç ”ç©¶å…¶æºç å‘ç°RangeFilterå®é™…ä¸Šæ˜¯é¦–å…ˆéå†æ‰€æœ‰ç´¢å¼•ï¼Œç”Ÿæˆä¸€ä¸ªBitSetï¼Œæ ‡è®°æ¯ä¸ªdocumentï¼Œåœ¨æ—¶é—´èŒƒå›´å†…çš„æ ‡è®°ä¸ºtrueï¼Œä¸åœ¨çš„æ ‡è®°ä¸ºfalseï¼Œç„¶åå°†ç»“æœä¼ é€’ç»™SearcheræŸ¥æ‰¾ï¼Œè¿™æ˜¯ååˆ†è€—æ—¶çš„ã€‚&nbsp;</span><br><span>3ã€è¿›ä¸€æ­¥æé«˜æ€§èƒ½ï¼Œè¿™ä¸ªåˆæœ‰ä¸¤ä¸ªæ€è·¯ï¼š&nbsp;</span><br><span>aã€ç¼“å­˜Filterç»“æœã€‚æ—¢ç„¶RangeFilterçš„æ‰§è¡Œæ˜¯åœ¨æœç´¢ä¹‹å‰ï¼Œé‚£ä¹ˆå®ƒçš„è¾“å…¥éƒ½æ˜¯ä¸€å®šçš„ï¼Œå°±æ˜¯IndexReaderï¼Œè€Œ IndexReaderæ˜¯ç”±Directoryå†³å®šçš„ï¼Œæ‰€ä»¥å¯ä»¥è®¤ä¸ºRangeFilterçš„ç»“æœæ˜¯ç”±èŒƒå›´çš„ä¸Šä¸‹é™å†³å®šçš„ï¼Œä¹Ÿå°±æ˜¯ç”±å…·ä½“çš„ RangeFilterå¯¹è±¡å†³å®šï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ä»¥RangeFilterå¯¹è±¡ä¸ºé”®ï¼Œå°†filterç»“æœBitSetç¼“å­˜èµ·æ¥å³å¯ã€‚lucene API å·²ç»æä¾›äº†ä¸€ä¸ªCachingWrapperFilterç±»å°è£…äº†FilteråŠå…¶ç»“æœï¼Œæ‰€ä»¥å…·ä½“å®æ–½èµ·æ¥æˆ‘ä»¬å¯ä»¥ cache CachingWrapperFilterå¯¹è±¡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸è¦è¢«CachingWrapperFilterçš„åå­—åŠå…¶è¯´æ˜è¯¯å¯¼ï¼Œ CachingWrapperFilterçœ‹èµ·æ¥æ˜¯æœ‰ç¼“å­˜åŠŸèƒ½ï¼Œä½†çš„ç¼“å­˜æ˜¯é’ˆå¯¹åŒä¸€ä¸ªfilterçš„ï¼Œä¹Ÿå°±æ˜¯åœ¨ä½ ç”¨åŒä¸€ä¸ªfilterè¿‡æ»¤ä¸åŒ IndexReaderæ—¶ï¼Œå®ƒå¯ä»¥å¸®ä½ ç¼“å­˜ä¸åŒIndexReaderçš„ç»“æœï¼Œè€Œæˆ‘ä»¬çš„éœ€æ±‚æ°æ°ç›¸åï¼Œæˆ‘ä»¬æ˜¯ç”¨ä¸åŒfilterè¿‡æ»¤åŒä¸€ä¸ª IndexReaderï¼Œæ‰€ä»¥åªèƒ½æŠŠå®ƒä½œä¸ºä¸€ä¸ªå°è£…ç±»ã€‚&nbsp;</span><br><span>bã€é™ä½æ—¶é—´ç²¾åº¦ã€‚ç ”ç©¶Filterçš„å·¥ä½œåŸç†å¯ä»¥çœ‹å‡ºï¼Œå®ƒæ¯æ¬¡å·¥ä½œéƒ½æ˜¯éå†æ•´ä¸ªç´¢å¼•çš„ï¼Œæ‰€ä»¥æ—¶é—´ç²’åº¦è¶Šå¤§ï¼Œå¯¹æ¯”è¶Šå¿«ï¼Œæœç´¢æ—¶é—´è¶ŠçŸ­ï¼Œåœ¨ä¸å½±å“åŠŸèƒ½çš„æƒ…å†µä¸‹ï¼Œæ—¶é—´ç²¾åº¦è¶Šä½è¶Šå¥½ï¼Œæœ‰æ—¶ç”šè‡³ç‰ºç‰²ä¸€ç‚¹ç²¾åº¦ä¹Ÿå€¼å¾—ï¼Œå½“ç„¶æœ€å¥½çš„æƒ…å†µæ˜¯æ ¹æœ¬ä¸ä½œæ—¶é—´é™åˆ¶ã€‚&nbsp;</span><br><span>ä¸‹é¢é’ˆå¯¹ä¸Šé¢çš„ä¸¤ä¸ªæ€è·¯æ¼”ç¤ºä¸€ä¸‹ä¼˜åŒ–ç»“æœï¼ˆéƒ½é‡‡ç”¨800çº¿ç¨‹éšæœºå…³é”®è¯éšå³æ—¶é—´èŒƒå›´ï¼‰ï¼š&nbsp;</span><br><span>ç¬¬ä¸€ç»„ï¼Œæ—¶é—´ç²¾åº¦ä¸ºç§’ï¼š&nbsp;</span><br><span>æ–¹å¼ ç›´æ¥ç”¨RangeFilter ä½¿ç”¨cache ä¸ç”¨filter&nbsp;</span><br><span>å¹³å‡æ¯ä¸ªçº¿ç¨‹è€—æ—¶ 10s 1s 300ms</span></p>
<p><span>ç¬¬äºŒç»„ï¼Œæ—¶é—´ç²¾åº¦ä¸ºå¤©&nbsp;</span><br><span>æ–¹å¼ ç›´æ¥ç”¨RangeFilter ä½¿ç”¨cache ä¸ç”¨filter&nbsp;</span><br><span>å¹³å‡æ¯ä¸ªçº¿ç¨‹è€—æ—¶ 900ms 360ms 300ms</span></p>
<p><span>ç”±ä»¥ä¸Šæ•°æ®å¯ä»¥å¾—å‡ºç»“è®ºï¼š&nbsp;</span><br><span>1ã€ å°½é‡é™ä½æ—¶é—´ç²¾åº¦ï¼Œå°†ç²¾åº¦ç”±ç§’æ¢æˆå¤©å¸¦æ¥çš„æ€§èƒ½æé«˜ç”šè‡³æ¯”ä½¿ç”¨cacheè¿˜å¥½ï¼Œæœ€å¥½ä¸ä½¿ç”¨filterã€‚&nbsp;</span><br><span>2ã€ åœ¨ä¸èƒ½é™ä½æ—¶é—´ç²¾åº¦çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨cacheèƒ½å¸¦äº†10å€å·¦å³çš„æ€§èƒ½æé«˜ã€‚</span></p>
<p><span>9.2.3 ä½¿ç”¨æ›´å¥½çš„åˆ†æå™¨&nbsp;</span><br><span>è¿™ä¸ªè·Ÿåˆ›å»ºç´¢å¼•ä¼˜åŒ–é“ç†å·®ä¸å¤šï¼Œç´¢å¼•æ–‡ä»¶å°äº†æœç´¢è‡ªç„¶ä¼šåŠ å¿«ã€‚å½“ç„¶è¿™ä¸ªæé«˜ä¹Ÿæ˜¯æœ‰é™çš„ã€‚è¾ƒå¥½çš„åˆ†æå™¨ç›¸å¯¹äºæœ€å·®çš„åˆ†æå™¨å¯¹æ€§èƒ½çš„æå‡åœ¨20%ä»¥ä¸‹ã€‚</span></p>
<p><span>10 ä¸€äº›ç»éªŒ</span></p>
<p><span>10.1å…³é”®è¯åŒºåˆ†å¤§å°å†™&nbsp;</span><br><span>or AND TOç­‰å…³é”®è¯æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œluceneåªè®¤å¤§å†™çš„ï¼Œå°å†™çš„å½“åšæ™®é€šå•è¯ã€‚</span></p>
<p><span>10.2 è¯»å†™äº’æ–¥æ€§&nbsp;</span><br><span>åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªå¯¹ç´¢å¼•çš„å†™æ“ä½œï¼Œåœ¨å†™çš„åŒæ—¶å¯ä»¥è¿›è¡Œæœç´¢</span></p>
<p><span>10.3 æ–‡ä»¶é”&nbsp;</span><br><span>åœ¨å†™ç´¢å¼•çš„è¿‡ç¨‹ä¸­å¼ºè¡Œé€€å‡ºå°†åœ¨tmpç›®å½•ç•™ä¸‹ä¸€ä¸ªlockæ–‡ä»¶ï¼Œä½¿ä»¥åçš„å†™æ“ä½œæ— æ³•è¿›è¡Œï¼Œå¯ä»¥å°†å…¶æ‰‹å·¥åˆ é™¤</span></p>
<p><span>10.4 æ—¶é—´æ ¼å¼&nbsp;</span><br><span>luceneåªæ”¯æŒä¸€ç§æ—¶é—´æ ¼å¼yyMMddHHmmssï¼Œæ‰€ä»¥ä½ ä¼ ä¸€ä¸ªyy-MM-dd HH:mm:ssçš„æ—¶é—´ç»™luceneå®ƒæ˜¯ä¸ä¼šå½“ä½œæ—¶é—´æ¥å¤„ç†çš„</span></p>
<p><span>10.5 è®¾ç½®boost&nbsp;</span><br><span>æœ‰äº›æ—¶å€™åœ¨æœç´¢æ—¶æŸä¸ªå­—æ®µçš„æƒé‡éœ€è¦å¤§ä¸€äº›ï¼Œä¾‹å¦‚ä½ å¯èƒ½è®¤ä¸ºæ ‡é¢˜ä¸­å‡ºç°å…³é”®è¯çš„æ–‡ç« æ¯”æ­£æ–‡ä¸­å‡ºç°å…³é”®è¯çš„æ–‡ç« æ›´æœ‰ä»·å€¼ï¼Œä½ å¯ä»¥æŠŠæ ‡é¢˜çš„boostè®¾ç½®çš„æ›´å¤§ï¼Œé‚£ä¹ˆæœç´¢ç»“æœä¼šä¼˜å…ˆæ˜¾ç¤ºæ ‡é¢˜ä¸­å‡ºç°å…³é”®è¯çš„æ–‡ç« ï¼ˆæ²¡æœ‰ä½¿ç”¨æ’åºçš„å‰é¢˜ä¸‹ï¼‰ã€‚ä½¿ç”¨æ–¹æ³•ï¼š&nbsp;</span><br><span>Field. setBoost(float boost);é»˜è®¤å€¼æ˜¯1.0ï¼Œä¹Ÿå°±æ˜¯è¯´è¦å¢åŠ æƒé‡çš„éœ€è¦è®¾ç½®å¾—æ¯”1å¤§ã€‚</span></p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> lucene </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[çœ‹ä¹¦ç¬”è®°]ã€Šæ·±å…¥javaè™šæ‹Ÿæœºã€‹â€”â€”javaä½“ç³»ç»“æ„ï¼ˆä¸€ï¼‰]]></title>
      <url>/2013/02/23/%E7%9C%8B%E4%B9%A6%E7%AC%94%E8%AE%B0-%E3%80%8A%E6%B7%B1%E5%85%A5java%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%8B%E2%80%94%E2%80%94java%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>javaçš„è¿™ç§é€‚åˆç½‘ç»œç¯å¢ƒçš„èƒ½åŠ›æ˜¯ç”±å…¶ä½“ç³»ç»“æ„å†³å®šçš„ï¼Œå®ƒå¯ä»¥ä¿è¯å®‰å…¨çš„ã€å¥å£®çš„ä¸”å’Œå¹³å°æ— å…³çš„ç¨‹åºé€šè¿‡ç½‘ç»œä¼ æ’­ï¼Œåœ¨å¾ˆå¤šä¸åŒçš„è®¡ç®—æœºå’Œè®¾å¤‡ä¸Šè¿è¡Œã€‚</p>
<p>ä½“ç³»ç»“æ„åŒ…æ‹¬å››ä¸ªç‹¬ç«‹ä½†ç›¸å…³çš„æŠ€æœ¯ï¼š</p>
<ul>
<li>javaç¨‹åºè®¾è®¡è¯­è¨€</li>
<li>java classæ–‡ä»¶</li>
<li>javaåº”ç”¨ç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰</li>
<li>javaè™šæ‹Ÿæœº</li>
</ul>
<p>ç”¨javaç¼–ç¨‹è¯­è¨€ç¼–å†™æºä»£ç ï¼ŒæŠŠå®ƒç¼–è¯‘æˆjava classæ–‡ä»¶ï¼Œç„¶åå†åœ¨javaè™šæ‹Ÿæœºä¸­è¿è¡Œclassæ–‡ä»¶ã€‚å½“ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œå®ƒé€šè¿‡è°ƒç”¨classæ–‡ä»¶ä¸­å®ç°äº†java APIçš„æ–¹æ³•æ¥æ»¡è¶³ç¨‹åºçš„java APIè°ƒç”¨ã€‚</p>
<p>javaè™šæ‹Ÿæœºå’Œjava APIç»„æˆäº†ä¸€ä¸ª&ldquo;å¹³å°&rdquo;ï¼Œæ‰€æœ‰javaç¨‹åºéƒ½åœ¨è¿™ä¸Šé¢ç¼–è¯‘ã€‚è¢«ç§°ä¸º&ldquo;javaè¿è¡Œæ—¶ç³»ç»Ÿ&rdquo;ï¼Œæˆ–è€…&ldquo;javaå¹³å°&rdquo;ã€‚</p>
<p>â€”â€”â€”â€”â€”-javaè™šæ‹Ÿæœºï¼š<br>javaé¢å‘ç½‘ç»œçš„æ ¸å¿ƒå°±æ˜¯javaè™šæ‹Ÿæœºï¼Œå®ƒæ”¯æŒjavaé¢å‘ç½‘ç»œä½“ç³»ç»“æ„ä¸‰å¤§æ”¯æŸ±çš„æ‰€æœ‰æ–¹é¢ï¼šå¹³å°æ— å…³æ€§ã€å®‰å…¨æ€§ã€ç½‘ç»œç§»åŠ¨æ€§ã€‚<br>javaè™šæ‹Ÿæœºä¸Šä¸€å°æŠ½è±¡çš„è®¡ç®—æœºï¼Œå…¶è§„èŒƒå®šä¹‰äº†æ¯ä¸ªjavaè™šæ‹Ÿæœºéƒ½å¿…é¡»å®ç°çš„ç‰¹æ€§ï¼Œä½†æ˜¯ä¸ºæ¯ä¸ªç‰¹å®šå®ç°éƒ½ç•™ä¸‹äº†å¾ˆå¤šé€‰æ‹©ã€‚ï¼ˆæ¯”å¦‚éƒ½è¦èƒ½æ‰§è¡Œå­—èŠ‚ç ï¼Œä½†æ˜¯æ‰§è¡Œçš„æŠ€æœ¯å¯ä»¥è‡ªå·±é€‰æ‹©ï¼‰ã€‚</p>
<p>javaè™šæ‹Ÿæœºçš„ä¸»è¦ä»»åŠ¡å°±æ˜¯è£…è½½classæ–‡ä»¶å¹¶æ‰§è¡Œå…¶ä¸­çš„å­—èŠ‚ç ã€‚è™šæ‹ŸæœºåŒ…å«ä¸€ä¸ªç±»è£…è½½å™¨ï¼Œå®ƒå¯ä»¥ä»ç¨‹åºå’ŒAPIä¸­è£…è½½classæ–‡ä»¶ã€‚java APIä¸­åªæœ‰ç¨‹åºæ‰§è¡Œæ—¶éœ€è¦çš„é‚£äº›ç±»æ‰ä¼šè¢«è£…è½½ã€‚å­—èŠ‚ç ç”±æ‰§è¡Œå¼•æ“æ¥æ‰§è¡Œã€‚</p>
<p>ä¸åŒjavaè™šæ‹Ÿæœºä¸­ï¼Œæ‰§è¡Œå¼•æ“å¯èƒ½å®ç°å¾—éå¸¸ä¸åŒï¼š</p>
<ul>
<li>&ldquo;ä¸€æ¬¡æ€§è§£é‡Šå­—èŠ‚ç &rdquo;ï¼Œæ˜¯è½¯ä»¶å®ç°çš„è™šæ‹Ÿæœºä¸­ï¼Œæœ€ç®€å•çš„å¼•æ“ã€‚</li>
<li>&ldquo;å³ä½¿ç¼–è¯‘å™¨&rdquo;ï¼Œæ›´å¿«ã€ä½†æ˜¯æ¶ˆè€—å†…å­˜ã€‚è¿™æ—¶ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¢«æ‰§è¡Œçš„å­—èŠ‚ç ä¼šè¢«ç¼–è¯‘æˆæœ¬åœ°æœºå™¨ä»£ç ã€‚ç¼–è¯‘å‡ºçš„æœ¬åœ°æœºå™¨ä»£ç ä¼šè¢«ç¼“å­˜ï¼Œå½“æ–¹æ³•ä»¥åè¢«è°ƒç”¨çš„æ—¶å€™å¯ä»¥é‡ç”¨ã€‚</li>
<li>&ldquo;è‡ªé€‚åº”ä¼˜åŒ–å™¨&rdquo;ï¼Œè¿™æ—¶ï¼Œè™šæ‹Ÿæœºå¼€å§‹çš„æ—¶å€™è§£é‡Šå­—èŠ‚ç ï¼Œä½†æ˜¯ä¼šè§æ—¶è¿è¡Œä¸­çš„ç¨‹åºæ´»åŠ¨ï¼Œå¹¶è®°å½•ä¸‹ä½¿ç”¨æœ€é¢‘ç¹çš„ä»£ç æ®µï¼Œç¨‹åºè¿è¡Œæ—¶æ—¶ï¼Œè™šæ‹Ÿæœºä¼šåªæŠŠæ´»åŠ¨æœ€é¢‘ç¹çš„ä»£ç ç¼–è¯‘æˆæœ¬åœ°æœºå™¨ä»£ç ï¼Œå…¶å®ƒçš„ä»£ç ç”±äºä½¿ç”¨ä¸é¢‘ç¹ï¼Œç»§ç»­ä¿ç•™æˆå­—èŠ‚ç &mdash;&mdash;ç”±è™šæ‹Ÿæœºç»§ç»­è§£é‡Šå®ƒä»¬ã€‚</li>
<li>æœ€åä¸€ç§è™šæ‹Ÿæœºç”±ç¡¬ä»¶èŠ¯ç‰‡åæˆï¼Œå®ƒç”¨æœ¬åœ°æ–¹æ³•æ‰§è¡Œjavaå­—èŠ‚ç ï¼Œè¿™ç§æ‰§è¡Œé‚£ä¸ªå¼•æ“å®é™…ä¸Šæ˜¯å†…åµŒåœ¨èŠ¯ç‰‡é‡Œçš„ã€‚</li>
</ul>
<p>å½“javaè™šæ‹Ÿæœºç”±ä¸»æœºæ“ä½œç³»ç»Ÿçš„è½¯ä»¶å®ç°æ—¶ï¼Œjavaç¨‹åºé€šè¿‡è°ƒç”¨æœ¬åœ°æ–¹æ³•å’Œä¸»æœºäº¤äº’ã€‚<br>javaä¸­æœ‰ä¸¤ç§æ–¹æ³•ï¼šjavaæ–¹æ³•å’Œæœ¬åœ°æ–¹æ³•ã€‚</p>
<ul>
<li>javaæ–¹æ³•æ˜¯ç”±javaè¯­è¨€ç¼–å†™ï¼Œç¼–è¯‘æˆå­—èŠ‚ç ï¼Œå‚¨å­˜åœ¨classæ–‡ä»¶ä¸­ã€‚</li>
<li>æœ¬åœ°æ–¹æ³•æ˜¯ç”±å…¶å®ƒè¯­è¨€ï¼ˆæ¯”å¦‚Cã€C++ï¼Œæˆ–è€…æ±‡ç¼–è¯­è¨€ï¼‰ç¼–å†™çš„ï¼Œç¼–è¯‘æˆå’Œå¤„ç†å™¨ç›¸å…³çš„æœºå™¨ä»£ç ã€‚ä¿å­˜åœ¨åŠ¨æ€é“¾æ¥åº“ä¸­ï¼Œæ ¼å¼æ˜¯å„ä¸ªå¹³å°ä¸“æœ‰çš„ã€‚<br>javaæ–¹æ³•æ˜¯å¹³å°æ— å…³çš„ã€‚<br>æœ¬åœ°æ–¹æ³•æ˜¯å¹³å°æœ‰å…³çš„ã€‚<br>è¿è¡Œä¸­çš„javaç¨‹åºè°ƒç”¨æœ¬åœ°æ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºè£…è½½åŒ…å«è¿™ä¸ªæœ¬åœ°æ–¹æ³•çš„åŠ¨æ€åº“ï¼Œå¹¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚æœ¬åœ°æ–¹æ³•æ˜¯è”ç³»javaç¨‹åºå’Œåº•å±‚ä¸»æœºæ“ä½œç³»ç»Ÿçš„è¿æ¥æ–¹æ³•ã€‚</li>
</ul>
<p>â€”â€”â€”â€”â€”-ç±»è£…è½½å™¨ä½“ç³»ç»“æ„ï¼š<br>ä¸€ä¸ªjavaç¨‹åºå¯ä»¥ä½¿ç”¨ä¸¤ç§ç±»è£…è½½å™¨ï¼šå¯åŠ¨ç±»è£…è½½å™¨å’Œç”¨æˆ·å®šä¹‰ç±»è£…è½½å™¨ã€‚<br>å¯åŠ¨ç±»è£…è½½å™¨ï¼ˆç³»ç»Ÿå”¯ä¸€ï¼‰æ˜¯javaè™šæ‹Ÿæœºå®ç°çš„ä¸€éƒ¨åˆ†ã€‚<br>javaç¨‹åºèƒ½å¤Ÿåœ¨è¿è¡Œæ—¶å®‰è£…ç”¨æˆ·å®šä¹‰çš„ç±»è£…è½½å™¨ã€‚è¿™ç§ç±»è£…è½½å™¨èƒ½å¤Ÿä½¿ç”¨è‡ªå®šä¹‰çš„æ–¹å¼æ¥è£…è½½ç±»ã€‚</p>
<p>å¯åŠ¨ç±»è£…è½½å™¨æ˜¯è™šæ‹Ÿæœºå®ç°çš„æœ¬è´¨éƒ¨åˆ†ï¼Œä½†æ˜¯ç”¨æˆ·å®šä¹‰ç±»è£…è½½å™¨ä¸æ˜¯ã€‚ä½†ç”¨æˆ·ç±»è£…è½½å™¨èƒ½å¤Ÿç”¨javaç¼–å†™ï¼Œèƒ½å¤Ÿè¢«ç¼–è¯‘æˆclassæ–‡ä»¶ï¼Œèƒ½å¤Ÿè¢«è™šæ‹Ÿæœºè£…è½½ï¼Œèƒ½å¤Ÿåƒå…¶ä»–ç±»ä¸€æ ·å®ä¾‹åŒ–ï¼Œä»–ä»¬å®é™…ä¸Šåªæ˜¯è¿è¡Œä¸­çš„javaåº”ç”¨ç¨‹åºå¯æ‰§è¡Œä»£ç çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>ç”±äºæœ‰ç”¨æˆ·å®šä¹‰ç±»è£…è½½å™¨ï¼Œæ‰€ä»¥ä¸å¿…åœ¨ç¼–è¯‘çš„æ—¶å€™å°±çŸ¥é“è¿è¡Œä¸­çš„javaç¨‹åºä¸­æœ€ç»ˆä¼šåŠ å…¥çš„æ‰€æœ‰ç±»ã€‚ä½¿å¾—åœ¨è¿è¡Œæ—¶æ‰©å±•javaç¨‹åºç§°ä¸ºå¯èƒ½ã€‚ä½†å®ƒè¿è¡Œæ—¶ç¨‹åºèƒ½å¤Ÿå†³å®šå®ƒéœ€è¦å“ªäº›é¢å¤–çš„ç±»ï¼Œèƒ½å¤Ÿå†³å®šæ˜¯ä½¿ç”¨ä¸€ä¸ªæˆ–æ˜¯æ›´å¤šçš„ç”¨æˆ·å®šä¹‰ç±»è£…è½½å™¨æ¥è£…è½½ã€‚</p>
<p>æ¯ä¸€ä¸ªç±»è¢«è£…è½½çš„æ—¶å€™ï¼Œjavaè™šæ‹Ÿæœºéƒ½ç›‘è§†è¿™ä¸ªç±»ï¼Œçœ‹ä»–åˆ°åº•æ˜¯è¢«å“ªä¸ªç±»è£…è½½å™¨è£…è½½ã€‚å½“è¢«è£…è½½çš„ç±»å¼•ç”¨äº†å¦ä¸€ä¸ªç±»æ—¶ï¼Œè™šæ‹Ÿæœºä¼šä½¿ç”¨è£…è½½ç¬¬ä¸€ä¸ªç±»çš„ç±»è£…è½½å™¨æ¥è£…è½½è¢«å¼•ç”¨çš„ç±»ã€‚</p>
<p>javaç¨‹åºèƒ½å¤Ÿä»ä¸€ä¸ªæˆ–å¤šä¸ªç±»ä¸­å®ä¾‹åŒ–å¤šä¸ªç”¨æˆ·å®šä¹‰ç±»è£…è½½å™¨ã€‚æ‰€ä»¥éœ€è¦å¤šå°‘ä¸ªç”¨æˆ·å®šä¹‰ç±»è£…è½½å™¨å°±èƒ½åˆ›å»ºå¤šå°‘ä¸ªã€‚è¢«ä¸åŒçš„ç±»è£…è½½å™¨è£…è½½çš„ç±»å­˜æ”¾åœ¨ä¸åŒçš„å‘½åç©ºé—´ä¸­ï¼Œå®ƒä»¬ä¸èƒ½äº’ç›¸è®¿é—®ï¼Œé™¤éåº”ç”¨ç¨‹åºæ˜¾ç¤ºåœ°å…è®¸è¿™æ ·åšã€‚<br>å½“ç¼–å†™åº”ç”¨ç¨‹åºçš„æ—¶å€™ï¼Œä»ä¸åŒæºæ–‡ä»¶è£…è½½çš„ç±»å¯ä»¥åˆ†éš”åœ¨ä¸åŒçš„å‘½åç©ºé—´ä¸­ã€‚è¿™æ ·å°±èƒ½å¤Ÿä½¿ç”¨javaç±»è£…è½½å™¨çš„ä½“ç³»ç»“æ„æ¥æ§åˆ¶ä»»ä½•ä»ä¸åŒæºæ–‡ä»¶ä¸­è£…è½½çš„ä»£ç ä¹‹é—´çš„äº’ç›¸åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯èƒ½å¤Ÿé˜»æ­¢æ¶æ„ä»£ç è·å–è®¿é—®å’Œç ´åå–„æ„ä»£ç çš„æƒé™ã€‚</p>
<p>ç½‘ç»œç§»åŠ¨æ€§çš„æ”¯æŒï¼šå…è®¸å®ä¾‹åŒ–ç”¨æˆ·å®šä¹‰ç±»è£…è½½å™¨æ¥çŸ¥é“å¦‚ä½•ä»ç½‘ç»œä¸‹è½½classæ–‡ä»¶ã€‚<br>å®‰å…¨æ€§çš„æ”¯æŒï¼šå…è®¸ä½¿ç”¨ä¸åŒçš„ç”¨æˆ·å®šä¹‰ç±»è£…è½½å™¨è£…è½½ä¸åŒæ¥æºçš„classæ–‡ä»¶ï¼ŒæŠŠä¸åŒæ¥æºçš„classæ–‡ä»¶æ”¾ç½®åœ¨ä¸åŒçš„å‘½åç©ºé—´ä¸­ï¼Œè¿™å°±èƒ½å¤Ÿé™åˆ¶æˆ–é˜»æ­¢ä¸åŒæ¥æºçš„ä»£ç ä¹‹é—´çš„äº’ç›¸è®¿é—®ã€‚</p>
<p>â€”â€”â€”â€”â€”-java classæ–‡ä»¶ï¼š<br>å¹³å°æ— å…³æ€§ï¼š</p>
<ul>
<li>ä¸ºjavaç¨‹åºæä¾›ç‹¬ç«‹äºåº•å±‚ä¸»æœºå¹³å°çš„äºŒè¿›åˆ¶å½¢å¼çš„æœåŠ¡ã€‚</li>
<li>java classæ–‡ä»¶æ˜¯å¯ä»¥è¿è¡Œåœ¨ä»»ä½•æ”¯æŒjavaè™šæ‹Ÿæœºçš„ç¡¬ä»¶å¹³å°å’Œæ“ä½œç³»ç»Ÿçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</li>
<li>javaç¼–è¯‘å™¨æŠŠjavaæºæ–‡ä»¶çš„æŒ‡ä»¤ç¿»è¯‘æˆå­—èŠ‚ç ï¼Œè¿™ç§å­—èŠ‚ç å°±æ˜¯javaè™šæ‹Ÿæœºçš„&ldquo;æœºå™¨è¯­è¨€&rdquo;ã€‚</li>
<li>java classæ–‡ä»¶ä¸­å­—èŠ‚é¡ºåºæ˜¯é«˜ä½åœ¨å‰ï¼Œè¿™ä¸ä½¿ç”¨ä½•ç§å¹³å°äº§ç”Ÿè¿™ä¸ªæ–‡ä»¶å’Œä½•ç§å¹³å°ä¸Šä½¿ç”¨è¿™ä¸ªæ–‡ä»¶éƒ½æ²¡å…³ç³»ã€‚</li>
</ul>
<p>ç½‘ç»œç§»åŠ¨æ€§ï¼š</p>
<ul>
<li>classæ–‡ä»¶è®¾è®¡å¾—ç´§å‡‘ï¼Œå› æ­¤å¯å¿«é€Ÿåœ¨ç½‘ç»œä¸Šä¼ é€ã€‚</li>
<li>ç”±äºjavaç¨‹åºæ˜¯åŠ¨æ€é“¾æ¥å’ŒåŠ¨æ€æ‰©å±•çš„ï¼Œclasså¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™ä¸‹è½½ã€‚</li>
</ul>
<p>â€”â€”â€”â€”â€”-java APIï¼š<br>java APIæ˜¯è¿è¡Œåº“çš„é›†åˆï¼Œå®ƒæä¾›ä¸€å¥—è®¿é—®ä¸»æœºç³»ç»Ÿèµ„æºçš„æ ‡å‡†æ–¹æ³•ã€‚<br>æ‰€æœ‰è¢«è£…è½½çš„classæ–‡ä»¶å’Œæ‰€æœ‰å·²ç»è£…è½½çš„åŠ¨æ€åº“å…±åŒç»„æˆäº†javaè™šæ‹Ÿæœºä¸Šè¿è¡Œçš„æ•´ä¸ªç¨‹åºã€‚</p>
<p>å¹³å°æ— å…³æ€§ï¼šåœ¨æ¯ä¸ªç‰¹å®šçš„ä¸»æœºå¹³å°ä¸Šéƒ½æ˜ç¡®åœ°å®ç°äº†javaè™šæ‹Ÿæœºå’Œjava APIã€‚</p>
<p>â€”â€”â€”â€”â€”-javaç¨‹åºè®¾è®¡è¯­è¨€ï¼š<br>javaèƒ½å¤Ÿæé«˜å¼€å‘è€…çš„æ•ˆç‡ï¼Œè¿™ç§æ•ˆç‡ä¸»è¦æ¥è‡ªjavaå¯¹ç›´æ¥å†…å­˜æ“ä½œçš„çº¦æŸã€‚<br>ï¼ˆåœ¨C++ä¸­ï¼šä¸å†ä½¿ç”¨çš„å¯¹è±¡æ²¡æœ‰è¢«é‡Šæ”¾ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼›å¤šæ¬¡é‡Šæ”¾ä¸€ä¸ªå¯¹è±¡ä¼šå¯¼è‡´å†…å­˜å†²çªã€‚è¿™ä¸¤ç§æƒ…å†µéƒ½ä¼šå¯¼è‡´C++ç¨‹åºå´©æºƒã€‚ï¼‰</p>
<p>æé«˜å¼€å‘è€…çš„æ•ˆç‡+ä¸ºç»ˆç«¯ç”¨æˆ·å¢å¼ºå¥å£®æ€§ã€‚</p>
<p>â€”â€”â€”â€”â€”-javaä½“ç³»ç»“æ„çš„ä»£ä»·ï¼š</p>
<ul>
<li>å’Œå…¶å®ƒæŠ€æœ¯ï¼ˆå¦‚C++ï¼‰ç›¸æ¯”ï¼Œjavaç¨‹åºçš„æ‰§è¡Œé€Ÿåº¦å¯èƒ½è¾ƒä½ï¼Œè¿™æ˜¯javaåœ¨é¢å‘ç½‘ç»œç‰¹æ€§ä¸Šçš„ä¸»è¦ä»£ä»·ä¹‹ä¸€ï¼ˆè™šæ‹Ÿæœºæ€§èƒ½é—®é¢˜[æ‰§è¡Œå¼•æ“çš„æ•ˆç‡]ï¼‰ã€‚</li>
<li>å› ä¸ºè·¨å¹³å°ï¼Œæ‰€ä»¥è¦ä¿è¯åœ¨å¤šç§è™šæ‹Ÿæœºä¸Šéƒ½æœ‰ä»¤äººæ»¡æ„çš„æ€§èƒ½ã€‚éšç€ä»£ç å’Œå¯¹è±¡é€šè¿‡ç½‘ç»œåœ¨è™šæ‹Ÿæœºä¹‹é—´ç§»åŠ¨ï¼Œå¼€å‘è€…ä¹Ÿæ— ä»çŸ¥æ™“ä»–ä»¬çš„ç¨‹åºç©¶ç«Ÿä¼šè¿è¡Œåœ¨å“ªäº›è™šæ‹Ÿæœºä¸Š</li>
<li>javaåœ¨å†…å­˜ç®¡ç†å’Œçº¿ç¨‹è°ƒåº¦ä¸Šçš„ç¼ºé™·ï¼Œåƒåœ¾æ”¶é›†å™¨å¯ä»¥ä½¿å¾—è®¸å¤šç¨‹åºæ›´åŠ å¥å£®ï¼Œä½†æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶çš„æ€§èƒ½åŠ å…¥äº†ä¸€äº›ä¸ç¡®å®šæ€§ï¼ˆæ— æ³•ç¡®å®šgcä»€ä¹ˆæ—¶å€™å¼€å§‹æ”¶é›†åƒåœ¾ï¼Œæ— æ³•ç¡®è®¤æ˜¯å¦å¼€å§‹æ”¶é›†åƒåœ¾ï¼Œæ— æ³•ç¡®è®¤åƒåœ¾æ”¶é›†è¦æŒç»­å¤šé•¿æ—¶é—´ï¼‰ï¼›javaè™šæ‹Ÿæœºè§„èŒƒè®¨è®ºçº¿ç¨‹è°ƒåº¦çš„åœ°æ–¹éå¸¸ç¬¼ç»Ÿï¼Œè¿™ç§å¯¹çº¿ç¨‹è¡Œä¸ºçš„æ¾æ•£è§„èŒƒæœ‰åˆ©äºå°†javaè™šæ‹Ÿæœºç§»æ¤åˆ°è®¸å¤šä¸åŒç±»å‹çš„ç¡¬ä»¶ä¸Šå»ï¼Œä½†æ˜¯è¿™ç§çº¿ç¨‹ç®¡ç†ä½¿å¾—ç¨‹åºå‘˜æ— æ³•äº†è§£åº”è¯¥å¦‚ä½•è°ƒåº¦çº¿ç¨‹ï¼Œæ— æ³•æ§åˆ¶çº¿ç¨‹è°ƒåº¦ã€‚</li>
<li>ä¸ºäº†å®ç°å¹³å°æ— å…³æ€§ï¼Œå¼•å‘çš„æœ€å°å…¬åˆ†æ¯é—®é¢˜ã€‚å„ä¸ªæ“ä½œç³»ç»Ÿä¹‹é—´è™½ç„¶æœ‰è®¸å¤šå…±æ€§ï¼Œä½†æ˜¯æ¯ä¸ªæ“ä½œç³»ç»Ÿé€šå¸¸éƒ½æœ‰ä¸€äº›è‡ªå·±çš„ç‰¹æ€§ã€‚åœ¨å¤§å¤šæ•°osä¸Šç”±çš„ç‰¹æ€§ï¼Œå¯èƒ½ä¼šè¢«æ·»åŠ åˆ°javaçš„osç³»ç»ŸæœåŠ¡APIä¸­ï¼Œä½†æ˜¯è¿™æ—¶è¿˜è¦åœ¨ä¸å…·å¤‡è¿™ä¸ªç‰¹æ€§çš„çš„osä¸Šç”±APIæ¨¡æ‹Ÿå®ç°å®ƒã€‚</li>
<li>å®¹æ˜“è¢«é€†å‘ç¼–è¯‘ã€‚å› ä¸ºjava classæ–‡ä»¶ä¸javaç¨‹åºè¯­è¨€ä¹‹é—´æ˜¯ç´§å¯†è”ç³»çš„ï¼Œå’Œjavaå¤©ç”Ÿçš„åŠ¨æ€é“¾æ¥ç‰¹æ€§ï¼Œæ‰€ä»¥ä»ä¸€ä¸ªç±»åˆ°å¦ä¸€ä¸ªç±»çš„å¼•ç”¨æ—¶ç¬¦å·åŒ–çš„ã€‚åœ¨java classä¸­ï¼ŒæŒ‡å‘å¦ä¸€ä¸ªç±»çš„å¼•ç”¨é€šè¿‡å­—ç¬¦ä¸²æ¸…æ¥šåœ°æ ‡æ˜äº†æ‰€æŒ‡å‘çš„è¿™ä¸ªç±»çš„åå­—ã€‚å¦‚æœå¼•ç”¨æŒ‡å‘ä¸€ä¸ªå­—æ®µï¼Œåˆ™è¿™ä¸ªå­—æ®µçš„åç§°å’Œæè¿°ç¬¦ï¼ˆå­—æ®µç±»åˆ«ï¼‰éƒ½ä¼šè¢«è¯¦ç»†è¯´æ˜ï¼›å¦‚æœè¿™ä¸ªå¼•ç”¨æŒ‡å‘çš„æ˜¯ä¸€ä¸ªæˆå‘˜æ–¹æ³•ï¼Œåˆ™è¿™ä¸ªæˆå‘˜æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦ï¼ˆè¿”å›ç±»å‹ï¼Œæ–¹æ³•å‚æ•°æ•°é‡å’Œç±»å‹ï¼‰ä¹Ÿä¼šè¢«è¯¦ç»†è¯´æ˜ã€‚è¿˜åŒ…å«äº†è‡ªå·±å­—æ®µå’Œæˆå‘˜æ–¹æ³•çš„ç¬¦å·å¼•ç”¨å’Œå¯é€‰çš„è°ƒè¯•ä¿¡æ¯ï¼ˆåŒ…å«å±€éƒ¨å˜é‡åç§°å’Œç±»å‹ï¼‰ã€‚<br>ä¸€ä¸ªclassæ–‡ä»¶çš„ç¬¦å·ä¿¡æ¯ï¼Œä»¥åŠå­—èŠ‚ç æŒ‡ä»¤é›†å’Œjavaè¯­è¨€ä¹‹é—´çš„å¯†åˆ‡å…³ç³»ï¼Œè¿™äº›æ–¹æ³•ä½¿å¾—æŠŠjava classæ–‡ä»¶é€†å‘ç¼–è¯‘ä¸ºjavaæºç æ–‡ä»¶ç›¸å½“å®¹æ˜“ã€‚<br>ï¼ˆå¯ä»¥ç”¨æ··æ·†å™¨æ¥æ··æ·†ä½ çš„classæ–‡ä»¶ï¼Œé€šè¿‡æ”¹å˜ç±»ã€å­—æ®µã€æ–¹æ³•å’Œã€å±€éƒ¨å˜é‡çš„åå­—ï¼Œä½†å®ƒä¸æ”¹å˜å·¥ä½œæµç¨‹ï¼‰ã€‚</li>
</ul>
<p>â€”â€”â€”â€”â€”-æ€»ç»“ï¼š<br>javaç¨‹åºè®¾è®¡è¯­è¨€æ˜¯ä¸€ç§ååˆ†é€šè¿‡çš„è¯­è¨€ï¼Œå®ƒå’Œå…¶ä»–æŠ€æœ¯ç›¸æ¯”æœ‰ç€æ˜æ˜¾çš„ä¼˜åŠ¿ï¼Œç‰¹åˆ«æ˜¯javaèƒ½åœ¨æå¤§ç¨‹åº¦ä¸Šæé«˜ç¨‹åºå‘˜çš„æ•ˆç‡ï¼Œå¢å¼ºç¨‹åºçš„å¥å£®æ€§ï¼Œä¸è€çš„ç¨‹åºè®¾è®¡æŠ€æœ¯ï¼ˆæ¯”å¦‚Cã€C++ï¼‰ç›¸æ¯”ï¼Œå…·æœ‰è¿‡å¾—å»çš„æ€§èƒ½ã€‚</p>
<p><img src="http://images.cnitblog.com/blog/378300/201302/23101002-a56a028cbdc04d5881e39f7e3e86d321.jpg" alt=""></p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> JVM </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[å·¥å…·åº“]JFileDownloaderå·¥å…·ç±»â€”â€”å¤šçº¿ç¨‹ä¸‹è½½ç½‘ç»œæ–‡ä»¶ï¼Œå¹¶ä¿å­˜åœ¨æœ¬åœ°]]></title>
      <url>/2013/02/20/%E5%B7%A5%E5%85%B7%E5%BA%93-JFileDownloader%E5%B7%A5%E5%85%B7%E7%B1%BB%E2%80%94%E2%80%94%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8B%E8%BD%BD%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%EF%BC%8C%E5%B9%B6%E4%BF%9D%E5%AD%98%E5%9C%A8%E6%9C%AC%E5%9C%B0/</url>
      <content type="html"><![CDATA[<p>æœ¬äººå¤§å››å³å°†æ¯•ä¸šçš„å‡†ç¨‹åºå‘˜ï¼ˆJavaSEã€JavaEEã€androidç­‰ï¼‰ä¸€æšï¼Œå°é¡¹ç›®ä¹Ÿåšè¿‡ä¸€ç‚¹ï¼Œäºæ˜¯ä¹ä¸€æ—¶å…´èµ·å°±å†™äº†ä¸€äº›å·¥å…·ã€‚</p>
<p>æˆ‘ä¼šåœ¨æœ¬åšå®¢ä¸­é™†ç»­å‘å¸ƒä¸€äº›å¹³æ—¶å¯èƒ½ä¼šç”¨åˆ°çš„å·¥å…·ã€‚</p>
<p>ä»£ç è´¨é‡å¯èƒ½ä¸æ˜¯å¾ˆå¥½ï¼Œå¤§å®¶å¤šæ‹…å¾…ï¼</p>
<p>ä»£ç æˆ–è€…æ€è·¯æœ‰ä¸å¦¥ä¹‹å¤„ï¼Œè¿˜å¸Œæœ›å¤§ç‰›ä»¬èƒ½ä¸åèµæ•™å“ˆï¼</p>
<p>&nbsp;</p>
<p><span>ä»¥ä¸‹ä»£ç ä¸ºæœ¬äººåŸåˆ›ï¼Œè½¬è½½è¯·æ³¨æ˜ï¼š</span></p>
<p><span>æœ¬æ–‡è½¬è½½ï¼Œæ¥è‡ªï¼š<a href="http://www.cnblogs.com/tiantianbyconan/archive/2013/02/20/2919132.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/archive/2013/02/20/2919132.html</a></span></p>
<p>&nbsp;</p>
<p>JFileDownloaderï¼šç”¨äºå¤šçº¿ç¨‹ä¸‹è½½ç½‘ç»œæ–‡ä»¶ï¼Œå¹¶ä¿å­˜åœ¨æœ¬åœ°ã€‚</p>
<p><strong>æºç å¦‚ä¸‹ï¼š</strong></p>
<p>1.JFileDownloaderç±»ï¼šä¸»è¦è´Ÿè´£ä¸‹è½½çš„åˆå§‹åŒ–å¯å¯åŠ¨å·¥ä½œã€‚</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('d395f922-7845-43c4-b066-96e79a7d1609')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_d395f922-7845-43c4-b066-96e79a7d1609" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.extrautil.jfiledownloader;<br></span><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.File;<br></span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.net.HttpURLConnection;<br></span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.net.URL;<br></span><span style="color: #008080;">  6</span><br><span style="color: #008080;">  7</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">  8</span> <span style="color: #008000;"> <em><br></em></span><span style="color: #008080;">  9</span> <span style="color: #008000;">  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 10</span> <span style="color: #008000;"> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2013-2-7 ä¸‹åˆ1:40:52<br></span><span style="color: #008080;"> 11</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 12</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> JFileDownloader{<br></span><span style="color: #008080;"> 13</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String urlPath;<br></span><span style="color: #008080;"> 14</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String destFilePath;<br></span><span style="color: #008080;"> 15</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> threadCount;<br></span><span style="color: #008080;"> 16</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> JFileDownloadThread[] threads;<br></span><span style="color: #008080;"> 17</span><br><span style="color: #008080;"> 18</span>     <span style="color: #0000ff;">private</span> JFileDownloadListener fileDownloadListener; <span style="color: #008000;">//</span><span style="color: #008000;"> è¿›åº¦ç›‘å¬å™¨</span><br><span style="color: #008080;"> 19</span>     <span style="color: #0000ff;">private</span> JFileDownloaderNotificationThread notificationThread; <span style="color: #008000;">//</span><span style="color: #008000;"> é€šçŸ¥è¿›åº¦çº¿ç¨‹</span><br><span style="color: #008080;"> 20</span><br><span style="color: #008080;"> 21</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> File destFile;<br></span><span style="color: #008080;"> 22</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 23</span> <span style="color: #008000;">     <em> ä¸‹è½½è¿‡ç¨‹ä¸­æ–‡ä»¶çš„åç¼€åã€‚<br></em></span><span style="color: #008080;"> 24</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 25</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> String DOWNLOADING_SUFFIX = â€œ.jdâ€<span style="color: #000000;">;<br></span><span style="color: #008080;"> 26</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 27</span> <span style="color: #008000;">     <em> é»˜è®¤ä½¿ç”¨çš„çº¿ç¨‹æ•°é‡ã€‚&lt;br&gt;<br></em></span><span style="color: #008080;"> 28</span> <span style="color: #008000;">      å¦‚æœä¸è®¾ç½®çº¿ç¨‹æ•°é‡å‚æ•°ï¼ˆthreadCountï¼‰ï¼Œåˆ™é»˜è®¤çº¿ç¨‹å¯åŠ¨æ•°é‡ä¸º1ï¼Œå³å•çº¿ç¨‹ä¸‹è½½ã€‚<br></span><span style="color: #008080;"> 29</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 30</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> DEFAULT_THREADCOUNT = 1<span style="color: #000000;">;<br></span><span style="color: #008080;"> 31</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 32</span> <span style="color: #008000;">     <em> ç”ŸæˆJFileDownloaderå¯¹è±¡ã€‚<br></em></span><span style="color: #008080;"> 33</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> urlPath è¦ä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶URLè·¯å¾„<br></span><span style="color: #008080;"> 34</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> destFilePath è¦ä¿å­˜çš„æ–‡ä»¶ç›®æ ‡ï¼ˆè·¯å¾„+æ–‡ä»¶åï¼‰<br></span><span style="color: #008080;"> 35</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> threadCount ä¸‹è½½è¯¥æ–‡ä»¶æ‰€éœ€è¦çš„çº¿ç¨‹æ•°é‡<br></span><span style="color: #008080;"> 36</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 37</span>     <span style="color: #0000ff;">public</span> JFileDownloader(String urlPath, String destFilePath, <span style="color: #0000ff;">int</span><span style="color: #000000;"> threadCount) {<br></span><span style="color: #008080;"> 38</span>         <span style="color: #0000ff;">this</span>.urlPath =<span style="color: #000000;"> urlPath;<br></span><span style="color: #008080;"> 39</span>         <span style="color: #0000ff;">this</span>.destFilePath =<span style="color: #000000;"> destFilePath;<br></span><span style="color: #008080;"> 40</span>         <span style="color: #0000ff;">this</span>.threadCount =<span style="color: #000000;"> threadCount;<br></span><span style="color: #008080;"> 41</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 42</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 43</span> <span style="color: #008000;">      ç”ŸæˆJFileDownloaderå¯¹è±¡ï¼Œå…¶ä¸­ä¸‹è½½çº¿ç¨‹æ•°é‡é»˜è®¤æ˜¯1ï¼Œä¹Ÿå°±æ˜¯é€‰æ‹©å•çº¿ç¨‹ä¸‹è½½ã€‚<br></span><span style="color: #008080;"> 44</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> urlPath urlPath è¦ä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶URLè·¯å¾„<br></span><span style="color: #008080;"> 45</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> destFilePath destFilePath è¦ä¿å­˜çš„æ–‡ä»¶ç›®æ ‡ï¼ˆè·¯å¾„+æ–‡ä»¶åï¼‰<br></span><span style="color: #008080;"> 46</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 47</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JFileDownloader(String urlPath, String destFilePath) {<br></span><span style="color: #008080;"> 48</span>         <span style="color: #0000ff;">this</span><span style="color: #000000;">(urlPath, destFilePath, DEFAULT_THREADCOUNT);<br></span><span style="color: #008080;"> 49</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 50</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 51</span> <span style="color: #008000;">      é»˜è®¤çš„æ„é€ æ–¹æ³•ï¼Œä½¿ç”¨æ„é€ æ–¹æ³•åå¿…é¡»è¦è°ƒç”¨setæ–¹æ³•æ¥è®¾ç½®urlç­‰ä¸‹è½½æ‰€éœ€é…ç½®ã€‚<br></span><span style="color: #008080;"> 52</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 53</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JFileDownloader() {<br></span><span style="color: #008080;"> 54</span><br><span style="color: #008080;"> 55</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 56</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 57</span> <span style="color: #008000;">      å¼€å§‹ä¸‹è½½æ–¹æ³•ï¼ˆæµç¨‹åˆ†ä¸º3æ­¥ï¼‰ã€‚<br></span><span style="color: #008080;"> 58</span> <span style="color: #008000;">     <em> &lt;br&gt;&lt;ul&gt;<br></em></span><span style="color: #008080;"> 59</span> <span style="color: #008000;">      &lt;li&gt;æ£€éªŒURLçš„åˆæ³•æ€§&lt;br&gt;<br></span><span style="color: #008080;"> 60</span> <span style="color: #008000;">     <em> &lt;li&gt;è®¡ç®—ä¸‹è½½æ‰€éœ€çš„çº¿ç¨‹æ•°é‡å’Œæ¯ä¸ªçº¿ç¨‹éœ€ä¸‹è½½å¤šå°‘å¤§å°çš„æ–‡ä»¶&lt;br&gt;<br></em></span><span style="color: #008080;"> 61</span> <span style="color: #008000;">      &lt;li&gt;å¯åŠ¨å„çº¿ç¨‹ã€‚<br></span><span style="color: #008080;"> 62</span> <span style="color: #008000;">     <em> &lt;/ul&gt;<br></em></span><span style="color: #008080;"> 63</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 64</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@throws</span><span style="color: #008000;"> Exception å¦‚æœè®¾ç½®çš„URLï¼Œincludesç­‰å‚æ•°ä¸åˆæ³•ï¼Œåˆ™æŠ›å‡ºè¯¥å¼‚å¸¸<br></span><span style="color: #008080;"> 65</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 66</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> startDownload() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception{<br></span><span style="color: #008080;"> 67</span>         checkSettingfValidity(); <span style="color: #008000;">//</span><span style="color: #008000;"> æ£€éªŒå‚æ•°åˆæ³•æ€§</span><br><span style="color: #008080;"> 68</span><br><span style="color: #008080;"> 69</span>         URL url = <span style="color: #0000ff;">new</span><span style="color: #000000;"> URL(urlPath);<br></span><span style="color: #008080;"> 70</span>         HttpURLConnection conn =<span style="color: #000000;"> (HttpURLConnection)url.openConnection();<br></span><span style="color: #008080;"> 71</span>         conn.setConnectTimeout(20 <em> 1000<span style="color: #000000;">);<br></span><span style="color: #008080;"> 72</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è·å–æ–‡ä»¶é•¿åº¦</span><br><span style="color: #008080;"> 73</span>         <span style="color: #0000ff;">long</span> size =<span style="color: #000000;"> conn.getContentLength();<br></span><span style="color: #008080;"> 74</span> <span style="color: #008000;">//</span><span style="color: #008000;">        int size = conn.getInputStream().available();</span><br><span style="color: #008080;"> 75</span>         <span style="color: #0000ff;">if</span>(size &lt; 0 || <span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> conn.getInputStream()){<br></span><span style="color: #008080;"> 76</span>             <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œç½‘ç»œè¿æ¥é”™è¯¯ï¼Œè¯·æ£€æŸ¥URLåœ°å€æ˜¯å¦æ­£ç¡®â€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 77</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 78</span> <span style="color: #000000;">        conn.disconnect();<br></span><span style="color: #008080;"> 79</span><br><span style="color: #008080;"> 80</span><br><span style="color: #008080;"> 81</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è®¡ç®—æ¯ä¸ªçº¿ç¨‹éœ€è¦ä¸‹è½½å¤šå°‘byteçš„æ–‡ä»¶</span><br><span style="color: #008080;"> 82</span>         <span style="color: #0000ff;">long</span> perSize = size % threadCount == 0 ? size / threadCount : (size / threadCount + 1<span style="color: #000000;">);<br></span><span style="color: #008080;"> 83</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> å»ºç«‹ç›®æ ‡æ–‡ä»¶ï¼ˆæ–‡ä»¶ä»¥.jdç»“å°¾ï¼‰</span><br><span style="color: #008080;"> 84</span>         destFile = <span style="color: #0000ff;">new</span> File(destFilePath +<span style="color: #000000;"> DOWNLOADING_SUFFIX);<br></span><span style="color: #008080;"> 85</span> <span style="color: #000000;">        destFile.createNewFile();<br></span><span style="color: #008080;"> 86</span><br><span style="color: #008080;"> 87</span>         threads = <span style="color: #0000ff;">new</span><span style="color: #000000;"> JFileDownloadThread[threadCount];<br></span><span style="color: #008080;"> 88</span><br><span style="color: #008080;"> 89</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> å¯åŠ¨è¿›åº¦é€šçŸ¥çº¿ç¨‹</span><br><span style="color: #008080;"> 90</span>         notificationThread = <span style="color: #0000ff;">new</span><span style="color: #000000;"> JFileDownloaderNotificationThread(threads, fileDownloadListener, destFile, size);<br></span><span style="color: #008080;"> 91</span> <span style="color: #000000;">        notificationThread.start();<br></span><span style="color: #008080;"> 92</span><br><span style="color: #008080;"> 93</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> åˆå§‹åŒ–è‹¥å¹²ä¸ªä¸‹è½½çº¿ç¨‹</span><br><span style="color: #008080;"> 94</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 0; i &lt; threadCount; i++<span style="color: #000000;">){<br></span><span style="color: #008080;"> 95</span>             <span style="color: #0000ff;">if</span>(i != (threadCount - 1<span style="color: #000000;">)){<br></span><span style="color: #008080;"> 96</span>                 threads[i] = <span style="color: #0000ff;">new</span><span style="color: #000000;"> JFileDownloadThread(urlPath, destFile,<br></span><span style="color: #008080;"> 97</span>                         i </em><span style="color: #000000;"> perSize, perSize, notificationThread);<br></span><span style="color: #008080;"> 98</span>             }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;"> 99</span>                 threads[i] = <span style="color: #0000ff;">new</span><span style="color: #000000;"> JFileDownloadThread(urlPath, destFile,<br></span><span style="color: #008080;">100</span>                         i <em> perSize, size - (threadCount - 1) </em><span style="color: #000000;"> perSize, notificationThread);<br></span><span style="color: #008080;">101</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">102</span>             threads[i].setPriority(8<span style="color: #000000;">);<br></span><span style="color: #008080;">103</span> <span style="color: #008000;">//</span><span style="color: #008000;">            threads[i].start();</span><br><span style="color: #008080;">104</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">105</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> å¯åŠ¨è‹¥å¹²ä¸ªä¸‹è½½çº¿ç¨‹ï¼ˆå› ä¸ºä¸‹è½½çº¿ç¨‹JFileDownloaderNotificationThreadä¸­ä½¿ç”¨äº†threadså±æ€§ï¼Œæ‰€ä»¥å¿…é¡»ç­‰ä¸‹è½½çº¿ç¨‹å…¨éƒ¨åˆå§‹åŒ–ä»¥åæ‰èƒ½å¯åŠ¨çº¿ç¨‹ï¼‰</span><br><span style="color: #008080;">106</span>         <span style="color: #0000ff;">for</span><span style="color: #000000;">(JFileDownloadThread thread : threads){<br></span><span style="color: #008080;">107</span> <span style="color: #000000;">            thread.start();<br></span><span style="color: #008080;">108</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">109</span><br><span style="color: #008080;">110</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">111</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">112</span> <span style="color: #008000;">     <em> å–æ¶ˆæ‰€æœ‰ä¸‹è½½çº¿ç¨‹ã€‚<br></em></span><span style="color: #008080;">113</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">114</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">115</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> cancelDownload(){<br></span><span style="color: #008080;">116</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> != threads &amp;&amp; 0 != threads.length &amp;&amp; <span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> notificationThread){<br></span><span style="color: #008080;">117</span>             <span style="color: #0000ff;">for</span>(JFileDownloadThread thread : threads){ <span style="color: #008000;">//</span><span style="color: #008000;"> ç»ˆæ­¢æ‰€æœ‰ä¸‹è½½çº¿ç¨‹</span><br><span style="color: #008080;">118</span> <span style="color: #000000;">                thread.cancelThread();<br></span><span style="color: #008080;">119</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">120</span>             notificationThread.cancelThread(); <span style="color: #008000;">//</span><span style="color: #008000;"> ç»ˆæ­¢é€šçŸ¥çº¿ç¨‹</span><br><span style="color: #008080;">121</span>             System.out.println(â€œä¸‹è½½å·²è¢«ç»ˆæ­¢ã€‚â€<span style="color: #000000;">);<br></span><span style="color: #008080;">122</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;">123</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">124</span>         System.out.println(â€œä¸‹è½½çº¿ç¨‹è¿˜æœªå¯åŠ¨ï¼Œæ— æ³•ç»ˆæ­¢ã€‚â€<span style="color: #000000;">);<br></span><span style="color: #008080;">125</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">126</span><br><span style="color: #008080;">127</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">128</span> <span style="color: #008000;">     <em> è®¾ç½®è¦ä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶URLè·¯å¾„ã€‚<br></em></span><span style="color: #008080;">129</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">130</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> urlPath è¦ä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶URLè·¯å¾„<br></span><span style="color: #008080;">131</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›å½“å‰JFileDownloaderå¯¹è±¡<br></span><span style="color: #008080;">132</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;">133</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JFileDownloader setUrlPath(String urlPath) {<br></span><span style="color: #008080;">134</span>         <span style="color: #0000ff;">this</span>.urlPath =<span style="color: #000000;"> urlPath;<br></span><span style="color: #008080;">135</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;">136</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">137</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">138</span> <span style="color: #008000;">      è®¾ç½®è¦ä¿å­˜çš„ç›®æ ‡æ–‡ä»¶ï¼ˆè·¯å¾„+æ–‡ä»¶åï¼‰ã€‚<br></span><span style="color: #008080;">139</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">140</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> destFilePath è¦ä¿å­˜çš„æ–‡ä»¶ç›®æ ‡ï¼ˆè·¯å¾„+æ–‡ä»¶åï¼‰<br></span><span style="color: #008080;">141</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›å½“å‰JFileDownloaderå¯¹è±¡<br></span><span style="color: #008080;">142</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">143</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JFileDownloader setDestFilePath(String destFilePath) {<br></span><span style="color: #008080;">144</span>         <span style="color: #0000ff;">this</span>.destFilePath =<span style="color: #000000;"> destFilePath;<br></span><span style="color: #008080;">145</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;">146</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">147</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">148</span> <span style="color: #008000;">     <em> è®¾ç½®ä¸‹è½½è¯¥æ–‡ä»¶æ‰€éœ€è¦çš„çº¿ç¨‹æ•°é‡ã€‚<br></em></span><span style="color: #008080;">149</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">150</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> threadCount ä¸‹è½½è¯¥æ–‡ä»¶æ‰€éœ€è¦çš„çº¿ç¨‹æ•°é‡<br></span><span style="color: #008080;">151</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›å½“å‰JFileDownloaderå¯¹è±¡<br></span><span style="color: #008080;">152</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">153</span>     <span style="color: #0000ff;">public</span> JFileDownloader setThreadCount(<span style="color: #0000ff;">int</span><span style="color: #000000;"> threadCount) {<br></span><span style="color: #008080;">154</span>         <span style="color: #0000ff;">this</span>.threadCount =<span style="color: #000000;"> threadCount;<br></span><span style="color: #008080;">155</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;">156</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">157</span><br><span style="color: #008080;">158</span>     <span style="color: #008000;">//</span><span style="color: #008000;">è§‚å¯Ÿè€…æ¨¡å¼æ¥è·å–ä¸‹è½½è¿›åº¦</span><br><span style="color: #008080;">159</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">160</span> <span style="color: #008000;">     <em> è®¾ç½®ç›‘å¬å™¨ï¼Œä»¥è·å–ä¸‹è½½è¿›åº¦ã€‚<br></em></span><span style="color: #008080;">161</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">162</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JFileDownloader setFileDownloadListener(<br></span><span style="color: #008080;">163</span> <span style="color: #000000;">            JFileDownloadListener fileDownloadListener) {<br></span><span style="color: #008080;">164</span>         <span style="color: #0000ff;">this</span>.fileDownloadListener =<span style="color: #000000;"> fileDownloadListener;<br></span><span style="color: #008080;">165</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;">166</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">167</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">168</span> <span style="color: #008000;">     <em> é€šè¿‡è¯¥æ–¹æ³•ç§»å‡ºç›¸åº”çš„ç›‘å¬å™¨å¯¹è±¡ã€‚<br></em></span><span style="color: #008080;">169</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">170</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> fileDownloadListener è¦ç§»é™¤çš„ç›‘å¬å™¨å¯¹è±¡<br></span><span style="color: #008080;">171</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">172</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> removeFileDownloadListener(<br></span><span style="color: #008080;">173</span> <span style="color: #000000;">            JFileDownloadListener fileDownloadListener) {<br></span><span style="color: #008080;">174</span>         fileDownloadListener = <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;">175</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">176</span><br><span style="color: #008080;">177</span><br><span style="color: #008080;">178</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">179</span> <span style="color: #008000;">     <em> æ£€éªŒè®¾ç½®çš„å‚æ•°æ˜¯å¦åˆæ³•ã€‚<br></em></span><span style="color: #008080;">180</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">181</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@throws</span><span style="color: #008000;"> Exception ç›®æ ‡æ–‡ä»¶URLè·¯å¾„ä¸åˆæ³•ï¼Œæˆ–è€…çº¿ç¨‹æ•°å°äº1ï¼Œåˆ™æŠ›å‡ºè¯¥å¼‚å¸¸<br></span><span style="color: #008080;">182</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">183</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> checkSettingfValidity() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception{<br></span><span style="color: #008080;">184</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> == urlPath || â€œâ€<span style="color: #000000;">.equals(urlPath)){<br></span><span style="color: #008080;">185</span>             <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œç›®æ ‡æ–‡ä»¶URLè·¯å¾„ä¸èƒ½ä¸ºç©ºâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">186</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">187</span>         <span style="color: #0000ff;">if</span>(threadCount &lt; 1<span style="color: #000000;">){<br></span><span style="color: #008080;">188</span>             <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œçº¿ç¨‹æ•°ä¸èƒ½å°äº1â€<span style="color: #000000;">);<br></span><span style="color: #008080;">189</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">190</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">191</span><br><span style="color: #008080;">192</span> }</pre><br></div><br></div>

<p>&nbsp;</p>
<p>2.JFileDownloadListeneræ¥å£ï¼šè¯¥æ¥å£ç”¨äºç›‘å¬JFileDownloaderä¸‹è½½çš„è¿›åº¦ã€‚</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('ee01f91f-781d-4fde-9833-bb14aaf3a587')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_ee01f91f-781d-4fde-9833-bb14aaf3a587" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.extrautil.jfiledownloader;<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.File;<br></span><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 6</span> <span style="color: #008000;"> <em><br></em></span><span style="color: #008080;"> 7</span> <span style="color: #008000;">  è¯¥æ¥å£ç”¨äºç›‘å¬JFileDownloaderä¸‹è½½çš„è¿›åº¦ã€‚<br></span><span style="color: #008080;"> 8</span> <span style="color: #008000;"> <em><br></em></span><span style="color: #008080;"> 9</span> <span style="color: #008000;">  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">10</span> <span style="color: #008000;"> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2013-2-7 ä¸‹åˆ2:12:45<br></span><span style="color: #008080;">11</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;">12</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> JFileDownloadListener {<br></span><span style="color: #008080;">13</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">14</span> <span style="color: #008000;">     <em> è¯¥æ–¹æ³•å¯è·å¾—æ–‡ä»¶çš„ä¸‹è½½è¿›åº¦ä¿¡æ¯ã€‚<br></em></span><span style="color: #008080;">15</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">16</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> progress æ–‡ä»¶ä¸‹è½½çš„è¿›åº¦å€¼ï¼ŒèŒƒå›´ï¼ˆ0-100ï¼‰ã€‚0è¡¨ç¤ºæ–‡ä»¶è¿˜æœªå¼€å§‹ä¸‹è½½ï¼›100åˆ™è¡¨ç¤ºæ–‡ä»¶ä¸‹è½½å®Œæˆã€‚<br></span><span style="color: #008080;">17</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> speed æ­¤æ—¶ä¸‹è½½ç¬æ—¶é€Ÿåº¦ï¼ˆå•ä½ï¼škb/æ¯ç§’ï¼‰ã€‚<br></span><span style="color: #008080;">18</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> remainTime æ­¤æ—¶å‰©ä½™ä¸‹è½½æ‰€éœ€æ—¶é—´ï¼ˆå•ä½ä¸ºæ¯«ç§’ï¼‰ã€‚<br></span><span style="color: #008080;">19</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">20</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> downloadProgress(<span style="color: #0000ff;">int</span> progress, <span style="color: #0000ff;">double</span> speed, <span style="color: #0000ff;">long</span><span style="color: #000000;"> remainTime);<br></span><span style="color: #008080;">21</span>     <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;">22</span> <span style="color: #008000;">      æ–‡ä»¶ä¸‹è½½å®Œæˆä¼šè°ƒç”¨è¯¥æ–¹æ³•ã€‚<br></span><span style="color: #008080;">23</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">24</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> file è¿”å›ä¸‹è½½å®Œæˆçš„Fileå¯¹è±¡ã€‚<br></span><span style="color: #008080;">25</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> downloadTime ä¸‹è½½æ‰€ç”¨çš„æ€»æ—¶é—´ï¼ˆå•ä½ä¸ºæ¯«ç§’ï¼‰ã€‚<br></span><span style="color: #008080;">26</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">27</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> downloadCompleted(File file, <span style="color: #0000ff;">long</span><span style="color: #000000;"> downloadTime);<br></span><span style="color: #008080;">28</span> }</pre><br></div><br></div>

<p>&nbsp;</p>
<p>3.JFileDownloaderNotificationThreadç±»ï¼šè¯¥çº¿ç¨‹ä¸ºé€šçŸ¥ä¸‹è½½è¿›åº¦çš„çº¿ç¨‹ã€‚</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('606a576f-1d6a-48a8-bb25-21c2a4df4a63')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_606a576f-1d6a-48a8-bb25-21c2a4df4a63" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.extrautil.jfiledownloader;<br></span><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.File;<br></span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.math.BigDecimal;<br></span><span style="color: #008080;">  5</span><br><span style="color: #008080;">  6</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">  7</span> <span style="color: #008000;"> <em> è¯¥çº¿ç¨‹ä¸ºé€šçŸ¥ä¸‹è½½è¿›åº¦çš„çº¿ç¨‹ã€‚<br></em></span><span style="color: #008080;">  8</span> <span style="color: #008000;">  ç”¨äºåœ¨ä¸‹è½½æœªå®Œæˆæ—¶é€šçŸ¥ç”¨æˆ·ä¸‹è½½çš„è¿›åº¦ï¼ŒèŒƒå›´ï¼ˆ0-100ï¼‰ã€‚0è¡¨ç¤ºæ–‡ä»¶è¿˜æœªå¼€å§‹ä¸‹è½½ï¼›100åˆ™è¡¨ç¤ºæ–‡ä»¶ä¸‹è½½å®Œæˆã€‚<br></span><span style="color: #008080;">  9</span> <span style="color: #008000;"> <em> æ­¤æ—¶ä¸‹è½½ç¬æ—¶é€Ÿåº¦ï¼ˆå•ä½ï¼škb/æ¯ç§’ï¼‰ã€‚<br></em></span><span style="color: #008080;"> 10</span> <span style="color: #008000;">  åœ¨å®Œæˆæ—¶è¿”å›ä¸‹è½½å®Œæˆçš„Fileå¯¹è±¡ç»™ç”¨æˆ·ã€‚è¿”å›ä¸‹è½½æ‰€ç”¨çš„æ€»æ—¶é—´ï¼ˆå•ä½ä¸ºæ¯«ç§’ï¼‰ç»™ç”¨æˆ·ã€‚<br></span><span style="color: #008080;"> 11</span> <span style="color: #008000;"> <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 12</span> <span style="color: #008000;">  </span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2013-2-17 ä¸‹åˆ12:23:59<br></span><span style="color: #008080;"> 13</span>  <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 14</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> JFileDownloaderNotificationThread <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Thread{<br></span><span style="color: #008080;"> 15</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> JFileDownloadThread[] threads;<br></span><span style="color: #008080;"> 16</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> JFileDownloadListener fileDownloadListener;<br></span><span style="color: #008080;"> 17</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> File destFile;<br></span><span style="color: #008080;"> 18</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> destFileSize;<br></span><span style="color: #008080;"> 19</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isRunning; <span style="color: #008000;">//</span><span style="color: #008000;"> çº¿ç¨‹è¿è¡Œåœæ­¢æ ‡å¿—</span><br><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> notificationTag; <span style="color: #008000;">//</span><span style="color: #008000;"> é€šçŸ¥æ ‡å¿—</span><br><span style="color: #008080;"> 21</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 22</span> <span style="color: #008000;">     <em> é€šè¿‡è¯¥æ–¹æ³•æ„å»ºä¸€ä¸ªè¿›åº¦é€šçŸ¥çº¿ç¨‹ã€‚<br></em></span><span style="color: #008080;"> 23</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> threads ä¸‹è½½æŸæ–‡ä»¶éœ€è¦çš„æ‰€æœ‰çº¿ç¨‹ã€‚<br></span><span style="color: #008080;"> 24</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> fileDownloadListener è¦é€šçŸ¥è¿›åº¦çš„ç›‘å¬å™¨å¯¹è±¡ã€‚<br></span><span style="color: #008080;"> 25</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> destFile ä¸‹è½½çš„æ–‡ä»¶å¯¹è±¡ã€‚<br></span><span style="color: #008080;"> 26</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 27</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JFileDownloaderNotificationThread(JFileDownloadThread[] threads,<br></span><span style="color: #008080;"> 28</span>             JFileDownloadListener fileDownloadListener, File destFile, <span style="color: #0000ff;">long</span><span style="color: #000000;"> destFileSize) {<br></span><span style="color: #008080;"> 29</span>         <span style="color: #0000ff;">this</span>.threads =<span style="color: #000000;"> threads;<br></span><span style="color: #008080;"> 30</span>         <span style="color: #0000ff;">this</span>.fileDownloadListener =<span style="color: #000000;"> fileDownloadListener;<br></span><span style="color: #008080;"> 31</span>         <span style="color: #0000ff;">this</span>.destFile =<span style="color: #000000;"> destFile;<br></span><span style="color: #008080;"> 32</span>         <span style="color: #0000ff;">this</span>.destFileSize =<span style="color: #000000;"> destFileSize;<br></span><span style="color: #008080;"> 33</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 34</span><br><span style="color: #008080;"> 35</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 36</span> <span style="color: #008000;">      ä¸æ–­åœ°å¾ªç¯æ¥å°±æ£€æŸ¥æ›´æ–°è¿›åº¦ã€‚<br></span><span style="color: #008080;"> 37</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 38</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 39</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> run() {<br></span><span style="color: #008080;"> 40</span>         isRunning = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 41</span>         <span style="color: #0000ff;">long</span> startTime = 0<span style="color: #000000;">;<br></span><span style="color: #008080;"> 42</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> fileDownloadListener){<br></span><span style="color: #008080;"> 43</span>             startTime = System.currentTimeMillis(); <span style="color: #008000;">//</span><span style="color: #008000;"> æ–‡ä»¶ä¸‹è½½å¼€å§‹æ—¶é—´</span><br><span style="color: #008080;"> 44</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;"> 45</span><br><span style="color: #008080;"> 46</span>         <span style="color: #0000ff;">long</span> oldTemp = 0; <span style="color: #008000;">//</span><span style="color: #008000;"> ä¸Šæ¬¡å·²ä¸‹è½½æ•°æ®é•¿åº¦</span><br><span style="color: #008080;"> 47</span>         <span style="color: #0000ff;">long</span> oldTime = 0; <span style="color: #008000;">//</span><span style="color: #008000;"> ä¸Šæ¬¡ä¸‹è½½çš„å½“å‰æ—¶é—´</span><br><span style="color: #008080;"> 48</span><br><span style="color: #008080;"> 49</span>         <span style="color: #0000ff;">while</span><span style="color: #000000;">(isRunning){<br></span><span style="color: #008080;"> 50</span>             <span style="color: #0000ff;">if</span>(notificationTag){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœæ­¤æ—¶æ­£ç­‰å¾…æ£€æŸ¥æ›´æ–°è¿›åº¦ã€‚<br></span><span style="color: #008080;"> 51</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> è®¡ç®—æ­¤æ—¶çš„æ‰€æœ‰çº¿ç¨‹ä¸‹è½½é•¿åº¦çš„æ€»å’Œ</span><br><span style="color: #008080;"> 52</span>                 <span style="color: #0000ff;">long</span> temp = 0<span style="color: #000000;">;<br></span><span style="color: #008080;"> 53</span>                 <span style="color: #0000ff;">for</span><span style="color: #000000;">(JFileDownloadThread thread : threads){<br></span><span style="color: #008080;"> 54</span>                     temp +=<span style="color: #000000;"> thread.currentLength;<br></span><span style="color: #008080;"> 55</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;"> 56</span> <span style="color: #008000;">//</span><span style="color: #008000;">                System.out.println(â€œtemp: â€œ + temp);<br></span><span style="color: #008080;"> 57</span> <span style="color: #008000;">//</span><span style="color: #008000;">                System.out.println(â€œdestFileSize: â€œ + destFileSize);<br></span><span style="color: #008080;"> 58</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> æ¢ç®—æˆè¿›åº¦</span><br><span style="color: #008080;"> 59</span>                 <span style="color: #0000ff;">int</span> progress = (<span style="color: #0000ff;">int</span>) ((<span style="color: #0000ff;">double</span>)temp  100 / (<span style="color: #0000ff;">double</span><span style="color: #000000;">)destFileSize);<br></span><span style="color: #008080;"> 60</span><br><span style="color: #008080;"> 61</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> æŠŠè¿›åº¦é€šçŸ¥ç»™ç›‘å¬å™¨</span><br><span style="color: #008080;"> 62</span>                 <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> fileDownloadListener){<br></span><span style="color: #008080;"> 63</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> è®¡ç®—ç¬æ—¶é€Ÿåº¦</span><br><span style="color: #008080;"> 64</span>                     <span style="color: #0000ff;">long</span> detaTemp = temp - oldTemp; <span style="color: #008000;">//</span><span style="color: #008000;"> ä¸¤æ¬¡æ›´æ–°è¿›åº¦çš„æ—¶é—´æ®µå†…çš„å·²ä¸‹è½½æ•°æ®å·®</span><br><span style="color: #008080;"> 65</span>                     <span style="color: #0000ff;">long</span> detaTime = System.currentTimeMillis() - oldTime; <span style="color: #008000;">//</span><span style="color: #008000;"> ä¸¤æ¬¡æ›´æ–°è¿›åº¦çš„æ—¶é—´æ®µå†…çš„æ—¶é—´å·®<br></span><span style="color: #008080;"> 66</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> ä¸¤æ¬¡æ›´æ–°è¿›åº¦çš„æ—¶é—´æ®µå†…çš„é€Ÿåº¦ä½œä¸ºç¬æ—¶é€Ÿåº¦</span><br><span style="color: #008080;"> 67</span>                     <span style="color: #0000ff;">double</span> speed = ((<span style="color: #0000ff;">double</span>)detaTemp / 1024) / ((<span style="color: #0000ff;">double</span>)(detaTime) / 1000<span style="color: #000000;">);<br></span><span style="color: #008080;"> 68</span><br><span style="color: #008080;"> 69</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> ä¿ç•™å°æ•°ç‚¹å2ä½ï¼Œæœ€åä¸€ä½å››èˆäº”å…¥</span><br><span style="color: #008080;"> 70</span>                     speed = <span style="color: #0000ff;">new</span> BigDecimal(speed).setScale(2<span style="color: #000000;">, BigDecimal.ROUND_HALF_UP).doubleValue();<br></span><span style="color: #008080;"> 71</span><br><span style="color: #008080;"> 72</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> è®¡ç®—å‰©ä½™ä¸‹è½½æ—¶é—´</span><br><span style="color: #008080;"> 73</span>                     <span style="color: #0000ff;">double</span> remainTime = (<span style="color: #0000ff;">double</span>)(destFileSize - temp) /<span style="color: #000000;"> speed;<br></span><span style="color: #008080;"> 74</span>                     <span style="color: #0000ff;">if</span>(Double.isInfinite(remainTime) ||<span style="color: #000000;"> Double.isNaN(remainTime)){<br></span><span style="color: #008080;"> 75</span>                         remainTime = 0<span style="color: #000000;">;<br></span><span style="color: #008080;"> 76</span>                     }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;"> 77</span>                         remainTime = <span style="color: #0000ff;">new</span> BigDecimal(remainTime).setScale(0<span style="color: #000000;">, BigDecimal.ROUND_HALF_UP).longValue();<br></span><span style="color: #008080;"> 78</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;"> 79</span><br><span style="color: #008080;"> 80</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> é€šçŸ¥ç›‘å¬è€…è¿›åº¦å’Œé€Ÿåº¦ä»¥åŠä¸‹è½½å‰©ä½™æ—¶é—´</span><br><span style="color: #008080;"> 81</span>                     fileDownloadListener.downloadProgress(progress, speed, (<span style="color: #0000ff;">long</span><span style="color: #000000;">)remainTime);<br></span><span style="color: #008080;"> 82</span><br><span style="color: #008080;"> 83</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> é‡ç½®ä¸Šæ¬¡å·²ä¸‹è½½æ•°æ®é•¿åº¦å’Œä¸Šæ¬¡ä¸‹è½½çš„å½“å‰æ—¶é—´</span><br><span style="color: #008080;"> 84</span>                     oldTemp =<span style="color: #000000;"> temp;<br></span><span style="color: #008080;"> 85</span>                     oldTime =<span style="color: #000000;"> System.currentTimeMillis();<br></span><span style="color: #008080;"> 86</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;"> 87</span><br><span style="color: #008080;"> 88</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœä¸‹è½½è¿›åº¦è¾¾åˆ°100ï¼Œåˆ™è¡¨ç¤ºä¸‹è½½å®Œæ¯•</span><br><span style="color: #008080;"> 89</span>                 <span style="color: #0000ff;">if</span>(100 &lt;=<span style="color: #000000;"> progress){<br></span><span style="color: #008080;"> 90</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> ç»™ä¸‹è½½å¥½çš„æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œå³å»æ‰DOWNLOADING_SUFFIXåç¼€</span><br><span style="color: #008080;"> 91</span>                     String oldPath =<span style="color: #000000;"> destFile.getPath();<br></span><span style="color: #008080;"> 92</span>                     File newFile = <span style="color: #0000ff;">new</span> File(oldPath.substring(0, oldPath.lastIndexOf(â€œ.â€<span style="color: #000000;">)));<br></span><span style="color: #008080;"> 93</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> æ£€æŸ¥å»æ‰åçš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ é™¤åŸæ¥çš„æ–‡ä»¶å¹¶é‡å‘½åä¸‹è½½çš„æ–‡ä»¶ï¼ˆå³ï¼šè¦†ç›–åŸæ–‡ä»¶ï¼‰</span><br><span style="color: #008080;"> 94</span>                     <span style="color: #0000ff;">if</span><span style="color: #000000;">(newFile.exists()){<br></span><span style="color: #008080;"> 95</span> <span style="color: #000000;">                        newFile.delete();<br></span><span style="color: #008080;"> 96</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;"> 97</span>                     System.out.println(destFile.renameTo(newFile));<span style="color: #008000;">//</span><span style="color: #008000;"> é‡å‘½å<br></span><span style="color: #008080;"> 98</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> é€šçŸ¥ç›‘å¬å™¨ï¼Œå¹¶ä¼ å…¥æ–°çš„æ–‡ä»¶å¯¹è±¡</span><br><span style="color: #008080;"> 99</span>                     <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> fileDownloadListener){<br></span><span style="color: #008080;">100</span>                         fileDownloadListener.downloadCompleted(newFile, System.currentTimeMillis() -<span style="color: #000000;"> startTime);<br></span><span style="color: #008080;">101</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">102</span>                     isRunning = <span style="color: #0000ff;">false</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> æ–‡ä»¶ä¸‹è½½å®Œå°±ç»“æŸé€šçŸ¥çº¿ç¨‹ã€‚</span><br><span style="color: #008080;">103</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">104</span>                 notificationTag = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">105</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">106</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®ä¸ºæ¯100æ¯«ç§’è¿›è¡Œæ£€æŸ¥å¹¶æ›´æ–°é€šçŸ¥</span><br><span style="color: #008080;">107</span>             <span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">108</span>                 Thread.sleep(100<span style="color: #000000;">);<br></span><span style="color: #008080;">109</span>             } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (InterruptedException e) {<br></span><span style="color: #008080;">110</span> <span style="color: #000000;">                e.printStackTrace();<br></span><span style="color: #008080;">111</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">112</span><br><span style="color: #008080;">113</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">114</span><br><span style="color: #008080;">115</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">116</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">117</span> <span style="color: #008000;">     <em> è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œåˆ™ä¼šä½¿å¾—çº¿ç¨‹å¤„äºå¾…æ£€æŸ¥æ›´æ–°è¿›åº¦çŠ¶æ€ã€‚<br></em></span><span style="color: #008080;">118</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">119</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">120</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">synchronized</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> notificationProgress(){<br></span><span style="color: #008080;">121</span>         notificationTag = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;">122</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">123</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">124</span> <span style="color: #008000;">     <em> å–æ¶ˆè¯¥é€šçŸ¥çº¿ç¨‹<br></em></span><span style="color: #008080;">125</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">126</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;">127</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> cancelThread(){<br></span><span style="color: #008080;">128</span>         isRunning = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">129</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">130</span><br><span style="color: #008080;">131</span><br><span style="color: #008080;">132</span> }</pre><br></div><br></div>

<p>&nbsp;</p>
<p>4.JFileDownloadThreadç±»ï¼šçœŸæ­£çš„ä¸‹è½½çº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹ç”¨äºæ‰§è¡Œè¯¥çº¿ç¨‹æ‰€è¦è´Ÿè´£ä¸‹è½½çš„æ•°æ®ã€‚</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('c46c22f4-1e9a-43c7-b6e7-f5c514b5483e')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_c46c22f4-1e9a-43c7-b6e7-f5c514b5483e" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.extrautil.jfiledownloader;<br></span><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.File;<br></span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.IOException;<br></span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.InputStream;<br></span><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.RandomAccessFile;<br></span><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.net.HttpURLConnection;<br></span><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.net.URL;<br></span><span style="color: #008080;">  9</span><br><span style="color: #008080;"> 10</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 11</span> <span style="color: #008000;"> <em><br></em></span><span style="color: #008080;"> 12</span> <span style="color: #008000;">  çœŸæ­£çš„ä¸‹è½½çº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹ç”¨äºæ‰§è¡Œè¯¥çº¿ç¨‹æ‰€è¦è´Ÿè´£ä¸‹è½½çš„æ•°æ®ã€‚<br></span><span style="color: #008080;"> 13</span> <span style="color: #008000;"> <em><br></em></span><span style="color: #008080;"> 14</span> <span style="color: #008000;">  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 15</span> <span style="color: #008000;"> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2013-2-7 ä¸Šåˆ11:58:24<br></span><span style="color: #008080;"> 16</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 17</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> JFileDownloadThread <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Thread{<br></span><span style="color: #008080;"> 18</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String urlPath;<br></span><span style="color: #008080;"> 19</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> File destFile;<br></span><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> startPos;<br></span><span style="color: #008080;"> 21</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 22</span> <span style="color: #008000;">     <em> æ­¤çº¿ç¨‹éœ€è¦ä¸‹è½½çš„æ•°æ®é•¿åº¦ã€‚<br></em></span><span style="color: #008080;"> 23</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 24</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> length;<br></span><span style="color: #008080;"> 25</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 26</span> <span style="color: #008000;">     <em> æ­¤çº¿ç¨‹ç°åœ¨å·²ä¸‹è½½å¥½äº†çš„æ•°æ®é•¿åº¦ã€‚<br></em></span><span style="color: #008080;"> 27</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 28</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> currentLength;<br></span><span style="color: #008080;"> 29</span><br><span style="color: #008080;"> 30</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> JFileDownloaderNotificationThread notificationThread;<br></span><span style="color: #008080;"> 31</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isRunning = <span style="color: #0000ff;">true</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 32</span><br><span style="color: #008080;"> 33</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 34</span> <span style="color: #008000;">     <em> æ„é€ æ–¹æ³•ï¼Œå¯ç”Ÿæˆé…ç½®å®Œæ•´çš„JFileDownloadThreadå¯¹è±¡<br></em></span><span style="color: #008080;"> 35</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> urlPath è¦ä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶URL<br></span><span style="color: #008080;"> 36</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> destFile è¦ä¿å­˜çš„ç›®æ ‡æ–‡ä»¶<br></span><span style="color: #008080;"> 37</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> startPos è¯¥çº¿ç¨‹éœ€è¦ä¸‹è½½ç›®æ ‡æ–‡ä»¶ç¬¬å‡ ä¸ªbyteä¹‹åçš„æ•°æ®<br></span><span style="color: #008080;"> 38</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> length è¯¥çº¿ç¨‹éœ€è¦ä¸‹è½½å¤šå°‘é•¿åº¦çš„æ•°æ®<br></span><span style="color: #008080;"> 39</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> notificationThread é€šçŸ¥è¿›åº¦çº¿ç¨‹<br></span><span style="color: #008080;"> 40</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 41</span>     <span style="color: #0000ff;">public</span> JFileDownloadThread(String urlPath, File destFile, <span style="color: #0000ff;">long</span><span style="color: #000000;"> startPos,<br></span><span style="color: #008080;"> 42</span>             <span style="color: #0000ff;">long</span><span style="color: #000000;"> length, JFileDownloaderNotificationThread notificationThread) {<br></span><span style="color: #008080;"> 43</span>         <span style="color: #0000ff;">this</span>.urlPath =<span style="color: #000000;"> urlPath;<br></span><span style="color: #008080;"> 44</span>         <span style="color: #0000ff;">this</span>.destFile =<span style="color: #000000;"> destFile;<br></span><span style="color: #008080;"> 45</span>         <span style="color: #0000ff;">this</span>.startPos =<span style="color: #000000;"> startPos;<br></span><span style="color: #008080;"> 46</span>         <span style="color: #0000ff;">this</span>.length =<span style="color: #000000;"> length;<br></span><span style="color: #008080;"> 47</span>         <span style="color: #0000ff;">this</span>.notificationThread =<span style="color: #000000;"> notificationThread;<br></span><span style="color: #008080;"> 48</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 49</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 50</span> <span style="color: #008000;">      è¯¥æ–¹æ³•å°†æ‰§è¡Œä¸‹è½½åŠŸèƒ½ï¼Œå¹¶æŠŠæ•°æ®å­˜å‚¨åœ¨ç›®æ ‡æ–‡ä»¶ä¸­çš„ç›¸åº”ä½ç½®ã€‚<br></span><span style="color: #008080;"> 51</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 52</span> <span style="color: #000000;">    @Override<br></span><span style="color: #008080;"> 53</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> run() {<br></span><span style="color: #008080;"> 54</span>         RandomAccessFile raf = <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 55</span>         HttpURLConnection conn = <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 56</span>         InputStream is = <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 57</span>         <span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br></span><span style="color: #008080;"> 58</span> <span style="color: #008000;">//</span><span style="color: #008000;">            URL url = new URL(â€œ</span><span style="color: #008000; text-decoration: underline;"><a href="http://localhost" target="_blank" rel="noopener">http://localhost</a></span><span style="color: #008000;">:8080/firstserver/files/hibernate.zipâ€);</span><br><span style="color: #008080;"> 59</span>             URL url = <span style="color: #0000ff;">new</span><span style="color: #000000;"> URL(urlPath);<br></span><span style="color: #008080;"> 60</span>             conn =<span style="color: #000000;"> (HttpURLConnection)url.openConnection();<br></span><span style="color: #008080;"> 61</span>             conn.setConnectTimeout(20  1000<span style="color: #000000;">);<br></span><span style="color: #008080;"> 62</span>             is =<span style="color: #000000;"> conn.getInputStream();<br></span><span style="color: #008080;"> 63</span>             raf = <span style="color: #0000ff;">new</span> RandomAccessFile(destFile, â€œrwâ€<span style="color: #000000;">);<br></span><span style="color: #008080;"> 64</span>             raf.setLength(conn.getContentLength()); <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®ä¿å­˜æ–‡ä»¶çš„å¤§å°<br></span><span style="color: #008080;"> 65</span> <span style="color: #008000;">//</span><span style="color: #008000;">            raf.setLength(conn.getInputStream().available());<br></span><span style="color: #008080;"> 66</span><br><span style="color: #008080;"> 67</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®è¯»å…¥å’Œå†™å…¥çš„æ–‡ä»¶ä½ç½®</span><br><span style="color: #008080;"> 68</span> <span style="color: #000000;">            is.skip(startPos);<br></span><span style="color: #008080;"> 69</span> <span style="color: #000000;">            raf.seek(startPos);<br></span><span style="color: #008080;"> 70</span><br><span style="color: #008080;"> 71</span>             currentLength = 0; <span style="color: #008000;">//</span><span style="color: #008000;"> å½“å‰å·²ä¸‹è½½å¥½çš„æ–‡ä»¶é•¿åº¦</span><br><span style="color: #008080;"> 72</span>             <span style="color: #0000ff;">byte</span>[] buffer = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">byte</span>[1024 <em> 1024<span style="color: #000000;">];<br></span><span style="color: #008080;"> 73</span>             <span style="color: #0000ff;">int</span> len = 0<span style="color: #000000;">;<br></span><span style="color: #008080;"> 74</span>             <span style="color: #0000ff;">while</span>(currentLength &lt; length &amp;&amp; -1 != (len =<span style="color: #000000;"> is.read(buffer))){<br></span><span style="color: #008080;"> 75</span>                 <span style="color: #0000ff;">if</span>(!<span style="color: #000000;">isRunning){<br></span><span style="color: #008080;"> 76</span>                     <span style="color: #0000ff;">break</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 77</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;"> 78</span>                 <span style="color: #0000ff;">if</span>(currentLength + len &gt;<span style="color: #000000;"> length){<br></span><span style="color: #008080;"> 79</span>                     raf.write(buffer, 0, (<span style="color: #0000ff;">int</span>)(length -<span style="color: #000000;"> currentLength));<br></span><span style="color: #008080;"> 80</span>                     currentLength =<span style="color: #000000;"> length;<br></span><span style="color: #008080;"> 81</span>                     notificationThread.notificationProgress(); <span style="color: #008000;">//</span><span style="color: #008000;"> é€šçŸ¥è¿›åº¦çº¿ç¨‹æ¥æ›´æ–°è¿›åº¦</span><br><span style="color: #008080;"> 82</span>                     <span style="color: #0000ff;">return</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 83</span>                 }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;"> 84</span>                     raf.write(buffer, 0<span style="color: #000000;">, len);<br></span><span style="color: #008080;"> 85</span>                     currentLength +=<span style="color: #000000;"> len;<br></span><span style="color: #008080;"> 86</span>                     notificationThread.notificationProgress(); <span style="color: #008000;">//</span><span style="color: #008000;"> é€šçŸ¥è¿›åº¦çº¿ç¨‹æ¥æ›´æ–°è¿›åº¦</span><br><span style="color: #008080;"> 87</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;"> 88</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 89</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {<br></span><span style="color: #008080;"> 90</span> <span style="color: #000000;">            e.printStackTrace();<br></span><span style="color: #008080;"> 91</span>         } <span style="color: #0000ff;">finally</span><span style="color: #000000;">{<br></span><span style="color: #008080;"> 92</span>             <span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br></span><span style="color: #008080;"> 93</span> <span style="color: #000000;">                is.close();<br></span><span style="color: #008080;"> 94</span> <span style="color: #000000;">                raf.close();<br></span><span style="color: #008080;"> 95</span> <span style="color: #000000;">                conn.disconnect();<br></span><span style="color: #008080;"> 96</span>             } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException e) {<br></span><span style="color: #008080;"> 97</span> <span style="color: #000000;">                e.printStackTrace();<br></span><span style="color: #008080;"> 98</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;"> 99</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">100</span><br><span style="color: #008080;">101</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">102</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">103</span> <span style="color: #008000;">     </span></em> å–æ¶ˆè¯¥çº¿ç¨‹ä¸‹è½½<br><span style="color: #008080;">104</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">105</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">106</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> cancelThread(){<br></span><span style="color: #008080;">107</span>         isRunning = <span style="color: #0000ff;">false</span><span style="color: #000000;">;<br></span><span style="color: #008080;">108</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">109</span><br><span style="color: #008080;">110</span><br><span style="color: #008080;">111</span> }</pre><br></div><br></div>

<p>&nbsp;</p>
<p><strong>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</strong></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> String urlPath = â€œ<a href="http://localhost:8080/firstserver/files/test.zip" target="_blank" rel="noopener">http://localhost:8080/firstserver/files/test.zip</a>â€œ<span style="color: #000000;">;<br></span><span style="color: #008080;"> 2</span> String destFilePath = â€œC:\Users\admin\Desktop\æ‚\ä¸´æ—¶ä»“åº“\test.zipâ€<span style="color: #000000;">;<br></span><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">int</span> threadCount = 3<span style="color: #000000;">;<br></span><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span> JFileDownloader downloader = <span style="color: #0000ff;">new</span><span style="color: #000000;"> JFileDownloader(urlPath, destFilePath, threadCount);<br></span><span style="color: #008080;"> 6</span> <span style="color: #008000;">//</span><span style="color: #008000;">æˆ–è€…ï¼š</span><br><span style="color: #008080;"> 7</span> JFileDownloader downloader = <span style="color: #0000ff;">new</span><span style="color: #000000;"> JFileDownloader()<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">            .setUrlPath(urlPath)<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">            .setDestFilePath(destFilePath)<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">            .setThreadCount(threadCount)<br></span><span style="color: #008080;">11</span>             .setFileDownloadListener(<span style="color: #0000ff;">new</span> JFileDownloadListener() { <span style="color: #008000;">//</span><span style="color: #008000;"> è®¾ç½®è¿›åº¦ç›‘å¬å™¨</span><br><span style="color: #008080;">12</span>                     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> downloadProgress(<span style="color: #0000ff;">int</span> progress, <span style="color: #0000ff;">double</span> speed, <span style="color: #0000ff;">long</span><span style="color: #000000;"> remainTime) {<br></span><span style="color: #008080;">13</span>                         System.out.println(â€œæ–‡ä»¶å·²ä¸‹è½½ï¼šâ€ + progress + â€œ%ï¼Œä¸‹è½½é€Ÿåº¦ä¸ºï¼šâ€ + speed + â€œkb/sï¼Œå‰©ä½™æ‰€éœ€æ—¶é—´ï¼šâ€ + remainTime + â€œæ¯«ç§’â€<span style="color: #000000;">);<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">15</span>                     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> downloadCompleted(File file, <span style="color: #0000ff;">long</span><span style="color: #000000;"> downloadTime) {<br></span><span style="color: #008080;">16</span>                         System.out.println(â€œæ–‡ä»¶ï¼šâ€ + file.getName() + â€œä¸‹è½½å®Œæˆï¼Œç”¨æ—¶ï¼šâ€ + downloadTime + â€œæ¯«ç§’â€<span style="color: #000000;">);<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">18</span> <span style="color: #000000;">            });<br></span><span style="color: #008080;">19</span>     <span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">20</span>         downloader.startDownload(); <span style="color: #008000;">//</span><span style="color: #008000;"> å¼€å§‹ä¸‹è½½</span><br><span style="color: #008080;">21</span>     } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {<br></span><span style="color: #008080;">22</span> <span style="color: #000000;">        e.printStackTrace();<br></span><span style="color: #008080;">23</span>     }</pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[[å·¥å…·åº“]JOJSONBuilderå·¥å…·ç±»â€”â€”ä¸€é”®æŠŠå¤šä¸ªbeanå¯¹è±¡æ•°æ®è½¬æ¢ä¸ºJSONæ ¼å¼æ•°æ®]]></title>
      <url>/2013/02/19/%E5%B7%A5%E5%85%B7%E5%BA%93-JOJSONBuilder%E5%B7%A5%E5%85%B7%E7%B1%BB%E2%80%94%E2%80%94%E4%B8%80%E9%94%AE%E6%8A%8A%E5%A4%9A%E4%B8%AAbean%E5%AF%B9%E8%B1%A1%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2%E4%B8%BAJSON%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE/</url>
      <content type="html"><![CDATA[<p>æœ¬äººå¤§å››å³å°†æ¯•ä¸šçš„å‡†ç¨‹åºå‘˜ï¼ˆJavaSEã€JavaEEã€androidç­‰ï¼‰ä¸€æšï¼Œå°é¡¹ç›®ä¹Ÿåšè¿‡ä¸€ç‚¹ï¼Œäºæ˜¯ä¹ä¸€æ—¶å…´èµ·å°±å†™äº†ä¸€äº›å·¥å…·ã€‚</p>
<p>æˆ‘ä¼šåœ¨æœ¬åšå®¢ä¸­é™†ç»­å‘å¸ƒä¸€äº›å¹³æ—¶å¯èƒ½ä¼šç”¨åˆ°çš„å·¥å…·ã€‚</p>
<p>ä»£ç è´¨é‡å¯èƒ½ä¸æ˜¯å¾ˆå¥½ï¼Œå¤§å®¶å¤šæ‹…å¾…ï¼</p>
<p>ä»£ç æˆ–è€…æ€è·¯æœ‰ä¸å¦¥ä¹‹å¤„ï¼Œè¿˜å¸Œæœ›å¤§ç‰›ä»¬èƒ½ä¸åèµæ•™å“ˆï¼</p>
<p>&nbsp;</p>
<p><span>ä»¥ä¸‹ä»£ç ä¸ºæœ¬äººåŸåˆ›ï¼Œè½¬è½½è¯·æ³¨æ˜ï¼š</span></p>
<p><span>æœ¬æ–‡è½¬è½½ï¼Œæ¥è‡ªï¼š<a href="http://www.cnblogs.com/tiantianbyconan/archive/2013/02/19/2917433.html" target="_blank" rel="noopener">http://www.cnblogs.com/tiantianbyconan/archive/2013/02/19/2917433.html</a></span></p>
<p>&nbsp;</p>
<p>JOJSONBuilderå·¥å…·ç±»ï¼šä¸€é”®æŠŠå¤šä¸ªåŸŸå¯¹è±¡æ•°æ®è½¬æ¢ä¸ºJSONæ ¼å¼æ•°æ®ï¼Œæ–¹ä¾¿ç”¨äºæ•°æ®çš„ä¼ è¾“å’Œäº¤äº’ã€‚åŠŸèƒ½ç±»ä¼¼äºé€šè¿‡Gsonæ¥ç”ŸæˆJsonæ•°æ®ã€‚</p>
<p><strong>æºç å¦‚ä¸‹ï¼š</strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('4379b86f-99f7-4b7d-81ce-f459e2888a57')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_4379b86f-99f7-4b7d-81ce-f459e2888a57" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.extrautil.jojsonbuilder;<br></span><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Field;<br></span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Method;<br></span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.ArrayList;<br></span><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Arrays;<br></span><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Iterator;<br></span><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br></span><span style="color: #008080;">  9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Set;<br></span><span style="color: #008080;"> 10</span><br><span style="color: #008080;"> 11</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 12</span> <span style="color: #008000;"> <em><br></em></span><span style="color: #008080;"> 13</span> <span style="color: #008000;">  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 14</span> <span style="color: #008000;"> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2013-2-14 ä¸Šåˆ10:49:59<br></span><span style="color: #008080;"> 15</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 16</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> JOJSONBuilder {<br></span><span style="color: #008080;"> 17</span>     <span style="color: #0000ff;">private</span> List&lt;?&gt; list; <span style="color: #008000;">//</span><span style="color: #008000;"> ä¼ å…¥çš„Listæ•°æ®</span><br><span style="color: #008080;"> 18</span>     <span style="color: #0000ff;">private</span> StringBuilder result = <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 19</span>     <span style="color: #0000ff;">private</span> List&lt;String&gt; includes = <span style="color: #0000ff;">null</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> è¦åŒ…å«çš„å±æ€§åˆ—è¡¨</span><br><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">private</span> List&lt;String&gt; excludes = <span style="color: #0000ff;">null</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> è¦æ’é™¤çš„å±æ€§åˆ—è¡¨</span><br><span style="color: #008080;"> 21</span><br><span style="color: #008080;"> 22</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 23</span> <span style="color: #008000;">     <em> é»˜è®¤æ„é€ æ–¹æ³•ã€‚&lt;br&gt;<br></em></span><span style="color: #008080;"> 24</span> <span style="color: #008000;">      ä½¿ç”¨æ­¤é»˜è®¤çš„æ„é€ æ–¹æ³•ä¹‹åå¿…é¡»è¦è°ƒç”¨setList()ä¼ å…¥List<br></span><span style="color: #008080;"> 25</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 26</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JOJSONBuilder() {<br></span><span style="color: #008080;"> 27</span><br><span style="color: #008080;"> 28</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 29</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 30</span> <span style="color: #008000;">      æ­¤æ„é€ æ–¹æ³•ä¼šæŠŠlistä¸­æ¯é¡¹çš„æ‰€æœ‰å±æ€§ä¿¡æ¯éƒ½ä¼šç”Ÿæˆåœ¨jsonä¸­ã€‚<br></span><span style="color: #008080;"> 31</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> list æ‰€è¦ç”ŸæˆJsonçš„Listæ•°æ®æº<br></span><span style="color: #008080;"> 32</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 33</span>     <span style="color: #0000ff;">public</span> JOJSONBuilder(List&lt;?&gt;<span style="color: #000000;"> list) {<br></span><span style="color: #008080;"> 34</span>         <span style="color: #0000ff;">this</span>.list =<span style="color: #000000;"> list;<br></span><span style="color: #008080;"> 35</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 36</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 37</span> <span style="color: #008000;">     <em> æ­¤æ„é€ æ–¹æ³•æä¾›listä¸­æ¯é¡¹å±æ€§ä¿¡æ¯çš„&lt;b&gt;åŒ…å«&lt;/b&gt;å’Œ&lt;b&gt;æ’é™¤&lt;/b&gt;ã€‚&lt;br&gt;<br></em></span><span style="color: #008080;"> 38</span> <span style="color: #008000;">      &lt;ol&gt;<br></span><span style="color: #008080;"> 39</span> <span style="color: #008000;">     <em> &lt;li&gt;ä½¿ç”¨includesï¼Œä¸ä½¿ç”¨excludesï¼šåªç”Ÿæˆåœ¨includesä¸­çš„ä¿¡æ¯&lt;br&gt;<br></em></span><span style="color: #008080;"> 40</span> <span style="color: #008000;">      &lt;li&gt;ä¸ä½¿ç”¨includesï¼Œä½¿ç”¨excludesï¼šåªç”Ÿæˆä¸åœ¨excludesä¸­çš„ä¿¡æ¯&lt;br&gt;<br></span><span style="color: #008080;"> 41</span> <span style="color: #008000;">     <em> &lt;li&gt;æ—¢ä½¿ç”¨includesï¼Œåˆä½¿ç”¨exclude(ä¸å»ºè®®)ï¼š&lt;br&gt;<br></em></span><span style="color: #008080;"> 42</span> <span style="color: #008000;">       - å¦‚æœincludesä¸­å’Œexcludesä¸­çš„ä¿¡æ¯ä¸å†²çªï¼Œåˆ™ç”Ÿæˆä¸åœ¨excludesä¸­çš„ä¿¡æ¯&lt;br&gt;<br></span><span style="color: #008080;"> 43</span> <span style="color: #008000;">     <em>  - å¦‚æœincludesä¸­å’Œexcludesä¸­çš„ä¿¡æ¯å†²çª(æŸä¸ªå±æ€§éƒ½å‡ºç°åœ¨è¿™ä¸¤ä¸ªæ•°ç»„ä¸­)ï¼Œåˆ™å†²çªéƒ¨åˆ†çš„ä¿¡æ¯è¿˜æ˜¯ä¼šç”Ÿæˆ&lt;br&gt;<br></em></span><span style="color: #008080;"> 44</span> <span style="color: #008000;">      &lt;li&gt;includeså’Œexcludeséƒ½ä¸ä½¿ç”¨ï¼Œåˆ™ä¼šæŠŠlistä¸­æ¯é¡¹çš„æ‰€æœ‰å±æ€§ä¿¡æ¯éƒ½ä¼šç”Ÿæˆåœ¨jsonä¸­<br></span><span style="color: #008080;"> 45</span> <span style="color: #008000;">     <em> &lt;/ol&gt;<br></em></span><span style="color: #008080;"> 46</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> list æ‰€è¦ç”ŸæˆJsonçš„Listæ•°æ®æºã€‚<br></span><span style="color: #008080;"> 47</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> includes æ‰€è¦åŒ…å«çš„å±æ€§åç§°æ•°ç»„ã€‚<br></span><span style="color: #008080;"> 48</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> excludes æ‰€è¦æ’é™¤çš„å±æ€§åç§°æ•°ç»„ã€‚<br></span><span style="color: #008080;"> 49</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 50</span>     <span style="color: #0000ff;">public</span> JOJSONBuilder(List&lt;?&gt;<span style="color: #000000;"> list, String[] includes, String[] excludes) {<br></span><span style="color: #008080;"> 51</span>         <span style="color: #0000ff;">this</span>.list =<span style="color: #000000;"> list;<br></span><span style="color: #008080;"> 52</span>         <span style="color: #0000ff;">this</span>.includes = <span style="color: #0000ff;">null</span> == includes || includes.length == 0 ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : Arrays.asList(includes);<br></span><span style="color: #008080;"> 53</span>         <span style="color: #0000ff;">this</span>.excludes = <span style="color: #0000ff;">null</span> == excludes || excludes.length == 0 ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : Arrays.asList(excludes);<br></span><span style="color: #008080;"> 54</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 55</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 56</span> <span style="color: #008000;">     <em> è·å¾—æ­£åœ¨è¿›è¡Œç”Ÿæˆjsonæ–‡ä»¶çš„ä¿¡æ¯æ¥æºListã€‚<br></em></span><span style="color: #008080;"> 57</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 58</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›æ­£åœ¨è¿›è¡Œç”Ÿæˆjsonæ–‡ä»¶çš„ä¿¡æ¯æ¥æºList<br></span><span style="color: #008080;"> 59</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 60</span>     <span style="color: #0000ff;">public</span> List&lt;?&gt;<span style="color: #000000;"> getList() {<br></span><span style="color: #008080;"> 61</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> list;<br></span><span style="color: #008080;"> 62</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 63</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 64</span> <span style="color: #008000;">     <em> å¯ä½¿ç”¨æ­¤æ–¹æ³•æ¥ä¼ å…¥ã€æ›¿æ¢JOJSONBuilderå¯¹è±¡ä¸­çš„Listå¯¹è±¡ã€‚<br></em></span><span style="color: #008080;"> 65</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 66</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> list æ‰€è¦ç”ŸæˆJsonçš„Listæ•°æ®æºã€‚<br></span><span style="color: #008080;"> 67</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›å½“å‰JOJSONBuilderå¯¹è±¡<br></span><span style="color: #008080;"> 68</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 69</span>     <span style="color: #0000ff;">public</span> JOJSONBuilder setList(List&lt;?&gt;<span style="color: #000000;"> list) {<br></span><span style="color: #008080;"> 70</span>         <span style="color: #0000ff;">this</span>.list =<span style="color: #000000;"> list;<br></span><span style="color: #008080;"> 71</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 72</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 73</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 74</span> <span style="color: #008000;">     <em> è®¾ç½®åŒ…å«çš„å±æ€§ä¿¡æ¯ã€‚<br></em></span><span style="color: #008080;"> 75</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 76</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> incFieldName è¦åŒ…å«çš„å±æ€§å<br></span><span style="color: #008080;"> 77</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›å½“å‰JOJSONBuilderå¯¹è±¡<br></span><span style="color: #008080;"> 78</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 79</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JOJSONBuilder setIncludes(Stringâ€¦ incFieldName) {<br></span><span style="color: #008080;"> 80</span>         <span style="color: #0000ff;">this</span>.includes = <span style="color: #0000ff;">null</span> == incFieldName || incFieldName.length == 0 ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : Arrays.asList(incFieldName);<br></span><span style="color: #008080;"> 81</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 82</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 83</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 84</span> <span style="color: #008000;">      è®¾ç½®æ’é™¤çš„å±æ€§ä¿¡æ¯ã€‚<br></span><span style="color: #008080;"> 85</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 86</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> excFieldName è¦æ’é™¤çš„å±æ€§å<br></span><span style="color: #008080;"> 87</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›å½“å‰JOJSONBuilderå¯¹è±¡<br></span><span style="color: #008080;"> 88</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 89</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JOJSONBuilder setExcludes(Stringâ€¦ excFieldName) {<br></span><span style="color: #008080;"> 90</span>         <span style="color: #0000ff;">this</span>.excludes = <span style="color: #0000ff;">null</span> == excFieldName || excFieldName.length == 0 ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : Arrays.asList(excFieldName);<br></span><span style="color: #008080;"> 91</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 92</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 93</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 94</span> <span style="color: #008000;">     <em> è·å¾—æŒ‡å®šClassç±»å‹çš„æ‰€æœ‰å±æ€§ï¼Œå¹¶æ‰“å°åœ¨æ§åˆ¶å°ä¸Šã€‚<br></em></span><span style="color: #008080;"> 95</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 96</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> clazz è¦è·å–çš„å±æ€§çš„ç±»çš„Classå¯¹è±¡ã€‚<br></span><span style="color: #008080;"> 97</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›è¯¥Classå¯¹è±¡çš„æ‰€æœ‰å±æ€§ã€‚<br></span><span style="color: #008080;"> 98</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 99</span>     <span style="color: #0000ff;">public</span> Field[] getFields(Class&lt;?&gt;<span style="color: #000000;"> clazz) {<br></span><span style="color: #008080;">100</span>         Field[] fields =<span style="color: #000000;"> clazz.getDeclaredFields();<br></span><span style="color: #008080;">101</span>         System.out.print(â€œfields of the class that named â€œ + clazz.getName() + â€œ: â€œ<span style="color: #000000;">);<br></span><span style="color: #008080;">102</span>         <span style="color: #0000ff;">for</span><span style="color: #000000;">(Field field : fields){<br></span><span style="color: #008080;">103</span>             System.out.print(field.getName() + â€œ, â€œ<span style="color: #000000;">);<br></span><span style="color: #008080;">104</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">105</span> <span style="color: #000000;">        System.out.println();<br></span><span style="color: #008080;">106</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> fields;<br></span><span style="color: #008080;">107</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">108</span><br><span style="color: #008080;">109</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">110</span> <span style="color: #008000;">     <em> æ ¹æ®listä¸­çš„å¯¹è±¡æ¥ç”Ÿæˆå¯¹åº”çš„jsonæ–‡ä»¶ã€‚<br></em></span><span style="color: #008080;">111</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">112</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›ç”Ÿæˆçš„Jsonå­—ç¬¦ä¸²ã€‚<br></span><span style="color: #008080;">113</span> <span style="color: #008000;">      </span><span style="color: #808080;">@throws</span><span style="color: #008000;"> Exception å¦‚æœListæ£€éªŒä¸é€šè¿‡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚<br></span><span style="color: #008080;">114</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;">115</span>     <span style="color: #0000ff;">public</span> StringBuilder jsonBuild() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception{<br></span><span style="color: #008080;">116</span>         <span style="color: #008000;">//</span><span style="color: #008000;">æ£€éªŒä¼ å…¥çš„Listæ˜¯å¦æœ‰æ•ˆ</span><br><span style="color: #008080;">117</span> <span style="color: #000000;">        checkValidityList();<br></span><span style="color: #008080;">118</span>         <span style="color: #008000;">//</span><span style="color: #008000;">jsonæ–‡ä»¶å¼€å§‹ç”Ÿæˆâ€”â€”â€”â€”â€”â€”â€”â€”-</span><br><span style="color: #008080;">119</span>         result = <span style="color: #0000ff;">new</span><span style="color: #000000;"> StringBuilder();<br></span><span style="color: #008080;">120</span>         jsonSubBuild(list); <span style="color: #008000;">//</span><span style="color: #008000;"> é€’å½’ç”Ÿæˆ</span><br><span style="color: #008080;">121</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> result;<br></span><span style="color: #008080;">122</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">123</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">124</span> <span style="color: #008000;">      ç”Ÿæˆjsonå¯é€’å½’éƒ¨åˆ†çš„å­æ•°æ®ï¼ˆæ ¹æ®æŸäº›å¯¹è±¡ç»„æˆçš„Listæ¥ç”Ÿæˆå±æ€§jsonæ–‡ä»¶ï¼‰<br></span><span style="color: #008080;">125</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">126</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> list<br></span><span style="color: #008080;">127</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;">128</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> jsonSubBuild(List&lt;?&gt;<span style="color: #000000;"> list){<br></span><span style="color: #008080;">129</span> <span style="color: #008000;">//</span><span style="color: #008000;">        Class&lt;?&gt; clazz = list.get(0).getClass(); </span><span style="color: #008000;">//</span><span style="color: #008000;"> è·å–å¯¹åº”çš„Classå¯¹è±¡</span><br><span style="color: #008080;">130</span>         Object curObj = <span style="color: #0000ff;">null</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯æ¬¡å¾ªç¯å½“å‰çš„ç±»å¯¹è±¡ï¼ˆèµ„æºï¼‰</span><br><span style="color: #008080;">131</span>         <span style="color: #0000ff;">int</span> listLength = list.size(); <span style="color: #008000;">//</span><span style="color: #008000;"> ç±»å¯¹è±¡ä¸ªæ•°<br></span><span style="color: #008080;">132</span> <span style="color: #008000;">//</span><span style="color: #008000;">        String simpleName = clazz.getSimpleName(); </span><span style="color: #008000;">//</span><span style="color: #008000;"> è·å–ç±»åï¼ˆä¸å«åŒ…åï¼‰</span><br><span style="color: #008080;">133</span><br><span style="color: #008080;">134</span>         result.append(â€œ[â€œ); <span style="color: #008000;">//</span><span style="color: #008000;"> æ ¹æ ‡ç­¾å¼€å§‹</span><br><span style="color: #008080;">135</span><br><span style="color: #008080;">136</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 0; i &lt; listLength; i++<span style="color: #000000;">){<br></span><span style="color: #008080;">137</span>             <span style="color: #0000ff;">if</span>(i != 0<span style="color: #000000;">){<br></span><span style="color: #008080;">138</span>                 result.append(â€œ,â€<span style="color: #000000;">);<br></span><span style="color: #008080;">139</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">140</span>             curObj =<span style="color: #000000;"> list.get(i);<br></span><span style="color: #008080;">141</span>             jsonSubSubBuild(curObj, list); <span style="color: #008000;">//</span><span style="color: #008000;"> å­æ•°æ®é€’å½’</span><br><span style="color: #008080;">142</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">143</span><br><span style="color: #008080;">144</span>         result.append(â€œ]â€); <span style="color: #008000;">//</span><span style="color: #008000;"> æ ¹æ ‡ç­¾ç»“æŸ</span><br><span style="color: #008080;">145</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">146</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">147</span> <span style="color: #008000;">      ç”Ÿæˆjsonå¯é€’å½’éƒ¨åˆ†çš„å­å­æ•°æ®ï¼ˆæ ¹æ®æŸä¸ªå¯¹è±¡æ¥ç”Ÿæˆå±æ€§jsonæ–‡ä»¶ï¼‰<br></span><span style="color: #008080;">148</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">149</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> curObj è¦ç”Ÿæˆjsonæ–‡ä»¶çš„é‚£ä¸ªå¯¹è±¡<br></span><span style="color: #008080;">150</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> list curObjå‚æ•°å±äºçš„é‚£ä¸ªList<br></span><span style="color: #008080;">151</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">152</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> jsonSubSubBuild(Object curObj, List&lt;?&gt;<span style="color: #000000;"> list){<br></span><span style="color: #008080;">153</span>         String fieldName = â€œâ€; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯æ¬¡è¦è°ƒç”¨çš„å±æ€§å</span><br><span style="color: #008080;">154</span>         String methodName = â€œâ€; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯æ¬¡è¦è°ƒç”¨çš„æ–¹æ³•å</span><br><span style="color: #008080;">155</span>         Method method = <span style="color: #0000ff;">null</span>;; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯æ¬¡è¦è°ƒç”¨çš„æ–¹æ³•</span><br><span style="color: #008080;">156</span>         Object value = â€œâ€; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯æ¬¡è¦è·å¾—çš„å±æ€§å€¼ï¼ˆå­æ ‡ç­¾ï¼‰</span><br><span style="color: #008080;">157</span><br><span style="color: #008080;">158</span>         Class&lt;?&gt; clazz =<span style="color: #000000;"> curObj.getClass();<br></span><span style="color: #008080;">159</span>         Field[] fields = getFields(clazz); <span style="color: #008000;">//</span><span style="color: #008000;"> è·å¾—å¯¹åº”ç±»å‹çš„æ‰€æœ‰å˜é‡</span><br><span style="color: #008080;">160</span>         <span style="color: #0000ff;">int</span> fieldsLength = fields.length; <span style="color: #008000;">//</span><span style="color: #008000;"> ç±»å¯¹è±¡çš„å±æ€§æ•°é‡</span><br><span style="color: #008080;">161</span><br><span style="color: #008080;">162</span>         result.append(â€œ{â€œ<span style="color: #000000;">);<br></span><span style="color: #008080;">163</span>         <span style="color: #0000ff;">int</span> offset = 0; <span style="color: #008000;">//</span><span style="color: #008000;"> åŒ…å«çš„ç¬¬ä¸€ä¸ªå±æ€§åç§»é‡</span><br><span style="color: #008080;">164</span>         <span style="color: #0000ff;">int</span> temp = 0<span style="color: #000000;">;<br></span><span style="color: #008080;">165</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j = 0; j &lt; fieldsLength; j++<span style="color: #000000;">){<br></span><span style="color: #008080;">166</span>             fieldName = fields[j].getName(); <span style="color: #008000;">//</span><span style="color: #008000;"> è·å–å¯¹åº”å±æ€§å</span><br><span style="color: #008080;">167</span><br><span style="color: #008080;">168</span>             <span style="color: #0000ff;">if</span>(list == <span style="color: #0000ff;">this</span>.list){ <span style="color: #008000;">//</span><span style="color: #008000;"> åªåœ¨æœ€å¤–å±‚çš„ç±»çš„å±æ€§ä¸­è¿›è¡Œæ’é™¤åŒ…å«<br></span><span style="color: #008080;">169</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> ä½¿ç”¨includesï¼Œä¸ä½¿ç”¨excludesï¼šåªç”Ÿæˆåœ¨includesä¸­çš„ä¿¡æ¯</span><br><span style="color: #008080;">170</span>                 <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> != includes &amp;&amp; <span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> excludes){<br></span><span style="color: #008080;">171</span>                     <span style="color: #0000ff;">if</span>(!<span style="color: #000000;">includes.contains(fieldName)){<br></span><span style="color: #008080;">172</span>                         <span style="color: #0000ff;">continue</span><span style="color: #000000;">;<br></span><span style="color: #008080;">173</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">174</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">175</span><br><span style="color: #008080;">176</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">ä¸ä½¿ç”¨includesï¼Œä½¿ç”¨excludesï¼šåªç”Ÿæˆä¸åœ¨excludesä¸­çš„ä¿¡æ¯</span><br><span style="color: #008080;">177</span>                 <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> == includes &amp;&amp; <span style="color: #0000ff;">null</span> != excludes){ <span style="color: #008000;">//</span><span style="color: #008000;"> åªä½¿ç”¨äº†ä¸åŒ…å«</span><br><span style="color: #008080;">178</span>                     <span style="color: #0000ff;">if</span><span style="color: #000000;">(excludes.contains(fieldName)){<br></span><span style="color: #008080;">179</span>                         <span style="color: #0000ff;">continue</span><span style="color: #000000;">;<br></span><span style="color: #008080;">180</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">181</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">182</span><br><span style="color: #008080;">183</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">æ—¢ä½¿ç”¨includesï¼Œåˆä½¿ç”¨exclude(ä¸å»ºè®®)ï¼š<br></span><span style="color: #008080;">184</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">- å¦‚æœincludesä¸­å’Œexcludesä¸­çš„ä¿¡æ¯ä¸å†²çªï¼Œåˆ™ç”Ÿæˆä¸åœ¨excludesä¸­çš„ä¿¡æ¯<br></span><span style="color: #008080;">185</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">- å¦‚æœincludesä¸­å’Œexcludesä¸­çš„ä¿¡æ¯å†²çª(æŸä¸ªå±æ€§éƒ½å‡ºç°åœ¨è¿™ä¸¤ä¸ªæ•°ç»„ä¸­)ï¼Œåˆ™å†²çªéƒ¨åˆ†çš„ä¿¡æ¯è¿˜æ˜¯ä¼šç”Ÿæˆ</span><br><span style="color: #008080;">186</span>                 <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> != includes &amp;&amp; <span style="color: #0000ff;">null</span> != excludes){ <span style="color: #008000;">//</span><span style="color: #008000;"> æ—¢ä½¿ç”¨äº†åŒ…å«ï¼Œåˆä½¿ç”¨äº†ä¸åŒ…å«</span><br><span style="color: #008080;">187</span>                     <span style="color: #0000ff;">if</span>(!includes.contains(fieldName) &amp;&amp;<span style="color: #000000;"> excludes.contains(fieldName)){<br></span><span style="color: #008080;">188</span>                         <span style="color: #0000ff;">continue</span><span style="color: #000000;">;<br></span><span style="color: #008080;">189</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">190</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">191</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> è®°å½•ç¬¬ä¸€ä¸ªåŒ…å«çš„å±æ€§çš„ç´¢å¼•</span><br><span style="color: #008080;">192</span>                 <span style="color: #0000ff;">if</span>(0 ==<span style="color: #000000;"> temp){<br></span><span style="color: #008080;">193</span>                     offset =<span style="color: #000000;"> j;<br></span><span style="color: #008080;">194</span>                     temp++<span style="color: #000000;">;<br></span><span style="color: #008080;">195</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">196</span> <span style="color: #008000;">//</span><span style="color: #008000;">                offset = 0 == temp++ ? j : 0;</span><br><span style="color: #008080;">197</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">198</span><br><span style="color: #008080;">199</span>             methodName =<span style="color: #000000;"> getGetterMethodNameByFieldName(fields[j]);<br></span><span style="color: #008080;">200</span>             <span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">201</span>                 method = clazz.getDeclaredMethod(methodName, <span style="color: #0000ff;">new</span><span style="color: #000000;"> Class[]{});<br></span><span style="color: #008080;">202</span>                 method.setAccessible(<span style="color: #0000ff;">true</span><span style="color: #000000;">);<br></span><span style="color: #008080;">203</span>                 value = method.invoke(curObj, <span style="color: #0000ff;">new</span><span style="color: #000000;"> Object[]{});<br></span><span style="color: #008080;">204</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></span><br><span style="color: #008080;">205</span>                 <span style="color: #0000ff;">if</span>(j != offset){ <span style="color: #008000;">//</span><span style="color: #008000;"> ç¬¬ä¸€ä¸ªå±æ€§å‰é¢ä¸åŠ â€,â€</span><br><span style="color: #008080;">206</span>                     result.append(â€œ,â€<span style="color: #000000;">);<br></span><span style="color: #008080;">207</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">208</span>                 result.append(â€œâ€˜â€œ + fieldName + â€œâ€˜:â€<span style="color: #000000;">);<br></span><span style="color: #008080;">209</span>                 <span style="color: #0000ff;">if</span>(fields[j].getType() == List.<span style="color: #0000ff;">class</span>){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœå±æ€§æ˜¯Listç±»å‹</span><br><span style="color: #008080;">210</span>                     List&lt;?&gt; subList = (List&lt;?&gt;<span style="color: #000000;">)value;<br></span><span style="color: #008080;">211</span>                     jsonSubBuild(subList); <span style="color: #008000;">//</span><span style="color: #008000;"> å­æ•°æ®é€’å½’</span><br><span style="color: #008080;">212</span>                 }<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(fields[j].getType() == Set.<span style="color: #0000ff;">class</span>){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœå±æ€§æ˜¯Setç±»å‹çš„</span><br><span style="color: #008080;">213</span>                     Set&lt;?&gt; subSet = (Set&lt;?&gt;<span style="color: #000000;">)value;<br></span><span style="color: #008080;">214</span>                     Iterator&lt;?&gt; iter =<span style="color: #000000;"> subSet.iterator();<br></span><span style="color: #008080;">215</span>                     List&lt;Object&gt; subList = <span style="color: #0000ff;">new</span> ArrayList&lt;Object&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">216</span>                     <span style="color: #0000ff;">while</span><span style="color: #000000;">(iter.hasNext()){<br></span><span style="color: #008080;">217</span> <span style="color: #000000;">                        subList.add(iter.next());<br></span><span style="color: #008080;">218</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">219</span>                     jsonSubBuild(subList); <span style="color: #008000;">//</span><span style="color: #008000;"> å­æ•°æ®é€’å½’</span><br><span style="color: #008080;">220</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">221</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœClassLoaderä¸æ˜¯nullè¡¨ç¤ºè¯¥ç±»ä¸æ˜¯å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½çš„ï¼Œä¸æ˜¯Java APIçš„ç±»ï¼Œæ˜¯è‡ªå·±å†™çš„javaç±»</span><br><span style="color: #008080;">222</span>                 <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> fields[j].getType().getClassLoader()){<br></span><span style="color: #008080;">223</span>                     jsonSubSubBuild(value, <span style="color: #0000ff;">null</span>); <span style="color: #008000;">//</span><span style="color: #008000;"> å­å­æ•°æ®é€’å½’</span><br><span style="color: #008080;">224</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">225</span>                 <span style="color: #0000ff;">else</span>{ <span style="color: #008000;">//</span><span style="color: #008000;"> å…¶å®ƒç±»å‹éƒ½è®¤ä¸ºæ˜¯æ™®é€šæ–‡æœ¬ç±»å‹<br></span><span style="color: #008080;">226</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> æ·»åŠ å­å…ƒç´ ï¼ˆç±»å±æ€§ï¼‰æ ‡ç­¾</span><br><span style="color: #008080;">227</span>                     <span style="color: #0000ff;">if</span>(value.getClass() == String.<span style="color: #0000ff;">class</span><span style="color: #000000;">){<br></span><span style="color: #008080;">228</span>                         result.append(â€œâ€˜â€œ + value + â€œâ€˜â€œ<span style="color: #000000;">);<br></span><span style="color: #008080;">229</span>                     }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;">230</span> <span style="color: #000000;">                        result.append(value.toString());<br></span><span style="color: #008080;">231</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">232</span><br><span style="color: #008080;">233</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">234</span><br><span style="color: #008080;">235</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></span><br><span style="color: #008080;">236</span>             } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {<br></span><span style="color: #008080;">237</span> <span style="color: #000000;">                e.printStackTrace();<br></span><span style="color: #008080;">238</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">239</span><br><span style="color: #008080;">240</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">241</span>         result.append(â€œ}â€<span style="color: #000000;">);<br></span><span style="color: #008080;">242</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">243</span><br><span style="color: #008080;">244</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">245</span> <span style="color: #008000;">     <em> &lt;ol&gt;é€šè¿‡å±æ€§Fieldå¯¹è±¡æ¥è·å–getteræ–¹æ³•çš„æ–¹æ³•åã€‚&lt;br&gt;<br></em></span><span style="color: #008080;">246</span> <span style="color: #008000;">      å¦‚æœæ˜¯booleanæˆ–Booleanç±»å‹(æ­£åˆ™è¡¨è¾¾å¼æ¥åˆ¤æ–­):isBorrowâ€“&gt;isBorrow();isborrowâ€“&gt;isIsborrow();&lt;br&gt;<br></span><span style="color: #008080;">247</span> <span style="color: #008000;">     <em> å¦åˆ™:borrowâ€“&gt;getBorrow();<br></em></span><span style="color: #008080;">248</span> <span style="color: #008000;">      &lt;/ol&gt;<br></span><span style="color: #008080;">249</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">250</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> field è¦ç”Ÿæˆgetteræ–¹æ³•çš„å¯¹åº”å±æ€§å¯¹è±¡ã€‚<br></span><span style="color: #008080;">251</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›getteræ–¹æ³•çš„æ–¹æ³•åã€‚<br></span><span style="color: #008080;">252</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">253</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String getGetterMethodNameByFieldName(Field field){<br></span><span style="color: #008080;">254</span>         String methodName = <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;">255</span>         String fieldName =<span style="color: #000000;"> field.getName();<br></span><span style="color: #008080;">256</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è§£æå±æ€§å¯¹åº”çš„getteræ–¹æ³•å<br></span><span style="color: #008080;">257</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> åˆ¤æ–­æ˜¯å¦æ˜¯booleanæˆ–Booleanç±»å‹:isBorrowâ€“&gt;isBorrow();isborrowâ€“&gt;isIsborrow()</span><br><span style="color: #008080;">258</span>         <span style="color: #0000ff;">if</span>(field.getType() == <span style="color: #0000ff;">boolean</span>.<span style="color: #0000ff;">class</span> || field.getType() == Boolean.<span style="color: #0000ff;">class</span><span style="color: #000000;">){<br></span><span style="color: #008080;">259</span>             <span style="color: #0000ff;">if</span>(fieldName.matches(â€œ^is[A-Z].*â€<span style="color: #000000;">)){<br></span><span style="color: #008080;">260</span>                 methodName =<span style="color: #000000;"> fieldName;<br></span><span style="color: #008080;">261</span>             }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;">262</span>                 methodName = â€œisâ€ + fieldName.substring(0, 1).toUpperCase() + fieldName.substring(1<span style="color: #000000;">);<br></span><span style="color: #008080;">263</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">264</span>         }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;">265</span>             methodName = â€œgetâ€ + fieldName.substring(0, 1).toUpperCase() + fieldName.substring(1<span style="color: #000000;">);<br></span><span style="color: #008080;">266</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">267</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> methodName;<br></span><span style="color: #008080;">268</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">269</span><br><span style="color: #008080;">270</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">271</span> <span style="color: #008000;">     <em> æ£€éªŒä¼ å…¥çš„Listçš„åˆæ³•æ€§ï¼ˆListæ˜¯ä¸æ˜¯ä¸ºnullã€é•¿åº¦æ˜¯ä¸æ˜¯ä¸º0ã€æ˜¯ä¸æ˜¯æ¯é¡¹éƒ½æ˜¯åŒä¸€ä¸ªç±»å‹ï¼‰<br></em></span><span style="color: #008080;">272</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">273</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@throws</span><span style="color: #008000;"> Exception å¦‚æœListä¸ºnull, æˆ–è€…é•¿åº¦ä¸º, æˆ–è€…æ¯é¡¹ä¸æ˜¯åŒä¸€ä¸ªç±»å‹, æŠ›å‡ºå¼‚å¸¸<br></span><span style="color: #008080;">274</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">275</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> checkValidityList() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception{<br></span><span style="color: #008080;">276</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> list){<br></span><span style="color: #008080;">277</span>             <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œè¯·ä¿è¯ä¼ å…¥çš„Listä¸ä¸ºnullâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">278</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">279</span>         <span style="color: #0000ff;">int</span> size =<span style="color: #000000;"> list.size();<br></span><span style="color: #008080;">280</span>         <span style="color: #0000ff;">if</span>(list.size() == 0<span style="color: #000000;">){<br></span><span style="color: #008080;">281</span>             <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œè¯·ä¿è¯ä¼ å…¥çš„Listé•¿åº¦ä¸ä¸º0â€<span style="color: #000000;">);<br></span><span style="color: #008080;">282</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">283</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 1; i &lt; size; i++<span style="color: #000000;">){<br></span><span style="color: #008080;">284</span>             <span style="color: #0000ff;">if</span>(list.get(0).getClass() !=<span style="color: #000000;"> list.get(i).getClass()){<br></span><span style="color: #008080;">285</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œè¯·ä¿è¯ä¼ å…¥çš„Listæ¯é¡¹éƒ½æ˜¯åŒä¸€ä¸ªç±»å‹â€<span style="color: #000000;">);<br></span><span style="color: #008080;">286</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">287</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">288</span><br><span style="color: #008080;">289</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">290</span><br><span style="color: #008080;">291</span><br><span style="color: #008080;">292</span><br><span style="color: #008080;">293</span> }</pre><br></div><br></div>

<p>&nbsp;</p>
<p><strong>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</strong></p>
<p>ä¾‹å¦‚:<br><strong>Studentç±»</strong>(è¯¥ç±»æœ‰å±æ€§nameï¼Œageï¼ŒisBoyï¼Œbooksç­‰å±æ€§ï¼›å…¶ä¸­bookså±æ€§æ˜¯ä¸€ä¸ªListï¼Œå­˜æ”¾Bookå¯¹è±¡)ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br></span><span style="color: #008080;">2</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> age;<br></span><span style="color: #008080;">3</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isBoy;<br></span><span style="color: #008080;">4</span> <span style="color: #0000ff;">private</span> List&lt;Book&gt;<span style="color: #000000;"> books;<br></span><span style="color: #008080;">5</span> <span style="color: #008000;">//</span><span style="color: #008000;">å¹¶å®ç°getterå’Œsetteræ–¹æ³•ï¼›</span></pre><br></div>

<p>&nbsp;</p>
<p><strong>Bookç±»</strong>(è¯¥ç±»æœ‰å±æ€§nameï¼Œauthorï¼Œnumberï¼Œlengthï¼Œwidthï¼ŒisBorrowedç­‰å±æ€§)ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br></span><span style="color: #008080;">2</span> <span style="color: #0000ff;">private</span><span style="color: #000000;"> String author;<br></span><span style="color: #008080;">3</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> number;<br></span><span style="color: #008080;">4</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">float</span><span style="color: #000000;"> length;<br></span><span style="color: #008080;">5</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">float</span><span style="color: #000000;"> width;<br></span><span style="color: #008080;">6</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isBorrowed;<br></span><span style="color: #008080;">7</span> <span style="color: #008000;">//</span><span style="color: #008000;">å¹¶å®ç°getterå’Œsetteræ–¹æ³•ï¼›</span></pre><br></div>

<p>&nbsp;</p>
<p>ç°åœ¨æœ‰ä¸€ä¸ªList&lt;Student&gt;ç±»å‹çš„æ•°æ®ï¼Œé€šè¿‡ä»¥ä¸‹ä»£ç æŠŠè¯¥Listè½¬æ¢ä¸ºJsonï¼š</p>
<div class="cnblogs_code"><br><pre>List&lt;Student&gt; list = <span style="color: #0000ff;">new</span> ArrayList&lt;Student&gt;<span style="color: #000000;">();<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;">æ„å»ºå‡ ä¸ªStudentå¯¹è±¡ï¼Œæ”¾å…¥listä¸­<br></span><span style="color: #008000;">//</span><span style="color: #008000;">&hellip;&hellip;<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;">å®Œæ•´æ•°æ®ç‰ˆï¼ˆä¸ä½¿ç”¨includeså’Œexcludesï¼‰</span><br>JOJSONBuilder jsonBuilder = <span style="color: #0000ff;">new</span><span style="color: #000000;"> JOJSONBuilder(list);<br>String content </span>=<span style="color: #000000;"> jsonBuilder.jsonBuild().toString();<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;">æˆ–è€…ä½¿ç”¨åŒ…æ‹¬/æ’é™¤ï¼š</span><br>JOJSONBuilder jsonBuilder = <span style="color: #0000ff;">new</span> JOJSONBuilder(list, <span style="color: #0000ff;">new</span> String[]{â€œnameâ€, â€œageâ€}, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br>jsonBuilder.jsonBuild().toString();<br><br></span><span style="color: #008000;">//</span><span style="color: #008000;">æˆ–è€…ä½¿ç”¨æ–¹æ³•é“¾é£æ ¼ï¼š</span><br><span style="color: #0000ff;">new</span> JOJSONBuilder().setExcludes(â€œnameâ€, â€œageâ€).jsonBuild().toString();</pre><br></div>

<p>&nbsp;</p>
<p><span>è½¬æ¢ä¹‹åçš„Jsonï¼ˆå®Œæ•´æ•°æ®ç‰ˆï¼ˆä¸ä½¿ç”¨includeså’Œexcludesï¼‰ï¼‰ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">[<br></span><span style="color: #008080;"> 2</span> <span style="color: #000000;">        {<br></span><span style="color: #008080;"> 3</span> <span style="color: #000000;">                â€˜nameâ€™:â€™helloâ€™,<br></span><span style="color: #008080;"> 4</span> <span style="color: #000000;">                â€˜ageâ€™:23,<br></span><span style="color: #008080;"> 5</span> <span style="color: #000000;">                â€˜isBoyâ€™:true,<br></span><span style="color: #008080;"> 6</span> <span style="color: #000000;">                â€˜booksâ€™:[<br></span><span style="color: #008080;"> 7</span> <span style="color: #000000;">                                        {<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">                                                â€˜nameâ€™:â€™book1â€™,<br></span><span style="color: #008080;"> 9</span> <span style="color: #000000;">                                                â€˜authorâ€™:â€™author1â€™,<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">                                                â€˜numberâ€™:123,<br></span><span style="color: #008080;">11</span> <span style="color: #000000;">                                                â€˜lengthâ€™:23.5,<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">                                                â€˜widthâ€™:18.0,<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">                                                â€˜isBorrowedâ€™:true<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">                                        },<br></span><span style="color: #008080;">15</span> <span style="color: #000000;">                                        {<br></span><span style="color: #008080;">16</span> <span style="color: #000000;">                                                â€˜nameâ€™:â€™book2â€™,<br></span><span style="color: #008080;">17</span> <span style="color: #000000;">                                                â€˜authorâ€™:â€™author2â€™,<br></span><span style="color: #008080;">18</span> <span style="color: #000000;">                                                â€˜numberâ€™:43,<br></span><span style="color: #008080;">19</span> <span style="color: #000000;">                                                â€˜lengthâ€™:42.23,<br></span><span style="color: #008080;">20</span> <span style="color: #000000;">                                                â€˜widthâ€™:30.57,<br></span><span style="color: #008080;">21</span> <span style="color: #000000;">                                                â€˜isBorrowedâ€™:false<br></span><span style="color: #008080;">22</span> <span style="color: #000000;">                                        }<br></span><span style="color: #008080;">23</span> <span style="color: #000000;">                                ]<br></span><span style="color: #008080;">24</span> <span style="color: #000000;">        },<br></span><span style="color: #008080;">25</span><br><span style="color: #008080;">26</span> <span style="color: #000000;">        {<br></span><span style="color: #008080;">27</span> <span style="color: #000000;">                â€˜nameâ€™:â€™worldâ€™,<br></span><span style="color: #008080;">28</span> <span style="color: #000000;">                â€˜ageâ€™:22,<br></span><span style="color: #008080;">29</span> <span style="color: #000000;">                â€˜isBoyâ€™:false,<br></span><span style="color: #008080;">30</span> <span style="color: #000000;">                â€˜booksâ€™:[<br></span><span style="color: #008080;">31</span> <span style="color: #000000;">                                        {<br></span><span style="color: #008080;">32</span> <span style="color: #000000;">                                                â€˜nameâ€™:â€™book1â€™,<br></span><span style="color: #008080;">33</span> <span style="color: #000000;">                                                â€˜authorâ€™:â€™author1â€™,<br></span><span style="color: #008080;">34</span> <span style="color: #000000;">                                                â€˜numberâ€™:123,<br></span><span style="color: #008080;">35</span> <span style="color: #000000;">                                                â€˜lengthâ€™:23.5,<br></span><span style="color: #008080;">36</span> <span style="color: #000000;">                                                â€˜widthâ€™:18.0,<br></span><span style="color: #008080;">37</span> <span style="color: #000000;">                                                â€˜isBorrowedâ€™:true<br></span><span style="color: #008080;">38</span> <span style="color: #000000;">                                        },<br></span><span style="color: #008080;">39</span> <span style="color: #000000;">                                        {<br></span><span style="color: #008080;">40</span> <span style="color: #000000;">                                                â€˜nameâ€™:â€™book3â€™,<br></span><span style="color: #008080;">41</span> <span style="color: #000000;">                                                â€˜authorâ€™:â€™author3â€™,<br></span><span style="color: #008080;">42</span> <span style="color: #000000;">                                                â€˜numberâ€™:875,<br></span><span style="color: #008080;">43</span> <span style="color: #000000;">                                                â€˜lengthâ€™:20.59,<br></span><span style="color: #008080;">44</span> <span style="color: #000000;">                                                â€˜widthâ€™:15.08,<br></span><span style="color: #008080;">45</span> <span style="color: #000000;">                                                â€˜isBorrowedâ€™:false<br></span><span style="color: #008080;">46</span> <span style="color: #000000;">                                        },<br></span><span style="color: #008080;">47</span> <span style="color: #000000;">                                        {<br></span><span style="color: #008080;">48</span> <span style="color: #000000;">                                                â€˜nameâ€™:â€™book4â€™,<br></span><span style="color: #008080;">49</span> <span style="color: #000000;">                                                â€˜authorâ€™:â€™author4â€™,<br></span><span style="color: #008080;">50</span> <span style="color: #000000;">                                                â€˜numberâ€™:165,<br></span><span style="color: #008080;">51</span> <span style="color: #000000;">                                                â€˜lengthâ€™:22.75,<br></span><span style="color: #008080;">52</span> <span style="color: #000000;">                                                â€˜widthâ€™:19.61,<br></span><span style="color: #008080;">53</span> <span style="color: #000000;">                                                â€˜isBorrowedâ€™:true<br></span><span style="color: #008080;">54</span> <span style="color: #000000;">                                        }<br></span><span style="color: #008080;">55</span> <span style="color: #000000;">                                ]<br></span><span style="color: #008080;">56</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">57</span> ]</pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[[å·¥å…·åº“]JOXMLBuilderå·¥å…·ç±»â€”â€”ä¸€é”®æŠŠå¤šä¸ªbeanå¯¹è±¡æ•°æ®è½¬æ¢ä¸ºXMLæ ¼å¼æ•°æ®]]></title>
      <url>/2013/02/19/%E5%B7%A5%E5%85%B7%E5%BA%93-JOXMLBuilder%E5%B7%A5%E5%85%B7%E7%B1%BB%E2%80%94%E2%80%94%E4%B8%80%E9%94%AE%E6%8A%8A%E5%A4%9A%E4%B8%AAbean%E5%AF%B9%E8%B1%A1%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2%E4%B8%BAXML%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE/</url>
      <content type="html"><![CDATA[<p>æœ¬äººå¤§å››å³å°†æ¯•ä¸šçš„å‡†ç¨‹åºå‘˜ï¼ˆJavaSEã€JavaEEã€androidç­‰ï¼‰ä¸€æšï¼Œå°é¡¹ç›®ä¹Ÿåšè¿‡ä¸€ç‚¹ï¼Œäºæ˜¯ä¹ä¸€æ—¶å…´èµ·å°±å†™äº†ä¸€äº›å·¥å…·ã€‚</p>
<p>æˆ‘ä¼šåœ¨æœ¬åšå®¢ä¸­é™†ç»­å‘å¸ƒä¸€äº›å¹³æ—¶å¯èƒ½ä¼šç”¨åˆ°çš„å·¥å…·ã€‚</p>
<p>ä»£ç è´¨é‡å¯èƒ½ä¸æ˜¯å¾ˆå¥½ï¼Œå¤§å®¶å¤šæ‹…å¾…ï¼</p>
<p>ä»£ç æˆ–è€…æ€è·¯æœ‰ä¸å¦¥ä¹‹å¤„ï¼Œè¿˜å¸Œæœ›å¤§ç‰›ä»¬èƒ½ä¸åèµæ•™å“ˆï¼</p>
<p>&nbsp;</p>
<p><span style="color: #993300;">ä»¥ä¸‹ä»£ç ä¸ºæœ¬äººåŸåˆ›ï¼Œè½¬è½½è¯·æ³¨æ˜ï¼š</span></p>
<p><span style="color: #993300;">æœ¬æ–‡è½¬è½½ï¼Œæ¥è‡ªï¼š<a href="http://www.cnblogs.com/tiantianbyconan/archive/2013/02/19/2917398.html" target="_blank" rel="noopener"><span style="color: #993300;">http://www.cnblogs.com/tiantianbyconan/archive/2013/02/19/2917398.html</span></a></span></p>
<p>&nbsp;</p>
<p>JOXMLBuilderå·¥å…·ç±»ï¼šä¸€é”®æŠŠå¤šä¸ªåŸŸå¯¹è±¡æ•°æ®è½¬æ¢ä¸ºXMLæ ¼å¼æ•°æ®ï¼Œæ–¹ä¾¿ç”¨äºæ•°æ®çš„ä¼ è¾“å’Œäº¤äº’ã€‚åŠŸèƒ½ç±»ä¼¼äºé€šè¿‡Gsonæ¥ç”ŸæˆJsonæ•°æ®ã€‚</p>
<p><strong>æºç å¦‚ä¸‹ï¼š</strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('4af7ec8c-18bf-4351-8053-b1c90a923182')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_4af7ec8c-18bf-4351-8053-b1c90a923182" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.wangjie.extrautil.joxmlbuilder;<br></span><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Field;<br></span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.lang.reflect.Method;<br></span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.ArrayList;<br></span><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Arrays;<br></span><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Iterator;<br></span><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;<br></span><span style="color: #008080;">  9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Set;<br></span><span style="color: #008080;"> 10</span><br><span style="color: #008080;"> 11</span> <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 12</span> <span style="color: #008000;"> <em><br></em></span><span style="color: #008080;"> 13</span> <span style="color: #008000;">  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 14</span> <span style="color: #008000;"> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2013-2-3 ä¸‹åˆ3:49:59<br></span><span style="color: #008080;"> 15</span>  <span style="color: #008000;">/</span><br><span style="color: #008080;"> 16</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> JOXMLBuilder {<br></span><span style="color: #008080;"> 17</span>     <span style="color: #0000ff;">private</span> List&lt;?&gt; list; <span style="color: #008000;">//</span><span style="color: #008000;"> ä¼ å…¥çš„Listæ•°æ®</span><br><span style="color: #008080;"> 18</span>     <span style="color: #0000ff;">private</span> StringBuilder result = <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 19</span>     <span style="color: #0000ff;">private</span> List&lt;String&gt; includes = <span style="color: #0000ff;">null</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> è¦åŒ…å«çš„å±æ€§åˆ—è¡¨</span><br><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">private</span> List&lt;String&gt; excludes = <span style="color: #0000ff;">null</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> è¦æ’é™¤çš„å±æ€§åˆ—è¡¨</span><br><span style="color: #008080;"> 21</span><br><span style="color: #008080;"> 22</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 23</span> <span style="color: #008000;">     <em> é»˜è®¤æ„é€ æ–¹æ³•ã€‚&lt;br&gt;<br></em></span><span style="color: #008080;"> 24</span> <span style="color: #008000;">      ä½¿ç”¨æ­¤é»˜è®¤çš„æ„é€ æ–¹æ³•ä¹‹åå¿…é¡»è¦è°ƒç”¨setList()ä¼ å…¥List<br></span><span style="color: #008080;"> 25</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 26</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JOXMLBuilder() {<br></span><span style="color: #008080;"> 27</span><br><span style="color: #008080;"> 28</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 29</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 30</span> <span style="color: #008000;">      æ­¤æ„é€ æ–¹æ³•ä¼šæŠŠlistä¸­æ¯é¡¹çš„æ‰€æœ‰å±æ€§ä¿¡æ¯éƒ½ä¼šç”Ÿæˆåœ¨xmlä¸­ã€‚<br></span><span style="color: #008080;"> 31</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> list æ‰€è¦ç”Ÿæˆxmlçš„Listæ•°æ®æºã€‚<br></span><span style="color: #008080;"> 32</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 33</span>     <span style="color: #0000ff;">public</span> JOXMLBuilder(List&lt;?&gt;<span style="color: #000000;"> list) {<br></span><span style="color: #008080;"> 34</span>         <span style="color: #0000ff;">this</span>.list =<span style="color: #000000;"> list;<br></span><span style="color: #008080;"> 35</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 36</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 37</span> <span style="color: #008000;">     <em> æ­¤æ„é€ æ–¹æ³•æä¾›listä¸­æ¯é¡¹å±æ€§ä¿¡æ¯çš„&lt;b&gt;åŒ…å«&lt;/b&gt;å’Œ&lt;b&gt;æ’é™¤&lt;/b&gt;ã€‚&lt;br&gt;<br></em></span><span style="color: #008080;"> 38</span> <span style="color: #008000;">      &lt;ol&gt;<br></span><span style="color: #008080;"> 39</span> <span style="color: #008000;">     <em> &lt;li&gt;ä½¿ç”¨includesï¼Œä¸ä½¿ç”¨excludesï¼šåªç”Ÿæˆåœ¨includesä¸­çš„ä¿¡æ¯&lt;br&gt;<br></em></span><span style="color: #008080;"> 40</span> <span style="color: #008000;">      &lt;li&gt;ä¸ä½¿ç”¨includesï¼Œä½¿ç”¨excludesï¼šåªç”Ÿæˆä¸åœ¨excludesä¸­çš„ä¿¡æ¯&lt;br&gt;<br></span><span style="color: #008080;"> 41</span> <span style="color: #008000;">     <em> &lt;li&gt;æ—¢ä½¿ç”¨includesï¼Œåˆä½¿ç”¨exclude(ä¸å»ºè®®)ï¼š&lt;br&gt;<br></em></span><span style="color: #008080;"> 42</span> <span style="color: #008000;">       - å¦‚æœincludesä¸­å’Œexcludesä¸­çš„ä¿¡æ¯ä¸å†²çªï¼Œåˆ™ç”Ÿæˆä¸åœ¨excludesä¸­çš„ä¿¡æ¯&lt;br&gt;<br></span><span style="color: #008080;"> 43</span> <span style="color: #008000;">     <em>  - å¦‚æœincludesä¸­å’Œexcludesä¸­çš„ä¿¡æ¯å†²çª(æŸä¸ªå±æ€§éƒ½å‡ºç°åœ¨è¿™ä¸¤ä¸ªæ•°ç»„ä¸­)ï¼Œåˆ™å†²çªéƒ¨åˆ†çš„ä¿¡æ¯è¿˜æ˜¯ä¼šç”Ÿæˆ&lt;br&gt;<br></em></span><span style="color: #008080;"> 44</span> <span style="color: #008000;">      &lt;li&gt;includeså’Œexcludeséƒ½ä¸ä½¿ç”¨ï¼Œåˆ™ä¼šæŠŠlistä¸­æ¯é¡¹çš„æ‰€æœ‰å±æ€§ä¿¡æ¯éƒ½ä¼šç”Ÿæˆåœ¨xmlä¸­<br></span><span style="color: #008080;"> 45</span> <span style="color: #008000;">     <em> &lt;/ol&gt;<br></em></span><span style="color: #008080;"> 46</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> list æ‰€è¦ç”ŸæˆJsonçš„Listæ•°æ®æºã€‚<br></span><span style="color: #008080;"> 47</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> includes æ‰€è¦åŒ…å«çš„å±æ€§åç§°æ•°ç»„ã€‚<br></span><span style="color: #008080;"> 48</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> excludes æ‰€è¦æ’é™¤çš„å±æ€§åç§°æ•°ç»„ã€‚<br></span><span style="color: #008080;"> 49</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 50</span>     <span style="color: #0000ff;">public</span> JOXMLBuilder(List&lt;?&gt;<span style="color: #000000;"> list, String[] includes, String[] excludes) {<br></span><span style="color: #008080;"> 51</span>         <span style="color: #0000ff;">this</span>.list =<span style="color: #000000;"> list;<br></span><span style="color: #008080;"> 52</span>         <span style="color: #0000ff;">this</span>.includes = <span style="color: #0000ff;">null</span> == includes || includes.length == 0 ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : Arrays.asList(includes);<br></span><span style="color: #008080;"> 53</span>         <span style="color: #0000ff;">this</span>.excludes = <span style="color: #0000ff;">null</span> == excludes || excludes.length == 0 ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : Arrays.asList(excludes);<br></span><span style="color: #008080;"> 54</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 55</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 56</span> <span style="color: #008000;">     <em> è¿”å›æ­£åœ¨è¿›è¡Œç”Ÿæˆxmlæ–‡ä»¶çš„ä¿¡æ¯æ¥æºListã€‚<br></em></span><span style="color: #008080;"> 57</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 58</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›æ­£åœ¨è¿›è¡Œç”Ÿæˆxmlæ–‡ä»¶çš„ä¿¡æ¯æ¥æºListã€‚<br></span><span style="color: #008080;"> 59</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 60</span>     <span style="color: #0000ff;">public</span> List&lt;?&gt;<span style="color: #000000;"> getList() {<br></span><span style="color: #008080;"> 61</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> list;<br></span><span style="color: #008080;"> 62</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 63</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 64</span> <span style="color: #008000;">     <em> å¯ä½¿ç”¨æ­¤æ–¹æ³•æ¥ä¼ å…¥ã€æ›¿æ¢JOXMLBuilderå¯¹è±¡ä¸­çš„Listå¯¹è±¡ã€‚<br></em></span><span style="color: #008080;"> 65</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 66</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> list æ‰€è¦ç”Ÿæˆxmlçš„Listæ•°æ®æºã€‚<br></span><span style="color: #008080;"> 67</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›å½“å‰JOXMLBuilderå¯¹è±¡<br></span><span style="color: #008080;"> 68</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 69</span>     <span style="color: #0000ff;">public</span> JOXMLBuilder setList(List&lt;?&gt;<span style="color: #000000;"> list) {<br></span><span style="color: #008080;"> 70</span>         <span style="color: #0000ff;">this</span>.list =<span style="color: #000000;"> list;<br></span><span style="color: #008080;"> 71</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 72</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 73</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;"> 74</span> <span style="color: #008000;">     <em> è®¾ç½®åŒ…å«çš„å±æ€§ä¿¡æ¯ã€‚<br></em></span><span style="color: #008080;"> 75</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 76</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> incFieldName è¦åŒ…å«çš„å±æ€§å<br></span><span style="color: #008080;"> 77</span> <span style="color: #008000;">      </span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›å½“å‰JOXMLBuilderå¯¹è±¡<br></span><span style="color: #008080;"> 78</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;"> 79</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JOXMLBuilder setIncludes(Stringâ€¦ incFieldName) {<br></span><span style="color: #008080;"> 80</span>         <span style="color: #0000ff;">this</span>.includes = <span style="color: #0000ff;">null</span> == incFieldName || incFieldName.length == 0 ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : Arrays.asList(incFieldName);<br></span><span style="color: #008080;"> 81</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 82</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 83</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;"> 84</span> <span style="color: #008000;">      è®¾ç½®æ’é™¤çš„å±æ€§ä¿¡æ¯ã€‚<br></span><span style="color: #008080;"> 85</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 86</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> excFieldName è¦æ’é™¤çš„å±æ€§å<br></span><span style="color: #008080;"> 87</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›å½“å‰JOXMLBuilderå¯¹è±¡<br></span><span style="color: #008080;"> 88</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 89</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> JOXMLBuilder setExcludes(Stringâ€¦ excFieldName) {<br></span><span style="color: #008080;"> 90</span>         <span style="color: #0000ff;">this</span>.excludes = <span style="color: #0000ff;">null</span> == excFieldName || excFieldName.length == 0 ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : Arrays.asList(excFieldName);<br></span><span style="color: #008080;"> 91</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">;<br></span><span style="color: #008080;"> 92</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;"> 93</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;"> 94</span> <span style="color: #008000;">     <em> è·å¾—æŒ‡å®šClassç±»å‹çš„æ‰€æœ‰å±æ€§ï¼Œå¹¶æ‰“å°åœ¨æ§åˆ¶å°ä¸Šã€‚<br></em></span><span style="color: #008080;"> 95</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;"> 96</span>      <span style="color: #008000;">*/</span><br><span style="color: #008080;"> 97</span>     <span style="color: #0000ff;">public</span> Field[] getFields(Class&lt;?&gt;<span style="color: #000000;"> clazz) {<br></span><span style="color: #008080;"> 98</span>         Field[] fields =<span style="color: #000000;"> clazz.getDeclaredFields();<br></span><span style="color: #008080;"> 99</span>         System.out.print(â€œfields of the class that named â€œ + clazz.getName() + â€œ: â€œ<span style="color: #000000;">);<br></span><span style="color: #008080;">100</span>         <span style="color: #0000ff;">for</span><span style="color: #000000;">(Field field : fields){<br></span><span style="color: #008080;">101</span>             System.out.print(field.getName() + â€œ, â€œ<span style="color: #000000;">);<br></span><span style="color: #008080;">102</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">103</span> <span style="color: #000000;">        System.out.println();<br></span><span style="color: #008080;">104</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> fields;<br></span><span style="color: #008080;">105</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">106</span><br><span style="color: #008080;">107</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">108</span> <span style="color: #008000;">     <em> æ ¹æ®listä¸­çš„å¯¹è±¡æ¥ç”Ÿæˆå¯¹åº”çš„xmlæ–‡ä»¶ã€‚<br></em></span><span style="color: #008080;">109</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">110</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›ç”Ÿæˆçš„xmlå­—ç¬¦ä¸²ã€‚<br></span><span style="color: #008080;">111</span> <span style="color: #008000;">      </span><span style="color: #808080;">@throws</span><span style="color: #008000;"> Exception å¦‚æœListæ£€éªŒä¸é€šè¿‡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸<br></span><span style="color: #008080;">112</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;">113</span>     <span style="color: #0000ff;">public</span> StringBuilder xmlBuild() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception{<br></span><span style="color: #008080;">114</span>         <span style="color: #008000;">//</span><span style="color: #008000;">æ£€éªŒä¼ å…¥çš„Listæ˜¯å¦æœ‰æ•ˆ</span><br><span style="color: #008080;">115</span> <span style="color: #000000;">        checkValidityList();<br></span><span style="color: #008080;">116</span>         <span style="color: #008000;">//</span><span style="color: #008000;">XMLæ–‡ä»¶å¼€å§‹ç”Ÿæˆâ€”â€”â€”â€”â€”â€”â€”â€”-</span><br><span style="color: #008080;">117</span>         result = <span style="color: #0000ff;">new</span> StringBuilder(â€œ&lt;?xml version=\â€1.0\â€ encoding=\â€utf-8\â€?&gt;â€<span style="color: #000000;">);<br></span><span style="color: #008080;">118</span>         xmlSubBuild(list); <span style="color: #008000;">//</span><span style="color: #008000;"> é€’å½’ç”Ÿæˆ</span><br><span style="color: #008080;">119</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> result;<br></span><span style="color: #008080;">120</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">121</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">122</span> <span style="color: #008000;">      ç”Ÿæˆxmlå¯é€’å½’éƒ¨åˆ†çš„å­æ•°æ®ï¼ˆæ ¹æ®æŸäº›å¯¹è±¡ç»„æˆçš„Listæ¥ç”Ÿæˆå±æ€§xmlæ–‡ä»¶ï¼‰ã€‚<br></span><span style="color: #008080;">123</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">124</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> list<br></span><span style="color: #008080;">125</span>      <span style="color: #008000;"><em>/</em></span><br><span style="color: #008080;">126</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> xmlSubBuild(List&lt;?&gt;<span style="color: #000000;"> list){<br></span><span style="color: #008080;">127</span>         Class&lt;?&gt; clazz = list.get(0).getClass(); <span style="color: #008000;">//</span><span style="color: #008000;"> è·å–å¯¹åº”çš„Classå¯¹è±¡</span><br><span style="color: #008080;">128</span>         Object curObj = <span style="color: #0000ff;">null</span>; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯æ¬¡å¾ªç¯å½“å‰çš„ç±»å¯¹è±¡ï¼ˆèµ„æºï¼‰</span><br><span style="color: #008080;">129</span>         <span style="color: #0000ff;">int</span> listLength = list.size(); <span style="color: #008000;">//</span><span style="color: #008000;"> ç±»å¯¹è±¡ä¸ªæ•°</span><br><span style="color: #008080;">130</span>         String simpleName = clazz.getSimpleName(); <span style="color: #008000;">//</span><span style="color: #008000;"> è·å–ç±»åï¼ˆä¸å«åŒ…åï¼‰</span><br><span style="color: #008080;">131</span><br><span style="color: #008080;">132</span>         result.append(â€œ&lt;â€ + simpleName + â€œAll&gt;â€); <span style="color: #008000;">//</span><span style="color: #008000;"> æ ¹æ ‡ç­¾å¼€å§‹</span><br><span style="color: #008080;">133</span><br><span style="color: #008080;">134</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 0; i &lt; listLength; i++<span style="color: #000000;">){<br></span><span style="color: #008080;">135</span>             curObj =<span style="color: #000000;"> list.get(i);<br></span><span style="color: #008080;">136</span>             xmlSubSubBuild(curObj, list); <span style="color: #008000;">//</span><span style="color: #008000;"> å­æ•°æ®é€’å½’</span><br><span style="color: #008080;">137</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">138</span><br><span style="color: #008080;">139</span>         result.append(â€œ&lt;/â€œ + simpleName + â€œAll&gt;â€); <span style="color: #008000;">//</span><span style="color: #008000;"> æ ¹æ ‡ç­¾ç»“æŸ</span><br><span style="color: #008080;">140</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">141</span>     <span style="color: #008000;">/**</span><br><span style="color: #008080;">142</span> <span style="color: #008000;">      ç”Ÿæˆxmlå¯é€’å½’éƒ¨åˆ†çš„å­å­æ•°æ®ï¼ˆæ ¹æ®æŸä¸ªå¯¹è±¡æ¥ç”Ÿæˆå±æ€§xmlæ–‡ä»¶ï¼‰ã€‚<br></span><span style="color: #008080;">143</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">144</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> curObj è¦ç”Ÿæˆxmlæ–‡ä»¶çš„é‚£ä¸ªå¯¹è±¡<br></span><span style="color: #008080;">145</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> list curObjå‚æ•°å±äºçš„é‚£ä¸ªList<br></span><span style="color: #008080;">146</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">147</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> xmlSubSubBuild(Object curObj, List&lt;?&gt;<span style="color: #000000;"> list){<br></span><span style="color: #008080;">148</span>         String fieldName = â€œâ€; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯æ¬¡è¦è°ƒç”¨çš„å±æ€§å</span><br><span style="color: #008080;">149</span>         String methodName = â€œâ€; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯æ¬¡è¦è°ƒç”¨çš„æ–¹æ³•å</span><br><span style="color: #008080;">150</span>         Method method = <span style="color: #0000ff;">null</span>;; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯æ¬¡è¦è°ƒç”¨çš„æ–¹æ³•</span><br><span style="color: #008080;">151</span>         Object value = â€œâ€; <span style="color: #008000;">//</span><span style="color: #008000;"> æ¯æ¬¡è¦è·å¾—çš„å±æ€§å€¼ï¼ˆå­æ ‡ç­¾ï¼‰</span><br><span style="color: #008080;">152</span><br><span style="color: #008080;">153</span>         Class&lt;?&gt; clazz =<span style="color: #000000;"> curObj.getClass();<br></span><span style="color: #008080;">154</span>         Field[] fields = getFields(clazz); <span style="color: #008000;">//</span><span style="color: #008000;"> è·å¾—å¯¹åº”ç±»å‹çš„æ‰€æœ‰å˜é‡</span><br><span style="color: #008080;">155</span>         <span style="color: #0000ff;">int</span> fieldsLength = fields.length; <span style="color: #008000;">//</span><span style="color: #008000;"> ç±»å¯¹è±¡çš„å±æ€§æ•°é‡</span><br><span style="color: #008080;">156</span><br><span style="color: #008080;">157</span>         String simpleName = clazz.getSimpleName(); <span style="color: #008000;">//</span><span style="color: #008000;"> è·å–ç±»åï¼ˆä¸å«åŒ…åï¼‰</span><br><span style="color: #008080;">158</span><br><span style="color: #008080;">159</span>         result.append(â€œ&lt;â€ + simpleName + â€œ&gt;â€<span style="color: #000000;">);<br></span><span style="color: #008080;">160</span><br><span style="color: #008080;">161</span><br><span style="color: #008080;">162</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j = 0; j &lt; fieldsLength; j++<span style="color: #000000;">){<br></span><span style="color: #008080;">163</span>             fieldName = fields[j].getName(); <span style="color: #008000;">//</span><span style="color: #008000;"> è·å–å¯¹åº”å±æ€§å</span><br><span style="color: #008080;">164</span><br><span style="color: #008080;">165</span>             <span style="color: #0000ff;">if</span>(list == <span style="color: #0000ff;">this</span>.list){ <span style="color: #008000;">//</span><span style="color: #008000;"> åªåœ¨æœ€å¤–å±‚çš„ç±»çš„å±æ€§ä¸­è¿›è¡Œæ’é™¤åŒ…å«<br></span><span style="color: #008080;">166</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> ä½¿ç”¨includesï¼Œä¸ä½¿ç”¨excludesï¼šåªç”Ÿæˆåœ¨includesä¸­çš„ä¿¡æ¯</span><br><span style="color: #008080;">167</span>                 <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> != includes &amp;&amp; <span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> excludes){<br></span><span style="color: #008080;">168</span>                     <span style="color: #0000ff;">if</span>(!<span style="color: #000000;">includes.contains(fieldName)){<br></span><span style="color: #008080;">169</span>                         <span style="color: #0000ff;">continue</span><span style="color: #000000;">;<br></span><span style="color: #008080;">170</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">171</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">172</span><br><span style="color: #008080;">173</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">ä¸ä½¿ç”¨includesï¼Œä½¿ç”¨excludesï¼šåªç”Ÿæˆä¸åœ¨excludesä¸­çš„ä¿¡æ¯</span><br><span style="color: #008080;">174</span>                 <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> == includes &amp;&amp; <span style="color: #0000ff;">null</span> != excludes){ <span style="color: #008000;">//</span><span style="color: #008000;"> åªä½¿ç”¨äº†ä¸åŒ…å«</span><br><span style="color: #008080;">175</span>                     <span style="color: #0000ff;">if</span><span style="color: #000000;">(excludes.contains(fieldName)){<br></span><span style="color: #008080;">176</span>                         <span style="color: #0000ff;">continue</span><span style="color: #000000;">;<br></span><span style="color: #008080;">177</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">178</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">179</span><br><span style="color: #008080;">180</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">æ—¢ä½¿ç”¨includesï¼Œåˆä½¿ç”¨exclude(ä¸å»ºè®®)ï¼š<br></span><span style="color: #008080;">181</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">- å¦‚æœincludesä¸­å’Œexcludesä¸­çš„ä¿¡æ¯ä¸å†²çªï¼Œåˆ™ç”Ÿæˆä¸åœ¨excludesä¸­çš„ä¿¡æ¯<br></span><span style="color: #008080;">182</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">- å¦‚æœincludesä¸­å’Œexcludesä¸­çš„ä¿¡æ¯å†²çª(æŸä¸ªå±æ€§éƒ½å‡ºç°åœ¨è¿™ä¸¤ä¸ªæ•°ç»„ä¸­)ï¼Œåˆ™å†²çªéƒ¨åˆ†çš„ä¿¡æ¯è¿˜æ˜¯ä¼šç”Ÿæˆ</span><br><span style="color: #008080;">183</span>                 <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> != includes &amp;&amp; <span style="color: #0000ff;">null</span> != excludes){ <span style="color: #008000;">//</span><span style="color: #008000;"> æ—¢ä½¿ç”¨äº†åŒ…å«ï¼Œåˆä½¿ç”¨äº†ä¸åŒ…å«</span><br><span style="color: #008080;">184</span>                     <span style="color: #0000ff;">if</span>(!includes.contains(fieldName) &amp;&amp;<span style="color: #000000;"> excludes.contains(fieldName)){<br></span><span style="color: #008080;">185</span>                         <span style="color: #0000ff;">continue</span><span style="color: #000000;">;<br></span><span style="color: #008080;">186</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">187</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">188</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">189</span><br><span style="color: #008080;">190</span>             methodName =<span style="color: #000000;"> getGetterMethodNameByFieldName(fields[j]);<br></span><span style="color: #008080;">191</span>             <span style="color: #0000ff;">try</span><span style="color: #000000;"> {<br></span><span style="color: #008080;">192</span>                 method = clazz.getDeclaredMethod(methodName, <span style="color: #0000ff;">new</span><span style="color: #000000;"> Class[]{});<br></span><span style="color: #008080;">193</span>                 method.setAccessible(<span style="color: #0000ff;">true</span><span style="color: #000000;">);<br></span><span style="color: #008080;">194</span>                 value = method.invoke(curObj, <span style="color: #0000ff;">new</span><span style="color: #000000;"> Object[]{});<br></span><span style="color: #008080;">195</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></span><br><span style="color: #008080;">196</span>                 <span style="color: #0000ff;">if</span>(fields[j].getType() == List.<span style="color: #0000ff;">class</span>){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœå±æ€§æ˜¯Listç±»å‹</span><br><span style="color: #008080;">197</span>                     List&lt;?&gt; subList = (List&lt;?&gt;<span style="color: #000000;">)value;<br></span><span style="color: #008080;">198</span>                     xmlSubBuild(subList); <span style="color: #008000;">//</span><span style="color: #008000;"> å­æ•°æ®é€’å½’</span><br><span style="color: #008080;">199</span>                 }<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(fields[j].getType() == Set.<span style="color: #0000ff;">class</span>){ <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœå±æ€§æ˜¯Setç±»å‹çš„</span><br><span style="color: #008080;">200</span>                     Set&lt;?&gt; subSet = (Set&lt;?&gt;<span style="color: #000000;">)value;<br></span><span style="color: #008080;">201</span>                     Iterator&lt;?&gt; iter =<span style="color: #000000;"> subSet.iterator();<br></span><span style="color: #008080;">202</span>                     List&lt;Object&gt; subList = <span style="color: #0000ff;">new</span> ArrayList&lt;Object&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;">203</span>                     <span style="color: #0000ff;">while</span><span style="color: #000000;">(iter.hasNext()){<br></span><span style="color: #008080;">204</span> <span style="color: #000000;">                        subList.add(iter.next());<br></span><span style="color: #008080;">205</span> <span style="color: #000000;">                    }<br></span><span style="color: #008080;">206</span>                     xmlSubBuild(subList); <span style="color: #008000;">//</span><span style="color: #008000;"> å­æ•°æ®é€’å½’</span><br><span style="color: #008080;">207</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">208</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> å¦‚æœClassLoaderä¸æ˜¯nullè¡¨ç¤ºè¯¥ç±»ä¸æ˜¯å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½çš„ï¼Œä¸æ˜¯Java APIçš„ç±»ï¼Œæ˜¯è‡ªå·±å†™çš„javaç±»</span><br><span style="color: #008080;">209</span>                 <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> !=<span style="color: #000000;"> fields[j].getType().getClassLoader()){<br></span><span style="color: #008080;">210</span>                     xmlSubSubBuild(value, <span style="color: #0000ff;">null</span>); <span style="color: #008000;">//</span><span style="color: #008000;"> å­å­æ•°æ®é€’å½’</span><br><span style="color: #008080;">211</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">212</span>                 <span style="color: #0000ff;">else</span>{ <span style="color: #008000;">//</span><span style="color: #008000;"> å…¶å®ƒç±»å‹éƒ½è®¤ä¸ºæ˜¯æ™®é€šæ–‡æœ¬ç±»å‹</span><br><span style="color: #008080;">213</span>                     value =<span style="color: #000000;"> value.toString();<br></span><span style="color: #008080;">214</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> æ·»åŠ å­å…ƒç´ ï¼ˆç±»å±æ€§ï¼‰æ ‡ç­¾</span><br><span style="color: #008080;">215</span>                     result.append(â€œ&lt;â€ + fieldName + â€œ&gt;â€<span style="color: #000000;">)<br></span><span style="color: #008080;">216</span> <span style="color: #000000;">                            .append(value)<br></span><span style="color: #008080;">217</span>                             .append(â€œ&lt;/â€œ + fieldName + â€œ&gt;â€<span style="color: #000000;">);<br></span><span style="color: #008080;">218</span> <span style="color: #000000;">                }<br></span><span style="color: #008080;">219</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></span><br><span style="color: #008080;">220</span>             } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {<br></span><span style="color: #008080;">221</span> <span style="color: #000000;">                e.printStackTrace();<br></span><span style="color: #008080;">222</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">223</span><br><span style="color: #008080;">224</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">225</span>         result.append(â€œ&lt;/â€œ + simpleName + â€œ&gt;â€<span style="color: #000000;">);<br></span><span style="color: #008080;">226</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">227</span><br><span style="color: #008080;">228</span>     <span style="color: #008000;">/<strong></strong></span><br><span style="color: #008080;">229</span> <span style="color: #008000;">     <em> &lt;ol&gt;é€šè¿‡å±æ€§Fieldå¯¹è±¡æ¥è·å–getteræ–¹æ³•çš„æ–¹æ³•åã€‚&lt;br&gt;<br></em></span><span style="color: #008080;">230</span> <span style="color: #008000;">      å¦‚æœæ˜¯booleanæˆ–Booleanç±»å‹(æ­£åˆ™è¡¨è¾¾å¼æ¥åˆ¤æ–­):isBorrowâ€“&gt;isBorrow();isborrowâ€“&gt;isIsborrow();&lt;br&gt;<br></span><span style="color: #008080;">231</span> <span style="color: #008000;">     <em> å¦åˆ™:borrowâ€“&gt;getBorrow();<br></em></span><span style="color: #008080;">232</span> <span style="color: #008000;">      &lt;/ol&gt;<br></span><span style="color: #008080;">233</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">234</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> field è¦ç”Ÿæˆgetteræ–¹æ³•çš„å¯¹åº”å±æ€§å¯¹è±¡ã€‚<br></span><span style="color: #008080;">235</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@return</span><span style="color: #008000;"> è¿”å›getteræ–¹æ³•çš„æ–¹æ³•åã€‚<br></span><span style="color: #008080;">236</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">237</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> String getGetterMethodNameByFieldName(Field field){<br></span><span style="color: #008080;">238</span>         String methodName = <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br></span><span style="color: #008080;">239</span>         String fieldName =<span style="color: #000000;"> field.getName();<br></span><span style="color: #008080;">240</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> è§£æå±æ€§å¯¹åº”çš„getteræ–¹æ³•å<br></span><span style="color: #008080;">241</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> åˆ¤æ–­æ˜¯å¦æ˜¯booleanæˆ–Booleanç±»å‹:isBorrowâ€“&gt;isBorrow();isborrowâ€“&gt;isIsborrow()</span><br><span style="color: #008080;">242</span>         <span style="color: #0000ff;">if</span>(field.getType() == <span style="color: #0000ff;">boolean</span>.<span style="color: #0000ff;">class</span> || field.getType() == Boolean.<span style="color: #0000ff;">class</span><span style="color: #000000;">){<br></span><span style="color: #008080;">243</span>             <span style="color: #0000ff;">if</span>(fieldName.matches(â€œ^is[A-Z].*â€<span style="color: #000000;">)){<br></span><span style="color: #008080;">244</span>                 methodName =<span style="color: #000000;"> fieldName;<br></span><span style="color: #008080;">245</span>             }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;">246</span>                 methodName = â€œisâ€ + fieldName.substring(0, 1).toUpperCase() + fieldName.substring(1<span style="color: #000000;">);<br></span><span style="color: #008080;">247</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">248</span>         }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;">249</span>             methodName = â€œgetâ€ + fieldName.substring(0, 1).toUpperCase() + fieldName.substring(1<span style="color: #000000;">);<br></span><span style="color: #008080;">250</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">251</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> methodName;<br></span><span style="color: #008080;">252</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">253</span><br><span style="color: #008080;">254</span>     <span style="color: #008000;">/</span><br><span style="color: #008080;">255</span> <span style="color: #008000;">     <em> æ£€éªŒä¼ å…¥çš„Listçš„åˆæ³•æ€§ï¼ˆListæ˜¯ä¸æ˜¯ä¸ºnullã€é•¿åº¦æ˜¯ä¸æ˜¯ä¸º0ã€æ˜¯ä¸æ˜¯æ¯é¡¹éƒ½æ˜¯åŒä¸€ä¸ªç±»å‹ï¼‰ã€‚<br></em></span><span style="color: #008080;">256</span> <span style="color: #008000;">      </span><span style="color: #808080;">@author</span><span style="color: #008000;"> wangjie<br></span><span style="color: #008080;">257</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@throws</span><span style="color: #008000;"> Exception å¦‚æœListä¸ºnull, æˆ–è€…é•¿åº¦ä¸º, æˆ–è€…æ¯é¡¹ä¸æ˜¯åŒä¸€ä¸ªç±»å‹, æŠ›å‡ºå¼‚å¸¸<br></span><span style="color: #008080;">258</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;">259</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> checkValidityList() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception{<br></span><span style="color: #008080;">260</span>         <span style="color: #0000ff;">if</span>(<span style="color: #0000ff;">null</span> ==<span style="color: #000000;"> list){<br></span><span style="color: #008080;">261</span>             <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œè¯·ä¿è¯ä¼ å…¥çš„Listä¸ä¸ºnullâ€<span style="color: #000000;">);<br></span><span style="color: #008080;">262</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">263</span>         <span style="color: #0000ff;">int</span> size =<span style="color: #000000;"> list.size();<br></span><span style="color: #008080;">264</span>         <span style="color: #0000ff;">if</span>(list.size() == 0<span style="color: #000000;">){<br></span><span style="color: #008080;">265</span>             <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œè¯·ä¿è¯ä¼ å…¥çš„Listé•¿åº¦ä¸ä¸º0â€<span style="color: #000000;">);<br></span><span style="color: #008080;">266</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">267</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = 1; i &lt; size; i++<span style="color: #000000;">){<br></span><span style="color: #008080;">268</span>             <span style="color: #0000ff;">if</span>(list.get(0).getClass() !=<span style="color: #000000;"> list.get(i).getClass()){<br></span><span style="color: #008080;">269</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> Exception(â€œè¯·ä¿è¯ä¼ å…¥çš„Listæ¯é¡¹éƒ½æ˜¯åŒä¸€ä¸ªç±»å‹â€<span style="color: #000000;">);<br></span><span style="color: #008080;">270</span> <span style="color: #000000;">            }<br></span><span style="color: #008080;">271</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">272</span><br><span style="color: #008080;">273</span> <span style="color: #000000;">    }<br></span><span style="color: #008080;">274</span><br><span style="color: #008080;">275</span><br><span style="color: #008080;">276</span> }</pre><br></div><br></div>

<p>&nbsp;</p>
<p><strong>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</strong><br><span>ä¾‹å¦‚:</span><br><strong>Studentç±»</strong><span>(è¯¥ç±»æœ‰å±æ€§nameï¼Œageï¼ŒisBoyï¼Œbooksç­‰å±æ€§ï¼›å…¶ä¸­bookså±æ€§æ˜¯ä¸€ä¸ªListï¼Œå­˜æ”¾Bookå¯¹è±¡)ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br></span><span style="color: #008080;">2</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> age;<br></span><span style="color: #008080;">3</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isBoy;<br></span><span style="color: #008080;">4</span> <span style="color: #0000ff;">private</span> List&lt;Book&gt;<span style="color: #000000;"> books;<br></span><span style="color: #008080;">5</span> <span style="color: #008000;">//</span><span style="color: #008000;">å¹¶å®ç°getterå’Œsetteræ–¹æ³•ï¼›</span></pre><br></div>

<p>&nbsp;</p>
<p><strong>Bookç±»</strong><span>(è¯¥ç±»æœ‰å±æ€§nameï¼Œauthorï¼Œnumberï¼Œlengthï¼Œwidthï¼ŒisBorrowedç­‰å±æ€§)ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> <span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br></span><span style="color: #008080;">2</span> <span style="color: #0000ff;">private</span><span style="color: #000000;"> String author;<br></span><span style="color: #008080;">3</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> number;<br></span><span style="color: #008080;">4</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">float</span><span style="color: #000000;"> length;<br></span><span style="color: #008080;">5</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">float</span><span style="color: #000000;"> width;<br></span><span style="color: #008080;">6</span> <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> isBorrowed;<br></span><span style="color: #008080;">7</span> <span style="color: #008000;">//</span><span style="color: #008000;">å¹¶å®ç°getterå’Œsetteræ–¹æ³•ï¼›</span></pre><br></div>

<p>&nbsp;</p>
<p><span>ç°åœ¨æœ‰ä¸€ä¸ªList&lt;Student&gt;ç±»å‹çš„æ•°æ®ï¼Œé€šè¿‡ä»¥ä¸‹ä»£ç æŠŠè¯¥Listè½¬æ¢ä¸ºxmlï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> List&lt;Student&gt; list = <span style="color: #0000ff;">new</span> ArrayList&lt;Student&gt;<span style="color: #000000;">();<br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #008000;">//</span><span style="color: #008000;">æ„å»ºå‡ ä¸ªStudentå¯¹è±¡ï¼Œæ”¾å…¥listä¸­<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">//</span><span style="color: #008000;">&hellip;&hellip;<br></span><span style="color: #008080;"> 5</span><br><span style="color: #008080;"> 6</span> <span style="color: #008000;">//</span><span style="color: #008000;">å®Œæ•´æ•°æ®ç‰ˆï¼ˆä¸ä½¿ç”¨includeså’Œexcludesï¼‰</span><br><span style="color: #008080;"> 7</span> JOXMLBuilder jOXMLBuilder = <span style="color: #0000ff;">new</span><span style="color: #000000;"> JOXMLBuilder(list);<br></span><span style="color: #008080;"> 8</span> <span style="color: #000000;">jOXMLBuilder.xmlBuild().toString();<br></span><span style="color: #008080;"> 9</span><br><span style="color: #008080;">10</span> <span style="color: #008000;">//</span><span style="color: #008000;">æˆ–è€…ä½¿ç”¨åŒ…æ‹¬/æ’é™¤ï¼š</span><br><span style="color: #008080;">11</span> JOXMLBuilder jOXMLBuilder = <span style="color: #0000ff;">new</span> JOXMLBuilder(list, <span style="color: #0000ff;">new</span> String[]{â€œnameâ€, â€œageâ€}, <span style="color: #0000ff;">null</span><span style="color: #000000;">);<br></span><span style="color: #008080;">12</span> <span style="color: #000000;">jOXMLBuilder.xmlBuild().toString();<br></span><span style="color: #008080;">13</span><br><span style="color: #008080;">14</span> <span style="color: #008000;">//</span><span style="color: #008000;">æˆ–è€…ä½¿ç”¨æ–¹æ³•é“¾é£æ ¼ï¼š</span><br><span style="color: #008080;">15</span> <span style="color: #0000ff;">new</span> JOXMLBuilder().setExcludes(â€œnameâ€, â€œageâ€).xmlBuild().toString();</pre><br></div>

<p>&nbsp;</p>
<p><span style="line-height: 1.5;">è½¬æ¢ä¹‹åçš„xmlï¼ˆå®Œæ•´æ•°æ®ç‰ˆï¼ˆä¸ä½¿ç”¨includeså’Œexcludesï¼‰ï¼‰ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">StudentAll</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 3</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Student</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 4</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span>hello<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 5</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">age</span><span style="color: #0000ff;">&gt;</span>23<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">age</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 6</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">isBoy</span><span style="color: #0000ff;">&gt;</span>true<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">isBoy</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 7</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">BookAll</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 8</span>                         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Book</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 9</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span>book1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">10</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">author</span><span style="color: #0000ff;">&gt;</span>author1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">author</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">11</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">number</span><span style="color: #0000ff;">&gt;</span>123<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">number</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">12</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">length</span><span style="color: #0000ff;">&gt;</span>23.5<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">length</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">13</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span>18.0<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">14</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">isBorrowed</span><span style="color: #0000ff;">&gt;</span>true<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">isBorrowed</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">15</span>                         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Book</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">16</span>                         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Book</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">17</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span>book2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">18</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">author</span><span style="color: #0000ff;">&gt;</span>author2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">author</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">19</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">number</span><span style="color: #0000ff;">&gt;</span>43<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">number</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">20</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">length</span><span style="color: #0000ff;">&gt;</span>42.23<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">length</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">21</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span>30.57<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">22</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">isBorrowed</span><span style="color: #0000ff;">&gt;</span>false<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">isBorrowed</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">23</span>                         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Book</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">24</span>                 <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">BookAll</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">25</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Student</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Student</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">28</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;world</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">29</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">age</span><span style="color: #0000ff;">&gt;</span>22<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">age</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">30</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">isBoy</span><span style="color: #0000ff;">&gt;</span>false<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">isBoy</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">31</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">BookAll</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">32</span>                          <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Book</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">33</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span>book1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">34</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">author</span><span style="color: #0000ff;">&gt;</span>author1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">author</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">35</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">number</span><span style="color: #0000ff;">&gt;</span>123<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">number</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">36</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">length</span><span style="color: #0000ff;">&gt;</span>23.5<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">length</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">37</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span>18.0<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">38</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">isBorrowed</span><span style="color: #0000ff;">&gt;</span>true<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">isBorrowed</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">39</span>                         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Book</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">40</span>                         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Book</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">41</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span>book3<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">42</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">author</span><span style="color: #0000ff;">&gt;</span>author3<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">author</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">43</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">number</span><span style="color: #0000ff;">&gt;</span>875<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">number</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">44</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">length</span><span style="color: #0000ff;">&gt;</span>20.59<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">length</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">45</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span>15.08<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">46</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">isBorrowed</span><span style="color: #0000ff;">&gt;</span>false<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">isBorrowed</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">47</span>                         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Book</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">48</span>                         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Book</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">49</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span>book4<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">50</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">author</span><span style="color: #0000ff;">&gt;</span>author4<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">author</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">51</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">number</span><span style="color: #0000ff;">&gt;</span>165<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">number</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">52</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">length</span><span style="color: #0000ff;">&gt;</span>22.75<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">length</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">53</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span>19.61<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">54</span>                                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">isBorrowed</span><span style="color: #0000ff;">&gt;</span>true<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">isBorrowed</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">55</span>                         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Book</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">56</span>                 <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">BookAll</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">57</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Student</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">58</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">StudentAll</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[[java]äºŒã€å…«ã€åã€åå…­è¿›åˆ¶ä¹‹é—´çš„è½¬æ¢]]></title>
      <url>/2013/01/29/java-%E4%BA%8C%E3%80%81%E5%85%AB%E3%80%81%E5%8D%81%E3%80%81%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2/</url>
      <content type="html"><![CDATA[<p>int n1 = 14;<br>    //åè¿›åˆ¶è½¬æˆåå…­è¿›åˆ¶ï¼š<br>    Integer.toHexString(n1);<br>    //åè¿›åˆ¶è½¬æˆå…«è¿›åˆ¶<br>    Integer.toOctalString(n1);<br>    //åè¿›åˆ¶è½¬æˆäºŒè¿›åˆ¶<br>    Integer.toBinaryString(12);</p>
<pre><code>//åå…­è¿›åˆ¶è½¬æˆåè¿›åˆ¶
Integer.valueOf(&quot;FFFF&quot;,16).toString();
//åå…­è¿›åˆ¶è½¬æˆäºŒè¿›åˆ¶
Integer.toBinaryString(Integer.valueOf(&quot;FFFF&quot;,16));
//åå…­è¿›åˆ¶è½¬æˆå…«è¿›åˆ¶
Integer.toOctalString(Integer.valueOf(&quot;FFFF&quot;,16));

//å…«è¿›åˆ¶è½¬æˆåè¿›åˆ¶
Integer.valueOf(&quot;576&quot;,8).toString();
//å…«è¿›åˆ¶è½¬æˆäºŒè¿›åˆ¶
Integer.toBinaryString(Integer.valueOf(&quot;23&quot;,8));
//å…«è¿›åˆ¶è½¬æˆåå…­è¿›åˆ¶
Integer.toHexString(Integer.valueOf(&quot;23&quot;,8));

//äºŒè¿›åˆ¶è½¬åè¿›åˆ¶
Integer.valueOf(&quot;0101&quot;,2).toString();
//äºŒè¿›åˆ¶è½¬å…«è¿›åˆ¶
Integer.toOctalString(Integer.parseInt(&quot;0101&quot;, 2));
//äºŒè¿›åˆ¶è½¬åå…­è¿›åˆ¶
Integer.toHexString(Integer.parseInt(&quot;0101&quot;, 2));
</code></pre>]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Javaåƒåœ¾å›æ”¶å™¨å·¥ä½œåŸç†]]></title>
      <url>/2013/01/07/Java%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/</url>
      <content type="html"><![CDATA[<p>åƒåœ¾å›æ”¶å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿæˆ‘ç°åœ¨å°±ç®€å•çš„ä»‹ç»ä¸€ä¸‹</p>
<p>é¦–å…ˆè¦æ˜ç¡®å‡ ç‚¹ï¼š</p>
<p>Javaæ˜¯åœ¨å †ä¸Šä¸ºå¯¹è±¡åˆ†é…ç©ºé—´çš„</p>
<p>åƒåœ¾å›æ”¶å™¨åªè·Ÿå†…å­˜æœ‰å…³ï¼Œä»€ä¹ˆIOå•Šï¼Œç½‘ç»œè¿æ¥å•Šï¼Œç®¡å®ƒPäº‹</p>
<p>å½“å¯ç”¨å†…å­˜æ•°é‡è¾ƒä½æ—¶ï¼ŒSunç‰ˆæœ¬çš„åƒåœ¾å›æ”¶å™¨æ‰ä¼šè¢«æ¿€æ´»</p>
<p>åœ¨åƒåœ¾å›æ”¶å™¨å›æ”¶åƒåœ¾ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹Javaåˆ†é…å¯¹è±¡çš„æ–¹å¼ï¼ŒJavaçš„å †æ›´åƒä¸€ä¸ªä¼ é€å¸¦ï¼Œæ¯åˆ†é…ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå®ƒå°±å¾€å‰ç§»åŠ¨ä¸€æ ¼ã€‚è¿™æ„å‘³ç€å¯¹è±¡å­˜å‚¨ç©ºé—´çš„åˆ†é…é€Ÿåº¦ç›¸å½“å¿«ã€‚Javaçš„&ldquo;å †æŒ‡é’ˆ&rdquo;åªæ˜¯ç®€å•åœ°ç§»åŠ¨åˆ°å°šæœªåˆ†é…çš„é¢†åŸŸã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ†é…ç©ºé—´çš„æ—¶å€™ï¼Œ&ldquo;å †æŒ‡é’ˆ&rdquo;åªç®¡ä¾æ¬¡å¾€å‰ç§»åŠ¨è€Œä¸ç®¡åé¢çš„å¯¹è±¡æ˜¯å¦è¿˜è¦è¢«é‡Šæ”¾æ‰ã€‚å¦‚æœå¯ç”¨å†…å­˜è€—å°½ä¹‹å‰ç¨‹åºå°±é€€å‡ºå°±å†å¥½ä¸è¿‡äº†ï¼Œè¿™æ ·çš„è¯åƒåœ¾å›æ”¶å™¨å‹æ ¹å°±ä¸ä¼šè¢«æ¿€æ´»ã€‚</p>
<p>ä½†æ˜¯ç”±äº&ldquo;å †æŒ‡é’ˆ&rdquo;åªç®¡ä¾æ¬¡å¾€å‰ç§»åŠ¨ï¼Œé‚£ä¹ˆä½ è‚¯å®šä¼šæƒ³ï¼Œæ€»æœ‰ä¸€å¤©å†…å­˜ä¼šè¢«è€—å°½ï¼Œåƒåœ¾å›æ”¶å™¨å°±å¼€å§‹é‡Šæ”¾å†…å­˜ã€‚è¿™é‡Œæœ‰äººè‚¯å®šä¼šé—®ï¼šæ€ä¹ˆåˆ¤æ–­æŸä¸ªå¯¹è±¡è¯¥è¢«å›æ”¶å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯å½“å †æ ˆæˆ–é™æ€å­˜å‚¨åŒºæ²¡æœ‰å¯¹è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨æ—¶ï¼Œå°±è¡¨ç¤ºç¨‹åºï¼ˆå‘˜ï¼‰å¯¹è¿™ä¸ªå¯¹è±¡æ²¡æœ‰å…´è¶£äº†ï¼Œå®ƒå°±åº”è¯¥è¢«å›æ”¶äº†ã€‚æœ‰ä¸¤ç§æ–¹æ³•æ¥çŸ¥é“è¿™ä¸ªå¯¹è±¡æœ‰æ²¡æœ‰è¢«å¼•ç”¨ï¼šç¬¬ä¸€ç§æ˜¯éå†å †ä¸Šçš„å¯¹è±¡æ‰¾å¼•ç”¨ï¼›ç¬¬äºŒç§æ˜¯éå†å †æ ˆæˆ–é™æ€å­˜å‚¨åŒºçš„å¼•ç”¨æ‰¾å¯¹è±¡ã€‚å‰è€…çš„å®ç°å«åš&ldquo;å¼•ç”¨è®¡æ•°æ³•&rdquo;ï¼Œæ„æ€å°±æ˜¯å½“æœ‰å¼•ç”¨è¿æ¥è‡³å¯¹è±¡æ—¶ï¼Œå¼•ç”¨è®¡æ•°åŠ 1ï¼Œå½“å¼•ç”¨ç¦»å¼€ä½œç”¨åŸŸæˆ–è¢«ç½®ä¸ºnullæ—¶ï¼Œå¼•ç”¨è®¡æ•°å‡1ï¼Œè¿™ç§æ–¹æ³•æœ‰ä¸ªç¼ºé™·ï¼Œå¦‚æœå¯¹è±¡ä¹‹é—´å­˜åœ¨å¾ªç¯å¼•ç”¨ï¼Œå¯èƒ½ä¼šå‡ºç°&ldquo;å¯¹è±¡åº”è¯¥è¢«å›æ”¶ï¼Œä½†å¼•ç”¨è®¡æ•°å´ä¸ä¸ºé›¶&rdquo;çš„æƒ…å†µã€‚</p>
<p>Javaé‡‡ç”¨çš„æ˜¯åè€…ï¼Œåœ¨è¿™ç§æ–¹å¼ä¸‹ï¼ŒJavaè™šæ‹Ÿæœºé‡‡ç”¨ä¸€ç§&ldquo;è‡ªé€‚åº”&rdquo;çš„åƒåœ¾å›æ”¶æŠ€æœ¯ï¼Œå¦‚ä½•å¤„ç†æ‰¾åˆ°çš„å­˜æ´»å¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯è¯´ä¸æ˜¯åƒåœ¾ï¼‰ï¼ŒJavaæœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<p>ä¸€ç§æ˜¯&ldquo;åœæ­¢-å¤åˆ¶&rdquo;ï¼šç†è®ºä¸Šæ˜¯å…ˆæš‚åœç¨‹åºçš„è¿è¡Œï¼ˆæ‰€ä»¥å®ƒä¸å±äºåå°å›æ”¶æ¨¡å¼ï¼‰ï¼Œç„¶åå°†æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ä»å½“å‰å †å¤åˆ¶åˆ°å¦ä¸€ä¸ªå †ï¼Œæ²¡æœ‰è¢«å¤åˆ¶çš„å…¨æ˜¯åƒåœ¾ã€‚å½“å¯¹è±¡è¢«å¤åˆ¶åˆ°æ–°å †ä¸Šæ—¶ï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªæŒ¨ç€ä¸€ä¸ªçš„ï¼Œæ‰€ä»¥æ–°å †ä¿æŒç´§å‡‘æ’åˆ—ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåˆ†é…å¯¹è±¡çš„æ—¶å€™&ldquo;å †æŒ‡é’ˆ&rdquo;åªç®¡ä¾æ¬¡å¾€å‰ç§»åŠ¨ï¼‰ã€‚ç„¶åå°±å¯ä»¥æŒ‰å‰è¿°æ–¹æ³•ç®€å•ã€ç›´æ¥åœ°åˆ†é…å†…å­˜äº†ã€‚è¿™å°†å¯¼è‡´å¤§é‡å†…å­˜å¤åˆ¶è¡Œä¸ºï¼Œå†…å­˜åˆ†é…æ˜¯ä»¥è¾ƒå¤§çš„&ldquo;å—&rdquo;ä¸ºå•ä½çš„ã€‚æœ‰äº†å—ä¹‹åï¼Œåƒåœ¾å›æ”¶å™¨å°±å¯ä»¥ä¸å¾€å †é‡Œæ‹·è´å¯¹è±¡äº†ï¼Œç›´æ¥å°±å¯ä»¥å¾€åºŸå¼ƒçš„å—é‡Œæ‹·è´å¯¹è±¡äº†ã€‚</p>
<p>å¦ä¸€ç§æ˜¯&ldquo;æ ‡è®°-æ¸…æ‰«&rdquo;ï¼šå®ƒçš„æ€è·¯åŒæ ·æ˜¯ä»å †æ ˆå’Œé™æ€å­˜å‚¨åŒºå‡ºå‘ï¼Œéå†æ‰€æœ‰çš„å¼•ç”¨ï¼Œè¿›è€Œæ‰¾å‡ºæ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ã€‚æ¯å½“å®ƒæ‰¾åˆ°ä¸€ä¸ªå­˜æ´»å¯¹è±¡ï¼Œå°±ä¼šç»™å¯¹è±¡ä¸€ä¸ªæ ‡è®°ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸ä¼šå›æ”¶ä»»ä½•å¯¹è±¡ã€‚åªæœ‰å…¨éƒ¨æ ‡è®°å®Œæˆæ—¶ï¼Œæ²¡æœ‰æ ‡è®°çš„å¯¹è±¡å°†è¢«é‡Šæ”¾ï¼Œä¸ä¼šå‘ç”Ÿä»»ä½•å¤åˆ¶å·¥ä½œï¼Œæ‰€ä»¥å‰©ä¸‹çš„å †ç©ºé—´æ˜¯ä¸è¿ç»­çš„ï¼Œç„¶ååƒåœ¾å›æ”¶å™¨é‡æ–°æ•´ç†å‰©ä½™çš„å¯¹è±¡ï¼Œä½¿å®ƒä»¬æ˜¯è¿ç»­æ’åˆ—çš„ã€‚</p>
<p>å½“åƒåœ¾å›æ”¶å™¨ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶ï¼Œå®ƒæ‰§è¡Œçš„æ˜¯&ldquo;åœæ­¢-å¤åˆ¶&rdquo;ï¼Œå› ä¸ºè¿™ä¸ªæ—¶åˆ»å†…å­˜æœ‰å¤ªå¤šçš„åƒåœ¾ã€‚ç„¶åJavaè™šæ‹Ÿæœºä¼šè¿›è¡Œç›‘è§†ï¼Œå¦‚æœæ‰€æœ‰å¯¹è±¡éƒ½å¾ˆç¨³å®šï¼Œåƒåœ¾å›æ”¶å™¨çš„æ•ˆç‡é™ä½çš„è¯ï¼Œå°±åˆ‡æ¢åˆ°&ldquo;æ ‡è®°-æ¸…æ‰«&rdquo;æ–¹å¼ï¼›åŒæ ·ï¼ŒJavaè™šæ‹Ÿæœºä¼šè·Ÿè¸ª&ldquo;æ ‡è®°-æ¸…æ‰«&rdquo;æ•ˆæœï¼Œè¦æ˜¯å †ç©ºé—´å‡ºç°å¾ˆå¤šç¢ç‰‡ï¼Œå°±ä¼šåˆ‡æ¢åˆ°&ldquo;åœæ­¢-å¤åˆ¶&rdquo;æ–¹å¼ã€‚è¿™å°±æ˜¯æ‰€è°“çš„&ldquo;è‡ªé€‚åº”&rdquo;æŠ€æœ¯ã€‚</p>
<p>å…¶å®ä»”ç»†æƒ³ä¸€ä¸‹ï¼Œ&ldquo;åœæ­¢-å¤åˆ¶&rdquo;å’Œ&ldquo;æ ‡è®°-æ¸…æ‰«&rdquo;æ— éå°±æ˜¯ï¼š&ldquo;åœ¨å¤§é‡çš„åƒåœ¾ä¸­æ‰¾å¹²å‡€çš„ä¸œè¥¿å’Œåœ¨å¤§é‡å¹²å‡€çš„ä¸œè¥¿é‡Œæ‰¾åƒåœ¾&rdquo;ã€‚ä¸åŒçš„ç¯å¢ƒç”¨ä¸åŒçš„æ–¹å¼ï¼Œè¿™æ ·åšå®Œå…¨æ˜¯ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè¦çŸ¥é“ï¼Œæ— è®ºå“ªç§æ–¹å¼ï¼ŒJavaéƒ½ä¼šå…ˆæš‚åœç¨‹åºçš„è¿è¡Œï¼Œæ‰€ä»¥ï¼Œåƒåœ¾å›æ”¶å™¨çš„æ•ˆç‡å…¶å®æ˜¯å¾ˆä½çš„ã€‚Javaç”¨æ•ˆç‡æ¢å›äº†C++æ²¡æœ‰çš„åƒåœ¾å›æ”¶å™¨å’Œè¿è¡Œæ—¶çš„çµæ´»ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯æ˜æ™ºçš„é€‰æ‹©ï¼ˆè™½ç„¶å®ƒåªè·Ÿå†…å­˜æœ‰å…³ï¼‰ï¼Œéšç€ç¡¬ä»¶çš„é£é€Ÿå‘å±•ï¼Œæˆ‘ç›¸ä¿¡ï¼Œå¼€å‘æ—¶é—´è¦æ¯”è¿è¡Œæ•ˆç‡é‡è¦å¾—å¤šï¼</p>
<p>å¼•ç”¨ï¼š<a href="http://fhz1980.blog.163.com/blog/" target="_blank" rel="noopener">http://fhz1980.blog.163.com/blog/</a></p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> gc </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¸€åˆ»é’Ÿç²¾é€šæ­£åˆ™è¡¨è¾¾å¼]]></title>
      <url>/2012/12/27/%E4%B8%80%E5%88%BB%E9%92%9F%E7%B2%BE%E9%80%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p><span>ä½œè€…:&nbsp;maXiaoKe,&nbsp;ã€€å‡ºå¤„:javaresearch</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;æƒ³å¿…å¾ˆå¤šäººéƒ½å¯¹æ­£åˆ™è¡¨è¾¾å¼éƒ½å¤´ç–¼ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¥æˆ‘çš„è®¤è¯†ï¼ŒåŠ ä¸Šç½‘ä¸Šä¸€äº›æ–‡ç« ï¼Œå¸Œæœ›ç”¨å¸¸äººéƒ½å¯ä»¥ç†è§£çš„è¡¨è¾¾æ–¹å¼æ¥å’Œå¤§å®¶åˆ†äº«å­¦ä¹ ç»éªŒã€‚&nbsp;</span><br><span>ã€€ã€€å¼€ç¯‡,è¿˜æ˜¯å¾—è¯´è¯´&nbsp;^&nbsp;å’Œ&nbsp;$&nbsp;ä»–ä»¬æ˜¯åˆ†åˆ«ç”¨æ¥åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“æŸï¼Œä»¥ä¸‹åˆ†åˆ«ä¸¾ä¾‹è¯´æ˜ï¼š</span></p>
<p><span>ã€€ã€€â€œ^Theâ€:&nbsp;å¼€å¤´ä¸€å®šè¦æœ‰â€Theâ€å­—ç¬¦ä¸²;</span></p>
<p><span>ã€€ã€€â€œof&nbsp;despair$â€:&nbsp;ç»“å°¾ä¸€å®šè¦æœ‰â€of&nbsp;despairâ€&nbsp;çš„å­—ç¬¦ä¸²;</span></p>
<p><span>ã€€ã€€é‚£ä¹ˆ,</span></p>
<p><span>ã€€ã€€â€œ^abc$â€:&nbsp;å°±æ˜¯è¦æ±‚ä»¥abcå¼€å¤´å’Œä»¥abcç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œå®é™…ä¸Šæ˜¯åªæœ‰abcåŒ¹é…ã€‚</span></p>
<p><span>ã€€ã€€â€œnoticeâ€:&nbsp;åŒ¹é…åŒ…å«noticeçš„å­—ç¬¦ä¸²ã€‚</span></p>
<p><span>ã€€ã€€ä½ å¯ä»¥çœ‹è§å¦‚æœä½ æ²¡æœ‰ç”¨æˆ‘ä»¬æåˆ°çš„ä¸¤ä¸ªå­—ç¬¦(æœ€åä¸€ä¸ªä¾‹å­)ï¼Œå°±æ˜¯è¯´&nbsp;æ¨¡å¼(æ­£åˆ™è¡¨è¾¾å¼)&nbsp;å¯ä»¥å‡ºç°åœ¨è¢«æ£€éªŒå­—ç¬¦ä¸²çš„ä»»ä½•åœ°æ–¹ï¼Œä½ æ²¡æœ‰æŠŠä»–é”å®šåˆ°ä¸¤è¾¹ã€‚</span></p>
<p><span>ã€€ã€€æ¥ç€,è¯´è¯´&nbsp;â€™*â€™,&nbsp;â€™+â€™,å’Œ&nbsp;â€™?â€™,</span></p>
<p><span>ã€€ã€€ä»–ä»¬ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦å¯ä»¥å‡ºç°çš„æ¬¡æ•°æˆ–è€…é¡ºåº.&nbsp;ä»–ä»¬åˆ†åˆ«è¡¨ç¤ºï¼š</span></p>
<p><span>ã€€ã€€â€œzero&nbsp;or&nbsp;moreâ€ç›¸å½“äº{0,},&nbsp;</span><br><span>ã€€ã€€â€œone&nbsp;or&nbsp;moreâ€ç›¸å½“äº{1,},&nbsp;</span><br><span>ã€€ã€€â€œzero&nbsp;or&nbsp;one.â€ç›¸å½“äº{0,1},&nbsp;è¿™é‡Œæ˜¯ä¸€äº›ä¾‹å­:&nbsp;</span><br><span>ã€€ã€€â€œab<em>â€œ:&nbsp;å’Œab{0,}åŒä¹‰,åŒ¹é…ä»¥aå¼€å¤´,åé¢å¯ä»¥æ¥0ä¸ªæˆ–è€…Nä¸ªbç»„æˆçš„å­—ç¬¦ä¸²(â€œaâ€,&nbsp;â€abâ€,&nbsp;â€abbbâ€,&nbsp;ç­‰);&nbsp;</em></span><br><span>ã€€ã€€â€œab+â€:&nbsp;å’Œab{1,}åŒä¹‰,åŒä¸Šæ¡ä¸€æ ·ï¼Œä½†æœ€å°‘è¦æœ‰ä¸€ä¸ªbå­˜åœ¨&nbsp;(â€œabâ€,&nbsp;â€abbbâ€,&nbsp;ç­‰.);&nbsp;</span><br><span>ã€€ã€€â€œab?â€:å’Œab{0,1}åŒä¹‰,å¯ä»¥æ²¡æœ‰æˆ–è€…åªæœ‰ä¸€ä¸ªb;&nbsp;</span><br><span>ã€€ã€€â€œa?b+$â€:&nbsp;åŒ¹é…ä»¥ä¸€ä¸ªæˆ–è€…0ä¸ªaå†åŠ ä¸Šä¸€ä¸ªä»¥ä¸Šçš„bç»“å°¾çš„å­—ç¬¦ä¸².</span><br><span>ã€€ã€€è¦ç‚¹,&nbsp;â€™â€˜,&nbsp;â€™+â€™,å’Œ&nbsp;â€™?â€™åªç®¡å®ƒå‰é¢é‚£ä¸ªå­—ç¬¦.</span></p>
<p><span>ã€€ã€€ä½ ä¹Ÿå¯ä»¥åœ¨å¤§æ‹¬å·é‡Œé¢é™åˆ¶å­—ç¬¦å‡ºç°çš„ä¸ªæ•°ï¼Œæ¯”å¦‚</span></p>
<p><span>ã€€ã€€â€œab{2}â€:&nbsp;è¦æ±‚aåé¢ä¸€å®šè¦è·Ÿä¸¤ä¸ªb(ä¸€ä¸ªä¹Ÿä¸èƒ½å°‘)(â€œabbâ€);&nbsp;</span><br><span>ã€€ã€€â€œab{2,}â€:&nbsp;è¦æ±‚aåé¢ä¸€å®šè¦æœ‰ä¸¤ä¸ªæˆ–è€…ä¸¤ä¸ªä»¥ä¸Šb(å¦‚â€abbâ€,&nbsp;â€abbbbâ€,&nbsp;ç­‰.);&nbsp;</span><br><span>ã€€ã€€â€œab{3,5}â€:&nbsp;è¦æ±‚aåé¢å¯ä»¥æœ‰2-5ä¸ªb(â€œabbbâ€,&nbsp;â€abbbbâ€,&nbsp;or&nbsp;â€abbbbbâ€).</span><br><span>ã€€ã€€ç°åœ¨æˆ‘ä»¬æŠŠä¸€å®šå‡ ä¸ªå­—ç¬¦æ”¾åˆ°å°æ‹¬å·é‡Œï¼Œæ¯”å¦‚ï¼š</span></p>
<p><span>ã€€ã€€â€œa(bc)*â€:&nbsp;åŒ¹é…&nbsp;a&nbsp;åé¢è·Ÿ0ä¸ªæˆ–è€…ä¸€ä¸ªâ€bcâ€;&nbsp;</span><br><span>ã€€ã€€â€œa(bc){1,5}â€:&nbsp;ä¸€ä¸ªåˆ°5ä¸ª&nbsp;â€bc.â€</span><br><span>ã€€ã€€è¿˜æœ‰ä¸€ä¸ªå­—ç¬¦&nbsp;â€™â”‚â€™,&nbsp;ç›¸å½“äºOR&nbsp;æ“ä½œ:</span></p>
<p><span>ã€€ã€€â€œhiâ”‚helloâ€:&nbsp;åŒ¹é…å«æœ‰â€hiâ€&nbsp;æˆ–è€…&nbsp;â€helloâ€&nbsp;çš„&nbsp;å­—ç¬¦ä¸²;</span></p>
<p><span>ã€€ã€€â€œ(bâ”‚cd)efâ€:&nbsp;åŒ¹é…å«æœ‰&nbsp;â€befâ€&nbsp;æˆ–è€…&nbsp;â€cdefâ€çš„å­—ç¬¦ä¸²;</span></p>
<p><span>ã€€ã€€â€œ(aâ”‚b)*câ€:&nbsp;åŒ¹é…å«æœ‰è¿™æ ·å¤šä¸ª(åŒ…æ‹¬0ä¸ª)aæˆ–bï¼Œåé¢è·Ÿä¸€ä¸ªcçš„å­—ç¬¦ä¸²;</span></p>
<p><span>ã€€ã€€ä¸€ä¸ªç‚¹(â€˜.â€™)å¯ä»¥ä»£è¡¨æ‰€æœ‰çš„å•ä¸€å­—ç¬¦,ä¸åŒ…æ‹¬â€\nâ€</span></p>
<p><span>ã€€ã€€å¦‚æœ,è¦åŒ¹é…åŒ…æ‹¬â€\nâ€åœ¨å†…çš„æ‰€æœ‰å•ä¸ªå­—ç¬¦,æ€ä¹ˆåŠ?</span></p>
<p><span>ã€€ã€€å¯¹äº†,ç”¨â€™[\n.]â€™è¿™ç§æ¨¡å¼.</span></p>
<p><span>ã€€ã€€â€œa.[0-9]â€:&nbsp;ä¸€ä¸ªaåŠ ä¸€ä¸ªå­—ç¬¦å†åŠ ä¸€ä¸ª0åˆ°9çš„æ•°å­—</span></p>
<p><span>ã€€ã€€â€œ^.{3}$â€:&nbsp;ä¸‰ä¸ªä»»æ„å­—ç¬¦ç»“å°¾&nbsp;.</span></p>
<p><span>ã€€ã€€ä¸­æ‹¬å·æ‹¬ä½çš„å†…å®¹åªåŒ¹é…ä¸€ä¸ªå•ä¸€çš„å­—ç¬¦</span></p>
<p><span>ã€€ã€€â€œ[ab]â€:&nbsp;åŒ¹é…å•ä¸ªçš„&nbsp;a&nbsp;æˆ–è€…&nbsp;b&nbsp;(&nbsp;å’Œ&nbsp;â€aâ”‚bâ€&nbsp;ä¸€æ ·);</span></p>
<p><span>ã€€ã€€â€œ[a-d]â€:&nbsp;åŒ¹é…â€™aâ€™&nbsp;åˆ°â€™dâ€™çš„å•ä¸ªå­—ç¬¦&nbsp;(å’Œâ€aâ”‚bâ”‚câ”‚dâ€&nbsp;è¿˜æœ‰&nbsp;â€[abcd]â€æ•ˆæœä¸€æ ·);&nbsp;ä¸€èˆ¬æˆ‘ä»¬éƒ½ç”¨[a-zA-Z]æ¥æŒ‡å®šå­—ç¬¦ä¸ºä¸€ä¸ªå¤§å°å†™è‹±æ–‡</span></p>
<p><span>ã€€ã€€â€œ^[a-zA-Z]â€:&nbsp;åŒ¹é…ä»¥å¤§å°å†™å­—æ¯å¼€å¤´çš„å­—ç¬¦ä¸²</span></p>
<p><span>ã€€ã€€â€œ[0-9]%â€:&nbsp;åŒ¹é…å«æœ‰&nbsp;å½¢å¦‚&nbsp;x%&nbsp;çš„å­—ç¬¦ä¸²</span></p>
<p><span>ã€€ã€€â€œ,[a-zA-Z0-9]$â€:&nbsp;åŒ¹é…ä»¥é€—å·å†åŠ ä¸€ä¸ªæ•°å­—æˆ–å­—æ¯ç»“å°¾çš„å­—ç¬¦ä¸²</span></p>
<p><span>ã€€ã€€ä½ ä¹Ÿå¯ä»¥æŠŠä½ ä¸æƒ³è¦å¾—å­—ç¬¦åˆ—åœ¨ä¸­æ‹¬å·é‡Œï¼Œä½ åªéœ€è¦åœ¨æ€»æ‹¬å·é‡Œé¢ä½¿ç”¨â€™^â€™&nbsp;ä½œä¸ºå¼€å¤´&nbsp;â€%[^a-zA-Z]%â€&nbsp;åŒ¹é…å«æœ‰ä¸¤ä¸ªç™¾åˆ†å·é‡Œé¢æœ‰ä¸€ä¸ªéå­—æ¯çš„å­—ç¬¦ä¸².</span></p>
<p><span>ã€€ã€€è¦ç‚¹:^ç”¨åœ¨ä¸­æ‹¬å·å¼€å¤´çš„æ—¶å€™,å°±è¡¨ç¤ºæ’é™¤æ‹¬å·é‡Œçš„å­—ç¬¦ã€‚ä¸ºäº†PHPèƒ½å¤Ÿè§£é‡Šï¼Œä½ å¿…é¡»åœ¨è¿™äº›å­—ç¬¦é¢å‰ååŠ â€™â€™,å¹¶ä¸”å°†ä¸€äº›å­—ç¬¦è½¬ä¹‰.</span></p>
<p><span>ã€€ã€€ä¸è¦å¿˜è®°åœ¨ä¸­æ‹¬å·é‡Œé¢çš„å­—ç¬¦æ˜¯è¿™æ¡è§„è·¯çš„ä¾‹å¤–?åœ¨ä¸­æ‹¬å·é‡Œé¢,&nbsp;æ‰€æœ‰çš„ç‰¹æ®Šå­—ç¬¦ï¼ŒåŒ…æ‹¬(â€˜â€™),&nbsp;éƒ½å°†å¤±å»ä»–ä»¬çš„ç‰¹æ®Šæ€§è´¨&nbsp;â€[*+?{}.]â€åŒ¹é…å«æœ‰è¿™äº›å­—ç¬¦çš„å­—ç¬¦ä¸².</span></p>
<p><span>ã€€ã€€è¿˜æœ‰,æ­£å¦‚regxçš„æ‰‹å†Œå‘Šè¯‰æˆ‘ä»¬:&nbsp;â€å¦‚æœåˆ—è¡¨é‡Œå«æœ‰&nbsp;â€™]â€™,&nbsp;æœ€å¥½æŠŠå®ƒä½œä¸ºåˆ—è¡¨é‡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦(å¯èƒ½è·Ÿåœ¨â€™^â€™åé¢).&nbsp;å¦‚æœå«æœ‰â€™-â€˜,&nbsp;æœ€å¥½æŠŠå®ƒæ”¾åœ¨æœ€å‰é¢æˆ–è€…æœ€åé¢,&nbsp;or&nbsp;æˆ–è€…ä¸€ä¸ªèŒƒå›´çš„ç¬¬äºŒä¸ªç»“æŸç‚¹[a-d-0-9]ä¸­é—´çš„&lsquo;-&rsquo;å°†æœ‰æ•ˆ.</span></p>
<p><span>ã€€ã€€çœ‹äº†ä¸Šé¢çš„ä¾‹å­,ä½ å¯¹{n,m}åº”è¯¥ç†è§£äº†å§.è¦æ³¨æ„çš„æ˜¯,nå’Œméƒ½ä¸èƒ½ä¸ºè´Ÿæ•´æ•°,è€Œä¸”næ€»æ˜¯å°äºm.&nbsp;è¿™æ ·,æ‰èƒ½&nbsp;æœ€å°‘åŒ¹é…næ¬¡ä¸”æœ€å¤šåŒ¹é…mæ¬¡.&nbsp;å¦‚â€p{1,5}â€å°†åŒ¹é…&nbsp;â€pvppppppâ€ä¸­çš„å‰äº”ä¸ªp.</span></p>
<p><span>ã€€ã€€ä¸‹é¢è¯´è¯´ä»¥\å¼€å¤´çš„</span></p>
<p><span>ã€€ã€€\b&nbsp;ä¹¦ä¸Šè¯´ä»–æ˜¯ç”¨æ¥åŒ¹é…ä¸€ä¸ªå•è¯è¾¹ç•Œ,å°±æ˜¯â€¦æ¯”å¦‚â€™ve\bâ€™,å¯ä»¥åŒ¹é…loveé‡Œçš„veè€Œä¸åŒ¹é…veryé‡Œæœ‰ve</span></p>
<p><span>ã€€ã€€\B&nbsp;æ­£å¥½å’Œä¸Šé¢çš„\bç›¸å.ä¾‹å­æˆ‘å°±ä¸ä¸¾äº†</span></p>
<p><span>ã€€ã€€â€¦..çªç„¶æƒ³èµ·æ¥â€¦.å¯ä»¥åˆ°<a href="http://www.phpv.net/article.php/251&nbsp;çœ‹çœ‹å…¶å®ƒç”¨\&nbsp;å¼€å¤´çš„è¯­æ³•" target="_blank" rel="noopener">http://www.phpv.net/article.php/251&nbsp;çœ‹çœ‹å…¶å®ƒç”¨\&nbsp;å¼€å¤´çš„è¯­æ³•</a></span></p>
<p><span>ã€€ã€€å¥½,æˆ‘ä»¬æ¥åšä¸ªåº”ç”¨:</span></p>
<p><span>ã€€ã€€å¦‚ä½•æ„å»ºä¸€ä¸ªæ¨¡å¼æ¥åŒ¹é…&nbsp;è´§å¸æ•°é‡&nbsp;çš„è¾“å…¥</span></p>
<p><span>ã€€ã€€æ„å»ºä¸€ä¸ªåŒ¹é…æ¨¡å¼å»æ£€æŸ¥è¾“å…¥çš„ä¿¡æ¯æ˜¯å¦ä¸ºä¸€ä¸ªè¡¨ç¤ºmoneyçš„æ•°å­—ã€‚æˆ‘ä»¬è®¤ä¸ºä¸€ä¸ªè¡¨ç¤ºmoneyçš„æ•°é‡æœ‰å››ç§æ–¹å¼ï¼š&nbsp;â€10000.00â€&nbsp;å’Œ&nbsp;â€10,000.00â€,æˆ–è€…æ²¡æœ‰å°æ•°éƒ¨åˆ†,&nbsp;â€10000â€&nbsp;and&nbsp;â€10,000â€.&nbsp;ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹æ„å»ºè¿™ä¸ªåŒ¹é…æ¨¡å¼:</span></p>
<p><span>^[1-9][0-9]*$&nbsp;</span></p>
<p><span>è¿™æ˜¯æ‰€å˜é‡å¿…é¡»ä»¥é0çš„æ•°å­—å¼€å¤´.ä½†è¿™ä¹Ÿæ„å‘³ç€&nbsp;å•ä¸€çš„&nbsp;â€0â€&nbsp;ä¹Ÿä¸èƒ½é€šè¿‡æµ‹è¯•.&nbsp;ä»¥ä¸‹æ˜¯è§£å†³çš„æ–¹æ³•:&nbsp;</span><br><span>^(0â”‚[1-9][0-9]*)$&nbsp;</span></p>
<p><span>ã€€ã€€â€œåªæœ‰0å’Œä¸ä»¥0å¼€å¤´çš„æ•°å­—ä¸ä¹‹åŒ¹é…â€ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å…è®¸ä¸€ä¸ªè´Ÿå·åœ¨æ•°å­—ä¹‹å‰:</span></p>
<p><span>^(0â”‚-?[1-9][0-9]*)$&nbsp;</span></p>
<p><span>ã€€ã€€è¿™å°±æ˜¯:&nbsp;â€0&nbsp;æˆ–è€…&nbsp;ä¸€ä¸ªä»¥0å¼€å¤´&nbsp;ä¸”å¯èƒ½&nbsp;æœ‰ä¸€ä¸ªè´Ÿå·åœ¨å‰é¢çš„æ•°å­—.â€&nbsp;å¥½äº†,ç°åœ¨è®©æˆ‘ä»¬åˆ«é‚£ä¹ˆä¸¥è°¨ï¼Œå…è®¸ä»¥0å¼€å¤´.ç°åœ¨è®©æˆ‘ä»¬æ”¾å¼ƒ&nbsp;è´Ÿå·&nbsp;,&nbsp;å› ä¸ºæˆ‘ä»¬åœ¨è¡¨ç¤ºé’±å¸çš„æ—¶å€™å¹¶ä¸éœ€è¦ç”¨åˆ°.&nbsp;æˆ‘ä»¬ç°åœ¨æŒ‡å®š&nbsp;æ¨¡å¼&nbsp;ç”¨æ¥åŒ¹é…å°æ•°éƒ¨åˆ†:</span></p>
<p><span>^[0-9]+(.[0-9]+)?$&nbsp;</span></p>
<p><span>ã€€ã€€è¿™æš—ç¤ºåŒ¹é…çš„å­—ç¬¦ä¸²å¿…é¡»æœ€å°‘ä»¥ä¸€ä¸ªé˜¿æ‹‰ä¼¯æ•°å­—å¼€å¤´.&nbsp;ä½†æ˜¯æ³¨æ„ï¼Œåœ¨ä¸Šé¢æ¨¡å¼ä¸­&nbsp;â€10.â€&nbsp;æ˜¯ä¸åŒ¹é…çš„,&nbsp;åªæœ‰&nbsp;â€10â€&nbsp;å’Œ&nbsp;â€10.2â€&nbsp;æ‰å¯ä»¥.&nbsp;(ä½ çŸ¥é“ä¸ºä»€ä¹ˆå—)</span></p>
<p><span>^[0-9]+(.[0-9]{2})?$&nbsp;</span></p>
<p><span>ã€€ã€€æˆ‘ä»¬ä¸Šé¢æŒ‡å®šå°æ•°ç‚¹åé¢å¿…é¡»æœ‰ä¸¤ä½å°æ•°.å¦‚æœä½ è®¤ä¸ºè¿™æ ·å¤ªè‹›åˆ»,ä½ å¯ä»¥æ”¹æˆ:</span></p>
<p><span>^[0-9]+(.[0-9]{1,2})?$&nbsp;</span></p>
<p><span>ã€€ã€€è¿™å°†å…è®¸å°æ•°ç‚¹åé¢æœ‰ä¸€åˆ°ä¸¤ä¸ªå­—ç¬¦.&nbsp;ç°åœ¨æˆ‘ä»¬åŠ ä¸Šç”¨æ¥å¢åŠ å¯è¯»æ€§çš„é€—å·(æ¯éš”ä¸‰ä½),&nbsp;æˆ‘ä»¬å¯ä»¥è¿™æ ·è¡¨ç¤º:</span></p>
<p><span>^[0-9]{1,3}(,[0-9]{3})*(.[0-9]{1,2})?$&nbsp;</span></p>
<p><span>ã€€ã€€ä¸è¦å¿˜è®°&nbsp;â€™+â€™&nbsp;å¯ä»¥è¢«&nbsp;â€™*â€™&nbsp;æ›¿ä»£&nbsp;å¦‚æœä½ æƒ³å…è®¸ç©ºç™½å­—ç¬¦ä¸²è¢«è¾“å…¥è¯&nbsp;(ä¸ºä»€ä¹ˆ?).&nbsp;ä¹Ÿä¸è¦å¿˜è®°åæ–œæ†&nbsp;&rsquo;\&rsquo;&nbsp;åœ¨phpå­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šå‡ºç°é”™è¯¯&nbsp;(å¾ˆæ™®éçš„é”™è¯¯).</span></p>
<p><span>ã€€ã€€ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥ç¡®è®¤å­—ç¬¦ä¸²äº†,&nbsp;æˆ‘ä»¬ç°åœ¨æŠŠæ‰€æœ‰é€—å·éƒ½å»æ‰&nbsp;str_replace(â€œ,â€,&nbsp;â€â€,&nbsp;$money)&nbsp;ç„¶ååœ¨æŠŠç±»å‹çœ‹æˆ&nbsp;doubleç„¶åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä»–åšæ•°å­¦è®¡ç®—äº†.</span></p>
<p><span>ã€€ã€€å†æ¥ä¸€ä¸ª:</span></p>
<p><span>ã€€ã€€æ„é€ æ£€æŸ¥emailçš„æ­£åˆ™è¡¨è¾¾å¼</span></p>
<p><span>ã€€ã€€åœ¨ä¸€ä¸ªå®Œæ•´çš„emailåœ°å€ä¸­æœ‰ä¸‰ä¸ªéƒ¨åˆ†:</span></p>
<p><span>ã€€ã€€1.&nbsp;ç”¨æˆ·å&nbsp;(åœ¨&nbsp;â€™@â€™&nbsp;å·¦è¾¹çš„ä¸€åˆ‡),</span></p>
<p><span>ã€€ã€€2.â€™@â€™,</span></p>
<p><span>ã€€ã€€3.&nbsp;æœåŠ¡å™¨å(å°±æ˜¯å‰©ä¸‹é‚£éƒ¨åˆ†).</span></p>
<p><span>ã€€ã€€ç”¨æˆ·åå¯ä»¥å«æœ‰å¤§å°å†™å­—æ¯é˜¿æ‹‰ä¼¯æ•°å­—,å¥å·&nbsp;(â€˜.â€™),&nbsp;å‡å·(â€˜-â€˜),&nbsp;and&nbsp;ä¸‹åˆ’çº¿&nbsp;(â€˜_â€™).&nbsp;æœåŠ¡å™¨åå­—ä¹Ÿæ˜¯ç¬¦åˆè¿™ä¸ªè§„åˆ™,å½“ç„¶ä¸‹åˆ’çº¿é™¤å¤–.</span></p>
<p><span>ã€€ã€€ç°åœ¨,&nbsp;ç”¨æˆ·åçš„å¼€å§‹å’Œç»“æŸéƒ½ä¸èƒ½æ˜¯å¥ç‚¹.&nbsp;æœåŠ¡å™¨ä¹Ÿæ˜¯è¿™æ ·.&nbsp;è¿˜æœ‰ä½ ä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­çš„å¥ç‚¹ä»–ä»¬ä¹‹é—´è‡³å°‘å­˜åœ¨ä¸€ä¸ªå­—ç¬¦ï¼Œå¥½ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ€ä¹ˆä¸ºç”¨æˆ·åå†™ä¸€ä¸ªåŒ¹é…æ¨¡å¼:</span></p>
<p><span>^[_a-zA-Z0-9-]+$&nbsp;</span></p>
<p><span>ã€€ã€€ç°åœ¨è¿˜ä¸èƒ½å…è®¸å¥å·çš„å­˜åœ¨.&nbsp;æˆ‘ä»¬æŠŠå®ƒåŠ ä¸Š:</span></p>
<p><span>^[_a-zA-Z0-9-]+(.[_a-zA-Z0-9-]+)*$&nbsp;</span></p>
<p><span>ã€€ã€€ä¸Šé¢çš„æ„æ€å°±æ˜¯è¯´:&nbsp;â€ä»¥è‡³å°‘ä¸€ä¸ªè§„èŒƒå­—ç¬¦(é™¤äº†.)å¼€å¤´,åé¢è·Ÿç€0ä¸ªæˆ–è€…å¤šä¸ªä»¥ç‚¹å¼€å§‹çš„å­—ç¬¦ä¸².â€</span></p>
<p><span>ã€€ã€€ç®€å•åŒ–ä¸€ç‚¹,&nbsp;æˆ‘ä»¬å¯ä»¥ç”¨&nbsp;eregi()å–ä»£&nbsp;ereg().eregi()å¯¹å¤§å°å†™ä¸æ•æ„Ÿ,&nbsp;æˆ‘ä»¬å°±ä¸éœ€è¦æŒ‡å®šä¸¤ä¸ªèŒƒå›´&nbsp;â€a-zâ€&nbsp;å’Œ&nbsp;â€A-Zâ€&nbsp;?&nbsp;åªéœ€è¦æŒ‡å®šä¸€ä¸ªå°±å¯ä»¥äº†:</span></p>
<p><span>^[_a-z0-9-]+(.[_a-z0-9-]+)*$&nbsp;</span></p>
<p><span>ã€€ã€€åé¢çš„æœåŠ¡å™¨åå­—ä¹Ÿæ˜¯ä¸€æ ·,ä½†è¦å»æ‰ä¸‹åˆ’çº¿:</span></p>
<p><span>^[a-z0-9-]+(.[a-z0-9-]+)*$&nbsp;</span></p>
<p><span>ã€€ã€€å¥½.&nbsp;ç°åœ¨åªéœ€è¦ç”¨&rdquo;@&rdquo;æŠŠä¸¤éƒ¨åˆ†è¿æ¥:</span></p>
<p><span>^[_a-z0-9-]+(.[_a-z0-9-]+)<em>@[a-z0-9-]+(.[a-z0-9-]+)</em>$&nbsp;</span></p>
<p><span>ã€€ã€€è¿™å°±æ˜¯å®Œæ•´çš„emailè®¤è¯åŒ¹é…æ¨¡å¼äº†,åªéœ€è¦è°ƒç”¨</span></p>
<p><span>eregi(&lsquo;^[_a-z0-9-]+(.[_a-z0-9-]+)<em>@[a-z0-9-]+(.[a-z0-9-]+)</em>$&nbsp;&rsquo;,$eamil)&nbsp;</span></p>
<p><span>ã€€ã€€å°±å¯ä»¥å¾—åˆ°æ˜¯å¦ä¸ºemailäº†.</span></p>
<p><span>ã€€ã€€æ­£åˆ™è¡¨è¾¾å¼çš„å…¶ä»–ç”¨æ³•</span></p>
<p><span>ã€€ã€€æå–å­—ç¬¦ä¸²</span></p>
<p><span>ã€€ã€€ereg()&nbsp;and&nbsp;eregi()&nbsp;æœ‰ä¸€ä¸ªç‰¹æ€§æ˜¯å…è®¸ç”¨æˆ·é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼å»æå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†(å…·ä½“ç”¨æ³•ä½ å¯ä»¥é˜…è¯»æ‰‹å†Œ).&nbsp;æ¯”å¦‚è¯´,æˆ‘ä»¬æƒ³ä»&nbsp;path/URL&nbsp;æå–æ–‡ä»¶å&nbsp;?&nbsp;ä¸‹é¢çš„ä»£ç å°±æ˜¯ä½ éœ€è¦:</span></p>
<p><span>ereg(â€œ([^\/]*)$â€,&nbsp;$pathOrUrl,&nbsp;$regs);&nbsp;</span><br><span>echo&nbsp;$regs[1];&nbsp;</span></p>
<p><span>ã€€ã€€é«˜çº§çš„ä»£æ¢</span></p>
<p><span>ã€€ã€€ereg_replace()&nbsp;å’Œ&nbsp;eregi_replace()ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨çš„:&nbsp;å‡å¦‚æˆ‘ä»¬æƒ³æŠŠæ‰€æœ‰çš„é—´éš”è´Ÿå·éƒ½æ›¿æ¢æˆé€—å·:</span></p>
<p><span>ereg_replace(â€œ[&nbsp;\n\r\t]+â€,&nbsp;â€,â€,&nbsp;trim($str));&nbsp;</span></p>
<p><span>ã€€ã€€æœ€å,æˆ‘æŠŠå¦ä¸€ä¸²æ£€æŸ¥EMAILçš„æ­£åˆ™è¡¨è¾¾å¼è®©çœ‹æ–‡ç« çš„ä½ æ¥åˆ†æä¸€ä¸‹.</span></p>
<p><span>â€œ^[-!#$%&amp;\â€™<em>+\./0-9=?A-Z^_`a-z{|}~]+â€™.â€™@â€™.â€™[-!#$%&amp;\â€™</em>+\/0-9=?A-Z^<em>`a-z{|}~]+.â€˜.â€™[-!#$%&amp;\â€™*+\./0-9=?A-Z^</em>`a-z{|}~]+$â€&nbsp;</span></p>
<p><span>ã€€ã€€å¦‚æœèƒ½æ–¹ä¾¿çš„è¯»æ‡‚,é‚£è¿™ç¯‡æ–‡ç« çš„ç›®çš„å°±è¾¾åˆ°äº†.</span></p>
]]></content>
      
        
        <tags>
            
            <tag> reg </tag>
            
            <tag> æ­£åˆ™è¡¨è¾¾å¼ </tag>
            
            <tag> regular expression </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JVMåŸç†]]></title>
      <url>/2012/12/26/JVM%E5%8E%9F%E7%90%86/</url>
      <content type="html"><![CDATA[<p><strong>JVM åŸç†è§£é‡Š</strong></p>
<p><span data-mce-mark="1"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAFoCAIAAADRsrsHAAAgAElEQVR4nOydZ1gUVxuGX8ru0ju4ggIWxIoo2DAaRUXsiCiioIiCNKUjnbVi7ygoSBGl9w7bktiNvUdFURQihA7S9/uxS5WmkWw+8z7X/cOLHWfOzJy955wzc2aBde4ci0JBEAT55wEUEIIg3AIFhCAI10ABIQjCNVBACIJwDRQQgiBcAwWEIAjXQAEhCMI1UEAIgnANFBCCIFwDBYQgCNdAASEIwjVQQAiCcA0UEIIgXAMFhCAI10ABIQjCNVBACIJwDRQQgiBcAwWEIAjXQAH1D1/fOi+vKg+PWi+vJl9uF4ZCafbx+uzpUeXhWevl09zNAr4NXp41Hh5Vnl51Pr7NPt51Hh5Vnp7V3r4t/d2ET71P/xfuP77N3pzC1PRSGF+fBm+vKg8PNtUeXfbRt8nb63Pbp56e9d/7jDT7eNZ4elR5ePd6EHwbPT1rPDyqvHpfDOkNFFD/cDLz0BwtQiTOG69JdeB2YSjuT1erGysSRYiKy9VXP3D/YgE38zBV5SlEosiIqQ7rttzTX+BMJIpIkkfP31xCofTjq+LD2mF6YLVVgavX9y65y+NFsyyJRBE55RmLzP/qYbFah01nZ6mKEIkiRKIIUVxWZNUdD5+G9gWcbs/SNOF8ShxOHnpgs9v3LefLNbJTZIkiRK2D+ttLelxse6qSwnQiUUR11r5NDtVcrhL/r6CA+ofjJmf1EQCgNVo9m/sC8i3dunzraDkAPrWRk8KtPbosUL51sd5QKQLANPWfo63tnutpbwMAYemhczcV9yWgZi+39xtmj5EWk9DZcPf7C8j5oY7WJgCQHKK+cEtPAqqx33hSawRwwiNAED9v6VHl07qAp0361HFzWz8eJE3es2nH9y3nCwOJcRIAMG2P3raeBbQtUV5ODQBGaFE22qOAvg0UUP/4dwmI0rTD/KKG6mQAQbKK4Sqbyk6fut9fNkxLmg9gyIbZRg/cvD+7OuVbWNy2tH7g5NHY+5p9PMptjPZICRN5eGC+ye1/hYCAyE90We9Y6uXL+XTbWvfxQ0W5LyCvMhvrJxYWt7c5fnD37q4jjPQNCqh//MsExPJxubt88jo5AKLS3Mmm7zp9ap+pKjeJADBYw22NTYnPV63W/a+tK7cBEAD+FQISEBAaPnw5P2HkCsv3Hj7sT4u2aG1WGTVpsOL84dwVEPIdQAH1j+4F5MvysEmZMW27uroph3mnV24t8KKwKJQGD/vH69VN1Sebqq+86uBR2zZQ6u38bK3eYXV1l7k62Xaefa6nB3w+mS9xHScNIKw5fCbTpcNHziZmg6QkASZMmh9pvaOR4lFkZhShrm467SdHo22VFEoLhVJoruWppW6qvihqw9abK5f7t2134gQjVaUxALwAID9i6Xg1U/2Nvzl7ltsZRC1RN1XX9tO1/tS27xSnG1rTndTVTRcZ5dq51bP/7uP2YYtRQPuOqJuqr6Da7KjkePArBSQmITN3QcAIfpKiwQ1nzwYKhUXx+mOtmpG6+oqp6tsmdScgT7tfdOZ6tG991i4d09eeXTdRYq17QrvHZToK6DVn39VN1dWdZs254dy2mPOdObO81NVNdQySbF3rKJQaZzOavrqpupa9lnmBr1eBmab9VM5/DDIye+/RsQC+DR4Od1eqm09uLUPHY/hfAgXUP74UkI93nYOZx/QJP5EIQm29BRAbRZ66b8XWAi9Ko7vdXX0VAB4A8mkzp1JvzqrqncyCZ4xWBmE1Za0EO68+19NTkRqct4RrjVUFkFUYbmvm2vb3TxsnTpQiAciZzjN64OrDori++GIMqPULJjVl2OhlZLlRACAsrTh85Mrh0DXTloRscys013IeBwBDfx5l8pqzIV8WxSZSQlQJAFTnnjR3qqFQWJ7Ot01WbBqlOKbTKuTmjVuaYuFc4UP5agFJyAxetpYxl0+Q7+d4G7cqXwrLyy53tqr2pGnrF03z/lJALpbHtaculBCVbt+60GCJ8XbzNuW1+8Xlka6O71jJkaIdlxlhq617r9XjrcdHbfO0WV4z5ae0rk5MSGTNjHm3XShNvpQvx4DKtun5TwMAURnhuefXTNs8ik+En/MfxyuOPLLaNJ9zu8Cr2nFrztSJemTg52ktgpSittqKRFPnyh6OyY8KCqh/dBWQb6OHw5MVY4T4eUFOxUBjmoOW1nb1UerSwgBiWqPnZjl4s3zcisxXzAPgA1isv/WVO7sH4V20ZZHzWEkQUpg91eiFVz/W01ORvJ3urphhLAEgozhZz/oz5++uv00RHyUIIKWxa43NJx9KrwICALkpyupWWlrOC5adNN5wdf0024kqk9gtIKWxxlOmO6/dfNvVs38C8qmwNTysqQAConLKE2y0tJxmTLcepyBK4AMg2y4xfeHm8/UCkhuqt+n1mhHC/EpnzJxLvSksl81+Y5Wnq83y0p+1p6uAvAqMpkyQFAQpRW01TTstLTuNcdryEgCCSnKTLm/jdCdLbec5yYoMBhivOHLjFC3n6RrGw+RHAkiKyFrOsy3pdHzkVEeMWjNDY7uWlr2m2hJFKQAQFhE32ej62YfSs4CIAvxKc5RHbpgxw0FLy3aCspKoAACoacwN3+bJolDq3W3uGKgtBn4C30jjaTMctLSctSYbSIrJg8LPWgapzp7cr+3/ICig/vGFgNqb0Cs2P97h1UihfLY33qumPAhAYdg4n82uLIp3rfPWpGEygrw8MM6Abu/eQKGwfJxvLZlkKA0S8qMsDLfX9Gs9PZXKu8hiKWW8KAgNGj/F6LU3hUXxZXlZnJMQHQIwZsqSeFt2k743ASnIaR1fY1/ets4exoD6JyDvYtu1UTrqplpzvY3tqimUFl/vSstF80UFBQEmz9LLcfD8BgEp62+tsdKbQuBfZ2D1xt2nfpuhySj5hVPnxa5felBTtLOAPF4Yzdgxrb07U+9sETlnvCKAmNSgDcZOLAqFRXG7PlNcVQhAdoib/sb3HhSWt+tzQ21rBSEp+YlWWuYfOh+fkRO1Qyxd6yiUBjfb3CVT1ABAUFRE16LE27elRwEBiSCiPd7slZdvE4VSY7fGQVlODgBGTbM3dWjw9Sy0WHlYFQj8IhqqG196+TRRKCyKy92fJy0QFQAFdctV1mVfNWz3fw4KqH/0MQjt+cl889U1S7xHKY4HgKGjl5o4sCiUZm+3QtM54wl8/KB+fpPDXz4UltvWEM3R40FAY9T02G1fXuu6X09P1DlvufjzWDKIDJObkeTgzfL1qbczMBcTkgAp9xWb3nIGHXoT0IpZS686dmhk/S0BdSybb6On65t1Rumr5pkICUi0duW+VkAkSblZhrb1TsZ7iASJn42uubgVmM7VVxq6YbbeDUvOMj0MQnuV2Vj+brjiqOaY6WyRGWxjUXxZ3luDJUSHApC1lsXZubMXrnbakL52xra1tm3dn9bjI7J1/pqnbuw/uuWvW+IFACQR4Zkb33j7NPUoID5ZMaWo7ZRGzqjf9uxRSloAoKRhbbSt0tPhtt7sOQBCAkKr561KNFqXum5d6rp10Yumzh4sDiCnp6l3143btf0fBAXUlWYfzwpni9sWW29bOJR4si9Q3QrIt8XbrWDr1rsWFrct1p5SHKzWNqTQJg5fr3onEz8JggQPmOmZPXfzbbAztJ8wBEiKS6YZPffo93p6wsvx/opZ6wRASnKQ3Xqneh+PfEP1IcJEEJ13fqNT69epFwEJmM83eLKjwwr/poB8vatdHF9aWNy2MPvFaLErALFtX75JQIOkyXs2uTR6br0sSZAZvSLTbvuvC4bPI2u4LrF5a9+dgHw8imysH1pY3LZYH6o2an7b1tkC8vVhORvbiQlLAejNXXXLqcd7fK3HZ5zbkq3vOMNw/ReQCFl8wa9uFE7N6SIgt22pS6ZBz9FR12I6cv9b8I+BAurKZ9etVB0iAC/AxBAL13IfCotCaXbY6DhxeMcuWLO3W4nZcmsCvwgAEAVlRcWVxEXlSASBTuLwbfJ2/G2OCFmAB6bqJ213zVs/0UQJBFUm2W52Zi/Qv/X0hFfh1mV+4wggJD105oYPXnZZUwiDiCA+1zDbse3pxF4EpOq82PxtxztEfQhoyOxR6//gXNi7GQOqd7GizdXQAQAeXn4BkaESEsriIhK8PHx/S0CuTd6OzNlEMkn78hazSBWl6Sozd25yKO5GQN7V1oY7ZSUVAYCfJCEipiguNliQJNRRQLb640WF+AB05uhfdexTQB1vw/dfQBLyEgZPKZTWJ4O6FxAvD6+4iLiShIRyZ0y05nW40fbjgwLqSqO74139yezL0c71dkWeFBaFUm610moMuYOAPCvtjI8AkAAI/ARh9WXRtq6f3a0Tp4yd2VkcLT7eJaazR4qQeGDWaSPT2Imq84B3ofpPvzqxN9ff9fTEZyeLSO0x/CAuL7H8rtuWs0SCFPD5rN76rv2m73cUkOy0EctucDoIviyK9eWOAvJ1urtghjEALw8vSYI97cOnxXWDr7iI3N8S0I5mH49nKwUVhCaeXGWwW0lh/KR5R61da7oKyJflax0mIaoIwM/HL8ieHuFpf2OR1tL2LpgPa8fGveIiZACYujhkW+sEDl/fRm/vGs/2GWcDKaDt6Uum8QOIiYg7b3Ct+y8N93QLCugLPF3zjOexBUTUWEVzdK+nuD8xUFstz9MuIC/XtxsWkAAAYONys+cuXo2+FJbTJlf1kXxdxeHb4mMVJiGqCBP2zFu0ZIQiH4zZqLX5Hbsd8RXr6QEvx0f6cwyBR0ZI9OyypWL8/DwwN9LcpaJ9mQESUIcvM1tALubHZo4jACjLD9tv6lTt7dvi68OyXakiKsTz9wTU4uP9acOMoSKCG9QmqkpK6mgtotl7dhWQrw/LVn+UqBAPwNLZK36xc6/38W1xtQ6bN4kfOowBtUlztPYpc6daCoVFoXx2soierz1Fad3L1gIMoIC8nB6vmmsIwCMkKrnStsrHl/sVnquggL7A17N8+7qd7PELotAgMXElCXF5IaIwHwAoLZu4/pUPheXl+saEM8Igwpkz5fHCUGPtEH7oRhzej5ZKjBUjSggICvLzg8p0h42OnAGCr1tPt3gWWa48ogq8PDxSgoI8APDTuuvOnh1mBnwHAVXarvaZrADApzJ09Jmt7uyu5dV5kioCPHxtAnI2P6Q1DgD4yco/r7PnLDNXnCzAA98qIEVZ+Ys2vixfnyar5cqigsJEIj8v74a5K+65+La4WF6YO7GTgGz0lEWFAEBo+tJL291YFM8CMx0PVSK0C6jtXAAQBLYuNHi6g8Ki7HhtsNBZQIDAJ6s+dNFVN0rTgAqo9XwBD6+AmHSopWe1D4VFcfhl0vhVEhLKElOc51kWcv0r8A+CAvoS3wZ3x/sLxwnx8XYZIJw+akqMuUc9hcLy9SizXcsZZBWTHkMerCk/eJykoCQBuhXHZ0udyTLs596GrPxp7VVXzqyCr11Pt6WtdbJInT+yrZC2a20LPDpeV79GQBTPiu3rDgOQ2sqjszrVwb3ZzSpl9sQZACQiaagMWVNeXmPwoFEiPAT2c3RsAfk4/DZ/2jIAIBCFpeS6LvNNAlKSk4/cRuk4eAygZK+76bUHheVqFaI9qVMXzMvisLjoYAAQFleWI2vKD54gLUpmNy/bBUT5vGPdabKkCoCMqMQ4srymPHm8hKgcAIhKK+psqfTpeHwGQkC+je52Dw1mrgDg4eFRlB08abC8przcKAGiCMB8tTmplh4NfZzxHwoUUDe0+HrXOltmLpshJ0hq/V4P1p0wL2GLTQnnnohvo6fzqzULHfn5xDgLqJpMX+a/cIy+IoCg8rypmztdxzzMDw2WUYYv52d95Xq6o9nT8dnauToAAHwAmrHWO6o6vR/nqwTk2+ju8GyhpjAfH6c44+ef2epc5+NRYr3hIvuWNgAQBATGagevXewsLCjXJiCKV6XdlozpE5dx/ieJxD/96Jq1/jOFFYUBJGYdNrKv+DYBdbh9DjCZstymyPdLAVFYFI8PG/X2SokrcwqgOH/MQv9l061UAQhSQ0Yav+O8CcCj0Mw0bq7CdNn2S4uynIKnvinNiTNyP5ACorB8vWtd7W4bLPIeBcT2a5yqyfRlDBu7st7m3/yAoIB6wpfltj12tUGInl6Inl6Insk1S/ZkgvYFmn1cX+rrR3IWMH+w3b3M1eK2qV6I3vrMDU5dZqjnr1ubrKcXYmJxz7nLlPSvWk93+HpVO9le1dML0VsZomf7waP10QEOXhXbrW7o6YUYGMZYurAfmK6wX5O0Ri9Eb+NtW9eqLuOgvj6NrrYR+is5O77R6qmrZyOFwvLxKLa1oLH/uMrgooVTla/b6zWrYzsu07YtPb0QPYOL+tuLfXzLONsyf7DdvY7iWWptcUVPL2TNumRr17oe9qjRw/mphUmInl7s2nV5nOkLbnnsbXHWQ2F5ub20MgvR04syNHrg4t31OOvpheiZ/mbhWua+/Zm5Xojemug19uUdXkVS7bSBtl6v9eTqJRtvyO/wWqWKTmVm/9G72tH2bvu++7Z8cU7ru9+W+4cNxul6eiHrN193cG9t3fg2ee94t0Xv4sq2MnTc1n8IFBCCIFwDBYQgCNdAASEIwjVQQAiCcA0UEIIgXAMFhCAI10ABIQjCNVBACIJwDRQQgiBcAwWEIAjXQAEhCMI1UEAIgnANFBCCIFwDBYQgCNdAASEIwjVQQAiCcA0UEIIgXAMFhCAI10ABIQjCNVBACIJwDRQQgiBcAwWEIAjXQAEhCMI1UEAIgnANFBCCIFwDWDdusHJyEARB/nmAhcFgMFwKCgiDwXAtKCAMBsO1oIAwGAzXggLCYDBcCwoIg8FwLSggDAbDtaCAMBgM14ICwmAwXAsKCIPBcC0oIAwGw7WggDAYDNeCAsJg+pXm5paGhmZul+JHy48soLqCgpoXL2pevGj49InbZcH8f6elhVVUVHX16rvm5hZul+WHyo8soIJTp16Ym78wN/8UG8vtsmD+v1Nd3RAT82Tp0ssfP1Zyuyw/VH5kAT1aupQJwAR45eTEYrFaOoTbRcP8n+XevcJ16+Ll5Y8cP34d6893zH9FQE2taWxsZP+jubkZaxKmP6mvbwoNvS8hsZ9A2DV5cmBlZV1TU3NzczO7FrGDdenb8p8Q0EtHx4aGhrq6utra2pqamtra2rq6usbGRqw3mP7k7t1CE5MEHh4KAEVa+sDZs7dqa+vr6+vr6urq6+sbGhrwevbN+U8I6IW9fW1tbWVlZVlZWWlpaVlZWVVV1efPnxsbG7HSYHpPY2NzYODvZPJhAAoAhUDYNXHi2Q8fSisrqyoqKiorK2tqavB69s35Twjo2fbtFRUVxcXFHz9+/PDhQ2Fh4V9//VVZWVlXV9fU1ISVBtNL7tz5aGycwMe3iy0gHh6KiMjeU6euvH37saio6M8//2TXJbyefVv+EwJ6YmtbUlJSUFCQl5f36tWrvLy8jx8/lpaW1tTUYKXB9JLGxuYTJ24oKx9n24cNH99OTc2z168/ef369Zs3bwoKCoqLi9nXM2wEfW3+EwJ6ZG1dWFiYl5f35MmTx48fP3v27O3bt58+faqqqmpoaMAag+kpDx4UGRrGEgi7OgoIgCIgsNvPL/Pq1TuPHj36448/3r9/X1JSgtezb8h/QkAPrawKCgpevHhx//79u3fvPnjw4NWrVx8/fqyoqEABYXpKU1PzsWPXR4w42cU+bKZN8798Oefatev37t37448/2NWJ3QjidsH/n/KfENADS8t37949ffr0999/v3Xr1p07d168ePHhw4fy8vL6+noUEKbbPH9esmpVNJG4u1sBCQrudnW9lJSUdeXKlfv37+fl5RUXF2Mj6GvzXxFQfn7+48ePb926df369du3bz9//rygoAAFhOkpzc0tx4/fUFHpvvnDZurUY8ePR2dn51y/fv3p06cfPnyoqKior6/HRlD/818R0Nu3bx8/fnzz5s1r167dvn372bNn79+/LysrwzYzptu8fVu+dOnlnpo/rY2gXVZW5yIjExkMxt27d7ER9A1BAaGAMF3T0tJy8uTNnkZ/OjJlyqH9+8MzMjKuXbv27NkzbAR9bVBAKCBM1/z1V+2cOaG9N3/aGkHm5gHR0Ql0Ov3evXttjSB8vqyfQQGhgDBdExx8d/jwE0Ti7jbaHkQEoPDz7+Tn38nHR2GjpYWNoG8PCggFhOmaiIgHvr4Md3eqm1uuq2u2o2O6jk4o2z5CQrtWrDi5ePGRhQsP6ugc0NE5YGBwdO/e4ISE9kZQSUlJbW0tNoL6ExQQCgjTNdXV9eXln0tLa0tKqj9+LH39+sO+fblsAUlL7wkICD1+PODQoVMHDpw4ePDksWNnzp+/EB0dnZWVdePGjefPnxcWFlZWVuIjZv0JCggFhOk+LS0tDQ0NVVVVRUVFR47Q2AKSkdkTHh5+7ty5M2fOnD592t/fPyAg4MKFC1FRUenp6VeuXHn8+DFWrf4HBYS1BNN9mpub6+vrKysrCwsLDx+msgUkK7v30qVLISEh586dCwgICAwMDAoKCg8Pj42NzcjIuHLlyqNHj969e1daWoq9sP4EBYQCwnSf5ubmurq6ioqKji0gWdm9cXFxly5dCgsLCwkJCQ0NvXjxYnR0dHJyMpVKvXnz5pMnT96/f88WED4Q1GdQQCggTPdht4CqqqqKi4uPHWOwBTRokF9GRkZiYmJ0dHRkZGRUVFR8fHxqaiqVSr127VrbNMPy8nJ8QUd/ggJCAWG6T3Nzc0NDQ21tbVlZ2alTv7EFRCbv/+2333Jzc1NTU5OSkpKTkzMzMxkMxs2bNx8+fPjy5cuCgoKSkpKqqqr6+nrsgvUZFBAKCNN9Wlpampqa6urqqqurz569zhaQvPzBe/fuXb16NTc3NysrKzs7+5dffrl169aTJ0/evHnT9q47dvMHq1afQQGhgDA9prm5ubGxsa6u7ty5W2wBKSgcev78+d27d3/99Vc6nc5kMm/cuPHo0aO8vLyioqLy8vKamprPnz+zXxSNzZ8+gwJCAWF6C/vXL4KD77AFNGTI4by8vEePHl2/fv3XX3+9evXq3bt32W93KSsrq62txXfUf1VQQCggTN8JCbnXJqD3798/e/bs9u3bV69evXHjxoMHD16/fv3nn39WV1ezR51RPf0PCggFhOk7bQIaOvQI++2av//++7Vr127evPno0aM3b960zUHldkn/z4ICQgFh+g4KaICCAkIBYfoOCmiAggJCAWH6DgpogIICQgFh+g4KaICCAkIBYfoOCmiAggJCAWH6DgpogIICQgFh+g4KaICCAkIBYfoOCmiAggJCAWH6DgpogIICQgFh+g4KaICCAkIBYfoOCmiAggJCAWH6DgpogIICQgFh+g4KaICCAkIBYfoOCmiAggJCAWH6DgpogIICQgFh+g4KaICCAkIBYfoOCmiAggJCAWH6DgpogIICQgFh+g4KaIDygwioqbKy+sGDqnv3OnJv1iy2gO4aGPyRkXE/Lu76xYtXQkNvXrr0KDn5/Zs3KCBMP4MCGqD8IAKqffEiz83tqZFRR64pKLAFdG3kyNsrVlxfvPi3hQt/XbDgyqJFt62t8588QQFh+hkU0ADlRxHQq1cvt21j8vCwjdM7vxCJt21t3zx+XFJSUlNTw/4FS/w1FUwvQQENUH4QATXX15cxGFelpPoWEC/vL2TyvczMly9eFBYWlpeX19bW1tfXNzY2sn9Pjtu7gvk3BgU0QPlBBMRiserev/9j69a+BSQszDQxuXX16uPHj9+8eVNUVFRWVlZVVcX+OV38QUtMt0EBDVB+HAE119dXXLv2K4nUm314eBiDB2dHRPzCZN66devx48d5eXkfPnwoKSmpqKj4/PkzuzvG7V3B/OuCAhqg/DgCYrW01P/557MNG34hEHoSEF1UNFNPLzE+Pj09nU6nX79+/cGDB3/88cf79+9LSkqqqqrq6+tRQJgvgwIaoPxAAmKxmuvrS3/77YqERPej0Tw8OYqKkfv3X7p0KSYmJjk5OScn58qVK/fu3Xv58mVhYSG7EYQCwnwZFNAA5YcSUEtLS91ffz1as+ZXIaEvBUQTF0/S0QkOCAgODg4LC4uKikpOTqZSqbdu3Xr+/PmHDx/Ky8tRQJhugwIaoPxQAmKxWI319X9mZl6Vl+/aCOLhyRwxInTHjjNnzgQEBAQFBYWHh8fFxWVnZ9+4cePZs2dsAeFjQZhugwIaoPxoAmpqaqotLX2watWvIiIdBUQVF4/X0Tlz7NipU6f8/f0DAwNDQ0NjY2Ozs7Nv3rz54sWLwsLCyspKHAPCdBsU0ADlRxNQc3NzQ0NDQXT09REj2htBPDwZqqphjo6nTp06efLk6dOnAwMDw8PDExMT6XT63bt38/Ly2BWosbERb8NjvgwKaIDyowmopaWlqamp+tOnB/r6v4mKcm5+iYklL1kSdPq0v78/uwUUFBQUGRmZnp5+9erVJ0+eFBQUYP8L00tQQAOUH01ALBarubm5vr7+XXj4zXHjmDw8TB4e6sSJiV5eISEhAQEBZ86cCQwMDAsLS0hIoNFod+7cef369adPn6qrq7H5g+kpKKAByg8oIHYjqKqo6OGaNb8KCf0iKkozMkqOioqIiAgKCjp37lxwcHC3zZ+mpiYUEKbboIAGKD+ggFhtjaALF26qqV3V0rpy7FhWVlZsbGxYWFhISMjFixcTEhKoVCo2fzD9DApogPJjCojTCCosfGJmdm/HjvvXr//yyy+pqanR0dGXL1+OiYnJyMi4evXq06dPsfmD6U9QQAOUH1NArNZGUMmDB+/u3n3x4sWtW7dyc3NTUlISExNTU1PZN7+w+YPpZ1BAA5QfVkDsRlBNVdVfxcX5+fmPHj26du0ajUbLycmh0+k3b97s+PAhNn8wvQcFNED5YQXEam0EVVZWFhUVvXr16sGDB+x3QjhQTcsAACAASURBVN+6daut0mDzB9OfXL36ztw8ZfPmJAeHNBTQd8yPLKCWlpbGxsba2trS0tIPHz68fPny8ePHDx8+fPr06evXr9mzT7H5g+lPKirqnj8vfvKk6OHDdx8+fGAL6Pr162wBvX37tqSkpLa2Fp8j+9r8yAJitTaCqqqq/vrrr48fP+bn5+fl5eXn5xcVFZWWluKjz5j+p6WlpaGhoaKi4uPHj3/88cfdu3dv3br1+++/P3nyJD8/HwX0bfnBBcQeCaqrq6uqqiorKysuLv7zzz9LSkrKy8tramrYM79QQJj+hC2gqqqqoqKi169fP3z48O7du/fv33/+/Pn79+9LS0vxVQrfkB9cQCwWq7m5ubGxsb6+vra2tqqqqrKykv0C1vr6eux8Yfofdo++urq6uLj43bt3z58/f/LkSVt3HqfyfFt+fAG1tLQ0Nzc3NTU1NDTU19fX1dWxX0GPbR/MV6VtSLGsrKywsPDt27evX7/Oy8srKCjA12l+c358AbHD1lBb8Ed4MF8bdhViDymWlpYWFRV9/PixsLCQ/ULx2tpaHE/8hvxXBMROS2u4XRDM/2XahhSrq6vLy8vLysrKysoqKytra2vxJ1W+Lf8tAWEwfzNtQ4qfP3+ura2tra2tq6traGjA8cRvCwoIg/mKtA0pNjU1sX/Mkv17ltiy/raggDCYbwl2579LUEAYDIZrQQFhMBiuBQWEwWC4FhQQBoPhWlBAGAyGa0EBYTAYrgVKWCWFrEIEQZB/HrjDusNkMREEQf55UEAIgnANFBCCIFwDBYQgCNdAASEIwjVQQAiCcA0UEIIgXAMFhCAI10ABIQjCNVBACIJwDRQQgiBcAwWEIAjXQAEhCMI1UEAIgnANFBCCIFwDBYQgCNdAASEIwjVQQAiCcA0UEIIgXAMFhCAI10ABIQjCNVBACIJwjb8lIHp9esJdK9tjVlY3oxJqad+6Hhq1IiroqK0N7XLiZxqDxWSyMmIz9+w8ZLUz83hs1ffYz8aMhLsn9hyysjpkZXXIyubYtqOv0nMaGW0LZH08fuLmPr9nKbld/mNpuGeIs9UhK6vMM4GfsgfsNDCYrJTwc47Oh6ysks6cL8yk/SPnHkG4zt8SELUyKuA0kEgA+w8HFmczWUxqWeQZxj63ELeeORv8Mr3T97wpI/mBjw4fP998A+8HCRkNDGZ9xEGTGeoA6sYGB/OoPReAmvHujH9mL9tqJdB64/ppKsAJr4CAxuWLiTVtxsy6HK2/YvXoMZYuu6lxGR03UXh4sZqCKADM0t+YeimjcYBOA53JCvNRliEDwHpLx/tJVG5XC+T/GlpFTNC1A24he/ZnRyTXd/ooI9/vYLKbW8hh/3sJA1afv4LvLKDMx956BqrQW/S3hEQkd1gJvSomNFYXgAeAbJQYnlBNp308bqs/UQHE1Nab7n/dS7sjO4ZuumqxWK+ba4+QtKSq9owZS2fMWDl7RlpEYmuTjVZ5YZf17AkAomTNJa5nooqjglP9/Dg4mYwcRAYAUJm6ztwptu3vfodyj8ZWMRktfR2lFlrm+4NHsv38Us9HFGTmNHe7GJ1ZH+SqJC0HIOXkvPN1RttHjPrM5Dfn/drL04Hfw8LKsnPKoiJu+/mlHj5MjUipZzLa1lmbFHT7NHvJ07eDkmo7bi4znnbkaKqf3+2IqLK0lKfB51L9/Jhnz75L/9vio2a9vxSS6ueXc+zoH6k/hkbp1YkRD/z9Uv1OXAtIqOlpsdyM12HBqX5+tFMn89K4veM5CblOhrrDAJTHLnA5W8pkNNEzipOTi5NzmjLOH1IZrwxyqovMQy/EfWbSG6g5lRlZNVmdy0xNfxd1+cnluJKMrn2C780ACUhYRHrocE1V1Q6MHC1DEuD/QkD0rILTe2wBeAggZ7zrUVpmEz3piuWcOYMBVDQMrCm/BAbe7o78pOTP9Oz8E857l3I2oaEycuxgCQAejnCkB40crtJegFFzTJbu+z0xs4v1m7Jjc7frzlMCMfHJFsZn8pNjcuwX90Nn4vJk96dMavdC4cBoys38cHLXTpKEuPigUUZOGZFdLkccWmjMwkOrhkqKAczZ53uusL3RRy0OPXJ6fvclWG1oeCM64Y6DxRoAEJMcuupQIZPWKkT6a7+Fy8ewFxyxRMfzRW7bAWc2XnBXkpEDgDUWDnfOnXTWnQMA46ZMCQpK+7v1KTkiZIs+AAwaKrfnVAqrgxD/b8l6sXeThRoAjPh5xp7XPS2WcOGQ4SIAGD525LGzqVwtML02/MA2bQ0AgMHDppm40wPPXDnte9re4bT9gSs+W8fIDwHQsjb1oQYG3g70px87EE3ZlX7w1MeOHf+Mi0lejttN7QJ8zryJzWgYwNJ+q4CaabnVaRGPT+3dCSQiwA6PfXfCUyqzUx+yBaSmaeB7+k1UVAeCY9YoDRPvKqDm9ITrnusAgEgScjl0oTSH1px09oTGZJXuvnIds83e7UVahyIx6DWJ0am2CwH4AARlpGUVrTxo8eltn9YlR17d7eluuvtRWk5T+47Q/jzuYqA2HIgCS/RWXY3NrogJTHcxVCaTlclkZRkJfl4+ABASERssN4jzRw4q0ybsfMmk9SKgFnp2cSj7+AjKGLj9Ep/6xYlkNOVml0dFvb4UlWslO0gUAHR3uR57wDlicUVJKQUhR07PB+Dh4RGWHDJokDKZrDxIRppEIrAFlJD+ytvJUQgAxOTJLo/obUJM+32b9vwhnGM1feb09CiOC1po9A8HjIZIigMIOTp5v4oI2muop0wmL9DRiQrL6Glf+st/VkDJ4efM1yqTybNmTQsOSv+uBfhKaClXXZYtHisoJiklIyIE/PxESZm2+iwrLi4tLTtkkCxZUFAQSCLCUkPJZGUyWXPSuFOBqZ3OV9xZ56XzBwvP2Lh0z8Pk7AHrrH2rgCpjAqNNujhB39/v3JWv64IxKqLOXjICAH5BAf2U6NTPdEaJv+OCMYp8/PwkAj+BFwB4+fiIQoKCIp1xdvZ8md5aHgajMTXuVw8zAODhJwoJ6kUGx1a2DfEw6A3pUb9YbVgKPLxSsirmJ4qZdHZLoZkWkTp9xjTgJUyaZ7c/LD9sb4rr8AMn4xoZTBad0XjOXUl6EPARDCwcf0/IYTEZTVRaQw69z24Xm5rEy+lmAAAE4vLLQR3K0052ceDh/T0eKWUdbfucM0dOzwcQJgmv2/cmN6eJyWSlBQVNmTKOIyBmWcT+M6v4AIQGya2hJuc2sUfWGVFpM2ZOAz5+Pj5+PhijqRlwnn1ZZjTlJlPXyA0SAuBbdWZ/RNn3rU//WQH9W2A0RRzZ8NNU4vxlHodOhpsbEIYpaVCCG+nM5tzM6hDvyx47QgJi3mfG/7pk0UJejQ1rjuQzejlHibeN168jqK3Q8XtB7W+1/0q4K6DclGe+jhv5AYAgJLj9ZkZGPTP91rbp0+V55husOmm1atN4ABj201Sfh5mZVZ2po9KaW29jfU4Ij966SIhIACGi0BrKk5S0OnqH0ZnE0BPGywUJBH6QGKlskhWWVNw6dpPnN3vBSD4+GL9pw67HiXG3HcxXE3lVRinFXWI0Zl6MkBgsw8MDczeEBcfUMJisrJhfzf2Clh99159DRM14f8zbkgAEIlhSzn7KonZ3/r6DgD7HhUSYzQUAGRnRsPDMBvYxiTqyUn0CH8xaOWvWylnAO159xeFIdgVtyAwPE5WRAYC5ZhEhcZ+/b31CAXGZWOrsOT9NWepxOLSUlvJsh50lL6+yitLloMw7blKyO7YecDlTmJTRwmS8O7pmowbv1Lk6MeG9NHsZTamXcozX6A5XW+YW+J2vVRy+cxcsty4r5VN8VOfOV2dS0qqodPZKKiIPB68VEwa2gOxvZWY2RB7UGatC4pvj7XyUudu0Pye+NHznqTUysiICAJ27Km3IyUgKC6qoqe0/EFoQl/aZSm/tgsWka0xS5wcAoqiIpIKc3GAxESG5wWqb9rzLzH13eLMiSYQXwNZt9x9p9JasKKqJ0XIRCemJMzecjOnz+FTHBSdtFhcBgqCgGT05tY7R7WKMptzs8suXX5z2tiaJiwDY2rteDY16fNjFZPqYfgqoJTvxnrvNCgBxKQHvkzH1dDqLySwPdNMZNwzUlni6eniungOEkXPnHchnMll0en3MSW8BKXEAWGeXHJ3aktClC0atjg0OIyuNIpOVHfc/TI34ZfHSVZwjOdvc8OSHLrsQeXiZ5lT2cV6zfgM1MKgnAX04aWg+u+2kqOnpuNxjj7UzmKzUwFPjJmmSyRZ27g8Sc1hMJisn8YG7nUXXrkFMtpa2Lpm8wXzb9bhsFjO3KHjvyaUd+8XkHXtOfcz8vmPA39YFYzRmXYpTHjOJTFa29qDFR9wwNDThFHKq4eLD+e3/NzJlguZMMlnZ1C42snXwKD2e5mGtTCaPV1U64B9XT6eXBbosmqSmTCYrrzU/F57ccRnlYYpjth59T81pZmbcc5m3cOhCT/vTeTm0Fia95MKe47riKiONqDE5r/boCcvISYpvSQ6KrWYyyy9QrH42XG/g94ra60WCQft4xtl7PmGUxuTzA9K1/J6D0FnP9xjbzOkw8Dxz9jqvwI/xYTGqE7Q6Dkhv2nbxUgqLmZG308VFkn215wjo1T6tCfIk0N547vylJ/058dkJN7ZtNBDvtc2lomFgTbkZEVGcTe/833Pzd26dO2xwp2XHqfgHpPwVdmKPApnIwwv6FrmR8fV0Joue8/HULqdZY0FQSFN7LiOuj1r74ejevdIAIiQRs+PFubm9NV+ptOog7+EC4nww9djB83/mMgtPm5pNEwQYs3zhrpsX+hAQi5H+Zq+XCwCfCGmY+ZECam4zM+O+s7bWUOKMlSYp586lbFw9AxRmTLH/PaPjtsDMfdfzNDor7mznQej2cwp6eo6Tp8wRERHhHBtBCfHppgbHC5hMFpPZQmeWBbosmThGmERifywqITFSUUlZRrKrgDJCL83XXTREXEKw7TAThIXlZs6cwf6usmhxGauGjxADiTUWUZdTWUwmK/VylMUaCQCCjPRk2zNl7C5zzKFlw1UEYayN9b4XGakvPV29lAYriHQ8eyAzeKiaHeW3hL89mPW1Auo6CE1vyAwLFZSRBoBFOlumaS0SF2+9W0sSFVFbodPmoIhIsrJSl55BWkyqvQkAiEkJuB+LrqPTGzMvRa+fOF4GQHzatm1H87Opny7sO6IjDSAgLbMoMDSpls5oyYh+EXAw7eiFF/GcIZumnLQ/Y4IfhcaXZ+a+2bdOmCS8wmz3s6SsJiazKeXCxWX6C6SG6q1cmXSxt8PVmHD+3EZt0lDFec7nyv/dAkq/66Kto9yhOgweqm5z7G1bhW7LIsNDFxIqog5eMBzWujhBSND+VvzZgCnKQ0ljje33309L7deJp2fnHbZz1ACQkhm2xPKyn1/KXr8zqyWlhQAAYOzsrTY74v3PPYqJfup3NmnTmcLO/70hLebGqeOpFCfv6VPHA4DSsHn2Xi+Czl1WG60MvLygu8s//M9czt2BpqzI7E1r5gOIiQ3RX/ZFW6AjWQm/7NiqAiAmJejsn1BH7+0i05iV/dRrrDCRH2DNRf/Ickb2i936a8cBwPgVun6/h/YlIGZOUeCBI+oAfEShYa73s7IamLGZMydNIoGR6dbf4+N/32pqBKRJk2ZmxjKbc3I/HN4sTBIBUD9yILAoh9mbgORkFBYa7t/hm+q3M3DDfN1hACCkMXkeLYHJYtAbEi+cVx8rTSAAjDVeaxO22y91545982dPBugsoMwnHjoLBokIAczXWXzK2y/Vb3eYzVrjsUASJE3RmkmNzW5iUN/uXTNhsBRoG585H1vHZFZE7D28kgwAQJBQUPN9xaQ1M5mVAY6TFIcAzKO4nCtKiQg1WTkUgDx08BZrn1Q/v+Td3nt/lpAgAQxZcuJg6F+9PD72DwtIRoo8V8/byTvVb1ew+XJ9FQAgjRg+NSPuKwTEYlLLLnj7jFdRBDHFxetPng1Kc9qoKgUSMtKbtwcUswdoqFk1WRmVOdSKqLNnLNYtnTGjjSXTpmuPVuDj5VNUGTtv6vSlM2YsnTppCnmQNIDoqAkbKaG9Pe5LTbzhaLmMJDtmhsO9zH+rgDQ0Z6yl7ArZqqWjDFOmTfW2svVZMHtyJwHNcbbafs7ScKKiAiwyPHTh0ktvm+0K7ZdEQZJ97imb2dJyglomYYHRNfS2Ey9Klp28SlfXtB1Hamhc25huXeqlB6fcQnb6Xtp/LF5Xd+NCXb0JgkKaOi7WduePBj5NzmxMj830sls6ZvJU2Z+sN+x9kdV1R0pDnH1/HjoIZMZrrQ8OjXl2wFmDU6pROj9rG7dvd94KVZWRAACCSsNmRURk9nRkGpIiYiyXAZDkZH9Kictu7L7/xYZRl5aQaywoSABQs0qLSKhlJt0wXrJUDIA8abXViad9C4heFRsSZ6oGQBAUNM5NSKvLDD6vMn4UqO2wP/guN/fdQfsdaiA5eoTZiYTGrKyHbqpCRH5QM40Lia2i9yog0LLeffplVi6LSasI8fPWVQOAUeNVzgdnsWi0mpCdUwQkCAAzdLZkBMfX0JksWmb+UYrrNJV2ATEYrPiTJpOGiBFh8uwFF0+eL81lspj0mvjgjC06MwBIkgLz9kfU0mh1kX42w0bKymlTfAKLqNQCf0ePWXJD5bSWaYmQB5lfz6Q2MbMeusweIycIGuv8T8VURPnvWTkLAESVlFZ5hlQzmS303I/nKFFebiFuR+9HJtfQ/zUCAg0Tp8MP0nNZTFrVpePH9DUAQF5x0IlzmV8jICaLmnrdZq62AgBZYZzG1J9UlEBCatSyLVcTuz6q05AWc/34gY4P4l5wdjlkMJ3ET5q9bO0RR5cOHzkfc3M7uufU08iEno9A2gs3+21AHD5cMyXm3yogAACTzbs3TNFRhlGjVdcvXW48ecLITgJSM1iqZ7/k5+FyMrDI8NCFiBc+1jZDOwhIwJ4RdviAkZ6N3/EHqbkdTvyXmX/6SGhx6yWuOj6Q6mvobGhgveDnWQL8JO1Ve7duPXQo6G1GNmesJyv59ok9O7Rn/wQCkhITNhsb305svVvEZLJyEn+zWKxLBhg60WDbyT8zM14d8ezzQSAhUQndFbteZnV/G74q6mTQOiUA0cGDbG7nUJt6O4a06vjQMBUBAV6Ade5XEtKaci6lLJj/EwCozTDeH1LQt4CYTWkJV9zXAfAKCKiEhcZ/CvFdrzxMfNjKwwciKpjMiogDh1cOA0XFSa6BJYmX4zQ6bIvZq4DGWKaGJ9R29wVryaUWHbMUJokAqHhQjue3PkLSmHAhcKNum4Ba6IzqADtFaRkAMLV2fpTc+qQJLTP/OMVDBYBEFP5p1+vs7Kac0LBRE0YD2drK43l6+nMPK+uxqtMWOpy2nCArqxYfnd3IiE3TGj5cAH7abMeIz25IDA5fq6sKAMKicurzbAwNnQ0NnQ0pd+LSPn839XwnAamsv+AfzWlidDNI328BMZkVUb5HZo4examDYoqjF+4+1fE2QsojW4cjnEPRCUeD1eazxhD4CBOmz9mqv7rDRwaWy5cYzNFer796b1BiDzcNMt8e2OE+DJSUyZER/xYBUSsvX/zNaute41UrgZ8fAGDsMjefEKuZ/e6CxX46v3PXKrXB4zTmjYW2MaDyqJA3aWnV9I4nXmKo/E9bOh1Qr6sRidV0JovJbEiNyXVfpzu6dc1tAuJM+2rDbIf27J8AAEBYmLDeeMvv8en1dCaLyawId/OdPmIIkMfP3xx0OY3FpFbHRtAN1zisWqTLLygIMF1rlsWq5YbDhikDDBqquFRnyabps2dJ/Wy3eX9PAiqL8PPXh349rEjL+XR+30og8QNMsN/3NDW7Lub47p80hwAoz557ODixuB8CYmWnPt1nPwGASIJdx8Of7F2iJi8GOhsCguMbmMyGpLA4s+UjxeTVlux9En58F5CIrdti9S4gwx2/xqc2dfcFa8zKfuo1RZhI7HIx6PIFa6Ex8vfOHSIhCKCww3Xfm/YGfNsDlq03H5gpV1ZqTpWAKWs3pVy6fNN842qV8QscD2XtMBSWEjA5Fv058/zZQUpDQMXX8/D7bCaLmvp8p4vVaAXolDFGq032bD1673Jq3b9HQCusYi8lNX4PAbGY6Q+sVuiT2f4ZNlvf90WneQI9CqgzywzkFeRBVm38T2arWv+4xawvAQkMH66VFvtvEVBGvh/Fq8OZ19B0/vVS7IsTDoeM2zos8w20tZfOW3fC3uzg1PlmCxe296FcfTNj02uiQ5P8PBw9KUEmHSvi1534utjAAAPtLtWwY0aqqK6Y1959M9b+WWcUEAhgvPHY67Scpoy4aKtZkxUAYNhPU9cfc3NLPuiXn8FkMegNKedPCEpLAnhR/PIz4pi6ujoAmnO0I4PjPpwJTjU9W9jz8fkKAVGzi87t1VYk8fHA7GVrqWERzw9uXTmBDCC2dInxjSRqvwREyyoK8PMcAnxEmO/jl6SnpCoOYzbYpMdksphMFjXpvqPlehBXVdJL8vOZD0Q+GOLpF1CURetDQBaU28mtw5NdBdTalYOxh/afLczpXkDNNEbeTs0hEkQAFU+3w/ntnd8vBcT8dGLt/NESoG2w+8DBi0ZLZk2cZH049NkBZw1RkrDtyYIwL2MZsthgo/PHIyuZTBaTWZ8Smeu7zVRXZ+0MTY1O51zD0+N4fvb3mtD7twVkYp8a0/qIeS8CWmx6LiShsXcBUdPuOC9fMQwAAGTkpxvZ3kr+hqkS0dkzftKCoYZGjrdiU14Gnw3Zuyc1puc7XLkJV+zN54PMaJVtt78YvvjbfKOAsj8FnLo4Y7ru5AnjgZeXPQidknTL/3SHyUqUCxvXGQIIiRBXm+9I3Luvw0f+DyIS/4pP/RQT+ZrzPNE3CoiVk/TQe4dPh/E2DpNUxYWEAGDTFquHye3L16cn3PKYOJFvxOypPncS06vD9y5WG92x8qpNVE28zGTRaJ8jDqwVkBQCmd17jhZkdRBQaN83Iysij54zlAEQlR9kd4/ax3SN+sykGw4/66iSBPjBcN1aryUTJ8kBSE/aYH4oP7t/AmLSq+JColcB8AMs190oJCnXaU5Zxuudzk5SICcptFF3OQA/wKrokLgqdlflmwTUYTAbHD335KVzviFNiaHnTZdChy5Yhb+NopQ0AGzZ5vIkpfWLRM8qOLN3tzoAP1F4rNfT7KxGJpMVe3zzpImiKotstmyxWTRRY4ZubETKXxeOH1ckCv5Mydm1gCwporDSJvVS23QWanVs6seAmMJL52PZJ33KeFWSIAlg+gYbGlu+TGp1bNRjP79Uv4M5R8OLqX3P3fuCf0pAP609GRDNnmvWnBKZuG3NFwKiVYTvOTh9wkgx6cGK8iPkgDxU0d7lfOfh9uxPAYFXu5s52IEdu0aPHQMwfup0b6tt9jpaYiMU9XcFfuhBLvVxZ88aawmJKCzSPdrbjZd/VkCcGtDpLljooaUTx/fcFun0NbfYxBkMruxbQEMmT7BK6jIXLC6pPLfjPXV6fVpGSWh8VdvTxhF7NJVHdBAQ/XNyUvHFsLJcWk38pWS1fS+zsxuZzMpgb8PxIwWFJeSHDpukqqqpqrp2mQ4jjtlCpZb5O4qQxAAWBRwLL6F+nYDqE8KjLBYBCMjJLc5MyOl1EJrJYjKbacw8P625KgKCBPbxEZRduHr/haT2lkIfAmLWpcb+sn1Q+zw4sfkH9wT9yama1D+D9hyc33oXmAdg0PZfYls7Kd8kIPYg9FgBCX4A3XV2Vy6nNjCYLHrup3OHduuoQ8dB6KgDc0fKC/DDnBVr0y9E19KYLCajIfXyFbt1usBLkCCr7wmpodFYTCYrI+yy9nR1osZ8DY35GsN157s/zKJXxl2I1OMn8hu5GomIi4hZuO55kUplMZkNWQnvLx+LN3U5PtXhDrspx2CyEo7ZyQ2Rgg6385kZ+X47D41SURs6XFVK9+xR/5vRKTW0r3qot9d6GBh4OzDqY3J247cLKDJeddgwfgD1lYePRVQwmCwGtTT09KkVU7sIqCkrKtVi5vTBIDltga2D1b6VMhIgpqisH3ax46T2hOsGhmatz7tMGqagKAlEEmH4sI6zMoePEhERAUFZGYXxKqqaqqpr52klHjqc3e0AMzX7+fHt1nMFx8yYGR76HR9uGAgBXTxppj1bmUxWJg8aIiUm3mnUBzjzszjPYs1133YkL7ufAuouHU8qnVqVFnPV1feI0pr4kOgq9lWuk4Do9ekxt6zM9o8dHng65n3HuWAZYVE6Ogt01h8/E9VxonNTdvYLip4wURAETWPPx1YxOwoorTE7p6r3wc702GwnM3EASWnBI0Gp9b3ehm/di5x7DqPGyLJ3b4zRas9bcTlN/RYQKycz/6ijGBA5BlpofjksoW0cpC4h7LL5Qo5/iCDmeDQ/M4f1dwTEftBuyDBZXj4ATcdte29cjHoTdjpy9bLZAJ2/YOm3bCdryBD4AVYbGmeej3oTdfHG3m2OmsDHL6IyyvxqKrX1hkDmI4/FusMJAACECStXHHnPZH5OiaHbiHHEKrgo8ER4CZXJYjI/BTlSFoiIACiqKHnvCX4TFfUmMurNEbshkrIAQkaWLvcSc9qPLTXz46ndTpJiwMcDC22Zccl1vc0/6ElAPWXRHrcLJd8uoPQblhNUpfkA1Cw2+VwJj3oTfjZ5k6EO+zrSJiB67rsDNnNVhgBJaN3GTXdjE++5WBoJAYiLK6z1fZ2T220ruyLySIiRxLghsv4nW78XTGZrF6y9EdAjDFrNxdO7li0QUplq5BM0AA8BfV8BccbDGI25ac8PWDlM4SUSCEQAHh4gEIkk0A06HV6cQ+ty8emHgLqbC2bmnBmbzmIym2nUutiggI3LAYCHh2ewvGTExcxGRhcBpTzeZrmVSCAAgITkkA0HwGYICwAAIABJREFU3mam19O7tMYZTdTc2szMquzsGhq1Jvly9DIBAX4gLHOkxibXdxJQXL7f8dDhG3JiM3tu2mS+O7DThx9AjCTidLaC2tezuQxGY8wRH1kFufZqrWG86vDrnKwitoA4U0ySKzIzq+L8/SdPHtNFQLSc0vN+24HEbkLxb3BIj+kwtT09Jt1xIxEAAAgk2O53vjSndYjkGwXEZDGYrIs7xyoM5eXl5RSZj49AJJEI/NDlQcTUwNPjJo0j8fHztu0dLx8fUXmk4gH/Tk9LVwT7rp86mhcAVKes9QmuYDJZOZlvjzgQgAgAsNQhN7at/5XyeJulpQCRxN/ZBgSikIDhuYOXun5bcjLfHnEgAREANnoczk/v/9DJQAuI+Ze/3fThiny8PG2HRoBEEiDwdxRQU+LJgyNGKwMQpi3fc+JSNZNZfulA4GoiEUBMUsDpwKUaGr27wnPqobSMYGhYZgP9awTEYDQmh8StWDqHOMmwn9OP/hUCyryUvlpfh0RQmzLabYONK4CYJHE7hXKSKCNPEti56+D7zs8y9UNA3c0Fy6U2MhgsZtbL/ebbpgiwK72cgqzPkZhG9sWtk4AYzdSkx442lmxLEUhSEoKB56KrOnaes2J+NTfRExQUGTt61s6gt0cdBfiJALDR/fDb9FxWVwFRvHkJQxSkOLLr7uBURAVEGgHwEIXEHH7vtF9fwmjMvBghKT+Yh4envVrzEvhVluk6U89wXsfBw99qYQESiZeXt4uAmNTKyICTrXcbDe28Hid3aAIwMt7s83EFAAASCU4GRFa27fs3C4jJZDFoNcG+k5SGcYo8a8H2XQfYF4NOAmLQG7Kzn+9dsHRs294N+2mqz6OsrC5tw5a0Cxe1f54EAJo/bTwe3cJksmjZf53ba8kWq7nvraS2XgCjmUotCtp5dHlnG5h5/BqV0kD7cqyHWhl59giQSACErZTfk3t8huufF1ALnfrhpL32aEX26ibN+jnkSECsjVEHAaVctRgzToqXF8DYzPJuEqOFyWxhpOXt9XAF4OHhFxNfnR6T2m2TnF0Pv0VAGeGxugu01Oda+p7/1O8J2P+sgGg5pcEHHIFEbBXQh5OG5rNk5YSEBNQ0jfadeLLbxwtATErA7WhEybldrtKDR0pIDtnYYc5LvwTU0+Bf1ou9JuaTRUSJACCnrmaSEhZbnsO5DpT5b1cfKg8dxoAaMjMKz/tfNJsLADw8ICW9Jj7k4m9OOnpqZGUyWXmQLFlEWBAARgwevmnbqa7N9Q4COh/5zMdxIwgOktPLScpp6kFAra8Z4SGSxNwOXyjL6eGmDC2nPPSIzyD5wTy8vACgbxbsH9w6F4xfcKKGroNzb+8DahcQo5mWWxkV/TYq6k1U1KeMrIZO321GY3ZWWVTUm6iot9FRlbnt83hZtNzS5KQ3UVEFiYlVVEan9aR3EASdWpGa/CYq6n18XEXH0Tdq9se4OM4sv6Tk0uycqrSUN1FR7+LazwWbxuzkP9snCcYVJnb3hgcGtTop6WNU1JvExGLOEWM052b/9WV52AeZml2Z0nmm4RfLdHN8elymWxgN2WklCb1Mb0wuz6Q2f3F8WhjUquiYd1FRb9IyatuaJ3Rqt8enOTezKJ5zGD8mJVXnUmsz0t5EReXHRJfm0FqY9M9pcQUxUW+ioorTOI+PdD6nPQ5sNdNyq9Oi3sVEl2elXN06TnMYWZksO4hEIsFsR0v/jz014WNOms3Rkp22xHV3wLvs3u+i/E2+9TmgssizMcaj1JUU5ICHB2YGBwRfcVu5Tl1cQhBAQ8t4t/+bjBT2rXqOxXPTP57ycR06TEFSRnnYor3OJ/L7OwbUk4DotSkX6Y7LPNZO2Us58zQisTw9/dkBS03VsZqqquqKckJEAsBYe9v9r1s130KjVsRfpHnabSRtuHQyrCgr+6nP9FnDxpqsdUw5HXg7MPC2/5EY6w0rpGWHAB+JNPfI2chSzlsI0u47rlipBEKiosOVho8bPEgKxOTJjg9oPZ8bOq008vxpfeDhATkFhytx3T6ZQq9OCEtZzz6GsMLMPi0irjyX3pST9vy41zH7jXsPnLl2xu/0fAABgqCuTYr/6ZuBgbePeXmNHTu8q4AQpDdaGLTK2OD754+FrB47XgZm6KxLCkrusWGem/7yYvjtiOgPGT28w/O78Y0CYpRH+l9cAwDsW7/udxKSiy8fC1830cVk8anjwU/TctqeFWofSKOm5Z08fF5/oovJ2pRznCcJ/4aAmOzXZeZHnf+QSWMxmS25WQUndywFYtuwwHSdDcnn4ms7Nk0Z9Ib05GcHYypotGYmsyYh4NqJs0+jUjjL0HOrosNyNm8yklwTeCC4MLttfLTtta2cyA2S9fHo45WsTbkZ7/xtLIFAAMVpHkefp2d/eRgbc9Lfntl5yoBoZ+d6Izq5lsa5MjdlpfyZHPMhM6u/g9AI0i+oZZFnrxz1uxEWUdJ1bjZX+NYuWENW8pvzbiFubiEebiHhcVVUOotJ/SviRF50SCnn7Z/U6tiou25ul3w97yRkNnPuO3RZpm09Hhc9w4s7NShaX6zttjfzSExlf0rFoNelxNxw8whrnepCCw4r/toH0ujU6vi4ezsvlXeRS1by7VPH2ybRxO7ZmZfe59roDWmJ9zYuFyIIwij1pd6H7qdkfblYM5VWesnzj9S2LnqnNXxOi392wi3Ey+PiuZgqOnvOYeofhw8nurkxAgfyhzoQ5J8AfxdsQKHTGxJCT9jaH7KyOnQq6PWAv+IbQf6/QAEhCMI1UEAIgnANFBCCIFwDBYQgCNdAASEIwjVQQAiCcA0UEIIgXAMFhCAI10ABIQjCNVBACIJwDRQQgiBcAwWEIAjXQAEhCMI1UEAIgnANFBCCIFwDBYQgCNdAASEIwjXgHuveb6zfEARB/nmgmdXcxGpCEAT55wEWBoPBcCkoIAwGw7WggDAYDNeCAsJgMFwLCgiDwXAtKCAMBsO1oIAwGAzXggLCYDBcCwoIg+lXWlpYTU0t3C7FjxYUEAbTr1RW1r95U9aCCvquQQFhMH2noaE5K+vVmjWx1dX13C7LDxUUEAbTd549K7aySlNWPh4Wdp/bZfmhggLCYPpIU1NzTMxjBYWjAgJ75s4N/fy5sblzWrBj9q1BAWEwfeTp00+Wlml8fLt4eCiDBx+OjHz4+XN9Q0NDfX19Q0ND4//aO/N4qLrHjx9ky5KiTJRSSWlTUQlFIgntppRoz9NeKiVFaCqRfd/XMfZ1Zsx227VoU0qblD2EsTPm98dYxq7i63n8zvv1+Wtm3Llz77nve8655xzNzS0tLQwGY6R38z8JFBAE0h8tLYzQ0NcyMi4AWAFgxctrq6ERVFJSWVNTQ6fTa2pq6urqGhoampuboYP+ACggCKQ/3r//eeRICg+PDUtAHBzWIiI3wsIy8/OLS0tLf/78+evXLzqdznIQbIv9LqNTQJX37pUTieVEYkNBwUjvC+Q/TEtLq5/fi3nz3Fn2YYWL69ratYHPnn3Izc3Ny8srLCwsLy+n0+mNjY2wEvS7jE4BvTcyeq2p+VpTs4JIHOl9gfyH+fKlYt++RF5eW3YBcXBYCQjYeXhQnz59lZ2d/fnz54KCgoqKirq6OlgJ+l1Gp4Aypk9HAEAAKAoMbG1tbW1tZX9gAYsIZDAwGK1+fi8WLPBgt09HtLR8Y2IoT548ef369efPn4uKiqqqqmAl6HcZ5QIqDAhoaWlpbm5uaof1zAI6CDIg+flVu3fH8fHZ9iogAQFba+uo1FTSw4cP37x58+3bt7Kysrq6Oli6fotRLqB8P7+Ghoa6urqampqampra2tr6+vqmpiZ4m4L0T2tra2Dgy76qP6yoq7t4eESTSKQnT558+PChsLCwuroaVoJ+i1EuoO8+PjU1NZWVlWVlZWVlZRUVFXQ6vb6+HrbVIf1TUVG/bRuur+pPeyXI5uxZ/9jYRARBXr16BStBf8AoF1Cup2dFRUVxcXF+fv6PHz8KCwvLyspYt6mWlpaR3k3Iv5fg4Fdz57r1Yx9WVFUdHB3DCARCRkbGhw8fioqKYCXotxjlAvri7l5SUvLt27dPnz59/Pjxy5cvhYWFv379gg8sIP3Q0NCioxPOz99f9YcVISGb48d94uISaDQarAT9AaNcQB9dXPLz8z9+/JiVlfXmzZvs7Oy8vLzS0tLa2looIEhfYLFvZ8xw5uAYwD6sR/KrVzs4OHRWglg9QbCfcZCMcgHlODvn5eVlZ2e/ePEiMzPz9evXX758KS4uptPpUECQvggNfX3yJP7gwaSDB5P2708wNo5ZudKHZRw+vmtr1txZtcpeWfnGypUYZeUbGzc6XL8ekJDQWQkqLy+HlaBBMsoF9MHJKTc3Nysr6+nTp0+ePHn58uWnT59YDXUoIEhf5OdXffxYnpPzMzu75PXr/CdPPl+6lMYS0Pjxtrdu+dvYeFy54mxp6WRp6WRj4+bpGYDD4YhE4pMnT3Jyclh3uKamJljABmSUC+j9nTtfv3598+bNkydPHj9+nJmZ+fHjx45KMiwfkH5obW1tamqi0+klJSUODhSWgMTEbENCQnx8fNzd3d3c3Nzc3Ly8vAICArBYbGpq6sOHD9+9e5efn19ZWdnQ0ABbYQPy/0VAGRkZjx496hBQVVUVFBCkfxgMRmNjY3V1dVFR0e3bZJaAJk60CwsLCwgI8Pb29vLy8vLy8vPzCw4OxuFwaWlpDx48yMrK+v79O2tmBmyFDQgUEATSOwwGo6Ghoaqqqri4uKMGNHGiHQ6HCwsLCwwM9Pf3DwgICAkJiYyMTEhIIJFIGRkZ79696xAQbOYPCBQQBNI7rBoQnU4vLS11dKSyBCQujklJSYmNjcViseHh4REREdHR0YmJienp6Q8ePHj58uXHjx8LCgrgUI9BAgUEgfQOg8Foamqqra2tqKhwcbnHEhAKdePu3btEIjExMTEuLi4+Pj41NZVCoTx69OjVq1c5OTk/fvwoLS2trq5uaGiATbABgQKCQHqntbW1ubm5oaGBTqd7eDxiCUhC4lZmZuaDBw/S09PxeDyBQKDRaE+ePMnKyvry5UtBQcHPnz+rqqrq6urgUKDBAAUEgfQOaxUXloN8fJ6yBCQpaZ+dnf38+fO7d+9SKBQajfb48eM3b96wVuRgrY7Isg+s/gwGKCAIpE9YDmppafH3z2QJaMqU21+/fs3Kynr8+PG9e/cePHiQmZmZk5OTn5/P6veBS778FlBAEMgAsJbm6BDQ9+/fs7Oznz59+vDhw8ePH7OG15eUlHQMPoTlavBAAUEgA9MhoKlTHfLz8z98+PD8+fNHjx5lZGRkZWXl5ub+/PmztrYWLrHwu0ABQSAD001AOTk5LAGxup+hgP4YKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIYJKCAIZGCggIaJ/7yAmn7+pL9+TX/5kj2PJCRYAsoyM/uQkvICh3scGvowOPhpZGQ2gQAFBPldoICGif+8gKoePfp85kz2zp3suS8gwBJQxpIlT/X1H+no3NfSuqel9XDjxpcWFgUFBVVVVY2NjVBAkEECBTRM/OcFVP3kyTsDA4SDg2Wc/nMPhXphZfXjx4+Kior6+vqWlhYGgwFXEYcMCBTQMPGfFxCjtrbQx+fBuHEDC4ib+/7Spa/v3//69WtJSUl1dXV9fT38JyqQwQAFNEz85wXEZDKrnz17t3XrwAKSkLh38uTz58+zs7Pz8vJKSkoqKytramrq6+ubm5tZVaGR/imQfylQQMPEaBBQS01NcXDwPR6e/uzDyUlVUEiPirp//z7LQbm5uUVFReXl5XQ6vaGhobm5GQoI0hdQQMPEaBAQs7WV/uJFlr5+PwKiTJ6cum9fQlwcHo+n0WgZGRmsf6dbUFBQXl5eU1MD/5M3pB+ggIaJUSEgJrO5srIoLOxuX5UgTs40BYVIB4fw8PDo6OikpCQSifTo0aM3b96w/qdldXV1Q0MDFBCkL6CAholRIqDWlpbqrKyXmpq9Cog0aVLMjh3+3t7+/v6hoaFRUVHJyclUKvX58+cfP34sKiqqqqqCAoL0AxTQMDFaBNTa2lBe/iMg4O6YMT2rP0kKCgGWlp6enl5eXiwHxcXFkcnkZ8+esQRUXV3d2NgIBQTpCyigYWL0CKi5sbHy/ftnK1fe5eLqUv2ZOBFrYODu5OTq6uru7u7j4xMSEhIbG0smkzMzMz9//lxaWgr7gCD9AwU0TIwSATGZTAaDUV9RkevhcW/s2E4BcXAkrVgRcOmSq6uri4sLS0BhYWGJiYl37959/fr1t2/fysvL6+rq4FAgSD9AAQ0To0dAbZWgr1+fKire5eZmCYgqJhZjbOzj5ubm5ubq6urp6RkQEBAVFYXH4zMyMj58+MCaFwbbX5D+gQIaJkaPgJhMJoPBaKip+ers/EBUlFX9IampxWAw/v7+np6eHh4ePj4+oaGhCQkJNBrt1atXHdUfOAgI0j9QQMPEqBJQa2trc1NTVX7+MwWFu9zcd0VESGfOxGOxISEhvr6+Pj4+sPoD+TOggIaJUSUgJpPJYDAaGxs/37jxUELikY7OvYCA1NTUqKio4ODgoKCgsLAwWP2B/AFQQMPEaBNQa2trc3Nz1ffvmWpqb1xcMh8/plKpiYmJWCw2MjIyJiaGSCRmZGTk5OQUFhbCp++QQRIS8oqHx4aHx2bGjDtQQEPIaBMQk9UTVF9f/OjR97dv32dnP378mEgkJiYmJiQkpKamdnv4Bas/kMGQmVlobk46f5547RoZCmgIGYUCYlWCaiorf5aW5ubmvnr16sGDB2QymUQiIQgCBx9C/oDGxpaKirrS0ur8/J8FBQU5OTmZmZkZGRlPnz59+/btt2/fysrK6urqYHH6XUahgJisSlBDQ1VVVWFh4cePH1++fJmRkfH48eNnz569e/fu+/fvsPoD+V1aW1ubmprYC9WzZ8+eP3/+7t27vLw8KKA/Y3QKiFUJqq2tLS8v//Hjx8ePH9++fZuVlfX+/fvc3NySkhI6nQ6rP5DfgiUgOp1eXFz89evXrKysly9fvn79Oicnp2ONTViifpfRKSBmeyWourr658+fBQUF3759y83N/f79O2sdMtZ6rLD6Axk8bU37mpqysrIfP37k5ORkZ2e/f//+69evxcXFlZWVcD7zHzBqBcQqLvX19XQ6vaKi4ufPn6WlpWVlZVVVVXV1dXDmF+R3aW1tbWlpqa+vr6ysLCkpycvLy83N/fbtW8eSUrBO/QeMWgExmUwGg9Hc3NzQ0FBbW0un06urq1kLsDY1NcHqD+QPYDAYTU1NNTU1v379Ki0tLS4uLikpKS8vZ60vDgvVHwCKipijNYWFrQUFjPz8lh8/mvLyGvPyGr5/b8zPby4oYBQWto747sH851JY2Jqf35KX1/D1a+2nT1UfP1Z+/Fj15Qv927f6Hz+aCgoYI76H/4mUlrIJCEGYozs0WiuVyugIjdZKo7WO+F7B/EdDpTIolGYyuZFEakhPr09PryeRGimUZiq1BZarQSYj4/+TgFhheQcWEZi/DNv9rKU9HTe2kd+9/0T+PwoIBmZoA29pfxwoIBgYmBELFBAMDMyIBQoIBgZmxAIFBAMDM2KBAoKBgRmxQAHBwMCMWKCAYGBgRixQQDAwMCMWKCAYGJgRCxQQDAzMiAUKCAYGZsQCBQQDAzNi+VcKiNZMwtPx5BZqzynFtGYKiY7H1+DxjZS+JhzTmikkOoFQ2/0DtBZSeh0eTyemN/Sy5d8Lg0puIOLpeFYINSTq0E5EZFCItUQ8HU9sIA/xlmFg/kX59wmIWk/CpRqPFxM9SvFNrO/2Lj4ab7NPkJ9fYtz4qzdxjenUXrbA+oz4FLnLocwuDoq9v1t/Iz+/4NI1hx2j/24nCZ9cDh5X4Rfk5xfk5xcUlZhj7FI2pA76hFmoKMcvyK9icdAljzDiJwUGZngyRAJKL4928UShpneLurqBurpBz9e7ZeUmS7uwGtamqOkV0fbnRHl5OITE9c3vhSWXh9kd37TSYNMechiBmYZLtjICAAjz8l28HtXQm4Cqou299wkCTkHUpP0Po0kt1I63YhC0thYAYL6KiX1Urz+kOszu+KaVA+wtCjUdJS45QVCIF7TBMU5S1CIHT2EM3YnJsZWdNxMAsO7aEb9S2kiXkr8JBV8YZHsBJTkHZUwKSqmntL1e5HfAbBNqOmrVQR2Xgr/ZPhFLPr6ro4wpyM5zdU9m/nUNdzQEH4zdoqWJQrVdOx2v0yi14dZyc2Wmo1AnT9p9jCeN5E4OkYCIP7G3b4AeLFy4auHCVT1f74as2j+WQdUIwkSQFlJKlsPuSbzcHAAcO+ucl5T61lZ//Xw+ISHl04bepQMLiFwUcvX6egAEJ0jtc60msNdKBhZQS5K3p57y3AF3mMVMed2TmGfe3s+8/V77JtYPstDjbuupr1SQlTU7fvVdXF/nPu3xKRlZSQDktt+5EUnveJ1KKA65aSMrq9BLNluZ+JYiSBMhPuPmPgVZOWXZI3dDUhuog9ilLiEVBoW8svUoGvSfNFOI7zALVZbKKsga4W5F/iJ3ebcJH3v/2jYxwMEDRCyuBf3Ct52yX8GXj+jIzJVb5X4jtnGQ30UhFgZbKSyY1+WHy0jPWqKx94DVXW/vR25uZBvbRwHhv6jDsDQPMZJ42NCI7av1lq8kYhEm++0hwddq7+bezo6sgqysjbVncQq5x5apNakhqUdkFeRkFWRlgxyCf/VZ4aU1I9jklcs12LZ5Ye+xrITeP5/vprdFXoAfgFVqm5KC8ExCyq9Qzwxfv2eJhDdW08eKcAGdQym+0XVkGpOYVBYX8SUmoZTtq1sR5JffOV+zo1HukUVpQ30wOzJEAqI2EhM/Y+ziLQ9uFxEcCwB6o3HAVUyyu/sjd/dHGEwyK7ZW/kf1AfcYALSvHbsc2/G6i09WDL65/WTE70UBbg4AtKOdcXRKLG3HqlUCAEiqHj7uVzGggMiJbzBHjcWAyPgJRtccU1RVNysp6bZlqZLEpIkAAKEJU+Yu0e18XUlXSSnaNbyKiDAp+IJAn/ttO2Ybbr7/iEKncIwNj4Vbte8zBhOLsQy+bU0MJQz2KNGo9dGO21bL84/lVdPaEecW9ovYWxMSQZgINkF5hjQvABomvj7xLZ1XYNp3X4sDvetQ0UTbOR9BGtNw6RY6AIzhB5sTfZPrKIPbN1bSY55YHj+xQO/MBvu8Qf9VExn/9CL/2HEAgLVul4N+prO/S/kV5xG0c9JYbh6DPRdeRqY0tTeKq8Ps/tFbqKC4JtIvtc+Np4T6XzjUeZpWLFuzeDbv5uOOW4RFxwMAAFiqdeqkZUf5YVCp9WlpdDx+sEYbdOiR9pa7tJagRMexHXF+Ht4lCqu2YcLqiZS2T8Y4m2gr9nXDkpKW0ziBeRrTtcBQCUUhdudRAHAAAMCcw5h3ccSeO9BCxn/2PKOzaukiXh4etm1OniShvH7PTfvI2m5/QgiN0F8oJwQAAKKiKEX5ZbrLFLUWyi2fN3+FwjKVWVxcYwCYMltlyTJdJSXd5QqaSxatXrz+3C77L2wOakwOo11S1FGX1zC9SsamDe0hbctQ9gHRKLVYa8WJItxAzt7cs4iAMBGkMvoW9ry2iba2iba2idbabUpygIsTgNlaSmt2a7e97n7uypfktpNRHIaxkAKAAwC1K6+xaS1JnufUlkwCAMhrnrqFbRpIQI1JQZHHN0gBgeliawL8XNz4eHl7KQm9cMPK+2dXzdcm+aZeUlwxBQDOMbxLt9mfMnuNTaxvv703JIXEmBuuU5TbtMGQGDYYB1Hq0yPwa5bw83IDOS3Pm/4/e9qHkv4z0tFEb4OJturqcYKCAABJGRVljbajt2Of/Q2/D74WBwDgAmCt3l63M+cDzc09Dugvn4MaCgGl53uduqA+VRzM36g0RAKipH7xsjg1hX8Sn35yeGozWyWxu4BolJa0mPyYmPxUSmermZj4zNsp0Ny8I37m566dW71FkXesxqar/5wJdPX/lExi4vH0mJj8pKSy4bhCEIRJjEzapbVITLCXcsPJxS+nhPeLbysY/QoIAACmbXK3CWGvJDYT4p9gjGQ6PjDTMMohqrprLbI5PSnL9bTeEinAydHLNgXFpNV33PRNYP+TIo/Nm+aKbF614cL2ZSpzwHyZBeb/mAeam/ucOWO1fv3+9ettzpzxO7J1utQksHDVgf0nA83NA81t02+HlXf96iocJuECepG6usr+i/iIvm8Vf5whFFArlVzsdURAVBCALUHXwn9RECaCFAWYmq0f4OLfro3OiEGYCNKQFnH/yooFAHABoHzGrSiZVBdyVXuFDAAAoKQV1uibbdXbvFIOAMDDNWa5qu7pbQZmaLQZGh2Icf2eTGYiSCX2ur2hJOAXn6dm8TY17sXxY3dMTe1NTS/qTpuBYv9OYSmxlcf3mdqbtuVJaFxd56EnV+BcY06orpUDQmMFtTcdcLodUZVO6ajVV+IwoafUV85BAWHxJVp7ieHJAx4cBgX/1e+0Bh8PF5i785jTh3hiS8+PkfG5XqcAL3fvh2mynOYRhze+FgcA4AbguIVveRqFiSCVQZY71GSHQkD4t3abti0EYOgE1JyGJVnumAt4Bccs37t1+1k02qw9J3RU5GdOFEdJ6a7bYoZGmxlsP71J22S9tsnGK09DU+p7aTmSa5LDSNu3miwfs33rbjun0OI0MhNBmGm4ZKuzR7W1TfR22R51ziMO9RWCILVhV3ctkh4HAJgsp7Xe0M7U1N7U1Hbvtt0rAAAhgcDsAAAc/UlEQVSACwCNC97FqWQm0imgKVNn7dq+v6N03TLde3iZoBA/AEDy8D7r7ISOhhi1Kt4nYu8MwMnJNX++Mg8PH5h27qRDbjKFbQdIZRGuXitmtBWDFXqX9h5kbdZyq7ziTAAAACIz1TZd7/ztiX5m+tM0tdZG3Pb77n/pqN7M6ZJKNscCvkb7P9i1K+n8hUB7v+J0MiPF84Ki3GRpnRuWgRXkvo9AGjbi7A55NdW9hy3eDXmH0dAJiNZETn56QXGsMA+QO07wTGhAEGa7gERFUes0t5ht33pQcyng4gRg4TbNTafQetukJSU6BUT+GeHgtgKAzguM8OXWjtXzxg8gMAA27Tj5NIrIRIjfnE6aLQBg/FT5fa7lnfuWknFIcXmHgISFRSXnbpHeEBee3tsPIRR6OwRvVVGTBgAAobGC2vp77Y90qqr9xI+fLaVkYnLCwwlbRuylztw1FHpScOz6+WAMJ1h4hOqf2NsFhjCppAqc29ldhv9oLBAS4gNAZu0ynWPorfvU5y9E/YWA0rBxtpb2pqZJt5wKE5Pf+jm2/ZCjx5z94prIVFYhi7M1N1s/f+FkAABq3jRdC1OzQLOQivZ9q4/zDr5s1n4ELiVhQn6SBhQQqTTA3l5VZizfWBX1zWYGnfY5tEZ6FgoAAMTFxNSUV+/Z0Pb6WfTmfzZfvO+fXEvufvQe3zhotXurwZjlB7duvx8W8fqCuQ9rZ4y3rlZXk1dafwJ90GV4BFTueVRebjIAYL66YbhXIqt910DAPrZdrcoqUYa27+MIDDYBdWtaMhDCJytNSZQAW1llnXF8nr/VpbmAn4dH5/TFO4tFJvCBJZtP00JTmtv/tpkY8whzYC0AgJOLe6nmCfuQCkKbvypxGP+j8oryqDmK2+3bfjutJR1374AeSmWdo41ncRqFmRbiY7xhtrD81m23XwRf95Lj275W0+hmTH06lYnEkrYtWSI/kIAQpD7eBaOzbM1MVcx5/47z/i8TEI1MT/HzUubj5QVg5aar/5wJNDdPd/d75XbIbD2YJ6fo55nCdoc/RPROrEOiiNoqK9sF1JIe9+yWqR5gE1BiRJLR4kViAIyfKr9k1S5tbZO1ahryMwEA3JxcC5asNtJax2qeuFx1+JpEZpJw+FOGqqCHgNJ8rBXnTZWUnCUmJgEAmDVr8dq1p1DSR60jG3r8kKa0wHDj/qvRQHLqLO1VRm6nPfIHWdypabn+V7YDwAXAcjOPwl56IjvTiiA/7LWmSAqASTt9bSOrkZQsayNjaQCmztc+7frhDwQUZa+rMh8AoKui6W5+6YDW0rafwcXNq2Xs5Y2jp1M7PsMGah7qSg6CtCJIZaR1wBENKQmRjrcU5+r72DgUpPUnoGZiFO2S0VoAhAUm7DJyLkyjtrL6a8nJj83U10gDAMB0Sckde0z9fdLafzu+moCvxlNb2CtupKRnjse3yAEA+MfzbLh+5nyA+SFTlJgYAACIzZ+1bJvRqRCPmO4jNoYuNf5mi+dPBQCoLl8TesO7vaeWXJ0YmMJqHZ93/5aU3tK3gFoRUqE9eqrkuG4CaiFE379mogS4J/EtSQpLeHZm6eRJPEBmm9eN8Mr2I1AT5xloKgfAGH7e2fp24XVE9soRUhl9C3vL1MMZV8f6IhqVHuPhq7POxMr9SxLr/pr65dZV992mHs7heTgHNx327RCzbfVUt+sc2G/1yANX1Z+Dkl+c1N+EQmmrHr4f01/p/e0MlYBaKYT8wAu6fDxj2IrwOr292Gt7zdYDqakyJ/652qMT+sK1pXJz2wRErghzcdsoD9gEVByMObNYBgXAVOXtXi4x9QjS72N4ak3kbSuDpaCHgGr8TBfPR6H09U+sWKEFAJi/WM1o18U5kxfo2n3rcdDrYlyub1eeDICQoMjCBYq6Siu0ly2Yz8XJ2aYemdVLl185afkyIiYnLupVwoB1H4SJIM143F1rbQA4+YB0mFtMbb/3kBYE/8hEHDUegDWHo3zjG6nR9w5v0wcAzFyka+33/S8ENF9SUn25stISJd0VyzQWykixjrW29VscviXB13r/9tVzUJOFAQBCqPFzNZR0/tFxKUBoTfhoH+OJouOBjPQcDUUlXSUlzUXTZkwCc6WXuFvH1fYlICqxwMfuspYcAACMEZKQO/k6nsygIUwEaYpzurZqkVR7IRGaPt/ost+vfko/IYZ842xHV/QGJcUVU3l5uQGYMHXxgp2+Fr6FaeRGCqV5ECfiDxPnYrJ2jgg/AACoLFV1uIhJxmCSHZ3vx/bo+2sX0CyZRedOWHU8r0jEWNppiogIAgAmGBtbvGl7+kmtjvHw3S8PxohMkbPLI1Iq/U+rTJvIC+TMjtz+ksIq29SySFsnAwCAIIp//8NYUku/YzIYNFpldHReVFQFiVCG83zg1PnMpP2hCq8Iz2q7CzaJ1zHJGAz2xJbFMpMAkDbccP5FAqWfLZcF/HNoneisRavuOMUN5aEeIgHRGglxDy6rAx4uAMZJT50pJykoxN8poP7Zro3OwCW+uPYPuv0V1gWW637RUEthupDE6V1m75MQJtKvgKgpr68b7ZED3QVEwWeclpGdImhotNdZYw3rMfzm8+e99k6RmrglJCKd2f2MJmVZHL8gK2ugpRvsGvLM2+Ouy6ULvDxTJk+Tl5l9+fytr4nkJkJ0ttuZQ6aGumZOOfGEXnpzuh6cqnjP8L0AcPCMFTF7gcM39fdhahMlwAslNgGACQZn0yNSmWnB4cY6SwDgn7V4t13g3wgICIzbqLc7Mw5hUgmFwbbnxFlPXvamesbX0pBe+4AYVEKh6z6BCYJAWPzGpTuFaQgTQcrCzttsniAMpijJnM7EU3oTELU+0SfWdPOGSZLSEqJgnNj0i8FMVluPSviEObRKbg5KRGy8CD8AYIbYlGPoUzhsr83hrlcXlVSV4PXEx9FTX1pBbuZig/P4oMRGQkphsP9jF5e7AcGDOBd/lrQs240GS4WE+dhKrajE3IM2z7x9Mr0TOsfBD9QJPUFsvZtFYCnrDkQjfPO+YL4McI8TU7AMZ1JozDQfpyVSEtxAbfM/tLA0BoIwkfSCoMs2awEA4yT4L2bjyYMea5aWZbvZRI19HMBs+ZlTpcZxcnNOmD1j9tKuQxn2bDNKCUiq6+fWGOdphlYDk5camHqXD3YfBpGhERCNVBbn5rgOAC4AgE6oA+4lRmn1/E4BcXPzioqKTxcXnyIqDDg4ABASF500DTVRnJ+XlyWg4PDwM9vGdhVQeRqFiQ/GbrlO7OiM6EdA+BCcyYbloLuAWuIdLsyUFAOr7U7ZYTe3jQPaaXk72my9gJDotKN+bZ0gbApoSE0uxWJzg9z9T20Zw8k1UQwlg0JdtQ2qxLfdIor8Dpjpi40X5AeTZFSNMNnRhH6dQirB2jurAzCGV2D7ze/J6f2VIRqlIcHh6KTxggAYH7zyPo7EiHU/Y7AKALBgnmKgR/TfCIhv2XoL11jWF9XhscRTAHC3na8qMtKbgKh16ZFxm/j4+QFQ3hd62/cjFpuLxeaGuEXu1VsFgNSUWTbOiT0FxKCkZDvuP7Fb7fDZWxFWRuwCaoq7eW2JzDzBjVcNjqD1FvLw8omOFxWfKatq4dd7vxiCMBGEQSFWp2DfB7mG7+cQQ4lPE98Z5xpLJxJL4mNzg538tmssBwBMklE1sn2Li67ptzvjT4N/Z7fFaCVqqpiQMD+7Urj5wb5Ev/gaCq0V6V9A/GITJp440Tnwr5WIu39xjxbgnDxhur0ba/BkasapBbKSXGDhNsdbEXQa8gcCaiXj83C4XNaZ6pKwTHeLa+r8YrwbI9zCPkewvRXsRHWwCL12+65PfJ9PLRK8LXau4fvNBxT/KwERE57aH2w/0L0IaOA+oMjYZ5YHtnJw8PDw8LRfYGXJabWd863wdDyeHhcSfWknAECYh++sVXB5Ymr7W8QGnPs5tDpXVwG1IrQiR+OpkiJgzDaPS86JHQMRMb7Zjmf2cAlP5j+bmUJiP6kMCu7+oa2b23+MlKh4kA+entZ1N/B4epSnnbEWAAAA8bniF1/1Nww6Lc/b6jIAgJtX8JQXHd9vE5pKrgo6KygmDACX5ekb31OQylAbU935AHAqy6uSwtP+RkCr1TYnB+N/R0DkaryXG3/fQxlQ0xWuhPUUUHW49z27i7GOrtkxuGR2AdEor61mL5jNc+awxQuPtsfwnhgPwimDq7v3kHAURm/ti1YapTTC2nEnAABM4OX3co77lYyn4/H0EDtt1UW8vHysCTECfDy8Y4CUGCo4iMb87eGXg01J0PFLG9um4Ajw8rQ9sFx3/ik2pYlNQJycXHy87TN12rIp8k40+/P1mhgP571KAIjMmriHGNVWxr47HVowBwXA0jMmDl/xCBMhFQZb2moCAIQl+C+8SxtIQDRKTehl8SniXb+6t/DxcHByAC5uvvYDKMjPr7FsNRnbx5bxofEmusoc8zep3P7XCagxLZp0WfevBBSTkoM5dVtS8tz589btF9hTy3mKct0OHB+rl4kDAB4ePrbXVSx2n3NG6yp3ERCtCQkNlUKJcXAA/ZNJIYFsI6HDS6Nuu6zj4OARmnjWp6ZTCvjsG9sNF4/p6Mni4ODg4+v1/PHycrN0x8HJITZzwuUPfTroNwTURME/vyQ8dhwHAOqulwNL0/HvMFu3y3MCIKevhMkl/5WAtmmjH0cj/wMBtdKoLRRyM5XKSOsqoHDruTKonSYXXkXhK0PbBBThGfH29kkjbtEZ43s/hmXhFjcNeHjHANZ55+XtPAVj1u/18oxi3RLyQ6wddwKOcWKzL3WbAziUaaWSG9LxdDyenhL7we28Mes4cPHYW/v8xHcKaPGS1YHusV1vWunNXcZnp+d5nz6/igsADk4Obv72MibAy83JyQEA53r9/XfDCUwEqYjCuO0GAAiI8+2iRrFPLepjD2mUGgKh+/2yZ/zMpaaJA6U9/s7hZe0v1hHT++xjivc6v0OdS0oBfca38t8moFYaqTTG+a+aYDHp+THhj284fQm5daP9Asu4NGvezL7KfjcUzUwsI0zs/BbuPoRWYAmomEJ4ZT1lqggnJ1C+dsEnn4Bjn4pRnxKZdk4dcIzhFzYkBnTMUaJVBF09vL6fyRja10zvvO6s1gY9vH7qGODk4pkkY+5fQ+hVLr8hoFYahR599ejEcYKAT1Rkd5D5rQD0mhU8AExRQB/3qaD8lYA6xlv9iYDYm2AdiY4pJJD7G4jYKaCgZnJYzFzpiQZnKcHxTVQa20DElF8xboGGnFwcYjPFL77q0Z5lkPGVSdhcLPZTRESmr+8LX9+vERFUsxmzpYCWwfGH2LaeYAYltSzRN9M/MCua3KNf728SmbRSQRmFmo7a4cY2LoGJ0JoJ8a/s9rHGbR05c+dHErmvp2C9JD36vtkuvb6HyfIv2XTjZmQtgtQl+IeeUAaAg4tnwowL3ctYaYiZ3Y4/mk8XdmX6dBTgVceY+bzyOGC2CWWk21k8eqbIx3ifBh+QUza+gR3COY9D1gndQkn9HnLpPB8PT28C6p/t2uiMGFoThVxLSGHNKWNdYIVRAW+DvJ95s8UZc+eQDgBAgJvX5Oj1R26e7W+F/YiN+RSMy7LD3N6vAsZPlTe+/SboylwpHk4uAJYdTvaOraN1mQvWSk3LC7x6DHBwApFZuzDv4tr6L1vSU/KiQrp8qbf3U2/v6IOiE0UBAFvczcN+df5wamNyJMli3+S9117E4hm9TwcjlUTeuqMMwBheAfStH/33ASFIKyUt3//6jWkSk8F4qUmS00SExgKwYtna6EBiy/9aQNS69PBoHT4+PgCE98bcjq7pbYcHFhDXGB7U9KWzp0/nNvByiKwgUZlsI6GDnfxSLLfPmAgA4OAE4nNnyAT2Nh+KNcdNftYs+VmzFMw9EPMZ82YCkQmT5s6YrSArq6C2+ZJtaDWN0kyhNHfrxeiYn6W2+ZJtKL3fg99b0l+enj13CgBgnOTKPR0PvJkI6VeMu/c0cdboZKvLniWptMELqC7G3cFIRbifq4Jf8eiu27lEhEFJeud8dh8AgIOTU3za4gsehSltvUi1OGfbPStR4/hFBOUN117O6hjK3z7fsL9IS/DwcgMgKDlp2typE8SE5LQWHUtx7msOYELGgQ0bhKZprDpFjh3SsYhDNxCx427ZRUAJty5f3ibDegyfYHPFaY8S4OYCCmgnc6uELo/hWRshsguIdYF1Sb+P4RvI5F+R7i77VcD4iVKbjGwWSANOTgCA8QmHzwkkRvfJqFR6UlC0PgBjAJgkY3PNuzSV7esIMWQfJ8v28spAkOwrKAkUm4DSsHFX7W33+pZSSZWp0ZRofN93XVplvHvoHgA4eMaizve8w/cWQoHrVbs50tNZZVFygfE/138QO+eC/a8ERGumpL22WjNWhBeAKUv2WT+KITARpAJr439MSVdJ6dimbY9jBiEgAADg4gFKlvssHdeu36mkpKukpL14zjRx4XEiYovk5i+WFgNgrCjPdg9ruyQM5nNsSmM3iRATMpzMlstMb/tMeOIrK5l5M8GKVfqOF64lX7twHa2vO3PhOk2941eCq7sdzPSkV/6e0RcOGq5TlJi50FhvS0J7R9ggwxrGAQAAwuKz5yzWbhsQsFxridyc9npxtDOOTulzHFCPpOd5njyhJgIAar6kkS+G/WF5x6NxYR1NE2okkYlQqmMDsOj2SYlScmsUluuyHUMAAEDN1Tri3jmUgRBLcXZs36CFg84qFTBtxZx9AexfdHbnJPHxQE7L7OilOAwmGeOZ4YYrTkio622HSwMPnV49SX3BWg/biOrfml04EgKaoqqopr90IkoErNPbFXPd2nyjooiI2KYNO+K8fZIOSgFuDrD7+oc4AgMhFLg6ppqb01w7Bnf9jYAQJoLUxnq57FcBPDz8U6a0za9ZuPC08tpDa7VNtNW0pSUlAAAik2YpqJloa+9eu1pLDgBOAACQ2WbxJCKVNcChMvoW9rSqisIiiTnaZmjPop4CSo3AXtyvIDNfaqKCqeGeAeeCNaVhqVfUAODkA3JYj9jaQTymqYm0Npaf0TYGXBg1R2efR2DSMAuI/NVp224lAICI1ESFbdpoC7RnIY1aFed8ae2EcQIATJPTUNUw0dZGK8vOkwRgkpS68YW81EEIiF9QbMOh0PPu32NwmbY2WHPzQHNzz8Nb18hPnS4998i+04Hm5oHmllEW4ZWUXmaxN6ZEkq4d1Fi9fPrGYx2fYS1X0jaoj4IvCnYJ3aa1lkdggsyqw3pW2Ynd+7Ob8XH3McZblwIhAZSepnUO/nfKdhoOe9ZgnrRYrzUVbgB2o+98ie1vIGL3kKLvntmmJwaAiKzGZqfibr83xsFCdYEkAOLyWna3ouoRhEEm/Ai5bbVtKRjD2dsuSC5ZbBqF62uyKLHUw/bCqlVSE3Uum/iWdrzOaoKp7A/3iu1/DGctztkKvUhKZfnJ8/bf+x1D+ycZBgF1sk7PKMU9ALE9g161YJzQuJWqq3VkwBhOsNnCt7SnXBBkyATELyKhqGe+R099sZ6ljTlmqsSUXssOz1gRed1LBuo8ChtOXfb4mkRsIcW/tLlkpy2vKA0AEJYS07Q+HlLRU0CEWOTmWd3lcwAA44RE1DV2XtvtXdLPgmSUtM++Fjrd5g31k0Q/SwPVSaICnbsqJjlP74CPY2COr8UBADgBWLxC69gWAzM0+vh6pTlTxw+FgBB6LMbbQH5h+1fOET+ZSUBakfQ8j7O3d62UEO9sMcyWljU9djUuPIU5mCYY+zig9gxqNjyCVMc6xZ/XNFy7Yvue06EhnXPu8u/oLpQVZhtVTKoIc4vQU10CuCfwLvDySGwid28O18U6ue5fAADfjIkrU6KQ3+onqk8IiLY+bio/Z3a38rNY3/bQkRfY1LYq2+AE1BDram+gMgUA8Rny52wiu1//JBxhv8rKiQCMX7LHyCEvHWEiCIOSXhzhcPOYIVpIgK1YgIVz5E/ssYy3wVb1s//EqKSTOxTBzNWytl86XhycgGpxztf3aGzQ3nDyosOzngMv/z7DIKAZOmp6x7ejzdBoX+vbnxPJ7Se+jTEAbNbbbWfr9y2p54TMIRLQ+Knye51+pIal3girJMa+OGZqh0abofXRstLTWRfzaj0zNNrMaK8tJrQi1uuSfUh+SjqDlPDm2qmT82dOAQAIs8+vQVqQ9GdnxCdPBJ1NMEIs4nj5yPoVytMAAHzCvJqXbob9Ypuw2u3gVMZ7BywFgBOAFSceBCc39vEso5VGrcK5OO3TGT9BCACweMGy/Zva54IJiytrGaY6DLAcR0t6ykcfKzP0TnO0zdsYYhMVYaaE+pufNEOjQ65i8lLbvqiJlJzjhjYzRJuhrTLDOiZ/puU5YULaZmyZ3Njv8LW9L6YW5+x44mDHZC4f8ytfUtreaqGSvnvvvmiMNkNffugbX0Ppcb56E1BZwKlD6yb3d6GSk947XPcwUDLWkD55wOwJjthMTv3mZ2p/1NTe1NR660oJceGu86oIBYH2zqqyq+YvuOWU2Ejq0R9HTHzmbmuGRtvtO/Ay/vcExEQQJpL6BXPVh20+rZnRXtsb4TXstbbUCOxVMzM02snM4mVMn0MrGxKD4qxPmaHR9ifMnuB6DqZPz/e18DmGNkMfC7HwLeoUOq0FiX92YN8Vtn1gP6d9h1Do7RiF/sfjqG9ufDCRNYfOUHP8BCGgZRrtn9DryOZWBCkLMXPYs1Jjrdbtq86syd5Dn6ETEKU+PZKsr3dA+/zDoCTWcKbaRO/7TuauhzZsXdrjepHTOnfgpC9rmYXrTo8jU5oQZCgF1GUyKisDLUhGxN09YbRTau5KqSWbd5h6OGMrCLHv3cwDzc39zU+eVxUeJwDa52ex/oT8K8Yj/oSalsJMQXn1Qxd9fxL6HKbRlB7/8pbScl4uLrDwkIXPj14rQTRqfVpkipEyvwAvAJNXLFLxs3UtxpOKQq65Gipqyc3/Z5tBIqatBjR34cqda9eZaGsbqiySRgl3CGhYSskfp28B5XuiTdT6rSngo+6f+8dcUxNz/NyHJNYxTHzrqG28QXvHchkBAR4wSebUqeufkjqPZHN60g8/S9xVq/s4SsvQdlWMjlDTy6PcA7TXGWksW8DHyw0mr9h3LSOm93pNK4IUeKJPobW9rnsUDHnLqyPDuiZ0WaiZ7Y6pUiL8E0Vmqip2WQBMa8F0YUFWc01Yaul2e0fWw4URFRCCMIm4u6cxhNOe+USkYzEtNmuKzd94jhiSzL7eVTMx8aWPxT7H6IGWAaXUEUMTls3l5xkD1himeGPrevYE0cj0BE/P1YpLeWepLjiQ6NwxP5BUEub/4ob9l9SB+4CGq6D8WYgJT10tdDXW9Tw+ZaHn7xxSOrXnyN3IPubTEYl1qamV6endGgitCFIVfMVET1N3/1VaWPKQrz02+kOjNqUFBK/XNFAyTXHufw7q8GeYF6Un5nmb2W1WO7rZ9kPX5b4qgy4baisryMoqyOraHe5YRYH0K9YzSFZ2hazsrZshVYQeS3YR4u47nFaQlV09f6GbS2xTj2p2fWIQ9jxaQXGV4Tm/HsOlEjKP7T0mK6ugg7byiBvM/rcvb9rx8LKXJUd/58RTarEYRbnx3Nxgn+Gxp2GJ9b3cpVnLbt58H5zSc6Z+x5Ks7MeHHml/yVCrY0nWkSxMMDC/m3/ff8UYzWEgyCfMguULUNNRqKsnrb8mj/wuwcCMZKCAYGBgRixQQDAwMCMWKCAYGJgRCxQQDAzMiAUKCAYGZsQCBQQDAzNigQKCgYEZsUABwcDAjFiggGBgYEYsUEAwMDAjFiggGBiYEQsUEAwMzIgFCggGBmbEAgUEAwMzYoECgoGBGbFAAcHAwIxYugiorIwJAwMD8z/Lr1+dAvo/JqQglIgk4f4AAAAASUVORK5CYII=" alt=""></span></p>
<p>ã€€ã€€JVM å…¨ç§°æ˜¯ Java Virtual Machine ï¼ŒJava è™šæ‹Ÿæœºï¼Œè¿™ä¸ª JVM ä½ æ˜¯çœ‹ä¸åˆ°çš„ï¼Œå®ƒå­˜åœ¨å†…å­˜ä¸­ã€‚æˆ‘ä»¬çŸ¥é“è®¡ç®—æœºçš„åŸºæœ¬æ„æˆæ˜¯ï¼šè¿ç®—å™¨ã€æ§åˆ¶å™¨ã€å­˜å‚¨å™¨ã€è¾“å…¥å’Œè¾“å‡ºè®¾å¤‡ï¼Œé‚£è¿™ä¸ª JVM ä¹Ÿæ˜¯æœ‰è¿™æˆå¥—çš„å…ƒç´ ï¼Œè¿ç®—å™¨æ˜¯å½“ç„¶æ˜¯äº¤ç»™ç¡¬ä»¶ CPU è¿˜å¤„ç†äº†ï¼Œåªæ˜¯ä¸ºäº†é€‚åº”&ldquo;ä¸€æ¬¡ç¼–è¯‘ï¼Œéšå¤„è¿è¡Œ&rdquo;çš„æƒ…å†µï¼Œéœ€è¦åšä¸€ä¸ªç¿»è¯‘åŠ¨ä½œï¼Œäºæ˜¯å°±ç”¨äº†JVM è‡ªå·±çš„å‘½ä»¤é›†ï¼ŒJVM çš„å‘½ä»¤é›†åˆ™æ˜¯å¯ä»¥åˆ°å¤„è¿è¡Œçš„ï¼Œå› ä¸º JVM åšäº†ç¿»è¯‘ï¼Œæ ¹æ®ä¸åŒçš„CPU ï¼Œç¿»è¯‘æˆä¸åŒçš„æœºå™¨è¯­è¨€ã€‚</p>
<p>ã€€ã€€JVM æ˜¯ä¸€ä¸ªå†…å­˜ä¸­çš„è™šæ‹Ÿæœºï¼Œé‚£å®ƒçš„å­˜å‚¨å°±æ˜¯å†…å­˜äº†ï¼Œæˆ‘ä»¬å†™çš„æ‰€æœ‰ç±»ã€å¸¸é‡ã€å˜é‡ã€æ–¹æ³•éƒ½åœ¨å†…å­˜ä¸­ã€‚</p>
<p><strong>ã€€ã€€JVM çš„ç»„æˆéƒ¨åˆ†</strong></p>
<p><span data-mce-mark="1"><span data-mce-mark="1"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwkAAAF2CAIAAACqEkPmAAAgAElEQVR4nOzdZ1xTVx/A8SNThogbERF3qbjx0TpqraNUsVpHaa0DrXsPVEQZ7oEbHKAY3CAoSmTKCKCARECG7D1DSAjZO/d5cSEGFRREQPh/P+eVOdx7SSj8eidiiDDdM9EYAAA0DgPDHGC0p8HlHvf29n769Km/v39YWNjr168zMjLKysqqq6sFAoFUKm3tHzkAWgiCNgIANAm0UXsbbPYxAoFw9+7dR48e+fn5RUZGJicnFxUVVVVV8fl8aCPQcUAbAQCaBtqovQ0W6+jVq1ddXV3v3Lnz5MmTkJCQhISE/Px8Go3G4/GgjUDHAW0EAGgaaKP2NpjMI5cuXbpy5Yqbm5unp2dgYCCZTM7Nza2srOTxeBKJpLV/5ABoIdBGAICmgTZqb4PJPHLx4kVnZ+ebN296eHgEBgbGxcXhbcTlcqGNQMcBbQQAaBpoo/Y2PtlGOTk50Eago4E2AgA0DbRRexvQRgDgoI0AAE0DbdTeBrQRADhoIwBA00AbtbcBbQQADtoIANA0TWojySFG4Y4M8npyzdiUlLyfX2eOPY++IydtR36xjah1W4G/Py11U2GFNV/SGmuX2vLoe/KSNyfTD7XYSqGNAMBBGwHQ8chkEg5HwmbLvuqONY1uIzFvb0X2ipsrhk5Ecjp9DOaGFOyqFthLZfi0A6kPTZaYjrC0WlfSWlWEj8wlpiN0t11ZlslojbXz97y7P+PfAb2NHm5rsZVCGwGAgzYCzUoq5vO47Pd4PL5E+sEMLpfLZrN5AqFEJmulzVQkk4h4dbb5AyKJTIZhUgmfx2Oz2TyBQCyVYTKZWCRks9kcDkco+e7uiCcTiSh37pRevy4oKpIKhVgTC6lxbSQVH8z0HWI+UUlVTUVTS01bW01bW01bS1Wzs5K6htq5iP0MgYMMgzaCNgKg9UEbgWaVR1xiNkn7vZlmS0Ly6szIJk6bMElbW3vhwRORhZxW2kxFDLLzHzNMtD+th7a2S2ghm4/lhSwxm6mtrf3btl1+2SysujjA9Yi2trb+oN72pELhd/ZHQyYUFp44Ed2nz+vBg/MdHHi5uU1aTOPaKI844LcJSirKA1fb/JtIsWGzbdhsG0bZ1qgboxFSVtf46UHifpYY2gjaCIDWB20EmoUMw+hxTj/NGNNbo7Pa+wMmSL2zRp8xM353imPUzsz0MR0xCiH0m5VDeEFbaKOq2AuzJw5Cn6aOkHNQPouH5QaZT5+MEPp5/WbfTBbGKCReOYQQ0umjdSA0X/Cd/dGQCoUFx4+/1NWNUFZ+2bUreeTIXGtrZmKiRCKRSqVSqVT2RXv0GtNGjHXXf+k5VG2MlePabMYhUc3hMweZ1I5H2x51Y7RmZ42eFy3f0g9BG9UMaCMAWg+0Efh6UomolOw8afIwtc6qn+gL1c6aP077nZiHiaXYd9tGAmZ2RjqZTM4oKGTwJe2ljUgIkRCKUFF51bPnG1PTrF276C9fCoVCsViMR1KDi2lEGxX6D5w+WGXl/sWx+YfEdV+SSQ9xy/49rKXS9dQKcuUn2+gQt2ztI1P9yab6pjXjp4sem8v47xci4Vil+80wfT/h55sBO6jC9xNEjB2xj35WmDDjUawVQ9Q8bVQeM2nPmtolr5m8M8bqozm7Y3aOX/N+7SMst/ydwqp/ztZfHF5t/GQb1VnXX//b8nQrS+HV6sQ/li1a6hW1keQweaupvqmp/po9v8SUQxsB0DjQRuCribm8jEczRnRWV0EIofmb7Fw8iEQikUh84LJzxXyEEEJq3fUnOieVi6TSNtxGUxetOXeXWJcfkZhP5Yk/+pvQrtrofSH16RM/dWrmzp0VoaF8Pv9zhfTlbXTg9fmuw/VNTj/aXPGJHLGXia2LA/4NytlXLbT/sI14+7IjF5r9amCCkNL7ZtUePMLQztUis8oBwxzEzF0JT2dMG9NVIWq7DB9rdOrhynymA4Y5COnbwu5MmWjSRWFCV5OJgy4T15VyvrKNdsfsnPDfRC29brUL7qbde+K4zTvXlsrnlK7eudlkYm+Nbu/Xrqbbq8+idZMiSmvnsDY/3TZqgXxOL53JluMv2E6u20YfrauLZq9Ro9cprIseNWPMsLkHjoxcMVu7F0JoiOGCc/8U8KCNAGgcaCPwlSQiVnbcxYma6soIofmb7f0Ti5lC/CUBMzvGf+eK5XqGi+zd7saXsaUy2SfbSMyip4bcslR0/Vl0KUP0fjViVmlqyPW6U0KiS1kKU75ozsfkbbTUyjG2vL5Z1JQLJ49ZWlqeJNxJLOfX20a8ktirzg61a997xDYo94P+4xVGXHW0eb+Fn5rzrX2yjWoKSVn5Zc+e8dOnZ+zeTQkM5FVXi0Qi/CjbRwfavrCN7DFsh+9snUEz5hBirThfEFIKbWTHKljpaW3YtbvxPqeFboSFBMJCAmHh2T1644YgI8ufnVKtMewgNdbCaVK/bj0nnCAsvIXPOTNx9HCdIdt/e5Btg2E2pcELjozt389o4qnaJRBOTTDqp2l8aKFf0cGvaaPy2PErhnfuNs74XzszF8JCAmH+BbtRi8Zp6A4fvS4W33tkk3nPeMSAQYs2zLzgWrP2K6fGrZiFtIf0WRxcs4epPGL0wmHqXWaNXntqHoGwkOD0q9Um4xHGvQYptBG+rpmLTO0u/IEvx/XC9A2LBiqsC2+jwcbGA1fumn7WZSGBaEnKsxZ+acJCGwFQA9oIfCUBpyzy9ljUWQmhif/cii2oEtZ5lZWbmOB2O6aEX/svH7URj5oW+WDDkpkj6xzMMp4y7+xDUlGVCMMwjEclRz5YvWSmcd0pM+etfhBIpuJh8SVzPunL2uhLzjeiZbpdcDD/YVgf+b6Jvr1nbLU5nliBYXhW0FIuXtj/2w9GPRT2X3w452MiKpXq5ZVrZdVcI2fXrsSpUyPV1T9uo5qhpBSlqxs/Y0amtXW5nx+HQhGJRBKJpG4hfXkbbXlo1GXAv3Pvv9vH//z8Om3Eo21N9Jt31eW/Qh5+FZsDhjkwE2f9PUcXLZ1sFWuFYdaFxHmHkK6+0ZI0zEGKz2Fsf+Kx0DFgLZl6EMP2ZRJ+3Yb6jDD9O1O+lqqtdwnzHUM3plbVf/egz7SRPYbtDVuhM1Rn0KITy1+V24gxBwyzY5f/53/CeJZO9/4rVlVgDjLsUEnMfLery2LS9rHFNV8rKLV8cNQQ4d0js8c42x8t1zH6xXjZgzWJ+Pbw9iUGzV9m1rtmjnxdi0ad8N9YzrbDlyNmWyX6z1y+SLff8qXZHAepDG8jLROz6XdJu5niBt5kaCMAGgJtBL6OlFOd7nMEITWEkNXjyDL25359ftBGYnZekNu+qUizW5epf2+2stpjZbXl76m9u2kiZGJ5/FkSTYxhvNJwp6NT0afmTN10Niid+YVzPk3eRqOmm2+3d1Rw+cLFyBymRCzDvqSNGNkXj/w8yAiZTJi+apOVlZXV1vV/zpqEuunob7RJpQmkMgyrit0/ZmJfhIwmTLZYt93KaufG5fOmDEGoWy+DTd6FPHE9ccTNzMxct67ejvmWI1JHJ2H27GwHB1psLI/JrFtILdBGH72KN83B8aYj5G10sCJ20cVJGjrdRu11nHPGcY6j4/LEggO89zdsPFgcbGY/touewZj9jnMcHX9zdFz5jnJIKP3clny2jXjrrg3oYjDJ7G7sXt77f8e3R6fvAHMyz0HywVdxrMikfxyPTl2zSN5Gdljh338ZaP1v7+IX+QfkJ2OJ6VteXB5vLJ9DW7W5v3a3WaPWHPzV0XGOfBw7OHb5LLVeBiOeFjqIa9toheNfSVS7xoYRtBEActBG4OuImfT4u9sQUkUInQoiV/I+9wUftJGQkffi2WVLy+37d/tmsjBMhmGc5BuLjft3QWjktnPeWSxMXJ7qarcGIaRj1G+FVxYfk2IYJ9PXdv92S0vLsx4v0iuFXzSnHvWfi62joXXgWb6AJ8E+30YCSrj9aNP+qJ/Jnote+dUYhmFcauxjp0mDkHZvrY3ErGqxhJ90d5yxMUJo5H/7HqZQxZiIkRf97LKlpeWm7bu90lhi6afjqBXbiIRQpJ7eazOzvEeP6GVlHA5HIBDUFlLVF7dRk4+pOWCYHZ+2M7nusbCaz6emjRz4tA0v7wyeNlT+wQ1Ysfc3pxsLXyZtrxI4YJgDl7Laz3nApJoPWQmhgesd5l5zWxibvpsprH9LGm4jmR1WuepYf+0+h5YQCw8ovsQqXOZ5SKtP/xmhlQ4SmQOGHSgk/v0M3/5L0y3M+tVuZm+jh9swqR2WttBIX/Nf55XvKm3fL0fxOrXaOZ/6KUUIoR76uu5pDiJpTRs1+do6aCMAcNBG4Ot8bRspksrEjOIA/6AHp9cO7KeHEFp9zDGZhgnKku/artJDCOnq9lpx/D7xGZFIJBIT8ivZwtrThL9kTj2ap43KX1iNGqKH0LhFG064PcZP5Pa5f/Xoxl8Q0uys9bdnJp/LSHQ3N/5BEyE0zmzZCRcvIpFIDH0Zm8do+IQoTFBSUuLklGJunjxvXvK8eW9//z3RzCzht9/i58x5M3s2edasRo9ff40ePDhCRaWhKurUKaxHjzATk5dr17718sp+9664uJhKpVZXV3M4HKFQKBbTpFL7L/ujeyDxqqFxv9H1nIvtIJMerExfHhy4Kb/ykFCq2Eb2Qvb2pEdTViGElDohI/1pc4bONR9mPtPAQE9D3kYYZset3Bh2eZj5vGHmcwyGayirI4QQmrVipu+bfRyJA4bZMossn58dZj5v6Nxf9Ycod1JBCCE0f9O8FynWvPoeCdI8bWRLz/rzxIiuRgihXt2G/TTQzHyY+W9GE0x0m9BG/UwMps8Zam4+7IPxz8qxIUUOEhm0EQDNA9oIfB0Jq+rtw734MTUHv9gK7udujPNRG0lFPHpZHplMJsfERN621+z8/nIjvI0wPjXlrvPqft3rlovZviuPXkTnl9F4YuzL5nyavI266RkYjzZVMH3KNOeIMpFAin2+jTIfmo4YUN//1qtrajvHsVmi6pQ7C8yNtTQUXupnMnE3ISwxKZnGr/d8IzmpVCoWi/l8PovFotPpFRUVZWVlJSUlxcXFRY2Sm5u8b1+kjs4nqyhcSSlURyfI0NBv8WI/F5eQwMCXL1/Gx8enpaXl5eWVl5dXVVVxOByhsEIisZPJ7L/kj2412WzmD13quYbflkdd67JGtcfwyYSXexgihTaS2pSRF5xeoKI2qLfppP6mZ1anM20lmIMkd9nKPwwU2kjeK/YYY53bvMFzTPXH/qjbXcdojd2yNKbCBKmtqGy187T+0031xxjr6GgN3nlhdS67qW3EWO1oqN13zcLHGdYKx87sGBkW7mu09QxnRzLsJaLd/jt0Bpt0GzKqr+k2M9c3e3iYg5S+9ekl0/dtlPfXFAPNBaeXkcsOSWuXI2XvJN+aaiafk7XYtJ/m/LpzPh7QRgA0C2gj8JX47MKQazpIvRNCFueJ2TRend00UjGPxSguLebId4180EZSES0z9uLuBQghJeVOXfUMBgwwMtTrrqaq8r6NMExAyXp6eYeR0QBDg77dUadO79tiqa1rTJlY9oVzPqV5zsWubSONrt31DAYY1TXM+MfbSVyOCMOqEz1WLJxtZNS/r46O1vst7NZ3wLk4Pv9zf3okEolAIGCz2XQ6vbS0tKCgIDs7OyMjIz09Pa1RkpLe7NwZ0aXLh1WkrByqqRnUr5/3H38QHB3dCYQHDx54e3s/f/48LCwsJiYmOTk5JyenrKyMwWBwuWUikd2X7jqq796PEltOxcZ67/2I7zsx6DXg2mb5c2fF3D1ZwbPmT+te00YyOxHHmlq0u7j6kEKg2NNizZb+2sdi7+9xFDsBc39F8Z5Spq1CVdhXRMyYNaHHfycWp9Cb1EaYPYZtfzJWZ6DK/4483FIssJNhDhhmLxHsfvdwxlaVbv3GWmTL7KT4vqWti57mWONrlwoPVLz7++LuQQrnWW9/MlZn4OIZF2N30kT2eHgxsy1d5XNk9hj9v/OjtfUXz7j4akdlzbocMMxezDvAyN9dVHxQBG0EQPOBNgJfScyvSny+S11DDSGE9t2OzKl6f9qMTFqZ63N+n6Gxofvb2ueO1W0jGTX91tGNCHVSUlLrM7Dm+Ru0iDOjhxopthGGyWRiiZjLYxbGu2j36qGtra2loa6krITQrD32ofnsL57zseZpoyzPSSOMlBCatedyaD63gfdLJuGLJeKyOBubFdra2tpamp3VVRDS6aNlFZLX4H2SZDKZRCLh8XgMBqO8vDwvLy8tLe3t27dv3ryJa6xXr15t3lynjZSUwlVVgw0MHi1e7HLypJOT05UrV1xcXG7evHnnzh1PT09fX9+QkJDY2NjU1NT8/PyKigo2u1ggsJVIvvSc3zyi4ZzxSspKdZ4ZUlmw+tlhVO8zQ/h70h7+ulKla1/DhW/YNky2DZttk/yw71QThBBCSybvibGS8fekP5y5yqC7ge2KArYNi40veferKwN/HTlkwzHL7Mpdb65OWTxUf+SpVUU1r9qw2bvDT/WZMNR439X1hfXd/idziekI3Y3n/0oskX9VzeBwDoqlDhjmkO3dc6xRJyXznx0jtlHZNmz2vqyIObbmnZSM+hp7b8dkdhjN8uQgbb1OU857bS1h27DZNgWxM+2WI4QQGtDL6MFWvHJqlrPxt+uJu9lsGzZ1S9T5nxapKqsoXMP/0bps2Ozd6V6/7VfSHfDDXxmYgxTaCIBmAm0EvpqQWR19TltTHSGk1llzt0tAdjX+Aq8s/trJpepqnZQ69TKqfe5Y3Taipdw58Z8qQr2HjLQNLq7pp9rOUGwjdnEA2WuaV7ZMKmJz2Gw2uyj81MgJRggpr9l7PpnyxXM+1jxtVNtzymuOn6/d5k8qClnyPPJeClUg4LPZbFoB2e2cBUKdemp2u01mixo480gmk4nFYi6XW1VVVVpampOTk5KSEh8f//r16+jo6FeNEhERuWEDSVtb3kYhAwc+XbnyztmzLleuODs5Xb58+fLly87Ozi4uLm5ubvfu3Xv8+HFAQEBUVFRiYmJOTk55eXl1dSGff0gisf/Cw2pSsVXstYG/Gn/4rFkNNVT/s2YPUVMWXbbo1KmTiqZ2zZdodu6kjN8Fcvr4zcRtLMyemffP/f2dOqmpatXO0dZW01RXUl4540zCXqnMnp624PKmTkrqdSZoqHdS3vS7W9p+WX3bnLnEdISuqrrC1tYOw6G97mU4iKUOUvFGz/G9TFSU1TVU8Ze0NJTVVHobj1+aJLbHMHtMtpdk33Vob2X1zjVr19JUVsNvH6/Xo//xNTTMQYbVLkdVWV0TX4XquJ8H7NxoaqHQRh+vS1tbTauzssEQPfsX+6Sw3wiA5gNtBL6aTCxmpz3cotVTGyGEdHr07meIH0oa0L9vd13ND44ZfdBGyYRjqxFCykYmJl45Nc9lOz/6B30VJG+jqnQv572GBr37Gv8w+nwcveY+QDm+001GqyD08267oDzWl8ypZ/Obp42k5RFHR00wREi723KHa4lUDMOYpaF3zhoZGRmNNf7RO4krFuX5zp8zxaCPRu+/bM68KuFiGIZVFwVes9dCSLuP1pbgnK/Yb/S6UV69erVpU81+IxOTkB07iNeueRIIBDe369evOzs7Ozk5OTk5Xb161dXVlUAgPHjwwMfHJzg4ODo6Ojk5OS8vr6KigsUqatR+IwyzF7KtKPFL1y1RPDFLp4/B3JCCXdUCe2nNgbY616lJRNalSYvOWyh8xYIZF4P/ubNk8LTOJqsPri/DHKTig8yi/4jnRyie47XqyIKwXGum0B7DHKQiG1r2irtHhitO2Or8z6uiA2z8GFb9bYQ+RX5dGIbZccv2xN0ZOGd87WvjB/96Z11p2cHag4D2/OrNzx16jTGsnTBy6PzLfwW6zdiqrNvP5K/Mmnsy2XHLtgafGlBztd20H//xXP761i9174v90bpQ9zHTZvm+21PNr/kuoI0AaBbQRuDryWQyAask1H1rH8MPzoXG9R3U3/F57bnGddtIXJbgamuBEFLTUBtkYmpqamo65od+tc9lw9tIzMuPddpvgZBqZ7V+P4ypOVHaZIiWhgZC862vRRQJpV8yp56tb6Z7P4o52Z4nfzYZ9P6c7rGjhhj2Rahrr/6HH9OYYpmMTw92HjNuKEI6evrDR441VZijZ3g4isWVNPSIV7yN8PONaDRaaWlpfn5+VlYWfrLRu0Z5+5a8c2fsnDlvjhyJ8/CICggI9Pd//Pjx3bt3b9686eLicu3aNXyP0Z07dzw8PJ4+fRoUFBQVFZWQkJCRkVFcXEyn07nc0kacbyQfIpvi/G1k8vrasSkpeX/dmx7Z8+g7ctJ25BfbiDAHDLOXCA/Q8te//5K8vXTeQWb+9kyyfI6DTGLLpe1UWOz6wgprvsIFaDLxIWbFDsUJJVUHhfVdoYYP/v601E2KXyIfiUmbaPz396IUMrdnp9e+mr49m2lbd1F2HMqWtOTaCWk7cuk2vOq9JR9+73bcym2ZqevJ5PXkzJ35zIM8+p685M3J9Dp3p6yzLvLmtEz8QryaIWbveZey8YPvHdoIgMaCNgLNRUjPCgm/c3CCiZFCFhmbTDhyI5QUWiq/Wv/D+xtxihPD7TbV7hdQRWjjETevKweHmBgh1H/LQffMKgwTcYoLyLcu7Ffce4AQsthkd+tVdjFLiGFfNueTmu2+2CJGUWzQnb0/TxkiX7uR4ZCDhBehxWwMrx5ueVS095GZkxRv3v3hnAZIpVKRSMTj8ZhMJp1Op1Ao8ovUChuloCAvKionKCgrPv5dSsqbN28iIiKeP3/+6NGjO3fuEAgEAoGAV5GPj4+/vz9+Ivbbt28zMzOLioqoVCqLxRIIKF9+QA3GdzGgjQDAQRuBZsUqDAl4RnjPLyCktO7BLGYh8ekzAoEQTE4sZ4sxDMOEnOL0hJr5dwiE9FK2iFFIDHhGIBBeklOrau6YJOLQ8hMIdSSkF3PqNM+XzPmIkPou6Lk3gUAIJ6dS6709E6s0JMCPQCAERMcUMUXybb7vUfucuJqFMfJI4UT52p89JRYyP1gSpzQq1E9hCz81px74riORSMTn8zkcDpPJZDAYVVVVVVVV9MarrKwsLy8vKChIS0uLi4sLDQ319fX18vLy8PB49OiRvIqio6MTExPT09Pz8/PLyspoNBqLxeLz+WJxZaN3GsFo2wPaCAActBEA3xOZTCaVSvFCEgqFglr8xuNyuUwmk0qlFhQUpKamxsTEhISE+Pv7+/n5BQYG4lWUkJCA39aotLS0srKSyWRyuVyhUCgWi6VSukz2zf9aw2jJAW0EAA7aCIDvD/5EM+nXwW8jyWQyy8vLc3JykpKSYmNjX758+fLly5iYmA+qqLq6WqGKpI15nhqM72ZAGwGAgzYCoIOS3xSATqeXlJTk5OSkpaWlpKSkpqZmZGTUs68IryIctFF7G9BGAOCgjQDooOQXvrFYLBqNVlZWVlxcXFhYWFxcXFZW1mAV4aCN2tuANgIAB20EQAeFH5XDz+xms9n4ad10Op3BYDCZTB6PV38V4aCN2tuANgIAB20EQMclv/BNIBDwavH5/M9VEQ7aqL0NaCMAcNBGAHRc8qvePvC5KsJBG7W3AW0EAA7aCABQc+HbF/SQImij9jagjQDAQRsBAJoG2qi9DWgjAHDQRgCApoE2am8D2ggAHLQRAKBpoI3a24A2AgAHbQQAaBpoo/Y2oI0AwEEbAQCaBtqovQ1oIwBw0EYAgKaBNmpvA9oIABy0EQCgaaCN2tuANgIAB20EAGgaBoYdafU/5zCacTAY0EYAYBi0EQCgqdgY5i6TuUil10SiK3z+ZTb7fHX1GTr9JJV6vKLiGIVyFMZ3NMrLj2ZmnoA2AgCDNgIAfA2xWMxmsykUSmZm5qtXr54/f37//n1XV1cnJ6eL4Dt06dIlvI08PT0DAwPJZHJubi60EehooI0AAE0nkUg4HE5FRUVWVlZMTExAQICnp+etW7euX7/u3CZdae0NaOOuXLni4uLi7u7u7e0dHBwcHx+fl5dHo9F4PJ5UKm3tHzcAWgi0EQCg6SQSCZfLpVKpubm5b968CQkJ8fHxefDgAYFAcGuDbty45eTkdvNma29Hm+bu7u7h4eHr6xseHp6UlFRYWEin0/l8PrQR6DigjQAATSeRSHg8Hp1OLywsTE5OfvnyZVBQ0LNnz7y9vT3bGg8P76tXA01NvQiE1t6UNu3x48dEIjEkJCQ2NjY9Pb20tJTBYAgEAmgj0HFAGwEAmk4qlQoEgurq6vLy8uzs7MTExOjo6PDw8BcvXgS1McHe3i82bgzX1n6xa1fQs2fNvPAzZ4K3bw/evj34zJnmXXLLCwkJIZFIsbGxycnJeXl5FRUVLBZLKBRCG4GOA9oIANB0MplMLBZzudyqqqrS0tLc3Ny0tLSkpKSEhIQ3bUpc3GsPj4gffiApKUWMGPGaSIx7/TpOAZlMJpPJTV78y5Urww0Mwg0MXq5cif8LuVYzfQMtJD4+PiEhITk5OSMjIz8/n0KhVFdX83g8sVgsk8la+8cNgBYCbQQAaDqZTCaRSAQCAYfDqaqqolAoJSUlhYWF+fn5eW1Jdlxcop1dhLo6CaEIdfW3p09nJiRk1crOzs7Ozs7JycnNzW3a8smLF5MQIiFEXrw451OavOSWV1BQUFRUVFpaSqVSq6uruVwuvtMI2gh0HNBGAICvIpVKxWKxUCjk8XgsFqu6urqqqopOp9PaDiq1KDDw9aRJeL6QEHo9bVpBZGRJcXFRUVFxcXFJSUlZWRmFQqFSqU1bQ9I//+BLTrSwoFAo5eXlZbXKy8srKiqavOSWR6fTq6qqqqur2Ww2n88XiUQSiQTCCHQo0EYAgK8llUrlhSQQCPh8Pp/P57UZzKKiPEfHSE1NeRtFamllOTuXpKeXlJSUlJSUl16kkOsAACAASURBVJdXVlYyGAwWi8XlcpuwitTly/ElJy9bxmAwaDQalUqVJxHeGU1bcsvj8/kCgUAgEOBVBHuMQAcEbQQAaAYymUwmk0kVSNoIsbiKRHo7a5Y8jPDxxswsJyCgID+/oKCgpKSESqUymUwej4cHQWOlr1qFLzbl33+ZTCadTsf3HlEoFDqdzmKx5Dtg2jjFT1BWq7V/uABoadBGAID2TEynF587F6Wt/UEbRWprvz158l1cXHp6em5ubklJCZ1O53K5TTvpOMPSUnG/EYVCKSoqwk/cqaioYDAYPDidGYDvB7QRAKD9kskYJFLy3LkfhBE+Xs2aFXv7NjkuLikpKTs7u7y8nMlkNu1idXkbJf3zD5VKLSwszMzMTE9Pz8zMLCoqqqysZLPZIpEI2giA7wK0EQCg3ZJwOEWnT0d16fLJNiJpaYXt3h0eGBgdHZ2UlJSfny9/cFhjI0beRokWFmVlZTk5OcnJyW/fvk1OTs7NzZVXF7QRAN8FaCMAQLvFCA9Pnjfv02GEEAmhF1Om+J8//+LFC/k9oJu260ixjYqLi9PT0+Pj48lkckJCQkZGRklJCYPBgDYC4HsBbQQAaJ9kIlGBg8NLXd0G2ihcW9tv3TpfH5/w8PDExMS82ueqNnbXkbyNEv76q6ioKC0tjUwmx8TEkMnk9PT04uJiaCMAviPQRgCA9qk6IiLZzIykpNRAG5E6dfKfNMnn5El/f//o6Ogm7zpSbKPCwsJ3797FxcW9evUqLi4uLS2tqKioqqoKHkkGwPcC2ggA0A7JxOK8gwdf9e7dUBghREIotFs34vLlPt7eYWFhCQkJ+K6jxl6w9nEbvX79GtoIgO8UtBEAoB1iRkcnzZkToaz82TYiKSkFTJjw5NQp+a6jsrIy+a6jL8wjaCMA2hNoIwBAO0R7/jxr06aUBQtSFixI/uOPxHnz4iZPlvdQ0MiRfmPHEkeP9h01ynfUKJ+ZM70OHPDx8QkLC0tMTMzPz2/sriNoIwDaE2gjAEA7xM/LY71+Xf3qFSMqqjI8vCQwMOP8eXkbeW/ffs/amrBnj9uuXW67dhH2779z9qynp6e/v39MTExGRkZj73UEbQRAewJtBABot2QymUQi4fF4NBotx89P3kYPzp+/cePG1atXnZycnJ2dr1275ubm9uDBAyKRGBkZmZKSgtcMn8//wgvWoI0AaE+gjQAA7ZZMJhOJRBwOh0qlZvr6ytvo4YULt27dcnFxuXbt2rVr11xdXQkEgoeHB5FIjIiIwO8D2ajDatBGALQn0EYAgHZLKpUKhUI2m02lUrOIxPfH1Jyd7927RyAQ3Nzc3Nzc3N3d79+///jx44CAgJcvXyYnJxcUFNBoNA6H84UP+oA2AqA9gTYCALRb8jaqrKxUPKb2/OZNb2/vhw8f3rt37969ex4eHo8fP/bz8yORSPjdGouKivBHz0IbAdABtUQbSYXM6sr8elVWM4Xf/veFVMDmCgUifEVSEbuanp+fX1RSXM2XfPN1f4KYW1Ze+ql3o7CooIovbvK9c2USkZDP5Iqbb0tlMjG3qqCgMD8/P5/B4onhVzv4jkilUpFIxOPxGAxGQVDQ+9thP3wYGBj47Nmzx48fP3782NfXNzg4ODIy8s2bN+/evSsoKKBQKNXV1Xw+H46pAdABtUQb0ZIdj61G9Vpud5xcKhBLv9299GUSIbeUdMUnLjaTgW9RJuHYNoRQn2H9j0VVYljL38Y/18d0+qhPvRs6vTX3+L2jcwXSxj9cQCYRMfPI5JAzPrnNtqESHj/3yR4tDR2EENrn5JtfBc88AN8P/FxsgUDAZrPLwsPlbRTn6/vy5cvg4GB/f39/f/+QkJBXr14lJiZmZmYWFRVVVFQwGAwOhyMUCj9xLrZMJhMKpXVH+ooVNW20ZElBTs67t29fv3r1KiIi7tWrtKSkosJCaCMAviNtoI1U1dRnb93ll836ZhtAf3X6p9ED1Hdev93226hTp05qOpraex4mVrEaufeHVxh5zWaB5v9mT2q+NpLwqwqIO3U11DohhJDajqt+WdXNtWwAvjmZTCaVSsVisUAgoEZFydso5cWL+Pj4yMjI0NDQ0NDQly9f4mFUXFxMo9FYLBaXyxUIBGKx+OOaEVIoRWfPFhw/rjjejBuHLzlm5MikffvIO3e+2rQpcsOGV5s3v9m7tyAxEdoIgO9IG2gjhFDnLpMtrZ9mcpp/3TIJRn91adxQfVVltO0KoaaNWv+YWr1thBBCnRDS6anv7JtEb8Q7ws2LPrvrz64aaNR002ZrIzG/Kilgr05NGiGk88/pG4kUfjMtHYAWIM+jqpgYeRtlRkSkpqbGxsZGRkZGRkbiR74KCwvx868FAoFIJPpkGGEYJiguzlq//qWuruKIUFPDlxyhqhqpoxPRpUtEly4kbe2ILl1e//VX3uvXio+whSfOAtDGtWQb9TMctvtGKFlR+P1DcyYNQghp/r5m+8vy5l+3TIJVhh7r36cPQgpt1Ppq2+inP9dffxxZ+3bEkkLvHrFASAUhhAy2EF5mM0RfukROZrjD+t8Qas42krAZKV4HeyO1TmjBggXdu3dHustsbr0tgTgC3xuZTMaMi5O3UV50dEZGxps3b169ehUdHZ2QkJCVlaX4qJAGnhYi5XLp/v6RtTH0maGqGn/1ak5qKoVCYbFY+L4oiUTy5U8jAQC0vJZso0HDxlyIotd5Scx8c/vv2WMRQj/9vexJJhfDhMzsBC9zc/M/zc2fJ1TwhLXLyHS7cNLc3HyzrW1QLhvDxLyKrOfmi/80Nzf3isxmFiYcPrbXHLf32IUEKobhc4jzFs+bNFxDXR0hZGQyesZv5ifd3DILS0M8r5ubmy9fb+nxjonJZFhRxJqVa8zNj3mEZ2UluF2wxRf13x7bpxlsTMzjZz1fsvhP/B+v+8WV1tmfI+ZWJoZdNn/v7PPwIqYQa0htG/223iH8/f4ymVhUlZfoZvtXZzVNhPptdSdmM2qWI6jIIrode7+OBebm18Ny2FwJhmEYLeXCBZtffhpm2AshpNOjq+mv5v+sXBJSxJfIMAzD2BlBtns2v//azXtsgzLYn//gJJzyNJ99RkhVCW10f3Jr3Q8D9ZDeUtu7r8sE8jm1nxe+PRmh2zZvNTc3Nzc/6fYkswrDMCGzKPz5WYU353JYYmXdc8WF9KJwD8Up5uaXnydWMpvxhHIAMIxFJsuTpSA2NisrKyEhISYmJiYm5u3btzk5ORQKhc1mi8Wf+8mTyQTFxSnz50eoqHwmjJSVSZMnk/390969KywspFKpTCZT8Wgd5BEAbVMrtxGv0N9+wU/6CKHpy1cE5AkxjFdJDjqFEFJHyDkon8WrmVgSa2W5FCE0Ys7smwlVGCZi5cc5I011hNAu6+Pr1y0zMOxdc0Sqt+GQNYcuxFMV5yhYamUVm1r3fCOpDEt7aKQ/ACHDsT+bm88eMUQfn9ull/6Eef9Yrvz3X/OJKirK+D8aT5p53juquKYtuLS3wR5L50wbqrCKQZN+XnjTJ4rSQH58uo0wDJOJRIyEuws0e2ogNOj4DVIpC8Ow6tyA+6fNJ5oYvl+HEkLG0+ZfC0ihs8RYCcnSck7db7OHvrZ7GlskxcpjHaxWTdbvpfv+Nd1e+gv/2x/0uWOYYi7lte/BoUhVAy33Typ557PFZHQv1O9vh+tkijyOaj8vfHvmTe2u2w0hNPL3nXdJxTw2Jcrn5sKfJw1S2LCh0+Ys9Qh+S+PiX88ujvK5vPDnsYPqbP3QSXPOP3pZ+uV7zQD4rA/aKDs7G2+j2NjYt2/f5ubmVlRUcDicz7cRhkl5PJqvb5SODqlTp4baSFPzxeHDL0ND4+Pj09PTCwsLKRRKVVUVm83G8wjaCIC2qSXbqGu33jP+3mKlaNvK334w6oEQGrZky5VUNtaUNhppbPzH6l0Hjzo6Ht+/Gj9C1+t/s7e+pEmFzPKEMxePbTDT7dIFITR1kcX+o46+JFJZYX1thBAa/svCTTYnHA/vsTCbgP+h7txF99cNh0+dcXTcv9xArxtCyGTXJa9cDoZhPGpU4LlZk1A3nW7L9zo6nnF0dHTcb2mg1xeNnWrrFVBWb33U20aYTCKkks9r9+2GENrs6JVNFQuocVf2WwxDfYYNW7rriKPjmZNHbFZPUVNVRmjk3gfx+UwJuzgg4P7+TXMmDUcI9R1kYHnA0fnapVSaSMrOe7TcxEgHmZgt3GF7wtHxhM2mhb8MR6ir4Y//uqdxG/rYJMyK+AcOI5GKhtafzwqoPE7uk7XTR/VARst3uyWU1u4Wq/28cHOX73A45ujo6E16VcRklAV42U4di/rqGVjud3R0dDzj6Lh3eTedbmjSrHOBUVQehgmrUu6f+s8E9TDU/2PbYUdHxzOnDm/4VbdLZ4SMN1x+kUaHfUeg2TRjG2EymYhGS/7998jOnesLo3BV1RfjxvneuxcUGBgREUEmk1NTU3Nzc0tLS+l0On4RHJyaDUDb1CbOxTYYNXn/tSe51RjWlDZCk+a7B75l8DBMSI27v9/CBCH0w5Rxt1P4WH3nG9Hqb6Ox/50iplSJME5u8KVdYxFCSKdnv+V3szkiqQyjhm0dPbQXQmip7YnXZSIxMy/o7L6pSLPb8LmbYypqrnejvtn/9099u6IJm2wep1fVs+ej/jbCpCJ2mru2fg+E0L9H778r5Quo7554XbWycnR1fV3CwzCZkFkZfXaaproaQuNOE6PLeBj2yfONZBjGyQs5dsrByorw4mURU4RhImqC95HlQxDqMnjUX/4lDXxqElbhW0+biUits+a026lcjhjjZXpu+9mkBxq+xOpODKXmG1Nso5FzH0blsGp2KYmq0h/bbJqAuvb96e/9b6g121MRs3nu8G6aaOq+s0F5TLGwKieYeMPK6sTl85GFXAyTSUWc5Ovm+t01ETI5cCug4AuO/AHwZZqzjTBMJhZTPDyi9fTq23UU2rXrk+3bPe7ff/LkiZ+fX1hYWGxsbHJycm5uLoVCYTKZ+MPavvV3DQBoglZuI8OxP5v/teIk4Wliec2f1Ma30dDjT1NLa/aAlCc7Wq1GCA2aOOZCLB1rfBsZ7j3jk8dQnKMxyGC2bx6GSTEMwzJ9TEeMQgj9ZuUQXsBhZQWf2zYOIR09w0U2zoRaV2z/GTG4F0IjVx30Tqnn5O/GtJHiiyI+LT/5lusNxx3z1FU1EEKHPImFLAz7knOxuVRyVLjLWbt/fx+HEBowwuhhZv0fmoRdFOVt/xNS7a5pejmyQiSUYhg3zWf9tAm6aLjFvmtxVFGdzwshhHZ5pZaya3/XM1K8D64aiVCvwSP+sb0if3OcbRYZ6ukgNG7bueCsOrdtkIjYpekEtztO+xZ176qD2ta586AdaN42wmQyYVXV29mzIzU0PrHTSE3N38TE/coVAoFw7969R48eEYnEsLCwuLi49PT0kpISBoOBX7b2jb9pAEBTtGQbaWrp/Dh5jrn5vHnmc2rOj5603MorNpelcN5y49tou2t4ae2xl69uo4VHL8fhofXJeyDVbSNaMqHBHWJLrRxj67n2roFjalIRPdFZW787QmjdKc9MihDDJBxaZlIskUgkPrp/Yf8qxXV8to1E9LyI8FAikUh0P/fnrKnyL2y4jaSskpgbR39BSFO389Ljbj7PnhGJRKLHpe1jxxoiZLJsrVtChVjx81JCyOhieDFdfiJSeayj1dIG3pzVxwjJNAyT8Bj5aWQikUh87OV2ZCNCqvIZ0EagWTVzG2GYRCIpvnkzZsCAj3cdvejR46Gl5fXr111cXNzc3O7evevt7R0YGBgTE/Pu3Tu8jWC/EQBtVmuciy2TYAyy28wJ/TXUEELzN58LSWPxaw+7K7TRWb9sJrfmVMUG2uiUJ7mydgdE67SRamfNfj+MMf3I/ot3U2iffk/qPxdbLGan+azR6qWFUPfD14OLmZiIkxXxaP2fPyGE1LU0+xuPGT9u3MghekpKyp9vIz49yt16mGE/hJCOnv7wkWPHjTQ21NP9XBtJ2QXkW9Zm9YbNuD/W3yXTJAqflypC2+7G099fXFbbRupaOv2NP/HmHHYjZjNEvII4v70rfkEIqXZW6/fDGNPxpmOG9VNTVYU2As3tW7QRp7w8YdasiLpnHYWrqvr9+ON1R0dnZ+crV664uLgQCIRHjx4FBATExMSkp6eXlpZWV1fDrSABaLNa7zq1PN/fpw7qrIYQ+vkf6+fkyppHnX36b620KHr3qkVtrY3oKfdP/KeJUM+ho/eHUxv1ntTTRjKpkEGLurFZs7M2QlprXLwyaAJJQdiuFXMRUtXQ6jHxj9/dEhkSniDnyRYtDe3PtJEUEyVeG6BvgJCmbq++/x6/GFPC5eS9urR7zmfaSMYtinI/9MGVb3WMXLjBLaFK2kAbVcRd3muhgZDh/2YffVVPIUpKXp/euRQhFXWN7iOn/+QUR5dJZJTg/f379IQ2As2t2dsIf1hb/uXLMUOGKLZRcJ8+Hv/+6+TkdPnyZScnp+vXr7u7u3t7ewcHB8fFxWVlZeE3CxCJRNBGALRNrXkNfx5x6uzRysoIoSmrNzxOrZLKMAzjVb4JPq2KkCpCG93JtGoRhmEyaVXC4w0Lp7S1NuIVkq/sW6yCkKHxgNtJtU9hlYq5XC6bzWYLBKJ6HxJX20azVtv4J1LYtSrL3z07h5A6QgiprboWml4pxEpIVpZzEELGsy2ux1djGIYJmdXR57TxE9EbaCOpCEtzN9LvgRAyP3IvtpSPYTJZRYLbkeXoM23EKYm55GCOUCelTp01tevQ0uysoqKE0NjFFneTGbL624iTFXF0w+/KCJlMHe/5TuHN4eBvjlAsldXuWzKaOPtMDB3DMEwqlCS7DNDvjqCNQHNr9jaSyWRisZhVUpI4d678Xkfhysp+Y8bcPH/e2dn58uXLzs7Orq6u9+7de/bsWURERFJSUkFBAZ1Ol98j+5t+ywCApmnNNpKK3xHnTp2IEFJW/d8/Ox6lsTAMEzML39zGz6hR3XA/oZgpxjBm2qOV//xPRbmttZFCQ/QcaHwvAxNLMQzLJk6bMElbW1t7o82l1Ip63pPaNlJWVdPQ1FJMD43a+zEdvv+awpRh8jZSmrJwQXAhhon5VYnPd6lrqKEvbyOV7VdvZzEwjFMYcWzfXNXPtJFC8xm6J7LrKI0jLFk4FiGlCb/96/mWWX8byVh5Ifa7ZyGkpGw0dqp3NoZhUgzL8P5x6I/a2traVmfuZdNq20hp1PRJT/MwTCIRFpBsu+t17QRtBJpds7cRhmFSqVQoEORfvBg7bBi+5NB+/Z6tWXPLze3q1avOzs7Xrl3DD6gFBgbGxsZmZmaWl5ezWCy4gB+Atqx17/0orgi7uGTaUISQmta8ZdtjSjFMJmJUxNxYhZAqQto99Q0MBxgZGer30tLCU6CxbYRJMUnKXSN9Q4SQTo+e/QyNNh8/npjeTG0kkzCzya67FyCkpKzSs5/RACMjI6N+vdVU1RBaanU9ukBY35mWDT5PTRWhVeeJhRSuRIphWO0xNaSuqdHHwMhowABD/d46qFOnum0kK0s8s3slQkits1pvA6OxE3/0yuTy4vFjajXfu5GhgZ5uVw3UcBvxi6JcrOfXc6xQWpXgtmHhSITURpmtuZPCqreNMJmYkRp+ev0chFRU1Xr1MzIyMjIy6tdLRVkFoVVHvBJLRdLaY2o122xkNGCAgV7XTspKCNoINLtv0Ub4rqPqnJykP/8kKSuTlJRCpk175uZ29+5dV1fX69evy3cakUgk2GkEwPeile+LLeHmv3BaMNMYIaSj++v6zTHlmEwiZpfm+J5braGuhafCLxv33r59ffn8WU1pIwzD+PTnjmMG9a0Jj5mbtvq/TmyeNsIwqYhHL0x+fuXIAsW4WbP/wvPkMhqv/t+x9bZR116a9t6RMQU0rlhS85tTxCl+E7hj+fyaGX179T3uGRPpaa/ZqytCfY/fCC1lYRiGiXgZ4U6ba2d11dM6HFks5FQmEy8bD6q9a/es+cvdPR/b77dASG2QwRT5vQkU8Uqiz9ks1EGo3+BRB/1LPvweJDTy3fV/jENIY8zvFg/eVdTbRhgmFXIqcsmPju6rc1L31pN3XqRX4M/4FfEoKRH2my1qN7qzpv3tyBjP430H9UWo994zXnkQR6C58AsKMtetS//vv9TVq4tTU5uljTAMk0qlAh4v/+LF2OHDowYOjNyzJ+D5c09PTwKB4Obm5u7uju80ev36New0AuB70RJtJGTlZr8lEomh4RF59A/vhShmlca/iSISiUTiK3IclYdhGCaTSHmU9AD/QCKRSCQSyVn5DAYt7e0bIpFIio0tYoowTCrmMfKJ/n5EIjGntFpY+8tMwMpNe0skEkNfRuQpPHCCUxpFCsUXRoxOSqFUVRdnpxKJxODwkCy6EJNhGLs09EVozbr4EgzDMCGnzpyaBZVHkSKIRGJsWiaNV7tPSCrmVZYkERVkFFTwGn7cBbc8KjqC+AlBLwKK2eIP/4ey9vsiEonE0BehpSyZmFUc8CKo7rqErOLs2lmBwQHplTypTCbfZiKRSHzzNo3B4hQXpNYsh13TfIokPFpmWmx9nxeGiVmUlDfRtZ8FX1hNzSESiX5EYmpJtUj84eKkQnZJfoLid6j4eSm8z0QikRjkH1DMEMtYpaGkUCKRmJpdzGn4sXQAfDkpn8/NzGSlpdESE8uKi7OzsxMTE2NjY1+/fp2UlJSXl0elUrlcbmOvq8d3HVUlJ6csW/b6zz/jnz0LDw9/9uzZgwcP7t69++DBA19f3w/ONIKnhQDQxrVEGwEAQBshkUjYbDaFQsnJyUlKSiKTyWQyOSUlpclthGGYVCrls9mlz55lP3yYnpISGxsbFBTk4+Pj5eXl4+ODX54GO40A+I60XBuV0QofvHC+6nMYBgwYMFpnPDns7O1w0cP2jLv1MZfddpe3Hbqw5dCFLfbO24/f2ON458AlT9srjxu92CtPDjt7259323X66tZjLrsOXdxidXLtdgfLbXYrdzhYWp1cZ3tpyzHX3Y53rC952Dp721950trvQ/3jms8Rz9DrHD7r87/TAWi/Wq6N3mREWp6Y0er/5cOAAaPjjieHnR87XPa0O3f34Olb+45d33Pkyq4jV3Ydd9lzmrD//L2Dlx/ZNaGNruJ55OVw8YGto7v18et77C7tsHHcYn16k43jFvvLO467WDnePnDxoa2zl0NbDqOrPoedvG3/sjOl0EtkdbXA3wgA2o6Wa6PolBfrz5i1wIoAAKA+EomEz+dXV1dXVFQUFhbm5ubm5eUVFRVRqVQWi9Xke1XjZx3xeDw6nV5UVJSRkfH27dv4+PikpKTMzMySkpKqqqrv4kwjnoBjtmdIYVmOQCAQCoVCoVAkEkkkEqlU2sa3HIBmBG0EAOhA8JtZczgcBoNBpVLLy8vLy8srKyurq6u5XO7XtItUKhUKhWw2m0qlFhcX5+TkZGVl5ebmFhcXV1ZWstns7+JMI7yNMvJSGAxGdXU1i8XicDh8Ph8vJMgj0EFAGwEAOhCZTCaRSAQCAZfLZTKZDAaDwWCwWCwul4u3S5P//OO7jvh8PovFotFoFAqltLSUQqHQ6XQWi4U/WbbttwXeRvEpsUVFRSUlJRQKhUajMZlMHo8HeQQ6DmgjAEDHIpVKxWKxUCjk8/k8Ho/H4wkEgmb5w48vmc/nczgcPLyYTCaHwxEIBGKxuO3vNMJq2yjsZVBycvK7d++ysrIKCwspFEp1dfV3cUwQgGYBbQQA6FhkMplUKpVIJBKJRCwWS2p9/Sk18iWLRCI8vORHo76X83XwNnrs6xEWFhYZGfn69Wv8BgcVFRVwAwLQcUAbAQA6qG90HZZie31HVYTD2+jWPRcfHx8/P7+QkJCYmJh3796VlJQwGAz8yGBrbyMA3xy0EQAANL/v9Op3vI2crp+/c+eOh4eHr69veHh4YmJifn4+jUbDnwTX2tsIwDcHbQQAAKAG3kaOl064urq6u7t7eXkFBQXFxcXl5OQ0+b7hAHx3oI0AAADUwNvo5LkjV65cuXnz5sOHD/39/WNjY7OysvBn8UIbgY4A2ggAAEANvI1OOB52cnJydXV98OCBn59fTExMZmYm3kZisfjzSwHgOwdtBAAAoAa0EQAYtBEAAAA5aCMAMGgjAAAActBGAGDQRgAAAOSgjQDAoI0AAADIQRsBgEEbAQAAkIM2AgCDNgIAACAHbQQABm0EAABADtoIAAzaCAAAgBy0EQAYtBEAAAA5aCMAsO+ujaqqsJQUGE0ZVVXN8jECANozaCMAsO+ujcrLMRIJRlNGeXmzfIwAgPYM2ggADNqo4wxoo/aNy8Vyc2G0z5GXh0mlLfSDBG0EAAZt1HHGN20jmQwrKcGKimA0ZVAozfAR0Git/zMG4xuNqChMImmGH5IvAW0EAAZt1HHGN20jiQSLimr97/E7HfHxzfARQBu14wFtBEALgzbqKAPaqM0OaCMYDQ9oIwBaGLRRRxnQRm12QBvBaHhAGwHQwqCNOsqANmqzA9oIRsMD2giAFgZt1FEGtFGbHdBGMBoe0EYAtDBoo44yoI3a7IA2gtHwgDYCoIVBG3WUAW3UZge0EYyGB7QRAC0M2qijDGijNjugjWA0PKCNAGhh0EYdZUAbtdkBbQSj4QFtBEALgzbqKAPaqM0OaCMYDQ9oIwBaGLRRRxnQRm12QBvBaHhAGwHQwqCNOsqANmqzA9oIRsMD2giAFgZt1FEGtFGbHdBGMBoe0EYAtDBoo44yoI3a7IA2gtHwgDYCoIV1mDbyp9y/neziQq4d6ffvM+uZzPMN4vgGiZr5F1wo58VTsovLGxeXwqcvxKEt/usV2qjNDmgjGA0PaCMAWlhHaCNJkG+xl63tuIGG6L3x48bd8XpcFvTB5GD2syfhWy6H7XMrxNPnDwAAIABJREFUb+ZfcESyx06EkCpC23Z60Ikt/usV2qjNDmgjGA0PaCMAWli7byMZKbTs6Pz+fbXRx/oOHX80UKwwWRJy4dqcUcZojpUFtFFjQBt9zWjxNpKRQgUBAezaIQgNlSq+Gh4mDnn/KjsoRBIW3thvShYWLnkRprDYUG5Q4MfratYRLgnFtzlYHBYu+4IvkYQE8wID2AEB/BcvJK3+Y9DAgDYCoIW19zYKFZJO2PXv0bVTp0+0USclo/5G3grzyZunTdVXUoI2aixoo68ZLd1GgVUBtlbdu3bT0NDW0NDW0LA6eDBbYQL7+Y3HVjUvaWtoaE/eHHbzibCR31TZzSevVl3Ie/8vjj+OGvTxuppx8AM9Q201tLtqaGv8/PDGQ9YXfAl58/QZRhraGhorli8nt/qPQQMD2giAFta+20gaGlzk+EffbhpKCKHhCy7aOWV4eOR7eCQ4bbJagBBCKt30xjqSsNqzf2LX/zRRDyFoo8ZqtjYK5ZIcfxw5zEhPb8eG81ledV4tvXXrrJ6eUb/+xvOPFvsGfbPdDy0+WryN6AE22zTUVGv/H0FnqfXDh+8nVHq4XJuuePh5fbDr48a00cOYwyv/7TFxwchzue//8ZTRcH2E0DZr68xv8zbyAj2CbBBSQwhNuuvyoL6zCRWG09XpPwxVRgghrZ8t7Nxa+8eggQFtBEALa99tJAkNzj86R0u3M0JozV67d/4v8D+o4hfPYu22WiCENLsbLrrAeBEmIznNnzPVuJe2lipCSEevu9Ho4fP3LLmJF5LgRVDEqlFTRg43HV4ztq06+ObeB6sL45IuTJtsWs+cT7RRubvlnqXDTYcPXzHfMujmN/71+p20EZt0VFtPFyH077KT7zzqvFro4nIIIaSspjXNJv9pYJs+CNKo0dpthMb8feWsJ7/m1WeZN3eu12p6GxVe3ms9SVcHDZs+vE23UfW1tTN/7KOOf4/axv/+7ZDbHJvxTQa0EQAtrH23kSw8hP5kl3ZvHYTQ0B9+uHjuXGntSxwfn9STJ4mnz4bcfCIMC5f/7lYwZsFPToUkEtPHx3Pi/yb0UlZWev9ar14D1lnse12bPsJgn4QLk8ymDVdRV1Wc85PFPreaOR+3kbu15US9bggZT1t94Gbpt96TBG3UZkdrttGQX4y66PVfeHr33aqaVx+Huqwfq6W16q+/kIpKE9oo88Sm9T8g1ObbKHHT/4z7qiEDg3E9ew5BGtMmLnnu3to/CfUNaCMAWlj7biOMFC4geR6c0qtrZ4QQMh45cpGZmaWZmeX6vTc+3Ovj5XXyiO0vQwZ3RQiZmP1vzSXrM6HnfKoDn8YfXzMeKamiYTs2bXe1tiZYL1890rAfQn1+mH3c/iGfRMJIgdlPjs8ZhZASQnM2Oe60JlhbH54z0qQ7Qr0HWqzfm0EifdxG8Vv//alfd9TbZOGaoy+ffftfr9BGbXa0Zhsttv99yujhI7dvssdPAxI9v/3owB+Ddce72NggNbWP20j47M4Lh7WW+H9HZnPXmW1PeOZfe8OLhzfstv45bviwrgghHb2uExabLdr5h2tpcJisThs98jhjVbOEvy0dPnUwK8PO7mzNKswsF/5ta+PG+WhO1SO7m1b4nCVHLB1SG9dGbjcmD+ivjmYtW3bKYoZZb9Rj4E9799/j1Z1jZfm3pZnZZRun+Ou167LcesGdhJFI0rCQSler9Yvm174Vqz3O3KysuxZRSHCC1R/r5td+I2ZmZ63OpD9q/E8ItBEALay9txFJRiIVnrPaO7FXL02FXUK9B46YaWFlsc5x7W2qwuSPzzeSBD8vuHnEcdPmC5uO5/gFiUkkjOQduHLaZF2Eukxet+w6lUQSBN0PPD0eIWVVNHPHhWdVwSSMRKq4abVk2vhJY2ZeO3OmmET6oI0yr23dMFq/V2+Thf8cILk/be57KX1qtN82Ejx2fWK72crCwsrCwspi5am1R/M+WnK568k7my1q51g4WK4NIZCwMPmEh252u6wsLO6cPJlDfPDy1E58mt3y5eQWuIKpNdtovfuerVOmDV3816bYxySMRKLfvXh57gjjnht8btigzh+2EevpRR/rGb8a95RfzqCCDBaaLwz28uKQSBjpuqXF5Lo7X3X1NY6mBYRKa9tohbm5zQYL0zFGNa9rd+8zZ+1xhc+C9/CC6661FsOHG8mXoabde8iv1stts1+8v8atxNnuvMVwk5pJGn27G1ssNl8yESHlz7eRjETi3N5kbtRDE409an057txmy//1QFqD/5hvU/cnp2abhwz534LJ+Lq6DBuzyMmTJAohZlxfsm66kaq6Su1Wdp8wZprzyZOFtV/OIRKDlyxeaKSiIp+CkJHRmAMbTr5rbB5BGwHQwtp9G+Ej79TWU6st1s8eOKTOcTMdvW6Ljp2+xwutuUT5s+diV3keJNhs2jVt+DBdhNBkS7PrJSQS47GLuwVCndQ0DWxSveU3BXjkcfKM10nX2vZSaCOLvVbm/fR6ITR5zXWnFgkjUrttI+aTMx47Z04e1qP2M1Xv1cVkz7ZtqSEh8r+j+WfOnJ85ZlSP9x98F40uf8zdFkkIkYTgc5zMzcYghOZNm3Z8++qFY/vi07RUVZetXRt8048f/C0/mlZtI8+TzjvNpsyYs8nDjYSRSAWXTh4YpD9yrENkgA3S+KCNnhJP/zPdBOnr6y+xsLCysNj11+LlU1RU1dHcJUfiHwQISY88Tu5fM23MqO4IoW79u/+y1sLyyHJCxYv3+41Mev9gPn3+OgsLKwvz5dOMhyCENHr2N79HC8avuveM2vz7BP0uCBlNGP7bJgsLK4s/Vs8eZYxUuqgab13rVuoXIiWR+N7XLi4eN0wXoS76Y8bP3m5hsevPeUvG9639eD/TRlISKW3HxH491ZHx9rvniYzHZxz/Gm+AukwesyjQU3Hm++PsJmPGrLKwsLJY67rvQgkpuPjZhXUzkbIymmluvt3Cwsqi5nfLqDFzXc48YZNIkuDn7y7snVvbjjstLKwsZv42sHcPhAaNnHvpRCOv+4M2AqCFdZA2wgft4d5LW/Gd29PNxw8yRAipauqPXpoYVHOO9ifbSBQckHPBmnDAmmBtfepvvX568r+wNW1UftvFcfBnj/XUtJEyQrMGD9bo3Bkh9H/2zjOuqbONwzebgIoLwVEnJWrVOmgVLWodlCqt1qpYa9UOB2pbq9am+GIdrTiKWBEkyJQVRMImrMCjiMh2MAVk7703eT8cCEOGcQSU+/r9P7TmcM6TM6885xmwcLuB/q2qN/fQ7Zy3zY1Ul2z+R5thyeiI/u7dX3R3IxdHnRULlWDqtGnrNTR2a2h8u1p1xWwYJim9/4hVPofbQkiDi4X+io+VYLjytHlfaWjs1vh0o6rydACahPSGH63KvLithPDdiD569KcqKhoaGrs1NLatWLGIOl7qJx85er9BhR1gN3L21NJYvnjH2bMetYQTq3f8h9FTFuwxSuLozKJJinZyozL7s/s3zAHa6LXrvo0mhEdIc6BvsuniRWMkJWDlv8ct8ziE1197I5is/vdf1Lsnt0SjgweUAWD4eNqhKE5ACyEVzvu0FyrKg9wc+k6zk7fKCeERz0ybk3/NlgcQp4GmN8u9jpB8wy2r58sBDFdetOnaZYc6Qpp8XGPO/6CmACDSrxsFNRJHm2XyY6Vh+nY9wiI8cuvOsa+/kIOJUxae0Oncsqq9zHKTjx77K6393+u8HTkn1UFElKYwz9WJTb2GK3bYe3jtuDGgtGGFTpQLafJxjb18sOs7R1sXLdWPZAFGL937vUmJQGcIuhGCCJl3242auNy0ixe99PQ89OxyXPw6DfPo8tTk6C9zJwPAaGnaNTtOYyDh9eRGTQGeKebHj3wAIAoAo+bPXaChqqo2TV6e1uFG2ebMs6MARCVlP9BJYvfjRhQzJ09WkpWVgUmbdumGer+xh27nvG1u1Cud3KjMjqG+dDrIyP/w/aE4QniE1HKs/U5PmwziNNjKvu5RG0CqrE7rfrtOU3WT4XGDbEJ4xCPZ/PdD3Y9XmxvBqAmbdx96QgiPkAoX55sfK4GYKAD9ysWbJW+u6mgA3UhuL1vfOex/Gp8rf3JYyzDd19pP5wv1yfRtzE7LtLtR9GGtjeMBRk1frrHPUU/PQ0/PQ+8fF70dW0bJygCs3K4XwSK8/txIcSPjtk3bP5Y56xntBQBpBZo6l+PXTMiTk/RZUwFA5U9tgyz+Vcy5df/055MBJAD2X2eVBJCEc6pqswBk5v7y/d/8d1hV7izHDQDi/bhRa1BABfu3beNGyIDcoX36yS6ER0iGwZFfVIbB8Kmfrj+Z9VyZQWWHscHt+vZ/z7/J1KcDiIpLf7DV/H+n3dp2xcHf1WYpASjN17hq2H2j1W6G5KrefxsWLRjbcd8Q4AxBN0IQIfNuu1G1D8dyOk1aDAC+0vvdLLO9Dz+PkDpPOzudrwBATop2+hynwY/wenKjMjbT6hsAERHRYePnKm3ysnaqJiR8v8ZqhY57XLEj02Q1AEjIwC8hLO/2350+JU52eW3tMAjfjUQAxilMNzvOuPrJolkyErBk8ykDp+fbmb7+vItuFPyd6kdjACYt2fu97t22mfIMPM99Qz0itQ6zCrv2/mvyd8t1Yvr/rXN8LgBIyoBOOMunkRC+G41aqfWPVYdDZHJ0xtEkRQA27GU+c35jh2YA3WjRXj9T52cmG79aOv0HraPhrEsG22fOpy/wfG6ZBkKIlpZ6H8dlu57HC7jR1m2MqPb3Vs+7EXcj/X05AOmNer/y+80RHvHIZB3+idrKYVaaR/txn6F+qlMb7Rfsp9YU4Bv/x1LZEZIAs44fOuHPZEYwmXfPHNy7ciqA3CKljQFe3cs8ciODZdOxhrZ3u70xX2O3IeER0sz1L7ZjRpgyI5hM58NTpnfMWIRuhCCDnnfbjRq5PjGXFGVGiQJ0GfsxjcUKPH58FwCA6Fiaoj2nrZHQ827U0cblI50UF59mQlr8vG6tXbWo0z2u2svM+Y8RAGLS8NENa5eqQOoxfNns60V/aGp6s92q/cjz/dTKmb9tXjRZCmDdxq+5naTtTeVtcyNZ2VET5RWnKnZk0pgxcl3dyEVVdV4fT6nDrDQPwiOkwdst/3aXMT8BenajLVpaD3p0iL3MiHfXjYrNf/9m+bRNX2u5WTHObJZfQt8d0YcbiUnKDh89WbHLoZmqqDh132WuE+EJ0of/eTdymkufKgowY+N/Z2w6/WDo7kbuK1Q/FAOYon7yuDl//OsXc6OgGj8Xx+U0aameT5nJiu+fPc0fVrStzBs3MsJ7cCMREWm5SeMUuu+HVVrHmKQl0D+fZXj5I6ptuNTYMfKTFRUnjKDRxNGNEORt4N12Ix7hVpNz494bI9LjnCEAIiIjp40+l8hp6/8Stl91yXgAWP3r18apHN86v8AMU+ZJCQCQpMGxO1YupRxO1r/fr5qn0PX3n2eU41Gq3SoctIpz4lRxOPH/rdVcDABiHy/QvGVEehz70V9z3SdiIjBp8f5frpW/oecuP2+bG71IW+w2NxIVk5SUkqV1muaCyjHHDE/SEuj34Oe1qyYBgIi4mIQMjSYrLSUl1rMbbd6qFdrReW2ouFEDMflRa+ly1c2X9xw7Mkd5xSz9Zz250Z1vtD4TBVCYr/WTYR+n66u40b0ddOWxAPDl39o3O/rDB7mn2/28CwAApI6y0j351+mao1o3+O0Ca31YPn/060Y+xZ5/7O887mU3ho3/8It/irqWuZsbZZoydcUAxCRll+o866V9YYU70+EgAICImKSMdNscJlG/aKydhG6EIG8D77obkRbCzTj7xaQe55oFmKygaM3p6Bic8p/qig8BQExCXEqWtnjbCqO49nscgCRNmjaMRpOVkhATFenqRkHVHDu3YwCSABLSMm2LiYmLAcDinZ9dywgkPbpR6bVfti6eBCJiGus0g9/Qc5efd9iNpq3WOWac32ny1LYEBLUGkWdGK9QXiYmJAMCkjWsPhnM46RZX9T/q2Y1WLNPyMO14jg4dN7LVWqoyeeqSD+Z8PlZ57Tb9kp7c6AlDa/M0AJH5G5cZZvS+/ldxo8RL9A/eB4DZv2vrpbcv1uDpEHB0mQSAFIC+HasyiH+dvr9X639P2xercGXZruynD3+Tj2u07koJSbHe1AhERihP/Dqka5m7uVGhHdOQOn/EdCLazp/uyaR+U4lJyiw9Fsdyrw8MaiXEb53GMhF0IwR5G3jn3YhHSLOve5bTLebChTM73wRHTVPbcCLWqUtbnyY/F8e1Kxa1LTHxM9VDMYH+JS6GNw8CtP/SPHT8eAjrn82aiwCkPtfYRN1GW4O4tRy7OMejMvIjOjahtkPngkuRGzVATg9u1OLv7fH1RjUA2uRFe35jvsjsmC+fd9GNQnarfiwPIK7++7fmBb2s02uN6nxJgClqhw/qp7t5NxKSeYP5l1TPbiS9VOuECf9vfTI4OiNokiIAWnuZae+kG+02DHMKbCX+XK2v14iLS0pI0JQWr9fzayFBlRwXAxpNqpMblTKP71s1BUBSZuaanYaER0gj1+fRpamzlBWnKir+e/kyNej8q7hRo9+pM4unTQYJueFfnm4be8zlqdkv+0ZIgZiE7EcH4128mwhp8ju/bu1sAPHhSqsYOubVhDR6Od5hqI+Vpi68Xt2o0s2RtVYaxADgh5vnzBPa37CnsVgJhidPbaADiI4fNeVS2xyLPbtRnZutt/YCABERkBv/x61ML8IjJMdca896xamKit9paT3oeO8mKSOtE+Xo00g63qGjGyHIW8BQcKO2G7GdXVxbc11mBJMZYW6d5OT9fH14BYuV0LaMRZIdu4aQlkD/Cve2NpURTGa2p2cD8UlzsotgMpNYrE5CE9RCPKMtzDo24cDO9+146lf7u0YwmZFMZoarf1P77LaVTk5JTGaEhU0qm/Nmxxh8F90o9+J3qz8YAzBCceWeS1aER0iNt7XfKboKnb6UTr/l7FzDr1uSUj++07yQkAa3m26HNcZDz24Ew0Zv2LY7qu3J7cR8fzyIigDMNTawKQ14Y4dmAN2ovT7s4VGtryYBAExXVv1Xn/AIqeRwrnV1o2Zf9+A/v/1qKoD0MLn36Cp0+iLl92dNFBUVA/hKx9/Ok+qFkGOu/ZsGAEgPl35vLl3l83kGz3wDW17MjXjEO/n0N8uVx7TPaUhXoc/4YIr8aJAcI63KtHCu5Qa2EsIjnLvnV6+YByA5bJzClAV0+iKl6coK/EngenMj75xbJ34bBiACMPdwmI1H5yqfFn+boJNfrQSQkBm9sG2OxZ7dqJXrn2vz35kFAKIACtPnKtFV6PR5U+RGDgOYt/bAeVYlvw8HiIjC+FnT319Ep8+fLD9CRgLQjRDkrWDouNFQz7voRo0edvbfLV0wFmDUhOlzVTVVVTU+mrtwGoC4pOzW0wkevk2ExDBUl04HAPnpEz5cq6r6+aJ5CybLQS9uNGfs2E8XLFBVVdVUVVVfuHAmgDiA5ga9BCefptfw7XrJIHCjNEOt7z4BAPh4kaqrG+H15EY8Qqpd7CPO7Nm3Yiq/blQCYP/x4052nuXtYxzUc+y9D21e0/a5jCJtWwjHv/lF3Yg0etg9MLqsp6a2gL+N0ROVdl/wu2hW1CZGhEdIraeZzym1Ne0LTZ048ffTx89s7asPP38sAHEAzV3Xs10CWrss4Jt6TeeYEoCozPiJ2yJ8OsrczY14hDT5+2ZeP2v+3QJpWUl+MdesW2doYh3vSXiENAV4ptnwywMAoLVrl4XewdVqswBGfamxO0KgMwTdCEGEDLrRUMm76EY8QkpuGrr9rLlqzjj+I2qsnJy2zglbey5VOVfpom/729yFSm2fKikpHWUc/ktbHUBUGuaxWOwaQvhupPnpp0Z6jJ82L6EWHiYpuffIkZCbnHr/N3lohO1G3Hqu/YMTOtYMhqWFW7Ev4RFS48EMvsqwZDC82udjbuRyE06cuMlgWF6yyHHnd90iTRx2vOkF/oCcNxmMBA6nW5ubUju7e20LnGCduJrLDWwlTk56ZywZjAd2dnxrafB1SrDovEzHGvKZTD/+sJ9n9Dycevgi/DJbMhhuenrPuJwce4alDsOSoZ/i1sNYnS3+3jk39S0ZDGsG40FPx7TG3enhpR7KzDW2K/LqvnBrUGCV41Wbkyf4u+KepWWncQdIc0d5GJYMRrSTUzVxC2ZetmQw/AwN8wU6Q9CNEETIoBsNlbwdbhTUSGz/O3b4kra211X74q4PpEo2O1hb+9KBQ1f+sarw7fjR3+Bq5X/hz0va2lRMjx1L6LraCvZFl7Ntn9qfPZtG/PK9zC5paxtoa0d7eTUQ0rUPv1es/VVq4Wtd5x55UxG2G2HetqAbIYiQQTcaKnk73Gig0uP4RsIKuhGm76AbIYiQQTcaKkE36ivoRphBHHQjBBEy6EZDJehGfQXdCDOIg26EIEIG3WioBN2or5gd3v2FCp3+x6G2iWaFGnQjTN9BN0IQIYNuNFSCbjRog26E6TvoRggiZNCNhkrQjQZt0I0wfQfdCEGEDLrRUAm60aANuhGm76AbIYiQQTcaKkE3GrRBN8L0HXQjBBEy6EZDJehGgzboRpi+g26EIEIG3WioBN1o0AbdCNN30I0QRMigGw2VoBsN2qAbYfoOuhGCCBl0o6ESdKNBG3QjTN9BN0IQIYNuNFSCbjRog26E6TvoRggiZNCNhkrQjQZt0I0wfQfdCEGEDLrRUAm60aANuhGm76AbIYiQQTcaKkE3GrRBN8L0HXQjBBEyb5kbFRbyHjzAvEwKC1/LYewZdKNXCboRpu+gGyGIkHnL3AgZnDQ38+7f5wUHY14mMTGv4RCUlAz8F8G8ody/j26EIEIF3Qh5PTQ3Y14yLS2vYf+3tg78F8G8uQgNdCME4aEbIQiCIHzQjRCEh26EIAiC8EE3QhAeuhGCIAjCB90IQXjoRgiCIAgfdCME4aEbIQiCIHzQjRCEh26EIAiC8EE3QhAeuhGCIAjCB90IQXjoRgiCIAgfdCME4aEbIQiCIHzQjRCEh26EIAiC8EE3QhAeuhGCIAjCB90IQXjoRgiCIAgfdCME4aEbIQiCIHzQjRCEh26EIAiC8EE3QhAeuhGCIAjCB90IQXjoRgiCIAgfdCME4aEbIQiCIHzQjRCEh26EIAiC8EE3QhAeuhGCIAjCB90IQXjoRgiCIAgfdCME4aEbIQiCIHzQjRCEh26EIAiC8EE3QhAeuhGCIAjCB90IQXjoRgiCIAgfdCME4aEbIQiCIHzQjRCEh26EvJO0tPBiYnhRURjMu5OGBmFcO+hGCMJ7W9woK4v35Anm3Ull5es9ubrT3MwLDuYRgsG8O6mre7NXDQW6EYLw3hY3Skwc+BsT5jWmuPj1nlzdQTfCvHtBN0IQoYFuhBmAoBthMIIG3QhBhAa6EWYAgm6EwQgadCMEERroRpgBCLoRBiNo0I0QRGigG2EGIOhGGIygQTdCEKGBboQZgKAbYTCCBt0IQYQGuhFmAIJuhMEIGnQjBBEa6EaYAQi6EQYjaNCNEERooBthBiDoRhiMoEE3QhChgW6EGYCgG2EwggbdCEGEBroRZgCCboTBCBp0IwQRGuhGmAEIuhEGI2jQjRBEaKAbYQYg6EYYjKBBN0IQoYFuhBmAoBthMIIG3QhBhAa6EWYAgm6EwQgadCMEERroRpgBCLoRBiNo0I0QRGigG2EGIOhGGIygQTdCEKHxzrmRX76bYwST2WOSHd2q/Xr4q1ZCii0sYjotmeLkVP1q24pgOuay/ZrewC2yJdC/wp0ZYcqMYNoW+/g3C/jnDd7+VWxOw8De5QedG3GSWTYRTGYE0y6N5dPY47lx06nE279FwG/a5M+tdPSqa//fOm/rWGtmBNM6i+355g+Bd76d9eP2EzKJxarsukCdl8Uji/bT1cohx91X0G/XEhRU4eBZyw1sbfsXnzQnux639RojyD70KXGyi+90VT62sCjpZeE3c10EtRDPaAuzCCbzmZNnrf+rrQ3dCEGExjvnRjaXGBuhF9TVtd2ue1UEdCzfGhTYwHFNdmT9Ky8/qtOS6zQ1XZzYhV5+fT4t+toWgPqxHYbJHpzGFy35i6bWh+WrAyAJAEtsmPYVAvxtQI2XW+RJptduw4zXXSrBMujcyFBTYz4AACz6du3llE4C3UiIlaLiGACYu93uCqtOgHVy6309Ev6zcv78fFL7Pybp0z9QBoCZx7TPpb/x/axvoKo8vf10VFur4dnpe7UQ8uS04gTF9o9nqJ/SMX+B3wP8BDZxvbNt7O3Uzjx24dukyW6tpQCgrqFB3tj3esF92OLnlc8+f1Vz0dxO1+QkeXlDR8cMTlBrUOeF39x1wa0iZ4cpjgSAb7frxbFebW3oRggiNIaUGwEArN570ZTbZjxBQfVet4KPLQVJsR6WVJi3+UeDgsBX2BZM+37zH7EB/F/Vryd1Po5cXdowOdow2nKHGw4v/gO9hWvqvHf1Mpi/QRXdqFv4bgQL5n1mY9BxyF7ajVoD7e+f3aoJEz5Q7HCjZIN5H82lDaN9eOLnC2/+EHRxI/jws13/dXyvZsL1+0JRYdhLulFrkHuazcFdICkDOuGsQehGgYUGP66Zp9DDRSlJG3aMXcYJ4u+KN3ldoBshyNvJkHMjMeV923WTCeER0uDpwD26XKZHMQIAEVHxWWpfG7zCtkBUYqrar8dMX/f7haBmLqeKw6ni+DUFBr24eMXrbv9GWUwM3aiHdLiRqOiCzWpGme0fvbQbZVzVYSwQF+/qRi2BvjW+nCqOb30A9/Uac0/p6kbjF2zbb9Rey8htIOf+N3GknMhLulGRg6mJmoTE4HUjA0O1WUqiItATUpI0E0fHqvaF3+R1gW6EIG8n76obTVaYrvsHK43VEZdvFs6XBwDx1cu/5ZgTHiFArm8LAAAgAElEQVTZZjfOjpBqu1/+YBhs3rbkgwuam9UAAEBCcanKvhjBt5XGOn1+xez3AUB86fdfmOS+seeEQInV0do8AwDdqId0uBGA5Icz19gatn300m6UfoVxbC5AVzcSbvhuNGXx+CmLled/tcIwq+0jbjU5O0FxJOObbyZNm/YybmTPvLYEYLC6UZnh7mUz5cUBYIra4YMX4lisNBYr1vzctR8AAEQARv/ByvRqW/hNXhfoRgjydvKuutH0CXSD810+qmaf1liuDADLl2q5m5AGt5tuhzXGA4CElMz3V+86+jdw25Zs9HWKvLJ5x9fK6l/9GWHdR6PsXrfFI5wn51drzAOAGVoajIT2f28J9M812KWmMleFTleh01Xon105cbWbOTUF+sYZzPtEhVpgvZmeaZztoVO76Cr0pQc3MxIJqfdzfnCerjKHrkLf7NVRPNu7J3btaVstXYU+V33erghffktts8O7v/hg/OhRUgAgM3LY5Hn0T7Yu7XgSlF//dfvaj9v/dvkfu0+ldhQpsIYYqC1VUaHT//er4X393Ue30FXodJUvdp8ye9m7/KB2I6BJz970yfVs6mToxY0KbxqabeTvbboKnX6WYZ3v1nYsrpzYNfc9RUUaAEjQJCbNoc/5hH4+ztkv9br61rX84+5oo7dPhU7f8Im6nWGX8jxhbN69lK6yepfpedtaqhjeTg9Obe60uY23DG+W9fOl+G60YqfK1p0as5errr/Tfh5mGWySHf2x+d7D7ysrP+9GzX4eCee3qcyZ1b659WZ6poVtnzp7GP46f/qUybIAICIK42dNf38RneFn6FbTxY3cgq0ZHQU+5Zzr3b2EGYaGlzrtQJXNpxKcvLv1Lah0M3RiUAvMWkbfdsfZ4/ELuFGJ/vb5ymMA4Itvf7jT3sa8meuTan7uEHWMV5946Ojd3N91EfOr+qaPO0r43Re7fXs4569/t3ltL8v04EbFjieu7KP3eNz7CboRggiNoeNGiac3qymP4LtRhbO+6V45AMmR0ioX7HwburYrqufYx9sbRdl59NnRrA83snLdvfjjUQCw4DuNf9MI4RHS4OcSdXnxqg/kxSRE25/Cw2ZMmXny+HF+vUKNlwv3x48/mSUmJkEtMJyu9MEnH054Tx4AFNVV90b33Bbb1uC41kdT5Md0ep0nJSav9vFiDxeX2uee/QAd9RmthGQy133zycQRspJ8NxgvP23/999HP3d/nzhx5sfK8oqjAGDssk9/cvMQ5M7eOYPVjebMmvXdkiVrQHb25LX2TMLrxY3S9PXPz5tJl+uyQydPnnv2qEmmC+ER82Pa6l33dlv9SmyX5zqHyzi0BkBmAn1Dl/PHzEp9zkwpWPjJrtuG3s2EVHuYeOguWDytc28BuTkz513V1895ITdSP/zlH4cPrflwjqqtGeERUu/vE7RtIk3mB4+L/5u1qLsb1XLs7vyjoqY0GjreSQ2nK31w/uzZNEJ4hGWptx26s9dRz7my3Y1UlZUPfvP1R3Mnd3w+beEqXbvk9hOm7vZ1+9+2fDpz5tTO6xg1TW3BNx4mdvzuBQUW+syvZ85pW42IGIz+aKHK8tnDhstC327U6HZy0aKpAPDelCk6na6vBl/fFD09Dz09DxNWuU9Aa+/XRTMhAevWfTZxWMdlASA3Qn6j+vd89aGunZ3rZ8uNku28zEL170+b9eZGDsY6G6crAkycueKg4TMXdCMEGZS8q240XEbuo0UauzU6sl5ZXp4GAOO0NH8OdyMF1noX1QFg+HjaoShOgKC9l/ve1m6NxUsnjh4JAEqah3TcagjhEZ9k9j/q80BCFHZoa5swGJYMxr+75i5UgqnT1ur97lBKCI/4JDn9o6YAIAIwQ/3U/sPmDIbxLvXFSqMBoA83KnbYu3XtOIDRH81V/5vBsGQc1tdWXw4gBrD4h3+SXX2aiUuA4cW/NT/+aBwATF6otONfxhnX004VJLCOmG5bNUZGBr7YvFmfwbBkMP7bu0pjIYyTn/vzbqvCrvd3AFizfv15BsOScTao/3qLt8+Nli/VvPEL49SSScNlpmxcZZ7XkxvVs80sd6krwbAZikt0GQxLxvEbjE3r5WRoANOXH+Qw3RqJR4Tl1X+3r/98EgCMnCi35TxDx4ZhX8ThJnSt88g0ZvyxBEBmyrxV5nntham2+vnruROGw/gfd5x44kF4xI1rdHCJMoyVk9NmMCwZDEsG4/w2xYmKMGvuLtuL7Kpev1SHGx3TumrF0P5CWfWAPuERUu3DsZxKk1Y+fN/61DzVbm7kGWHz54rZMExS8qcjR8wYDEsG4+IOJfpkUKJ/ff3krXLCSXYyNdy/+7sZACAuCZontY+aMSzSnHwb291oDE1RXeWr0wyGJePotSOaayTFxQBA+U9vI886QnjkVvhfO7UmywEo0hW3XeyyD8csWXTEy9CthpB6tpntfvU5owCkR05euOUag2HJYBhuWTh6pDRAP27EI85XtiycIQcAMHXatPXUVblt9ynzbov1fF2UBQYUmB5bPWaEFEz9bvNuQwbDkvHDr6vm0AFGTpi792erGkJ4na4dWLL5sDbDksE4v3nVyvEAI+RVv9gd1ZMbJZ78TYs+AeQmL/7yNw9nAa8adCMEERrvqhv1Bl358+u6VqWE5JjqnV0EACMn0M7Gc7iv4ka9MkZZ/TtdPzbhEVLtbud8cBGIitGmrebedqsnhEdIBfvYX+umToIJGssOBTuQel87nwuLAEQlYNr3vxtme/q1EFLPNjP7Tm3emL7cKOGMxrrZADB81bLt/g6ER/wqvcx8tbUvaWtfOmOW79k2EsHz7SoauX4xuitl5KRg0hKL/8xKqWezxwXzvXPoMOrDqVvcrbu60fgFl/65Wvgy++ptcSMttv4t36M7P4FhU8euv2VJGgO7u1Gjh32I/olL2kds296HBjUSW4vFY8dIAYzdbnaWRclKj+2NurWVqfW66nR0wRwY9r7i+sD2ZeJ/Wz57Eg3GLf/nT+NiQkrtL5/fOgukRsxcvCWqfZlSx10/zJcfA0o/bj37pNdHbGc3Mr/7D+Pg7A/XbrEtJgHlHOOTNClJLYMEZ72fVJXHdHKjCicT5vfzQJw2frZmmK8f9Yar7PaBI2oTFGCq1md/hN8ivP7aG8GEhZsPXC8ghEcCqv1uWGlKS9MAYJ2Fnk0pIeXOf/yzdeokGK485XP9E45lhPBIUBOx5WxZNG6EFMCsvxiXswgpsTn+58bRADKTJ6qd1XegauxqHfQZahPlZfp1I5J7/exFDbryyE7X47DRCsu1jmlt/1PLNNMjgP/y7vnrojWIW2F74crhny9pn4qxp2peXUP//GbzOACa8qrl+jmENAf6pVqulB0rBbBkx1GzeC/CI6TU/oLOZlXlKUvOnTiR/JwbhVw9efYz+tSRU5dqaN++frte0KsG3QhBhMZQcqOxyz7+1ED3Sooz4b1pNxo7a/2nmocP6PqZOlOjyeVaMS9MARAVk5y2Wmf3nouUuGh//e38qZMAJs3X0DMkZc5MKy0AEKfBN1yWJ//WmXxRa/uivtzo2ZntX84eDgCTJtC/3ah9SVv70s+HmRdsa7lBnQv8/DOgxpdjO5smLQ4wacnezbvOt5XqG+1Vc+gAYybQ95zv6kaf/uJ0o+/3jG+9G7mbkDyTK+fmKQynjd2saZvvF2TZe1vspgCvdCvti4e0980ZPlwKALYbMVhlL+xGPOIRf+WXfQowaqziAVvCCyI8QrxX02fIgNLSH24bujYSkvQP4+B4AKkRE+asO912gLQvaX/x5RT5MQB0dW1W97qQ59xopPqf+8yf3GD879P3ltGPPwrwTLuxc4W0hPoFVr5v+zLtbpT+n96fkwDEaSOVNU7v3de+uY1b6BMUAKYv1TI26d+NFOZrnOI3Zudyws/SZEYCwKJreqZFhKTqa337MQDMWKeqw2+K10pItbW25tQxMgCf7GUEeZAMY+2flwPQJi1f/lvnxuxRv9FnTurfjXiEZF87abpPS3vd/I+UOl+cYhKw+tffr+f0/puhWyrYF13Oav/xueqScQCgvIKun0pIfQAnaB+NNgxAYa/bFeeatoVdCfOK6XGD7Lb/7eRG6juPfrXwg6kAsz/75cwtgcWIoBshiBB5V92op/dcP7l1eg30Jt6p7dTQ+GwyjSYBMGnJPoZxvFfHwhlM5v96UTYAgPkauw1JnjXz0gwAEUkZBZ3HTj58Bck219qt3pcb1TpcPrdp0dThnVYoITN6zibDY8ctb3Kq2kfjff4ZUMnhXKPRpHouE8AEukpXN5q+XY+8Yl8bKoPbjRo9Wf5/fjMPZMZJb2Zb2ZrJy3dzoyq2XcQFhiWDYXpU+5gmgDh/lwnqRqTY+rKB+hiQkZ+8xbHcP6iVOP1Onz4Wph/YdTGRTXiEPGYwvu/jzFHXvtSvG81QP6Vjns06fXH7eyr0z3x9nO/r0KUlx1uynKpJdzdK0tP7uY/NLdU69gJutExVw9W2rRjPu1HUz1obxgHQ5n+9zjCvS4HP/02foAAAGxmWNuTJCe1d4wHGKK/drl/aaTFBx88sZ19k6VB3gNVbqN6jADBD3cPasaaX64JHSCshucanWbod777baXOjGl+O/Yc0aQmARXv5P4GeS8e1ozppkrycHACA0qf7dV7qfTS6EYIIjXfVjXpqH90l/bfFtjSKMPGoFWRbLYQ8+m3dKvlhNABYsvkfPfvi9r45bW4kIio2WmmVyuL1qqqanfPtIQMrkm3OPDsKQFRS9gOdJLYPv86/XzfiEZJhcFxvk6qm6sIPZ07s8jDboBfVrll9uZHc5MXzFq3rVqr1mw8zyWvuh0xlcLsRj5B8a/PL00bJiItv2rr1kKzsiE5uVM+xJ7qbN00FAHFZKcWlqqrrVVWXKEpJib+MGzV4WHn8vmoiyCrSdoVw/Mtd9k2eMRom7rM450K1jG5zI3HpEYoz1bsdIFVVzQNn2Q69faku3lPict1439LZM+g37Fge+8VpEht8We51vbmRqARNnq6+eEn3E/WH4+a2hCdIH/7n3ej+91rrZABGzd/yjWFxlwJ3caOoI9rbhwEMV16zXr+g02Iv4kY5hoZcPT0PPctk+87TgHCKXP45/7ESiIkCgO5FZr5fz9dFSxC3hH3xvNqokTSg2qGvUVVdOXPK5GEdblTtwzGfSJMWBVDa63XNuZfBHbq01ZuqqKg8apTcS/djQDdCEKExZN2ojz78zb7u0Ve+3bFSecXcPwMF78Pvq/6J0jBpAFBd8q2zgTt108wyY56WBRCVlF2gk9zJezqn2JFpshoAJGTglxCWN/+enmGstXNFP27EI75Zfr5ZPs4ehr+q0OmL3leaPX4YiIgAzDVn2pSTnp8BVT4cU3matCjArL0c4/7v70PHjRq9ne6d2DCps2W2u1HGde1fVgKIS48YTd+wdF8MIU2EcNYqjpN5GTfiEbdki8MHFWC0tLSRk9P9w+PGy8P4H/W47a2I4nQZe2gAMhM+XHu+QIBvRHjdvYfF0tv+gcL0gwf/M14gKSOnE33Lp/E5N0q5pPebDIDkyPeWns3z7XWAyldxo4TTWlqzAeCDL1UvdhoqgjR56f6qpDAaYNw2hpMjSflXW3s+AExXo5/t/E4t7ix99vR+3Mj9E/p0aQBYeeDbK/Gd5olr8veKuvo9SEkAwMHDzGy3nq+L+gBO0AEabTiAjLzylM9u6JkWEhJ/SvuHqR1uVOfP8d5Eo8kAwA47Pcf2y9Cv0s0xx47f1a7j2hk9euKZH/aZfPnZihFSoKy67bSdILP9EB5BN0IQITJk3YjX+9iPsRcOfqc2BeBFx358bluGn6+ZKS0JAFO+2Xgkwtu/hZBi1g3mCikACRocdLP2rg2k7tRuBS6sNBYr382tjpBqLzPnP0YAiEnDRzdMWRXcwFZCmvzdgo9orpvSlxvVurnlsi7sMdA/fNmbeko1+riE63wEkmIAUpeYN4pIz8+AOj8O58tRNJoIwDfXTrMKuYRHSHOAV6k7K43FynGmWlEMRTfiEVJyy/GKnDTwu7G3u9EDbe0tADBKee1m/WJCeCSozsdNX2HcKHg5N2o77sMkJPYcPHhuxIhRMPy03r/tgzSSTMMTjEWSAArKCjp3fdqFw885x5mVxmIVeXn1Pj1qu/fQ150+aV1DnCL1dm+WlR27YIGWmKTs2jOZbr4txNBQdeaMTm6UZ3ZBT1USYIQC7RjXJaA5iPAIafJzyWOz0lisQg8PqqHMq7hRnvXuA+to0iCvtnAn17ltPuYW4pOqozFRQRYkZY+dOJlKSKHD4T+2yACMmq+0yYs/RpGvO3uT0rRR/bjRM0OVOTMlALqM/ZjGYkUZGv7RdjhHXGaaFfdyXXTUp87d62PiXE9ISwCHu2f3Ouhwo0auT8wlRZlRogBzz5w2yW67dsy8j6r/tnChvZNzhW8P10619dnj6+bIAixSWXzLo+/pGp8LuhGCCI2h7Eb9zBkCouL0F5oz5PltPTNSW71AVBQAJi3e/8u18rZtqUlTmzpoFefEqeJw4v9bq7kYQExcQ/PLYEJ4xDOKdbRtmY8OBls4lXE48f+pb1AVERXty40CvtT8RFwMYNLGtQfDOZwqDqfIxcrtGIAkgISavWnbnGtx/9Pa8j4AzNP8+N94jk+ND7eJ65d+TnPMGJqICMDW005WnCoOJ/XGT79qAoiKfThnnscQdqMmH7cY3dVS/NOj3Y3CD2lvFQcApU/eP/eYw6nwdIvTXS0jR3Us7+RG/zF+/xAAxs9SOBPD4VRzuC1Bvb0P8oxiHeUPoyMhsf/2hY6e+bWOV42/WyApCiCnMFmXU+XJqeJwYs69P0sJQFzyp0M/x/brRu1tkp6e1/tFFABARJI2SodT5UN4hLioqs7r5EZ1bDOW9hIpMQBJmuwxdr4Lp4rDefzvx5/MAxCT0Nq+I4JyIwem0TIAkKTBsTtWLqWcgCZuUOuLuRGPWHod+vxTcVH+PqzieJZwdI8qyI0AUakF37GuOtYRwiO2V3Q2SYoDDBs/V/NMJodTyeGkn9GcNJ6aBK6fOUPU1GaJ9TJnCABISR8NuEENKNDDdVHB4RjL0aREAOB769N2eRxOnvGxPaunQSc34hFuNTkn/97IHq4dEJ0xcc7VSz1fO+GHDmiJi8JopTXbzhehGyHI4GQou1E/c83CPM0lBk9fYK7Z57fVEmhw/bN5swBARExjnWYwIbygoFJnmxtLAcQAJKRlpGnDaDRZKTFxMYDFX/92jeosHVTmate2jJiEjLT0MBpNVmqWhtKkBdP6cqNmv2s7v14MICIuJiFDow2j0YbRpGnUw/agTYp725xrWTe0dq8BAFFxMSlZ2vSPpl5KJqSR6+f1hcK4YQDiktJUqaQlJMQBlD5ed963aQi7EY8EVXi66fPbqre7Ua6V9hFNABAVE5Wi9raMpJhI21O4w42KHBh/bwMAEVERSRmanDxNN8qx29iPHRsqYNmdbj/tdn1/Pd2p0zR5QYEZ18/qLgAQERGRpA4uTUZKVFQUQPOImVUf3Qi6u1EOU+/MAgCAEZK0Yzqc+p7ciBcUmGdzTf+jNoWSbducmJgowOqfLpi2jbRe6c5ktbXZlqRJ04bRDjhfZFe9qBsFllud1dVU7rwPh9EkJUVERGCB/tnreYFU/8qgPPvjJ7cCiIiIiktSJZGVFBdp29f9zDWba/Djqh7nmgWQAtC3sitv20oP10Ucl/NAlyYjBwAS0pLSsjSarJSkhJhoVzciLYQbdVZx/Pjnrh1QWq58Ponb87VTYfXPSU1lEBH9cNYcd3QjBBmcDGk3IqQ1KLCB45rsyPpXXr7zqMPrNDVdWOwCF7+XHRfbL/fy/k2LxgMAjbZo5zpmDiEtgdwKZ5vgo2oyIzp6hm3ZsYPj4lHa3pWsJZBb5mzldlSaNoL6fMMZbZO7lzd+u6ovN+IR/yIPF5cdO9Z1+gqjpKX/tbJK9uY2tetdc4CH/x7+MnLKilohhPAIqXN3eqy7YXanYZfVVqxgObsU+FF/OGTdiDQF+MUfWy5LHa92N2oO8Eo11z62oet+Zv0xaboCgOwRxskU6lByOTGnj+9qW0qMBms9WW6PemlHXOPN8jgIIAEAC24Y2pZ1NfJmf99Cm/9sfljQ+QF/6PjxEHdOVUAfX6q7G5U66RnuBgAYQ6PdcOE0BpEe3IiQZq5/KcvU4+BHINHxm2GXtnagm1dF++ZaAv0zrfnvpwBA9bqeWdGLuhFpDfAtc3cOPM7fPwBAvddmV3ZMdENauJxMm+Nnvmn7XBLgtKGhx4npytN62Ifd0uLnlc92YmlqqnXRohET1I7G2NhVcDuG7ejpugiq83Hk/imv0C5XW3bs4LAMdLTVASTm01W8+N/O1ynT6cTchdM6NjF7xebTznlt7wp7uHZaA3xDj/6yBUBy5KSVOw0E6LCGboQgQuOdcyO/fDfHCCbzsYV1vteL3nRaCSm2sIhhMiPak+LURxPsF9pWs49rqp1lBJMZwbRJtmvrLNMaFNTg6RBldoO/oTQ2u1tXuNagwGrPG1Fm1AJOBW7+GW391NrarrYE+le4MyNMmRFM22KfjgdJNZud0ukrxNy4URwY2K0tbadlzJ5YdExF3uTtFGdtzv/bJBarsuOvglqIZ7SFWQST+czJs9a/393yAhl0bsRJZtlEMJmJdk5lPh3/3uV43XQq8fanHqhN/m65Tt32s9dja4sIJjPDzY3fpL3O0zOjbZeaRjHtyvy5td7WsdbMCKZ1Ftuzczuh3o5pR0m4/hWuthGdjm+2p2fvLY2oeOfbWT9mMiMc2Pm+hEdIc4BnAbv7uVFmZxfHZEZYOeR0arPcGsitcbeLMDXlb67z92o7Z/z98zrKY1Pg6dNEfNKc7LqdP53OZ2qZjjV02j/MCCYzwrWjP0THddRe5ggmM4rJLPD3r+llH/aYSienpM6buGH2yMGzKSio22I9Xhd1XhaPLDpfp23Xe5y1dVeh8Y63s+7YhA0rjdPPtVPr5pbGZEaYWcQ5egkwWhi6EYIIjXfOjd7i1HLs7p5v7yx93qWg/Q4bcUjrS/ke+zy/tRl0boTBDPqgGyGI0EA3Gjxp9HeMMlRfzq+ZX902aqXGtGkTAOZ8vIJp4dLvD+W3I+hGGIygQTdCEKGBbjSY4lfpZeb+009fUQ06O1BeMX+rxcWLWW+8AMIKuhEGI2jQjRBEaKAbDbbU+/vf27GDoaV1rCO6HnrOlW9+08ILuhEGI2jQjRBEaKAbYQYg6EYYjKBBN0IQoYFuhBmAoBthMIIG3QhBhAa6EWYAgm6EwQgadCMEERroRpgBCLoRBiNo0I0QRGigG2EGIOhGGIygQTdCEKGBboQZgKAbYTCCBt0IQYQGuhFmAIJuhMEIGnQjBBEa6EaYAQi6EQYjaNCNEERooBthBiDoRhiMoEE3QhChgW6EGYCgG2EwggbdCEGEBroRZgCCboTBCBp0IwQRGuhGmAEIuhEGI2jQjRBEaKAbYQYg6EYYjKBBN0IQofF2uFFWFu/JE8y7k8rK13tydaelhRcXN/BfE4N5jWloeLNXDQW6EYLw3hY3QhAEQYQAuhGC8NCNEARBED7oRgjCQzdCEARB+KAbIQgP3QhBEAThg26EIDx0IwRBEIQPuhGC8NCNEARBED7oRgjCQzdCEARB+KAbIQgP3QhBEAThg26EIDx0IwRBEIQPuhGC8NCNEARBED7oRgjCQzdCEARB+KAbIQgP3QhBEAThg26EIDx0IwR592lp4bW0DHQhkLcDdCME4QnVjWL9f9BbnVeSicFghJfizOK0pOK0pLzigS4J5m1IWl7SZ0dmnPsX3QgZ0gjPjSIT736lM0/jqNJnR2Z8dmSG+m/T1x6etubXqWt+nbL6FwwG80aifmCSrqqcrqqc+oFJA14YzFuRzw6/r/fvWXQjZCgjPDdqbmmura+uqCorKMp7lp4S/TDSn+vn5OxoYWV2zfjq5Sv6/16+iMFgXm+Y2nvclJXclJWY2nsGvDCYtySXrlwx6OZGT58+RTdChg7CcyMej9fa2trU1FRZWZmbm5uQkBAcHOzh4WFvb29mZmZsbGyIIMhr5dqVK05r1nBlZLgyMk6rVxteuUL9+9WrVwe2YMjg5/r16xYWFo6OjhwOJywsLDk5ubCwsKamprm5WTjPCwQZQAbAjaqqqvLz858+fRoaGurj43P79m0bGxtzc/MbCIK8VmyPHfOm04mICBER8abTbx49ymQyTUxMTExMmO2YmpoOdDGRwYilpaWdnZ2Li0tAQEBUVNSzZ8+KiorQjZAhwgC4UXV1dVFR0bNnz6KjowkhXl5ebDbb0dHRAUGQ14itref69dwRIwgAAeCOGOH++ec3LS2trKwsLS2trKxu3rxpY2NjZ2dnb28vzHI5nTvHPnCAfeDA7f/9T5jbRQTi1q1bLi4uPj4+9+7de/LkSWZmZklJSW1tLboRMhQQqhvxeLzm5uba2trS0tLs7OyEhISIiIi7d+/6+/v7+Ph4I3xcXLy9vAa6EMjbDefSJe7s2URUlHIjIirqP3Omy9mzjo6OLBbL0dHx9u3bLi4u7u7unp6ewiyY708/BUydGjB1qt8XXwhzu4hA+Pj4cLnce/fuRUdHP336NC8vr7y8vL6+vgXHg0CGAMJ2o5aWloaGhqqqqqKiooyMjKSkpMePH0dFRYWHh4eFhT0Y9ITcuHHPwOCegcF9NvtNbYOQOwcPhvr6vqn1I0OBkJC7Wlpk9Og2MQIgAEEjR/pt2ODu4uLq6uru7u7t7R0QEHDnzp2QkJDQ0FChFe3et99S5bm7bFloO/fv3+f/t9BKgvRGWFhYREREdHR0bGxscnJydnZ2SUlJdXV1Y2Nja2ur0J4XCDJQCNuNqNdqdXV1lZWVRUVFubm5GRkZz549S0lJSX4bCN+3pNAAACAASURBVNu+PURVNURV9dHVq8nJyU878VrW/zQ29vHNm8Hvvffw+vWkR49eyzqRIcgTF5eQDz4gYmKd3YiIiQW9/76vkZG3t7evr29gYGBoaGh0dHRcXFxiYuLrOof7JfLHH6nyhK5cmZiYmJCQEB8fHxcXFx8fn5CQkJiYmJSUJLTCIL2RkpKSlpaWmZmZl5dXUlJSVVVVX1/f3NyMboQMBQbAjVpaWhobG+vr66uqqsrLy0tKSoqLiwvfEsLmz6du6/F//VVQUFBQUJDfTkE7L7/2goLcuLjozZvviItHffllVnh4QafVvurKkSFDQV7e4wMHgrtWGrVFTo67ZYu3p6e/v//du3ejoqISEhLS09Nzc3Pz8/OFU7wnBw5QhYlYsyY7OzszMzMtLe3Zs2dpaWkZGRnZ2dl5eXl4qg84RUVFxcXFpaWlFRUVNTU19fX1TU1NLS0t6EbIUEDYbsRr16Pm5mbKkOrq6mpra2veEiIWLqRu68l//11RUVFeXl5eXl5WVlZeXl5RUVFZWVlVVVVdXf1yK68qKcnjcILl5IiISPCIEZkODuV5eZWVlRUVFdTKX3H9yFCguqqq+OHDsJkz73SrNGpvdRT43ntepqYcb29CSFRU1NOnT3Nzc0tLSysrK4VzaiX++itVmCh19cLCwry8vMzMzIyMjMzMzNzc3MLCwrKyMqEVBumD2trauro6yoqam5tRjJChwwC4EY/Ha22npZ3mt4TIRYuo2/ozPb3a2tqqqirKkKhbeV1dXUNDA3UfEZimppq0tMR9+/iPsdgdO0pjYmpqaqqrq6nnxCutHxkaNFZXp544ESwn14MYUa2OZGQ4W7e6374dEBAQHh5ONbOtqKioq6trbGwUQgmTjxyhShL92WclJSW5ubnp6elpaWlU9VVxcXFlZSX/eYwMIPz7M/+OLeQnBYIMFAPjRm8vUSoqfDeqrq7mvxOkfnbX1tZS1c4vseaWhoayoKCQTu9BgkeOzLKxKS8spGqnKisra2pqGhoamvGVP9ILrc3NdenpD6ZM6bnSqL3qiCsvz75+3dvT8969e3FxcVlZWWVlZUJrTZJ67Bi/3qioqCgzM/Pp06dUg6eMjIzCwsKqqqqGhgbsD4UgyECBbiQYfDdK/vvvsrKygoKC7OzsrKysnJwc/u/dl3vA1KakJP/yS7fH2KPt2zMJyc3N5b9roPQIHxtIjzSVl6efPXtXUrJXMaKqjsTFXb/+2sXWNiAgIDIyMiUlpbCwUGi9kPhuFLl2bV5eXmpq6pMnTx4+fPj48eOUlJTc3Nzy8nI8yREEGUDQjQSD70ZJZ84UFhZmZGQkJyc/ffo0NTU1JyentLS0pqamqalJ0AdMa3NzCYdzX1Gx2zMsePToJ1euJCcmJicnp6en5+XllZWVUcOvYdUR0p2WltqUlNBJk4iISN9uREREuKNH3/7vP08PD6rqKDs7m6o6EkKbks5ulJ2dnZSUFB0dTfUYT0xM5FdioRshCDJQoBsJBt+NEk6dysnJSU5OfvLkyePHj+Pi4tLT0/lzMQr6dKl9+jT511/v8Ifp6/T6I3TTpshbt2JiYuLi4p49e5afn19ZWdnY2IhPDqQbjUVFmRcu9PU2reup5aql5WJlJfyqI74bRaxZk5WVRY0B++DBg4iIiPj4+MzMzNLSUnQjBEEGEHQjweC7Ufxff2VmZiYkJERHR0dFRT169CglJSUvL48SF4GeLq3NzUXOzg+mT+/xGXZHUfEOgxFMSFhYWGxsbEZGBn/kfqw6QjrTWFiYZWCQtGdP0p49iXv2xP3ww+OdO+/PmEGdSAHjx3t++qmrmhp72TL20qXsZcuctm1zZDI92quOOlfYvNFTq5sbxcfHh4eH379/Pzw8PC4ujjrD6+rq0I0QBBko0I0Eg+9GcSdPpqenx8bGRkREhIWFUcPq5+bmVlRUCOpGbZVGEhI9/74XEwtQV/c1MQkMDAwPD09MTKQMDBtkIN1oaWioS0urSUqqSUysjI8vjonJCg2N/Pxz6kTiqKjYnT9vcfq0qa4u83//M9XVtTh37qaFBZvN5nK50dHR/MlEX6LiUyA6u1FmZiblRiEhIWFhYehGCIIMBtCNBIPvRrG6umlpaU+ePAkLCwsNDY2MjExKSsrJyRHUjVqbmwtYrIgPPujj9Qd3wgTv/fu93N3v3Lnz8OHD9PR0rDpC+oCamaeioiI3NzdqyxbqLPJSU7OysmIymUZGRoaGhkZGRkwm08rKysnJydfXNywsLCkp6eUqPgUF3QhBkEEOupFg9OhG9+/fp9woOzub6mLz4o+W2pSU5J9/visl1XevIo6amuvVqz4+Pg8ePMCqI6RvWlpa6uvry8rKsrOzIzdvps4i7+XLbWxszMzMmEzm9evXmUymubm5jY2Ns7Ozn5/fgwcPEhIScnJyhDCfKLoRgiCDHHQjwXi9btTa0pJvYxO5YEG/LWf9J0xw//FHNxeXoKCgzlVHb/r1B/I20tzcXFdXV1ZWlpOTw3cjn5UrHR0dbWxsLCwszM3NLS0tbWxsHB0dPTw8AgMDIyIikpKSqP7zdXV1zc3Nb6546EYIggxy0I0E4/W6UX1mZtLevXelpft1oyBxcY6qqrOREYfDeb7qCPUI6QzlRhUVFXl5efx3agFr1ri7u9++fdve3t7Ozs7BweH27dseHh4BAQGhoaGPHz9OTU3Nz8+vqKigxuh6c8VDN0IQZJCDbiQYr9eNSv384rZuDVNWDlNWDnv//VAlpZDJkzuaGY0d66+g4DdunO+4cb7jxnnNn+989KirqytWHSF909zc3NDQUFVVVVxc/HDbtrYzSkMjKCiIw+G4urqy2WxXV1cOhxMUFBQWFvbkyZOUlJScnJySkpLq6uo3/a4W3QhBkEEOupFgvF43qoyIyL95M4fJzDExyTQ2Tv3vvzgdHb4beWzY4LRzp8P27Xbbttlt22a/a5f9iROOjo5U1RG/5Sy2OkK60dLS0tTUVFdXV1lZ+Xj7dup0Cvnii/Dw8Dt37vj4+HA4HF9f37t371JDCqWlpeXl5ZWUlFRWVtbV1b30vDcvCLoRgiCDHHQjwXjtbbF5PF5rayv1EqS0tDT9wQO+G7FOnzYzMzM2NjY0NDQ0NDQ2NjYzM7Ozs3N3d7979+6TJ0+oUfKo1iFYdYTwoc6oxsbGurq62B07qNMp7KuvYmNjw8LCgoKCuFwuIYQaT4gas7S8vJyaLJkaVhT7qSEIMpRBNxKMN+RGTU1NNTU1RUVFKffudXYjc3NzExMTIyMjIyMjExMTc3NzOzs7Nze3oKCgmJgYoQ1Ig7x1tLa2UrVH8Tt3tonI118nJyc/fPgwJCTkzp07ISEh/AFLKyoqKCuipl4X5rjY6EYIggxC0I0E4w25UWNjY1VVVWFhYWc3uv3PPzdv3jQ3Nzc1NTU1NTU3N79586ajo6Onp+edO3coN6ImLRfOFKHIW0dra2vCrl3U6RS1ZQt1xj548ODevXvUMOvp6enFxcV8vRbOWYRuhCDIIAfdqFdqEhOzr13LMjDonND33mu7raurP9LVjfjjj5Dffgv+9dfQo0dj/v47Oz39pd2ourq6qKjo2f37fDdyv3TJ0dHR1tbW2tra2tra1tbW0dHR1dXV398/NDT0yZMn6enpRUVFQps+HXkbSdy9mzqdorduzcjIiIuLCwsLCwkJCQ8P509eJmQRQTdCEGSQg27UK5UREfHbt9+fMKFz+DN73B0+PFhB4a68/J2xY++MHXt38uTI/fszU1NfYkYqyo1qampKS0szwsI6xjS6ds3Ly4vNZt+6devWrVtsNtvLy4vqcf3w4cPk5OScnJzS0tKamhp0I6Q3XsSNhDyxK7oRgiCDHHSjXmksKMi8dOmOuHi/gw8REZG7iooxtrZpqalURU5DQ0NTU9MLtt6g2hvV19dXVlbmxcTwVxtiYUEI8fHx8fDw8PDw8PHxIe0zzlI9rouLiysrK+vr67G9EdIb6EYIgiCCgm7UK63NzeXBwTFLl/bvRrKydz//PCo0NDExMTs7u6SkpKqqqra2ljKkfm/xVLNZqldRcWwsf7XRDg7h4eGEEH9/f39/f6pjUWxsbFpaWn5+fmlpKdXjWggdi5C3F3QjBEEQQUE36ouG/Pysy5f7qToSEQl67z3uhQv379+PiYl5+vRpVlZWYWFhWVkZVYH0Ih3s+Z2uK5KS+GuOY7MfP34cGhpKCCGEdBu8uLa2tr6+nupbhGKE9MbAulFLXV0Zl1vq61vSKXHt05g8WLAgydb2oZlZqKHhPQOD0KtXY8zN0x49QjdCEGRgQTfqi9ampsrIyMj58/twoyBZWb+VKz2dnAICAu7duxcdHZ2YmJienp6fn19WVkY1BnqRuzxVe1STmspf81MPj8TExMjIyHv37t27dy8yMjIxMTErK6u0tJQaDls4Pa6Rt5qBdaOmsrJnOjqPNTQerV3Lz4MpU6giBY8ZE7Z8+f1ly4IXL77z8cfBixeH7dqVSkhxcXFtbe0bnbcEQRCkD9CN+qGxqCjj/Pk7YmK9VRr5T5nCPnr01q1b1CQMhJCIiAhqSL3CwkKqPdCLP3jq0tL4K0/x8kpOTo6Ojg4NDQ0NDY2Ojk5OTs7Nza2srKQaX6MVIf0ysG7UXFWVY2QULCPT/4tpACIqGr5/f3JISEFBQVVVFVXnStk/nuoIgggTdKN+aG1qqnz8+IGSEhEVff5uHkijeaipWV+/bmVlZW9vf/v2bS8vL0JIVFTU06dP8/LyysvLX9qNUr29U1JSYmJiKDeKiYlJSUnJz8+vqqpqamp6o98aeWcYWDdqbWmpz8mJnD+f38Gzr0yYEGlllRgbSzXaq66upt4av+k5TBAEQbqBbtQPra2t9SUlKbq6d6Wln7+b+0yZYr9vH5PJNDU1tbCwsLOzc3Fx8ff3DwsLS0xMzM3NRTdCBpYBb4vd2tCQdflyyOjR/Xb2DNq2LdTL69GjR9T4FMXFxRUVFTU1NS/YaA9BEOR1gW7UD62trU0NDeVJSfffe69b1VGQpKTrsmUm//577do1Y2NjU1NTa2vr27dv+/n5hYWFUXPBVlRUCDQXLLoR8noZcDfitbY2FhVFzp/fV58GEZGgESN8rl0L9PO7f//+w4cPnz59mpmZWVBQIFCjPQRBkNcCulH/tLS01FVVJf7+e/CIEV0qjaZOtf3xR0NDw6tXr167do3JZFpbW7PZ7ICAgKioqNTU1MLCwurqaoEGH0I3Ql4vA+9GPB6Px8s4d+6+omKvHRrExTnr17Otrd3d3f38/IKDgyMjI+Pj46l5cCsqKurr67FpNoIgQgPdqH9aW1sbGxpKk5JCp00jIiJtd3MxMdeVK2/o61NuZGRkZGpqamdn5+HhERwc/OTJE/5sDAK9DkA3Ql4vg8SNarOyIhctutNToz0iIhIoK2t//ryNlZWDgwObzfb29qb6NFADhpWVlWG3NQRBhAm60QvR3NxcV1OTcPjwvTFjqBt6wPvvOx86ZHbjhrGx8bVr10xMTKysrKgXahEREcnJyVRfG0Fn80A3Ql4vg8SNmhsbU//66/6kST10aJCWdlu50szI6MaNG5aWlnZ2dmw229fX9/79+7GxsVQJ0Y0QBBEm6EYvBDWtR3FkZNjcuURUlIiJ+W/axL5xw9ramslkmpiYmJmZvXqlEQ/dCHndDBY3am4ue/w4esWK7v09RUT8x4yxOHHC+Nq169evm5qaWllZOTo6ent7h4SExMbGZmVllZWVUZfSGy0hgiAIH3SjF6WlpaW2sjLh55/vKSgEz5oVdPq0p5ubg4ODhYWFubk5vxV2t0ojQR856EbI62WQuFFLS0t9dXWyrm63qqNAGRnXTz4xunLF8OpVqv7V0tLS0dGRw+GEhoYmJCTk5uYK2qEBQRDkFUE3elFaW1sbGxsLCIlctixi794wd/eAgAA2m21nZ2djY8NisTw8PO7evfsqlUY8dCPkdTNI3IiqeS0KDY1eu7aj6khExG/8+Ju//37t2rWrV68aGhqamJhYW1s7OzsHBARERkampKS8RIcGBEGQVwTdSACam5try8rSjIyeurjEPnwYEhLi7e3t7Ozs5OTk6upK3c1fpdKIh26EvG4GiRvxqJrXiorkkydDJk5s69AwfLjXqlUW168bGxsbGhoaGRmZmZnZ29t7enreu3cPX6ghCDJQoBsJAFV1VJ6ZmZ+enpKSEh0dTQjhcDheXl5+fn7PN494iV+6Dbm50UuXRqmqRi5enH73LroR8oqk//13tKpq5JIlcQzGwLoRVXVUSEjM558TUVEiIsJVUvLQ1aUa7RkbG1OVRrdv3/b39+f/zKiurha0QwOCIMgrgm4kAK2trc3NzXV1dWVlZdnZ2QkJCREREcHBwXfu3AkJCXn48CE1ptFLVxrxeLzmmpoiF5cCZ+csB4ecpKSUlJSHDx8+ePDgwYMHDx8+5LsR/oxGXpDKqKhCNjv31q3swMDMzMz4+Pjw8PD79++Hh4cnJCRQKi8cN+JRVUdlZcmnT4coKt4ZMYJ8+aXX7dsODg7m5uampqbm5ub29vZUh4ZX/5mBIAjy0qAbCQZVdVRdXV1UVJSenh4fHx8TExMVFfXo0aOnT5/m5OS8lrt5c3NzdXV1QUFBamrqo0ePwsPDw8PDHz16lJqaSv2SRjdCXpyWlpb6+vrS0tLMzExK6B88eBAZGckfPaihoUE48kFVHRVwuQ+//DJkwYIHBgZcLpfNZtvY2FhZWdnY2Dg7O1OVRikpKVhphCDIQIFuJBhU1VF9fX1FRUV+fn56enpycnJSUlJqamp2dnZxcTF1N3/FX+GUGxUWFqalpcXGxkZFRUVFRcXGxqalpVFNU9GNkBeHciOqsvP/7Z1nXFNJF8avSlVX17W7vgoqKvbeC/aGXdeuuK51sRcsa107uipFqYKo9B4gJJSQDumNQOidEEhITwgl74eQGBEQFBD1Pr/ny5rJzLmzCfefM+fOcDgcKpVKIpGoVKqG5oVCYUeyUU1NjVwgyHV0pNnasggEHA4XExMTFBTk5+cXFBQUHR39aaURyEagQIHqYLULG1VV1ypVP6wVVTUSuVIgkpRVCIpKyvIKinPyC/OLSkrLKioEIpFELlOoFF83hEyhqhRJi7m8rJx8BiuNRKGTKHQGKy0rJ7+Yy6sUSWUK1Tefh5a6ulZVA97bvqVqa2urqqpEIlFpaWl2djaLxaLT6SwWKycnh8vlisXiDmMjtTZ1JCosLGEwsrOzqVQqAoGIioqKiIiIiopKTEwkk8lg0ggUKFDfVu3CRuQcMY4j/FGNTa/EpAlQqeVJDG4CtTiOXAAn5cdTChNpJUhmGSaNj02v/MohMGx+EqMMTiqIwmWEJjKC4ihBcZTQREYULgNOKkhilGHY/G8+Dy10SqYoo0TWth+wjlNt7Q/g2urqKoVCIhKVl5UV5Odncjic9PRMTkZhfn4FjycRi6uUytrqmo4Jpq6mpkalUsrlQoGguLAwjc0mJCcjEhPj4XBEQmIKHs9msQoLCir5fIVMVqNS1dV0UGDta1CgQH1XAtnoS4xNr8Sk8dHsCiSLh6BzEXRuEqMMlVqOSeNj0gRf3z8mTYBi8RKoxTBCbjQ2IxLFjkSxo7EZMEJuArUYxeK1ySgdZnqeuLq6ukar2traurq6zp8PqFOpqpipyu/fCgZLSmMISRQePqUIhclNQGTHJ+YmIIrRWF4yQUiiyGgMBYPVofFQ6QICqRiNzYDHU8MjcQFBaF9/XEAQJTySA4srQmH4BJKESu/IqNrPqsysOqXyW3+cQYEC1QqBbPSF1mSPMGw+ml2BZldg2HxMmuDrM0Z6nfOTmGUJ1GI4KT82JSc2JQdOyk+gFie1UWqqI03NEUkkEqlUKpPJ5HK5UqnUoFIn3+m4rqpKSWf+AFbQGHIqXUKmCghEHi65FIUpQWFKUZhyfHIlgSQhU+VUuoLG6Mh4ZFS6iEQpxyUXIJAcKIweAaGGRdAjItOhsfmJSTwsXkQkyzo2qnY0g1UtkXz626Dz/zwABeqnFchGX2VseqXObdszJk2AZlcgmWUIemkCrSSBVoKglyKZZWh2xfeVNMJxhOQsAZfLLSsr4/F4fD5fJBLJZLKqqqrq6urOjEc/DBspNThCoYlJlEoCiZ9M4CcTBClEIYEkIVO/CYIoaAwpmSpIIZZh8YVJyOy4hAxYXHZcQgECycXgBClECZn6g4ARnamkM2V8vkwm0/02UKlUOkj61h9zUKBANSKQjTqpNXkpNLsCnVqBSi1HpZajUys0YPR9JY1wHCGBU87hcDIyMrKzswsKCrhcrkAgkEqlmkOyOu3t4QdjIzmVLqPQpBSahEwVk6kSMlVKocmodDmV/q3iEZOpghQiD5dcgsYWI9ElKAwPixekEMUkyo+TNKIzlXRmRVERj8crLy/n8/lCoVAqlWqyp5358w8K1M8skI06r7UZKQEmTYBJE2DTBe2RoOoIp5ZisVg8Hk8ikZhMZlZWVklJSWVlpVwu78znZP1IbKSkMxU0hsZyGkNOpcu1//kN45FR6RIyVUgk81OIFfgUfgpRSCRLyFQZhfYjgZGSzsxLT8/MzMzOzs7Pzy8pKamoqBCLxUqlEtyhABSozimQjUC3u1H0oqioKCgUGh8fj8FgNBuIl5WVaZ4e77TLaj8YG3VCa7JHDVJZHVz81DGmp6Ro9ttkMBgcDqewsFC3FxrIRqBAdUKBbAS63Y2g5L9//z4gICA8PBwOh+NwODabrdl1sMNOq/gCgWzUAa5PZVHpGn/bVFb7GRUXp/ltgEajyWQyh8MpKSkRCoUKhaLTfv5BgfqZBbIR6HZ3AinHzc3t9evXvr6+kZGRSUlJdDo9Pz9fIBB05nsDyEYdZsW3XuBrb8eEhQUEBISGhkKhUBQKRafT8/Ly+Hy+XC4H97gHBaoTCmQj0O3ueGK2o6Oji4uLl5eX5pR1CoWSm5vL5/NBNgL9Mzjkva+np+e7d+9CQ0Pj4uKIRGJWVhaPx5PJZCAbgQLVCQWyEeh2dxwh6/nz505OTp6engEBATAYjEQi5eTkVFRUdObfzSAbgW4r+3t7v3r1ytPT09/fPyYmBo/HZ2RkcLlc8GxEUKA6p0A2At3uBtkI9E/u956vHR0d3dzc3r9/D4FAsFhseno6l8uVSCTV1dXf+pMOChSohgLZCHS7G2Qj0D+5QTYCBer7EshGoNvdIBuB/skNshEoUN+XQDYC3e4G2Qj0T26QjUCB+r4EshHodjfIRqB/coNsBArU9yWQjUC3u0E2Av2TG2QjUKC+L4FsBLrdDbIR6J/cIBuBAvV9CWQj0O1ukI1A/+QG2QgUqO9LHcRGaGpGUGjQtXsOTdotygVZ/M3v4h/FzOYjWTwcR4jjVGLZheG+r+48RgQll6LabUQsqygmNqK5WXL0t48raKPhBGhGdrCP840H6HBqObo9ZxJkI9A/uUE2AgXq+1IHsVESBvHo6g6zpmW+wfbA+7RvhUENzS6MiklyeB3jFJ+twQgMk+V0fPyUcfceR2XHt9u4aDL77fO/mpulRVuWvaK10XAVCALuqc2YMRb/OaOKEO05nyAbgf7JDbIRKFDflzqUjSwsJy7asH/zjka8xc7xRnTON4OhBqaRX14/s3KVzVYvFo4jxHEEmNSst48P79v/3gNR2H4YoWEj8xEj563ds+GPxmbJ9vaJwIw2Go6PpDJe3z30x+6gtylcZHvO5zdgo7o6ZVGRsqCgrqrqy/v4ajaSEpJyI5xCXdwj4SmyBgepUgjFkSHoN/6YJGJru5WQqdpjWWn8xFCSjy82EFPZjrd2QtH7d4h3EUwkUdaaNypoDAmZ2kYxMBQUXPbLV1GOTqGOTqEhsKzktuq5IwyyEShQ35c6lI2mLVp7F/ZNoaeFbshGHWQNG40aM84utCSB9a0noe3c8WxUp1KVenrm3bkjRCKVRUW1SuWXdPLVbFQBc3p3GAB+6dfjxJvcFLpc/9XkKNjxbSumLF37Ct4KPiDhsv0D4RFx5UQNGSQzHXYemj5v/QavjHa8tcdELZoxd57NdQ8Yv4VvoVGFqERWQEgiFNkmMSioBB703g1T494AAADAr/tuvI3Ct9v1tr1BNgIF6vtSJ2OjdD6Knh+B5kRSy7Haf8SyimOTM6CkImSa9l/SypPI7AiU1ilFiFQB9qOuKjGs0rgPDUqS2LoGlWhGIRyfFZPC1SuyKU/EcqI0/bDL4lCJD84eWbJsp/WzhChcZmKqEJfOTyKmQdCFCNaHgTCsoniCdoiPY8ZxBChabiwhD07jJlHzoSh2BIodieHAGA3i/FI20sRDKEliceOTs6JQ7AgUOzolPzG18uOW5YlYjubVCEJhArMsiZwXg8+JZVRophFBSItEFyWxK7EcAZKaDSXkx9O5CHJeDIodgWJDsJlwpqBhkMw8WLL2qjGZ0WQepvOxUW1VVd69e5hff8UNGJBx4oQQhVJVVLSWkNqMjYDuxqY7XoWl8Cl6qaMvYCMqSQx1vGBq3Ou0Ky6JpKQzlXRCuuvRS6vWHzrgm9OOt/bWsxExkfrAdueQUcMfQdokBjEOirzYpbtR74EDBw8bMuTQZQcigtxu19v27ixsVFdXI5XWSCR1tbVt0l+1rKS0ODc3NzeXJxAo9b7IdbV1SnF+Xl5ubi5PLFfV1LUyzhpVlUIk082MSlpYUJibm1tWKVK2tq9Wq1YhLC4qyM3NLRdKqpqcJ5WspLg4NzeXK6hUVNep1bUqiZifm5tbWFAoVbVXaDVKQTkvNze3iMttJjRQbaFOxkZUtq/rzdFTZo67h4tnCXAcIS5dEBvyYsfmJdsuOnvhhDhOJZZdEZeU+OziCF0VzoitT++Fpcfr0Q+WnRcZ4m07or7NiJ0uDvG5iDQNN5SEvnt4bJ31mp1hwVqOfprQhwAAIABJREFUwXEId+fOnvGH4+OY7CRUzN9/bdN1Pm3R2ruwT+uNKjEsXmTI09P7zOvbTZhheQ8FJfMw6ZpRCt8/O7b9oO2f9gHP7l1abW5uZmY2ZvLs/Z6p8cwm8ajFbKSNx8bFISTg/Oa1M83NzczM5u04dysiB52mxaP0ciQddWvOrGmaWqV9d+3exzhcPaXNhzWoN8p/c3+39UG7084BDy/bLjc3NzMzmzB3xRGfdCRbx1uVGGZZsJftLuv6qzafvmaxHTSSXtEM8H1bNkoCgCQAwPbtm2Zjw0cgVFJpdVVVbW1tXd3n/8C2ERt16dLFwLC7CXDhLRtLUehebRs26hh/czaiCVGBIbuMTEyvRUNThB134W3mTsJGdSoV18en2MVFWVBQW1Wl/mpCyg6bsXgSAAAAsPnsOUxxre5bpRJLCE49uxsDALDHCZ5a3pql7boalSiHSIx/HJatVqvV6lq1mu1nNmQ4AACb/nUgFMu+MujPiY++O2X0QAAADt71YlQ01YoTNmP8JAAAVl24hciTqtWVHC/nkwAADB9i5sdWq9sHXIqSL9hsBwBg/MoVHhRBuwwBql6djI3SKxNx6GeXJoyZdPkZkpeUJsSREDd2bpprc/9qeAYmXYjjFES8dz9paWkxSq9EeaTF6LGX7FyosZpOmBx/t8fbx4790GTk6DG7Xz2NzUlqMzZK97p6fsfY0aNG6sqkzc0tJlqOc3iFLk7SstE2K4uRFmMsLEaN0LYZPWHqfs9UGKNhMubL2GjS+NGjx4wZNWKEBlXMR46at/3kTUghjiPEpXGRyJAj06ZMMDc3186SxZpNVqvXN8NG6+ZbjBo9xmJUfcDm5iPGz1p85H2uFo8YTvv3rBozaqSOS81HjLBYNNfKx58jbAaPvjkbJXXpgjQ0xA4cyNy+vQwGq6qqUqlUNTU1tc3eG9qIjX77pceGv7YbGnbf+yYAW07RvgqyUStME6ICQ/YZm+xywKNI0o678DZzZ2Gjqqr8+/dxAwemjByZe+uWPDv7Kzv8wEYGS/44FcUWa1/4CjaS56NeXd3YfdaKOSAbNRTIRh2nDmWjEaMsJk6fN3N2Q8+ac+DQtchAmhDHEWJZuVHBz7eOnjbNNsKPlOF1b8fauSdt/8OGswQ4jjAuMeju6SkzZi+1eYnXran5ul1btWTRhCMO/8bm4TjCuISAf09NmlrfJjUChXt0bNaM6ZMP/xcbQm4BGzWyptaQjaKC//lr67gx83dtuQ3xQ7EjUMzg6IibO0dYjJw05Q7Mn1BWz0aLzM21bUJjEY539pqNHGN5NMyXWNboM/P1tdjm5uOnzZ3xySzNnLNt21/ePmQ9NhprZr7x7vW32GAUO9DP5di+FSMX7Nxmj4/jCFG09LePpk+yMB9x6o0ThBqBYkeEvv3TZusoCwuLlQeaZKO55uZWh/c+gvqj2CGQqEdX/jC3nD7lTGwEi4/hCMO89m5eOmbFkQcPgiiamQ+BRD26smvkpKVznagIduPA1ynYSOOuXVHdu+OHD6dv3FgcGiqXy3WE1GgaqY3YqO+Afn8GeNz+y6SP2d7/4uNTJJpXG2EjhpIeHTp10rwhQ4bXe9XRI+7MZA1tYLK9rg0b+FvvLl269uo7eNDgf+55pON0a2puWPf7D8fPmnPZr5TOVOjFkP/O5qz1zrMng/LpTCWdKUKFJFzT9T9k+J77QRCM6DMX0oCNyKUQB8+/Z8259KYA7n53hPn4IUOG669zoSP9Lu8f0qdXj24GBn0GWJiP9Awi8Mn68WhHn7Z09a2gMr2xeIG3dy+9/fzJO9hJm6NDhgwfMmTl/AUPz58fNqj/gJ5duvT8bfCgwcM+xIxi3Dh17sN0WYwecTYGThFR9YPXa9PY/CjpzKLAU3d2aDtpos2PwUa67wWyWzdM797EiROzL18WUamab0EL86n6+sBGgEmPdSdO4UvrX/hiNpLl4J6c3dzbFJi0eEaYDt06dE2tZWzUcE2tQ9gIXFPrOHWKZ/jNzddtPxnwnqJJHfFRJMbrO/vGTFt89bHzqmXz19i6vYQXojlCHKcgxOPZkdVrFt+NglD5H5CClun+dMca632HHyaEMQpCPJ4dsVq24NR7//o2FQlBj63mT9943f8Nlvd5NuI09pzaR2yU4XH+0IbxWzefCPQmcDH1q3iFsXBvW8ux42f89zw2N1GzprZ42dq/3F6iuBiOEJtWBI19e9hirIVNwFsCtxk2anqWFi7b6uxJ1I9nx/GXyaGUCixHiGHS3G6d3zBvx4b7aBiHl4iF35wzZvS2p4/g2QkaamEVhfi7HNy51LxpNrKet3rrWT8PTBmGI8Syc8ODXGzGTbc8Dglj8jEc1osdKxbb3LwWxKhf7uQIsWwuNC7i+omJYxfef4Up1xWEdVI20hFSjx74UaNo69cX+vpK+fymCKmt2GjgoBMxMBTx+qYhZhb3nELzUhpjIwqxMuzJgqmW5oYGRoBO3fv8NmzH3hOoBKaSgOK4nAH0dOKqEwujq8X2IEY8c9/Wf5ClHRLDlNF0MSBQ+5evWbb75Eu4hJ6c7/30xZgRFgP1euk92Hzk6VeO8LLmLqQhGxWFPXy+wcio//CJFsMGdu3STVMfPWDogXOPcQlkJTLE/eQm3QjGJt2f+6ZUkJlKejxq77bdZr/27al9zcjUdNCsZYtd0+lMTaE6993F5RMvHd69cveSX/sAADB00uLD/wT8e0T/woG117zDUMKkwCfHt1sO7Nv3wwtdu3btN9JinNvbRC6RqaQzlSnQ+DP7d+naGBgZDZ8y+4p/LllXF49IPn7gL/O+A3tp+zAwMhowcdY0J2oKrQ0TVJ2NjTTfBaSBAbZfP9KMGRlnz/IxmKqqqurqag0ktbBDPTYCgF4L152EpEvUavVXsJGUg7h1ZBUAfMxGHaqWsVFDdQgbgeo4dSgbTZy56OiTSGefT414B8uMZ9c3xqZxE5L8DluOtZq/aIz1Zbt3pBhNRTCF7HD33HTLyeOWbWvwcPvaldMnT5j8x0WPN2i2z9ObmxduXvqM8GGTRlq6VxDsTUIGnCloAzaiJz/6c7fV6gvH3BlJH66xEsPKdD81fur4U7cC02NTNWy0e895aGj9dXETUBA7C8vRn2OjkRZj9t0N+s/r01mK84pIhafqx3PtfnhmXD2RZLy7f323ho1YedHBDgtGW659hI+kfSgGQqeg7C8dnt9MvdG8P4/+i4yoD7gIGuV7ZtyMejZCB+9YMn/szGWLN+zSn/mNWzYvmz/SYqzVdUhpQuoXspGyqKjI0ZFpbd1WZqxdSxgzBmlo2AgbaVfZUN27p4wfz9ixo8DHR1xYWFVV1YCQ2o6NbGOTaJVJrtcG9Z2772FkDF7SkI3oYiwEcWaMqaHV6UuP379wCnV0CnV0en1+2capQJ+ZK4+/QSqplEpERODto1uMDLtvsLV/8IwCTeKTPzynloYKi7+1/tf+Ux/5JUuo2qLvJJ8rK2Zu2HkqMIbMj3vld8Ji+oChu8481vQf6uj09sKWKWaTRh+48xaa3Do2WgsAJr1MVpxyfeYQUt9P334rjj17jxCSkrPCPB0OWC/6bfCAgzfCnV9xMDQpjZn3dpvNxN5Llm2/c/uZZvTAB//c+mOBSd85K93iKikMLRvNGjpo9u49p52fOIV6vkfFJBXFh/s/sruyxNBoydEnj54FB8By8Lh0lz/3zJw5b+HRF/b11xL05M7j7YCxATDmmg8VTVHSmSWBtheX9p85ddG5q09DHV+8v3Py9EIjk5EzfSOIlRSmks4s9D90am7fxfPXXbn+n6aTYPt/n+xf1M144rznkHwC7cdmow+ENHAgecECzpkzZQkJCoWi5YT0ERsBvfsvO34+hadWN81GyrIMiOdda502Wlu7JGZJZDVqtVpdwXz27KrV3NHD+gMA0Ktv7xlLrXft3xafr6jJR/65/09ra+u7/pAMPpfj6fnA2tr6xPnrsHoU00icGn7yyCFr6xueEEaZ5sGLKlEBIurJh/GsHRKp5bLmZ7xlbFSMP3PC1tra+oanL6NM8REb+bJUZdQ3W/f+oRnSJSC+WKR9m5xHQL21trb+Y8tWr+SynDib/X9aW1tbWz8PiM8VfWZ+1OoKjuezB9bW1ieuX4dlay+9Tq0WpfrbHNmrfdNlx5cpRXK9WOtqVSL6GxttQI22AdVAnaze6EM9TbrLkfGTx5qNOOr1Ij6//kmoFNzD68eaSquYmZltOevgmch8/fjaOqutTe+R+NVsREbftdmxYNd12+CPthrCpJb4PZ4wbdJf13zZUJaGjWz2XUyI4LSOjVpRi/3RXpR6bMTIjvC5N3K05S431ke1TR9dV6NsdPzEfVwUpzE2gnktXTS7qZlvPubPspGMw+EcPtwkx7SnUd27p0yezNq/vzQmRioQ6BNSW7IRkiGj4cinrMdOnmd773UqhvoxGzFkJEzWu/uv775no8gSbdanMsr+5h8TAF1uqZF6I71n+Mlojsf1nb36T7scVFCfFyFmOu9bP2n54b9d2ISUTKdLV+aajT18W/8JL3FSuM+ZaVMWrD97Jyif2Co26tmr7zo7T0Q5haGgM8VJrx/PGT9S16aReiNE3KbR01euv+YYkI+vZw45EZfhe+/sut7dZ9/CIKgSmoaNho5f8KerG5ynq83S1Rvtc9TWG1G5MV5wh1fwt3Fc7WqdnIDOdrbuYWwA1M8POtl21YaZM7defEHDUJV0ugQDQd9YaWRiaueKKCMylHQkymaO1bLlf9u/ycJpQyITCkMdrm0wMpp6KSoquZLa1Jz8OGxUT0jdumH69SMvXpx+7hw3NlYuFKpUqvovQtMLbVo2mmhltd3KaiYwYO7iszHZsibYSJgNff/IevaEYXqpPgCwXLj+FZTJF1eri5JsbFZ+lCIE+g7p6c2SqFj69Ub8rIB/j80EgF+nLjkBK/wQjJThvtXyf78A0w49iGbyq9VqCRcd5rFp0ZwReh1aLFy53R9Oq2imaOnr6o16du+5aOO+bSsnGpgaaoa0nLbghkt4WqlSrVarxfmQgH8AADDsZjBh6bYNC3p07wkAwLQtt8KJ3LLPzE9j9UY1Ncoc9NH926f26GWqfdPA0WOXXX/inq6JvUZRnhO3b7/1xB7agD5tA+pTdUo2Sq9AE7C3to+bMNpsxMqbtwPZcewPbDRu5uL1to8aPVLjRSAWkgyyUTuy0ezNxw9f+e/Tmb/+8KUPrgL1pWtq35CNkgAAPWIEycYmJyamorRULBbL5fJ6QlIqFQ02bPxyNmLKaExhnMfNDcOsrE57eSIEzddiYyBv71w988e6hePNWspGdAov2v310t6m064jk6hiGlNJiArdNX3mfJvrDjBBMjTabt+UPoMGLtl65oCNvg+tGDpywJDdf90noFrFRgMHDf4HS2DKGm3zKRsleR4fM6zf2DkrN+/SH/3kDust0wxNTKd5hhIFlHo22nr0JiZBP2fzKRt9bCIuK+jVmX17/l4329CgWz0bESJD1i2ct3C3rQdcrGlGIfKgvo8vXYZG4YUUhhLlc3XOhCGjpi3csFM/pFO7t+2a3dWg29jnXomlpPZlI1F5OQ8Cybazy75woQOcdfYsdcEClLFxk1+Hrl3Rv/5KXrKEc/lyaXS0lMvVrDg3RUhaNlp15IK303NbqzF9B889bkeqaIyNlDyCs92O0cDA0aO3n71jb//4wZ2rB+cbGXYDgIkXfcm5ohpJIRT63u74yjljAAAYPGKozRV7p1cvWDxVbepHtdhSTuTtIzMBoP+sFbYYzc29Tq2Wsr2txw3rDkywvRfBqahWS0ugQdcXTAUGDxpqY2dvb2//2N7+4t4+vfoAc5Y/jUXzmkyafB0bAQDQw9B4x+l7jx7Z29tfsbEcMRgAzCbt/c+DxlN+YCMAAAwAYPPhq/ce2Nvbh+MppRUln5ufT9moRlmeh9i7wdTQFFi79/Stu/b29vbXTy2eOQkwG7Xu32ccgVqtknOJwcsAk24AMHvXkX/uPrS3v3thz7xJQwHAbP7mB3FFija45f+I6oRsJEDT0wOcT60a+8euE8c3TN+yyy7IHVmM5ghxZJLDv2cWLtq65yU9qam3p6a/e3Zn+/xNSx/j9drkBb3yeeie5IstRjfKRoyky3NmTm0hGzGITw/tWWZ15ogjOeEjXkl1OjB+iuX5O8EcGPubslFqQUyE25rRlktvIcMoH3ZdQuES7p87MPPL2AgZuGPJfKujr57D8lt7+Npn2UjF4/GCgrLOn886fz7z3DnOmTNpp06l2toyT5xgHD9OP3astaYdPpwyaxbSyKg5KurSJeF//0tYvhxtZ0eJiOCwWPn5+VwuVyAQSCQSpVKpksnkNMbX4FEDNlLSiZkOOxaPWXrkvCs9PvxjNqLLyQiKnd3zc+cfnjv/8PDW6aOG1P/CaykbMSXYKOyducYm8/7zxVSQGaLo52dnjF6y77JfNKFBDdCn2nrgPDqxVWw0ZMiQxzRtndDn2Sjy8bSRQ5oaXVeTpGGj/SfvkpD6ATTKRil5nq9CNNN18oit9ZwP3WnmBxvks3retBU2Z94hGr+u6BdrZ4xuZk7uusCKCO3LRpWFhVl2dp/5oH6TfGqvXpQVKzJv3apITpaLRE0R0gc2ugVLTn7/8NAEYPC0iRdhRaLG2Cg1NOjlhQv2bm4pRXK1uq5KVI57srC7sREATHsEwZXI1epG640+fU5NXBD50m6mGTB49hS7ZIGmjZztu/334b8Ao446BLP5KpUgLeTq8ZlA78Fzd9qReGq1Wl2nVpfhT6wd06c7sODSE1iOqImE3VeykWnPwRuOEfOUNTVqtbqC+ezS/FFDAGDENpsX+KKqD2zU1cB06qYYOk+h3QypJfPzMRvVVknzMd6bARMDYOJaP3SWWKlWq9XCLJ97xyYNBcwWL72LKpFJhWlhdwDACACA2fcDaDxxjVpZSg31eX7hwgV7t3cpIBs1oc7HRuxSeFzI4bVj523290lmuJzct9T62Bl3TDRTiGPlBHg83r96wYz9Tx9EZuqhT1FkQLSzU8JbeB6CUxzu4/j36gUzDj57kFhYf29OfHXSatZSmxePo3OQnLLIgCe2WxdYbf7vZTIPx6nEsosg729tnTrBsgEbLdu32ZmCbIRFct7cOLJ5+upVNu7PE/JRHCGOU4lhZof63ts3drTlspdOcflJnG/KRpxyBD7p/urRo9deOh/MgjL5OI4QR8947fpoq/X8Zmuxm2YjGvnBoeXz19jsfRjtgy3Wxl+RRGT5Ovnbu1ChbEFTm0C2vBa7pqZGpVLJ5XKRSFRRUVFaWlpUVFRQUJCfn5/XGuVmZtIvXkT16tXo332EgQF88OComTMjDh2K9PCAxcQgkUgCgcBkMrOysoqLiysqKiQSiUIskVJobcpGTGXS+yubJi5f86frC/fgw/prakjO62N/mRj2BABg6KQFS9bs3rBx36pF00cNaTkbKcm4vHc35xqZLP8nKBOfku6wc9GY6X9ffJmKZ2rYqGefATMWrd23YeOnfvH4VRq23dnof2Onr125/tPRD27dDo0hCyktZyMqN+aF67ppMwAA+GXA4ClWOzZs3Ld+3a5Fkwy6dW0VGw0ZNXHlCutG5yQ8FF1BbmpOfnA2SgIA1KBBKatX5wQG8ktKpFKpUqnUEZLuC6vHRghOaS7c6/zUYf0HjTt+n1zUbC22SlGRy3jt5m5/ep2xoSkAAP8EQPLFanUL2UhdxSX63do5DPjfmKm38SK1uq5aXRi5f+iAXsCIQ8+grAqVupIZfO3ARADoP3L8ruvOXlo5Xd0ybFAvAJh28ik8Q6xuVF+5pjbgf1ujitXV2kkqRZ7YuuhXABiz8Yg7mf+BjYxMe1yLK61UNlrU1dT8fMxGVZVcnOtyAOgGAIuO3Hr6ylNzjS4PT2+yGgMAv89YdgNRLBNxIu9bAsZdAQBYtO/iU0d3Ly8vLyiOWtAUG4JSq9WdphY70tkH9Q6ai+BUIFPIr2+etJi35XxQVjxLkAB7e2TXku3HXzhGFyI5wgR09JMry2eNmzlpl/1jn0in+vd6nFm9fPncS3avaDCOMAEJeXxp8aTJc6acdtN0fuv0jOmT5+++D/EllOM4wji4z5VjsybOX7Xrjr+zT4Sj95tzZzatnj967C4tGzHobrcuWE9fZXXM8VlgYiChrAGLQKP/O717zuRZG1afevnUJ9LZJ/y5i5Pt+pGjRi5Z/gwVQubhvoKNmq7FjnT2ifcMzUj4PBsJ0fSsAKe1c0aPHHngwfWXIc4+kc4Oj7ZvXGFmZvaFbMQRRgWe37dyyvhFNrv/ef2sPp7Axw9v7B49be6G4AAGv6l8UgvZqK6urqamRqlUisXi8vLyoqKinJwcDofDZrNZrRSTSiWcPo385ZcGf+4TjYzggwZBpkzx27PH8+lTr9ev3717FxgYGBkZGRcXh8ViaTRaRkZGcXGxQCCQVlZKyFQ5ld6WbERPSXPaYzNp3rYtx+y2rK1nIxqZH+flYtXVeMw0q/kL155zhsPwEjpTBve+u9eqFWxEp1Qm+PpOMjex+jcuJjxor8XkSX89egErpzOVmAi/M9snjZ11+mW8pNUX0hZsBH1hPWqo1YFbUdHJzRzK1lI2IiOQF5evnjbUfOrctTuOXnGB8ulMBQlf6n2mh4lRPRulhAWsXTDbau8pr3htqokuTUFxnF6GhyTxyHQF7NXBmWMXbjvnF45r1TlxbchGQi63+PVr1qZNjHXrGOvW0deupa5eTVm1irxyJWnFCuLy5W3spUtxI0ciDQyao6IuXRL79k2cMAHz11+0oKDM1NTCwkIejycUCqVSqe5ZNs139iM2kir5qX4vDpsBAyz+dwWSh3bq0YCNaqQVHHoyBAKBBL5/ZncA0FMr2UitLGG8vX5gEDBg7NSbRGldjVKCuzBsUC/A4twLaA6/Sq0uTba/sB1oWs1wT9vubySkeOxcOR4AgJU2F5KKdGxkYNJ9gidN9tEW2p+fn4/ZSF6eC3vYzDVOWmwdll1TJebgns0cZ9zNQO+lCat3X3cNwhJpTS8t/uzqFM/wm5mZmZtv23o0JpSdGx7k8ueEmfMuIyAsTR6iKMDh701Whw7eggUzBThOUVRowNVly+ZM03/3xClzlu696++NKcNxhDhWdsg718OLF07RvT5h3rylL56EZtRjBIniaH915rTxZmZmZiNGjZi+bLED5OHxmXMPadmIkxvg8NBm6ngzM7Nxc1ceeMv5hEWy3j96eGTxnKkTtUOMHDVi1qqlK9944UuRHOHXsFGzs7R04SrfgBawES6Nh8JCL65fM89Ct03muIlTZ0+bOmXsqi9kIxwnzePc+V0Lpk6w1EVkYTFm5qKN+y6GFqDSKhsFo9aykVwur6ysLCkpycnJSU1NpdFoJBKJQCCktEoYDPb4cX02QhgbJ/TrFz15st/+/S6PHjk6Ojo7O7u4uHh4eLx588bf3z8iIiIuLg6PxzOZzNzc3LKyMhGfLyKSZVT6F2910xgbMZV4SOiuRfNnWI61tJyt4R4KvtT/wXFDE0Ob1wwMWUMbEnwsze3ioWWWjbDRcWcUgqhohI2YciIux/WYmYn17SsXDw0dPMXmlm9MspLOVBITSXeP7hk7yuLg44T4FL2SHTIPAqH7xWYnEptmpi9lo0Ejh/0bXj8WNshtwYjRC/449zwoHUfRvosuTcbk+QUlB6AFVIai5WykyQnN1uxNwFTSmXIKgRvrEXJhlamRtt5Is3/BjGVbbnlR8RQlnSmnYPL9r14wNPn9L3cKhizDhb23njp1zvpDD94zMGQtHjHkJHyhXwDeD8kjfXwEXjuwka4Wu7a2trq6WqFQSCQSgUDA4/FKSkqKiooKCwsL2lDZ2YxLl5rMp3btmtCrF2zYsOitW6NdXeNjYzEYDJlMZrPZOTk5paWlAoFAg0e67NHHbKRWi/MQPpeH/fZb374Hnj69ZGxspMdGKmkGMvDI5rkAABj36P4/yynTp02bOGpQ167dvoCN1Ioy2uvHu38FBlsOf0KRVpUT7/Qc3BsYfC88QfO6lo2Me/T6n+WUGZ/oticks7Lx+9fXsdGwIcO96dWfZaNepj2uROQq5R+S5i2ZnybZqJ/5uElTpze4xp1HziCK1OpapaoE6bRw/uIZMyaO6vGLrmQbACat3v2GKWuHs75/BHUQGyFx2Bf3T3y666Pe9o/HDl5MCCVQPJ+fWbxq84M4ITpd+3Y09O9jNpsvODkmltaTFoHofm/Bh/fOPXPNixLN1B+xBBYbdnVufZtZJ/xfY4pRjcazaO1CO3gkK8fj5qa157wc4LmaE+mTUPEPrh+eOXvezDU7V7tSMax0d7tly6wcHGJzdTVGsNjX10/Prw9jqfXCj/Y/LAp0uXJo67kTt9Fa1ChLxMbdXrB03ulIf1ITez9SOf6ul5qZpZlzdm7YFRbCETQWT7b/c/ujG07se54Sp116w3GoT9dvWFE/w4dtb7hev3BmzZqDO9+wcRx+EonodNpq/gI3d2xJEqfQ97ntng1XLz4nxujN4TWrdQvt4iJZfN16WVTwzeM22ques2HtH86vSc0s/7WOjaqrq2UymUAgKC4uzsrKYrFYFAqFQCDg8Xhca4RFItFHjyb17JkEAElGRohff4XPmBFqa/vGycnFxcXJycnBwcHBwcHJycnV1dXT0/Pdu3chISGxsbFoNJpGo2VlZZWWllaWlws1bPSly2qNsxGdmf92z9GFpiaAtpaIkswNsj/bw9Coy9+vvcMZUBgHCkM9XrFlmuYP2JI1TrFyDRvBnK+YGvdadcnLJzQbQxBTPjlrlkoSw12u9zPu3QUATHufve2WhqsflBfzxO1g7959fh+8/2kyFJYOhXGgMA7U23PWxHk9t1+9FlHUlmyEoD88tbfP74P3P02JhRcdPH6VAAAQ/ElEQVSn0OQ0ZqbLAmtLI+Pp204+8qHWjx6W7HD1Ytc+A4c+ISRTJS1nI3yo36YFswwXbtn6AgWFcaAwhr/j64PaP/l/v8IgiArdPE9bsfnxe22brkbGgy64xHOJdCWdmeO1Yc90E9OJa3ff9KTUhxRJ8b5/s4tR39/uxMEIn9sVs83YqKampqqqSiqVCgSC0tLSvLy8rKys9PT0tLQ0dhuKTiedOfNpPhXRrVtC9+6w338P3rDBy97e28vL19c3ODg4KioqMTERj8czGIysrKySkpLKykqZTKZ5hE39KRuplXxOsPvh3vrZi3o2qslLPLtvLQAYmvboO3vDGk9qZY1cmRX6dw/Tnl/CRmollxr8aFdvYNiQ4Z7kcrR9z+59gD63Q6iFUrVarVaXERwu7jAFgGGzVvyLbd3DWF/HRv0G/s8OzlXrdqgUkBx2LLcAAJPVB6+hS5pmoxbNz8dspCjPj7fvBQBdAGCHFyFX2PQxbnV1Kkm+pKo6J3b9jtVmZmbDfh/wyy8mAGCxfIUDCXxUrVF1EBuB7min81G0UgStXHu+mxDHqcQQUxwv2+7ZcuyfyMKODOYL8kalpaU5OTlpaWl0Op1MJhNbKQIOhztxAvnrr0gTE+S8eXF37kT6+/v7+3t5ebm6ujo7Ozs6Ojo5Ob169crd3d3b29vPzy88PDwuLg6HwzEYjJycnLKyMlFFfd7oi++ITbGREh8RvmfNYoOu2pwQTYgODt9v2scU6NJFe0vpZmhkbGJqaGBgPnfZP4GldKaSTpUmB3j16dm3SxcAANb+/RAVj2rIRnS6jASHH/5lYM8uBtb/+ISh9e7uuOyXN2+YmpgY6t+5uhkZmVgfvh4Pa+YQktazER2X5XzjmlE3AAAMjU3/ehFbQqAr6bHQFfOtjA0MuulG79K1q+GA382vvcaIP+xv1JJ6o2Tak407JxsYdtX11KWLoXEPUxNjAOiy4X40DC/WzPO+dcsMDQw+tBnYr+9DfDJVmySLS9y22trEwFAvpC5dDHv92ve0M5xL+PL/9a1iI80nX6FQCIVCLpebm5ur/8kntKGwWOyJEx+xUdeuCEND+NChgVu3uj54oMmnurq6enh4+Pj4BAQEREZGxsfHJycns1gsTT5V86SC5mv7CRup1ZICcvAN/c9YPRsVJV2wWQkAgOWKHS5koVqtVleJhLinmpqkL2AjtVpYEP3yhtGAAQPOBQQ8NTExBoweB5HL63f9kWYg/z26phsATFgwPSC1uj6NU1stk8okEolEWVVd29TOBDo22nvDJTlP0lBSqaq2rq7pWuzfBg93JVfX1xHVVmdA1lrPBoBuVttPRqWKm2ajFs3Px2xULRJQ3p8xBIwAALgdgedK6+rUanVdjVKpkEgkErlcUVOrrqurqRJVckkuPdyTs7gyzUWL0sNOHJ4PAF3nL94Iz/n6W/6PKJCNfkhzE9Ax18ZPnTRed76bEMdJ97pybruFxbKdp54jmlz/ag+3qhZbqVRKJBI+n19SUqL59czhcDQ/oFshBoN09mzK5s0Ud3dSYiIGiYTDYKGhoe/evfP09HR1dXVxcXFzc3vdRL1RUVGRQCCQCYXtUG/EVNKZShqdF/rs6qYpH9bLaFQRLjx8v+mAHtpbyuy9ds6vY0/u2d11ysIlrml0ppLOVFBI+c77h/7WAwAAg93/eELiPmEjpoJCLnTdP7Rvj22XXclJ+ofVMxQUKg/qHXxCn41WXbntn46jfhReG7ARQ5QYArmwCgAAwMjE8Kp/Bp6qpDNkBBL75bpds3WjDxlpcToaTtCAUWvYiCGnoMhPt+2fou3pt2G/H3FmJ3o5mpr8ZnD2vR+qgs5U0uhSIhx7cs/uD23cMpOpetVFDBmRlOGx5++lupB+GzDwaHgsQUBmtOGxIZ9lo+rqav1fBampqbqMKbYNhUSidPlUAEgCgHhz8/D9+32ePHF1dnZydGw0nwqFQtFoNJVK1eRThUKhQqHQLKs1wkZ1ysq8WHe9YpkGbNR1/qaN8Hy1ulohoEadNTY1Ar6UjepEuZF+l7p06WJkYmIMAABwG0ook2t3bhXnxN88txwAunYzm7ogOFPTT3rwOItxPXv27Hnh8bvMpvIlOjYyNDLu3qNnA/XtP9CVLJWommSjLl369en/jiStVqnV6hzI1hWTDboBwPy/joelCes+z0bNzk+DZ/hV8gpi6DHA1BAAjExvBpMLJWq1uph49di+nj179ly2elt8jqIiP+Fpz549uht3MTnum1AorlKr1erilEsH/+gGAJYrVriQ+W136/+RBLLRD+lKJJnhdnHk6FGTJs/QHc02e8r4cWPWHNrrTkCw2zuAj9xyNtJVXYjFYl3VRXFxsabwolUqSEvLo9Oz09PT2GwKhYJCoWJiYoKCgt69e+ft7e3t7a2hooiICBgMpntOLTMzs6ioqP45NYnkaxbUlHSmnEIUYOKy4DjhJ1sIKsjEMiSCk4As0G2+TKMJ0fCsWM3KDoyTiC0jkEVYbDEUkY/QPbjOkBOw2TA4BwrjoJIryDRJCqY4IakQSdYrIapvU4QjfdggWzculSLEaoeAwjhQVFly82DEVNKplQhEXiK2jEBTaPonE8qT4rPgBEmTbZgKKlWIQ3GgME4snIMjS7XTKCOiixN1o8fnxOP1jz+TE/H5CfHFmBQJtWHYlSh4BooopuqQhSFJwRQnaLuCJWRjSDIauSIWngnFCz6UCtElWGzxhzbkT0uIZERsaZIupMb/f7U3GzWVN2p1pV3zwmI/1OFNmBB/+jTk1asALy8vT0/NWrOjo6Ojo+PLly/d3Ny8vLx8fX3DwsLgcLh+PlUsFjeXN1LX1UqL08PsGrKRds0IMO5uOnComdnw4cOGDOilTZTq2KiuhPr43H4AAIxMjAYMNZs6e1wwR1bNavSs2VphFv6tLQAAAGAIAAf+w5RWVOmSQXXVlSzEoyMrAcDA0Kj/75r6yN/7G3QzAIADd4Koxaqmtv3WsVGjMu7e04kgETfJRv169txtc7DfsJHDh5uZmQ0dYGpiBACLdl2OIparatWfX1Nrdn4asFFdnUpUSXf/u7tJTwDo3X/w0GFmZmb/G9yrZw8AmL5yTwBFXl1XIy9nRdwGTI0AoGe/gUOHDTfTa7Nub2A6eC5b4wLZ6Mc0Nq08AYt0fXRo8sSxusLp1Qev3Q1JjaCUd3AwLWejuro6DR4plUqZTCaRSEQikVAoFAqFla2XQCAoKysrKChIT08nkUgIBCIqKiokJCQwMDA4OFhHRSkpKQwGIyMjQ7e/keaJ5Wq5/GuSRqBB69ySeiOlUimVSnUZ08zMTE2xUWobikYjnjmTvHIl6c4dgr8/GgqNjYkJCQl5+/ath4eHq6vrq1evNBkjHx8ff3//8PBwGAyGRqMpFEp6enphYSGfz2+23kitVqvVtQpxIeLpDsDYQI+N1CppISn29N719YwxuP/gewF4VMDN7v17A8Dge+4JxWK1Wq1WydMRjie0rXoP6nE7qbCK+b4xNlLXVBZhvG0BADAwAXa8xZTKqvTXyWqrpGXZxMB/L63WZxvbBz5xaWVCRdMVyF/HRsMGDXVJzIp8edC0b30OeMeJm/G0YrGiVq1uho1aND+f7ItdV1tXJSgiJ7w+PnDYb7oYl6/f643KzBVVqdVqdV1NlZSLJwffHNxfvw7sozagPhXIRj+u0wXIFKKbX7RuC4C3cBac2f7jfuJWnTWr2V+upqamurpapVKpVKqqqqqqqipl66XJP5WXl+fn56empiYnJycmJsJgsNjYWDgcnpSUlJKSQqfTORxOXl5eaWkpn8+XSCRyubz+9Nmv3hcbNGiNW/6cmlgs5vP5ZWVlxcXFmofU8ttQeXk5aHQWDJZBJqcymSQSCYlERkVFBQYG+vj4aHbH0VBRWFhYTEyMphCbRqNxOJyCggIej6dLGmmeU5OVonFICASSTOdUSPV+49SohFwWJCYaAoFAKLnl2jPjleJsNg2iUUJcQrG4rlpcCI2DQSCQ9LwyeX0tcZW4MFPbKhYOTSuX14qLEuISIBAIMSO3Up9qqquExVkQCCQ6BsLiClU1n5QQ1VZJinIpED1lFQurmt/YR8XPQCLgkCYUHQPNrayurpWWopOQEAgkmc2pkNeo1SppYR5Lc11F4lp5eRoUHqt5ByuzUKojkGp5WXE6BAKJjYGmceW1H0f82flRVLJpJAgEkpScXCDSK72u4mfE64VMorErP9rSsa5OLSlMiIPpXccnbUB9LJCNQLe7W8VGGtV9otrWS7dbEpfLzcnJYTKZRCIRj8fj8XgikdiAisRisUKhqKeiNjpPDTRojT/LRg0ypmKxWCgUCgQCgUDAb2uVl5drHoVjs9kEAiEhISEyMjIoKMjf3z8wMFBHRTgcjkqlpqWl5ebmlpSUVFRUaL4j+vsbgQL1owpkI9Dt7i9gozaRrsRVIBBoNkxKT09ns9lpaWmZmZn5+flNUVH920E2At1GbslZsxo80mwNr58oVbS1ZDKZSCTi8Xh5eXksFguPx8fHx8fExERHR8fGxmqoiEKhaLY1Ki4uLi8vF4lEMplMt/FjM6fPggL1YwhkI9Dt7m/IRvoPvnG5XE1Zd3FxcVlZWTNUVP92kI1At5Fbwka6D+2XZUlbLs3inUgkKi0tzcrKotPpycnJGAwGg8Hg8fgGVCQUCkEqAvUTCmQj0O3ub8hGunUKqVQqEok0NdpCoVAikTRDRfVvB9kIdBu55WzUAdJtssrn84uKirKysthsNpPJZLFY6enpYK4IFCg1yEagO8Dfio3UenhUVVWlW1PQPzWzmb/4IBuBbit3NjbSleJVVFSUlJQUFhbm5+cXFhaWlJSAVAQKlBpkI9Ad4G/LRroyDo00ywrNU1H9e0E2At1G7mxsVFtbq1KpNMe3aXa74PP5lZWVIpFILpeDVAQKFMhGoNvd35CN9NUSHvqoPchGoNvInYqN1NrUkUqlUiqVcq0UCgVIRaBAaQSyEeh2dydho9YKZCPQbeVOyEb6yVT9rCpIRaBAqUE2At0BBtkI9E/uzsZGHz7kWn3DGECB6oQC2Qh0uxtkI9A/uTstG4ECBapRgWwEut0NshHon9wgG4EC9X0JZCPQ7W6QjUD/5AbZCBSo70sgG4Fud4NsBPonN8hGoEB9XwLZCHS7G2Qj0D+5QTYCBer7EshGoNvdIBuB/skNshEoUN+XQDYC3e4G2Qj0T26QjUCB+r7ULmxEAdkI9AdXwlMyQTYC/TMbZCNQoL4vtQsbZZTIGHkSaq6InFVJ4FTg2Vw0oyiJmp9Ayo0nZscRskD/PIanZIbHpYBsBPpnNshGoEB9X2oXNlKr1TU1NTKZjMfjZWZmpqSkQKFQPz8/Dw8PJyen56B+Pr148cLZ2dnT0zMwMBAOh5PJZB0b1dbWtvnHr00EshHotjLIRqBAfV9qLzaqra2Vy+Xl5eXZ2dlEIhEGgwUFBXl7e7u6ujqB+vnk7Ozs5ub25s2b0NDQ+Ph4KpWal5fH5/MVCkUnZiPVN7+ngv4xDLIRKFDfl9qXjSoqKvLy8qhUamJiYkREhJ+fn7e3tyeon1Jv3rzx9/eHQCBIJJLJZBYUFAgEAqVS2XnZSKWqYrG/+W0V9PduCYX2zsMTZCNQoL4jtSMbKRQKgUBQWFiYmpqKx+Pj4uIiIyNDQkICQP18CgwMDA0NhUAg8fHxKSkp6enpJSUlQqGwM7ORuq6urkpVLZdLKyt5xcVZaekkPD4eCg0LDHz/5o2Xu7uniwto0J+1h4uLg4MDyEagQH1H+j9Su1ygPVMyoQAAAABJRU5ErkJggg==" alt=""></span><br></span></p>
<p><strong><span data-mce-mark="1">ã€€ã€€Class Loader ç±»åŠ è½½å™¨</span></strong></p>
<p>ã€€ã€€ç±»åŠ è½½å™¨çš„ä½œç”¨æ˜¯åŠ è½½ç±»æ–‡ä»¶(.class)åˆ°å†…å­˜ï¼ŒClass Loader åŠ è½½çš„ class æ–‡ä»¶æ˜¯æœ‰æ ¼å¼è¦æ±‚çš„ã€‚</p>
<p><span data-mce-mark="1">ã€€ã€€ç±»åŠ è½½çš„æœ€ç»ˆäº§å“æ˜¯ä½äºè¿è¡Œæ—¶æ•°æ®åŒºçš„å †åŒºçš„Classå¯¹è±¡ã€‚</span></p>
<p>ã€€ã€€Classå¯¹è±¡å°è£…äº†ç±»åœ¨æ–¹æ³•åŒºå†…éƒ¨çš„æ•°æ®ç»“æ„ã€‚&nbsp;</p>
<p><span data-mce-mark="1">ã€€ã€€å¹¶ä¸”å‘JAVAç¨‹åºæä¾›äº†è®¿é—®ç±»åœ¨æ–¹æ³•åŒºå†…çš„æ•°æ®ç»“æ„ã€‚</span></p>
<p><span data-mce-mark="1"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAswAAAGZCAIAAAASGPCUAAAgAElEQVR4nOzdf1zOd////9CZNu3ULFs2O3ViW7PODYu1zax9tGnORrY2zUImFmJtWnI6JFIHYo1wIBwImRBnyIRmUSwciDOLhHDolyQ5qqN6fP94fnu+X45+vXLU6+io+/Vy/PE6nsfrOI7XUUd163j9MiEAAACAZmBi6AUAAACA1gmRAQAAAM0CkQEAAADNApEBAAAAzQKRAQAAAM0CkQHNKJESPcmTX7Ul2+t0/Q16Q03qQioUzplDOWpS13MpoALJFx/atCqqyqO8emZ4RI8e0AOdu+RTfjMvF4AxQWRAM6oZGQNpoJrUnajTLJolnNOKrBzIoealI3V8h95xIIdJNEnyxYc27RE9ciXXdEqva4Z4ip9Ns+/SXT5SSIV9qW/NOVMopf5LBmU0y2sAMDREBjQjYWQco2Mv0UvbaFskRfaiXjEUwy636TYRWZFVrY9gQza/0q/SLTGAwA264UM+Z+hMXTPISa4gBb9aV2S0o3Zu5Fbz0oE6sIkltKRZXgCAoSEyoFlUUmUYhU2myfZkH0ZhF+iCEzmNp/F+5DeZJr9AL/iRH7ukURpVR0YBFeykncLHsSGbH+lHw7wGaGNSKTWMwnQuXuT1Lr2rM8jvcpSOJlMyv1pXZJiSaa3PaE7mK2hFk78QgJYDkQHNopIqIyjie/r+HXongiJm0+yX6WX2ybOa1PZkrzM/i4x7dG8hLfQhn4N0kIh+oV9+pp8rqVL65Yc26CydjaAIfllCS7pRN+EIvxRS4c/0M7tXNEWnUVoIhfiQz0SaaEVWPuTDLqfpNJuHRUYGZURRlPAZzcl8Ha2T+GUCSAmRAc2IrS6JpujFtPgtemsIDXElV2dytiRLV3Jll5N0kgSrS3IoJ5ZiAynwd/rdkRyzKMuQLwDasGIqtiO7Wm96RI/W0JpwCicib/KOo7gjdCSWYrfQln/SP2Mpll1u0S02P4uMPMoLozBXck2gBCKaSlN1PrcDaH0QGdCMWGSoSZ1P+U7kFEuxKlIdpsN9qI+KVOxyn+5TjW0y7tCdyTQ5mqLLqMxAyw5tXTEVm5N5X+rLL2fpLL81iZI8yGMDbfiZfi6iIjbY4OqSAipQkWo6TT9JJ23JVkMaCV4IgAEhMqAZCTf8dCKnBleXcKEUuoE2DKNhN+mmNIsKoKOYim3JNo/y2MWN3JIoid9aTuUP6IHIDT91tskopuLP6LNTdKqKqppv+QFaAkQGNKNESvyGvimm4nIqdyKnp+lpC7LoRJ3aU3sLsmCXOIojQWRUUMUaWrOIFrGrNmSjc0QNAGlYkIXwqgd5CCODiLSklZN8Ha1zIzf2ZtZ5b1uQxZ/0Jz0eGWVUNokmHaWj/ak/DqoBrR4iA5pFFVWlUdoG2mBJlnZkt5N2ivkko5RKt9CWQArk45/QJ+2o3WW6LOXCA6RT+kAaKBwRRkY5ladRmpzkARQgnOcUnfqCvqj5aDwyCqlwPs3nm2KYk3k9x+EAaAUQGdAsKqhiMA3uQl34AQAajIxKqtxG22bTbJ2bTMnUgzwkWGYAruaBW4SRkUd5zuT8Jr2pExmWZFnro7HIKKCCpbR0I23k45/RZ3+nvwt3ggVoZRAZ0FxyKXcpLeVXncgpiIIUpFhEi3pQDwUp2IXtP2JFVhEUYU3WfJxf2lN7BSn20B6DvRJoY2IoZipN1RmsubokiqKEkbGO1v1AP7DpNEo7R+f4TaZkep/uh1GYsDAYczIPpdCmXHqAlgSRARJxIqfv6ftgCta5sFUhS2lpzZuEl5q/nQGaw1baOp/ml1AJu5pBGXtpLzUUGctpeTAF85tSKXUuzb1AF9jV9tR+Ck3pQT1kJNO5PE1Py0gWTdFSvDYAySEyQCKH6TDf0w+gBdpP+z3IYyktvUf3+OBtuh1KoR7ksZgW51COcH4eGUtoiSVZjqJRHuTBL32oD0+HKIqq/3KMjkn5SgEkg8gAACAiukW3kiip5h4falInUZJOYZAgMi7RpSRK0rm4kzs+nwBAZAAAPImH9FD4mYeOe3TvIT2UcnkAWiBEBgAAADQLRAYAAAA0C0QGAAAANAtEBgAAADQLRAYAAAA0C0QGAAAANAtEBgAAADQLRAYAAAA0C0QGAAAANAtEBgAAADQLRAYAAAA0C0QGAAAANAtEBgAAADQLRAYAAAA0C0QGAAAANAuxkTFmzBgHaB67d+9u1u8xAACAQYiNjL59+54/fz4bmtqsWbMUCkWzfo8BAAAMohGRkZeX16yL0jbJ5XJEBgAAtEqIDANDZAAAQGuFyDAwRAYAALRWiAwDQ2QAAEBrhcgwMEQGAAC0VogMA0NkAABAa4XIMDBEBgAAtFaIDANDZAAAQGuFyDAwI4qMEzdPmC8wxwWXJ7tYLbYy9FsYAKSGyDAwI4qMpBtJHrs9DL0UYKwsQi0MvQgAIDVEhoEhMqCNQGQAtEGIDANDZEAbgcgAaIMQGQaGyIA2ApEB0AYhMgwMkQFtBCIDoA1CZBgYIgPaiJYcGX/l/+W63RUXXGpeDl49aOi3p3EzssjIysqyt7cPDg5etWqVvcCwYcPqusvVq1d9fX2lXMhGQWRAG9GSIyMlO2XIpiGpt1NxwUV48Tngo0g1jt/PLZbRRMarr75qZWU1cODAvLy84uJimUwWERGRV6179+513bGioiImJmbGjBlSLq14iAxoI1p4ZLjtcDP0UkCLI0+SIzL01CyRUV5erqlWWlr6pMumS6PR2NrasmmZTKZUKvlNOpHh4uJiZmZmXq+mWio9ITKgjUBkgNFBZOivWSJj7ty5tra2HTt2fPXVVwcMGPCky/Z/srKy0tPTz50717Nnz/T0dLVa3WBkqFQqIkqvjVar1X+RmgoiA9oIRAYYHUSG/ppxdYmdnV1xcXHjF6kW06ZNc3Z2/vjjjzt16uTs7BweHi6TyWbMmBFfra7IcHZ2fv/997t27ers7Ozs7NytW7d33nmnJWxcwiEyoI1AZIDRQWTozzgig1EoFHx1SWxsrJfATz/9JJyTRwYR3bp1y8/P7/jx43/++efMmTOvXLnShIukP0QGtBGIDDA6iAz9SRcZKSkpsmrFxcWVlZVseteuXUQUGxvLrmq12pKSEj7niRMn/m9ZTUyee+65jRs3nj59WlbD6tWr+ZzCyCCijIyMoKCgoKCgS5cuNeolSACRAW0EIgOMDiJDfxJFxrlz52bPnq2sNmnSpKqqqkWLFtna2iYlJRHRiRMn+vTpExoaWlFRMXHiRD6nTCZLTU0lIh8fn7Vr13br1m3p0qWzZs1it9ra2oaFhbHpffv28admkTFlyhTPau++++7bb7/tKdCo19J8EBnQRiAywOggMvQnUWTk5+dnZGSsWrXK0dHR0dHRzMyMiB49eqRUKuVyOREtXrx4/fr1JSUlRHT8+PHLly+zObt37x4TE0NEVlZWbO+SgoKCy5cvs4d1dHTMysqq+dQsMpKSkhKr/fjjj5MmTWLTXbt2TUxMbNRraT6IDGgjEBlgdBAZ+pNudcmmTZsWLlyYlZWVlZXVtWtXNpiYmMg+VPDy8kpISGCD9+7dGzp0KJvz22+/jYmJ+eyzz86dO8d3Yd2+fbuNjY2NjY25uXn37t3Z9MiRI/lz6awuISKFQsFqhoiys7Mb9UKaFSID2ghEBhgdRIb+JIqMffv2+fj4VFZWsqvW1tZsgkVGSEhIZGRkVVUVG3zhhRcqKirYtK+vb0xMDLvKI6OyslKr1Wq12g8//PDq1atsmt+FGoqMFgWRAW0EIgOMDiJDfxJFxuHDh319fbOrde3alX+cwDa8EN7xjTfe4HNOmDBhzZo1ZWVl9PjBuJhaV5cUFhaOGjXq4sWLwkFEhv4QGaAPRAYYHUSG/po4MvLy8m7cuMGmdVaXxMTEOAi8//77bHzfvn3CHUOIqLCw0OFx6enpVB0ZhYWFKdX69++/e/dufjUjI4OIfHx84uLi+KOVlJRcvnwZkaE/RAboA5EBRgeRob8mjoyoqKjhw4dHR0dHR0dPnDhRo9Hot3iPYZFx7tw59zosW7bsf//736xZs86cOcPvdfPmze+//14ul+/du7cJF6apIDKgjUBkgNFBZOiviSPj7NmzAdXu3r2r37Lp0mq1S5curX+exMTE5ORkncH09PTY2NimXZim0jYjQ61Wy6H12rhxY81vOiIDjA4iQ39GcxbW1kreJiMjNTXVBFove3v7mt/0thMZaWlpPmAMQkJC6v9WIjL0h8gwsLYcGcOHD4+DVgeRwb4I0PLZ2dnV/61EZOgPkWFgbTkyfH19m+TRoEUxQWTExZmYmPzwww8qaMEQGdJAZBgYIgNaGUQGi4ywsLCmekBoDogMaSAyDAyRAa0MIgORYRQQGdJAZBgYIgNaGUQGIsMoIDKkgcgwMEQGtDKIDESGUUBkSAORYWCIDGhlEBmIDKOAyJAGIsPAEBnQyiAyEBlGAZEhDUSGgSEyoJVBZCAyjAIiQxqIDANDZEArg8hAZBgFRIY0EBkGhsiAVgaRgcgwCogMaSAyDAyRAa0MIgORYRQQGdJAZBgYIgNaGUQGIsMoIDKkgcgwMEQGtDKIDESGUUBkSAORYWCIDGhlEBmIDKOAyJAGIsPAEBnQyiAyEBlGAZEhDUSGgSEyoJVBZCAyjAIiQxqIDANDZEArg8hAZBgFRIY0EBkGhsiAVgaRgcgwCogMaSAyDAyRAa0MIsMYI2P16tXLli3jVy0tLfl0SEjIxo0bhTOfPXvWw+P/fhV88MEH+fn59Tz4a6+9Jrzq5uZ26dKlmrN5enomJyc3dsmfGCJDGogMA0NkQCuDyDDGyCCiwMDALVu2aLVaIjI1NSWi8vLytWvXLlq0SDhbZWVlYmLi+PHj+Yi9vX2tfx1GjBhx7tw5IurevXt5efmmTZvmz59PRC4uLpaWlvfv39eZ393dPSkpiYhMTEysHmdmZpaent60rxeRIQ1EhoEhMqCVQWQ0KjK0Wq1KpcrKysrNzc3Nzc3KylKpVOwvvUiZmZkqlaqiouJJl5fu37+vUqlUKpWTk9PmzZtVKlWHDh1UKtXq1auHDx+uqlZaWkpEhw8f7tOnDxvJzc0lInt7+8TERD7bzZs3+SMPGzbszJkzL7zwwo4dO2bOnMkGXVxc0tLS+DxFRUXsjkOHDlUqleXl5SxxhJydnREZRgqRYWCIDGhlEBmNioy8vDxLS8tFixaFh4eHh4cvWrTI0tKyUb9sFyxY0Llz58LCwiddXjp58qSrQMeOHU1MTDp16uT6uDt37hBRx44d2VU7O7vw8PCTJ09OmDCBz/Puu+96eXkR0enTp2NjY2NjYzt06GBiYvL666/HxsZeunTp/Pnz9vb2y5YtY7ceOXIkNTWV3fell15ia146dOgQ+7h+/fohMowUIsPAEBnQyiAyGhsZ7MvFIoPqXvtQj759++oTGdy+ffvCw8NnzJjRvn17Pz+/8PDw3377TWcea2trNhEWFhYeHu7q6pqamspvjY+PZ5ERFRXl6+vr6+vbvn17ExOTF1980dfXNy4uzsfHZ/jw4eymjh07Lly4kN+Xry5p3749m2Ho0KEDBw5k0zk5Ofq/QCFEhjQQGQaGyIBWBpFhjJFx/PhxPz+/BQsWhIWFPXz40NTUtLCwMCwsbP78+X5+fidPnuRzCiPjo48+WrBggVqt5rfyyGBCQkLCwsI6d+4cGhrq5+e3f/9+Hx+fuLg4dqtw81Kqjozg4GC+uiQqKkomk+nzuuqByJAGIsPAEBnQyiAymioybt265VYtMTGRiHx8fNzc3CZNmpSRkcHG4+PjqToyNBoNG1yzZg17cJlMxkYmT55MRMeOHWNXVSrVDz/84ObmNn78+KysLDc3t1mzZsXExGRnZ7M78j/z169fj4mJ8ff3P3/+PBsxNzdnD/Lmm296enrevn3b39//wYMH7FZhZMydO3fjxo1VVVXdu3fPy8uLiYmZP39+r1696okMR0fHzZs3t2vXjj3FwIEDX3/9df5F0Gg0T/DtqAsiQxqIDANDZDTWkiVLjh8/zqaLi4tHjx7NpleuXJmQkMCmKyoqRo4cWfO+H3300RMtr2GMGjWqrKyMTR89epT9BWKGDh0q5hG2bt0aExPDr0rz8hEZTxAZR48enTlz5syZM48ePcoio6ysbPjw4SnVpk+ffubMGZVKlZKSYmZmNmrUqJSUlGnTpkVERFB1ZBQXF/fs2TMlJeXatWtENHfu3G3btrG779+/f9KkSXl5eSkpKSNHjrS1tY2NjU1JSbGysiopKUlJScnKyhIulc6ml5mZmXxnkOeee4495rRp09h7Mi0tbciQIexWYWRcunSJbSvavXt3NnL79u2UlJRvv/02MzPTyclJuJ5l5cqVzz333Jo1a8rKyjp06MCeIigoyNPTk38R9Nm4tSZEhjQQGQaGyGgs4cethYWF/NdEQEBAdHQ0n+3MmTOff/65zn0tLCwKCgpE/oU2uLy8vH/84x9sOiYmhn+5hg4dKnIjuLCwMPZHiLGwkOLPPCLjCSKDfX99fX1jYmJYZGg0GltbWz6bp6cn+zCDiLp168aOS/Hw4cOSkhKqjoyePXsKf0t7eHh06dLF2tra2tq6a9eugwYNYuPe3t7btm1jO7Dk5ORcvHjRugYTE5OagyxEdLbJYNNWVla9evUiQWRMnTqV37FDhw5sYsGCBVS9dwn/GOPQoUPW1tahoaEjRoxg22RgdUlrgsgwMESGSJWVlRqNRqPReHt77969u6qqqrS09O7du3369GHjfn5+mzdv1mg0VVVVRJSVldW+fXvh3vxU/Vf2zJkzX375ZT3PpdVqNRpNZWUl+z9Mo9HwTxREeoK76CgrK2Ov67nnntNoNNu2bfPx8dFoNCNHjjxx4gS7iS1erSorKzdv3uzr68vmZF8TCwsLjUDT/l/IITIae5yM1NTUDh06+Pn5+fn5dejQgf1/X09k8A8GuL59+3bs2LG4uFj4V9PDw4P9zdbh7e3NVrLUpbS01MLCoq53V62RQURWVlZUY5uM0tJSU1PTqqqqxMTEMWPG8HE7O7uaG5EIj5PRrl07c4H27dtj7xIjhcgwMESGSKdPn+7du3fv3r07d+7crVu3v/76q3///j179jQzM2Pjzz77rLW1de/evdlmaLdu3frmm2+I6N69e1eqPf3003y6nvdzUFDQ888/f+LEid69e2u1WhsbGwcHh0a9QBsbG/6P45MZO3Zs72ovv/yyiYkJO0JRb4FPPvmkrrunpKRYWFiw2Tp16qRSqTIzM4X3ffbZZ6OiovRZwrogMp4gMtzc/v9nd3Nze7LIKCwsLCkpGTJkCNvRlB6PDK1Wy7e3qD8ysrOzBwwYUFFRMXjw4Nu3b9ecoWvXruwnKCAgQBgZjE5kfPjhh717905KShL+ONy5c2fIkCHsOF1CLDKysrJ69eplY2MjvAnHyTBeiAwDQ2Q0FltdkpKSotVq61ldwm3ZssXJycnJyalTp04mJiZO1VatWlXXUwQFBSmVSiJikaFWqxsbGdnZ2XpGBpeQkBAVFfXmm2/+4x//kMvlCQkJRUVFDd4rJSXF3d2dTbu4uKhUKp2N7AICAhAZXAuMjLKysq+++iqh2g8//HDu3LkTJ04kJCRYWVklJCTw41mpVKpevXrt2bOnoqIiMjLSwcGB/T2Wy+VKpZLdfefOnb6+vmq1OiEhwcXFhb2Ran6Udf78+bFjxxYUFBDR7du3J0yYkJCQkJmZKZzHzMyM/QS98sorwsg4evTow4cP165du3TpUj54/PjxhIQEJycnT09PtsCXL1/+7rvvsrKyLC0tExISUlJS+MwsMrp3787KXvikiAzjhcgwMERGY/n4+Pj6+k6dOrWkpKSkpGT27NlsfMeOHXxHO6VSqVQqhf+uHTp0aMqUKaamprWGiI4WEhm7d+9WKpWenp5BQUFsnf3WrVs9PT2XL1/OFq8eOpExb9484f+XhMh4nGEjIysra8WKFWx6xYoVfBvMO3fueFZjn0n4+/vzEV7J4eHhbKS0tJRN8FONhISEsBE/Pz8iSk5O9hQQrhBJT09XKpU//fTT1atX+eClS5fY24/9QLFdSPjqkvj4eOFRNCZMmLBy5colS5awq3/88YdSqfT29vb09CSijIyMVatWXbhwYfbs2ewzjClTppiZmbGf3/T09AsXLri7u//nP//57rvvtFqtlZWVUuBf//oXIsNIITIMDJHRWD4+PqNHj87JyZHL5UG1KSoqCgoK8vX1dXR05Pdi/wlZWFgEBQXxHfzqUk9k7N+/nz8REeXk5LDpY8eO7dq1i4/zyEhKSmKD7FBCGo2G3/3EiRNEFBkZGRQUNG/evIKCAjZ+5MiRvXv3Cp+FHt/wc82aNUFBQcHBwfW8hJSUFDs7O/YIr776qre3t0ajCQkJ4TMgMoTa8rlL1Go1f7PVet6yxMTE/v3780846npdZWVlwq2M2Y+DzoYXSUlJp06d4lflcjmbOHXqlPDnV6vVWlpaCn+oe/fujcgwUogMA0NkNMq+fftsbW3Z3iWWlpbsvxxfX98hQ4aw6VdeeYWte87KyuKRsWHDhqVLl96/f59tzrZ8+XLhCSdrYpGxePHiVatWjR8/nkdGfHz8ggUL+H9X3333XWFhoVKpHDduXL9+/RYuXKhUKtnmbzwy5HL5uHHjlEol+23r5eXF7z5nzpyTJ0/u27dPqVS2a9du8uTJSqXSy8tLJpOdOHFCqVQKzyAljAxm8+bN9byElJSUd955hz3RW2+9pVKpiGjdunX8gx9EhlBLiIzffvtN5/Cad+7cWbx4cc057927x840xgUGBrLdTJ5AQUGBUqkUHm6rphMnTvBNPZrJ6dOn2Z63RFRVVSXc9ZqIDh06VPOEanpCZEgDkWFgiAyR0tLSnJycZDLZiBEjeGSwm9ixitn0oEGDdCJjy5YtS5cuZbv8sb1LioqKVq1a1eA2GU5OTleuXDE1NeWRUdceoQqFgrUIEbFjeLDIOHz4sEwm4xvcEZGpqSnfKKRHjx583U2HDh3YBxt37ty5evXq0qVLnR7HtsnQGdTZd0ao5jYZRFRcXGxhYcE6A5Eh1BIigx+Mi0tPT3dycqo5Z3Z2ts76u6Y6rHibgsiQBiLDwBAZImk0mitXruTn5/PjZFhaWrIdJbp169a5c2c2bW5uLoyMPXv2zJkzh28pybMgNja2nmcvKCiYPHky2xXF1NR0wIAB7DHriQydlRfZ2dnm5uaTJk0KCQnZtm0bH//73/9+RaC4uJiN6xz7KCcn58rjIiIiPD09dQZv3LhR10uoNTIqKyv379/v4uJCiIzHGTwy4uPj/fz8dEJBZGRMnDjxt99+q6ysfOIFbpsQGdJAZBgYIqOxhJHBjvewe/duts2BRqN57733hJFRUVEhPGs2z4LKysr6z6bt6em5f//+qqoqjUYjPDCA+Mh47733ysvLdb6/Ort4cDXPbS105syZr7766ueffxY+e/1qjQwiqqqqYgfwQGQIGTwyhKvD3nvvPXZwiI4dO7Zv354fK+LYsWNvvPGGzrhCoXBxcTEzM+Oz1XqsW6gJkSENRIaBITIaSxgZarVarVZv3ryZra1Qq9UDBw5kkXHmzBkXFxe1Ws0/LSAidlBCMTw9PflBynlkrFq16pdfflFX69WrF9ssdNGiRTNnzlSr1fwAXGfPnh04cOD9+/cfPnw4duzYzZs3s6Z55ZVX+N39/f337NmTn5+vVqvZShm2YZ2O9PR0fojSOXPmREVFqdXqBv9tTUlJMTc3Z4dZ7NixI48MrVZ77969kpKSWbNm7dy5U+RXo1EQGY2KjMrKyoMHD7L36owZM/jRbKnuTzLOnj3LPsl4+PDh999/f+jQofz8fHa8tbS0NPZJFTQIkSENRIaBITLEy8/Pv3HjhjAyHGp45plnsrOzT5w4MXLkyDNnzjg4OMyZMyelDvVsyzZ//vw///yTTQ8bNoyPL1myhD8XEWVmZgqfnR9fiF2dO3fu5s2b2TQ72EBxcTGfeevWrUQ0YcIEPjJlyhThMpw7dy4lJUXnIOizZs1ycHA4fPhwSkpKzcMZccJPMmbMmJGRkcGmMzMzv/3226VLl9a/3ag+EBmNiozCwkL23e/RowffJuP06dMpKSnbt28fMGAAe6/m5ubyu7C/jhkZGfzcNHybDESGeIgMaSAyDAyRId7x48fnzJkza9as06dPE9HYsWNrziOTyfLz87/66is+snPnTrc67N27V88X0kxOnz4dExMzfvx4fowmHePHj+/QocP06dPreoSMjIyaR2PkD97gTrz6QGQ8weqS7OzskJCQffv2savsWy/ED/e5a9euf//73126dPnxxx/ZmVGPHz/u5eX18OFDQmQ0BiJDGogMA0NkNMrRo0f5KVgNZc+ePeygFzr2799/69atJnmKHTt2+Pn51fosXEBAQJM8V5NDZDQ2MtRq9YIFC0Qmr6mpKdvwMzo6mh1ii21zw7bXQWSIh8iQBiLDwBAZRsfV1ZVv4iDk4eHx5Zdf+go005aVLVxbi4wdO3ZcvHhRONKoyHj48OHXX3/9yiuvsPcMWwU2e/Zs38exY1gtWLAgPDycRcZff/31xx9/7Ny5MzQ0NDc3d9WqVf7+/ogM8RAZ0kBkGBgio2VatmyZazV2XGSu1sjYunXr0qVLY6utW7fu9ddfZ6t12po2FRm7du1i588T7k7cqMgoKyuLFWDnJLOyshIOfvnll+wQtAkJCVVVVXwX1j179vTs2dPBwYG9US0sLBAZ4iEypIHIMDBERqNs2LChrwARXblyhU1v2LChSZaNuXHjhqoa37uEqRkZMTExL7zwQo8ePfiCvfHGG506dWLTOscubPXaVGTI5XJ2glxbW1t+zE39DyvOjhvLyWQy4dlqeGTk5OSoBBAZjYLIkAYiw8AQGeLt3r171ogMZ7EAACAASURBVKxZedU6d+5MRBUVFXl5eQsXLuTnQWhy1tbWp0+ftqpmZmZmaWlpZWXVo0cPIjpy5MjUqVN//PFHhULBFszExIQv5Jw5c4zl+9tU2lRkPHr0yNPTk3XGc889xwafLDJWr15tZWX13//+l0RHho78/HxEhniIDGkgMgwMkSFSRUXFli1bAgMD+chLL73EpyMiIpo2Mr777rsDBw6ww1E0+EkGEclkMnNzcwsLi3bt2llUMzc3NzMzW7duXRMuWMvXpiKDcXNza9++vYmJSefOnUtKShoVGfn5+ezd4u/vzwetrKwsBMzMzMRExgsvvCA8azzUD5EhDUSGgSEyxD57UhI/8ENNNSOjvLw8vZrwaM3pAvzgV1euXOGD7BQkRDR+/PjExMT09PRBgwY9evSI7zlSa2T88ssv//3vf69fvz548GB+usioqKiJEye2tZNKtMHIIKLPPvuMdYatra1CodBzdcm7774rvPrLL7/s3r2bX1Wr1aNGjap5r5KSks8+++yJn7StQWRIA5FhYIgMsc/emMioqqr69ddfnastWbKEvXsTEhL4oK2tLfszkJyc/Pnnn7PBAQMGeHl58ccZP358u3btiCg9Pd3Hx+fy5ctUR2RkZGTEx8d/++23d+/eNTExSUxMvHfvXnh4uLOz8/79+8W/zFagbUYGEbm6upoIGMup3tssRIY0EBkGhsgQ++yNiYzKysrZs2ffvn1boVAoFIr3338/Pj6eBGcbIaIjR44cOnSIiOzt7fmnF+np6cL9Trdt2+bt7b1p0yYiiomJ+fjjj9PS0oSRUVBQwJ5i7ty53t7eS5YsUSgU3t7ezz777JIlS5p2W1Rj0WYjg4jGjx+PyDAWiAxpGHFk7Nq169q1a4ZeCn0hMsQ+eyNXlxQWFgYGBgYHBwcHB7/99tssMhYtWiSrxj9gWL9+PR8UZsGGDRvmz59fWVnJtsmIiYkZNGhQamqqMDJyc3PZU8ydO1cmk82fPz84OFgmk/3973+fP39+W9uvhGnLkaHRaKZOncoiw8nJ6cKFC/o/JjQTRIY0GhEZbm5uHi1Jz549P/74Y0Mvhb769euHyBAjJycnLCxs+/btfGTSpEl8WicyKioqJk6cyD6oICIvLy8WGUQUVW3BggW8M3bu3MkGf/nll8jISDbo5OR05coVIlq/fv3cuXNv3Lhx5swZqrG65Pz58x4eHvPmzYuKivLx8fHw8IiKiurevXtOTs7ixYuFC9xGtOXIIKJ79+7NmDGDdUZ0dHSTPCY0B0SGNMRGRmpqamJLMmbMGP5jbOhl0Rc7/E7LZ/BdWKOjo/mxtMePH8+7gWpEhlartbGx4Vd5ZHz66ad8MDw8nH2g/d133/EtQBMSEtg2GXK5fP369Y8ePSIitVot3JhfJzIKCgoSExMDAwMdHR03bdqUmJhIRN27dyeiu3fvBgcHOzo6Ojo6toJP3UQyMTF55plnHGvo8M8ONQdbiP7v9u/ap2tTPdq//vUv9tupT58+ly5dMvQ3BGqHyJCG2MhoaWQyGfsxzsrKMvSytBUGj4yHDx+GhITY2NjY2NgcPXqU7V/6119/2djYdOnS5dlnn7WxsUlNTWUzp6Sk2FSzsLB44YUXrl69amFhwQf9/PyKioqIyN7e/uWXX2aDX3zxRX5+fnh4uEKh0Gg07KEqKiqE52vViYzff//dxsZm/vz5WVlZpaWlbJBFBhHdv3//m2++Wb9+fXl5+RN+sYyNCVRbvnw5f0tAS2OCyJAEIgPEMnhkGFxYWFhERERd5y5h2CcoPDLaIEP+VW9hsLqkJTNBZEgCkQFiITKISCaTHTx4sP552nJhUNveJuPSpUu8MLB3SQuHyJAGIgPEQmSAGG02MpKTk4UfYyAyWjhEhjQQGSAWIgPEaJuRceDAAXNzcxMTE0tLy8GDByMyWj5EhjQQGSAWIgPEaJuRYWdnZ2Ji0rFjx2XLlul/FlaQACJDGogMEAuRAWK0wchYuXJlly5d2McY1BSnegcJIDKkgcgAsRAZIEZbi4yVK1c+//zz7NcR2ygYkWEUEBnSQGSAWIgMEKNNRca6devYZxgmJianTp1ig4gMo4DIkAYiA8RCZIAYbSoySktLx48fv3379sLCwqqqKjaIyDAKiAxpIDJALEQGiNGmIqNWiAyjgMiQBiIDxEJkgBiIDESGUUBkSAORAWIhMkAMRAYiwyggMqSByACxEBkgBiIDkWEUEBnSQGSAWIgMEAORgcgwCogMaSAyQCxEBoiByEBkGAVEhjQQGSAWIgPEQGQgMowCIkMaiAwQC5EBYiAyEBlGAZEhDUQGiIXIADEQGYgMo4DIkAYiA8RCZIAYiAxEhlFAZEgDkQFiITJADEQGIsMoIDKkgcgAsRAZIAYiA5FhFBAZ0kBkgFhNHhnvvfdeMLQ6iAxEhlFAZEgDkQFiNXlkQGuFyDBBZLR4JogMSSAyQKwmjIz79+/HQ+uVnJxc85ve1iLjtddec4YWDJEhDUQGiNWEkQFtUFuLDGj5EBkSQGSAWIgM0EfbiYzKykoNGIPS0tL6v5WIDP0hMkAsRAboo+1EBrQaiAz9ITJALEQG6AORAUYHkaE/RAaIhcgAfSAywOggMvSHyACxEBmgD0QGGB1Ehv4QGSAWIgP0gcgAo4PI0B8iA8RCZIA+EBlgdBAZ+kNkgFiIDNAHIgOMDiJDf4gMEAuRAfpAZIDRQWTozygjo6KiIiAgwMTExMzM7Pr164ZenLYCkQH6QGSA0UFk6M8oIyMyMpJ9jJGYmGjoZWlDEBmgD0QGGB1Ehv4QGSAWIgP0gcgAo4PI0B8iA8RCZIA+EBlgdBAZ+kNkgFiIDNAHIgOMDiJDf4gMEAuRAfpAZIDRQWToD5EBYiEyQB+IDDA6iAz9ITJALEQG6AORAUYHkaE/RAaIhcgAfSAywOggMvSHyACxEBmgD0QGGB1Ehv5ac2Skpqby6bt376bUcOnSpWZf1uaRmZlZWFhYc/z69esFBQXN9KSIDNAHIgOMDiJDf605Mr799ttdu3axaYVC8dZbb7m7u3ft2nX48OHu7u6fffaZo6OjcP79+/dH1635Xs4T8PLyio+Prznu6+vr6+srXOwm/LAHkQH6QGSA0UFk6K81RwYRPfXUU0qlkogUCoVcLieiQYMGZWdnE1FWVpZOZNja2k6fPt3Pz8/Pz2/EiBFvv/22X7VOnTo102upxx9//BFWbenSpcKbao2M06dPBwYG8mX29fXt0qXLmjVrmmp5EBmgD0QGGB1Ehv5af2Rs27aNiBQKxbvvvuvj49OtWzdPT08fH59aI6O4uJhNx8bG+vr68pusra359MmTJ30EysvLi4qK2PTu3bub6jUSUXJyckQ1U1NT4U01I+P8+fMffPDBBx98wBfM29v72WefZdP79+/Xf3kQGaAPRAYYHUSG/lp5ZOzbt49NKBSKMWPGxMbGvv766+vWrYuNjX2yyDh37pyfn19stW7dumk0mtLS0tjYWH9/fz8/v6Z6jTpMTU1zcnJcq/Xo0ePdd99l00R05cqV6dOnT5gwYcKECWzBLC0t+UJOnTo1KChI/2VAZIA+EBlgdBAZ+mu1kTFq1Ki+fft+8MEH7KpCoejWrVvfvn07der0xhtv9O3bt9bIePPNN/v27du3b99//vOfXbt27VuNf5CQkJDg6enJ79K7d2+NRsOmY2JimjYyli1bdvDgQTZtampaVlamqjZy5MiVK1eyaSIqKSm5du1aeHj4Sy+9xBeYL/zLL7+MyACDQ2SA0UFk6K/VRsaDBw8KCwstLS3ZVYVCMXfu3EKBWiPj1q1b7NYtW7ZMnjyZz/z8888TUWZm5r///e+SkhJ+l6KiIj7d5JGh0WjGjBnD9pFpcHUJEYWHh4eGhhYWFvbr1++vv/5iS75nz54xY8bwEtIHIgP0gcgAo4PI0F+rjQxGGBlyudzd3f2pp56ysLAwMTF5gtUlV65ccXJyquu5akbG3bt3LaoFBwdrtVoiKikp4YPm5uYBAQFEpNFo7O3t2eDTTz/t4uLCH+Sjjz5q164dEd24ceOTTz4pLS2lOiKjvLy8uLjY3d397Nmz1tbWxcXFlZWVBw4csLCwCAkJqf8LJQYiA/SByACjg8jQX5uLjKSkJCKqKzJOnTqVlpaWlpa2bNkyDw+PtGpWVlbU+MgYOHBgaWkpe4RJkyZFRUURkY2NDZ/hwIED4eHhROTi4pKWlsYG09PTp06dyufJzMwcPHjwxYsXiSgxMXHEiBF3794VRkZFRQV7isWLF9vZ2a1bty4tLW3QoEEdO3b87bffvLy86v8SiYfIAH0gMsDoIDL01/ojo7i4+MyZMzwylixZEh8fX1dkODk5OTs7Ozs79+vXr0ePHs7VOnbsSI2PjIqKim3btrFH6NWrF4uMcePGxVc7d+4cmzMwMHDLli1s8MSJE/wRzp075+npmZeXx1aXJCYmvvTSSxs3bhRGRlFREXuKWbNmxcfH+/j4ODs779q1q3379l9//fWff/4p+uvaAEQG6AORAUYHkaG/Vh4ZTz31VHh4+MqVK3lkjBgxwtvb+8lWl+Tm5vr5+R09epSPb9u2raKigk3XjIyVK1fOnTuXTctkMhYZRORdLSAg4OTJk2xw/vz5bPCHH344cOAAG3R3d09JSWF32bJly19//bVx40aqsbokNzdXoVCwR1i4cKFCofDx8TE3N1er1X5+fr///ntDX1FREBmgD0QGGB1Ehv5aeWSYm5uvW7cuPT09MDAwJSVl79697EhccrlcJzI2bNgQEhJSVlbGrta1C6tw75J169aFhISwLS2otsiwsPi/36o8MhYuXMgHo6Oj2TYZGzduvHv3LhtUqVRsm4z4+Pj58+ffvn2biLRarXA9i05kqNVquVweFBQUEBAwf/58uVz+8OFDc3NzIsrKypo3b15AQEBAQEBmZmb9X676ITJAH4gMMDqIDP218sj49ddfiSguLs7b21vnJp3IcHZ2Tk9P51frigy1Wr1w4UIPDw8PD49ffvnlwYMHRHT//n0PD4/Bgwf36dPHw8Pj9OnTbOaNGzd6VLOzs3v//ff/97//2djY8EE/P7+zZ88SkYuLi4uLCxucPHlyYmLioUOH5s+fn5WVxR6qqqoqNjaWL49OZFy7ds3Dw2P27NlRUVE3btxggywyiOjKlSuff/75pEmTeMc8GUQG6AORAUYHkaG/Vh4ZRJSZmenl5XX16lXh4KBBg4SRERYWtn79+kePHvEZeGTIZLKLFy8Kj/iZk5OTlJSUlJTET1FWVlaWJJCfn8/GKyoqkh53//791NRUfvXy5ctszkuXLvFBlh137txhH7roOHDgwNq1a3Uio7i4OCkpiX9QMWHChIKCAh4ZRHTjxo2cnJwGv1b1Q2SAPhAZYHQQGfpr5ZFRVFT00Ucf1fz7mpWV5eDgoFariSgiImLZsmXCwiBBZOTm5g4bNuzMmTNN+QL0UFxcPH/+/BUrVugssNCdO3f69+9//fr1pn1qRAboA5EBRgeRob9WHhmFhYV2dnb8Kt+FtR55eXl9+/atZwalUqlzAE21Wu3g4NDAQhs/RAboA5EBRgeRob9WHhlpaWmffPIJvyomMojo0qVLHh4eBQUFdc0QFBTETu7KIDIAGoTIAKODyNBfa46MlJQUCwsLtqED2ybD3d195cqVfOuHCxcuENHNmzeTaggNDf3yyy+FI8LDV6xfv57vZUqIDAAREBlgdBAZ+mvNkWFpacn213B0dPT29j579qyfnx/fs8PV1ZVt+Llnzx4PATc3t2effdajhvHjxz948ODw4cPswZOTk9Vq9Z49e6KiolasWNG7d++oajdv3pTgiyC9Jo+M9PT0KGh1du7cWeu3G5EBRgeRob9WHhlsgu3CGhAQEB0dzW+teTAupp5tMvLz82UyGTt9vKenZ0JCQlhYWEBAgI+Pz4svvhhQ7dKlS0/80lqyJo+M8PBwE2h1hLtiCSEywOggMvTXViKjT58+8+bNu3LlCr+1nsh47rnnvAWuXbvGb2UH44qLiwsJCeG7mGJ1yZNhkeHt7a2A1uJvf/sbIgNaDUSG/lp5ZLCTevTv33/YsGGZmZlyuZydaYzqjYyePXvy04sMGjSIHdibyc/Pv3DhAjb8bBIsMoQHGQNjZ25ujsiAVgORob9WHhns9KQrVqxgR/y8efPmF198wQ58WVdkvPvuu8IPPNzc3ISRwbDI8PLysrOzs7Ozs7W1ffrpp+0EhAcPbTUQGdAgRAa0JogM/bXyyGATwsOKDxo0qFOnTlR3ZLCzunM1I2PLli1BQUFarfbRo0fFxcXFxcVXr14dMGBAsUBlZaUer6+FQmRAgxAZ0JogMvTX5iKDiPr06UN1RIbwlGaMMDIyMzMtLS2ffvppnYNx1fVbtZVBZECDEBkVFRWFYCTYyafqgcjQXyuPDJVKpVKpli9f3uAJ0ogoPT39nXfe0Zmt5icZOkf8PH/+/JAhQ9h0Tk5Obm5uI1+N0UBkQIMQGSqVSop9eKApCI8HXStEhv6MLzJycnKmTp3K3iLBwcGxdbh//76lpaWrq6urq6uDg4MwMg4ePEhEUVFRMpmMDyYnJ48bN06j0bCrd+7cYYfqqj8yEhISvvjiC37Tnj17QkJC7ty502yvvnnV9cVkQreEIjKgfogMFhk9e/Z0hZYNkSENI4uMe/fuTZkyRUyiqlQqvrokLS1NeIQMmUwWERERGBjIrqampkZERMycOVN4JvTz58/PmTMnIiJi1qxZ/HzrDI+MPXv2dO3aNTw8PELA0dHReP9qNvA1fdbEIwyRAfVBZLDI8PHxaZJHg+aDyJCGkUVGQUGBl5eXyMiIiIio63HCwsL4dEpKSlhYmE5JENHp06fDwsL++usvnXEeGTt27Air4YMPPjDev5oNfE0tTTwWIjKgPogMRIaxQGRIw8gig4ju3LkTLUJhYWEzLcC1a9fS0tLquvXs2bO3bt1qpqdubvV/SYM2BGF1CdQPkYHIMBaIDGkYX2RAgzw9PfPz88vKykaNGtWED4sNP6FBiAxEhrFAZEgDkdHaeHl5HTlypLKysqqqKiUl5csvv2yqR0ZkQIMQGYgMY4HIkAYio07Lli0zNTVt165dhw4dTE1NDb04ovj6+sbExAhHEhISvLy8muTBERnQIEQGIsNYIDKkgchoQK2HFRevrKzs9u3bTbg89SgsLPTz84uPjxcOnjhxYurUqQUFBfo/PiIDGoTIQGQYC0SGNBAZDdAzMtLT052dnZtweeoRHh4eHh5eczwyMlLnEKVPBpEBDUJkIDKMBSJDGq02Mvbu3atUKsvKypRKpVKpTE5O5jft2LGDDbJ/+s+fP69UKm/durV7926tVstuOnLkCJtZGBkPHjxQKpVJSUkqlYrNxo9Km5ubqxRgnxwolcrQ0NB//etfSqXy/PnzfAH4bL///jsRJScnK5XKwsLCrVu3KpXKvXv3Cl/Ivn37lErlpk2b+AhbYKaiooKPIzLA4BAZiAxjgciQRquNDIVCYW5uHiSQlJREROvXrxcO7tq1Kzg42MXF5cqVK7a2tsXFxf7+/tbW1vzgXcLIKCgoGDt2bN++fYWPoNVqi4uLhSO2trYqlYqIgoKCfHx8evfuHRQUdOzYMfYg4eHhwpkTEhLi4uJeffXVKVOm8MGtW7eymWNiYvggCwiVShX0OP6SERlgcIgMRIaxQGRIo9VGBhFZWlpu3ryZTSsUCrlcTkSDBg36+uuvvby8vLy8/v3vf3t4eAQHBysUCiJikZGXl9e3b1/+IDqrSxISEt57770zZ86wq71799ZoNGq12sHBQThPfn4+m665umT79u1ExBbgo48+CggIICIXF5d58+aVlZURkUqlcnFxIaKdO3cuXLgwJyeHiCorK9kdlUpl3759vap16NCBPzIiAwwOkYHIMBaIDGm08sjg08LIiI6OTqh28eJFFhkBAQG//vrrp59+2mBkeHp68qssMsrKyjZt2uRU7fjx43yGWrfJcHJyYs8+e/ZsHhn8AF88MgICAoRHQ2eUSuU333yTIMBvQmSAwSEyEBnGApEhjbYYGdnZ2cLZWGQ4Ozunp6dbWFg8QWQQ0aNHj9KrjRs3Lj09nc1QMzKGDBnCb42Ojn6CyBCe103o3r17P/30Ezv9G5ecnOzj45OXl1fXV0k8RAY0CJGByDAWiAxptOnIOHbs2Pjx47Va7eTJk/ft21dVVaXRaF566SW22oIRExl3794dPHgwH3R1dWXbZFBtkWFjY8On648MrVY7evToU6dOsenXXnuNakSG8DUSjpMBhobIQGQYC0SGNFptZAwZMsTa2vrVV18lokOHDllbW1tbW+/Zs4eI+vXrx65+/vnnbGZ/f/+jR4+y6T59+rCJtWvXWgsQUVZWFptm51f78ssv2dWcnBzhnDpHqjh69Ki1tbVwRYZ1HYqKioqKitj0rFmz2MzDhg2ztrbu3r07v3t4eDi/S2lpqc4LxxE/wYAQGYgMY4HIkEarjYy2bMyYMezcJW5uTfN7k0FkQIMQGYgMY4HIkAYiA8RCZECDEBmIDGOByJAGIgPEapmRkZ+fLzx82Y4dO4qLi4moqKhIuHlKbGzsvXv3dO77xx9/ZGRk6PPsdVm3bh2fPnLkyLVr19h0aWnpli1b6pn50qVLJ06caI5FkgYiA5FhLBAZ0kBkgFgtMzLS0tLYdrIM37A3KyvL0dGRj8fGxv700086m7D4+fnFxMQsXbqUH7m1qSxZsmTZsmVs2tvbOy4ujk3/+OOPNSNDuMFNPXsPGQVEBiLDWCAypIHIALGMOjKIyNbWVjgnVUdGYmLi119/rc8y1PTo0aM1a9awrX15ZLi7u+/bt09nTn9/f36AV0JkGAgiow1CZEgDkQFitbTIcHR0tLe3f+ONNzp37rxo0aKIiAh7e3sLC4s333zT3t7+X//61zPPPGNvb79q1So2v62t7R9//CF8BBYZRHTu3Dnh+Jo1a+wFGrtg7F62trbPPfecvb19165de/fubW9v3759e/6YixYtIqL//Oc/nTp1Ygvs6upKREqlslu3bvo8u2EhMhAZxgKRIQ1EBojV0iIjPz8/Ly8vKSnpk08+KS4ufvjwYV5e3jvvvHP+/Pm8vLyzZ8++//77eXl5JSUlbP579+5VVVUVFBRYVXvqqaeeeeYZNv3SSy+x2aKiooKCgvKqmZqaNnbB8gTmzJljYmJiYmKSlJQkHGcbjri7ux88eDAvL0+tVvfu3fv48eMTJ04UztaxY8cn++IYCiIDkWEsEBnSQGSAWC0tMpi0tLRPP/10+fLl7OAl/+///b9bt24R0fXr1z/55BM2T3l5uUajYcdmZSorK3/++WdTU9Nt27ZVVlYKx9euXRscHMxHLCye5E+jRqNJTEw0NzeXyWRsdUn//v3Nzc3ZQej5bO7u7uxQb1qttlevXgkJCRMnThQ+jrm5+RM8uwEhMhAZxgKRIQ1EBojVYiPDwsIiODg4Nzc3vTa5ubkymczW1tbMzIx9fkBEsbGxvr6+fn5+L7300r59+7RaLRuv5wCpDx484I/JNiBl0zdv3iwsLGTTjx49unr1anp6uq2t7ejRo9kdhRt+2trafvrpp/yYs+7u7tu3b09PT7948aKZmdnYsWPv37+fm5vLnxSRIQ1ERhuEyJAGIgPEaoGRodVqV69ezU/18tZbbzk7Ozs7O7dr145NvPnmm3w7SnaWXSK6f//+ihUrVq9ezbbJmDZt2q5du9g8dUVGYWFhRESEc7XNmzeXlZU5Ozu///779vb2ixcvdnZ2fvHFF5OSksaNG6dzIHlhZBBRZmZmYGAgm3Z3d3dwcHB2dh46dGjv3r2J6NChQ4GBgbxCEBnSQGS0QYgMaSAyQKyWFhmbN29evXr1559/XvN8cnxDiqioKJ3I0Gg0v/zyy4oVK0iw4eePP/6oVCqp7sjIzMxUKBQXLlyIjIyMjIx8+eWX2Tnn0tLSunfvHhUVRUSRkZFXrlzZvn175OM+/PDDadOm6Qyyg2EIV5ewyCCi4ODgcePGsZU+iAxpIDLaIESGNBAZIFZLi4ywsLCwsDC+C2tAQMDIkSNlMplMJmvfvj2bGDFihE5kyGSy9evXsxEeGVT957ye1SUXL16cO3ducHBwcHBwt27deGTofG4RERER/LgBAwZ4eHjoDLKT5dYaGUlJSW+//XZCQgIhMqSCyGiDEBnSQGSAWC0tMhhhZEyePFmpVCqVyvbt27OJSZMm6UQG/7SDHo+MzZs3E9GdO3dCQ0OFi/Ttt98S0dWrV3/66afU1FQ22Ldv37oiQ8e+fftCQkJmzJjBPpnQUWtkENGJEyfu3LlDiAypIDLaIESGNBAZIFbLjwwxq0uE9xVGBhcZGRkUFMSmv/nmmyNHjhBRSkqK8GxzIiPj0KFDMpns9u3bFy5c+Oqrrx49eqQzg7u7e//+/R0dHT/88ENhZHCIDGkgMtogRIY0EBkgVsuPjK5du9rY2NjY2JiYmLAJKysrFhnjxo07duzY66+/3q9fP37fe/fu8aNocMXFxUFBQezux48fZ4OlpaUbN260qWZmZvbyyy/b2Ni8+OKLTz31lI2NTUREhM7jpKamTpw4kZ8w5fbt26+//vqbb74pnMfd3X337t1ZWVlXr14VRsbMmTOPHz8+ZMiQv/76S58vjvQQGYgMY4HIkAYiA8RqgZFhZWUljIytW7dqH7dp0yaZTDZp0qQDBw5UVVVptdq7d++a1uG1115jD1tZWcnuXlVVxZ+L3b0uwoNtEJGpqengwYMrKiqEg1qtNj8/nz3X9OnTSbC6hIiEM1dWVn7yyScXL1584q+MoSAyWmxkHD9+fOzYsfzqW2+9xT/Y27t3L3tDclqtlv84ENGkSZMOHz5cz4PrfNMDAwOFB8vnFi1ag1zUIgAAIABJREFUtHLlSjFLe/369SFDhugMWlpairmvSIgMaSAyQKwWGBlFRUU1fxNJTKPRCM/v6uDgwE54VlpaWlBQUHP+ixcvjhs3TrLFkxgio8VGBhHt2rVLJpM9fPiQiOzs7IqLiysrK48ePTphwgSdOa9fvz5o0CB+1cvLi22JrGPu3Llbt24tKyuzsrKqqqo6fvy4h4cHEclksi5duiQnJ+vML5fL2Wd+dnZ2L774YneBZ555Rri91J9//vnll1/q3P3JjoxXF0SGNBAZIFYLjIyWID4+3tvbu+Z4UlKSs7NzyuOkXzyJITKaLzIuXbrE30hpaWmNum9paSm743fffefv75+SktKzZ8+jR48ePHjwlVde4Q/Lsvj06dMdOnRgI1evXiUiLy+v5cuX1/rs/v7+O3bssLS0/P3330eNGsUGZTIZ26+bKSsrY3ecMmXKjBkz7t27Z2dnV1hYKFxC4TZVWq3WxsaGTd+6dYs/71NPPcWnr1+/3uiv4OMQGdJAZIBYbTky8vPzowWEvx9rjYySkpKVK1e6C3Tu3Fm46Whrhchopsg4efKkj48Pey8NHz7cwcGhUXfPzc0Vvhu7devGTqnj/riTJ08SkbW1Nbvq6Ojo6emZlpY2c+ZMPs+IESPYefvS09PZj0PPnj1NTEzMzc2jo6N///33zMzMkSNHTp06lf+8FBQUsPu+9dZbb7/99pkzZ+zs7NavXy/8mRo+fDiPjG3btk2bNi0nJyclJWX37t38qU1NTfn0pk2b9PySIjKkgcgAsVpgZJSWlsoF/ve//xHRypUr5XI5P/lqk7hx40ZAtVdeeUWlUvGbao2MWbNm2djYCJfthRdemDdvnlwu37BhQxMuWEuDyGimyPD09ExMTGTT2dnZjY0M7sSJE3K5XCaTde3a9ccff6z1Dcm/gwkJCZ6enkFBQZGRkfxWtVrNIuOPP/5gPxHW1tYmJiZmZmYBAQEbNmyIjIwcPHgwu6lz587+/v78vsLVJb6+vgEBARMmTOjVqxebmZ0MeeXKle3bt5fL5cHBwdu3bxcuGFaXGCNEBojVAiNj+vTpEdU+/vhj9p+QUqlctmwZ/7i1ybm6uqpUqpkzZ/r4+Pj4+Hz22Wd2dnZsmn227OPjExwc3KtXL7ZggwYN8vb2ZtOLFy/u27dvMy1YS4DIaI7IiIuLW7BgAT/USnFxcc1drxt09epVHx+fuXPnRkRE3Lhxg22TERERsWTJEh8fnx07dvA5hZFha2sbFBR06dIlfiuPDGbt2rVhYWEWFhbLly/38fFZuXJlZGQkP8WgjY0NPzEQVUeGQqHo0qUL+ziQb7jNKZXKiIiIefPmOTo6spGtW7eyn6+//e1vbGLt2rWNffk1ITKkgcgAsVpgZAi3Nq9rnW6TuHz5cmhoKJtmkfHbb7/FxcXFxcXNmzfv008/ZdNslXZcXFx2dnaXLl1cXFxcXFx69OgxYMAANj106FBERgvUwiNDJpOxw97XpFAoXKoR0fXr19l0TEzMkiVL+LiLi4uXl1dcXNzly5fZHVlkEFFRUVFcXNzChQt3797NbrK2tmZ3dHBwYPtRL1++nH96J4yMtWvXRkRE3L9/38rKSqvVxsXFrVq16s0336wnMuzs7FauXNmjR4+hQ4e6uLh8+OGHzz//PH8JrGYqKiq+/vprvt3o+fPn4x7HD4unD0SGNBAZIFZLi4wPPvjgwoUL/OqdO3f4phJNHhklJSWRkZE///wzVUcGv6nW1SXZ2dn9+vVTqVTTp0+fPXu2qtozzzzDf8u3SogMKSNj06ZNS5Ys4e+u9957T6PRqFSq2bNnd+vWbdWqVSqV6oUXXmBLlZGRIbwvjwwmLy8vJyeHTVtbW7MHXL16taenJxHdvHlz9OjRN2/epMcj49atW/fv3yciKysrNvLgwQOVSjVnzpz9+/ezfVL4fuAHDx7s1q1bQEBAUVGRnZ3dH3/8oVKpdu7cOXjwYP4S2J4v/fv3F3520kwQGdJAZIBYLS0y6tlpvtbIGDBggKWlpaWlJf8YlojGjh1rWa1///5sUC6XWwqwwfLy8sWLF1taWv76668VFRW9evVi47VGRmVlZXFx8a+//jpr1qypU6eyM5UQUbt27T744IMne71GAZEhZWSUlpaWlpaOGjWKvVH5JgsKhWLu3LllZWVEVFRURESWNXTo0KFz5846g3v37qUa22SwaScnp7///e+lpaU8MiIiIvgd27Vrxya++OILqt67xNHRMSsri4hu375taWk5ZswYtrKGiPjeJTVXl/Tp08fExIQ92qRJk4ho2rRpOsv5zTff6P9VRWRIA5EBYhl1ZHzxxRcZGRn3798vLCxMTEx0dXWlxw8rXlpayiJDeFhxEvyLxuaZPn06iwwi6tSp04MHD3Qio6ioqLCwMD093dLS0tPTs7CwcOrUqX/729+Sk5NffPHFJ3ulRgSR0RyRsWDBgsjISL7egSUsVb8hecIKI0Mul9fzgA8fPhw4cODt27drvbXWyCCi/v37CyODP1S/fv3y8vJu3749YMAAPu7h4cG3VOWEG37ykmA6duwoPE6GkJeXV3x8PL+amprKfn71hMiQBiIDxDLqyCCijIwMe3t7Ozu7Xr16sV9SYWFh69atS0tLS0tL4x/P7ty5MygoKK0a/7C3qKhILpdv27aNry5p3769q6urTmR88skndnZ2gwcPTktLUygUdnZ24eHh7NQkTbIiuYVDZEiwd8mxY8dGjx5NRGFhYcLj2YuMjNu3b3/zzTdXrlwZOHBgenp6zRmsra3Zmz8yMlIYGYxOZEyfPt3Ozi45OVm468fdu3e9vb1//fXX8vJy4X1ZZFy/fv3TTz/t0KGD8CbhNlVEVF5enpaWlp2dTYgMI4fIALFaWmSMGjWK/w9HROnp6fw/s5qRcerUKQ8PD41GQ4//kgoNDWVbnI0YMeLo0aNscOvWrXxLtP/+979sMCYmxs/Pj4gWLFiwcePGsrIydtyLmqtL4uLitm/f7uLi8sMPP8TFxfn7+z///PNpaWlubm7CBW6VEBnNFBnh4eFr1qxhmz3yI8bu3r174cKFfHNIc3NzNjFlypRx48bxLZGFMjIy/P39z5w5w666ubnV3I5SuOGnMDKOHj1aWVm5Y8cOX19fPpiamhoXF+fm5jZy5EiWQTdu3AgMDExMTHR0dFy/fn1cXByfmUWGi4tLWlqazj8JPDIOHz4cFxe3bds2FxeXJUuWEJGXl9e8efP4ywwPD0dkGBFEBojV0iKDBB9mpKWlBQYG8t+VNSPD2dmZ/9PGIyM5OTkzM5MNajQadoqy9PR04e9cdkLXu3fvLly4cOfOnWyQn4WVaosMb2/vadOmKRSK0NBQb2/vY8eOsd+qRDR16lSFQqFQKJKSkp74VbdkiIzmO+Ln0qVLvb29dd5s0dHR3nVj+1QzarVaoVAEBQUdO3aMDxYXF3t7e8+cOZO9LdmPA/8Opqenb9y4kc88Z86cVatW8eNenDt3TqFQzJw509vbu7i4uLS0dO7cuTdv3gwJCTlw4ABb4GeeeYZtV6FWqxMSEuRyubu7u7+/P9tKQyEwdOhQFhkBAQHe3t6zZ8/mz+vl5TVs2DD+or744gtEhhFBZIBYLTAyQkND2WF8AgMD+UG7Q0ND/f39O3fuHBAQwA/m8+uvv/7nP/9hM48bN+6VV16Ji4vz8/NzdXXlR9lavXo1EUVGRg4aNIgPyuXyBw8ezJ49W7icGzZs4OdtrxkZAQEBs2bNksvl/FMQHhlsJbqtre2hQ4ee+FW3ZIiMlnnukoCAgNmzZ8vlcmFhcBkZGcOHDx82bBjb9anmKYW5sLAwPn3q1Cm5XK6z00pmZiYrDGbVqlXs3IHZ2dnz58+fO3euXC5n6WNpaSk8Wp2jo2Nd22QcOHCA/zNARGq1eteuXSJfeD0QGdJAZIBYLTAyysvL2TGJT58+zQf37t3Lj1UsPF3I/v37hYcxPnv2rEql4lf5wYgyMzOFs1VVVWk0mlrPDqXRaPz8/GpGRnR0NNtKny1MQkICjwwiKiwsrPUXfeuAyGjWyPj++++FZ+uNi4sTuQIuOjq6/tOoZmRk1Lp9RhO6ceMGO6YnoxMK586du3HjRrMugA5EhjQQGSBWC4wMw6qoqNi5c+e3334r/FBaR3Z29owZMyIjI0tKSqRcNkNBZDRrZPTu3Vt4bCudDT+hURAZ0kBkgFiIjJrKy8v5xhl1uXfvHtvgtC1AZEgWGXv37vX39xceUAsaBZEhDUQGiIXIgAYhMprpYFwmj3NwcIiOjtYZbMJnbAsQGdLA+xLEQmRAg8zNzbt27ZpVm6d/errW8ZZgd8ruT1d82iQPtX///mb6JEOtVvfo0UOr1VZUVOzfv3/atGlFRUUPHjxgt9Zz2BioFSJDGogMEAuRAQ0yNzc3geaJDEdHRxMTk8OHD+fm5k6ZMoUe3yYDkdFYJogMSSAyQCxEBjQIkcE0eWQkJydPnz79mWeeGT16NNsvIysrKzg4mO8LjchoLBNEhiQQGSAWIgMaZG5ubmFhIauN2UdmtY63BJ7TPV///PUmeSgvL6/miAx2WHG24Wf37t2JKDo62s/P7+DBg+xIFYiMxkJkSAORAWIhMqBB2PCzOTb83Lt3b0hIyO3bt1lkREVFXbt2LSAgIDk5OSkpyd/fPzs7G5HRWIgMaSAyQCxEBjQIkdEckZGRkXHr1i2q3oU1Ly/PwcGhW7duzs7Ozs7OXbt2ValUiIzGQmRIA5EBYiEyoEGIDAmOk6HVatMFHB0dERlPAJEhDUQGiIXIgAYhMqQ84iej0WgqKysRGY2FyJAGIgPEQmRAgxAZ0kfG6NGjk5KS/vnPfzbHM7ZiiAxpIDJALEQGNAiR0ayR8dlnnwlPkMaNGjWKH5ULREJkSAORAWIhMqBBiIyWeap3qAmRIQ1EBoiFyIAGITIQGcYCkSENRAaIhciABiEyEBnGApEhDUQGiIXIgAYhMhAZxgKRIQ1EBoiFyIAGITIQGcYCkSENRAaIhciABiEyEBnGApEhDUQGiIXIgAYhMhAZxgKRIQ1EBoiFyIAGITIQGcYCkSENRAaIhciABiEyEBnGApEhDUQGiIXIgAYhMhAZxgKRIQ1EBoiFyIAGITIQGcYCkSENRAaIhciABiEyEBnGApEhDUQGiIXIgAYhMhAZxgKRIQ1EBoiFyIAGITIQGcYCkSENRAaIhciABiEyEBnGApEhDUQGiIXIgAYhMhAZxgKRIQ1EBoiFyIAGITIQGcYCkSENRAaIhciABiEyEBnGApEhDUQGiIXIgAYhMhAZxgKRIQ1EBoiFyIAGITIQGcYCkSENRAaIhciABiEyEBnGApEhDUQGiIXIgAYhMhAZxgKRIQ1EBoiFyIAGITIQGcYCkSENRAaIhciABiEyEBnGApEhDUQGiIXIgAYhMhAZxgKRIQ1EBojVTJERGBgYD62FmZkZIgORYRQQGdJAZIBYzRQZ0MogMkwQGcbABJEhCUQGiNXkkXHq1KlgaHXCw8Nr/XYjMqBFQWRIA5EBYjV5ZECbgsiAFgWRIQ1EBoiFyAB9IDKgRUFkSAORAWIhMkAfiAxoURAZ0kBkgFiIDNAHIgNaFESGNBAZIBYiA/SByIAWBZEhDUQGiIXIAH20qcj4/PPPk6BlQ2RIA5EBYiEyQB9tKjLAKCAyJIDI+P/au9uoKK6DD+CrUkUbjwY9aiItHGOURj1GxEqVGA4RgymakJCKZH1JxIhKFRMV1BVXFrMqpcRs1CJyApKWKlqxKGiQrroxqwIaQGTlxY2ygvJWEHVBWO7z4T7c3szsIilO1fj/nf0wc2eYe2dm2fnvzJ1Z6CqEDOiOZyRkVFZWhsNTwtYzXRiEjO5DyICuQsiA7nhGQgb8nCBkdB9CBnQVQgZ0B0IGPHUQMroPIQO6CiEDugMhA546CBndh5ABXYWQAd2BkAFPHYSM7kPIgK5CyIDuQMiApw5CRvchZEBXIWRAdyBkwFMHIaP7EDKgqxAyoDsQMuCpg5DRfQgZ0FUIGdAdCBnw1EHI6D6EDOgqhAzojic8ZIzSjFr9zWq88OJfr331GkJGNyFkQFfpruucP3cOOBiAF17/xetJDhm192pTClPwwkv8Kq0rfdxvz6cbQgZ01Z3mO/oKPV54/XevC6YLj/stDAD/awgZAAAAIAmEDAAAAJAEQgYAAABIAiEDAAAAJIGQAQAAAJJAyAAAAABJIGQAAACAJBAyAAAAQBIIGQAAACAJhAwAAACQBEIGAAAASAIhAwAAACSBkAEAAACSQMgAAAAASSBkAAAAgCQQMgAAAEASCBkAAAAgCYQMAAAAkARCBgAAAEgCIQMAAAAkgZABAAAAkkDIAAAAAEkgZAAAAIAkEDIAAABAEggZAAAAIAmEDAAAAJAEQgYAAABIAiEDAAAAJIGQAQAAAJJAyAAAAABJIGQAAACAJBAyAAAAQBIIGQAAACAJhAwAAACQBEIGAAAASAIhAwAAACSBkAEAAACSQMgAAAAASSBkAAAAgCQQMgAAAEASCBkAAAAgCYQMAAAAkARCBgAAAEgCIQMAAAAkgZABAAAAkkDIAAAAAEkgZAAAAIAkEDIAAABAEggZAAAAIAmEDAAAAJAEQgYAAABIAiEDAAAAJIGQAQAAAJJAyAAAAABJIGQAAACAJBAyAAAAQBIIGQAAACAJhAwAAACQBEIGAAAASAIhAwAAACSBkAEAAACSQMgAAAAASSBkAAAAgCQQMgAAAEASCBkAAAAgCYQMAAAAkARCBgAAAEgCIQMAAAAkgZABAAAAkkDIAAAAAEkgZAAAAIAkEDIAAABAEggZAAAAIAmEDAAAAJAEQgYAAABIAiEDAAAAJIGQAQAAAJJAyPiPe/futbe3i8vv379vtfwJ1Nzc3NTUZLFY7t6928RpaWnp5E9aW1u7X/WDBw8ePHjARpuamthwS0sLP+m/q72trc1sNncyQ0tLi2BRD/2Tn0qwjmL8W+WhtQvW3WKx3L9/Xzxbe3v7vXv3uthC8Zy2trBgc7W3t1utnTaMX5HO/x34/d5J7QDwjEDI+A8XFxfBRyTl7u6u0+mKOTU1NVaXUFdXVyxy48YNiRtOzGYzrWvNmjUuLi6FhYXDhg1z6TBs2DClUmnrb1UqVWJiYnNzcyfLLy4ufmgbvv76661btzY2NtJROzs7OtDQ0KBUKlNTU63+VWho6OHDhx+6cEJIXl5eUFBQdXW1rRliYmLi4+P5I6VWq5XL5YLZ2traxPtIwNb+jY6O1mg0nTTSw8PDaDTSYZ1OJ66dENLc3FxRUUEIWb16dUpKCiGkrKyMEFJaWvrb3/62srJSMH9NTY2bmxshpL6+/qHvrpEjRwoO6iEhIenp6eJmhIeHJycns1Gj0ejh4WF1pS5duvTOO++wUXd396qqKhsbgNjb2/Ojn332WWJi4qONegDwFHnmQsa5c+cyO5w/f56fZDVkXLp0aeHChT4dJk2aNHz4cP7TmRcdHe3i4uLDee2113x8fKRamQ4lJSU+Pj4uLi6xsbG0ZNiwYWxqfHy8IGRk/tjvfve7nTt38iWXL1/m55fJrL9PsrKy+NH4+PgdO3b8+9//Jh0ho66uLiYmRrC5+IreeeediIiITBF63BU4deqUQqG4fv26re0QEBCg0+nYqNWQUVNTM2DAAB8Rb2/vfv360eFO9m8nISM/P/+jjz66desWHbUVMsrLy5cuXXrlyhUaMvR6vb+/PyGktLTUwcHhT3/6k7jBNGTExsaK313Tp09nc54/f37OnDltbW38n3cxZOzfv//TTz8Vz9bS0rJv377Nmzezkq6EjIaGBv7d9cUXX2RmZvLvlpKSEvFOZzqJkgDwdHlSQsaZM2fiO9DPvmvXrtHRa9euPcKKtm7dGhQUFBQUNGfOHE9PT36SOGScO3du4sSJ69atY2375JNPpkyZQodNJpNg4dHR0XPmzInnqFQqccjgZ7hw4cKjWrXY2Nguhoy+ffsGdUpwlJXJZPHW9OnTZ9++fYSQH374gZZMmjSJbq6ePXvGx8evWbOGba74+HiaP1gt7u7u7u7uVhtw9OhRrVYrrvG9994LDAzkSw4ePMjaGRcXV1paykZthQx6zBYwm81DhgzJyMgQlCckJLC63n//fVu15+bmuru7h4WF0XJCiE6nc3d352dml1ry8/M3bNgwY8aMjz/+ODQ0tL6+nhBSWloqeEOmpqbGx8fHxsY6OzufPHmS379UcXExHzI8PT3p6t+9e5dV6uXl9cc//pEOJyYm1tfX0+GZM2cGBQWx1g4aNIhvKj3XQgiJjY391a9+RQsLCgoIIe7u7vSkEXX69GnC/f/+4he/iI+P//zzz994441x48axHWpvb798+XLWVIVC4enpaXXXv/LKK1ZTEQA8jZ6IkKHVapVKparD4MGDCSFXrlxRqVRTpkyxdaa9m4xGo6en5/fff6/oMGjQoLVr1yoUii+//JIQcvbsWaVSOWbMmCVLlqhUqk2bNjk4OLBGTpgwQfA9nhASHR391ltvqTgrV64UhwyVSrVmzRonJyeVSpWdnd3NFbl37x5tv7e3t7e3t0KhMJlMnYcMOrWgoEAh8sUXX4irkMlkKhuio6MJIQaDgS987rnnZDIZv7mo2tpafrHioyYvLS2N/9vFixePGzdO3IC4uDiDwcAOS3v27GlsbKTrMm/evLFjx7JVo9+PWcg4e/Ysf9rDbDY7ODh8/fXXgmbY2dmxunx8fHx9fdnoxo0bx44dS2dTKBT+/v60XCaTNTY2bty4kW/n0KFDm5qazGYzbcybb74pk8lkMtnChQsVCoXFYlm2bJmTkxNrbVlZ2e7du1Uq1bp164YPH37w4MHY2Fi6f5ng4GAWMg4dOrR58+b6+vqIiIjGxkZW7+TJk+VyOR3etm1bdXU1HZ42bRprsEKh4Js6adKkzMxMuth+/frRQl9f3+jo6JSUlMjISDbnhx9+uHDhQkLI0aNHaQndXAkJCVeuXFEqlWfPniWE7Nq1S6VS8VtVoVDYOl1k69QLADyNnoiQoVKp6NcpioYMKjQ09NGGjMjIyLq6OtIRMq5du5bc4cUXX9y7d29ycvKxY8cIIcXFxUVFRf7+/j4+PnK5fO7cuf3795d3GDFihNWQ4ebmJufMmjXL6uWSiooKW5fAf6rm5mbaflpjcnJybW3tsGHDWBvc3d2thgyj0ZicnOzt7R0aGkqXYG9vb/Xz3dblErEvv/xSLpcnJCT06tUrLi5OLpfHxcVZnfP8+fMbNmxgvT2Cg4M7X7JOpwsICLA6yWQybdmy5Z///CchxMPDo6Kigq7Ohg0bpk6dyvYv7S/CQkZxcbFCoZDL5fRU2fz589PS0sQLZ51LiOhySVNTEx8y2FFTJpOJ9+/YsWNpD1zamPnz59OQoVQqk5OTW1tbhw4dSif5+/sHBQWxSxL85RK6f5OTk/v3708HTp48SQhJTU0dMWKEt7e3XC6n55YYq8fs7OzsMWPG0AavWLEiOTm5pqYmMjKSTg0ODmYhg/0zajSa6Ohof39/vV7PlpOVlUVDBmNvb9/Q0EDfeK6urvTfYdCgQf7+/nK5fM2aNeLNJYCQAfBz8vhDRmZmplKp5Pu7ffvtt2z4kYeMixcvzp49m3SEDH6S1T4Z/v7+O3fu1Gq1vXv31nZYuHBheHg4PcvNu3HjhlYkPz9f3IxHGDIonU43cuRIdmLg7NmzfBtYb0SKP89RUlISHBxcWlrq6+t75swZqwuXyWSeNrB5/vGPf3h6emo0Gq1W29LSYmdnd//+fa1WGxsb6+npefToUX6BBoNhzJgxoaGhrIRPlrZWcMiQIXzV/M7SaDRqtXrz5s1JSUmsE+tDL5eUlZVptdrAwMC6ujpBj0VGEDJefvlldv6jk5Axe/bsixcv8suhIYMOf/fdd2vXrp0zZ05ERIRcLvf09GxtbR05ciSdKsjctMGnTp3i969gc127do3u6OHDh9OOn0VFRXQrDR8+fNy4cYKdtXv3bplM9pvf/KagoOC7774jP+74aStkvPTSSzt37mR9e4mNkFFVVTV69GjxP4JWq2W9oBAyAJ4Rjz9kfPXVV53c+yAOGadOnXLuwL5UVVVVOXPYNQi+cNeuXbSwoqLC2dmZ9l87fPgw62pnNWRUV1c3NzdPmjTp6tWrr7/+Oi1UKpWDBw9mYci5a/jbKMQhY8aMGXS2t956ixCSlJRER+mxig7Tr/IajYYtkx1QDx8+TK9QZGRkzJo1S1w7vxn5kEEIuX379vTp0wsLC23tBaMN/fr1I4QUFRU5OzuvWrXKaDTevXuX/gk7Njc1NRmNxuXLl/PZMScnZ+bMmdHR0ax5PXv2ZMNhYWHiNuh0ulmzZrGqR40aRXt4UHfu3GloaOhix09Bn4zKykpXV9cffvjB6rqzFcnIyAgLCzMajXK5vKioiIhCxuDBg2n76ZmMnJwcPkWxkFFUVDR37ty6ujra8bOystJoNDo5OXUSMnr37r1gwYKIiAgHB4dONldAQADbyM3NzeL9RSdlZ2evWLFi6dKlsbGxs2bNoqdM+O6cfMhgFTk4OKxfv/7evXt+fn6sY6bVkOHq6kq/M+zZsychIcHqVkXIAHhGPBEhQ6FQ2JoqCBkGg2HmzJmtHby8vOixwcnJiRUuW7aMfkgNHjyYFe7cuVOtVrPltLa2Ojs7E0La29vpdX1iI2T84Q9/sLOzM5lMZrO5R48eb775ZlJSklKpbG1tZU8LaBUZP358VVWVoJB/uoAgZLz99tv5+fl0try8vLfffttisaxdu/avf/0r/Suz2ezk5NTW1paUlKRQKNgyn3vuOUJIbm6un59fTExMTEzM+++/f/78+dbW1qamptGjR1utfdiwYefOnbPj9OjRgx9dtmxZV/Ydrb29vb21tdVisfDyYes2AAALmElEQVST+BMAhBCLxcIaUFVV1atXL39/f4vFwprH7yzBoujmmjZtGn/fxNixY/mQQdGQ4eTkRNeiV69egvVqamoSh4zJkyebTCa6LmJsRVJTU1evXk0IaWtrc3V1rampEYSMpKQk2n56dam9vX3fvn3r169nDabvrvb2droi7BZWQkhra6vBYHjjjTfo/uW3gJ2d3cSJE9va2mJjY2NiYmxtro8++ig7O7srD3RJT08PDg6md5fQq0uEEGdn52+//Xb+/PlEdCaD1rJjxw7a/6atrW348OF0qiBkjB49WiaTsXtoo6OjbfW5QcgAeEY8ESHjJ53JMJvNO3fudHR0dHR07NOnD/1+5urqWtGBBYVXXnmFFfKXNiorKx0dHdnlEpVK9fzzz2u1Wj5kHD9+nFaxb9++ioqK8ePHjxgxQqfT9enTZ8mSJfwZYx77VH311Vfz8/Ot1k6Jz2TcunXLxcXF0dFx6NChvr6+tDAgIICereGP2Y2NjcuWLaPN69Gjh8ViycrKWrRoEetHefv27YqKirKyspdeeom1gX9Mk+BMBm0wPWYbDAb27b+urq7CGtoz4MGDB/TAfPnyZUcRmUwmLiwrKzOZTBMmTMjJyaH3bTKdXy7Jy8vz8/PjS/iQYTabKyoqli1bxo7ZhJC2trYjR46sWLFCsCg+ZDQ0NMybN49ezzKbzc7OzuKbJ+3s7Nra2o4fP/7xxx8LGtzJ5RI6cOjQoQEDBuzevZt0hIzGxka6KQYOHDhgwABHR8fevXu/8MILhBCj0Th79uy//OUv27dvp3/++uuvOzo68n0ylEol3QUODg50gDZ4+/bt/HYmhOj1+n79+vGFPXv2pPt3wYIFhLuFtbKykp56qaio2LFjB+1PaqtPBh2eMGECfUOykLFmzRr6P2Vvb0+rGzRoUP/+/elw7969X3zxRUdHR3YuECED4Bnx+ENGRkaGUqlkTxcghJw7d44NC0LG/fv3ExIStm7dSkc9PT1pyKiurvbosH37dtq1kxDCCj/99FN2Vx79FK6qqpo/f/7Vq1cTExNpjz/BmYybN2/qdLrg4GAPD4/MzEytVjtx4sTp06fTBt++fVu8LnzImDx5MqudfTozgpBRVFT03nvv0dovXbokCBkXLlxgn863b9+OjIxkn8K0n92iRYsId7PGokWLPDw8pkyZ0rdvX9YG/ubMTkIGLzIy0sO28vJyW9/+z58/P23atNzcXPEkLy8vQshPDRl0l/H4kHH27FkPDw9HR0c+ZIj73FDsmH3z5s1169ZptVpa3tLSMnHiRDc3N/4mWEKInZ1dZmamIGEQQn7/+98/NGQQQpKTk+m7i++TUVdXt2rVqujoaIPBMHfuXJZsaHcfWw2OjY2VyWQuLi5sF7i6uvK3sPL0er2gn+zAgQP5URYy/Pz82AJHjRrVlZBBCKFvSKuXSwghTU1NKpWKnvghhLi5uQmeb6ZQKDZu3Kiz5t1330XIAPjZePwhgxCiVCrZRegDBw4sXryYTRKEjOLiYv5mDRYyjhw5wgrZN6FDhw6xwt27d9PLJSdPnmQfi4Jr9oKQkZGRERAQEBMTk5KSsmDBgnnz5pWWltLP9NTU1G3btqWkpKSkpLBz+Ddu3FCpVFFRUSaT6dVXX7X11EhKEDJ8fX1Zlwg+ZOzYsWPXrl3857jg6hLfXVFwR6jZbHZxcbFaexdDxkNZDRlZWVkLFixoa2tbtGiRrRt0f1LI2L9/v/jyjfhySXh4OAsZ7e3tCQkJ7BFSFy5cYD2L6THbZDJFRUUJDmalpaVDhw4V3A5jZ2e3ZMkSqw0ThIzly5fTt4TVm3H4kJGXlxcQEKBSqaZMmcL6FTU1NWk0mrVr19LHUTC0wTdu3IiKiho1apTg30EQMo4ePUo3QtdDBk+n0+3fv58PGf3796cr9eGHH4qzsq2QUV5eHhAQoFAo6N8GBwffuXOHn02hULi7uwdY8/LLLyNkAPxsPBEhIysra/PmzWq1Wq1Wh4eH00KDwaBWq6dOnfrBBx+o1Wr6uOjq6mqFQqHuMGLEiLCwMIvFMmDAAFYYERFBb4wcOHAgK9y8ebNWqz1y5MiGDRsaGhpoFeXl5X//+99ZMwQhIycnR61Wb9y4MTw8nH5EspBBCDlw4ICzs/OSJUvoFeibN29GRkYeO3YsPT09MjLyhRde+EkhIzExccuWLbSpK1ascHFx+eabb+gkd3d3dg6GEJKbm7tp0ya2XnZ2djt27KCTuhgytm3bFhUVJSjsesjQ6/W0L+revXvZzmLoFqabq7a2lu4svjMmRUMG3cLUL3/5SzWHPl+BELJr1y6+Fr1en5eXRx4WMtRqNTvdRQg5ePAge0pHTU2No6PjvHnzpk6dqv6x1atXjxw5UtBgQecSniBkzJo1Kzw8PDw8nA8ZdHOlpqauX7+e/YJMWVmZWq3etGlTeHh4VFTUnTt3LBbLli1b4uLivvrqKy8vL7Vazfpp0pCRmpoaGhoqztz0DXn69Gm6CuvXr6ebS6/Xjx8/nl87we0zVkPG5cuXT58+zYeMvn370pXy9vbmQ8a2bdvq6+tVKtWBAwf4JfC1nDlzxs3N7d13342KihL8MAoulwA8I56IkEEIyc7O1mg0Go2GnRgoKyvTcNjPH1y/fl3zYxaLhR9lXwT37NnDCulZ8ePHj4t/G4IQkpKScuXKFUHI+P777zUaDXu+dWhoKB8yCCFpaWk0rzQ2Nq5evZp9Lh87dkyj0axcuTLkxy5cuPD555/TSzniPhl/+9vf+LWgD1IkhKSmpgq6o+bk5PBz7t27l5bTkLF3715aXXBw8PPPP883oKSkhIiOmgcOHMjPz+96yMjLy1MoFCEhITExMfyvhZ0+fTokJOSzzz7jnzltMpk0Go1SqaQNYBfFaMigW9iqnJycxMTEkJCQP//5z3wvSL52we+tsJChUCh69uwp2Pi//vWvafQ0m822KmX4583bChlhYWG2LpdouGdp0AZv3bqVRpz79++HhISEhYVpNBqa1ej+DQkJoc+3KC4u9vX1DQwMpD9KEhoaWlNTM2TIkHXr1p05cyY0NNTHx4et1AcffEDfkHq9nracBWi9Xj9x4kR+pfr27SvYXOLDvMFgoI/FY89uZ2eYCgoK+JtyNRrNqlWr+CeLaDSa6upqFjIuXboUEhISGRlZXl6+f//+lStXfvLJJ2xmvV5vMBisbtjTp08L7rgGgKfXkxIyHq+CgoKlS5fSZyLZmictLS0wMJB/EhHT3NzM359JnThxIv3HTCaTp6enl5eXr6/vnDlz2Jf1R4WGjNzc3HQbamtrFy9eTB9axRQWFoaEhCQmJnb++6K8goKC9PR0dgK8vLzc19c3LCwsPT395s2b4vmvXr06Y8aMqKgolpYaGhqs9tjgXbx4MT09XfzToIWFhXztDAsZJ0+eFK+7q6trV37mTcxWyDhx4oSfn9+pU6foqMFgED9mniooKGDp6sGDB+np6eJnyfPPESkpKWHH+IyMDH9///T0dLq5QkNDw8PD2Urt3r3bVp+M+vp6esqHOX78OD9aXFxstcElJSX83bwnTpywuvz29vZ//etffIlerw8MDExLS6uvr/f19V2xYkV6ejr7TYATJ07Y6sEDAD9jCBn/z2g0dv5LpO3t7VevXu1mLdeuXSssLCwsLLT1Na47amtrBc/tFrt69ar4Lsfr169353cyzWZzYWGh1VNEjMlksvoLt4/QrVu32Pd4sYfuX1sEvxXHo0/LkBqfjSorK/k7m+jDMP4Hbegi+u5qbW0tLCwU/47d/2ZzAcATBSEDAAAAJIGQAQAAAJJAyAAAAABJIGQAAACAJBAyAAAAQBIIGQAAACAJhAwAAACQBEIGAAAASAIhAwAAACSBkAEAAACSQMgAAAAASSBkAAAAgCQQMgAAAEASCBkAAAAgCYQMAAAAkARCBgAAAEgCIQMAAAAk8X+EAcW7raHJOAAAAABJRU5ErkJggg==" alt=""></span></p>
<p><strong>ã€€ã€€JVMåŠ è½½classæ–‡ä»¶çš„åŸç†æœºåˆ¶</strong></p>
<p><span data-mce-mark="1">ã€€ã€€1. Java ä¸­çš„æ‰€æœ‰ç±»ï¼Œå¿…é¡»è¢«è£…è½½åˆ° JMV ä¸­æ‰èƒ½è¿è¡Œï¼Œè¿™ä¸ªè£…è½½å·¥ä½œæ˜¯ç”± JVM ä¸­çš„ç±»è£…è½½å™¨å®Œæˆçš„ï¼Œç±»è£…è½½å™¨æ‰€åšçš„å·¥ä½œå®è´¨æ˜¯æŠŠç±»æ–‡ä»¶ä»ç¡¬ç›˜è¯»å–åˆ°å†…å­˜ä¸­ã€‚</span></p>
<p><span data-mce-mark="1">ã€€ã€€2. Javaä¸­çš„ç±»å¤§è‡´åˆ†ä¸ºä¸‰ç§ï¼š</span></p>
<p><span data-mce-mark="1">ã€€ã€€a) ç³»ç»Ÿç±»</span></p>
<p><span data-mce-mark="1">ã€€ã€€b) æ‰©å±•ç±»</span></p>
<p><span data-mce-mark="1">ã€€ã€€c) ç”±ç¨‹åºå‘˜è‡ªå®šä¹‰çš„ç±»</span></p>
<p><span data-mce-mark="1">ã€€ã€€3. ç±»è£…è½½æ–¹å¼ï¼Œæœ‰ä¸¤ç§ï¼š</span></p>
<p><span data-mce-mark="1">ã€€ã€€a) éšå¼è£…è½½ï¼Œç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å½“ç¢°åˆ°é€šè¿‡ new ç­‰æ–¹å¼ç”Ÿæˆå¯¹è±¡æ—¶ï¼Œéšå¼è°ƒç”¨ç±»è£…è½½å™¨åŠ è½½å¯¹åº”çš„ç±»åˆ°jvmä¸­ã€‚</span></p>
<p><span data-mce-mark="1">ã€€ã€€b)&nbsp;æ˜¾å¼è£…è½½ï¼Œé€šè¿‡ class.forname() ç­‰æ–¹æ³•ï¼Œæ˜¾å¼åŠ è½½éœ€è¦çš„ç±»ã€‚</span>ã€€ã€€</p>
<p><span data-mce-mark="1">ã€€ã€€4. ç±»åŠ è½½çš„åŠ¨æ€æ€§ä½“ç°</span></p>
<p><span data-mce-mark="1">ã€€ã€€ä¸€ä¸ªåº”ç”¨ç¨‹åºæ€»æ˜¯ç”±nå¤šä¸ªç±»ç»„æˆï¼ŒJava ç¨‹åºå¯åŠ¨æ—¶ï¼Œå¹¶ä¸æ˜¯ä¸€æ¬¡æŠŠæ‰€æœ‰çš„ç±»å…¨éƒ¨åŠ è½½åå†è¿è¡Œï¼Œå®ƒæ€»æ˜¯å…ˆæŠŠä¿è¯ç¨‹åºè¿è¡Œçš„åŸºç¡€ç±»ä¸€æ¬¡æ€§åŠ è½½åˆ° JVM ä¸­ï¼Œå…¶å®ƒç±»ç­‰åˆ° JVM ç”¨åˆ°çš„æ—¶å€™å†åŠ è½½ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯èŠ‚çœäº†å†…å­˜çš„å¼€é”€ã€‚å› ä¸ºjavaæœ€æ—©å°±æ˜¯ä¸ºåµŒå…¥å¼ç³»ç»Ÿè€Œè®¾è®¡çš„ï¼Œå†…å­˜å®è´µï¼Œè¿™æ˜¯ä¸€ç§å¯ä»¥ç†è§£çš„æœºåˆ¶ï¼Œè€Œç”¨åˆ°æ—¶å†åŠ è½½è¿™ä¹Ÿæ˜¯ Java åŠ¨æ€æ€§çš„ä¸€ç§ä½“ç°ã€‚</span></p>
<p><span data-mce-mark="1">ã€€ã€€5ï¼Java ç±»è£…è½½å™¨</span></p>
<p><span data-mce-mark="1">ã€€ã€€Java ä¸­çš„ç±»è£…è½½å™¨å®è´¨ä¸Šä¹Ÿæ˜¯ç±»ï¼ŒåŠŸèƒ½æ˜¯æŠŠç±»è½½å…¥ JVM ä¸­ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ JVM çš„ç±»è£…è½½å™¨å¹¶ä¸æ˜¯ä¸€ä¸ªï¼Œè€Œæ˜¯ä¸‰ä¸ªï¼Œå±‚æ¬¡ç»“æ„å¦‚ä¸‹ï¼š</span></p>
<p><span data-mce-mark="1">&nbsp; &nbsp; &nbsp; Bootstrap Loader&nbsp; - è´Ÿè´£åŠ è½½ç³»ç»Ÿç±»&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - - ExtClassLoader&nbsp; - è´Ÿè´£åŠ è½½æ‰©å±•ç±»&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - - AppClassLoader&nbsp; - è´Ÿè´£åŠ è½½åº”ç”¨ç±»</span></p>
<p><span data-mce-mark="1">ã€€ã€€ä¸ºä»€ä¹ˆè¦æœ‰ä¸‰ä¸ªç±»åŠ è½½å™¨ï¼Œä¸€æ–¹é¢æ˜¯åˆ†å·¥ï¼Œå„è‡ªè´Ÿè´£å„è‡ªçš„åŒºå—ï¼Œå¦ä¸€æ–¹é¢ä¸ºäº†å®ç°å§”æ‰˜æ¨¡å‹ã€‚</span></p>
<p><span data-mce-mark="1">ã€€ã€€6. ç±»åŠ è½½å™¨ä¹‹é—´æ˜¯å¦‚ä½•åè°ƒå·¥ä½œçš„</span></p>
<p><span data-mce-mark="1">ã€€ã€€å‰é¢è¯´äº†ï¼ŒJavaä¸­æœ‰ä¸‰ä¸ªç±»åŠ è½½å™¨ï¼Œé—®é¢˜å°±æ¥äº†ï¼Œç¢°åˆ°ä¸€ä¸ªç±»éœ€è¦åŠ è½½æ—¶ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯å¦‚ä½•åè°ƒå·¥ä½œçš„ï¼Œå³ Java æ˜¯å¦‚ä½•åŒºåˆ†ä¸€ä¸ªç±»è¯¥ç”±å“ªä¸ªç±»åŠ è½½å™¨æ¥å®Œæˆå‘¢ã€‚</span></p>
<p><span data-mce-mark="1">ã€€ã€€åœ¨è¿™é‡ŒJavaé‡‡ç”¨äº†å§”æ‰˜æ¨¡å‹æœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶ç®€å•æ¥è®²ï¼Œå°±æ˜¯&ldquo;ç±»è£…è½½å™¨æœ‰è½½å…¥ç±»çš„éœ€æ±‚æ—¶ï¼Œä¼šå…ˆè¯·ç¤ºå…¶Parentä½¿ç”¨å…¶æœç´¢è·¯å¾„å¸®å¿™è½½å…¥ï¼Œå¦‚æœ Parent æ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆæ‰ç”±è‡ªå·±ä¾ç…§è‡ªå·±çš„æœç´¢è·¯å¾„æœç´¢ç±»&rdquo;ï¼Œæ³¨æ„å–”ï¼Œè¿™å¥è¯å…·æœ‰é€’å½’æ€§ã€‚</span></p>
<p><strong>ã€€ã€€=================================
</strong></p>
<p>ã€€ã€€èµ„æ–™å‚è€ƒ:</p>
<p>ã€€ã€€å¤šè°¢&nbsp;<a href="http://samuschen.iteye.com/" target="_blank" rel="noopener">samuschen</a>&nbsp;çš„èµ„æ–™è´¡çŒ®ï¼Œ<a href="http://samuschen.iteye.com/blog/1119539" target="_blank" rel="noopener">http://samuschen.iteye.com/blog/1119539</a></p>
<p>ã€€ã€€è½¬è‡ªï¼š<a href="http://kb.cnblogs.com/page/167539/" target="_blank" rel="noopener">http://kb.cnblogs.com/page/167539/</a></p>
<p><strong>ã€€ã€€=================================</strong></p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> JVM </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[Java]Stackæ ˆå’ŒHeapå †çš„åŒºåˆ«ï¼ˆç»ˆç»“ç¯‡ï¼‰[è½¬]]]></title>
      <url>/2012/12/26/Java-Stack%E6%A0%88%E5%92%8CHeap%E5%A0%86%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%88%E7%BB%88%E7%BB%93%E7%AF%87%EF%BC%89-%E8%BD%AC/</url>
      <content type="html"><![CDATA[<div>é¦–å…ˆåˆ†æ¸…æ¥šStackï¼ŒHeapçš„ä¸­æ–‡ç¿»è¯‘ï¼šStack&mdash;æ ˆï¼ŒHeap&mdash;å †ã€‚</div><br><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åœ¨ä¸­æ–‡é‡Œï¼ŒStackå¯ä»¥ç¿»è¯‘ä¸º&ldquo;å †æ ˆ&rdquo;ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥æŸ¥æ‰¾äº†è®¡ç®—æœºæœ¯è¯­é‡Œé¢å †å’Œæ ˆå¼€å¤´çš„è¯è¯­ï¼š</div><br><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>å †å­˜å‚¨ï¼š heapstorage&nbsp;&nbsp;&nbsp; å †å­˜å‚¨åˆ†é…ï¼š heapstorage allocation&nbsp; å †å­˜å‚¨ç®¡ç†ï¼š heap storage management</strong></div><br><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>&nbsp;æ ˆç¼–å€ï¼š stack addressing&nbsp; &nbsp;æ ˆå˜æ¢ï¼šstack transformation&nbsp; æ ˆå­˜å‚¨å™¨ï¼šstack memory&nbsp; æ ˆå•å…ƒï¼š stack cell</strong></div><br><div>&nbsp;</div><br><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æ¥ç€ï¼Œæ€»ç»“åœ¨Javaé‡Œé¢Heapå’ŒStackåˆ†åˆ«å­˜å‚¨æ•°æ®çš„ä¸åŒã€‚</div><br><div>&nbsp;</div><br><div><br><table border="1" cellspacing="0" cellpadding="0"><br><tbody><br><tr><br><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><br><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Heap(å †)</td><br><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Stack(æ ˆ)</td><br></tr><br><tr><br><td>&nbsp;JVMä¸­çš„åŠŸèƒ½</td><br><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å†…å­˜æ•°æ®åŒº&nbsp;&nbsp;&nbsp;&nbsp;</td><br><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å†…å­˜æŒ‡ä»¤åŒº</td><br></tr><br><tr><br><td>&nbsp;å­˜å‚¨æ•°æ®</td><br><td>&nbsp;&nbsp;&nbsp;&nbsp; å¯¹è±¡å®ä¾‹(1)</td><br><td>&nbsp;åŸºæœ¬æ•°æ®ç±»å‹, æŒ‡ä»¤ä»£ç ,å¸¸é‡,å¯¹è±¡çš„å¼•ç”¨åœ°å€(2)</td><br></tr><br></tbody><br></table><br></div><br><div>1. ä¿å­˜å¯¹è±¡å®ä¾‹ï¼Œå®é™…ä¸Šæ˜¯ä¿å­˜å¯¹è±¡å®ä¾‹çš„å±æ€§å€¼ï¼Œå±æ€§çš„ç±»å‹å’Œå¯¹è±¡æœ¬èº«çš„ç±»å‹æ ‡è®°ç­‰ï¼Œå¹¶ä¸ä¿å­˜å¯¹è±¡çš„æ–¹æ³•ï¼ˆæ–¹æ³•æ˜¯æŒ‡ä»¤ï¼Œä¿å­˜åœ¨stackä¸­ï¼‰ã€‚<br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp; å¯¹è±¡å®ä¾‹åœ¨heapä¸­åˆ†é…å¥½ä»¥åï¼Œéœ€è¦åœ¨stackä¸­ä¿å­˜ä¸€ä¸ª4å­—èŠ‚çš„heapå†…å­˜åœ°å€ï¼Œç”¨æ¥å®šä½è¯¥å¯¹è±¡å®ä¾‹åœ¨heapä¸­çš„ä½ç½®ï¼Œä¾¿äºæ‰¾åˆ°è¯¥å¯¹è±¡å®ä¾‹ã€‚</div><br><div>&nbsp;</div><br><div>2. åŸºæœ¬æ•°æ®ç±»å‹åŒ…æ‹¬byteã€intã€charã€longã€floatã€doubleã€booleanå’Œshortã€‚<br>&nbsp;&nbsp;&nbsp; å‡½æ•°æ–¹æ³•å±äºæŒ‡ä»¤.</div><br><div>&nbsp;</div><br><div>&nbsp;=======================&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><br><div>&nbsp; å¼•ç”¨ç½‘ä¸Šå¹¿æ³›æµä¼ çš„&ldquo;Javaå †å’Œæ ˆçš„åŒºåˆ«&rdquo;é‡Œé¢å¯¹å †å’Œæ ˆçš„ä»‹ç»ï¼›</div><br><div><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; â€œJava çš„å †æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶æ•°æ®åŒº,ç±»çš„(å¯¹è±¡ä»ä¸­åˆ†é…ç©ºé—´ã€‚è¿™äº›å¯¹è±¡é€šè¿‡newã€newarrayã€anewarrayå’Œmultianewarrayç­‰æŒ‡ä»¤å»ºç«‹ï¼Œå®ƒä»¬ä¸éœ€è¦ç¨‹åºä»£ç æ¥æ˜¾å¼çš„é‡Šæ”¾ã€‚å †æ˜¯ç”±åƒåœ¾å›æ”¶æ¥è´Ÿè´£çš„ï¼Œå †çš„ä¼˜åŠ¿æ˜¯å¯ä»¥åŠ¨æ€åœ°åˆ†é…å†…å­˜å¤§å°ï¼Œç”Ÿå­˜æœŸä¹Ÿä¸å¿…äº‹å…ˆå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ†é…å†…å­˜çš„ï¼ŒJavaçš„åƒåœ¾æ”¶é›†å™¨ä¼šè‡ªåŠ¨æ”¶èµ°è¿™äº›ä¸å†ä½¿ç”¨çš„æ•°æ®ã€‚ä½†ç¼ºç‚¹æ˜¯ï¼Œç”±äºè¦åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ†é…å†…å­˜ï¼Œå­˜å–é€Ÿåº¦è¾ƒæ…¢ã€‚â€</strong></div><br><div><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &ldquo;æ ˆçš„ä¼˜åŠ¿æ˜¯ï¼Œå­˜å–é€Ÿåº¦æ¯”å †è¦å¿«ï¼Œä»…æ¬¡äºå¯„å­˜å™¨ï¼Œæ ˆæ•°æ®å¯ä»¥å…±äº«ã€‚ä½†ç¼ºç‚¹æ˜¯ï¼Œå­˜åœ¨æ ˆä¸­çš„æ•°æ®å¤§å°ä¸ç”Ÿå­˜æœŸå¿…é¡»æ˜¯ç¡®å®šçš„ï¼Œç¼ºä¹çµæ´»æ€§ã€‚æ ˆä¸­ä¸»è¦å­˜æ”¾ä¸€äº›åŸºæœ¬ç±»å‹çš„å˜é‡ï¼ˆ,int, short, long, byte, float, double, boolean, charï¼‰å’Œå¯¹è±¡å¥æŸ„ã€‚</strong>&nbsp;<strong>&rdquo;</strong></div><br><div><strong>&nbsp;&nbsp;&nbsp;</strong></div><br><div><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</strong>å¯è§ï¼Œåƒåœ¾å›æ”¶GCæ˜¯é’ˆå¯¹å †Heapçš„ï¼Œè€Œæ ˆå› ä¸ºæœ¬èº«æ˜¯FILO - first in, last out. å…ˆè¿›åå‡ºï¼Œèƒ½å¤Ÿè‡ªåŠ¨é‡Šæ”¾ã€‚ è¿™æ ·å°±èƒ½æ˜ç™½åˆ°newåˆ›å»ºçš„ï¼Œéƒ½æ˜¯æ”¾åˆ°å †Heapï¼</div>

<p>æœ¬æ–‡å‡ºè‡ª &ldquo;<a href="http://android.blog.51cto.com/" target="_blank" rel="noopener">å­¦ä¹ Android</a>&rdquo; åšå®¢ï¼Œè¯·åŠ¡å¿…ä¿ç•™æ­¤å‡ºå¤„<a href="http://android.blog.51cto.com/268543/50100" target="_blank" rel="noopener">http://android.blog.51cto.com/268543/50100</a></p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> stack </tag>
            
            <tag> heap </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[WEBé¡¹ç›®çš„åˆ†å±‚ç»“æ„]]></title>
      <url>/2012/11/30/WEB%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%88%86%E5%B1%82%E7%BB%93%E6%9E%84/</url>
      <content type="html"><![CDATA[<p><strong>WEB**</strong>é¡¹ç›®çš„åˆ†å±‚ç»“æ„**</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¤§éƒ¨åˆ†çš„WEBåº”ç”¨åœ¨èŒè´£ä¸Šè‡³å°‘è¢«åˆ†æˆå››å±‚ï¼šè¡¨ç¤ºå±‚ã€æŒä¹…å±‚ã€ä¸šåŠ¡å±‚å’ŒåŸŸæ¨¡å—å±‚ã€‚</p>
<p><strong>ä¸€ã€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**</strong>è¡¨ç¤ºå±‚**</p>
<p>ä¸€èˆ¬æ¥è®²ï¼Œä¸€ä¸ªå…¸å‹çš„WEBåº”ç”¨çš„å‰ç«¯åº”è¯¥æ˜¯è¡¨ç¤ºå±‚ï¼Œå¯ä»¥ä½¿ç”¨Strutsæ¡†æ¶ã€‚</p>
<p>ä¸‹é¢æ˜¯Strutsæ‰€è´Ÿè´£çš„ï¼š</p>
<p>1ã€&nbsp;&nbsp;ç®¡ç†ç”¨æˆ·çš„è¯·æ±‚ï¼Œåšå‡ºç›¸åº”çš„å“åº”ã€‚</p>
<p>2ã€&nbsp;&nbsp;æä¾›ä¸€ä¸ªæµç¨‹æ§åˆ¶ï¼Œå§”æ´¾è°ƒç”¨ä¸šåŠ¡é€»è¾‘å’Œå…¶ä»–ä¸Šå±‚å¤„ç†ã€‚</p>
<p>3ã€&nbsp;&nbsp;å¤„ç†å¼‚å¸¸ã€‚</p>
<p>4ã€&nbsp;&nbsp;ä¸ºæ˜¾ç¤ºæä¾›ä¸€ä¸ªæ•°æ®æ¨¡å‹ï¼ˆå³æŠŠæ•°æ®å¯¹è±¡è®¾ç½®åˆ°æŸä¸€ä¸ªèŒƒå›´å†…ï¼Œç”¨äºå‰å°è·å–æ•°æ®ï¼‰ã€‚</p>
<p>5ã€&nbsp;&nbsp;ç”¨æˆ·ç•Œé¢çš„éªŒè¯ã€‚</p>
<p>ä»¥ä¸‹å†…å®¹ï¼Œä¸è¯¥åœ¨Strutsè¡¨ç¤ºå±‚çš„ç¼–ç ä¸­ç»å¸¸å‡ºç°ï¼Œå®ƒä»¬ä¸è¡¨ç¤ºå±‚æ— å…³çš„ã€‚</p>
<p>1ã€&nbsp;&nbsp;ä¸æ•°æ®åº“ç›´æ¥é€šä¿¡ã€‚</p>
<p>2ã€&nbsp;&nbsp;ä¸åº”ç”¨ç¨‹åºç›¸å…³è”çš„ä¸šåŠ¡é€»è¾‘æœ‰æ ¡éªŒ</p>
<p>3ã€&nbsp;&nbsp;äº‹åŠ¡å¤„ç†ã€‚</p>
<p><strong>äºŒã€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**</strong>æŒä¹…å±‚**</p>
<p>å…¸å‹çš„WEBåº”ç”¨çš„åç«¯æ˜¯æŒä¹…å±‚ã€‚å¯ä»¥ç”¨Hibernateå®ç°ã€‚Hibernateçš„æŒä¹…å¯¹è±¡æ˜¯åŸºäºPOJOï¼ˆPlain Old Java Objectï¼‰å’ŒJavaé›†åˆçš„ã€‚</p>
<p>ä¸‹é¢æ˜¯Hibernateæ‰€è´Ÿè´£çš„å†…å®¹ï¼š</p>
<p>1ã€&nbsp;&nbsp;å¦‚ä½•æŸ¥è¯¢å¯¹è±¡çš„ç›¸å…³ä¿¡æ¯ã€‚</p>
<p>Hibernateæ˜¯é€šè¿‡ä¸€ä¸ªé¢å‘å¯¹è±¡æŸ¥è¯¢è¯­è¨€ï¼ˆHQLï¼‰æˆ–æ­£åˆ™è¡¨è¾¾çš„APIæ¥å®ŒæˆæŸ¥è¯¢çš„ã€‚HQLéå¸¸ç±»ä¼¼äºSQLï¼Œåªæ˜¯æŠŠSQLé‡Œçš„tableå’Œcolumnsç”¨Objectå’Œå®ƒçš„fieldsä»£æ›¿ã€‚</p>
<p>2ã€&nbsp;&nbsp;å¦‚ä½•å­˜å‚¨ã€æ›´æ–°ã€åˆ é™¤æ•°æ®åº“è®°å½•ã€‚</p>
<p>3ã€&nbsp;&nbsp;Hibernateè¿™ç±»é«˜çº§ORMæ¡†æ¶æ”¯æŒå¤§éƒ¨åˆ†ä¸»æµæ•°æ®åº“ï¼Œå¹¶ä¸”æ”¯æŒçˆ¶è¡¨/å­è¡¨å…³ç³»ã€äº‹åŠ¡å¤„ç†ã€ç»§æ‰¿å’Œå¤šæ€ã€‚</p>
<p><strong>ä¸‰ã€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**</strong>ä¸šåŠ¡å±‚**</p>
<p>ä¸€ä¸ªå…¸å‹WEBåº”ç”¨çš„ä¸­é—´éƒ¨åˆ†æ˜¯ä¸šåŠ¡å±‚æˆ–æœåŠ¡å±‚ã€‚å¯ä»¥ç”¨Springæ¥å®ç°ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸šåŠ¡å±‚æ‰€è´Ÿè´£çš„ï¼š</p>
<p>1ã€&nbsp;&nbsp;å¤„ç†åº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸šåŠ¡æ ¡éªŒã€‚</p>
<p>2ã€&nbsp;&nbsp;ç®¡ç†äº‹åŠ¡ã€‚</p>
<p>3ã€&nbsp;&nbsp;æä¾›ä¸å…¶ä»–å±‚ç›¸äº’ä½œç”¨çš„æ¥å£ã€‚</p>
<p>4ã€&nbsp;&nbsp;ç®¡ç†ä¸šåŠ¡å±‚çº§åˆ«çš„å¯¹è±¡çš„ä¾èµ–ã€‚</p>
<p>5ã€&nbsp;&nbsp;åœ¨è¡¨ç¤ºå±‚å’ŒæŒä¹…å±‚ä¹‹é—´å¢åŠ ä¸€ä¸ªçµæ´»çš„æœºåˆ¶ï¼Œä½¿å¾—ä»–ä»¬ä¸ç›´æ¥è”ç³»åœ¨ä¸€èµ·ã€‚</p>
<p>6ã€&nbsp;&nbsp;é€šè¿‡æ­ç¤ºä»è¡¨ç¤ºå±‚åˆ°ä¸šåŠ¡å±‚ä¹‹é—´çš„ä¸Šä¸‹æ–‡æ¥å¾—åˆ°ä¸šåŠ¡é€»è¾‘ã€‚</p>
<p>7ã€&nbsp;&nbsp;ç®¡ç†ç¨‹åºçš„æ‰§è¡Œï¼ˆä»ä¸šåŠ¡å±‚åˆ°æŒä¹…å±‚ï¼‰ã€‚</p>
<p><strong>å››ã€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**</strong>åŸŸæ¨¡å—å±‚**</p>
<p>æ—¢ç„¶æˆ‘ä»¬è‡´åŠ›äºä¸€ä¸ªWEBçš„åº”ç”¨ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå¯¹è±¡é›†åˆï¼Œè®©å®ƒåœ¨ä¸åŒå±‚ä¹‹é—´ç§»åŠ¨ã€‚åŸŸæ¨¡å—å±‚ç”±å®é™…éœ€æ±‚ä¸­ä¸šåŠ¡å¯¹è±¡ç»„æˆï¼Œæ¯”å¦‚è®¢å•æ˜ç»†ã€äº§å“ã€ç­‰ã€‚å¼€å‘è€…åœ¨è¿™å±‚ä¸ç”¨ç®¡å“ªäº›æ•°æ®ä¼ è¾“å¯¹è±¡ï¼Œè€Œå…³æ³¨åŸŸå¯¹è±¡å³å¯ã€‚ä¾‹å¦‚ï¼ŒHibernateå…è®¸ä½ å°†æ•°æ®åº“ä¸­çš„ä¿¡æ¯å­˜å…¥åŸŸå¯¹è±¡ï¼Œè¿™æ ·ä½ å¯ä»¥åœ¨è¿æ¥æ–­å¼€çš„æƒ…å†µä¸‹æŠŠè¿™äº›æ•°æ®æ˜¾ç¤ºåˆ°ç”¨æˆ·ç•Œé¢å±‚ï¼Œè€Œé‚£äº›å¯¹è±¡ä¹Ÿå¯ä»¥è¿”å›ç»™æŒä¹…å±‚ï¼Œä»è€Œåœ¨æ•°æ®åº“é‡Œæ›´æ–°ã€‚è€Œä¸”ï¼Œä½ ä¸å¿…æŠŠå¯¹è±¡è½¬åŒ–æˆDTOï¼ˆè¿™å¯èƒ½å¯¼è‡´å®ƒåœ¨ä¸åŒå±‚ä¹‹é—´ä¼ è¾“è¿‡ç¨‹ä¸­ä¸¢å¤±ï¼‰ã€‚è¿™ä¸ªæ¨¡å‹ä½¿å¾—Javaå¼€å‘è€…èƒ½å¾ˆè‡ªç„¶è¿ç”¨é¢å‘ç¼–ç¨‹ï¼Œè€Œä¸éœ€è¦é™„åŠ ç¼–ç ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> j2ee </tag>
            
            <tag> java web </tag>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[java é€‚é…å™¨æ¨¡å¼]]></title>
      <url>/2012/11/21/java-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>é€‚é…å™¨:åŸºäºç°æœ‰ç±»æ‰€æä¾›çš„æœåŠ¡ï¼Œå‘å®¢æˆ·æä¾›æ¥å£ï¼Œä»¥æ»¡è¶³å®¢æˆ·çš„æœŸæœ›</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ŠJavaè®¾è®¡æ¨¡å¼ã€‹</p>
<p>ä¸€ã€ç±»é€‚é…å™¨ï¼š</p>
<p>OtherOperationï¼ˆå·²å­˜åœ¨æ‰€éœ€åŠŸèƒ½çš„ç±»ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-21 ä¸‹åˆ4:39:18<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> OtherOperation {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> add(<span style="color: #0000ff;">int</span> a, <span style="color: #0000ff;">int</span><span style="color: #000000;"> b){<br>        </span><span style="color: #0000ff;">return</span> a +<span style="color: #000000;"> b;<br>    }<br>}</span></pre><br></div>

<p>Operationï¼ˆä¸ºæ‰€è¦å®ç°çš„åŠŸèƒ½å®šä¹‰æ¥å£ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-21 ä¸‹åˆ4:40:12<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Operation {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> add(<span style="color: #0000ff;">int</span> a, <span style="color: #0000ff;">int</span><span style="color: #000000;"> b);<br>}</span></pre><br></div>

<p>OperationAdapterï¼ˆé€‚é…å™¨ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-21 ä¸‹åˆ4:40:41
  å¯¹è±¡é€‚é…å™¨<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> OperationAdapter <span style="color: #0000ff;">extends</span> OtherOperation <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Operation{<br><br>}</span></pre><br></div>

<hr>
<p>äºŒã€å¯¹è±¡é€‚é…å™¨ï¼š</p>
<p>å‡å¦‚å®¢æˆ·æ¥å£æœŸæœ›çš„åŠŸèƒ½ä¸æ­¢ä¸€ä¸ªï¼Œè€Œæ˜¯å¤šä¸ªã€‚<br>ç”±äºjavaæ˜¯ä¸èƒ½å®ç°å¤šç»§æ‰¿çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½é€šè¿‡æ„å»ºä¸€ä¸ªé€‚é…å™¨ï¼Œè®©ä»–æ¥ç»§æ‰¿æ‰€æœ‰åŸä»¥å®Œæˆæˆ‘ä»¬çš„æœŸæœ›ï¼Œè¿™æ—¶å€™æ€ä¹ˆåŠå‘¢?åªèƒ½ç”¨é€‚é…å™¨çš„å¦ä¸€ç§å®ç°â€“å¯¹è±¡é€‚é…å™¨ï¼š<br>ç¬¦åˆjavaæå€¡çš„ç¼–ç¨‹æ€æƒ³ä¹‹ä¸€ï¼Œå³å°½é‡ä½¿ç”¨èšåˆä¸è¦ä½¿ç”¨ç»§æ‰¿ã€‚</p>
<p>OtherAddå’ŒOtherMinusï¼ˆå·²å­˜åœ¨åŠŸèƒ½çš„ä¸¤ä¸ªç±»ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<strong></strong></span><span style="color: #008000;"><br> <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian
  </span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-21 ä¸‹åˆ4:50:14<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> OtherAdd {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> add(<span style="color: #0000ff;">int</span> a, <span style="color: #0000ff;">int</span><span style="color: #000000;"> b){<br>        </span><span style="color: #0000ff;">return</span> a +<span style="color: #000000;"> b;<br>    }<br>}</span></pre><br></div><br><div class="cnblogs_code"><br><pre><span style="color: #008000;">/</span><span style="color: #008000;"><br> <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian
  </span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-21 ä¸‹åˆ4:50:46<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> OtherMinus {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> minus(<span style="color: #0000ff;">int</span> a, <span style="color: #0000ff;">int</span><span style="color: #000000;"> b){<br>        </span><span style="color: #0000ff;">return</span> a -<span style="color: #000000;"> b;<br>    }<br>}</span></pre><br></div>

<p>Operationï¼ˆä¸ºæ‰€è¦å®ç°çš„åŠŸèƒ½å®šä¹‰æ¥å£ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-21 ä¸‹åˆ4:51:59<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Operation {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> add(<span style="color: #0000ff;">int</span> a, <span style="color: #0000ff;">int</span><span style="color: #000000;"> b);<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> minus(<span style="color: #0000ff;">int</span> a, <span style="color: #0000ff;">int</span><span style="color: #000000;"> b);<br>}</span></pre><br></div>

<p>OperationAdapterï¼ˆ<span>é€šè¿‡</span><span>é€‚é…ç±»</span><span>çš„å¯¹è±¡æ¥</span><span>è·å–</span>ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-21 ä¸‹åˆ4:52:36<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> OperationAdapter <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Operation{<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> OtherAdd otherAdd;<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> OtherMinus otherMinus;<br><br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> OtherAdd getOtherAdd() {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> otherAdd;<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setOtherAdd(OtherAdd otherAdd) {<br>        </span><span style="color: #0000ff;">this</span>.otherAdd =<span style="color: #000000;"> otherAdd;<br>    }<br><br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> OtherMinus getOtherMinus() {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> otherMinus;<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setOtherMinus(OtherMinus otherMinus) {<br>        </span><span style="color: #0000ff;">this</span>.otherMinus =<span style="color: #000000;"> otherMinus;<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> add(<span style="color: #0000ff;">int</span> a, <span style="color: #0000ff;">int</span><span style="color: #000000;"> b) {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> otherAdd.add(a, b);<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> minus(<span style="color: #0000ff;">int</span> a, <span style="color: #0000ff;">int</span><span style="color: #000000;"> b) {<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> otherMinus.minus(a, b);<br>    }<br><br>}</span></pre><br></div>

]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> adapter </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[java è§‚å¯Ÿè€…æ¨¡å¼]]></title>
      <url>/2012/11/20/java-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>IWatchedï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ4:58:25<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> IWatched {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> addWatcher(IWatcher watcher);<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> removeWatcher(IWatcher watcher);<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> notifyWatchers(String msg);<br>}</span></pre><br></div>

<p>IWatcherï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ4:55:23<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> IWatcher {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> update(String msg);<br>}</span></pre><br></div>

<p>Watchedï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ5:01:05<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Watched <span style="color: #0000ff;">implements</span><span style="color: #000000;"> IWatched{<br>    </span><span style="color: #0000ff;">private</span> List&lt;IWatcher&gt; watchers = <span style="color: #0000ff;">new</span> ArrayList&lt;IWatcher&gt;<span style="color: #000000;">();<br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> addWatcher(IWatcher watcher) {<br>        watchers.add(watcher);<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> removeWatcher(IWatcher watcher) {<br>        watchers.remove(watcher);<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> notifyWatchers(String msg) {<br>        </span><span style="color: #0000ff;">for</span><span style="color: #000000;">(IWatcher watcher : watchers){<br>            watcher.update(msg);<br>        }<br>    }<br>}</span></pre><br></div>

<p>Watcherï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ5:04:56<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Watcher <span style="color: #0000ff;">implements</span><span style="color: #000000;"> IWatcher{<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> update(String msg) {<br>        System.out.println(msg);<br>    }<br>}</span></pre><br></div>

<p>Testï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ5:05:26<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Test {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {<br>        IWatched watched </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Watched();<br>        IWatcher watcher1 </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Watcher();<br>        IWatcher watcher2 </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Watcher();<br>        IWatcher watcher3 </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Watcher();<br>        watched.addWatcher(watcher1);<br>        watched.addWatcher(watcher2);<br>        watched.addWatcher(watcher3);<br>        watched.notifyWatchers(</span>â€œI have been clicked!â€<span style="color: #000000;">);<br><br>        watched.removeWatcher(watcher1);<br>        watched.notifyWatchers(</span>â€œwhatâ€™s upâ€<span style="color: #000000;">);<br>    }<br>}</span></pre><br></div>

]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> pattern </tag>
            
            <tag> observer </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[java è£…é¥°è€…æ¨¡å¼]]></title>
      <url>/2012/11/20/java-%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>IPersonï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ3:43:04<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> IPerson {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> canDo();<br>}</span></pre><br></div>

<p>Personï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ3:44:04<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Person <span style="color: #0000ff;">implements</span><span style="color: #000000;"> IPerson{<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> canDo() {<br>        System.out.println(</span>â€œI can codeâ€<span style="color: #000000;">);<br>    }<br>}</span></pre><br></div>

<p>Decoratorï¼ˆæ‰€æœ‰Personè£…é¥°è€…çš„çˆ¶ç±»ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ3:44:55<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Decorator <span style="color: #0000ff;">implements</span><span style="color: #000000;"> IPerson{<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> IPerson person;<br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> Decorator(IPerson person) {<br>        </span><span style="color: #0000ff;">this</span>.person =<span style="color: #000000;"> person;<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> canDo() {<br>        person.canDo();<br>    }<br>}</span></pre><br></div>

<p>DecoratorSwimï¼ˆSwimè£…é¥°â€“ä¸ºPeronæ·»åŠ &ldquo;Swim&rdquo;åŠŸèƒ½ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ3:48:54<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> DecoratorSwim <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Decorator{<br><br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> DecoratorSwim(IPerson person) {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">(person);<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> canDo() {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.canDo();<br>        System.out.println(</span>â€œI also can swimâ€<span style="color: #000000;">);<br>    }<br>}</span></pre><br></div>

<p>DecoratorDrawï¼ˆDrawè£…é¥°â€“ä¸ºPeronæ·»åŠ &ldquo;Draw&rdquo;åŠŸèƒ½ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ3:47:29<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> DecoratorDraw <span style="color: #0000ff;">extends</span><span style="color: #000000;"> Decorator{<br><br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> DecoratorDraw(IPerson person) {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">(person);<br>    }<br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> canDo() {<br>        </span><span style="color: #0000ff;">super</span><span style="color: #000000;">.canDo();<br>        System.out.println(</span>â€œI also can drawâ€<span style="color: #000000;">);<br>    }<br>}</span></pre><br></div>

<p>Testï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ3:49:35<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Test {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {</span><span style="color: #000000;"><br>        Decorator decorator </span>= <span style="color: #0000ff;">new</span> DecoratorDraw(<span style="color: #0000ff;">new</span> DecoratorSwim(<span style="color: #0000ff;">new</span><span style="color: #000000;"> Person()));<br>        decorator.canDo();<br>    }<br>}</span></pre><br></div>

]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> pattern </tag>
            
            <tag> decorator </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[java ä»£ç†æ¨¡å¼ï¼ˆé™æ€ä»£ç†+åŠ¨æ€ä»£ç†ï¼‰]]></title>
      <url>/2012/11/20/java-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%EF%BC%88%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>é™æ€ä»£ç†ï¼š</p>
<p>ISubjectï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ1:49:29<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> ISubject {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> request();<br>}</span></pre><br></div>

<p>RealSubjectï¼ˆçœŸå®è§’è‰²ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ1:51:37<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> RealSubject <span style="color: #0000ff;">implements</span><span style="color: #000000;"> ISubject{<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> request() {<br>        System.out.println(</span>â€œrealSubject requestingâ€<span style="color: #000000;">);<br>    }<br>}</span></pre><br></div>

<p>ProxySubjectï¼ˆä»£ç†ç±»ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ1:52:22<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ProxySubject <span style="color: #0000ff;">implements</span><span style="color: #000000;"> ISubject{<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> RealSubject realSubject;<br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> ProxySubject() {<br>        realSubject </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> RealSubject();<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> request() {<br>        System.out.println(</span>â€œdo something beforeâ€<span style="color: #000000;">);<br>        realSubject.request();<br>        System.out.println(</span>â€œdo something afterâ€<span style="color: #000000;">);<br>    }<br>}</span></pre><br></div>

<p>Testï¼ˆå®¢æˆ·ç«¯æµ‹è¯•ï¼‰:</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ1:54:47<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Test {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {<br>        ISubject proxySubject </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> ProxySubject();<br>        proxySubject.request();<br>    }<br>}</span></pre><br></div>

<hr>
<p>åŠ¨æ€ä»£ç†ï¼š</p>
<p>ISubjectï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ2:51:31<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> ISubject {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> request();<br>}</span></pre><br></div>

<p>RealSubjectï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ2:52:00<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> RealSubject <span style="color: #0000ff;">implements</span><span style="color: #000000;"> ISubject{<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> request() {<br>        System.out.println(</span>â€œrealSubject requestingâ€<span style="color: #000000;">);<br>    }<br>}</span></pre><br></div>

<p>SubjectInvocationHandlerï¼ˆè°ƒç”¨å¤„ç†ç±»ï¼‰ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<strong></strong></span><span style="color: #008000;"><br> <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian
  </span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ2:54:38<br> <em> è°ƒç”¨å¤„ç†ç±»<br> </em></span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> SubjectInvocationHandler <span style="color: #0000ff;">implements</span><span style="color: #000000;"> InvocationHandler{<br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Object obj;<br><br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> SubjectInvocationHandler(Object obj) {<br>        </span><span style="color: #0000ff;">this</span>.obj =<span style="color: #000000;"> obj;<br>    }<br><br>    </span><span style="color: #008000;">/</span><span style="color: #008000;"><br>     <em> ç”Ÿæˆä»£ç†ç±»å·¥å‚
     </em> </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br>     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> realObj
      </span><span style="color: #808080;">@return è¿”å›ç”Ÿæˆçš„ä»£ç†ç±»</span><br>     <span style="color: #008000;">*/</span><br>    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> Object getProxyInstanceFactory(Object realObj){<br>        Class</span>&lt;?&gt; classType =<span style="color: #000000;"> realObj.getClass();<br>        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> Proxy.newProxyInstance(classType.getClassLoader(),<br>                classType.getInterfaces(), </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> SubjectInvocationHandler(realObj));<br>    }<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> Object invoke(Object proxy, Method method, Object[] args)<br>            </span><span style="color: #0000ff;">throws</span><span style="color: #000000;"> Throwable {<br>        System.out.println(</span>â€œbeforeâ€<span style="color: #000000;">);<br><br>        method.invoke(obj, args);<br><br>        System.out.println(</span>â€œafterâ€<span style="color: #000000;">);<br><br>        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br>    }<br>}</span></pre><br></div>

<p>Testï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
  </span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br> <em> </em></span><span style="color: #808080;">@version</span><span style="color: #008000;"> åˆ›å»ºæ—¶é—´ï¼š2012-11-20 ä¸‹åˆ2:56:25<br> </span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Test {<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {<br>        RealSubject realSubject </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> RealSubject();<br></span><span style="color: #008000;">//</span><span style="color: #008000;">        InvocationHandler handler = new SubjectInvocationHandler(realSubject);<br></span><span style="color: #008000;">//</span><span style="color: #008000;">        ISubject subject = (ISubject)Proxy.newProxyInstance(realSubject.getClass().getClassLoader(),<br></span><span style="color: #008000;">//</span><span style="color: #008000;">                realSubject.getClass().getInterfaces(), handler);</span><br>        ISubject subject =<span style="color: #000000;"> (ISubject)SubjectInvocationHandler.getProxyInstanceFactory(realSubject);<br>        subject.request();<br><br>    }<br>}</span></pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> pattern </tag>
            
            <tag> proxy </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java å•ä¾‹æ¨¡å¼]]></title>
      <url>/2012/11/20/Java-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>Singletonæ¨¡å¼ä¸»è¦ä½œç”¨æ˜¯ä¿è¯åœ¨Java<a href="http://baike.baidu.com/view/330120.htm" target="_blank" rel="noopener">åº”ç”¨ç¨‹åº</a>ä¸­ï¼Œä¸€ä¸ªç±»Classåªæœ‰ä¸€ä¸ªå®ä¾‹å­˜åœ¨ã€‚</p>
<p>å¥½å¤„ï¼š</p>
<p>&nbsp;&nbsp; &nbsp; å’Œå…¨å±€å˜é‡ç›¸æ¯”ï¼Œå®ƒå¯¹äºç³»ç»Ÿæ€§èƒ½çš„ä¼˜åŒ–æ›´å¥½ï¼Œå› ä¸ºå®ƒæ˜¯å±äºä»€ä¹ˆæ—¶å€™ç”¨ï¼Œä»€ä¹ˆæ—¶å€™å®ä¾‹åŒ–çš„ã€‚</p>
<p>ã€€ã€€ä¸€èˆ¬Singletonæ¨¡å¼é€šå¸¸æœ‰ä¸¤ç§å½¢å¼:</p>
<p>ç¬¬ä¸€ç§å½¢å¼: ä¹Ÿæ˜¯å¸¸ç”¨çš„å½¢å¼ã€‚</p>
<div class="cnblogs_code"><br><pre>ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Singleton {<br>ã€€ã€€</span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> Singleton instance = <span style="color: #0000ff;">null</span><span style="color: #000000;">;<br>ã€€ã€€</span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Singleton(){<br>ã€€ã€€ã€€ã€€</span><span style="color: #008000;">//</span><span style="color: #008000;">do something</span><br><span style="color: #000000;">ã€€ã€€ã€€ã€€}<br>ã€€ã€€</span><span style="color: #008000;">//</span><span style="color: #008000;">è¿™ä¸ªæ–¹æ³•æ¯”ä¸‹é¢çš„æœ‰æ‰€æ”¹è¿›ï¼Œä¸ç”¨æ¯æ¬¡éƒ½è¿›è¡Œç”Ÿæˆå¯¹è±¡ï¼Œåªæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶ç”Ÿæˆå®ä¾‹ï¼Œæé«˜äº†æ•ˆç‡</span><br>ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> Singleton getInstance(){<br>ã€€ã€€ã€€ã€€</span><span style="color: #0000ff;">if</span>(instance==<span style="color: #0000ff;">null</span><span style="color: #000000;">){<br>ã€€ã€€ã€€ã€€ã€€ã€€instance </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Singleton();<br>ã€€ã€€ã€€ã€€}<br>ã€€ã€€ã€€ã€€</span><span style="color: #0000ff;">return</span><span style="color: #000000;"> instance;<br>ã€€ã€€ã€€ã€€}<br>ã€€ã€€}</span></pre><br></div>

<p><span>ç¬¬äºŒç§å½¢å¼:</span></p>
<div class="cnblogs_code"><br><pre>ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Singleton {<br>ã€€ã€€ã€€</span><span style="color: #008000;">//</span><span style="color: #008000;">åœ¨è‡ªå·±å†…éƒ¨å®šä¹‰è‡ªå·±çš„ä¸€ä¸ªå®ä¾‹ï¼Œåªä¾›å†…éƒ¨è°ƒç”¨</span><br>ã€€ã€€ã€€<span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> Singleton instance = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Singleton();<br>ã€€ã€€ã€€</span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Singleton(){<br>ã€€ã€€ã€€ã€€ã€€</span><span style="color: #008000;">//</span><span style="color: #008000;">do something</span><br><span style="color: #000000;">ã€€ã€€ã€€}<br>ã€€ã€€ã€€</span><span style="color: #008000;">//</span><span style="color: #008000;">è¿™é‡Œæä¾›äº†ä¸€ä¸ªä¾›å¤–éƒ¨è®¿é—®æœ¬classçš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥è®¿é—®</span><br>ã€€ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> Singleton getInstance(){<br>ã€€ã€€ã€€ã€€ã€€</span><span style="color: #0000ff;">return</span><span style="color: #000000;"> instance;<br>ã€€ã€€ã€€}<br>ã€€}</span></pre><br></div>

<p>psï¼šåœ¨é™æ€åˆå§‹åŒ–å™¨ä¸­åˆ›å»ºå•ä»¶ï¼Œè¿™æ®µä»£ç å°±ä¿è¯äº†çº¿ç¨‹å®‰å…¨ã€‚</p>
<p>å¯¹äºå¤šçº¿ç¨‹çš„è®¿é—®ï¼Œæˆ‘ä»¬å¤šåŠé‡‡ç”¨ç¬¬äºŒç§&ldquo;æ€¥åˆ‡&rdquo;çš„æ–¹å¼ï¼Œè€Œä¸ç”¨ç¬¬ä¸€ç§å»¶è¿Ÿå¤„ç†çš„æ–¹å¼ï¼Œè¿™æ ·å°±ä¼šè§£å†³å¤šçº¿ç¨‹å¯¹å•ä¸€è®¿é—®ç‚¹è®¿é—®é€ æˆé¡ºåºæ‰§è¡Œå‡ºé”™çš„é—®é¢˜ã€‚</p>
<p>&nbsp;</p>
<p>è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼šç”¨åŒé‡æ£€æŸ¥æ·é”ï¼Œåœ¨getInstanceï¼ˆï¼‰ä¸­å‡å°‘ä½¿ç”¨åŒæ­¥</p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Singleton{<br>  </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">volatile</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> Singleton instance;<br>  </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Singleton(){}<br>  </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> Singleton getInstance(){<br>    </span><span style="color: #0000ff;">if</span>(instance==<span style="color: #0000ff;">null</span><span style="color: #000000;">){<br>      </span><span style="color: #0000ff;">synchronized</span>(Singletion.<span style="color: #0000ff;">class</span><span style="color: #000000;">){<br>        </span><span style="color: #0000ff;">if</span>(instance == <span style="color: #0000ff;">null</span><span style="color: #000000;">){<br>          instance </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Singleton();<br>        }<br>      }<br>    }<br>    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> instance;<br>  }<br>}</span></pre><br></div>

<p><span>volatileå…³é”®è¯ç¡®ä¿ï¼šå½“instanceå˜é‡è¢«åˆå§‹åŒ–æˆSingletionå®ä¾‹æ—¶ï¼Œå¤šä¸ªçº¿ç¨‹æ­£ç¡®åœ°å¤„ç†instanceå˜é‡ï¼Œå› ä¸ºå®ƒä¼šå¼ºåˆ¶å˜é‡å»å¯¹åº”å†…å­˜ä¸­å…±äº«çš„å˜é‡</span></p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> pattern </tag>
            
            <tag> singleton </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[java å·¥å‚æ¨¡å¼]]></title>
      <url>/2012/11/19/java-%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p><span>å·¥å‚æ¨¡å¼ç»†åˆ†æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«ä¸ºï¼šç®€å•å·¥å‚æ¨¡å¼ã€å·¥å‚æ–¹æ³•æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡</span><span>å¼</span></p>
<p><span>ç°å•ä¸ªçš„è®²ï¼Œæœ€åå†è®²è¿™ä¸‰ä¸ªçš„åŒºåˆ«</span><br><span>è¿™ç¯‡æ–‡ç« ä¸»è¦é€šè¿‡ä¸€ä¸ªå†œåœºçš„å®ä¾‹æ¥è®²è§£ï¼Œè¿™ä¹Ÿæ˜¯javaä¸æ¨¡å¼ä¹¦ä¸­çš„ä¾‹</span><span>å­ï¼Œåªä¸è¿‡æˆ‘å¯¹ä¸€äº›éƒ¨åˆ†è¿›è¡Œäº†ç®€åŒ–ï¼Œä¸€äº›éƒ¨åˆ†è¿›è¡Œäº†æ‰©å……ï¼Œä»¥å¸®åŠ©ç†è§£ä¾‹</span><span>å­å¦‚ä¸‹ï¼š</span><br><span>æœ‰ä¸€ä¸ªå†œåœºå…¬å¸ï¼Œä¸“é—¨å‘å¸‚åœºé”€å”®å„ç±»æ°´æœæœ‰å¦‚ä¸‹æ°´æœï¼š</span><br><span>è‘¡è„ï¼ˆgrapeï¼‰</span><br><span>è‰è“ï¼ˆstrawberryï¼‰</span><br><span>è‹¹æœï¼ˆappleï¼‰</span></p>
<p><span><strong>ç®€å•å·¥å‚æ¨¡å¼ï¼š</strong></span></p>
<p><span><span>è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œå†™ä¸€ä¸‹æºä»£ç æºä»£ç ä¸­ç»™å‡ºäº†å¿…é¡»çš„æ³¨é‡Šä»£ç æ¯”ä¹¦ä¸Šçš„è¦</span><span>ç®€å•ä¸€äº›ï¼Œæ’ç‰ˆä¹Ÿå¥½çœ‹ä¸€äº›ï¼Œåªæ˜¯ä¸ºäº†è®©æ–°æ‰‹æ›´å¥½çš„ç†è§£</span></span></p>
<p><span><span><span>Fruit.java:</span></span></span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Fruit<br>{<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
 æ°´æœä¸å…¶å®ƒæ¤ç‰©ç›¸æ¯”æœ‰ä¸€äº›ä¸“é—¨çš„å±æ€§ï¼Œä»¥ä¾¿ä¸å†œåœºçš„<br><em> å…¶å®ƒæ¤ç‰©åŒºåˆ†å¼€è¿™é‡Œçš„æ°´æœå‡è®¾å®ƒå¿…é¡»å…·å¤‡çš„æ–¹æ³•ï¼š
</em> ç”Ÿé•¿grow()æ”¶è·harvest()ç§æ¤plant()<br></span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">void</span><span style="color: #000000;"> grow();<br></span><span style="color: #0000ff;">void</span><span style="color: #000000;"> harvest();<br></span><span style="color: #0000ff;">void</span><span style="color: #000000;"> plant();<br>}</span></pre><br></div>

<p><span>ä¸‹é¢æ˜¯Appleç±»çš„å‡½æ•°Apple.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Apple <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Fruit<br>{<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> 
 è‹¹æœæ˜¯æ°´æœç±»çš„ä¸€ç§ï¼Œå› æ­¤å®ƒå¿…é¡»å®ç°æ°´æœæ¥å£çš„æ‰€æœ‰æ–¹æ³•å³<br><em> grow()harvest()plant()ä¸‰ä¸ªå‡½æ•°å¦å¤–ï¼Œç”±äºè‹¹æœæ˜¯å¤šå¹´ç”Ÿæ¤ç‰©ï¼Œ
</em> æ‰€ä»¥å¤šå‡ºä¸€ä¸ªtreeAgeæ€§è´¨ï¼Œæè¿°è‹¹æœçš„æ ‘é¾„<br></span><span style="color: #008000;">*/</span><br><br><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> treeAge;<br><br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> grow() { <span style="color: #008000;">//</span><span style="color: #008000;">è‹¹æœçš„ç”Ÿé•¿å‡½æ•°ä»£ç  }</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> harvest() { <span style="color: #008000;">//</span><span style="color: #008000;">è‹¹æœçš„æ”¶è·å‡½æ•°ä»£ç  }</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> plant() { <span style="color: #008000;">//</span><span style="color: #008000;">è‹¹æœçš„ç§æ¤å‡½æ•°ä»£ç  }</span><br><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> getTreeAge() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> treeAge; }<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setTreeAge(<span style="color: #0000ff;">int</span> treeAge) { <span style="color: #0000ff;">this</span>.treeAge =<span style="color: #000000;"> treeAge; }<br>}</span></pre><br></div>

<p><span>ä¸‹é¢æ˜¯Grapeç±»çš„å‡½æ•°Grape.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Grape <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Fruit<br>{<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> 
 è‘¡è„æ˜¯æ°´æœç±»çš„ä¸€ç§ï¼Œå› æ­¤å®ƒå¿…é¡»å®ç°æ°´æœæ¥å£çš„æ‰€æœ‰æ–¹æ³•å³<br><em> grow()harvest()plant()ä¸‰ä¸ªå‡½æ•°å¦å¤–ï¼Œç”±äºè‘¡è„åˆ†ä¸ºæœ‰ç±½å’Œæ— ç±½
</em> ä¸¤ç§ï¼Œå› æ­¤å¤šå‡ºä¸€ä¸ªseedlessæ€§è´¨ï¼Œæè¿°è‘¡è„æœ‰ç±½è¿˜æ˜¯æ— ç±½<br></span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> seedless;<br><br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> grow() { <span style="color: #008000;">//</span><span style="color: #008000;">è‘¡è„çš„ç”Ÿé•¿å‡½æ•°ä»£ç  }</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> harvest() { <span style="color: #008000;">//</span><span style="color: #008000;">è‘¡è„çš„æ”¶è·å‡½æ•°ä»£ç  }</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> plant() { <span style="color: #008000;">//</span><span style="color: #008000;">è‘¡è„çš„ç§æ¤å‡½æ•°ä»£ç  }</span><br><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span> getSeedless() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> seedless; }<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setSeedless(<span style="color: #0000ff;">boolean</span> seedless) { <span style="color: #0000ff;">this</span>.seedless =<span style="color: #000000;"> seedless; }<br><br>}</span></pre><br></div>

<p><span>ä¸‹é¢æ˜¯Strawberryç±»çš„å‡½æ•°Strawberry.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Strawberry <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Fruit<br>{<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> 
 è‰è“æ˜¯æ°´æœç±»çš„ä¸€ç§ï¼Œå› æ­¤å®ƒå¿…é¡»å®ç°æ°´æœæ¥å£çš„æ‰€æœ‰æ–¹æ³•å³<br><em> grow()harvest()plant()ä¸‰ä¸ªå‡½æ•°å¦å¤–ï¼Œè¿™é‡Œå‡è®¾è‰è“åˆ†ä¸ºå¤§æ£šè‰è“å’Œä¸€èˆ¬
</em> è‰è“ï¼ˆå³æ²¡æœ‰æ£šçš„è‰è“ï¼‰å› æ­¤è‰è“æ¯”ä¸€èˆ¬æ°´æœå¤šå‡ºä¸€ä¸ªæ€§è´¨cotelessï¼Œæè¿°è‰è“<br><em> æ˜¯å¤§æ£šè‰è“è¿˜æ˜¯æ²¡æœ‰å¤§æ£šçš„è‰è“<br></em></span><span style="color: #008000;">/</span><br><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> coteless;<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> grow() { <span style="color: #008000;">//</span><span style="color: #008000;">è‰è“çš„ç”Ÿé•¿å‡½æ•°ä»£ç  }</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> harvest() { <span style="color: #008000;">//</span><span style="color: #008000;">è‰è“çš„æ”¶è·å‡½æ•°ä»£ç  }</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> plant() { <span style="color: #008000;">//</span><span style="color: #008000;">è‰è“çš„ç§æ¤å‡½æ•°ä»£ç  }</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span> getCoteless() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> coteless; }<br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setCoteless(<span style="color: #0000ff;">boolean</span> coteless) { <span style="color: #0000ff;">this</span>. coteless =<span style="color: #000000;"> coteless; }<br>}</span></pre><br></div>

<p><span>å†œåœºçš„å›­ä¸ä¹Ÿæ˜¯ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œè‡ªç„¶è¦æœ‰ä¸€ä¸ªåˆé€‚çš„ç±»æ¥ä»£è¡¨ï¼Œæˆ‘ä»¬ç”¨FruitGardenerç±»</span><br><span>æ¥è¡¨ç¤ºFruitGardenerç±»ä¼šæ ¹æ®å®¢æˆ·ç«¯çš„è¦æ±‚ï¼Œåˆ›å»ºå‡ºä¸åŒçš„æ°´æœå¯¹è±¡ï¼Œæ¯”å¦‚è‹¹æœï¼ˆappleï¼‰,</span><br><span>è‘¡è„ï¼ˆgrapeï¼‰æˆ–è‰è“ï¼ˆstrawberryï¼‰çš„å®ä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</span><br><span>FruitGardener.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> FruitGardener<br>{<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;">
 é€šè¿‡ä¸‹é¢çš„è¡¨æ€å·¥å‚æ–¹æ³•ï¼Œå¯ä»¥æ ¹æ®å®¢æˆ·çš„éœ€è¦ï¼Œåˆ›å»ºå‡ºä¸åŒçš„æ°´æœå¯¹è±¡<br><em> å¦‚æœæä¾›çš„å‚æ•°æ˜¯appleåˆ™é€šè¿‡return new Apple()åˆ›å»ºå‡ºè‹¹æœå®ä¾‹
</em> å¦‚æœæ˜¯æä¾›çš„å‚æ•°æ˜¯grapeåˆ™åˆ›å»ºè‘¡è„å®ä¾‹ï¼Œè¿™æ­£æ˜¯ç®€å•å·¥å‚æ–¹æ³•ä¹‹ç²¾é«“<br></span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Fruit factory(String which) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> BadFruitException<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">if</span> (which.equalsIgnoreCase(â€œappleâ€)) { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> Apple(); }<br>ã€€ã€€</span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (which.equalsIgnoreCase(â€œstrawberryâ€)) { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> Strawberry(); }<br>ã€€ã€€</span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (which.equalsIgnoreCase(â€œgrapeâ€)) { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> Grape(); }<br>ã€€ã€€</span><span style="color: #0000ff;">else</span> { <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> BadFruitException(â€œBad fruit requestâ€<span style="color: #000000;">); }<br>ã€€ã€€}<br>}</span></pre><br></div>

<p><span>ç®€å•å·¥å‚æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å½“åœ¨ç³»ç»Ÿä¸­å¼•å…¥æ–°äº§å“æ—¶ä¸å¿…ä¿®æ”¹å®¢æˆ·ç«¯ï¼Œä½†éœ€è¦ä¸ªä¿®æ”¹å·¥å‚</span><span>ç±»ï¼Œå°†å¿…è¦çš„é€»è¾‘åŠ å…¥åˆ°å·¥å‚ç±»ä¸­å·¥å‚æ–¹æ³•æ¨¡å¼å°±å…‹æœäº†ä»¥ä¸Šç¼ºç‚¹ï¼Œä¸‹é¢è°ˆè°ˆå·¥å‚</span><span>æ–¹æ³•æ¨¡å¼</span></p>
<p><span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</span></p>
<p><span><strong>å·¥å‚æ–¹æ³•æ¨¡å¼:</strong></span></p>
<p><span><span>ç”±äºæ°´æœæ¥å£ä»¥åŠgrapeç±»strawberryç±»appleç±»çš„ä»£ç éƒ½å’Œä¸Šé¢çš„ä¸€æ ·ï¼Œæ‰€ä»¥ä¸‹</span><span>é¢ç›¸å…³çš„æºç å»æ‰äº†æ³¨é‡Š</span><br><span>Fruit.java:</span></span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Fruit<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">void</span><span style="color: #000000;"> grow();<br>ã€€ã€€</span><span style="color: #0000ff;">void</span><span style="color: #000000;"> harvest();<br>ã€€ã€€</span><span style="color: #0000ff;">void</span><span style="color: #000000;"> plant();<br>}</span></pre><br></div>

<p><span>Apple.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Apple <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Fruit<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> treeAge;<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> grow() { <span style="color: #008000;">//</span><span style="color: #008000;">è‹¹æœçš„ç”Ÿé•¿å‡½æ•°ä»£ç  }</span><br>ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> harvest() { <span style="color: #008000;">//</span><span style="color: #008000;">è‹¹æœçš„æ”¶è·å‡½æ•°ä»£ç  }</span><br>ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> plant() { <span style="color: #008000;">//</span><span style="color: #008000;">è‹¹æœçš„ç§æ¤å‡½æ•°ä»£ç  }</span><br>ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> getTreeAge() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> treeAge; }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setTreeAge(<span style="color: #0000ff;">int</span> treeAge) { <span style="color: #0000ff;">this</span>.treeAge =<span style="color: #000000;"> treeAge; }<br>}</span></pre><br></div>

<p><span>Grape.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Grape <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Fruit<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> seedless;<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> grow() { <span style="color: #008000;">//</span><span style="color: #008000;">è‘¡è„çš„ç”Ÿé•¿å‡½æ•°ä»£ç  }</span><br>ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> harvest() { <span style="color: #008000;">//</span><span style="color: #008000;">è‘¡è„çš„æ”¶è·å‡½æ•°ä»£ç  }</span><br>ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> plant() { <span style="color: #008000;">//</span><span style="color: #008000;">è‘¡è„çš„ç§æ¤å‡½æ•°ä»£ç  }</span><br><br>ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span> getSeedless() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> seedless; }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setSeedless(<span style="color: #0000ff;">boolean</span> seedless) { <span style="color: #0000ff;">this</span>.seedless =<span style="color: #000000;"> seedless; }<br>}</span></pre><br></div>

<p><span>Strawberry.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> Strawberry <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Fruit<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> coteless;<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> grow() { <span style="color: #008000;">//</span><span style="color: #008000;">è‰è“çš„ç”Ÿé•¿å‡½æ•°ä»£ç  }</span><br>ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> harvest() { <span style="color: #008000;">//</span><span style="color: #008000;">è‰è“çš„æ”¶è·å‡½æ•°ä»£ç  }</span><br>ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> plant() { <span style="color: #008000;">//</span><span style="color: #008000;">è‰è“çš„ç§æ¤å‡½æ•°ä»£ç  }</span><br>ã€€ã€€<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span> getCoteless() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> coteless; }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setCoteless(<span style="color: #0000ff;">boolean</span> coteless) { <span style="color: #0000ff;">this</span>. coteless =<span style="color: #000000;"> coteless; }<br>}</span></pre><br></div>

<p><span>ä¸‹é¢çš„æºç å°±æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„é‡ç‚¹äº†ï¼Œåœ¨ç®€å•å·¥å‚æ¨¡å¼ä¸­ï¼Œå°†è¿™é‡Œå°†FruitGardenerå®š</span><span>ä¹‰ä¸ºä¸€ä¸ªç±»ï¼Œå³å›­ä¸è¦ç®¡ç†å›­é‡Œçš„æ‰€æœ‰æ°´æœï¼Œå¦‚æœå›­ä¸å“ªå¤©ç—…äº†ï¼Œæ°´æœéƒ½ä¸èƒ½ç®¡ç†äº†</span><span>åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­å°†FruitGardenerå®šä¹‰ä¸ºä¸€ä¸ªæ¥å£ï¼Œè€Œå°†ç®¡ç†æ°´æœçš„è§’è‰²åˆ’åˆ†å¾—æ›´ç»†ï¼Œ</span><span>æ¯”å¦‚æœ‰</span><span>è‘¡è„å›­ä¸ã€è‰è“å›­ä¸ã€è‹¹æœå›­ä¸ç­‰ç­‰å…·ä½“è§’è‰²ï¼Œå®ç°FruitGardeneræ¥å£çš„å·¥å‚</span><span>æ–¹æ³•æºç å¦‚ä¸‹æ‰€ç¤ºï¼š</span><br><span>æ¥å£FruitGardenerçš„æºç ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> FruitGardener<br>{<br>ã€€ã€€Fruit factory();<br>}</span></pre><br></div>

<p><span>è‹¹æœå›­ä¸ç±»AppleGardener.javaçš„æºç ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> AppleGardener <span style="color: #0000ff;">implements</span><span style="color: #000000;"> FruitGardener<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> Fruit factory() { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> Apple(); }<br>}</span></pre><br></div>

<p><span>è‘¡è„å›­ä¸ç±»GrapeGardener.javaçš„æºç ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> GrapeGardener <span style="color: #0000ff;">implements</span><span style="color: #000000;"> FruitGardener<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> Fruit factory() { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> Grape(); }<br>}</span></pre><br></div>

<p><span>è‰è“å›­ä¸ç±»StrawberryGardener.javaçš„æºç ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> StrawberryGardener <span style="color: #0000ff;">implements</span><span style="color: #000000;"> FruitGardener<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> Fruit factory() { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> Strawberry(); }<br>}</span></pre><br></div>

<p><span>ç”±ä»¥ä¸Šæºç å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¿æŒäº†ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œå…‹æœäº†å…¶ç¼ºç‚¹ï¼Œ</span><span>å½“åœ¨ç³»ç»Ÿä¸­å¼•å…¥æ–°äº§å“æ—¶ï¼Œæ—¢ä¸å¿…ä¿®æ”¹å®¢æˆ·ç«¯ï¼Œåˆä¸å¿…ä¿®æ”¹å…·ä½“å·¥å‚è§’è‰²å¯ä»¥è¾ƒå¥½</span><span>çš„å¯¹ç³»ç»Ÿè¿›è¡Œæ‰©å±•</span></p>
<p><span>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“</span></p>
<p><span><strong>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼š</strong><br><span>ç°åœ¨å·¥å‚å†æ¬¡å¤§å‘å±•ï¼Œè¦å¼•è¿›å¡‘æ–™å¤§æ£šæŠ€æœ¯ï¼Œåœ¨å¤§æ£šé‡Œç§æ¤çƒ­å¸¦ï¼ˆTropicalï¼‰å’Œäºšçƒ­å¸¦çš„</span><span>æ°´æœå’Œè”¬èœï¼ˆVeggieï¼‰å…¶ä¸­æ°´æœåˆ†ä¸ºTropicalFruitå’ŒNorthernFruitï¼Œè”¬èœåˆ†ä¸ºTropicalVeggie</span><span>å’ŒNorthernVeggieå›­ä¸åŒ…æ‹¬TropicalGardenerå’ŒNorthernGardenerä¹Ÿå°±æ˜¯è¯´ï¼Œ</span><span>TropicalGardenerä¸“é—¨ç®¡ç†TropicalFruitå’ŒTropicalGardenerï¼ŒNorthernGardenerä¸“é—¨</span><span>ç®¡ç†NorthernFruitå’ŒNorthernVeggieæŠ½è±¡å·¥å‚æ¨¡å¼åœ¨è¿™ä¸ªä¾‹å­ä¸­çš„æºç å¦‚ä¸‹æ‰€ç¤ºï¼š</span><br><span>Fruit.java:</span></span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span> Fruit { }</pre><br></div>

<p><span>NorthernFruit.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> NorthernFruit <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Fruit<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br>ã€€ã€€</span><span style="color: #0000ff;">public</span><span style="color: #000000;"> NorthernFruit(String name) { }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> String getName() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> name; }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setName(String name) { <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name; }<br>}</span></pre><br></div>

<p><span>TropicalFruit.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TropicalFruit <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Fruit<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br>ã€€ã€€</span><span style="color: #0000ff;">public</span><span style="color: #000000;"> TropicalFruit(String name) { }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> String getName() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> name; }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setName(String name) { <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name; }<br>}</span></pre><br></div>

<p><span>Veggie.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span> Veggie { }</pre><br></div>

<p><span>TropicalVeggie.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TropicalVeggie <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Veggie<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br>ã€€ã€€</span><span style="color: #0000ff;">public</span><span style="color: #000000;"> TropicalVeggie(String name) { }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> String getName() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> name; }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setName(String name) { <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name; }<br>}</span></pre><br></div>

<p><span>NorthernVeggie.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> NorthernVeggie <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Veggie<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br>ã€€ã€€</span><span style="color: #0000ff;">public</span><span style="color: #000000;"> NorthernVeggie(String name) { }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> String getName() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> name; }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setName(String name) { <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name; }<br>}</span></pre><br></div>

<p><span>Gardener.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Gardener<br>{<br>ã€€ã€€Fruit createFruit(String name);<br>ã€€ã€€Veggie createVeggie(String name);<br>}</span></pre><br></div>

<p><span>TropicalGardener.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TropicalGardener <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Gardener<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> Fruit createFruit(String name) { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> TropicalFruit(name); }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> Veggie createVeggie(String name) { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> TropicalVeggie(name); }<br>}</span></pre><br></div>

<p><span>NorthernGardener.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> NorthernGardener <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Gardener<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> Fruit createFruit(String name) { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> NorthernFruit(name); }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> Veggie createVeggie(String name) { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> NorthernVeggie(name); }<br>}</span></pre><br></div>

<p><span>ä¸ºäº†ç®€å•èµ·è§ï¼Œè¿™é‡Œåªè®²ä¸€ä¸‹å¢åŠ æ–°äº§å“ï¼ˆæ—ï¼‰æ—¶è¯¥ç³»ç»Ÿå¦‚ä½•æ‰©å±•ï¼ˆå…³äºäº§å“æ—ç›¸å…³</span><span>çŸ¥è¯†ï¼Œè¯·çœ‹æ­¤ä¹¦çš„ç›¸å…³ç« èŠ‚ï¼Œä¸è¿‡ä¸æ‡‚äº§å“æ—ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œè¿™é‡Œå†™å¾—å¾ˆç®€å•ï¼Œè‚¯å®šèƒ½</span><span>çœ‹æ‡‚ï¼‰æ¯”å¦‚ç°åœ¨è¦å¢åŠ å—æ–¹æ°´æœï¼ˆSouthFruitï¼‰å’Œå—æ–¹è”¬èœï¼ˆSouthVeggieï¼‰é‚£</span><span>ä¹ˆåªè¦å¢åŠ å¦‚ä¸‹ä»£ç å³å¯å¾ˆå®¹æ˜“çš„æ‰©å±•ï¼š</span><br><span>SouthFruit.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> SouthFruit <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Fruit<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br>ã€€ã€€</span><span style="color: #0000ff;">public</span><span style="color: #000000;"> SouthFruit (String name) { }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> String getName() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> name; }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setName(String name) { <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name; }<br>}</span></pre><br></div>

<p><span>SouthVeggie.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> SouthVeggie <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Veggie<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String name;<br>ã€€ã€€</span><span style="color: #0000ff;">public</span><span style="color: #000000;"> SouthVeggie (String name) { }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> String getName() { <span style="color: #0000ff;">return</span><span style="color: #000000;"> name; }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setName(String name) { <span style="color: #0000ff;">this</span>.name =<span style="color: #000000;"> name; }<br>}</span></pre><br></div>

<p><span>SouthGardener.java:</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> SouthGardener <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Gardener<br>{<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> Fruit createFruit(String name) { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> SouthFruit(name); }<br>ã€€ã€€</span><span style="color: #0000ff;">public</span> Veggie createVeggie(String name) { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> SouthVeggie(name); }<br>}</span></pre><br></div>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> pattern </tag>
            
            <tag> factory </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[java ç­–ç•¥æ¨¡å¼]]></title>
      <url>/2012/11/19/java-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p><strong>å®šä¹‰ï¼š</strong>å®šä¹‰ä¸€ç»„ç®—æ³•ï¼Œå°†æ¯ä¸ªç®—æ³•éƒ½å°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿ä»–ä»¬ä¹‹é—´å¯ä»¥äº’æ¢ã€‚</p>
<p><strong>ç±»å‹ï¼š</strong>è¡Œä¸ºç±»æ¨¡å¼</p>
<p><strong>ç±»å›¾ï¼š</strong></p>
<p><img src="http://my.csdn.net/uploads/201205/28/1338191755_7367.jpg" alt=""></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç­–ç•¥æ¨¡å¼æ˜¯å¯¹ç®—æ³•çš„å°è£…ï¼ŒæŠŠä¸€ç³»åˆ—çš„ç®—æ³•åˆ†åˆ«å°è£…åˆ°å¯¹åº”çš„ç±»ä¸­ï¼Œå¹¶ä¸”è¿™äº›ç±»å®ç°ç›¸åŒçš„æ¥å£ï¼Œç›¸äº’ä¹‹é—´å¯ä»¥æ›¿æ¢ã€‚åœ¨å‰é¢è¯´è¿‡çš„è¡Œä¸ºç±»æ¨¡å¼ä¸­ï¼Œæœ‰ä¸€ç§æ¨¡å¼ä¹Ÿæ˜¯å…³æ³¨å¯¹ç®—æ³•çš„å°è£…&mdash;&mdash;æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ï¼Œå¯¹ç…§ç±»å›¾å¯ä»¥çœ‹åˆ°ï¼Œç­–ç•¥æ¨¡å¼ä¸æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼çš„åŒºåˆ«ä»…ä»…æ˜¯å¤šäº†ä¸€ä¸ªå•ç‹¬çš„å°è£…ç±»Contextï¼Œå®ƒä¸æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼çš„åŒºåˆ«åœ¨äºï¼šåœ¨æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ä¸­ï¼Œè°ƒç”¨ç®—æ³•çš„ä¸»ä½“åœ¨æŠ½è±¡çš„çˆ¶ç±»ä¸­ï¼Œè€Œåœ¨ç­–ç•¥æ¨¡å¼ä¸­ï¼Œè°ƒç”¨ç®—æ³•çš„ä¸»ä½“åˆ™æ˜¯å°è£…åˆ°äº†å°è£…ç±»Contextä¸­ï¼ŒæŠ½è±¡ç­–ç•¥Strategyä¸€èˆ¬æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç›®çš„åªæ˜¯ä¸ºäº†å®šä¹‰è§„èŒƒï¼Œé‡Œé¢ä¸€èˆ¬ä¸åŒ…å«é€»è¾‘ã€‚å…¶å®ï¼Œè¿™åªæ˜¯é€šç”¨å®ç°ï¼Œè€Œåœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œå› ä¸ºå„ä¸ªå…·ä½“ç­–ç•¥å®ç°ç±»ä¹‹é—´éš¾å…å­˜åœ¨ä¸€äº›ç›¸åŒçš„é€»è¾‘ï¼Œä¸ºäº†é¿å…é‡å¤çš„ä»£ç ï¼Œæˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨æŠ½è±¡ç±»æ¥æ‹…ä»»Strategyçš„è§’è‰²ï¼Œåœ¨é‡Œé¢å°è£…å…¬å…±çš„ä»£ç ï¼Œå› æ­¤ï¼Œåœ¨å¾ˆå¤šåº”ç”¨çš„åœºæ™¯ä¸­ï¼Œåœ¨ç­–ç•¥æ¨¡å¼ä¸­ä¸€èˆ¬ä¼šçœ‹åˆ°æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼çš„å½±å­ã€‚</p>
<p>&nbsp;</p>
<p><strong>ç­–ç•¥æ¨¡å¼çš„ç»“æ„</strong></p>
<ul>
<li><strong>å°è£…ç±»ï¼š</strong>ä¹Ÿå«ä¸Šä¸‹æ–‡ï¼Œå¯¹ç­–ç•¥è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œç›®çš„æ˜¯é¿å…é«˜å±‚æ¨¡å—å¯¹ç­–ç•¥çš„ç›´æ¥è°ƒç”¨ã€‚</li>
<li><strong>æŠ½è±¡ç­–ç•¥ï¼š</strong>é€šå¸¸æƒ…å†µä¸‹ä¸ºä¸€ä¸ªæ¥å£ï¼Œå½“å„ä¸ªå®ç°ç±»ä¸­å­˜åœ¨ç€é‡å¤çš„é€»è¾‘æ—¶ï¼Œåˆ™ä½¿ç”¨æŠ½è±¡ç±»æ¥å°è£…è¿™éƒ¨åˆ†å…¬å…±çš„ä»£ç ï¼Œæ­¤æ—¶ï¼Œç­–ç•¥æ¨¡å¼çœ‹ä¸Šå»æ›´åƒæ˜¯æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ã€‚</li>
<li><strong>å…·ä½“ç­–ç•¥ï¼š</strong>å…·ä½“ç­–ç•¥è§’è‰²é€šå¸¸ç”±ä¸€ç»„å°è£…äº†ç®—æ³•çš„ç±»æ¥æ‹…ä»»ï¼Œè¿™äº›ç±»ä¹‹é—´å¯ä»¥æ ¹æ®éœ€è¦è‡ªç”±æ›¿æ¢ã€‚</li>
</ul>
<p><span>&nbsp;</span></p>
<p><strong>ç­–ç•¥æ¨¡å¼çš„ä¼˜ç¼ºç‚¹</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç­–ç•¥æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹æœ‰ï¼š</p>
<ul>
<li>ç­–ç•¥ç±»ä¹‹é—´å¯ä»¥è‡ªç”±åˆ‡æ¢ï¼Œç”±äºç­–ç•¥ç±»å®ç°è‡ªåŒä¸€ä¸ªæŠ½è±¡ï¼Œæ‰€ä»¥ä»–ä»¬ä¹‹é—´å¯ä»¥è‡ªç”±åˆ‡æ¢ã€‚</li>
<li>æ˜“äºæ‰©å±•ï¼Œå¢åŠ ä¸€ä¸ªæ–°çš„ç­–ç•¥å¯¹ç­–ç•¥æ¨¡å¼æ¥è¯´éå¸¸å®¹æ˜“ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥åœ¨ä¸æ”¹å˜åŸæœ‰ä»£ç çš„åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ã€‚</li>
<li>é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶ï¼Œå¦‚æœä¸ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œå¯¹äºæ‰€æœ‰çš„ç®—æ³•ï¼Œå¿…é¡»ä½¿ç”¨æ¡ä»¶è¯­å¥è¿›è¡Œè¿æ¥ï¼Œé€šè¿‡æ¡ä»¶åˆ¤æ–­æ¥å†³å®šä½¿ç”¨å“ªä¸€ç§ç®—æ³•ï¼Œåœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å·²ç»æåˆ°ï¼Œä½¿ç”¨å¤šé‡æ¡ä»¶åˆ¤æ–­æ˜¯éå¸¸ä¸å®¹æ˜“ç»´æŠ¤çš„ã€‚</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹ä¸»è¦æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li>ç»´æŠ¤å„ä¸ªç­–ç•¥ç±»ä¼šç»™å¼€å‘å¸¦æ¥é¢å¤–å¼€é”€ï¼Œå¯èƒ½å¤§å®¶åœ¨è¿™æ–¹é¢éƒ½æœ‰ç»éªŒï¼šä¸€èˆ¬æ¥è¯´ï¼Œç­–ç•¥ç±»çš„æ•°é‡è¶…è¿‡5ä¸ªï¼Œå°±æ¯”è¾ƒä»¤äººå¤´ç–¼äº†ã€‚</li>
<li>å¿…é¡»å¯¹å®¢æˆ·ç«¯ï¼ˆè°ƒç”¨è€…ï¼‰æš´éœ²æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå› ä¸ºä½¿ç”¨å“ªç§ç­–ç•¥æ˜¯ç”±å®¢æˆ·ç«¯æ¥å†³å®šçš„ï¼Œå› æ­¤ï¼Œå®¢æˆ·ç«¯åº”è¯¥çŸ¥é“æœ‰ä»€ä¹ˆç­–ç•¥ï¼Œå¹¶ä¸”äº†è§£å„ç§ç­–ç•¥ä¹‹é—´çš„åŒºåˆ«ï¼Œå¦åˆ™ï¼Œåæœå¾ˆä¸¥é‡ã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ªæ’åºç®—æ³•çš„ç­–ç•¥æ¨¡å¼ï¼Œæä¾›äº†å¿«é€Ÿæ’åºã€å†’æ³¡æ’åºã€é€‰æ‹©æ’åºè¿™ä¸‰ç§ç®—æ³•ï¼Œå®¢æˆ·ç«¯åœ¨ä½¿ç”¨è¿™äº›ç®—æ³•ä¹‹å‰ï¼Œæ˜¯ä¸æ˜¯å…ˆè¦æ˜ç™½è¿™ä¸‰ç§ç®—æ³•çš„é€‚ç”¨æƒ…å†µï¼Ÿå†æ¯”å¦‚ï¼Œå®¢æˆ·ç«¯è¦ä½¿ç”¨ä¸€ä¸ªå®¹å™¨ï¼Œæœ‰é“¾è¡¨å®ç°çš„ï¼Œä¹Ÿæœ‰æ•°ç»„å®ç°çš„ï¼Œå®¢æˆ·ç«¯æ˜¯ä¸æ˜¯ä¹Ÿè¦æ˜ç™½é“¾è¡¨å’Œæ•°ç»„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå°±è¿™ä¸€ç‚¹æ¥è¯´æ˜¯æœ‰æ‚–äºè¿ªç±³ç‰¹æ³•åˆ™çš„ã€‚</li>
</ul>
<p>&nbsp;</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åšé¢å‘å¯¹è±¡è®¾è®¡çš„ï¼Œå¯¹ç­–ç•¥æ¨¡å¼ä¸€å®šå¾ˆç†Ÿæ‚‰ï¼Œå› ä¸ºå®ƒå®è´¨ä¸Šå°±æ˜¯é¢å‘å¯¹è±¡ä¸­çš„ç»§æ‰¿å’Œå¤šæ€ï¼Œåœ¨çœ‹å®Œç­–ç•¥æ¨¡å¼çš„é€šç”¨ä»£ç åï¼Œæˆ‘æƒ³ï¼Œå³ä½¿ä¹‹å‰ä»æ¥æ²¡æœ‰å¬è¯´è¿‡ç­–ç•¥æ¨¡å¼ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¹Ÿä¸€å®šä½¿ç”¨è¿‡å®ƒå§ï¼Ÿè‡³å°‘åœ¨åœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸‹ï¼Œå¤§å®¶å¯ä»¥è€ƒè™‘ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œ</p>
<ul>
<li>å‡ ä¸ªç±»çš„ä¸»è¦é€»è¾‘ç›¸åŒï¼Œåªåœ¨éƒ¨åˆ†é€»è¾‘çš„ç®—æ³•å’Œè¡Œä¸ºä¸Šç¨æœ‰åŒºåˆ«çš„æƒ…å†µã€‚</li>
<li>æœ‰å‡ ç§ç›¸ä¼¼çš„è¡Œä¸ºï¼Œæˆ–è€…è¯´ç®—æ³•ï¼Œå®¢æˆ·ç«¯éœ€è¦åŠ¨æ€åœ°å†³å®šä½¿ç”¨å“ªä¸€ç§ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œå°†è¿™äº›ç®—æ³•å°è£…èµ·æ¥ä¾›å®¢æˆ·ç«¯è°ƒç”¨ã€‚</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ç­–ç•¥æ¨¡å¼æ˜¯ä¸€ç§ç®€å•å¸¸ç”¨çš„æ¨¡å¼ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œå¼€å‘çš„æ—¶å€™ï¼Œä¼šç»å¸¸æœ‰æ„æ— æ„åœ°ä½¿ç”¨å®ƒï¼Œä¸€èˆ¬æ¥è¯´ï¼Œç­–ç•¥æ¨¡å¼ä¸ä¼šå•ç‹¬ä½¿ç”¨ï¼Œè·Ÿæ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ã€å·¥å‚æ¨¡å¼ç­‰æ··åˆä½¿ç”¨çš„æƒ…å†µæ¯”è¾ƒå¤šã€‚</p>
<p>&nbsp;</p>
<p>åº”ç”¨åœºæ™¯ä¸¾ä¾‹ï¼š</p>
<p>åˆ˜å¤‡è¦åˆ°æ±Ÿä¸œå¨¶è€å©†äº†ï¼Œèµ°ä¹‹å‰è¯¸è‘›äº®ç»™èµµäº‘ï¼ˆä¼´éƒï¼‰ä¸‰ä¸ªé”¦å›Šå¦™è®¡ï¼Œè¯´æ˜¯æŒ‰å¤©æœºæ‹†å¼€èƒ½è§£å†³æ£˜æ‰‹é—®é¢˜ï¼Œå˜¿ï¼Œè¿˜åˆ«è¯´ï¼ŒçœŸè§£å†³äº†å¤§é—®é¢˜ï¼Œæåˆ°æœ€åæ˜¯å‘¨ç‘œé™ªäº†å¤«äººåˆæŠ˜å…µï¼Œé‚£å’±ä»¬å…ˆçœ‹çœ‹è¿™ä¸ªåœºæ™¯æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</p>
<p>å…ˆè¯´è¯´è¿™ä¸ªåœºæ™¯ä¸­çš„è¦ç´ ï¼šä¸‰ä¸ªå¦™è®¡ï¼Œä¸€ä¸ªé”¦å›Šï¼Œä¸€ä¸ªèµµäº‘ï¼Œå¦™è®¡æ˜¯äº®å“¥ç»™çš„ï¼Œå¦™è®¡æ”¾åœ¨é”¦å›Šé‡Œï¼Œä¿—ç§°å°±æ˜¯é”¦å›Šå¦™è®¡å˜›ï¼Œé‚£èµµäº‘å°±æ˜¯ä¸€ä¸ªå¹²æ´»çš„äººï¼Œä»é”¦å›Šå–å‡ºå¦™è®¡ï¼Œæ‰§è¡Œï¼Œç„¶åè·èƒœã€‚ç”¨javaç¨‹åºæ€ä¹ˆè¡¨ç°è¿™äº›å‘¢ï¼Ÿ</p>
<p><span>&nbsp;</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.yangguangfu.strategy;<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> 
 <br> <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> trygf521@126.com:é˜¿ç¦ 
  é¦–å…ˆå®šä¹‰ä¸€ä¸ªç­–ç•¥æ¥å£ï¼Œè¿™æ˜¯è¯¸è‘›äº®è€äººå®¶ç»™èµµäº‘çš„ä¸‰ä¸ªé”¦å›Šå¦™è®¡çš„æ¥å£ã€‚<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> IStrategy {<br>    </span><span style="color: #008000;">//</span><span style="color: #008000;">æ¯ä¸ªé”¦å›Šå¦™è®¡éƒ½æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„ç®—æ³•ã€‚  </span><br>    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> operate();<br><br>}  </span></pre><br></div>

<p><span>ç„¶åå†å†™ä¸‰ä¸ªå®ç°ç±»ï¼Œæœ‰ä¸‰ä¸ªå¦™è®¡å˜›ï¼š</span></p>
<p><span><span>å¦™è®¡ä¸€ï¼šåˆåˆ°å´å›½ï¼š</span></span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.yangguangfu.strategy;<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> 
 <br> <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> trygf521@126.com:é˜¿ç¦ 
  æ‰¾ä¹”å›½è€å¸®å¿™ï¼Œä½¿å­™æƒä¸èƒ½æ€åˆ˜å¤‡ã€‚<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> BackDoor <span style="color: #0000ff;">implements</span><span style="color: #000000;"> IStrategy {<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> operate() {<br>        System.out.println(</span>â€œæ‰¾ä¹”å›½è€å¸®å¿™ï¼Œè®©å´å›½å¤ªç»™å­™æƒæ–½åŠ å‹åŠ›ï¼Œä½¿å­™æƒä¸èƒ½æ€åˆ˜å¤‡â€¦â€<span style="color: #000000;">);<br>    }<br><br>}  </span></pre><br></div>

<p>&nbsp;</p>
<p><span>å¦™è®¡äºŒï¼šæ±‚å´å›½å¤ªå¼€ä¸ªç»¿ç¯ï¼Œæ”¾è¡Œï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.yangguangfu.strategy;<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> 
 <br> <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> trygf521@126.com:é˜¿ç¦ 
  æ±‚å´å›½å¤ªå¼€ä¸ªç»¿ç¯ã€‚<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> GivenGreenLight <span style="color: #0000ff;">implements</span><span style="color: #000000;"> IStrategy {<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> operate() {<br>        System.out.println(</span>â€œæ±‚å´å›½å¤ªå¼€ä¸ªç»¿ç¯ï¼Œæ”¾è¡Œï¼â€<span style="color: #000000;">);<br><br>    }<br><br>}  </span></pre><br></div>

<p><span>å¦™è®¡ä¸‰ï¼šå­™å¤«äººæ–­åï¼ŒæŒ¡ä½è¿½å…µï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.yangguangfu.strategy;<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> 
 <br> <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> trygf521@126.com:é˜¿ç¦ 
  å­™å¤«äººæ–­åï¼ŒæŒ¡ä½è¿½å…µã€‚<br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> BlackEnemy <span style="color: #0000ff;">implements</span><span style="color: #000000;"> IStrategy {<br><br>    @Override<br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> operate() {<br>        System.out.println(</span>â€œå­™å¤«äººæ–­åï¼ŒæŒ¡ä½è¿½å…µâ€¦â€<span style="color: #000000;">);<br><br>    }<br><br>}  </span></pre><br></div>

<p><span>å¥½äº†ï¼Œå¤§å®¶çœ‹çœ‹ï¼Œä¸‰ä¸ªå¦™è®¡æ˜¯æœ‰äº†ï¼Œé‚£éœ€è¦æœ‰ä¸ªåœ°æ–¹æ”¾å¦™è®¡å•Šï¼Œæ”¾é”¦å›Šé‡Œï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.yangguangfu.strategy;<br></span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> 
 <br> <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> trygf521@126.com:é˜¿ç¦ 
 <br> </span><span style="color: #008000;">*/</span><br><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Context {<br><br>    </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> IStrategy strategy;<br>    </span><span style="color: #008000;">//</span><span style="color: #008000;">æ„é€ å‡½æ•°ï¼Œè¦ä½ ä½¿ç”¨å“ªä¸ªå¦™è®¡  </span><br>    <span style="color: #0000ff;">public</span><span style="color: #000000;"> Context(IStrategy strategy){<br>        </span><span style="color: #0000ff;">this</span>.strategy =<span style="color: #000000;"> strategy;<br>    }<br><br>    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> operate(){<br>        </span><span style="color: #0000ff;">this</span><span style="color: #000000;">.strategy.operate();<br>    }<br><br>}  </span></pre><br></div>

<p><span>ç„¶åå°±æ˜¯èµµäº‘é›„èµ³èµ³çš„æ£ç€ä¸‰ä¸ªé”¦å›Šï¼Œæ‹‰ç€å·²æ­¥å…¥è€å¹´è¡Œåˆ—ï¼Œè¿˜æƒ³ç€å¨¶çº¯æƒ…å°‘å¥³çš„ï¼Œè‰²å’ªå’ªçš„åˆ˜å¤‡è€çˆ·å­å»å…¥èµ˜äº†ï¼Œå—¨ï¼Œè¿˜åˆ«è¯´ï¼Œäº®å“¥çš„ä¸‰ä¸ªå¦™è®¡è¿˜çœŸä¸é”™ï¼Œç§ç§ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.yangguangfu.strategy;<br><br></span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ZhaoYun {<br><br>    </span><span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> 
      èµµäº‘å‡ºåœºäº†ï¼Œä»–æ ¹æ®è¯¸è‘›äº®ç»™ä»–çš„äº¤ä»£ï¼Œä¾æ¬¡æ‹†å¼€å¦™è®¡<br>     </span><span style="color: #008000;">*/</span><br>    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {<br>        Context context;<br><br>        </span><span style="color: #008000;">//</span><span style="color: #008000;">åˆšåˆ°å´å›½çš„æ—¶å€™æ‹†å¼€ç¬¬ä¸€ä¸ª  </span><br>        System.out.println(â€œâ€”â€”â€”-åˆšåˆšåˆ°å´å›½çš„æ—¶å€™æ‹†å¼€ç¬¬ä¸€ä¸ªâ€”â€”â€”â€”â€”â€œ<span style="color: #000000;">);<br>        context </span>= <span style="color: #0000ff;">new</span> Context(<span style="color: #0000ff;">new</span><span style="color: #000000;"> BackDoor());<br>        context.operate();</span><span style="color: #008000;">//</span><span style="color: #008000;">æ‹†å¼€æ‰§è¡Œ  </span><br>        System.out.println(â€œ\n\n\n\n\n\n\n\n\n\n\n\n\nâ€<span style="color: #000000;">);<br><br>        </span><span style="color: #008000;">//</span><span style="color: #008000;">å½“åˆ˜å¤‡ä¹ä¸æ€èœ€æ—¶ï¼Œæ‹†å¼€ç¬¬äºŒä¸ª  </span><br>        System.out.println(â€œâ€”â€”â€”-åˆ˜å¤‡ä¹ä¸æ€èœ€ï¼Œæ‹†ç¬¬äºŒä¸ªäº†â€”â€”â€”â€”â€”â€œ<span style="color: #000000;">);<br>        context </span>= <span style="color: #0000ff;">new</span> Context(<span style="color: #0000ff;">new</span><span style="color: #000000;"> GivenGreenLight());<br>        context.operate();</span><span style="color: #008000;">//</span><span style="color: #008000;">æ‹†å¼€æ‰§è¡Œ  </span><br>        System.out.println(â€œ\n\n\n\n\n\n\n\n\n\n\n\n\nâ€<span style="color: #000000;">);<br><br>        </span><span style="color: #008000;">//</span><span style="color: #008000;">å­™æƒçš„å°è¿½å…µäº†ï¼Œå’‹åŠï¼Ÿæ‹†å¼€ç¬¬ä¸‰ä¸ªé”¦å›Š  </span><br>        System.out.println(â€œâ€”â€”â€”-å­™æƒçš„å°è¿½å…µäº†ï¼Œå’‹åŠï¼Ÿæ‹†å¼€ç¬¬ä¸‰ä¸ªé”¦å›Šâ€”â€”â€”â€”â€”â€œ<span style="color: #000000;">);<br>        context </span>= <span style="color: #0000ff;">new</span> Context(<span style="color: #0000ff;">new</span><span style="color: #000000;"> BlackEnemy());<br>        context.operate();</span><span style="color: #008000;">//</span><span style="color: #008000;">æ‹†å¼€æ‰§è¡Œ  </span><br>        System.out.println(â€œ\n\n\n\n\n\n\n\n\n\n\n\n\nâ€<span style="color: #000000;">);<br>    }<br><br>}  </span></pre><br></div>

<p><span>åè¯ï¼šå°±è¿™ä¸‰æ‹›ï¼Œæå¾—çš„å‘¨éƒæ˜¯&ldquo;èµ”äº†å¤«äººåˆæŠ˜å…µ&rdquo;å‘€ï¼è¿™å°±æ˜¯ç­–ç•¥æ¨¡å¼ï¼Œé«˜å†…èšä½è€¦åˆçš„ç‰¹ç‚¹ä¹Ÿè¡¨ç°å‡ºæ¥äº†ï¼Œè¿˜æœ‰ä¸€ä¸ªå°±æ˜¯æ‰©å±•æ€§ï¼Œä¹Ÿå°±æ˜¯OCPåŸåˆ™ï¼Œç­–ç•¥ç±»å¯ä»¥ç»§ç»­æ·»åŠ ä¸‹å»æ°”ï¼Œåªæ˜¯ä¿®æ”¹Context.javaå°±å¯ä»¥äº†ï¼Œè¿™ä¸ªä¸å¤šè¯´äº†ï¼Œè‡ªå·±é¢†ä¼šå§ã€‚</span></p>
<p>è½¬è‡ª&nbsp;<a href="http://yangguangfu.iteye.com/blog/815107" target="_blank" rel="noopener">http://yangguangfu.iteye.com/blog/815107</a>&nbsp;å’Œ&nbsp;<a href="http://blog.csdn.net/zhengzhb/article/details/7609670" target="_blank" rel="noopener">http://blog.csdn.net/zhengzhb/article/details/7609670</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> pattern </tag>
            
            <tag> strategy </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Zxing android è§£ææµç¨‹]]></title>
      <url>/2012/10/23/Zxing-android-%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>&nbsp;å¯¹äºåˆšå¼€å§‹å­¦ä¹ androidå¼€å‘çš„ç«¥é‹ä»¬æ¥è¯´ï¼Œè‹¥æœ‰ä¸€ä¸ªç®€å•è€Œåˆå…¨é¢çš„androidå·¥ç¨‹èƒ½æ¥å‰–æï¼Œé‚£å°±æ˜¯å†å¥½ä¸è¿‡äº†ï¼Œzxingå°±æ˜¯ä¸é”™å¾—ä¾‹å­ã€‚</p>
<div>&nbsp;&nbsp;&nbsp;&nbsp;zxingçš„æºç å¯ä»¥åˆ°google codeä¸Šä¸‹è½½ï¼Œæ•´ä¸ªæºç check out ä¸‹æ¥ï¼Œé‡Œé¢æœ‰å„ä¸ªå¹³å°çš„æºç ï¼Œiosçš„ï¼Œandroidçš„ã€‚å½“ç„¶æˆ‘ä»¬éœ€è¦çš„å°±æ˜¯androidä»£ç ã€‚</div><br><div>&nbsp;&nbsp;&nbsp;&nbsp;å°†androidçš„å·¥ç¨‹å¯¼å…¥åˆ°eclipseä¸­ï¼Œå¯¼å…¥å®Œæˆåï¼Œeclipseä¼šæ˜¾ç¤ºå„ç§é”™è¯¯ï¼Œè¿™æ˜¯ç¼ºå°‘coreæ–‡ä»¶å¤¹é‡Œé¢çš„æ ¸å¿ƒåº“æ–‡ä»¶æ‰€è‡´ï¼Œåœ¨projectä¸­åˆ›å»ºæ–‡ä»¶å¤¹coreï¼Œå†å°†zxingæºç ä¸­å¾—coreæ–‡ä»¶å¤¹ä¸‹å¾—ä»£ç å¯¼å…¥è¿›æ¥ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚</div><br><div>&nbsp;&nbsp;&nbsp;&nbsp;å¦‚æœé‡åˆ°unable resolved target-Xï¼Œåˆ™æ˜¯ä½ çš„avdç‰ˆæœ¬é—®é¢˜ï¼Œå¯ä»¥åœ¨project.propertitiesä¿®æ”¹targetå€¼ã€‚cleanä¸‹å°±okã€‚</div><br><div>&nbsp;&nbsp;&nbsp;&nbsp;å¦‚ä¸Šçš„éƒ½æ˜¯zxing androidä»£ç åˆ†æçš„å‡†å¤‡ï¼Œä¸‹é¢çš„åˆ™æ˜¯æ­£å¼å¼€å§‹ã€‚</div><br><div><br><br><img src="http://pic4.xihuan.me/dr/680__90/t02110ad14c2cdda9e7.png" alt=""><br><br></div><br><div>&nbsp;&nbsp;&nbsp;&nbsp;å¦‚ä¸Šå›¾ï¼šä¸ºæ•´ä¸ªandroidå·¥ç¨‹çš„ä»£ç ï¼Œandroidå…¥é—¨å°±é‡è¿™äº›ä»£ç ç€æ‰‹ã€‚å…¶ä¸­ä¸»è¦å…³æ³¨çš„æ˜¯androidï¼Œcameraï¼Œencodeï¼Œresultæ–‡ä»¶å¤¹ã€‚</div><br><div>&nbsp;&nbsp;&nbsp;ç¨‹åºå¯åŠ¨çš„æµç¨‹ï¼šåŠ è½½main activityï¼Œåœ¨æ­¤ç±»ä¸­åˆ›å»ºCaptureActivityHandlerå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯åŠ¨ç›¸æœºï¼Œå®ç°è‡ªåŠ¨èšç„¦ï¼Œåˆ›å»ºDecodeThreadçº¿ç¨‹ï¼ŒDecodeThreadåˆ›å»ºDecodehandlerï¼Œè¿™ä¸ªå¯¹è±¡å°±è·å–ä»ç›¸æœºå¾—åˆ°çš„åŸå§‹byteæ•°æ®ï¼Œå¼€å§‹è§£ç çš„ç¬¬ä¸€æ­¥å·¥ä½œï¼Œä»è·å–çš„byteä¸­è§£æqrå›¾æ¥ï¼Œå¹¶è§£æå‡ºqrå›¾ä¸­çš„å­—ç¬¦ï¼Œå°†è¿™å—æ²¡æœ‰åˆ†æçš„å­—ç¬¦æŠ›é€åˆ°CaptureActivityHandlerä¸­handleï¼Œè¯¥ç±»è°ƒç”¨main activityçš„decodeå‡½æ•°å®Œæˆå¯¹å­—ç¬¦çš„åˆ†æï¼Œæœ€åæ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šï¼ˆåˆ·æ–°UIï¼Œæœ€å¥½åœ¨UIçº¿ç¨‹é‡Œå®Œæˆï¼‰ã€‚è¿™æ ·ä¸€ä¸ªè§£æqrå›¾çš„è¿‡ç¨‹å¹¶å®Œæˆã€‚</div><br><div>&nbsp;&nbsp;&nbsp;ä¸‹é¢å…·ä½“åˆ†ææ•´ä¸ªè¿‡ç¨‹ã€‚é‡ç‚¹ä¹‹å¤„æœ‰main activity,camera.</div><br><div>&nbsp;&nbsp;&nbsp;ç¨‹åºå¯åŠ¨çš„ç¬¬ä¸€ä¸ªactivityä¾¿æ˜¯ï¼šCaptureActivity,æœ‰ç‚¹ç±»ä¼¼äºcä¸­çš„mainå‡½æ•°ï¼Œåœ¨æ­¤æ˜¯main activityã€‚è¿™ä¸ªacitvityåšçš„ä¸»è¦çš„äº‹ä¾¿æ˜¯ï¼šåŠ è½½æ‰«æå„ç§æ¡å½¢ç ï¼ŒäºŒç»´ç çš„ä¸€ä¸ªç•Œé¢ï¼Œå¯åŠ¨ä¸€ä¸ªå¤„ç†è·å–ä¸€ç»´ç äºŒç»´ç ä¿¡æ¯çš„çº¿ç¨‹ï¼Œå®Œæˆå¯¹äºè·å–çš„å›¾åƒä¿¡æ¯è¿›è¡Œè§£ç ï¼Œæœ€åå†å°†è§£ç çš„ä¿¡æ¯æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šã€‚</div><br><div>&nbsp;&nbsp;&nbsp;</div><br><div>&nbsp;&nbsp;&nbsp;å®Œæˆç•Œé¢çš„åŠ è½½ä¸»è¦åœ¨äºonCreateï¼Œå’ŒonResumeå‡½æ•°ä¸­ï¼Œè¿™æ¶‰åŠåˆ°äº†ä¸€ä¸ªactivityçš„ç”Ÿå‘½å‘¨æœŸï¼Œä»¥åå†å…·ä½“åˆ†æã€‚é¦–å…ˆè°ƒç”¨onCreateï¼Œå†è°ƒç”¨onResumeï¼Œåœ¨onResumeä¸­ä¼šåˆ¤æ–­è¿™ä¸ªactivityæ˜¯ç”±ä»€ä¹ˆå¯åŠ¨çš„ï¼Œå¯èƒ½æ˜¯å…¶ä»–çš„appè§¦å‘äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”¨æˆ·ç›´æ¥å¯åŠ¨çš„ã€‚è¿™æ ·å°±åˆå§‹åŒ–äº†ä¸‰ä¸ªå˜é‡ï¼Œä¸€æ˜¯sourceï¼Œä¾¿æ˜¯å¯åŠ¨activityçš„æºï¼Œä¸€æ˜¯decodeFormatsï¼ŒæŒ‡å‡ºè§£ç çš„æ–¹å¼ï¼Œæ˜¯qrï¼Œè¿˜æ˜¯å…¶ä»–çš„ç­‰ç­‰ï¼Œæœ€åä¸€ä¸ªæ˜¯ï¼šcharactresetï¼Œå³æ˜¯å¯¹äºè¿™äº›ç”Ÿæˆqrå›¾çš„å­—ç¬¦çš„ç¼–ç æ–¹å¼ã€‚è‹¥æ²¡æœ‰å¯¹coreä¸­å¾—ä»£ç ä¿®æ”¹ï¼Œç”¨è¯¥ç¨‹åºè§£æGB2312ç¼–ç çš„å­—ç¬¦åˆ™ä¼šä¹±ç ã€‚ä¹±ç çš„è§£å†³åé¢å°†æåˆ°ã€‚</div><br><div>&nbsp;&nbsp;&nbsp;ç•Œé¢çš„åŠ è½½ä¸­æœ‰ä¸¤ä¸ªå¾ˆå…³é”®çš„ç±»ã€‚surfaceview å’Œ ViewFinderViewï¼Œå‰é¢çš„æ˜¯ç”¨æ¥åŠ è½½ä»åº•å±‚ç¡¬ä»¶è·å–çš„ç›¸æœºå–æ™¯çš„å›¾åƒï¼Œåé¢çš„æ˜¯è‡ªå®šä¹‰çš„viewï¼Œå®ç°äº†æ‰«ææ—¶çš„ç•Œé¢ï¼Œä¸åœçš„åˆ·æ–°ï¼Œå¹¶å°†è¯†åˆ«çš„ä¸€äº›æ•°æ®ï¼Œå¦‚å®šä½çš„ç‚¹å›è°ƒæ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šã€‚</div>

]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> zxing </tag>
            
            <tag> qr </tag>
            
            <tag> qrcode </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[EditTextçš„å±æ€§ä»‹ç»]]></title>
      <url>/2012/10/15/EditText%E7%9A%84%E5%B1%9E%E6%80%A7%E4%BB%8B%E7%BB%8D/</url>
      <content type="html"><![CDATA[<p>EditTextç»§æ‰¿TextViewï¼Œæ‰€ä»¥EditTextå…·æœ‰TextViewçš„å±æ€§ç‰¹ç‚¹ï¼Œä¸‹é¢ä¸»è¦ä»‹ç»ä¸€äº›EditTextçš„ç‰¹æœ‰çš„è¾“å…¥æ³•çš„å±æ€§ç‰¹ç‚¹</p>
<p>android:layout_gravity=â€center_verticalâ€<span>ï¼šè®¾ç½®æ§ä»¶æ˜¾ç¤ºçš„ä½ç½®ï¼šé»˜è®¤</span>top<span>ï¼Œè¿™é‡Œå±…ä¸­æ˜¾ç¤ºï¼Œè¿˜æœ‰</span>bottom</p>
<div>android:hin<span>ï¼šTextä¸ºç©ºæ—¶æ˜¾ç¤ºçš„æ–‡å­—æç¤ºä¿¡æ¯ï¼Œå¯é€šè¿‡textColorHintè®¾ç½®æç¤ºä¿¡æ¯çš„é¢œè‰²ã€‚</span></div><br><div>android:singleLine<span>ï¼šè®¾ç½®å•è¡Œè¾“å…¥ï¼Œä¸€æ—¦è®¾ç½®ä¸º</span>true<span>ï¼Œåˆ™æ–‡å­—ä¸ä¼šè‡ªåŠ¨æ¢è¡Œã€‚</span></div><br><div>android:gray=â€topâ€&nbsp;<span>ï¼šå¤šè¡Œä¸­æŒ‡é’ˆåœ¨ç¬¬ä¸€è¡Œç¬¬ä¸€ä½ç½®</span>et.setSelection(et.length());<span>ï¼šè°ƒæ•´å…‰æ ‡åˆ°æœ€åä¸€è¡Œ</span></div><br><div>android:autoText&nbsp;<span>ï¼šè‡ªåŠ¨æ‹¼å†™å¸®åŠ©ã€‚è¿™é‡Œå•ç‹¬è®¾ç½®æ˜¯æ²¡æœ‰æ•ˆæœçš„ï¼Œå¯èƒ½éœ€è¦å…¶ä»–è¾“å…¥æ³•è¾…åŠ©æ‰è¡Œ</span></div><br><div>android:capitalize&nbsp;<span>ï¼šè®¾ç½®è‹±æ–‡å­—æ¯å¤§å†™ç±»å‹ã€‚è®¾ç½®å¦‚ä¸‹å€¼ï¼šsentencesä»…ç¬¬ä¸€ä¸ªå­—æ¯å¤§å†™ï¼›wordsæ¯ä¸€ä¸ªå•è¯é¦–å­—æ¯å¤§å°ï¼Œç”¨ç©ºæ ¼åŒºåˆ†å•è¯ï¼›charactersæ¯ä¸€ä¸ªè‹±æ–‡å­—æ¯éƒ½å¤§å†™ã€‚</span></div><br><div>android:digits&nbsp;<span>ï¼šè®¾ç½®å…è®¸è¾“å…¥å“ªäº›å­—ç¬¦ã€‚å¦‚&ldquo;1234567890.+-*/%\n()&rdquo;</span></div><br><div>android:singleLine&nbsp;<span>ï¼šæ˜¯å¦å•è¡Œæˆ–è€…å¤šè¡Œï¼Œå›è½¦æ˜¯ç¦»å¼€æ–‡æœ¬æ¡†è¿˜æ˜¯æ–‡æœ¬æ¡†å¢åŠ æ–°è¡Œ</span>android:numeric&nbsp;<span>ï¼šå¦‚æœè¢«è®¾ç½®ï¼Œè¯¥TextViewæ¥æ”¶æ•°å­—è¾“å…¥ã€‚æœ‰å¦‚ä¸‹å€¼è®¾ç½®ï¼šintegeræ­£æ•´æ•°ã€signedå¸¦ç¬¦å·æ•´æ•°ã€decimalå¸¦å°æ•°ç‚¹æµ®ç‚¹æ•°ã€‚</span></div><br><div>android:inputType:è®¾ç½®æ–‡æœ¬çš„ç±»å‹</div><br><div>android:password&nbsp;<span>ï¼šå¯†ç ï¼Œä»¥å°ç‚¹&rdquo;.&rdquo;æ˜¾ç¤ºæ–‡æœ¬</span></div><br><div>android:phoneNumber&nbsp;<span>ï¼šè®¾ç½®ä¸ºç”µè¯å·ç çš„è¾“å…¥æ–¹å¼ã€‚</span></div><br><div>android:editable&nbsp;<span>ï¼šè®¾ç½®æ˜¯å¦å¯ç¼–è¾‘ã€‚ä»ç„¶å¯ä»¥è·å–å…‰æ ‡ï¼Œä½†æ˜¯æ— æ³•è¾“å…¥ã€‚</span></div><br><div>android:autoLink=&rdquo;all&rdquo;&nbsp;<span>ï¼šè®¾ç½®æ–‡æœ¬è¶…é“¾æ¥æ ·å¼å½“ç‚¹å‡»ç½‘å€æ—¶ï¼Œè·³å‘è¯¥ç½‘å€</span></div><br><div>android:textColor = â€œ#ff8c00â€<span>ï¼šå­—ä½“é¢œè‰²</span></div><br><div>android:textStyle=â€boldâ€<span>ï¼šå­—ä½“ï¼Œ</span>bold, italic, bolditalic</div><br><div>android:textAlign=â€centerâ€<span>ï¼š</span>EditText<span>æ²¡æœ‰è¿™ä¸ªå±æ€§ï¼Œä½†</span>TextView<span>æœ‰</span></div><br><div>android:textColorHighlight=â€#ccccccâ€<span>ï¼šè¢«é€‰ä¸­æ–‡å­—çš„åº•è‰²ï¼Œé»˜è®¤ä¸ºè“è‰²</span></div><br><div>android:textColorHint=â€#ffff00â€<span>ï¼šè®¾ç½®æç¤ºä¿¡æ¯æ–‡å­—çš„é¢œè‰²ï¼Œé»˜è®¤ä¸ºç°è‰²</span></div><br><div>android:textScaleX=â€1.5â€<span>ï¼šæ§åˆ¶å­—ä¸å­—ä¹‹é—´çš„é—´è·</span></div><br><div>android:typeface=â€monospaceâ€<span>ï¼šå­—å‹ï¼Œ</span>normal, sans, serif, monospace</div><br><div>android:background=â€@nullâ€<span>ï¼šç©ºé—´èƒŒæ™¯ï¼Œè¿™é‡Œæ²¡æœ‰ï¼ŒæŒ‡é€æ˜</span></div><br><div>android:layout_weight=â€1â€<span>ï¼šæƒé‡åœ¨æ§åˆ¶æ§ä»¶æ˜¾ç¤ºçš„å¤§å°æ—¶è›®æœ‰ç”¨çš„ã€‚</span></div><br><div>android:textAppearance=â€?android:attr/textAppearanceLargeInverseâ€<span>ï¼šæ–‡å­—å¤–è§‚ï¼Œè¿™é‡Œå¼•ç”¨çš„æ˜¯ç³»ç»Ÿè‡ªå¸¦çš„ä¸€ä¸ªå¤–è§‚ï¼Œï¼Ÿè¡¨ç¤ºç³»ç»Ÿæ˜¯å¦æœ‰è¿™ç§å¤–è§‚ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤çš„å¤–è§‚ã€‚</span></div><br><div><span>&nbsp;</span></div><br><div><span>&nbsp;</span></div><br><div><span>æ¥æº:<a href="http://liangruijun.blog.51cto.com/3061169/627350" target="_blank" rel="noopener">http://liangruijun.blog.51cto.com/3061169/627350</a></span></div>

]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> EditText </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[TextViewçš„å±æ€§è¯¦è§£]]></title>
      <url>/2012/10/15/TextView%E7%9A%84%E5%B1%9E%E6%80%A7%E8%AF%A6%E8%A7%A3/</url>
      <content type="html"><![CDATA[<div align="left">android:autoLink ï¼šè®¾ç½®æ˜¯å¦å½“æ–‡æœ¬ä¸ºURLé“¾æ¥/email/ç”µè¯å·ç /mapæ—¶ï¼Œæ–‡æœ¬æ˜¾ç¤ºä¸ºå¯ç‚¹å‡»çš„é“¾æ¥ã€‚å¯é€‰å€¼(none/web /email/phone/map/all)<br>android:autoText ï¼šå¦‚æœè®¾ç½®ï¼Œå°†è‡ªåŠ¨æ‰§è¡Œè¾“å…¥å€¼çš„æ‹¼å†™çº æ­£ã€‚æ­¤å¤„æ— æ•ˆæœï¼Œåœ¨æ˜¾ç¤ºè¾“å…¥æ³•å¹¶è¾“å…¥çš„æ—¶å€™èµ·ä½œç”¨ã€‚<br>android:bufferType ï¼š æŒ‡å®šgetText()æ–¹å¼å–å¾—çš„æ–‡æœ¬ç±»åˆ«ã€‚é€‰é¡¹editable ç±»ä¼¼äºStringBuilder ï¼šå¯è¿½åŠ å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯è¯´getTextåå¯è°ƒç”¨appendæ–¹æ³•è®¾ç½®æ–‡æœ¬å†…å®¹ã€‚spannable ï¼šåˆ™å¯åœ¨ç»™å®šçš„å­—ç¬¦åŒºåŸŸä½¿ç”¨æ ·å¼ï¼Œå‚è§è¿™é‡Œ1ã€è¿™é‡Œ2ã€‚<br>android:capitalize ï¼šè®¾ç½®è‹±æ–‡å­—æ¯å¤§å†™ç±»å‹ã€‚æ­¤å¤„æ— æ•ˆæœï¼Œéœ€è¦å¼¹å‡ºè¾“å…¥æ³•æ‰èƒ½çœ‹å¾—åˆ°ï¼Œå‚è§EditViewæ­¤å±æ€§è¯´æ˜ã€‚<br>android:cursorVisibleï¼šè®¾å®šå…‰æ ‡ä¸ºæ˜¾ç¤º/éšè—ï¼Œé»˜è®¤æ˜¾ç¤ºã€‚<br>android:digitsï¼šè®¾ç½®å…è®¸è¾“å…¥å“ªäº›å­—ç¬¦ã€‚å¦‚&ldquo;1234567890.+-*/% ()&rdquo;<br>android:drawableBottomï¼šåœ¨textçš„ä¸‹æ–¹è¾“å‡ºä¸€ä¸ªdrawableï¼Œå¦‚å›¾ç‰‡ã€‚å¦‚æœæŒ‡å®šä¸€ä¸ªé¢œè‰²çš„è¯ä¼šæŠŠtextçš„èƒŒæ™¯è®¾ä¸ºè¯¥é¢œè‰²ï¼Œå¹¶ä¸”åŒæ—¶å’Œbackgroundä½¿ç”¨æ—¶è¦†ç›–åè€…ã€‚<br>android:drawableLeftï¼šåœ¨textçš„å·¦è¾¹è¾“å‡ºä¸€ä¸ªdrawableï¼Œå¦‚å›¾ç‰‡ã€‚<br>android:drawablePaddingï¼šè®¾ç½®textä¸drawable(å›¾ç‰‡)çš„é—´éš”ï¼Œä¸drawableLeftã€ drawableRightã€drawableTopã€drawableBottomä¸€èµ·ä½¿ç”¨ï¼Œå¯è®¾ç½®ä¸ºè´Ÿæ•°ï¼Œå•ç‹¬ä½¿ç”¨æ²¡æœ‰æ•ˆæœã€‚<br>android:drawableRightï¼šåœ¨textçš„å³è¾¹è¾“å‡ºä¸€ä¸ªdrawableã€‚<br>android:drawableTopï¼šåœ¨textçš„æ­£ä¸Šæ–¹è¾“å‡ºä¸€ä¸ªdrawableã€‚<br>android:editableï¼šè®¾ç½®æ˜¯å¦å¯ç¼–è¾‘ã€‚<br>android:editorExtrasï¼šè®¾ç½®æ–‡æœ¬çš„é¢å¤–çš„è¾“å…¥æ•°æ®ã€‚<br>android:ellipsizeï¼šè®¾ç½®å½“æ–‡å­—è¿‡é•¿æ—¶,è¯¥æ§ä»¶è¯¥å¦‚ä½•æ˜¾ç¤ºã€‚æœ‰å¦‚ä¸‹å€¼è®¾ç½®ï¼š&rdquo;start&rdquo;&mdash;?çœç•¥å·æ˜¾ç¤ºåœ¨å¼€å¤´;&rdquo;end&rdquo; &mdash;&mdash;çœç•¥å·æ˜¾ç¤ºåœ¨ç»“å°¾;&rdquo;middle&rdquo;&mdash;-çœç•¥å·æ˜¾ç¤ºåœ¨ä¸­é—´;&rdquo;marquee&rdquo; &mdash;&mdash;ä»¥è·‘é©¬ç¯çš„æ–¹å¼æ˜¾ç¤º(åŠ¨ç”»æ¨ªå‘ç§»åŠ¨)<br>android:freezesTextï¼šè®¾ç½®ä¿å­˜æ–‡æœ¬çš„å†…å®¹ä»¥åŠå…‰æ ‡çš„ä½ç½®ã€‚<br>android:gravityï¼šè®¾ç½®æ–‡æœ¬ä½ç½®ï¼Œå¦‚è®¾ç½®æˆ&ldquo;center&rdquo;ï¼Œæ–‡æœ¬å°†å±…ä¸­æ˜¾ç¤ºã€‚<br>android:hintTextï¼šä¸ºç©ºæ—¶æ˜¾ç¤ºçš„æ–‡å­—æç¤ºä¿¡æ¯ï¼Œå¯é€šè¿‡textColorHintè®¾ç½®æç¤ºä¿¡æ¯çš„é¢œè‰²ã€‚æ­¤å±æ€§åœ¨ EditViewä¸­ä½¿ç”¨ï¼Œä½†æ˜¯è¿™é‡Œä¹Ÿå¯ä»¥ç”¨ã€‚<br>android:imeOptionsï¼šé™„åŠ åŠŸèƒ½ï¼Œè®¾ç½®å³ä¸‹è§’IMEåŠ¨ä½œä¸ç¼–è¾‘æ¡†ç›¸å…³çš„åŠ¨ä½œï¼Œå¦‚actionDoneå³ä¸‹è§’å°†æ˜¾ç¤ºä¸€ä¸ª&ldquo;å®Œæˆ&rdquo;ï¼Œè€Œä¸è®¾ç½®é»˜è®¤æ˜¯ä¸€ä¸ªå›è½¦ç¬¦å·ã€‚è¿™ä¸ªåœ¨EditViewä¸­å†è¯¦ç»†è¯´æ˜ï¼Œæ­¤å¤„æ— ç”¨ã€‚<br>android:imeActionIdï¼šè®¾ç½®IMEåŠ¨ä½œIDã€‚<br>android:imeActionLabelï¼šè®¾ç½®IMEåŠ¨ä½œæ ‡ç­¾ã€‚<br>android:includeFontPaddingï¼šè®¾ç½®æ–‡æœ¬æ˜¯å¦åŒ…å«é¡¶éƒ¨å’Œåº•éƒ¨é¢å¤–ç©ºç™½ï¼Œé»˜è®¤ä¸ºtrueã€‚<br>android:inputMethodï¼šä¸ºæ–‡æœ¬æŒ‡å®šè¾“å…¥æ³•ï¼Œéœ€è¦å®Œå…¨é™å®šå(å®Œæ•´çš„åŒ…å)ã€‚ä¾‹å¦‚ï¼šcom.google.android.inputmethod.pinyinï¼Œä½†æ˜¯è¿™é‡ŒæŠ¥é”™æ‰¾ä¸åˆ°ã€‚<br>android:inputTypeï¼šè®¾ç½®æ–‡æœ¬çš„ç±»å‹ï¼Œç”¨äºå¸®åŠ©è¾“å…¥æ³•æ˜¾ç¤ºåˆé€‚çš„é”®ç›˜ç±»å‹ã€‚åœ¨EditViewä¸­å†è¯¦ç»†è¯´æ˜ï¼Œè¿™é‡Œæ— æ•ˆæœã€‚<br>android:linksClickableï¼šè®¾ç½®é“¾æ¥æ˜¯å¦ç‚¹å‡»è¿æ¥ï¼Œå³ä½¿è®¾ç½®äº†autoLinkã€‚<br>android:marqueeRepeatLimitï¼šåœ¨ellipsizeæŒ‡å®šmarqueeçš„æƒ…å†µä¸‹ï¼Œè®¾ç½®é‡å¤æ»šåŠ¨çš„æ¬¡æ•°ï¼Œå½“è®¾ç½®ä¸º marquee_foreveræ—¶è¡¨ç¤ºæ— é™æ¬¡ã€‚<br>android:emsï¼šè®¾ç½®TextViewçš„å®½åº¦ä¸ºNä¸ªå­—ç¬¦çš„å®½åº¦ã€‚è¿™é‡Œæµ‹è¯•ä¸ºä¸€ä¸ªæ±‰å­—å­—ç¬¦å®½åº¦<br>android:maxEmsï¼šè®¾ç½®TextViewçš„å®½åº¦ä¸ºæœ€é•¿ä¸ºNä¸ªå­—ç¬¦çš„å®½åº¦ã€‚ä¸emsåŒæ—¶ä½¿ç”¨æ—¶è¦†ç›–emsé€‰é¡¹ã€‚<br>android:minEmsï¼šè®¾ç½®TextViewçš„å®½åº¦ä¸ºæœ€çŸ­ä¸ºNä¸ªå­—ç¬¦çš„å®½åº¦ã€‚ä¸emsåŒæ—¶ä½¿ç”¨æ—¶è¦†ç›–emsé€‰é¡¹ã€‚<br>android:maxLengthï¼šé™åˆ¶æ˜¾ç¤ºçš„æ–‡æœ¬é•¿åº¦ï¼Œè¶…å‡ºéƒ¨åˆ†ä¸æ˜¾ç¤ºã€‚<br>android:linesï¼šè®¾ç½®æ–‡æœ¬çš„è¡Œæ•°ï¼Œè®¾ç½®ä¸¤è¡Œå°±æ˜¾ç¤ºä¸¤è¡Œï¼Œå³ä½¿ç¬¬äºŒè¡Œæ²¡æœ‰æ•°æ®ã€‚<br>android:maxLinesï¼šè®¾ç½®æ–‡æœ¬çš„æœ€å¤§æ˜¾ç¤ºè¡Œæ•°ï¼Œä¸widthæˆ–è€…layout_widthç»“åˆä½¿ç”¨ï¼Œè¶…å‡ºéƒ¨åˆ†è‡ªåŠ¨æ¢è¡Œï¼Œè¶…å‡ºè¡Œæ•°å°†ä¸æ˜¾ç¤ºã€‚<br>android:minLinesï¼šè®¾ç½®æ–‡æœ¬çš„æœ€å°è¡Œæ•°ï¼Œä¸linesç±»ä¼¼ã€‚<br>android:lineSpacingExtraï¼šè®¾ç½®è¡Œé—´è·ã€‚<br>android:lineSpacingMultiplierï¼šè®¾ç½®è¡Œé—´è·çš„å€æ•°ã€‚å¦‚&rdquo;1.2&rdquo;<br>android:numericï¼šå¦‚æœè¢«è®¾ç½®ï¼Œè¯¥TextViewæœ‰ä¸€ä¸ªæ•°å­—è¾“å…¥æ³•ã€‚æ­¤å¤„æ— ç”¨ï¼Œè®¾ç½®åå”¯ä¸€æ•ˆæœæ˜¯TextViewæœ‰ç‚¹å‡»æ•ˆæœï¼Œæ­¤å±æ€§åœ¨EdtiViewå°†è¯¦ç»†è¯´æ˜ã€‚<br>android:passwordï¼šä»¥å°ç‚¹&rdquo;.&rdquo;æ˜¾ç¤ºæ–‡æœ¬<br>android:phoneNumberï¼šè®¾ç½®ä¸ºç”µè¯å·ç çš„è¾“å…¥æ–¹å¼ã€‚<br>android:privateImeOptionsï¼šè®¾ç½®è¾“å…¥æ³•é€‰é¡¹ï¼Œæ­¤å¤„æ— ç”¨ï¼Œåœ¨EditTextå°†è¿›ä¸€æ­¥è®¨è®ºã€‚<br>android:scrollHorizontallyï¼šè®¾ç½®æ–‡æœ¬è¶…å‡ºTextViewçš„å®½åº¦çš„æƒ…å†µä¸‹ï¼Œæ˜¯å¦å‡ºç°æ¨ªæ‹‰æ¡ã€‚<br>android:selectAllOnFocusï¼šå¦‚æœæ–‡æœ¬æ˜¯å¯é€‰æ‹©çš„ï¼Œè®©ä»–è·å–ç„¦ç‚¹è€Œä¸æ˜¯å°†å…‰æ ‡ç§»åŠ¨ä¸ºæ–‡æœ¬çš„å¼€å§‹ä½ç½®æˆ–è€…æœ«å°¾ä½ç½®ã€‚ TextViewä¸­è®¾ç½®åæ— æ•ˆæœã€‚<br>android:shadowColorï¼šæŒ‡å®šæ–‡æœ¬é˜´å½±çš„é¢œè‰²ï¼Œéœ€è¦ä¸shadowRadiusä¸€èµ·ä½¿ç”¨ã€‚<br>android:shadowDxï¼šè®¾ç½®é˜´å½±æ¨ªå‘åæ ‡å¼€å§‹ä½ç½®ã€‚<br>android:shadowDyï¼šè®¾ç½®é˜´å½±çºµå‘åæ ‡å¼€å§‹ä½ç½®ã€‚<br>android:shadowRadiusï¼šè®¾ç½®é˜´å½±çš„åŠå¾„ã€‚è®¾ç½®ä¸º0.1å°±å˜æˆå­—ä½“çš„é¢œè‰²äº†ï¼Œä¸€èˆ¬è®¾ç½®ä¸º3.0çš„æ•ˆæœæ¯”è¾ƒå¥½ã€‚<br>android:singleLineï¼šè®¾ç½®å•è¡Œæ˜¾ç¤ºã€‚å¦‚æœå’Œlayout<em>widthä¸€èµ·ä½¿ç”¨ï¼Œå½“æ–‡æœ¬ä¸èƒ½å…¨éƒ¨æ˜¾ç¤ºæ—¶ï¼Œåé¢ç”¨&ldquo;&hellip;&rdquo;æ¥è¡¨ç¤ºã€‚å¦‚android:text=â€test</em> singleLine â€œ<br>android:singleLine=â€trueâ€ android:layout_width=â€20dpâ€å°†åªæ˜¾ç¤º&ldquo;t&hellip;&rdquo;ã€‚å¦‚æœä¸è®¾ç½®singleLineæˆ–è€…è®¾ç½®ä¸ºfalseï¼Œæ–‡æœ¬å°†è‡ªåŠ¨æ¢è¡Œ<br>android:textï¼šè®¾ç½®æ˜¾ç¤ºæ–‡æœ¬.<br>android:textAppearanceï¼šè®¾ç½®æ–‡å­—å¤–è§‚ã€‚å¦‚ &ldquo;?android:attr/textAppearanceLargeInverse&rdquo;è¿™é‡Œå¼•ç”¨çš„æ˜¯ç³»ç»Ÿè‡ªå¸¦çš„ä¸€ä¸ªå¤–è§‚ï¼Œ?è¡¨ç¤ºç³»ç»Ÿæ˜¯å¦æœ‰è¿™ç§å¤–è§‚ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤çš„å¤–è§‚ã€‚å¯è®¾ç½®çš„å€¼å¦‚ä¸‹ï¼štextAppearanceButton/textAppearanceInverse/textAppearanceLarge/textAppearanceLargeInverse/textAppearanceMedium/textAppearanceMediumInverse/textAppearanceSmall/textAppearanceSmallInverse<br>android:textColorï¼šè®¾ç½®æ–‡æœ¬é¢œè‰²<br>android:textColorHighlightï¼šè¢«é€‰ä¸­æ–‡å­—çš„åº•è‰²ï¼Œé»˜è®¤ä¸ºè“è‰²<br>android:textColorHintï¼šè®¾ç½®æç¤ºä¿¡æ¯æ–‡å­—çš„é¢œè‰²ï¼Œé»˜è®¤ä¸ºç°è‰²ã€‚ä¸hintä¸€èµ·ä½¿ç”¨ã€‚<br>android:textColorLinkï¼šæ–‡å­—é“¾æ¥çš„é¢œè‰².<br>android:textScaleXï¼šè®¾ç½®æ–‡å­—ä¹‹é—´é—´éš”ï¼Œé»˜è®¤ä¸º1.0fã€‚<br>android:textSizeï¼šè®¾ç½®æ–‡å­—å¤§å°ï¼Œæ¨èåº¦é‡å•ä½&rdquo;sp&rdquo;ï¼Œå¦‚&rdquo;15sp&rdquo;<br>android:textStyleï¼šè®¾ç½®å­—å½¢[bold(ç²—ä½“) 0, italic(æ–œä½“) 1, bolditalic(åˆç²—åˆæ–œ) 2] å¯ä»¥è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œç”¨&ldquo;|&rdquo;éš”å¼€<br>android:typefaceï¼šè®¾ç½®æ–‡æœ¬å­—ä½“ï¼Œå¿…é¡»æ˜¯ä»¥ä¸‹å¸¸é‡å€¼ä¹‹ä¸€ï¼šnormal 0, sans 1, serif 2, monospace(ç­‰å®½å­—ä½“) 3]<br>android:heightï¼šè®¾ç½®æ–‡æœ¬åŒºåŸŸçš„é«˜åº¦ï¼Œæ”¯æŒåº¦é‡å•ä½ï¼špx(åƒç´ )/dp/sp/in/mm(æ¯«ç±³)<br>android:maxHeightï¼šè®¾ç½®æ–‡æœ¬åŒºåŸŸçš„æœ€å¤§é«˜åº¦<br>android:minHeightï¼šè®¾ç½®æ–‡æœ¬åŒºåŸŸçš„æœ€å°é«˜åº¦<br>android:widthï¼šè®¾ç½®æ–‡æœ¬åŒºåŸŸçš„å®½åº¦ï¼Œæ”¯æŒåº¦é‡å•ä½ï¼špx(åƒç´ )/dp/sp/in/mm(æ¯«ç±³)ï¼Œä¸layout_width çš„åŒºåˆ«çœ‹è¿™é‡Œã€‚<br>android:maxWidthï¼šè®¾ç½®æ–‡æœ¬åŒºåŸŸçš„æœ€å¤§å®½åº¦<br>android:minWidthï¼šè®¾ç½®æ–‡æœ¬åŒºåŸŸçš„æœ€å°å®½åº¦</div><br><div>&nbsp;</div>

<p>é™„ä»¶ï¼šAndroidä¸­çš„é•¿åº¦å•ä½è¯¦è§£</p>
<p>Androidä¸­çš„é•¿åº¦å•ä½è¯¦è§£ï¼ˆdpã€spã€pxã€inã€ptã€mmï¼‰æœ‰å¾ˆå¤šäººä¸å¤ªç†è§£dpã€sp å’Œpx çš„åŒºåˆ«ï¼šç°åœ¨è¿™é‡Œä»‹ç»ä¸€ä¸‹dp å’Œspã€‚dp ä¹Ÿå°±æ˜¯dipã€‚è¿™ä¸ªå’Œsp åŸºæœ¬ç±»ä¼¼ã€‚å¦‚æœè®¾ç½®è¡¨ç¤ºé•¿åº¦ã€é«˜åº¦ç­‰å±æ€§æ—¶å¯ä»¥ä½¿ç”¨dp æˆ–spã€‚ä½†å¦‚æœè®¾ç½®å­—ä½“ï¼Œéœ€è¦ä½¿ç”¨spã€‚dp æ˜¯ä¸å¯†åº¦æ— å…³ï¼Œsp é™¤äº†ä¸å¯†åº¦æ— å…³å¤–ï¼Œè¿˜ä¸scale æ— å…³ã€‚å¦‚æœå±å¹•å¯†åº¦ä¸º160ï¼Œè¿™æ—¶dp å’Œsp å’Œpx æ˜¯ä¸€æ ·çš„ã€‚1dp=1sp=1pxï¼Œä½†å¦‚æœä½¿ç”¨px ä½œå•ä½ï¼Œå¦‚æœå±å¹•å¤§å°ä¸å˜ï¼ˆå‡è®¾è¿˜æ˜¯3.2 å¯¸ï¼‰ï¼Œè€Œå±å¹•å¯†åº¦å˜æˆäº†320ã€‚é‚£ä¹ˆåŸæ¥TextView çš„å®½åº¦è®¾æˆ160pxï¼Œåœ¨å¯†åº¦ä¸º320 çš„3.2 å¯¸å±å¹•é‡Œçœ‹è¦æ¯”åœ¨å¯†åº¦ä¸º160 çš„3.2 å¯¸å±å¹•ä¸Šçœ‹çŸ­äº†ä¸€åŠã€‚ä½†å¦‚æœè®¾ç½®æˆ160dp æˆ–160sp çš„è¯ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨å°†width å±æ€§å€¼è®¾ç½®æˆ320px çš„ã€‚ä¹Ÿå°±æ˜¯160 * 320 / 160ã€‚å…¶ä¸­320 / 160 å¯ç§°ä¸ºå¯†åº¦æ¯”ä¾‹å› å­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½¿ç”¨dp å’Œspï¼Œç³»ç»Ÿä¼šæ ¹æ®å±å¹•å¯†åº¦çš„å˜åŒ–è‡ªåŠ¨è¿›è¡Œè½¬æ¢ã€‚</p>
<p>å…¶ä»–å•ä½çš„å«ä¹‰<br>pxï¼šè¡¨ç¤ºå±å¹•å®é™…çš„è±¡ç´ ã€‚ä¾‹å¦‚ï¼Œ320<em>480 çš„å±å¹•åœ¨æ¨ªå‘æœ‰320ä¸ªè±¡ç´ ï¼Œåœ¨çºµå‘æœ‰480 ä¸ªè±¡ç´ ã€‚<br>inï¼šè¡¨ç¤ºè‹±å¯¸ï¼Œæ˜¯å±å¹•çš„ç‰©ç†å°ºå¯¸ã€‚æ¯è‹±å¯¸ç­‰äº2.54 å˜ç±³ã€‚ä¾‹å¦‚ï¼Œå½¢å®¹æ‰‹æœºå±å¹•å¤§å°ï¼Œç»å¸¸è¯´ï¼Œ3.2ï¼ˆè‹±ï¼‰å¯¸ã€3.5ï¼ˆè‹±ï¼‰å¯¸ã€4ï¼ˆè‹±ï¼‰å¯¸å°±æ˜¯æŒ‡è¿™ä¸ªå•ä½ã€‚è¿™äº›å°ºå¯¸æ˜¯å±å¹•çš„å¯¹è§’çº¿é•¿åº¦ã€‚å¦‚æœæ‰‹æœºçš„å±å¹•æ˜¯3.2 è‹±å¯¸ï¼Œè¡¨ç¤ºæ‰‹æœºçš„å±å¹•ï¼ˆå¯è§†åŒºåŸŸï¼‰å¯¹è§’çº¿é•¿åº¦æ˜¯3.2</em>2.54 = 8.128 å˜ç±³ã€‚è¯»è€…å¯ä»¥å»é‡ä¸€é‡è‡ªå·±çš„æ‰‹æœºå±å¹•ï¼Œçœ‹å’Œå®é™…çš„å°ºå¯¸æ˜¯å¦ä¸€è‡´ã€‚<br>mmï¼šè¡¨ç¤ºæ¯«ç±³ï¼Œæ˜¯å±å¹•çš„ç‰©ç†å°ºå¯¸ã€‚<br>ptï¼šè¡¨ç¤ºä¸€ä¸ªç‚¹ï¼Œæ˜¯å±å¹•çš„ç‰©ç†å°ºå¯¸ã€‚å¤§å°ä¸º1 è‹±å¯¸çš„1/72ã€‚</p>
<p>&nbsp;</p>
<p>&nbsp;<br>æ¥æºï¼š<a href="http://liangruijun.blog.51cto.com/3061169/627123" target="_blank" rel="noopener">http://liangruijun.blog.51cto.com/3061169/627123</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> TextView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidä½¿ç”¨ListViewåº”è¯¥æ³¨æ„çš„åœ°æ–¹]]></title>
      <url>/2012/06/19/Android%E4%BD%BF%E7%94%A8ListView%E5%BA%94%E8%AF%A5%E6%B3%A8%E6%84%8F%E7%9A%84%E5%9C%B0%E6%96%B9/</url>
      <content type="html"><![CDATA[<p><span>åœ¨ListViewä¸­è®¾ç½®Selectorä¸ºnullä¼šæŠ¥ç©ºæŒ‡é’ˆï¼Ÿ</span>&nbsp;<br>mListView.setSelector(null);//ç©ºæŒ‡é’ˆ&nbsp;<br>è¯•è¯•ä¸‹é¢è¿™ç§ï¼š&nbsp;<br>mListView.setSelector(new ColorDrawable(Color.TRANSPARENT));&nbsp;</p>
<p><span>å¦‚ä½•è®©ListViewåˆå§‹åŒ–çš„æ—¶å€™å°±é€‰ä¸­ä¸€é¡¹?</span>&nbsp;<br>ListViewéœ€è¦åœ¨åˆå§‹åŒ–å¥½æ•°æ®å,å…¶ä¸­ä¸€é¡¹éœ€è¦å‘ˆé€‰ä¸­çŠ¶æ€ã€‚æ‰€è°“â€é€‰ä¸­çŠ¶æ€â€å°±æ˜¯è¯¥é¡¹åº•è‰²ä¸å…¶å®ƒé¡¹ä¸åŒ,setSelection(position)åªèƒ½å®šä½åˆ°æŸä¸ªitemï¼Œä½†æ˜¯æ— æ³•æ”¹å˜åº•è‰²å‘ˆé«˜äº®ã€‚setSelection(position)åªèƒ½è®©æŸä¸ªitemæ˜¾ç¤ºåœ¨å¯è§Itemçš„æœ€ä¸Šé¢(å¦‚æœItemè¶…è¿‡ä¸€å±çš„è¯)! å°±æ˜¯æ‰€è°“çš„firstVisibleItemå•¦ï¼&nbsp;<br>å¦‚æœæƒ³è¦å®ç°æ•ˆæœå¯ä»¥åœ¨listviewæ‰€ç»‘å®šçš„adapteré‡Œçš„getViewå‡½æ•°é‡Œå»å®Œæˆä¸€äº›å…·ä½“çš„å·¥ä½œã€‚å¯ä»¥è®°ä¸‹ä½ è¦é«˜äº®çš„é‚£ä¸ªitemçš„indexï¼Œåœ¨getViewå‡½æ•°é‡Œåˆ¤æ–­indexï¼ˆä¹Ÿå°±æ˜¯positionï¼‰ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶åˆ™åŠ è½½ä¸åŒçš„èƒŒæ™¯ã€‚&nbsp;</p>
<p><span>ListViewçš„å³è¾¹æ»šåŠ¨æ»‘å—å¯ç”¨æ–¹æ³•ï¼Ÿ</span>&nbsp;<br>&nbsp;&nbsp;&nbsp; å¾ˆå¤šå¼€å‘è€…ä¸çŸ¥é“ListViewåˆ—è¡¨æ§ä»¶çš„å¿«é€Ÿæ»šåŠ¨æ»‘å—æ˜¯å¦‚ä½•å¯ç”¨çš„ï¼Œå…¶å®è¾…åŠ©æ»šåŠ¨æ»‘å—åªéœ€è¦ä¸€è¡Œä»£ç å°±å¯ä»¥æå®šï¼Œå¦‚æœä½ ä½¿ç”¨XMLå¸ƒå±€åªéœ€è¦åœ¨ListViewèŠ‚ç‚¹ä¸­åŠ å…¥&nbsp; android:fastScrollEnabled=â€trueâ€ è¿™ä¸ªå±æ€§å³å¯ï¼Œè€Œå¯¹äºJavaä»£ç å¯ä»¥é€šè¿‡myListView.setFastScrollEnabled(true); æ¥æ§åˆ¶å¯ç”¨ï¼Œå‚æ•°falseä¸ºéšè—ã€‚&nbsp;<br>&nbsp;&nbsp;&nbsp; è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯å½“ä½ çš„æ»šåŠ¨å†…å®¹è¾ƒå°ï¼Œä¸åˆ°å½“å‰ListViewçš„3ä¸ªå±å¹•é«˜åº¦æ—¶åˆ™ä¸ä¼šå‡ºç°è¿™ä¸ªå¿«é€Ÿæ»šåŠ¨æ»‘å—ï¼Œè¯¥æ–¹æ³•æ˜¯AbsListViewçš„åŸºç¡€æ–¹æ³•ï¼Œå¯ä»¥åœ¨ListViewæˆ–GridViewç­‰å­ç±»ä¸­ä½¿ç”¨å¿«é€Ÿæ»šåŠ¨è¾…åŠ©ã€‚&nbsp;</p>
<p><img src="http://dl.iteye.com/upload/attachment/463627/bb15bcb0-3d45-33fc-9460-8ca9f90bb29d.jpg" alt="">&nbsp;</p>
<p>1. æ›´æ–°ListViewä¸­çš„æ•¸æ“š,é€šéèª¿ç”¨BaseAdapterå°è±¡çš„notifyDataSetChanged()æ–¹æ³•ï¼š&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mAdapter.notifyDataSetChanged();&nbsp;</p>
<p>2. æ¯å€‹listviewéƒ½æœ‰ç„¡æ•ˆçš„ä½ç½®,å¦‚ç¬¬ä¸€è¡Œçš„å‰ä¸€è¡Œ,æœ€å¾Œä¸€è¡Œçš„å¾Œä¸€è¡Œ,é€™å€‹ç„¡æ•ˆçš„ä½ç½®æ˜¯ä¸€å€‹å¸¸é‡.&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; ListView.INVALID_POSITION&nbsp;</p>
<p>3. æœ‰æ™‚æˆ‘å€‘éœ€è¦åœ¨ç¨‹åºä¸­é€šéé»æ“ŠæŒ‰éˆ•ä¾†æ§åˆ¶ListViewè¡Œçš„é¸ä¸­,é€™å°±ç”¨åˆ°äº†åœ¨ç¨‹åºä¸­å¦‚ä½•ä½¿ç”¨ä»£ç¢¼ä¾†é¸æ“‡ListViewé ….&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mListView.requestFocusFromTouch();&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mListView.setSelection(int index);&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; ç¬¬ä¸€æ¢èªå¥ä¸¦ä¸æ˜¯å¿…é ˆçš„,ä½†æ˜¯è‹¥ä½ ListViewé …ä¸­å«æœ‰Button,RadioButton,CheckBoxç­‰æ¯”ListViewå–å¾— ç„¦é»å„ªå…ˆç´šé«˜çš„æ§ä»¶æ™‚,é‚£éº¼ç¬¬ä¸€æ¢èªå¥æ˜¯ä½ å¿…é ˆåŠ çš„.&nbsp;</p>
<p><span>4.&nbsp; åŒæ¨£çš„,è‹¥ä½ ListViewé …ä¸­å«æœ‰Button,RadioButton,CheckBoxç­‰æ¯”ListViewå–å¾— ç„¦é»å„ªå…ˆç´šé«˜çš„æ§ä»¶æ™‚,ListViewçš„setOnItemClickListeneræ˜¯ä¸è¢«åŸ·è¡Œçš„,é€™æ™‚ä½ éœ€è¦åœ¨ä½ çš„xmlæ–‡ä»¶ä¸­å°é€™äº›æ§ä»¶æ·»åŠ &nbsp;&nbsp;<span>android:focusable=â€falseâ€ æ³¨æ„é€™æ¢èªå¥è¦æ”¾åœ¨xmlæ–‡ä»¶ä¸­ä¿®æ”¹,åœ¨ä»£ç¢¼ä¸­ä½¿ç”¨æ˜¯ç„¡æ•ˆçš„.</span>&nbsp;</span></p>
<p>5. å¦‚ä½•ä¿æŒListViewçš„æ»¾å‹•æ¢ä¸€ç›´é¡¯ç¤º,ä¸éš±è—å‘¢:&nbsp; xmlæ–‡ä»¶ä¸­åšå¦‚ä¸‹ä¿®æ”¹&nbsp;&nbsp;&nbsp; android:fadeScrollbars=â€falseâ€&nbsp;</p>
<p>6. ListViewæœ¬èº«æœ‰è‡ªå·±çš„æŒ‰éµäº‹ä»¶ï¼Œå³ä½ ä¸éœ€è¦è¨­ç½®æ–¹å‘éµçš„æ¨™è­˜ï¼ŒæŒ‰ä¸‹æ–¹å‘éµListViewå°±æœƒæœ‰é»˜èªçš„å‹•ä½œï¼Œé‚£å¦‚ä½•é€²è¡Œæ§åˆ¶ï¼Œç·¨å¯«è‡ªå·±çš„onKeyå‘¢ï¼Œä½ éœ€è¦åœ¨Activityä¸­é‡å¯«dispatchKeyEvent(KeyEvent event)ï¼›æ–¹æ³•ï¼Œåœ¨é€™è£¡é¢å®šç¾©ä½ è‡ªå·±çš„å‹•ä½œå°±å¯ä»¥äº†&nbsp;</p>
<p><span>ListView è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ï¼š</span>&nbsp;<br>&lt;ListView android:id=â€@android:id/listâ€&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_width=â€match_parentâ€&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_height=â€0dipâ€&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_weight=â€1â€&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:stackFromBottom=â€trueâ€//ä»ä¸‹å¼€å§‹æ˜¾ç¤ºæ¡ç›®&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:transcriptMode=â€normalâ€&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:fastScrollEnabled=â€trueâ€&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:focusable=â€trueâ€&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:scrollbarTrackVertical=â€@drawable/scrollbar_vertical_trackâ€&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:scrollbarThumbVertical=â€@drawable/scrollbar_vertical_thumbâ€&nbsp;<br>/&gt;&nbsp;<br>//scrollbar_vertical_trackï¼Œcrollbar_vertical_thumbè‡ªå®šä¹‰çš„xmlæ–‡ä»¶ï¼Œæ”¾åœ¨Drawableä¸­ï¼Œtrackæ˜¯æŒ‡é•¿æ¡ï¼Œthumbæ˜¯æŒ‡çŸ­æ¡&nbsp;<br><span>å»æ‰ListView Selectoré€‰ç§æ—¶é»„è‰²åº•çº¹ä¸€é—ªçš„æ•ˆæœï¼š</span>&nbsp;</p>
<div class="dp-highlighter"><br><div class="bar"><br><div class="tools">Xmlä»£ç &nbsp; &nbsp;<a href="http://gundumw100.iteye.com/blog/1169065" title="æ”¶è—è¿™æ®µä»£ç " target="_blank" rel="noopener"><img src="http://gundumw100.iteye.com/images/icon_star.png" alt="æ”¶è—ä»£ç "></a></div>

<p></p></div><p></p>
<ol>
<li><span><span class="tag">&lt;?</span><span class="tag-name">xml</span>&nbsp;<span class="attribute">version</span>=<span class="attribute-value">â€œ1.0â€</span>&nbsp;<span class="attribute">encoding</span>=<span class="attribute-value">â€œutf-8â€</span><span class="tag">?&gt;</span>&nbsp;&nbsp;</span></li>
<li><span><span class="tag">&lt;</span><span class="tag-name">shape</span>&nbsp;<span class="attribute">xmlns:android</span>=<span class="attribute-value">â€œ<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><span class="tag">&gt;</span>&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">solid</span>&nbsp;<span class="attribute">android:color</span>=<span class="attribute-value">â€œ@android:color/transparentâ€</span><span class="tag">/&gt;</span>&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tag">&lt;</span><span class="tag-name">corners</span>&nbsp;<span class="attribute">android:radius</span>=<span class="attribute-value">â€œ0dipâ€</span>&nbsp;<span class="tag">/&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li><span><span class="tag">&lt;/</span><span class="tag-name">shape</span><span class="tag">&gt;</span>&nbsp;&nbsp;</span></li>
<li><span>//listview.setSelector(R.drawable.thisShape);&nbsp;&nbsp;</span></li></ol></div>

<p>æˆ–è€…è¿˜æœ‰ä¸€ç§åŠæ³•ï¼š&nbsp;<br>åœ¨Adapterä¸­é‡å†™public boolean isEnabled(int position)æ–¹æ³•ï¼Œå°†å…¶è¿”å›falseå°±å¯ä»¥äº†ï¼Œæ¨èé‡‡ç”¨æ­¤ç§åŠæ³•,å…·ä½“è§<a href="http://gundumw100.iteye.com/admin/blogs/850654" target="_blank" rel="noopener">http://gundumw100.iteye.com/admin/blogs/850654</a>&nbsp;</p>
<div class="dp-highlighter"><br><div class="bar"><br><div class="tools">Javaä»£ç &nbsp; &nbsp;<a href="http://gundumw100.iteye.com/blog/1169065" title="æ”¶è—è¿™æ®µä»£ç " target="_blank" rel="noopener"><img src="http://gundumw100.iteye.com/images/icon_star.png" alt="æ”¶è—ä»£ç "></a></div>

<p></p></div><p></p>
<ol>
<li><span><span class="keyword">public</span>&nbsp;<span class="keyword">boolean</span>&nbsp;isEnabled(<span class="keyword">int</span>&nbsp;position)&nbsp;{&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;TODO&nbsp;Auto-generated&nbsp;method&nbsp;stub</span>&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span>;&nbsp;&nbsp;</span></li>
<li><span>}&nbsp;&nbsp;</span></li></ol></div>

<p><span>ListViewå‡ ä¸ªæ¯”è¾ƒç‰¹åˆ«çš„å±æ€§</span>&nbsp;<br>é¦–å…ˆæ˜¯stackFromBottomå±æ€§ï¼Œè¿™åªè¯¥å±æ€§ä¹‹åä½ åšå¥½çš„åˆ—è¡¨å°±ä¼šæ˜¾ç¤ºä½ åˆ—è¡¨çš„æœ€ä¸‹é¢ï¼Œå€¼ä¸ºtrueå’Œfalse&nbsp;<br>android:stackFromBottom=â€trueâ€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>ç¬¬äºŒæ˜¯transciptModeå±æ€§ï¼Œéœ€è¦ç”¨ListViewæˆ–è€…å…¶å®ƒæ˜¾ç¤ºå¤§é‡Itemsçš„æ§ä»¶å®æ—¶è·Ÿè¸ªæˆ–è€…æŸ¥çœ‹ä¿¡æ¯ï¼Œå¹¶ä¸”å¸Œæœ›æœ€æ–°çš„æ¡ç›®å¯ä»¥è‡ªåŠ¨æ»šåŠ¨åˆ°å¯è§†èŒƒå›´å†…ã€‚é€šè¿‡è®¾ç½®çš„æ§ä»¶transcriptModeå±æ€§å¯ä»¥å°†Androidå¹³å°çš„æ§ä»¶ï¼ˆæ”¯æŒScrollBarï¼‰è‡ªåŠ¨æ»‘åŠ¨åˆ°æœ€åº•éƒ¨ã€‚&nbsp;<br>android:transcriptMode=â€alwaysScrollâ€&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>ç¬¬ä¸‰cacheColorHintå±æ€§ï¼Œå¾ˆå¤šäººå¸Œæœ›èƒ½å¤Ÿæ”¹å˜ä¸€ä¸‹å®ƒçš„èƒŒæ™¯ï¼Œä½¿ä»–èƒ½å¤Ÿç¬¦åˆæ•´ä½“çš„UIè®¾è®¡ï¼Œæ”¹å˜èƒŒæ™¯èƒŒå¾ˆç®€å•åªéœ€è¦å‡†å¤‡ä¸€å¼ å›¾ç‰‡ç„¶åæŒ‡å®šå±æ€§ android:background=â€@drawable/bgâ€ï¼Œä¸è¿‡ä¸è¦é«˜å…´åœ°å¤ªæ—©ï¼Œå½“ä½ è¿™ä¹ˆåšä»¥åï¼Œå‘ç°èƒŒæ™¯æ˜¯å˜äº†ï¼Œä½†æ˜¯å½“ä½ æ‹–åŠ¨ï¼Œæˆ–è€…ç‚¹å‡»listç©ºç™½ä½ç½®çš„æ—¶å€™å‘ç°ListIteméƒ½å˜æˆé»‘è‰²çš„äº†ï¼Œç ´åäº†æ•´ä½“æ•ˆæœã€‚&nbsp;<br>å¦‚æœä½ åªæ˜¯æ¢èƒŒæ™¯çš„é¢œè‰²çš„è¯ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šandroid:cacheColorHintä¸ºä½ æ‰€è¦çš„é¢œè‰²ï¼Œå¦‚æœä½ æ˜¯ç”¨å›¾ç‰‡åšèƒŒæ™¯çš„è¯ï¼Œé‚£ä¹Ÿåªè¦å°†android:cacheColorHintæŒ‡å®šä¸ºé€æ˜ï¼ˆ#00000000ï¼‰å°±å¯ä»¥äº†&nbsp;</p>
<p>ç¬¬å››dividerå±æ€§ï¼Œè¯¥å±æ€§ä½œç”¨æ˜¯æ¯ä¸€é¡¹ä¹‹é—´éœ€è¦è®¾ç½®ä¸€ä¸ªå›¾ç‰‡åšä¸ºé—´éš”ï¼Œæˆ–æ˜¯å»æ‰itemä¹‹é—´çš„åˆ†å‰²çº¿android:divider=â€@drawable/list_driverâ€&nbsp; å…¶ä¸­&nbsp; @drawable/list_driver æ˜¯ä¸€ä¸ªå›¾ç‰‡èµ„æºï¼Œå¦‚æœä¸æƒ³æ˜¾ç¤ºåˆ†å‰²çº¿åˆ™åªè¦è®¾ç½®ä¸ºandroid:divider=â€@drawable/@nullâ€ å°±å¯ä»¥äº†&nbsp;</p>
<p>ç¬¬äº”fadingEdgeå±æ€§ï¼Œä¸Šè¾¹å’Œä¸‹è¾¹æœ‰é»‘è‰²çš„é˜´å½±android:fadingEdge=â€noneâ€ è®¾ç½®åæ²¡æœ‰é˜´å½±äº†~&nbsp;</p>
<p>ç¬¬äº”scrollbarså±æ€§ï¼Œä½œç”¨æ˜¯éšè—listViewçš„æ»šåŠ¨æ¡ï¼Œandroid:scrollbars=â€noneâ€ä¸setVerticalScrollBarEnabled(true);çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œä¸æ´»åŠ¨çš„æ—¶å€™éšè—ï¼Œæ´»åŠ¨çš„æ—¶å€™ä¹Ÿéšè—&nbsp;</p>
<p>ç¬¬å…­fadeScrollbarså±æ€§ï¼Œandroid:fadeScrollbars=â€trueâ€&nbsp; é…ç½®ListViewå¸ƒå±€çš„æ—¶å€™ï¼Œè®¾ç½®è¿™ä¸ªå±æ€§ä¸ºtrueå°±å¯ä»¥å®ç°æ»šåŠ¨æ¡çš„è‡ªåŠ¨éšè—å’Œæ˜¾ç¤ºã€‚&nbsp;</p>
<p><span>å¦‚ä½•åœ¨ä½¿ç”¨galleryåœ¨flingingæ‹–åŠ¨æ—¶å€™ä¸å‡ºç°é€‰æ‹©çš„æƒ…å†µï¼Ÿ&nbsp;</span><br>è¿™æ—¶å€™éœ€è¦æ³¨æ„ä½¿ç”¨&nbsp;<br>gallery.setCallbackDuringFling(false)&nbsp;</p>
<p><span>å¦‚ä½•è®©ListViewè‡ªåŠ¨æ»šåŠ¨ï¼Ÿ&nbsp;</span><br>æ³¨æ„stackFromBottomä»¥åŠtranscriptModeè¿™ä¸¤ä¸ªå±æ€§ã€‚ç±»ä¼¼Marketå®¢æˆ·ç«¯çš„ä½ç«¯ä¸æ–­æ»šåŠ¨ã€‚&nbsp;<br>&lt;ListView android:id=â€listCWJâ€&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; android:layout_width=â€fill_parentâ€&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; android:layout_height=â€fill_parentâ€&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; android:stackFromBottom=â€trueâ€&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; android:transcriptMode=â€alwaysScrollâ€&nbsp;&nbsp;<br>/&gt;&nbsp;<br><span>å¦‚ä½•éå†listView çš„çš„å•é€‰æ¡†ï¼Ÿ</span>&nbsp;</p>
<div class="dp-highlighter"><br><div class="bar"><br><div class="tools">Javaä»£ç &nbsp; &nbsp;<a href="http://gundumw100.iteye.com/blog/1169065" title="æ”¶è—è¿™æ®µä»£ç " target="_blank" rel="noopener"><img src="http://gundumw100.iteye.com/images/icon_star.png" alt="æ”¶è—ä»£ç "></a></div>

<p></p></div><p></p>
<ol>
<li><span>ListView&nbsp;listView&nbsp;=&nbsp;(ListView)findViewById(R.id.é…ç½®æ–‡ä»¶ä¸­ListViewçš„ID);&nbsp;&nbsp;</span></li>
<li><span><span class="comment">//å…¨é€‰éå†ListViewçš„é€‰é¡¹ï¼Œæ¯ä¸ªé€‰é¡¹å°±ç›¸å½“äºå¸ƒå±€é…ç½®æ–‡ä»¶ä¸­çš„RelativeLayout</span>&nbsp;&nbsp;</span></li>
<li><span><span class="keyword">for</span>(<span class="keyword">int</span>&nbsp;i&nbsp;=&nbsp;<span class="number">0</span>;&nbsp;i&nbsp;&lt;&nbsp;listView.getChildCount();&nbsp;i++){&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;View&nbsp;view&nbsp;=&nbsp;listView.getChildAt(i);&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckBox&nbsp;cb&nbsp;=&nbsp;(CheckBox)view.findViewById(R.id.CheckBoxID);&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cb.setChecked(<span class="keyword">true</span>);&nbsp;&nbsp;</span></li>
<li><span>}&nbsp;&nbsp;</span></li></ol></div>

<p><span>å¦‚ä½•è®©ListViewä¸­TextViewçš„å­—ä½“é¢œè‰²è·Ÿéšç„¦ç‚¹çš„å˜åŒ–ï¼Ÿ&nbsp;</span><br>æˆ‘ä»¬é€šå¸¸éœ€è¦ListViewä¸­æŸä¸€é¡¹é€‰ä¸­æ—¶ï¼Œä»–çš„å­—ä½“é¢œè‰²å’ŒåŸæ¥çš„ä¸ä¸€æ ·ã€‚ å¦‚ä½•è®¾ç½®å­—ä½“çš„é¢œè‰²å‘¢ï¼Ÿ åœ¨å¸ƒå±€æ–‡ä»¶ä¸­TextColorä¸€é¡¹æ¥è®¾ç½®é¢œè‰²ï¼Œä½†æ˜¯ä¸æ˜¯åªè®¾ç½®ä¸€ç§é¢œè‰²ï¼Œè€Œæ˜¯åœ¨ä¸åŒçš„æ¡ä»¶ä¸‹è®¾ç½®ä¸åŒçš„é¢œè‰²ï¼š ä¸‹é¢æ˜¯ä¸ªä¾‹å­ï¼š&nbsp;</p>
<div class="dp-highlighter"><br><div class="bar"><br><div class="tools">Xmlä»£ç &nbsp; &nbsp;<a href="http://gundumw100.iteye.com/blog/1169065" title="æ”¶è—è¿™æ®µä»£ç " target="_blank" rel="noopener"><img src="http://gundumw100.iteye.com/images/icon_star.png" alt="æ”¶è—ä»£ç "></a></div>

<p></p></div><p></p>
<ol>
<li><span><span class="tag">&lt;?</span><span class="tag-name">xml</span>&nbsp;<span class="attribute">version</span>=<span class="attribute-value">â€œ1.0â€</span>&nbsp;<span class="attribute">encoding</span>=<span class="attribute-value">â€œutf-8â€</span>&nbsp;<span class="tag">?&gt;</span>&nbsp;&nbsp;</span></li>
<li><span><span class="tag">&lt;</span><span class="tag-name">selector</span>&nbsp;<span class="attribute">xmlns:android</span>=<span class="attribute-value">â€œ<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><span class="tag">&gt;</span>&nbsp;&nbsp;</span></li>
<li><span><span class="tag">&lt;</span><span class="tag-name">item</span>&nbsp;<span class="attribute">android:state_enabled</span>=<span class="attribute-value">â€œfalseâ€</span>&nbsp;<span class="attribute">android:color</span>=<span class="attribute-value">â€œ@color/orangeâ€</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">item</span><span class="tag">&gt;</span>&nbsp;&nbsp;</span></li>
<li><span><span class="tag">&lt;</span><span class="tag-name">item</span>&nbsp;<span class="attribute">android:state_window_focused</span>=<span class="attribute-value">â€œfalseâ€</span>&nbsp;<span class="attribute">android:color</span>=<span class="attribute-value">â€œ@color/orangeâ€</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">item</span><span class="tag">&gt;</span>&nbsp;&nbsp;</span></li>
<li><span><span class="tag">&lt;</span><span class="tag-name">item</span>&nbsp;<span class="attribute">android:state_pressed</span>=<span class="attribute-value">â€œtrueâ€</span>&nbsp;<span class="attribute">android:color</span>=<span class="attribute-value">â€œ@color/whiteâ€</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">item</span><span class="tag">&gt;</span>&nbsp;&nbsp;</span></li>
<li><span><span class="tag">&lt;</span><span class="tag-name">item</span>&nbsp;<span class="attribute">android:state_selected</span>=<span class="attribute-value">â€œtrueâ€</span>&nbsp;<span class="attribute">android:color</span>=<span class="attribute-value">â€œ@color/whiteâ€</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">item</span><span class="tag">&gt;</span>&nbsp;&nbsp;</span></li>
<li><span><span class="tag">&lt;</span><span class="tag-name">item</span>&nbsp;<span class="attribute">android:color</span>=<span class="attribute-value">â€œ@color/orangeâ€</span><span class="tag">&gt;</span><span class="tag">&lt;/</span><span class="tag-name">item</span><span class="tag">&gt;</span>&nbsp;&nbsp;</span></li>
<li><span><span class="tag">&lt;/</span><span class="tag-name">selector</span><span class="tag">&gt;</span>&nbsp;&nbsp;&nbsp;</span></li>
<li><span>åœ¨è·å–ç„¦ç‚¹æˆ–è€…é€‰ä¸­çš„æƒ…å†µä¸‹è®¾ç½®ä¸ºç™½è‰²ï¼Œå…¶ä»–æƒ…å†µè®¾ç½®ä¸ºæ©˜é»„è‰²ã€‚&nbsp;&nbsp;</span></li></ol></div>

<p><span>å¦‚ä½•è‡ªå®šä¹‰ListViewè¡Œé—´çš„åˆ†å‰²çº¿ï¼Ÿ</span>&nbsp;<br>æ‰€æœ‰åŸºäºListViewæˆ–è€…è¯´AbsListViewå®ç°çš„widgetæ§ä»¶å‡å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•è®¾ç½®è¡Œé—´è·çš„åˆ†å‰²çº¿ï¼Œåˆ†å‰²çº¿å¯ä»¥è‡ªå®šä¹‰é¢œè‰²ã€æˆ–å›¾ç‰‡ã€‚&nbsp;<br>åœ¨ListViewä¸­æˆ‘ä»¬ä½¿ç”¨å±æ€§android:divider=â€#FF0000â€ å®šä¹‰åˆ†éš”ç¬¦ä¸ºçº¢è‰²ï¼Œå½“ç„¶è¿™é‡Œå€¼å¯ä»¥æŒ‡å‘ä¸€ä¸ªdrawableå›¾ç‰‡å¯¹è±¡ï¼Œå¦‚æœä½¿ç”¨äº†å›¾ç‰‡å¯èƒ½é«˜åº¦å¤§äºç³»ç»Ÿé»˜è®¤çš„åƒç´ ï¼Œå¯ä»¥è‡ªå·±è®¾ç½®é«˜åº¦æ¯”å¦‚6ä¸ªåƒç´ android:dividerHeight=â€6pxâ€ ï¼Œå½“ç„¶åœ¨Javaä¸­ListViewä¹Ÿæœ‰ç›¸å…³æ–¹æ³•å¯ä»¥è®¾ç½®ã€‚&nbsp;</p>
<p><span>ListViewä¸é€šè¿‡notifyDataSetChanged()æ›´æ–°æŒ‡å®šçš„Item</span>&nbsp;<br>Listviewä¸€èˆ¬å¤§éƒ½æ˜¯é€šè¿‡notifyDataSetChanged()ä¾†æ›´æ–°listview,ä½†é€šè¿‡notifyDataSetChanged()ä¼šæŠŠç•Œé¢ä¸Šç°å®çš„çš„iteméƒ½é‡ç»˜ä¸€æ¬¡ï¼Œè¿™æ ·ä¼šå½±å“uiæ€§èƒ½ã€‚&nbsp;<br>å¯ä»¥é€šè¿‡æ›´æ–°æŒ‡å®šçš„Itemæé«˜æ•ˆç‡ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š&nbsp;</p>
<div class="dp-highlighter"><br><div class="bar"><br><div class="tools">Javaä»£ç &nbsp; &nbsp;<a href="http://gundumw100.iteye.com/blog/1169065" title="æ”¶è—è¿™æ®µä»£ç " target="_blank" rel="noopener"><img src="http://gundumw100.iteye.com/images/icon_star.png" alt="æ”¶è—ä»£ç "></a></div>

<p></p></div><p></p>
<ol>
<li><span><span class="keyword">private</span>&nbsp;<span class="keyword">void</span>&nbsp;updateView(<span class="keyword">int</span>&nbsp;itemIndex){&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;<span class="keyword">int</span>&nbsp;visiblePosition&nbsp;=&nbsp;yourListView.getFirstVisiblePosition();&nbsp;&nbsp;&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;View&nbsp;v&nbsp;=&nbsp;yourListView.getChildAt(itemIndex&nbsp;-&nbsp;visiblePosition);<span class="comment">//Do&nbsp;something&nbsp;fancy&nbsp;with&nbsp;your&nbsp;listitem&nbsp;view&nbsp;&nbsp;</span>&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;TextView&nbsp;tv&nbsp;=&nbsp;(TextView)v.findViewById(R.id.sometextview);&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;tv.setText(<span class="string">â€œHi!&nbsp;I&nbsp;updated&nbsp;you&nbsp;manuallyâ€</span>);&nbsp;&nbsp;</span></li>
<li><span>}&nbsp;&nbsp;</span></li></ol></div>

<p><span>è®©ListViewä¸­é•¿æŒ‰æŸäº›Itemæ—¶èƒ½å¼¹å‡ºcontextMenuï¼Œæœ‰äº›ä¸èƒ½</span>&nbsp;<br>å®šä¹‰äº†ä¸€ä¸ªlistViewï¼Œå¹¶ä¸ºä»–è®¾ç½®äº†setOnCreateContextMenuListenerçš„ç›‘å¬ï¼Œä½†è¿™æ ·åšåªèƒ½ä½¿è¿™ä¸ªlistViewä¸­çš„æ‰€æœ‰é¡¹åœ¨é•¿æŒ‰çš„æ—¶å€™å¼¹å‡ºcontextMenu ã€‚&nbsp;<br>æœ‰æ—¶å¸Œæœ›çš„æ˜¯æœ‰äº›é•¿æŒ‰æ—¶èƒ½å¼¹å‡ºcontextMenuï¼Œæœ‰äº›ä¸èƒ½ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•æ˜¯ä¸ºè¿™ä¸ªlistViewè®¾ç½®setOnItemLongClickListenerç›‘å¬ï¼Œç„¶åå®ç°&nbsp;</p>
<div class="dp-highlighter"><br><div class="bar"><br><div class="tools">Javaä»£ç &nbsp; &nbsp;<a href="http://gundumw100.iteye.com/blog/1169065" title="æ”¶è—è¿™æ®µä»£ç " target="_blank" rel="noopener"><img src="http://gundumw100.iteye.com/images/icon_star.png" alt="æ”¶è—ä»£ç "></a></div>

<p></p></div><p></p>
<ol>
<li><span><span class="keyword">public</span>&nbsp;<span class="keyword">boolean</span>&nbsp;onItemLongClick(AdapterView&lt;?&gt;&nbsp;parent,&nbsp;View&nbsp;view,&nbsp;&nbsp;&nbsp;</span></li>
<li><span><span class="keyword">int</span>&nbsp;position,&nbsp;<span class="keyword">long</span>&nbsp;id)&nbsp;{&nbsp;&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;<span class="keyword">if</span>(id&nbsp;==&nbsp;<span class="number">1</span>){&nbsp;&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span>;&nbsp;&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;</span></li>
<li><span>&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span>;&nbsp;&nbsp;&nbsp;</span></li>
<li><span>}&nbsp;&nbsp;&nbsp;</span></li></ol></div>

<p>å¦‚æœè¿™ä¸€é¡¹çš„id=1,å°±ä¸èƒ½é•¿æŒ‰ã€‚ è¿™æ ·å°±å¯ä»¥äº†&nbsp;</p>
<p><span>ListViewåº•éƒ¨åˆ†éš”çº¿çš„é—®é¢˜</span>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨å·¥ä½œä¸­é‡åˆ°äº†ä¸€ä¸ªéš¾é¢˜ï¼Œå°±æ˜¯ä¸€ä¸ªlistViewåœ¨æœ€ä¸‹é¢çš„ä¸€ä¸ªitemä¸‹é¢æ²¡æœ‰åˆ†å‰²çº¿ï¼Œè¦æ±‚æ˜¯å¿…é¡»å¾—æœ‰è¿™æ¡åˆ†å‰²çº¿ã€‚ç»è¿‡ä¸€é€šç ”ç©¶å‘ç°äº†è¿™ä¸ªå¥‡æ€ªçš„ç°è±¡ï¼š&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. ListActivityæœ‰è¿™æ¡åº•éƒ¨åˆ†å‰²çº¿ã€‚&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.åœ¨Activityä¸­åªæœ‰listviewï¼Œæ²¡æœ‰åˆ«çš„æ§ä»¶çš„è¯ä¹Ÿä¼šæœ‰ã€‚&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å…¶å®ListActivityä¹Ÿæ˜¯ä¸€ä¸ªActivityï¼Œåªä¸è¿‡åœ¨å…¶ä¸­ä½¿ç”¨äº†SetContentView(listView)æ–¹æ³•è®¾ç½®äº†ä¸€ä¸ªlistViewä½œä¸ºå…¶æ˜¾ç¤ºçš„Viewè€Œå·²ã€‚æ‰€ä»¥ç»“è®ºå°±æ˜¯åªè¦è¿™ä¸ªactivityè°ƒç”¨äº†SetContentView(listView)å°±ä¼šæœ‰è¿™æ¡åº•éƒ¨åˆ†å‰²çº¿ã€‚&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; é‚£ä¹ˆä»€ä¹ˆæƒ…å†µä¸‹æ‰ä¸ä¼šæœ‰è¿™æ¡åˆ†å‰²çº¿å‘¢ï¼Ÿåœ¨Activityä¸­å¦‚æœè°ƒç”¨setContentView(View)è€ŒListViewåªæ˜¯å†…åµŒå…¥åˆ°è¿™ä¸ªViewçš„è¯æœ‰å¯èƒ½ä¼šæ²¡æœ‰è¿™æ¡åˆ†å‰²çº¿ã€‚&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åˆ†æå…¶åŸå› ï¼šé€šè¿‡åŠ æ–­ç‚¹è°ƒè¯•å‘ç°åœ¨listViewä¸­ï¼Œæ‰€æœ‰çš„åˆ†å‰²çº¿éƒ½æ˜¯é€šè¿‡ç”»ä¸€ä¸ªå¾ˆçª„çš„çŸ©å½¢æ¥å®ç°çš„ï¼Œä½†æ˜¯åœ¨ç”»åˆ†å‰²çº¿å‰éƒ½ä¼šéƒ½ä¼šåˆ¤æ–­ç›®å‰çš„ä½ç½®Aå’ŒlistViewçš„é•¿åº¦Bï¼Œå¦‚æœA=Bäº†ï¼Œé‚£ä¹ˆå°±ä¸ä¼šç”»è¿™æ¡åˆ†å‰²çº¿äº†ã€‚ä½†æ˜¯å°†ListviewåµŒå…¥åˆ°ä¸€ä¸ªViewä¸­ï¼Œä¸€èˆ¬ä¼šè®¾ç½®ä¸ºé«˜åº¦ä¸ºwrap_content,è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€åé‚£æ¡åˆ†å‰²çº¿çš„ä½ç½®åˆšå¥½ç­‰äºlistViewçš„é«˜åº¦ï¼Œæ‰€ä»¥ç³»ç»Ÿä¸ä¼šç”»ä¸Šè¿™æ¡åˆ†å‰²çº¿ã€‚é‚£è¦æ€ä¹ˆæ ·æ‰ä¼šç”»ä¸Šå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå°†ListViewçš„é«˜åº¦è®¾ç½®ä¸ºfill_partentå°±å¯ä»¥äº†ã€‚&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; å½“ç„¶ä»¥ä¸Šæ‰€è¯´çš„éƒ½æ˜¯itemå¾ˆå°‘çš„æƒ…å†µä¸‹ï¼Œå¦‚æœitemå¾ˆå¤šä»¥è‡³äºå¿…é¡»æ˜¾ç¤ºæ»šåŠ¨æ¡çš„è¯ï¼Œé‚£æœ€åä¸€ä¸ªitemä¸‹é¢æ˜¯è‚¯å®šä¸ä¼šæœ‰åˆ†å‰²çº¿äº†ã€‚<span>&lt;!â€“[endif]â€“&gt;&nbsp;&lt;!â€“[endif]â€“&gt;</span></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> ListView </tag>
            
            <tag> tips </tag>
            
            <tag> view </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è®¾ç½®EditTextæ˜¯å¦å¯ç¼–è¾‘]]></title>
      <url>/2012/06/15/%E8%AE%BE%E7%BD%AEEditText%E6%98%AF%E5%90%A6%E5%8F%AF%E7%BC%96%E8%BE%91/</url>
      <content type="html"><![CDATA[<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/<em>*</em></span><br><span style="color: #008080;"> 2</span> <span style="color: #008000;">      è®¾ç½®EditTextæ˜¯å¦å¯ç¼–è¾‘<br></span><span style="color: #008080;"> 3</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@author</span><span style="color: #008000;"> com.tiantian<br></span><span style="color: #008080;"> 4</span> <span style="color: #008000;">      </span><span style="color: #808080;">@param</span><span style="color: #008000;"> editText è¦è®¾ç½®çš„EditText<br></span><span style="color: #008080;"> 5</span> <span style="color: #008000;">     <em> </em></span><span style="color: #808080;">@param</span><span style="color: #008000;"> value å¯ç¼–è¾‘:true ä¸å¯ç¼–è¾‘:false<br></span><span style="color: #008080;"> 6</span>      <span style="color: #008000;">/</span><br><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> setEditTextEditable(EditText editText, <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> value){<br></span><span style="color: #008080;"> 8</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;">(value){<br></span><span style="color: #008080;"> 9</span>             editText.setFocusableInTouchMode(<span style="color: #0000ff;">true</span><span style="color: #000000;">);<br></span><span style="color: #008080;">10</span> <span style="color: #000000;">            editText.requestFocus();<br></span><span style="color: #008080;">11</span>         }<span style="color: #0000ff;">else</span><span style="color: #000000;">{<br></span><span style="color: #008080;">12</span>             editText.setFocusableInTouchMode(<span style="color: #0000ff;">false</span><span style="color: #000000;">);<br></span><span style="color: #008080;">13</span> <span style="color: #000000;">            editText.clearFocus();<br></span><span style="color: #008080;">14</span> <span style="color: #000000;">        }<br></span><span style="color: #008080;">15</span>     }</pre><br></div>]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidä¸­Applicationè®¾ç½®å…¨å±€å˜é‡ä»¥åŠä¼ å€¼]]></title>
      <url>/2012/06/14/Android%E4%B8%ADApplication%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E4%BB%A5%E5%8F%8A%E4%BC%A0%E5%80%BC/</url>
      <content type="html"><![CDATA[<p><span>Applicationè®¾ç½®å…¨å±€å˜é‡ä»¥åŠä¼ å€¼&nbsp;</span></p>
<ol>
<li>/**</li>
<li><ul>
<li>é‡å†™Applicationï¼Œä¸»è¦é‡å†™é‡Œé¢çš„onCreateæ–¹æ³•ï¼Œå°±æ˜¯åˆ›å»ºçš„æ—¶å€™ï¼Œ</li>
</ul>
</li>
<li><ul>
<li>æˆ‘ä»¬è®©å®ƒåˆå§‹åŒ–ä¸€äº›å€¼ï¼Œå‰æ®µæ—¶é—´åœ¨javaeyeé‡Œé¢çœ‹åˆ°è¿‡ä¸€ä¸ªä¾‹å­ï¼Œä¸æ­¤ç›¸ä¼¼ï¼Œ</li>
</ul>
</li>
<li><ul>
<li>æˆ‘åšäº†äº›æ”¹è¿›ã€‚å¬è¯´å¤–å›½å¼€å‘è€…ä¹ æƒ¯ç”¨æ­¤åˆå§‹åŒ–ä¸€äº›å…¨å±€å˜é‡ï¼Œå¥½åƒåœ¨Activity</li>
</ul>
</li>
<li><ul>
<li>ä¸€äº›ç±»é‡Œé¢åˆå§‹åŒ–å…¨å±€å˜é‡çš„åŒ–ï¼Œä¼šé‡åˆ°ä¸€äº›ç©ºæŒ‡é’ˆçš„å¼‚å¸¸ï¼Œå½“ç„¶ï¼Œæˆ‘æ²¡æœ‰é‡åˆ°è¿‡ã€‚</li>
</ul>
</li>
<li><ul>
<li>å¦‚æœç”¨æ­¤æ–¹æ³•åˆå§‹åŒ–çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥é¿å…é‚£äº›æœ‰å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚</li>
</ul>
</li>
<li>*&nbsp;</li>
<li><ul>
<li>å¯åŠ¨Applicationï¼Œä»–å°±ä¼šåˆ›å»ºä¸€ä¸ªPIDï¼Œå°±æ˜¯è¿›ç¨‹IDï¼Œæ‰€æœ‰çš„Activityå°±ä¼šåœ¨æ­¤è¿›ç¨‹ä¸Šè¿è¡Œã€‚</li>
</ul>
</li>
<li><ul>
<li>é‚£ä¹ˆæˆ‘ä»¬åœ¨Applicationåˆ›å»ºçš„æ—¶å€™åˆå§‹åŒ–å…¨å±€å˜é‡ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æ‰€æœ‰çš„Activityéƒ½å¯ä»¥æ‹¿åˆ°è¿™äº›</li>
</ul>
</li>
<li><ul>
<li>å…¨å±€å˜é‡ï¼Œå†è¿›ä¸€æ­¥è¯´ï¼Œæˆ‘ä»¬åœ¨æŸä¸€ä¸ªActivityä¸­æ”¹å˜äº†è¿™äº›å…¨å±€å˜é‡çš„å€¼ï¼Œé‚£ä¹ˆåœ¨åˆ«çš„Activityä¸­</li>
</ul>
</li>
<li><ul>
<li>æ˜¯ä¸æ˜¯å€¼å°±æ”¹å˜äº†å‘¢ï¼Œè¿™ä¸ªç®—ä¸ç®—ä¼ å€¼å‘¢ï¼Ÿ</li>
</ul>
</li>
<li><ul>
<li>OKï¼Œé‚£ä¹ˆä¸‹é¢çš„ä¾‹å­æˆ‘ä»¬æµ‹è¯•ä¸‹ã€‚ã€‚ã€‚</li>
</ul>
</li>
<li><ul>
<li>@author yong.wang</li>
</ul>
</li>
<li>*</li>
<li>*/</li>
<li>public class MyApplication extends Application {<br>17.18.  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;private String name;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;@Override</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;public void onCreate() {</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; super.onCreate();</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; setName(NAME); //åˆå§‹åŒ–å…¨å±€å˜é‡</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br>25.26.  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;public String getName() {</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; return name;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}<br>29.30.  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;public void setName(String name) {</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; this.name = name;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;private static final String NAME = â€œMyApplicationâ€;</li>
<li>}</li>
</ol>
<p><span>//Ok,åº”ç”¨ç¨‹åºåˆ›å»ºå¥½äº†ï¼Œä¸è¿‡æˆ‘ä»¬åº”è¯¥åœ¨é…ç½®æ–‡ä»¶ApplicationManifest.xmlä¸­å°†è¦è¿è¡Œçš„åº”ç”¨ç¨‹åºMyApplicationåŠ è¿›å»ï¼Œä¿®æ”¹ä¸‹:</span></p>
<ol>
<li>&lt;?xml version=â€1.0â€ encoding=â€utf-8â€?&gt;</li>
<li>&lt;manifest xmlns:android=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;package=â€com.hisoft.appâ€</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;android:versionCode=â€1â€</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;android:versionName=â€1.0â€&gt;</li>
<li>&nbsp; &nbsp; &lt;application android:icon=â€@drawable/iconâ€ android:label=â€@string/app_nameâ€</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;android:name=â€.MyApplicationâ€&gt;&nbsp;&nbsp;å°±æ˜¯è¿™å„¿ï¼Œå°†æˆ‘ä»¬ä»¥å‰ä¸€ç›´ç”¨çš„é»˜è®¤Applicationç»™ä»–è®¾ç½®æˆæˆ‘ä»¬è‡ªå·±åšçš„MyApplication</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;activity&nbsp;android:name=â€.MyFirstActivityâ€</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;android:label=â€@string/app_nameâ€&gt;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;intent-filter&gt;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;action android:name=â€android.intent.action.MAINâ€ /&gt;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;category android:name=â€android.intent.category.LAUNCHERâ€ /&gt;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&lt;/intent-filter&gt;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;/activity&gt;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;activity android:name=â€.MySecondActivityâ€&gt;&lt;/activity&gt;</li>
<li>&nbsp; &nbsp; &lt;/application&gt;</li>
<li>&nbsp; &nbsp; &lt;uses-sdk&nbsp;android:minSdkVersion=â€8â€ /&gt;<br>18.19.  &lt;/manifest&gt;</li>
</ol>
<p><span>å½“xmlé…ç½®æ–‡ä»¶è¿è¡Œå®Œandroid:name=â€.MyApplicationâ€&gt;ï¼Œåœ¨æ­¤é‚£ä¹ˆå°±åˆ†é…å¥½äº†è¿›ç¨‹IDï¼Œå†ä¸‹é¢ï¼Œæˆ‘ä»¬å°±è¦è¿è¡Œæˆ‘ä»¬çš„Activityäº†</span></p>
<ol>
<li>public class MyFirstActivity extends Activity {</li>
<li>&nbsp; &nbsp;&nbsp;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;private MyApplication app;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</li>
<li>&nbsp; &nbsp; @Override</li>
<li>&nbsp; &nbsp; public void onCreate(Bundle savedInstanceState) {</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;super.onCreate(savedInstanceState);</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;setContentView(R.layout.main);</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;app = (MyApplication) getApplication(); //è·å¾—æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºMyApplication</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Log.e(â€œMyFirstActivityOriginalâ€, app.getName());&nbsp; &nbsp;//å°†æˆ‘ä»¬æ”¾åˆ°è¿›ç¨‹ä¸­çš„å…¨å±€å˜é‡æ‹¿å‡ºæ¥ï¼Œçœ‹æ˜¯ä¸æ˜¯æˆ‘ä»¬æ›¾ç»è®¾ç½®çš„å€¼</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;app.setName(â€œis coolâ€);&nbsp;&nbsp;//OKï¼Œç°åœ¨æˆ‘ä»¬å¼€å§‹ä¿®æ”¹äº†</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Log.e(â€œMyFirstActivityChangedâ€, app.getName()); //å†çœ‹ä¸‹ï¼Œè¿™ä¸ªå€¼æ”¹å˜äº†æ²¡æœ‰</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Intent&nbsp;intent = new Intent();&nbsp;&nbsp;//æ›´é‡è¦çš„æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åœ¨åˆ«çš„Activityä¸­æ˜¯æ‹¿åˆ°åˆå§‹åŒ–çš„å€¼ï¼Œè¿˜æ˜¯ä¿®æ”¹åçš„</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;intent.setClass(this, MySecondActivity.class);</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;startActivity(intent);</li>
<li>&nbsp; &nbsp; }</li>
<li>}</li>
</ol>
<p><span>ä¸Šé¢è¿è¡Œå®Œäº†ï¼Œå°±è¦è·³åˆ°è¿™ä¸ªActivityäº†</span></p>
<ol>
<li>public class MySecondActivity extends Activity {<br>2.3.  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;private MyApplication app;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;@Override</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;protected void onCreate(Bundle savedInstanceState) {</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; super.onCreate(savedInstanceState);</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; setContentView(R.layout.main);</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; app = (MyApplication) getApplication();&nbsp;&nbsp;//è·å–åº”ç”¨ç¨‹åº</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; Log.e(â€œMySecondActivityâ€, app.getName()); //è·å–å…¨å±€å€¼</li>
<li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</li>
<li>}</li>
</ol>
<p><em>å¤åˆ¶ä»£ç </em></p>
<p><span>OKï¼Œçœ‹ä¸‹å€¼ï¼šå½“ç„¶æˆ‘å·²ç»è¿è¡Œè¿‡äº†ï¼Œ</span><br><span>MyFirstActivityOriginal&nbsp; &nbsp;&nbsp; &nbsp; MyApplication&nbsp;</span><br><span>MyFirstActivityChanged&nbsp; &nbsp;&nbsp;&nbsp;is cool</span><br><span>MySecondActivity&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; is cool</span><br><span>çœ‹çœ‹ï¼Œæ˜¯ä¸æ˜¯ç‰¹åˆ«ä»¤äººå…´å¥‹,å½“ç„¶æœ‰å¯èƒ½ä½ é€€å‡ºä¹‹åå†è¿è¡Œçš„æ—¶å€™ï¼Œå°±ç¬¬2ã€3ã€‚ã€‚ã€‚æ¬¡ï¼Œæœ‰å¯èƒ½ä¼š3ä¸ªè¾“å‡ºå…¨æ˜¯ is coolï¼Œé‚£æ˜¯ä½ æ²¡æ€æ‰è¿›ç¨‹çš„é—®é¢˜ã€‚</span></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> application </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidè‡ªå®šä¹‰å±æ€§ï¼Œformatè¯¦è§£]]></title>
      <url>/2012/06/06/Android%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%EF%BC%8Cformat%E8%AF%A6%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p><strong>1. referenceï¼šå‚è€ƒæŸä¸€èµ„æºIDã€‚</strong></p>
<p>&nbsp;&nbsp;&nbsp; ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name = â€œåç§°â€&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>background</span>â€œ format = â€œ<span>reference</span>â€œ /&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ImageView</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_width = â€œ42dipâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;android:layout_height = â€œ42dipâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>background</span>&nbsp;= â€œ<span>@drawable/å›¾ç‰‡ID</span>â€œ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&gt;</p>
<p><strong>2. colorï¼šé¢œè‰²å€¼ã€‚</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name = â€œåç§°â€&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>textColor</span>â€œ format = â€œ<span>color</span>â€œ /&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp; ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextView</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_width = â€œ42dipâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;android:layout_height = â€œ42dipâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span><span>textColor</span></span>&nbsp;= â€œ<span>#00FF00</span>â€œ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&gt;</p>
<p><strong>3. booleanï¼šå¸ƒå°”å€¼ã€‚</strong></p>
<p>&nbsp;&nbsp;&nbsp; ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name = â€œåç§°â€&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>focusable</span>â€œ format = â€œ<span>boolean</span>â€œ /&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Button</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_width = â€œ42dipâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_height = â€œ42dipâ€</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>focusable</span>&nbsp;= â€œ<span>true</span>â€œ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&gt;</p>
<p><strong>4. dimensionï¼šå°ºå¯¸å€¼ã€‚</strong></p>
<p>&nbsp;&nbsp;&nbsp; ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name = â€œåç§°â€&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>layout_width</span>â€œ format = â€œ<span>dimension</span>â€œ /&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Button</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>layout_width</span>&nbsp;= â€œ<span>42dip</span>â€œ<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>layout_height</span>&nbsp;= â€œ<span>42dip</span>â€œ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&gt;</p>
<p><strong>5. floatï¼šæµ®ç‚¹å€¼ã€‚</strong></p>
<p>&nbsp;&nbsp;&nbsp; ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name = â€œAlphaAnimationâ€&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>fromAlpha</span>â€œ format = â€œ<span>float</span>â€œ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>toAlpha</span>â€œ format = â€œ<span>float</span>â€œ /&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;alpha<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>fromAlpha</span>&nbsp;= â€œ<span>1.0</span>â€œ<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>toAlpha</span>&nbsp;= â€œ<span>0.7</span>â€œ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&gt;</p>
<p><strong>6. integerï¼šæ•´å‹å€¼ã€‚</strong></p>
<p>&nbsp;&nbsp;&nbsp; ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name = â€œAnimatedRotateDrawableâ€&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œvisibleâ€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>frameDuration</span>â€œ format=â€<span>integer</span>â€œ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>framesCount</span>â€œ format=â€<span>integer</span>â€œ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œpivotXâ€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œpivotYâ€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œdrawableâ€ /&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;animated-rotate</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmlns:android = â€œ<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:drawable = â€œ@drawable/å›¾ç‰‡IDâ€&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; android:pivotX = â€œ50%â€&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:pivotY = â€œ50%â€&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>framesCount</span>&nbsp;= â€œ<span>12</span>â€œ&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>frameDuration</span>&nbsp;= â€œ<span>100</span>â€œ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&gt;</p>
<p><strong>7. stringï¼šå­—ç¬¦ä¸²ã€‚</strong></p>
<p>&nbsp;&nbsp;&nbsp; ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name = â€œMapViewâ€&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>apiKey</span>â€œ format = â€œ<span>string</span>â€œ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;com.google.android.maps.MapView<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_width = â€œfill_parentâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;android:layout_height = â€œfill_parentâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;android:<span>apiKey</span>&nbsp;= â€œ<span>0jOkQ80oD1JL9C6HAja99uGXCRiS2CGjKO_bc_g</span>â€œ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&gt;</p>
<p><strong>8. fractionï¼šç™¾åˆ†æ•°ã€‚</strong></p>
<p>&nbsp;&nbsp;&nbsp; ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name=â€RotateDrawableâ€&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œvisibleâ€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œfromDegreesâ€ format = â€œfloatâ€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œtoDegreesâ€ format = â€œfloatâ€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>pivotX</span>â€œ format = â€œ<span>fraction</span>â€œ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>pivotY</span>â€œ format = â€œ<span>fraction</span>â€œ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œdrawableâ€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;rotate</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmlns:android = â€œ<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ&nbsp;<br>ã€€ã€€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:interpolator = â€œ@anim/åŠ¨ç”»IDâ€</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:fromDegrees = â€œ0â€&nbsp;<br>ã€€ã€€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:toDegrees = â€œ360â€</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>pivotX</span>&nbsp;= â€œ<span>200%</span>â€œ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>pivotY</span>&nbsp;= â€œ<span>300%</span>â€œ&nbsp;<br>ã€€ã€€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:duration = â€œ5000â€</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:repeatMode = â€œrestartâ€</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;android:repeatCount = â€œinfiniteâ€</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&gt;</p>
<p><strong>9. enumï¼šæšä¸¾å€¼ã€‚</strong></p>
<p>&nbsp;&nbsp;&nbsp; ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name=â€åç§°â€&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name=â€<span>orientation</span>â€œ&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;<span>enum&nbsp;</span>name=â€<span>horizontal</span>â€œ value=â€0â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;<span>enum</span>&nbsp;name=â€<span>vertical</span>â€œ value=â€1â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/attr&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;LinearLayout</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmlns:android = â€œ<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>orientation</span>&nbsp;= â€œ<span>vertical</span>â€œ<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_width = â€œfill_parentâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_height = â€œfill_parentâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/LinearLayout&gt;</p>
<p><strong>10. flagï¼šä½æˆ–è¿ç®—ã€‚</strong></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name=â€åç§°â€&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name=â€<span>windowSoftInputMode</span>â€œ&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span>flag&nbsp;</span>name = â€œ<span>stateUnspecified</span>â€œ value = â€œ0â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span>flag</span>&nbsp;name = â€œ<span>stateUnchanged</span>â€œ value = â€œ1â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span>flag&nbsp;</span>name = â€œ<span>stateHidden</span>â€œ value = â€œ2â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span>flag</span>&nbsp;name =&nbsp;â€<span>stateAlwaysHidden</span>â€œ value = â€œ3â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span>flag</span>&nbsp;name = â€œ<span>stateVisible</span>â€œ value = â€œ4â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span>flag</span>&nbsp;name = â€œ<span>stateAlwaysVisible</span>â€œ value = â€œ5â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span>flag&nbsp;</span>name = â€œ<span>adjustUnspecified</span>â€œ value = â€œ0x00â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span>flag</span>&nbsp;name = â€œ<span>adjustResize</span>â€œ value = â€œ0x10â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span>flag</span>&nbsp;name = â€œ<span>adjustPan</span>â€œ value = â€œ0x20â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<span>flag</span>&nbsp;name = â€œ<span>adjustNothing</span>â€œ value = â€œ0x30â€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/attr&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;activity</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:name = â€œ.StyleAndThemeActivityâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:label = â€œ@string/app_nameâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>windowSoftInputMode&nbsp;</span>= â€œ<span>stateUnspecified | stateUnchangedã€€|ã€€stateHidden</span>â€œ&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;intent-filter&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;action android:name = â€œandroid.intent.action.MAINâ€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;category android:name = â€œandroid.intent.category.LAUNCHERâ€ /&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/intent-filter&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/activity&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>æ³¨æ„ï¼š</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å±æ€§å®šä¹‰æ—¶å¯ä»¥æŒ‡å®šå¤šç§ç±»å‹å€¼ã€‚</p>
<p>&nbsp;&nbsp;&nbsp; ï¼ˆ1ï¼‰å±æ€§å®šä¹‰ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;declare-styleable name = â€œåç§°â€&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;attr name = â€œ<span>background</span>â€œ format = â€œ<span>reference|color</span>â€œ /&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/declare-styleable&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ï¼ˆ2ï¼‰å±æ€§ä½¿ç”¨ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ImageView</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_width = â€œ42dipâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;android:layout_height = â€œ42dipâ€<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:<span>background</span>&nbsp;= â€œ<span>@drawable/å›¾ç‰‡ID|#00FF00</span>â€œ</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&gt;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> attr </tag>
            
            <tag> attrubite </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[é—®é¢˜Re-installation failed due to different application signatures.è§£å†³]]></title>
      <url>/2012/05/28/%E9%97%AE%E9%A2%98Re-installation-failed-due-to-different-application-signatures-%E8%A7%A3%E5%86%B3/</url>
      <content type="html"><![CDATA[<p>è¿›å…¥SDKçš„<span>toolsç›®å½•ï¼š</span></p>
<p><span><span>adb uninstall com.xxx.xxx(åŒ…å)</span></span></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> exception </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[android:ellipsizeå±æ€§çš„å«ä¹‰]]></title>
      <url>/2012/05/22/android-ellipsize%E5%B1%9E%E6%80%A7%E7%9A%84%E5%90%AB%E4%B9%89/</url>
      <content type="html"><![CDATA[<p><span>TextViewåŠå…¶å­ç±»ï¼Œå½“å­—ç¬¦å†…å®¹å¤ªé•¿æ˜¾ç¤ºä¸ä¸‹æ—¶å¯ä»¥çœç•¥å·ä»£æ›¿æœªæ˜¾ç¤ºçš„å­—ç¬¦ï¼›çœç•¥å·å¯ä»¥åœ¨æ˜¾ç¤ºåŒºåŸŸçš„èµ·å§‹ï¼Œä¸­é—´ï¼Œç»“æŸä½ç½®ï¼Œæˆ–è€…ä»¥è·‘é©¬ç¯çš„æ–¹å¼æ˜¾ç¤ºæ–‡å­—(textviewçš„çŠ¶æ€ä¸ºè¢«é€‰ä¸­)ã€‚&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; å…¶å®ç°åªéœ€åœ¨xmlä¸­å¯¹textviewçš„ellipsizeå±æ€§åšç›¸åº”çš„è®¾ç½®å³å¯ã€‚</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:ellipsize=â€startâ€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; çœç•¥å·åœ¨å¼€å¤´&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:ellipsize=â€middleâ€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; çœç•¥å·åœ¨ä¸­é—´&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:ellipsize=â€endâ€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; çœç•¥å·åœ¨ç»“å°¾&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:ellipsize=â€marqueeâ€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; è·‘é©¬ç¯æ˜¾ç¤º</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æˆ–è€…åœ¨ç¨‹åºä¸­å¯é€šè¿‡setEillpsizeæ˜¾å¼è®¾ç½®ã€‚<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; æ³¨: EditTextä¸æ”¯æŒmarqueeè¿™ç§æ¨¡å¼ã€‚</span></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> view </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[android å¼‚å¸¸ï¼šScrollView can host only one direct child]]></title>
      <url>/2012/05/22/android-%E5%BC%82%E5%B8%B8%EF%BC%9AScrollView-can-host-only-one-direct-child/</url>
      <content type="html"><![CDATA[<p>android é‡‡ç”¨ScrollViewå¸ƒå±€æ—¶å‡ºç°å¼‚å¸¸ï¼š<span>ScrollView can host only one direct child</span>ã€‚</p>
<p>ä¸»è¦æ˜¯<span>ScrollViewå†…éƒ¨åªèƒ½æœ‰ä¸€ä¸ªå­å…ƒç´ ï¼Œå³ä¸èƒ½å¹¶åˆ—ä¸¤ä¸ªå­å…ƒç´ </span>ï¼Œæ‰€ä»¥éœ€è¦æŠŠæ‰€æœ‰çš„å­å…ƒç´ æ”¾åˆ°ä¸€ä¸ªLinearLayoutå†…éƒ¨æˆ–RelativeLayoutç­‰å…¶ä»–å¸ƒå±€æ–¹å¼ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> exception </tag>
            
            <tag> ScrollView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[androidçœŸæœºè°ƒè¯•æ—¶æ— æ³•æ˜¾ç¤ºlogcatä¿¡æ¯çš„è§£å†³åŠæ³•]]></title>
      <url>/2012/05/09/android%E7%9C%9F%E6%9C%BA%E8%B0%83%E8%AF%95%E6%97%B6%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BAlogcat%E4%BF%A1%E6%81%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
      <content type="html"><![CDATA[<p><strong>androidçœŸæœºè°ƒè¯•æ—¶æ— æ³•æ˜¾ç¤ºlogcatä¿¡æ¯çš„è§£å†³åŠæ³•ï¼š</strong></p>
<p><span>windowâ€“&gt;show viewâ€“&gt;android-&gt;devicesï¼Œ</span></p>
<p><span>æ‰“å¼€devicesï¼Œç‚¹å‡»å³è¾¹çš„æˆªå±å›¾ç‰‡çš„æŒ‰é’®ã€‚ç­‰åˆ°å‡ºç°æˆªå›¾çš„æ—¶å€™ï¼Œlogcatå°±å‡ºæ¥ä¿¡æ¯äº†ï¼</span></p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[Javaä¸­çš„å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨]]></title>
      <url>/2012/05/03/Java%E4%B8%AD%E7%9A%84%E5%BC%BA%E5%BC%95%E7%94%A8%E3%80%81%E8%BD%AF%E5%BC%95%E7%94%A8%E3%80%81%E5%BC%B1%E5%BC%95%E7%94%A8%E5%92%8C%E8%99%9A%E5%BC%95%E7%94%A8/</url>
      <content type="html"><![CDATA[<h2 id="Javaä¸­çš„å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨-nbsp"><a href="#Javaä¸­çš„å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨-nbsp" class="headerlink" title="Javaä¸­çš„å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨&nbsp;"></a>Javaä¸­çš„å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨&nbsp;</h2><div><span>åŸæ–‡é“¾æ¥</span><span>:</span><span><a href="http://aaronfu.net/?p=9995" target="_blank" rel="noopener">http://aaronfu.net/?p=9995</a></span></div>

<p>ä»JDK1.2ç‰ˆæœ¬å¼€å§‹ï¼ŒæŠŠå¯¹è±¡çš„å¼•ç”¨åˆ†ä¸ºå››ç§çº§åˆ«ï¼Œä»è€Œä½¿ç¨‹åºèƒ½æ›´åŠ çµæ´»çš„æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™å››ç§çº§åˆ«ç”±é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼šå¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨ã€‚</p>
<p><strong>1ï¼å¼ºå¼•ç”¨</strong><br>æœ¬ç« å‰æ–‡ä»‹ç»çš„å¼•ç”¨å®é™…ä¸Šéƒ½æ˜¯å¼ºå¼•ç”¨ï¼Œè¿™æ˜¯ä½¿ç”¨æœ€æ™®éçš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼ºå¼•ç”¨ï¼Œé‚£å°±ç±»ä¼¼äºå¿…ä¸å¯å°‘çš„ç”Ÿæ´»ç”¨å“ï¼Œåƒåœ¾å›æ”¶å™¨ç»ä¸ä¼šå›æ”¶å®ƒã€‚å½“å†…å­˜ç©º é—´ä¸è¶³ï¼ŒJavaè™šæ‹Ÿæœºå®æ„¿æŠ›å‡ºOutOfMemoryErroré”™è¯¯ï¼Œä½¿ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ï¼Œä¹Ÿä¸ä¼šé éšæ„å›æ”¶å…·æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡æ¥è§£å†³å†…å­˜ä¸è¶³é—®é¢˜ã€‚</p>
<p><strong>2ï¼è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰</strong></p>
<p>å¦‚æœä¸€ä¸ªå¯¹è±¡åªå…·æœ‰è½¯å¼•ç”¨ï¼Œé‚£å°±ç±»ä¼¼äºå¯æœ‰å¯ç‰©çš„ç”Ÿæ´»ç”¨å“ã€‚å¦‚æœå†…å­˜ç©ºé—´è¶³å¤Ÿï¼Œåƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶å®ƒï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸è¶³äº†ï¼Œå°±ä¼šå›æ”¶è¿™äº›å¯¹è±¡çš„å†…å­˜ã€‚åªè¦åƒåœ¾å›æ”¶å™¨æ²¡æœ‰å›æ”¶å®ƒï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥è¢«ç¨‹åºä½¿ç”¨ã€‚è½¯å¼•ç”¨å¯ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜ã€‚<br>è½¯å¼•ç”¨å¯ä»¥å’Œä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå¦‚æœè½¯å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼ŒJavaè™šæ‹Ÿæœºå°±ä¼šæŠŠè¿™ä¸ªè½¯å¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚</p>
<p><strong>3ï¼å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰</strong><br>å¦‚æœä¸€ä¸ªå¯¹è±¡åªå…·æœ‰å¼±å¼•ç”¨ï¼Œé‚£å°±ç±»ä¼¼äºå¯æœ‰å¯ç‰©çš„ç”Ÿæ´»ç”¨å“ã€‚å¼±å¼•ç”¨ä¸è½¯å¼•ç”¨çš„åŒºåˆ«åœ¨äºï¼šåªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸã€‚åœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒ æ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ä¸è¿‡ï¼Œç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ï¼Œ å› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚<br>å¼±å¼•ç”¨å¯ä»¥å’Œä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå¦‚æœå¼±å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼ŒJavaè™šæ‹Ÿæœºå°±ä¼šæŠŠè¿™ä¸ªå¼±å¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚</p>
<p><strong>4ï¼è™šå¼•ç”¨ï¼ˆPhantomReferenceï¼‰</strong><br>â€œè™šå¼•ç”¨â€é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å½¢åŒè™šè®¾ï¼Œä¸å…¶ä»–å‡ ç§å¼•ç”¨éƒ½ä¸åŒï¼Œè™šå¼•ç”¨å¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶ã€‚<br>è™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶çš„æ´»åŠ¨ã€‚è™šå¼•ç”¨ä¸è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨çš„ä¸€ä¸ªåŒºåˆ«åœ¨äºï¼šè™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ã€‚å½“åƒ åœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ç¨‹åºå¯ä»¥é€šè¿‡åˆ¤æ–­å¼•ç”¨é˜Ÿåˆ—ä¸­æ˜¯ å¦å·²ç»åŠ å…¥äº†è™šå¼•ç”¨ï¼Œæ¥äº†è§£</p>
<p>è¢«å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦å°†è¦è¢«åƒåœ¾å›æ”¶ã€‚ç¨‹åºå¦‚æœå‘ç°æŸä¸ªè™šå¼•ç”¨å·²ç»è¢«åŠ å…¥åˆ°å¼•ç”¨é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨æ‰€å¼•ç”¨çš„å¯¹è±¡çš„å†…å­˜è¢«å›æ”¶ä¹‹å‰é‡‡å–å¿…è¦çš„è¡ŒåŠ¨ã€‚</p>
<p>åœ¨æœ¬ä¹¦ä¸­ï¼Œâ€å¼•ç”¨â€æ—¢å¯ä»¥ä½œä¸ºåŠ¨è¯ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºåè¯ï¼Œè¯»è€…åº”è¯¥æ ¹æ®ä¸Šä¸‹æ–‡æ¥åŒºåˆ†â€å¼•ç”¨â€çš„å«ä¹‰ã€‚</p>
<p>åœ¨java.lang.refåŒ…ä¸­æä¾›äº†ä¸‰ä¸ªç±»ï¼šSoftReferenceç±»ã€WeakReferenceç±»å’ŒPhantomReferenceç±»ï¼Œå®ƒ ä»¬åˆ†åˆ«ä»£è¡¨è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨ã€‚ReferenceQueueç±»è¡¨ç¤ºå¼•ç”¨é˜Ÿåˆ—ï¼Œå®ƒå¯ä»¥å’Œè¿™ä¸‰ç§å¼•ç”¨ç±»è”åˆä½¿ç”¨ï¼Œä»¥ä¾¿è·Ÿè¸ªJavaè™šæ‹Ÿæœºå›æ”¶æ‰€å¼•ç”¨çš„å¯¹ è±¡çš„æ´»åŠ¨ã€‚ä»¥ä¸‹ç¨‹åºåˆ›å»ºäº†ä¸€ä¸ªStringå¯¹è±¡ã€ReferenceQueueå¯¹è±¡å’ŒWeakReferenceå¯¹è±¡ï¼š</p>
<p>//åˆ›å»ºä¸€ä¸ªå¼ºå¼•ç”¨<br>String str = new String(â€œhelloâ€);</p>
<p>//åˆ›å»ºå¼•ç”¨é˜Ÿåˆ—, &lt;String&gt;ä¸ºèŒƒå‹æ ‡è®°ï¼Œè¡¨æ˜é˜Ÿåˆ—ä¸­å­˜æ”¾Stringå¯¹è±¡çš„å¼•ç”¨<br>ReferenceQueue&lt;String&gt; rq = new ReferenceQueue&lt;String&gt;();</p>
<p>//åˆ›å»ºä¸€ä¸ªå¼±å¼•ç”¨ï¼Œå®ƒå¼•ç”¨â€helloâ€å¯¹è±¡ï¼Œå¹¶ä¸”ä¸rqå¼•ç”¨é˜Ÿåˆ—å…³è”<br>//&lt;String&gt;ä¸ºèŒƒå‹æ ‡è®°ï¼Œè¡¨æ˜WeakReferenceä¼šå¼±å¼•ç”¨Stringå¯¹è±¡<br>WeakReference&lt;String&gt; wf = new WeakReference&lt;String&gt;(str, rq);</p>
<p>ä»¥ä¸Šç¨‹åºä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå†…å­˜ä¸­å¼•ç”¨ä¸å¯¹è±¡çš„å…³ç³»å¦‚å›¾11-10æ‰€ç¤ºã€‚</p>
<p><img src="http://www.javathinker.org/java/ref_1.gif" alt=""></p>
<p>å›¾11-10 â€œhelloâ€å¯¹è±¡åŒæ—¶å…·æœ‰å¼ºå¼•ç”¨å’Œå¼±å¼•ç”¨</p>
<p>åœ¨å›¾11-10ä¸­ï¼Œå¸¦å®çº¿çš„ç®­å¤´è¡¨ç¤ºå¼ºå¼•ç”¨ï¼Œå¸¦è™šçº¿çš„ç®­å¤´è¡¨ç¤ºå¼±å¼•ç”¨ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶â€helloâ€å¯¹è±¡è¢«strå¼ºå¼•ç”¨ï¼Œå¹¶ä¸”è¢«ä¸€ä¸ªWeakReferenceå¯¹è±¡å¼±å¼•ç”¨ï¼Œå› æ­¤â€helloâ€å¯¹è±¡ä¸ä¼šè¢«åƒåœ¾å›æ”¶ã€‚<br>åœ¨ä»¥ä¸‹ç¨‹åºä»£ç ä¸­ï¼ŒæŠŠå¼•ç”¨â€helloâ€å¯¹è±¡çš„strå˜é‡ç½®ä¸ºnullï¼Œç„¶åå†é€šè¿‡WeakReferenceå¼±å¼•ç”¨çš„get()æ–¹æ³•è·å¾—â€helloâ€å¯¹è±¡çš„å¼•ç”¨ï¼š</p>
<p>String str = new String(â€œhelloâ€); //â‘ <br>ReferenceQueue&lt;String&gt; rq = new ReferenceQueue&lt;String&gt;(); //â‘¡<br>WeakReference&lt;String&gt; wf = new WeakReference&lt;String&gt;(str, rq); //â‘¢</p>
<p>str=null; //â‘£å–æ¶ˆâ€helloâ€å¯¹è±¡çš„å¼ºå¼•ç”¨<br>String str1=wf.get(); //â‘¤å‡å¦‚â€helloâ€å¯¹è±¡æ²¡æœ‰è¢«å›æ”¶ï¼Œstr1å¼•ç”¨â€helloâ€å¯¹è±¡</p>
<p>//å‡å¦‚â€helloâ€å¯¹è±¡æ²¡æœ‰è¢«å›æ”¶ï¼Œrq.poll()è¿”å›null<br>Reference&lt;? extends String&gt; ref=rq.poll(); //â‘¥</p>
<p>æ‰§è¡Œå®Œä»¥ä¸Šç¬¬â‘£è¡Œåï¼Œå†…å­˜ä¸­å¼•ç”¨ä¸å¯¹è±¡çš„å…³ç³»å¦‚å›¾11-11æ‰€ç¤ºï¼Œæ­¤ æ—¶â€helloâ€å¯¹è±¡ä»…ä»…å…·æœ‰å¼±å¼•ç”¨ï¼Œå› æ­¤å®ƒæœ‰å¯èƒ½è¢«åƒåœ¾å›æ”¶ã€‚å‡å¦‚å®ƒè¿˜æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥åœ¨ç¬¬â‘¤è¡Œæ‰§è¡Œwf.get()æ–¹æ³•ä¼šè¿” å›â€helloâ€å¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶ä¸”ä½¿å¾—è¿™ä¸ªå¯¹è±¡è¢«str1å¼ºå¼•ç”¨ã€‚å†æ¥ä¸‹æ¥åœ¨ç¬¬â‘¥è¡Œæ‰§è¡Œrq.poll()æ–¹æ³•ä¼šè¿”å›nullï¼Œå› ä¸ºæ­¤æ—¶å¼•ç”¨é˜Ÿåˆ—ä¸­æ²¡æœ‰ä»» ä½•å¼•ç”¨ã€‚ReferenceQueueçš„poll()æ–¹æ³•ç”¨äºè¿”å›é˜Ÿåˆ—ä¸­çš„å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å›nullã€‚</p>
<p><img src="http://www.javathinker.org/java/ref_2.gif" alt=""><br>å›¾11-11 â€œhelloâ€å¯¹è±¡åªå…·æœ‰å¼±å¼•ç”¨</p>
<p>åœ¨ä»¥ä¸‹ç¨‹åºä»£ç ä¸­ï¼Œæ‰§è¡Œå®Œç¬¬â‘£è¡Œåï¼Œâ€helloâ€å¯¹è±¡ä»…ä»…å…·æœ‰å¼±å¼•ç”¨ã€‚æ¥ä¸‹æ¥ä¸¤æ¬¡è°ƒç”¨System.gc()æ–¹æ³•ï¼Œå‚¬ä¿ƒåƒåœ¾å›æ”¶å™¨å·¥ä½œï¼Œä»è€Œæ é«˜â€helloâ€å¯¹è±¡è¢«å›æ”¶çš„å¯èƒ½æ€§ã€‚å‡å¦‚â€helloâ€å¯¹è±¡è¢«å›æ”¶ï¼Œé‚£ä¹ˆWeakReferenceå¯¹è±¡çš„å¼•ç”¨è¢«åŠ å…¥åˆ°ReferenceQueue ä¸­ï¼Œæ¥ä¸‹æ¥wf.get()æ–¹æ³•è¿”å›nullï¼Œå¹¶ä¸”rq.poll()æ–¹æ³•è¿”å›WeakReferenceå¯¹è±¡çš„å¼•ç”¨ã€‚å›¾11-12æ˜¾ç¤ºäº†æ‰§è¡Œå®Œç¬¬â‘§è¡Œå å†…å­˜ä¸­å¼•ç”¨ä¸å¯¹è±¡çš„å…³ç³»ã€‚</p>
<p>String str = new String(â€œhelloâ€); //â‘ <br>ReferenceQueue&lt;String&gt; rq = new ReferenceQueue&lt;String&gt;(); //â‘¡<br>WeakReference&lt;String&gt; wf = new WeakReference&lt;String&gt;(str, rq); //â‘¢<br>str=null; //â‘£</p>
<p>//ä¸¤æ¬¡å‚¬ä¿ƒåƒåœ¾å›æ”¶å™¨å·¥ä½œï¼Œæé«˜â€helloâ€å¯¹è±¡è¢«å›æ”¶çš„å¯èƒ½æ€§<br>System.gc(); //â‘¤<br>System.gc(); //â‘¥<br>String str1=wf.get(); //â‘¦ å‡å¦‚â€helloâ€å¯¹è±¡è¢«å›æ”¶ï¼Œstr1ä¸ºnull<br>Reference&lt;? extends String&gt; ref=rq.poll(); //â‘§</p>
<p><img src="http://www.javathinker.org/java/ref_3.gif" alt=""><br>å›¾11-12 â€œhelloâ€å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼Œå¼±å¼•ç”¨è¢«åŠ å…¥åˆ°å¼•ç”¨é˜Ÿåˆ—</p>
<p>The important part about strong references &mdash; the part that makes them â€œstrongâ€ &mdash; is how they interact with the garbage collector. Specifically, if an object is reachable via a chain of strong references (strongly reachable), it is not eligible for garbage collection. As you don&rsquo;t want the garbage collector destroying objects you&rsquo;re working on, this is normally exactly what you want.</p>
]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
            <tag> reference </tag>
            
            <tag> StrongReference </tag>
            
            <tag> SoftReference </tag>
            
            <tag> WeakReference </tag>
            
            <tag> PhantomReference </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Javaé›†åˆæ¡†æ¶Listï¼ŒMapï¼ŒSetç­‰å…¨é¢ä»‹ç»]]></title>
      <url>/2012/04/18/Java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6List%EF%BC%8CMap%EF%BC%8CSet%E7%AD%89%E5%85%A8%E9%9D%A2%E4%BB%8B%E7%BB%8D/</url>
      <content type="html"><![CDATA[<div>Java Collections Frameworkæ˜¯Javaæä¾›çš„å¯¹é›†åˆè¿›è¡Œå®šä¹‰ï¼Œæ“ä½œï¼Œå’Œç®¡ç†çš„åŒ…å«ä¸€ç»„æ¥å£ï¼Œç±»çš„ä½“ç³»ç»“æ„ã€‚</div><br><div>&nbsp;</div><br><div>Javaé›†åˆæ¡†æ¶çš„åŸºæœ¬æ¥å£/ç±»å±‚æ¬¡ç»“æ„ï¼š</div><br><div><br>java.util.Collection [I]<br>+â€“java.util.List [I]<br>&nbsp;&nbsp; +â€“java.util.ArrayList [C]<br>&nbsp;&nbsp; +â€“java.util.LinkedList [C]<br>&nbsp;&nbsp; +â€“java.util.Vector [C]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +â€“java.util.Stack [C]<br>+â€“java.util.Set [I]<br>&nbsp;&nbsp; +â€“java.util.HashSet [C]<br>&nbsp;&nbsp; +â€“java.util.SortedSet [I]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +â€“java.util.TreeSet [C]</div><br><div><br>java.util.Map [I]<br>+â€“java.util.SortedMap [I]<br>&nbsp;&nbsp; +â€“java.util.TreeMap [C]<br>+â€“java.util.Hashtable [C]<br>+â€“java.util.HashMap [C]<br>+â€“java.util.LinkedHashMap [C]<br>+â€“java.util.WeakHashMap [C]</div><br><div>&nbsp;</div><br><div>[I]ï¼šæ¥å£</div><br><div>[C]ï¼šç±»</div><br><div>&nbsp;</div><br><div><span><strong>Collectionæ¥å£</strong></span><br>&nbsp;&nbsp; &nbsp;Collectionæ˜¯æœ€åŸºæœ¬çš„é›†åˆæ¥å£ï¼Œä¸€ä¸ªCollectionä»£è¡¨ä¸€ç»„Objectçš„é›†åˆï¼Œè¿™äº›Objectè¢«ç§°ä½œCollectionçš„å…ƒç´ ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;æ‰€æœ‰å®ç°Collectionæ¥å£çš„ç±»éƒ½å¿…é¡»æä¾›ä¸¤ä¸ªæ ‡å‡†çš„æ„é€ å‡½æ•°ï¼šæ— å‚æ•°çš„æ„é€ å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªç©ºçš„Collectionï¼Œæœ‰ä¸€ä¸ªCollectionå‚æ•°çš„æ„é€ å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„Collectionï¼Œè¿™ ä¸ªæ–°çš„Collectionä¸ä¼ å…¥çš„Collectionæœ‰ç›¸åŒçš„å…ƒç´ ã€‚åä¸€ä¸ªæ„é€ å‡½æ•°å…è®¸ç”¨æˆ·å¤åˆ¶ä¸€ä¸ªCollectionã€‚<br><div>&nbsp;&nbsp; &nbsp;å¦‚ä½•éå†Collectionä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Ÿä¸è®ºCollectionçš„å®é™…ç±»å‹å¦‚ä½•ï¼Œå®ƒéƒ½æ”¯æŒä¸€ä¸ªiterator()çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªè¿­ä»£å­ï¼Œä½¿ç”¨è¯¥è¿­ä»£å­å³å¯é€ä¸€è®¿é—®Collectionä¸­æ¯ä¸€ä¸ªå…ƒç´ ã€‚å…¸å‹çš„ç”¨æ³•å¦‚ä¸‹ï¼š</div>

<ol>
<li><span><span>Iterator&nbsp;it&nbsp;=&nbsp;collection.iterator();&nbsp;</span><span class="comment">//&nbsp;è·å¾—ä¸€ä¸ªè¿­ä»£å­</span><span>&nbsp;</span></span></li>
<li><span><span class="keyword">while</span><span>(it.hasNext())&nbsp;{&nbsp;</span></span></li>
<li><span>ã€€ã€€Object&nbsp;obj&nbsp;=&nbsp;it.next();&nbsp;<span class="comment">//&nbsp;å¾—åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ </span><span>&nbsp;</span></span></li>
<li><p><span>}&nbsp;</span></p>
<div>&nbsp;&nbsp; &nbsp;æ ¹æ®ç”¨é€”çš„ä¸åŒï¼ŒCollectionåˆåˆ’åˆ†ä¸ºListä¸Setã€‚</div><br><div>&nbsp;</div><br><div><span><strong>Listæ¥å£</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;Listç»§æ‰¿è‡ªCollectionæ¥å£ã€‚Listæ˜¯æœ‰åºçš„Collectionï¼Œä½¿ç”¨æ­¤æ¥å£èƒ½å¤Ÿç²¾ç¡®çš„æ§åˆ¶æ¯ä¸ªå…ƒç´ æ’å…¥çš„ä½ç½®ã€‚ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨ç´¢å¼•ï¼ˆå…ƒç´ åœ¨Listä¸­çš„ä½ç½®ï¼Œç±»ä¼¼äºæ•°ç»„ä¸‹æ ‡ï¼‰æ¥è®¿é—®Listä¸­çš„å…ƒç´ ï¼Œè¿™ç±»ä¼¼äºJavaçš„æ•°ç»„ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;è·ŸSeté›†åˆä¸åŒçš„æ˜¯ï¼ŒListå…è®¸æœ‰é‡å¤å…ƒç´ ã€‚å¯¹äºæ»¡è¶³e1.equals(e2)æ¡ä»¶çš„e1ä¸e2å¯¹è±¡å…ƒç´ ï¼Œå¯ä»¥åŒæ—¶å­˜åœ¨äºListé›†åˆä¸­ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰Listçš„å®ç°ç±»ä¸å…è®¸é‡å¤å…ƒç´ çš„å­˜åœ¨ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;é™¤äº†å…·æœ‰Collectionæ¥å£å¿…å¤‡çš„iterator()æ–¹æ³•å¤–ï¼ŒListè¿˜æä¾›ä¸€ä¸ªlistIterator()æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ª ListIteratoræ¥å£ï¼Œå’Œæ ‡å‡†çš„Iteratoræ¥å£ç›¸æ¯”ï¼ŒListIteratorå¤šäº†ä¸€äº›add()ä¹‹ç±»çš„æ–¹æ³•ï¼Œå…è®¸æ·»åŠ ï¼Œåˆ é™¤ï¼Œè®¾å®šå…ƒç´ ï¼Œ è¿˜èƒ½å‘å‰æˆ–å‘åéå†ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;å®ç°Listæ¥å£çš„å¸¸ç”¨ç±»æœ‰LinkedListï¼ŒArrayListï¼ŒVectorå’ŒStackã€‚</div><br><div>&nbsp;</div><br><div><span><strong>LinkedListç±»</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;LinkedListå®ç°äº†Listæ¥å£ï¼Œå…è®¸nullå…ƒç´ ã€‚æ­¤å¤–LinkedListæä¾›é¢å¤–çš„getï¼Œremoveï¼Œinsertæ–¹æ³•åœ¨ LinkedListçš„é¦–éƒ¨æˆ–å°¾éƒ¨ã€‚è¿™äº›æ“ä½œä½¿LinkedListå¯è¢«ç”¨ä½œå †æ ˆï¼ˆstackï¼‰ï¼Œé˜Ÿåˆ—ï¼ˆqueueï¼‰æˆ–åŒå‘é˜Ÿåˆ—ï¼ˆdequeï¼‰ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;æ³¨æ„LinkedListæ²¡æœ‰åŒæ­¥æ–¹æ³•ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªListï¼Œåˆ™å¿…é¡»è‡ªå·±å®ç°è®¿é—®åŒæ­¥ã€‚ä¸€ç§è§£å†³æ–¹æ³•æ˜¯åœ¨åˆ›å»ºListæ—¶æ„é€ ä¸€ä¸ªåŒæ­¥çš„Listï¼š</div>
</li>
<li><p><span><span>List&nbsp;list&nbsp;=&nbsp;Collections.synchronizedList(</span><span class="keyword">new</span><span>&nbsp;LinkedList(â€¦));&nbsp;</span></span></p>
<div>&nbsp;</div><br><div><span><strong>ArrayListç±»</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;ArrayListå®ç°äº†å¯å˜å¤§å°çš„æ•°ç»„ã€‚å®ƒå…è®¸æ‰€æœ‰å…ƒç´ ï¼ŒåŒ…æ‹¬nullã€‚ArrayListæ²¡æœ‰åŒæ­¥ã€‚</div><br><div>sizeï¼ŒisEmptyï¼Œgetï¼Œsetæ–¹æ³•è¿è¡Œæ—¶é—´ä¸ºå¸¸æ•°ã€‚ä½†æ˜¯addæ–¹æ³•å¼€é”€ä¸ºåˆ†æ‘Šçš„å¸¸æ•°ï¼Œæ·»åŠ nä¸ªå…ƒç´ éœ€è¦O(n)çš„æ—¶é—´ã€‚å…¶ä»–çš„æ–¹æ³•è¿è¡Œæ—¶é—´ä¸ºçº¿æ€§ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;æ¯ä¸ªArrayListå®ä¾‹éƒ½æœ‰ä¸€ä¸ªå®¹é‡ï¼ˆCapacityï¼‰ï¼Œå³ç”¨äºå­˜å‚¨å…ƒç´ çš„æ•°ç»„çš„å¤§å°ã€‚è¿™ä¸ªå®¹é‡å¯éšç€ä¸æ–­æ·»åŠ æ–°å…ƒç´ è€Œè‡ªåŠ¨å¢åŠ ï¼Œä½†æ˜¯å¢é•¿ç®—æ³•å¹¶ æ²¡æœ‰å®šä¹‰ã€‚å½“éœ€è¦æ’å…¥å¤§é‡å…ƒç´ æ—¶ï¼Œåœ¨æ’å…¥å‰å¯ä»¥è°ƒç”¨ensureCapacityæ–¹æ³•æ¥å¢åŠ ArrayListçš„å®¹é‡ä»¥æé«˜æ’å…¥æ•ˆç‡ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;å’ŒLinkedListä¸€æ ·ï¼ŒArrayListä¹Ÿæ˜¯éåŒæ­¥çš„ï¼ˆunsynchronizedï¼‰ã€‚</div><br><div>&nbsp;</div><br><div><span><strong>Vectorç±»</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;Vectoréå¸¸ç±»ä¼¼ArrayListï¼Œä½†æ˜¯Vectoræ˜¯åŒæ­¥çš„ã€‚ç”±Vectoråˆ›å»ºçš„Iteratorï¼Œè™½ç„¶å’ŒArrayListåˆ›å»ºçš„ Iteratoræ˜¯åŒä¸€æ¥å£ï¼Œä½†æ˜¯ï¼Œå› ä¸ºVectoræ˜¯åŒæ­¥çš„ï¼Œå½“ä¸€ä¸ªIteratorè¢«åˆ›å»ºè€Œä¸”æ­£åœ¨è¢«ä½¿ç”¨ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ”¹å˜äº†Vectorçš„çŠ¶æ€ï¼ˆä¾‹å¦‚ï¼Œæ·»åŠ æˆ–åˆ é™¤äº†ä¸€äº›å…ƒç´ ï¼‰ï¼Œè¿™æ—¶è°ƒç”¨Iteratorçš„æ–¹æ³•æ—¶å°†æŠ›å‡ºConcurrentModificationExceptionï¼Œå› æ­¤å¿…é¡»æ•è·è¯¥å¼‚å¸¸ã€‚</div><br><div>&nbsp;</div><br><div><span><strong>Stack ç±»</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;Stackç»§æ‰¿è‡ªVectorï¼Œå®ç°ä¸€ä¸ªåè¿›å…ˆå‡ºçš„å †æ ˆã€‚Stackæä¾›5ä¸ªé¢å¤–çš„æ–¹æ³•ä½¿å¾—Vectorå¾—ä»¥è¢«å½“ä½œå †æ ˆä½¿ç”¨ã€‚åŸºæœ¬çš„pushå’Œpopæ–¹ æ³•ï¼Œè¿˜æœ‰peekæ–¹æ³•å¾—åˆ°æ ˆé¡¶çš„å…ƒç´ ï¼Œemptyæ–¹æ³•æµ‹è¯•å †æ ˆæ˜¯å¦ä¸ºç©ºï¼Œsearchæ–¹æ³•æ£€æµ‹ä¸€ä¸ªå…ƒç´ åœ¨å †æ ˆä¸­çš„ä½ç½®ã€‚Stackåˆšåˆ›å»ºåæ˜¯ç©ºæ ˆã€‚</div><br><div>&nbsp;</div><br><div><span><strong>Setæ¥å£</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;Setç»§æ‰¿è‡ªCollectionæ¥å£ã€‚Setæ˜¯ä¸€ç§ä¸èƒ½åŒ…å«æœ‰é‡å¤å…ƒç´ çš„é›†åˆï¼Œå³å¯¹äºæ»¡è¶³e1.equals(e2)æ¡ä»¶çš„e1ä¸e2å¯¹è±¡å…ƒç´ ï¼Œä¸èƒ½åŒæ—¶å­˜åœ¨äºåŒä¸€ä¸ªSeté›†åˆé‡Œï¼Œæ¢å¥è¯è¯´ï¼ŒSeté›†åˆé‡Œä»»æ„ä¸¤ä¸ªå…ƒç´ e1å’Œe2éƒ½æ»¡è¶³e1.equals(e2)==falseæ¡ä»¶ï¼ŒSetæœ€å¤šæœ‰ä¸€ä¸ªnullå…ƒç´ ã€‚</div><br><div>&nbsp;&nbsp; &nbsp; å› ä¸ºSetçš„è¿™ä¸ªåˆ¶çº¦ï¼Œåœ¨ä½¿ç”¨Seté›†åˆçš„æ—¶å€™ï¼Œåº”è¯¥æ³¨æ„ï¼š</div><br><div>&nbsp;&nbsp; &nbsp;1ï¼Œä¸ºSeté›†åˆé‡Œçš„å…ƒç´ çš„å®ç°ç±»å®ç°ä¸€ä¸ªæœ‰æ•ˆçš„equals(Object)æ–¹æ³•ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;2ï¼Œå¯¹Setçš„æ„é€ å‡½æ•°ï¼Œä¼ å…¥çš„Collectionå‚æ•°ä¸èƒ½åŒ…å«é‡å¤çš„å…ƒç´ ã€‚</div><br><div>&nbsp;</div><br><div>&nbsp;&nbsp; &nbsp;è¯·æ³¨æ„ï¼šå¿…é¡»å°å¿ƒæ“ä½œå¯å˜å¯¹è±¡ï¼ˆMutable Objectï¼‰ã€‚å¦‚æœä¸€ä¸ªSetä¸­çš„å¯å˜å…ƒç´ æ”¹å˜äº†è‡ªèº«çŠ¶æ€å¯¼è‡´Object.equals(Object)=trueå°†å¯¼è‡´ä¸€äº›é—®é¢˜ã€‚</div><br><div>&nbsp;</div><br><div><span><strong>HashSetç±»</strong></span></div><br><div>&nbsp;&nbsp;&nbsp; æ­¤ç±»å®ç° Set æ¥å£ï¼Œç”±å“ˆå¸Œè¡¨ï¼ˆå®é™…ä¸Šæ˜¯ä¸€ä¸ª HashMap å®ä¾‹ï¼‰æ”¯æŒã€‚å®ƒä¸ä¿è¯é›†åˆçš„è¿­ä»£é¡ºåºï¼›ç‰¹åˆ«æ˜¯å®ƒä¸ä¿è¯è¯¥é¡ºåºæ’ä¹…ä¸å˜ã€‚æ­¤ç±»å…è®¸ä½¿ç”¨ null å…ƒç´ ã€‚</div><br><div>&nbsp;&nbsp;&nbsp; HashSetä¸æ˜¯åŒæ­¥çš„ï¼Œéœ€è¦ç”¨ä»¥ä¸‹è¯­å¥æ¥è¿›è¡ŒSåŒæ­¥è½¬æ¢ï¼š<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;Set s = Collections.synchronizedSet(new HashSet(â€¦));<br>&nbsp;</div><br><div><span><strong>Mapæ¥å£</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;Mapæ²¡æœ‰ç»§æ‰¿Collectionæ¥å£ã€‚ä¹Ÿå°±æ˜¯è¯´Mapå’ŒCollectionæ˜¯2ç§ä¸åŒçš„é›†åˆã€‚Collectionå¯ä»¥çœ‹ä½œæ˜¯ï¼ˆvalueï¼‰çš„é›†åˆï¼Œè€ŒMapå¯ä»¥çœ‹ä½œæ˜¯ï¼ˆkeyï¼Œvalueï¼‰çš„é›†åˆã€‚</div><br><div>&nbsp;&nbsp; &nbsp;Mapæ¥å£ç”±Mapçš„å†…å®¹æä¾›3ç§ç±»å‹çš„é›†åˆè§†å›¾ï¼Œä¸€ç»„keyé›†åˆï¼Œä¸€ç»„valueé›†åˆï¼Œæˆ–è€…ä¸€ç»„key-valueæ˜ å°„å…³ç³»çš„é›†åˆã€‚</div><br><div>&nbsp;</div><br><div><span><strong>Hashtableç±»</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;Hashtableç»§æ‰¿Mapæ¥å£ï¼Œå®ç°ä¸€ä¸ªkey-valueæ˜ å°„çš„å“ˆå¸Œè¡¨ã€‚ä»»ä½•éç©ºï¼ˆnon-nullï¼‰çš„å¯¹è±¡éƒ½å¯ä½œä¸ºkeyæˆ–è€…valueã€‚</div><br><div>&nbsp;&nbsp; &nbsp;æ·»åŠ æ•°æ®ä½¿ç”¨put(key, value)ï¼Œå–å‡ºæ•°æ®ä½¿ç”¨get(key)ï¼Œè¿™ä¸¤ä¸ªåŸºæœ¬æ“ä½œçš„æ—¶é—´å¼€é”€ä¸ºå¸¸æ•°ã€‚</div><br><div>Hashtable é€šè¿‡initial capacityå’Œload factorä¸¤ä¸ªå‚æ•°è°ƒæ•´æ€§èƒ½ã€‚é€šå¸¸ç¼ºçœçš„load factor 0.75è¾ƒå¥½åœ°å®ç°äº†æ—¶é—´å’Œç©ºé—´çš„å‡è¡¡ã€‚å¢å¤§load factorå¯ä»¥èŠ‚çœç©ºé—´ä½†ç›¸åº”çš„æŸ¥æ‰¾æ—¶é—´å°†å¢å¤§ï¼Œè¿™ä¼šå½±å“åƒgetå’Œputè¿™æ ·çš„æ“ä½œã€‚</div><br><div>ä½¿ç”¨Hashtableçš„ç®€å•ç¤ºä¾‹å¦‚ä¸‹ï¼Œå°†1ï¼Œ2ï¼Œ3æ”¾åˆ°Hashtableä¸­ï¼Œä»–ä»¬çš„keyåˆ†åˆ«æ˜¯&rdquo;one&rdquo;ï¼Œ&rdquo;two&rdquo;ï¼Œ&rdquo;three&rdquo;ï¼š</div>
</li>
<li><p><span><span>Hashtable&nbsp;numbers&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;Hashtable();&nbsp;</span></span></p>
</li>
<li><span>numbers.put(â€œoneâ€,&nbsp;<span class="keyword">new</span><span>&nbsp;Integer(</span><span class="number">1</span><span>));&nbsp;</span></span></li>
<li><span>numbers.put(â€œtwoâ€,&nbsp;<span class="keyword">new</span><span>&nbsp;Integer(</span><span class="number">2</span><span>));&nbsp;</span></span></li>
<li><p><span>numbers.put(â€œthreeâ€,&nbsp;<span class="keyword">new</span><span>&nbsp;Integer(</span><span class="number">3</span><span>));&nbsp;</span></span></p>
<div>è¦å–å‡ºä¸€ä¸ªæ•°ï¼Œæ¯”å¦‚2ï¼Œç”¨ç›¸åº”çš„keyï¼š</div>
</li>
<li><p><span><span>Integer&nbsp;n&nbsp;=&nbsp;(Integer)numbers.get(</span><span class="string">â€œtwoâ€</span><span>);&nbsp;</span></span></p>
</li>
<li><span>System.out.println(<span class="string">â€œtwo&nbsp;=â€</span><span>&nbsp;+&nbsp;n);&nbsp;</span></span></li></ol></div><div>&nbsp;&nbsp; &nbsp;ç”±äºä½œä¸ºkeyçš„å¯¹è±¡å°†é€šè¿‡è®¡ç®—å…¶æ•£åˆ—å‡½æ•°æ¥ç¡®å®šä¸ä¹‹å¯¹åº”çš„valueçš„ä½ç½®ï¼Œå› æ­¤ä»»ä½•ä½œä¸ºkeyçš„å¯¹è±¡éƒ½å¿…é¡»å®ç°hashCodeå’Œequalsæ–¹ æ³•ã€‚hashCodeå’Œequalsæ–¹æ³•ç»§æ‰¿è‡ªæ ¹ç±»Objectï¼Œå¦‚æœä½ ç”¨è‡ªå®šä¹‰çš„ç±»å½“ä½œkeyçš„è¯ï¼Œè¦ç›¸å½“å°å¿ƒï¼ŒæŒ‰ç…§æ•£åˆ—å‡½æ•°çš„å®šä¹‰ï¼Œå¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ åŒï¼Œå³obj1.equals(obj2)=trueï¼Œåˆ™å®ƒä»¬çš„hashCodeå¿…é¡»ç›¸åŒï¼Œä½†å¦‚æœä¸¤ä¸ªå¯¹è±¡ä¸åŒï¼Œåˆ™å®ƒä»¬çš„hashCodeä¸ä¸€å®šä¸åŒï¼Œå¦‚ æœä¸¤ä¸ªä¸åŒå¯¹è±¡çš„hashCodeç›¸åŒï¼Œè¿™ç§ç°è±¡ç§°ä¸ºå†²çªï¼Œå†²çªä¼šå¯¼è‡´æ“ä½œå“ˆå¸Œè¡¨çš„æ—¶é—´å¼€é”€å¢å¤§ï¼Œæ‰€ä»¥å°½é‡å®šä¹‰å¥½çš„hashCode()æ–¹æ³•ï¼Œèƒ½åŠ å¿«å“ˆå¸Œ è¡¨çš„æ“ä½œã€‚</div><br><div>&nbsp;&nbsp; &nbsp;å¦‚æœç›¸åŒçš„å¯¹è±¡æœ‰ä¸åŒçš„hashCodeï¼Œå¯¹å“ˆå¸Œè¡¨çš„æ“ä½œä¼šå‡ºç°æ„æƒ³ä¸åˆ°çš„ç»“æœï¼ˆæœŸå¾…çš„getæ–¹æ³•è¿”å›nullï¼‰ï¼Œè¦é¿å…è¿™ç§é—®é¢˜ï¼Œåªéœ€è¦ç‰¢è®°ä¸€æ¡ï¼šè¦åŒæ—¶å¤å†™equalsæ–¹æ³•å’ŒhashCodeæ–¹æ³•ï¼Œè€Œä¸è¦åªå†™å…¶ä¸­ä¸€ä¸ªã€‚</div><br><div>&nbsp;&nbsp; &nbsp;Hashtableæ˜¯åŒæ­¥çš„ã€‚</div><br><div>&nbsp;</div><br><div><span><strong>HashMapç±»</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;HashMapå’ŒHashtableç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºHashMapæ˜¯éåŒæ­¥çš„ï¼Œå¹¶ä¸”å…è®¸nullï¼Œå³null valueå’Œnull keyã€‚ï¼Œä½†æ˜¯å°†HashMapè§†ä¸ºCollectionæ—¶ï¼ˆvalues()æ–¹æ³•å¯è¿”å›Collectionï¼‰ï¼Œå…¶è¿­ä»£å­æ“ä½œæ—¶é—´å¼€é”€å’ŒHashMap çš„å®¹é‡æˆæ¯”ä¾‹ã€‚å› æ­¤ï¼Œå¦‚æœè¿­ä»£æ“ä½œçš„æ€§èƒ½ç›¸å½“é‡è¦çš„è¯ï¼Œä¸è¦å°†HashMapçš„åˆå§‹åŒ–å®¹é‡è®¾å¾—è¿‡é«˜ï¼Œæˆ–è€…load factorè¿‡ä½ã€‚</div><br><div>&nbsp;</div><br><div><span><strong>WeakHashMapç±»</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;WeakHashMapæ˜¯ä¸€ç§æ”¹è¿›çš„HashMapï¼Œå®ƒå¯¹keyå®è¡Œ&ldquo;å¼±å¼•ç”¨&rdquo;ï¼Œå¦‚æœä¸€ä¸ªkeyä¸å†è¢«å¤–éƒ¨æ‰€å¼•ç”¨ï¼Œé‚£ä¹ˆè¯¥keyå¯ä»¥è¢«GCå›æ”¶ã€‚</div><br><div>&nbsp;</div><br><div><span><strong>å¯¹é›†åˆæ“ä½œçš„å·¥å…·ç±»</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;Javaæä¾›äº†java.util.Collectionsï¼Œä»¥åŠjava.util.Arraysç±»ç®€åŒ–å¯¹é›†åˆçš„æ“ä½œ<br><div>&nbsp;&nbsp; &nbsp;java.util.Collectionsä¸»è¦æä¾›ä¸€äº›staticæ–¹æ³•ç”¨æ¥æ“ä½œæˆ–åˆ›å»ºCollectionï¼ŒMapç­‰é›†åˆã€‚</div><br>&nbsp;&nbsp; &nbsp;java.util.Arraysä¸»è¦æä¾›staticæ–¹æ³•å¯¹æ•°ç»„è¿›è¡Œæ“ä½œã€‚ã€‚</div><br><div>&nbsp;</div><br><div><span><strong>æ€»ç»“</strong></span></div><br><div>&nbsp;&nbsp; &nbsp;å¦‚æœæ¶‰åŠåˆ°å †æ ˆï¼Œé˜Ÿåˆ—ç­‰æ“ä½œï¼Œåº”è¯¥è€ƒè™‘ç”¨Listï¼Œå¯¹äºéœ€è¦å¿«é€Ÿæ’å…¥ï¼Œåˆ é™¤å…ƒç´ ï¼Œåº”è¯¥ä½¿ç”¨LinkedListï¼Œå¦‚æœéœ€è¦å¿«é€Ÿéšæœºè®¿é—®å…ƒç´ ï¼Œåº”è¯¥ä½¿ç”¨ArrayListã€‚</div><br><div>&nbsp;&nbsp; &nbsp;å¦‚æœç¨‹åºåœ¨å•çº¿ç¨‹ç¯å¢ƒä¸­ï¼Œæˆ–è€…è®¿é—®ä»…ä»…åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è¿›è¡Œï¼Œè€ƒè™‘éåŒæ­¥çš„ç±»ï¼Œå…¶æ•ˆç‡è¾ƒé«˜ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹å¯èƒ½åŒæ—¶æ“ä½œä¸€ä¸ªç±»ï¼Œåº”è¯¥ä½¿ç”¨åŒæ­¥çš„ç±»ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;åœ¨é™¤éœ€è¦æ’åºæ—¶ä½¿ç”¨TreeSet,TreeMapå¤–,éƒ½åº”ä½¿ç”¨HashSet,HashMap,å› ä¸ºä»–ä»¬ çš„æ•ˆç‡æ›´é«˜ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;è¦ç‰¹åˆ«æ³¨æ„å¯¹å“ˆå¸Œè¡¨çš„æ“ä½œï¼Œä½œä¸ºkeyçš„å¯¹è±¡è¦æ­£ç¡®å¤å†™equalså’ŒhashCodeæ–¹æ³•ã€‚</div><br><div>&nbsp;</div><br><div>&nbsp;&nbsp; &nbsp;å®¹å™¨ç±»ä»…èƒ½æŒæœ‰å¯¹è±¡å¼•ç”¨ï¼ˆæŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆï¼‰ï¼Œè€Œä¸æ˜¯å°†å¯¹è±¡ä¿¡æ¯copyä¸€ä»½è‡³æ•°åˆ—æŸä½ç½®ã€‚ä¸€æ—¦å°†å¯¹è±¡ç½®å…¥å®¹å™¨å†…ï¼Œä¾¿æŸå¤±äº†è¯¥å¯¹è±¡çš„å‹åˆ«ä¿¡æ¯ã€‚</div><br><div>&nbsp;&nbsp; &nbsp;å°½é‡è¿”å›æ¥å£è€Œéå®é™…çš„ç±»å‹ï¼Œå¦‚è¿”å›Listè€ŒéArrayListï¼Œè¿™æ ·å¦‚æœä»¥åéœ€è¦å°†ArrayListæ¢æˆLinkedListæ—¶ï¼Œå®¢æˆ·ç«¯ä»£ç ä¸ç”¨æ”¹å˜ã€‚è¿™å°±æ˜¯é’ˆå¯¹æŠ½è±¡ç¼–ç¨‹ã€‚</div><br><div>&nbsp;</div><br><div><strong><span>æ³¨æ„ï¼š</span></strong></div><br><div>1ã€Collectionæ²¡æœ‰get()æ–¹æ³•æ¥å–å¾—æŸä¸ªå…ƒç´ ã€‚åªèƒ½é€šè¿‡iterator()éå†å…ƒç´ ã€‚</div><br><div>2ã€Setå’ŒCollectionæ‹¥æœ‰ä¸€æ¨¡ä¸€æ ·çš„æ¥å£ã€‚</div><br><div>3ã€Listï¼Œå¯ä»¥é€šè¿‡get()æ–¹æ³•æ¥ä¸€æ¬¡å–å‡ºä¸€ä¸ªå…ƒç´ ã€‚ä½¿ç”¨æ•°å­—æ¥é€‰æ‹©ä¸€å †å¯¹è±¡ä¸­çš„ä¸€ä¸ªï¼Œget(0)â€¦ã€‚(add/get)</div><br><div>4ã€ä¸€èˆ¬ä½¿ç”¨ArrayListã€‚ç”¨LinkedListæ„é€ å †æ ˆstackã€é˜Ÿåˆ—queueã€‚</div><br><div>5ã€Mapç”¨ put(k,v) / get(k)ï¼Œè¿˜å¯ä»¥ä½¿ç”¨containsKey()/containsValue()æ¥æ£€æŸ¥å…¶ä¸­æ˜¯å¦å«æœ‰æŸä¸ªkey/valueã€‚</div><br><div>&nbsp;&nbsp; &nbsp; &nbsp;HashMapä¼šåˆ©ç”¨å¯¹è±¡çš„hashCodeæ¥å¿«é€Ÿæ‰¾åˆ°keyã€‚</div><br><div>&nbsp;</div><br><div><br><div>6ã€Mapä¸­å…ƒç´ ï¼Œå¯ä»¥å°†keyåºåˆ—ã€valueåºåˆ—å•ç‹¬æŠ½å–å‡ºæ¥ã€‚</div><br><div>ä½¿ç”¨keySet()æŠ½å–keyåºåˆ—ï¼Œå°†mapä¸­çš„æ‰€æœ‰keysç”Ÿæˆä¸€ä¸ªSetã€‚</div><br><div>ä½¿ç”¨values()æŠ½å–valueåºåˆ—ï¼Œå°†mapä¸­çš„æ‰€æœ‰valuesç”Ÿæˆä¸€ä¸ªCollectionã€‚</div><br><div>ä¸ºä»€ä¹ˆä¸€ä¸ªç”ŸæˆSetï¼Œä¸€ä¸ªç”ŸæˆCollectionï¼Ÿé‚£æ˜¯å› ä¸ºï¼Œkeyæ€»æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œvalueå…è®¸é‡å¤ã€‚</div><br><div>&nbsp;</div><br><div>â€”â€”â€”â€”â€”â€”â€”â€”</div><br><div>æœ¬æ–‡ç»“åˆäº†å‡ ç¯‡ç½‘ä¸Šæ–‡ç« å¹¶æ‘˜å½•è€Œæˆçš„ï¼š</div><br><div>1.&nbsp;<a href="http://jonsion.javaeye.com/blog/421993" target="_blank" rel="noopener">Java Collections Framework - Javaé›†åˆæ¡†æ¶List,Map,Setç­‰å…¨é¢ä»‹ç»</a></div><br><div>2.&nbsp;<a href="http://blog.csdn.net/Fitzwilliam/archive/2006/02/10/596384.aspx" target="_blank" rel="noopener">ç»†è¯´Javaä¹‹utilç±»</a></div><br><div>3.&nbsp;<a href="http://billy-lee.javaeye.com/blog/356398" target="_blank" rel="noopener">JavaåŸºæœ¬æ¦‚å¿µï¼šé›†åˆç±» List/Set/Mapâ€¦ çš„åŒºåˆ«å’Œè”ç³»</a></div><br></div>



]]></content>
      
        
        <tags>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[androidå±è”½è¿”å›é”®å’Œhomeé”®]]></title>
      <url>/2012/03/08/android%E5%B1%8F%E8%94%BD%E8%BF%94%E5%9B%9E%E9%94%AE%E5%92%8Chome%E9%94%AE/</url>
      <content type="html"><![CDATA[<div class="dp-highlighter"><br><br>1.  å±è”½è¿”å›é”®çš„ä»£ç :<br>public boolean onKeyDown(int keyCode,KeyEvent event){<br>switch(keyCode){<br>case KeyEvent.KEYCODE_HOME:return true;<br>case KeyEvent.KEYCODE_BACK:return true;<br>case KeyEvent.KEYCODE_CALL:return true;<br>case KeyEvent.KEYCODE_SYM: return true;<br>case KeyEvent.KEYCODE_VOLUME_DOWN: return true;<br>case KeyEvent.KEYCODE_VOLUME_UP: return true;<br>case KeyEvent.KEYCODE_STAR: return true;<br>}<br>return super.onKeyDown(keyCode, event);<br>}<br><br>å±è”½homeé”®çš„ä»£ç :<br>public void onAttachedToWindow() {<br>this.getWindow().setType(WindowManager.LayoutParams.TYPE_KEYGUARD);<br>super.onAttachedToWindow();<br>}</div>

]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> key </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidçš„å•ä½åŠå±å¹•åˆ†è¾¨ç‡]]></title>
      <url>/2012/03/08/Android%E7%9A%84%E5%8D%95%E4%BD%8D%E5%8F%8A%E5%B1%8F%E5%B9%95%E5%88%86%E8%BE%A8%E7%8E%87/</url>
      <content type="html"><![CDATA[<p>ä¸€ã€å¸¸ç”¨çš„å•ä½ï¼šç›¸å¯¹å•ä½ä¸»è¦æœ‰ï¼špxã€spã€dp</p>
<p>ç»å¯¹å•ä½ä¸»è¦æœ‰ï¼šptã€inã€mm</p>
<p>äºŒã€å•ä½åº”ç”¨æ€»ç»“ï¼šä¸€èˆ¬ç”¨ç›¸å¯¹å•ä½ï¼Œè€Œä¸æ˜¯ç»å¯¹å•ä½</p>
<p>1ã€å­—ä½“çš„å¤§å°ä¸€èˆ¬ä½¿ç”¨SPï¼Œç”¨æ­¤å•ä½çš„å­—ä½“èƒ½å¤Ÿæ ¹æ®ç”¨æˆ·è®¾ç½®å­—ä½“çš„å¤§å°è€Œè‡ªåŠ¨ç¼©æ”¾</p>
<p>2ã€ç©ºé—´ç­‰ç›¸å¯¹è·ç¦»ä¸€èˆ¬ä½¿ç”¨dpï¼ˆdipï¼‰,éšç€å¯†åº¦å˜åŒ–ï¼Œå¯¹åº”çš„åƒç´ æ•°é‡ä¹Ÿå˜åŒ–ï¼Œä½†å¹¶æ²¡æœ‰ç›´æ¥çš„ç›¸å¯¹æ¯”ä¾‹çš„å˜åŒ–ã€‚</p>
<p>3ã€pxä¸å®é™…åƒç´ æœ‰å…³ï¼ŒåŠä¸å¯†åº¦æœ‰å…³ï¼dpå’Œspå’Œå®é™…åƒç´ æ²¡æœ‰å…³ç³»ï¼Œå¯¹äºä¸€å®šåˆ†è¾¨ç‡ä½†ä¸åŒå¯†åº¦çš„å±å¹•ï¼Œpxå•ä½çš„åº”ç”¨å¯èƒ½ä¼šå¯¼è‡´é•¿åº¦çš„ç›¸å¯¹æ¯”ä¾‹çš„å˜åŒ–ã€‚</p>
<p>ä¸‰ã€å¯†åº¦ä¸åˆ†è¾¨ç‡ï¼š</p>
<p>å¯†åº¦å€¼è¡¨ç¤ºæ¯è‹±å¯¸æœ‰å¤šå°‘ä¸ªæ˜¾ç¤ºç‚¹ï¼Œä¸åˆ†è¾¨ç‡æ˜¯ä¸¤ä¸ªæ¦‚å¿µã€‚</p>
<p>å…¶å±å¹•å¯†åº¦æ ‡å‡†æ˜¯ï¼šHVGAå±density=160ï¼›QVGAå±density=120ï¼›WVGAå±density=240ï¼›WQVGAå±density=120</p>
<p>å…·ä½“çš„åº”ç”¨è¿ç®—å…³ç³»ï¼šå‡è®¾åˆ†è¾¨ç‡æ˜¯ x<em>yï¼Œ å¯†åº¦ä¸º dï¼Œ å±å¹•å®é™…å¤§å°ä¸º a</em>bé‚£ä¹ˆå…³ç³»ä¸º x<em>y = d </em> a * b (çº¦ç­‰äº)</p>
<p>ä¸åŒdensityä¸‹å±å¹•åˆ†è¾¨ç‡ä¿¡æ¯ï¼Œä»¥480dip<em>800dipçš„ WVGA(density=240)ä¸ºä¾‹density=120æ—¶ å±å¹•å®é™…åˆ†è¾¨ç‡ä¸º240px</em>400px ï¼ˆä¸¤ä¸ªç‚¹å¯¹åº”ä¸€ä¸ªåˆ†è¾¨ç‡ï¼‰</p>
<p>å››ã€å¯¹æ¯”æ€»ç»“ï¼š</p>
<p>1ã€åœ¨ç›¸åŒå¯†åº¦ï¼ˆå³åŒä¸€å®ä½“å±å¹•ï¼‰ä¸åŒåˆ†è¾¨ç‡çš„æƒ…å†µä¸‹ï¼Œä¸å®ä½“å¯†åº¦æ— å…³çš„ç›¸å¯¹å•ä½spå’Œdpæ˜¾ç¤ºæ­£å¸¸</p>
<p>2ã€åœ¨ç›¸åŒåˆ†è¾¨ç‡ä¸åŒå¯†åº¦çš„æƒ…å†µä¸‹ï¼Œå› ä¸ºä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéƒ½ç”¨çš„æ ‡å‡†å¯†åº¦ï¼Œæ‰€ä»¥åˆ†æçš„æ„ä¹‰ä¸æ˜¯å¾ˆå¤§</p>
<p><strong>å…¶ä»–èµ„æ–™ï¼š</strong><br>pxï¼šæ˜¯å±å¹•çš„åƒç´ ç‚¹<br>inï¼šè‹±å¯¸<br>mmï¼šæ¯«ç±³<br>ptï¼šç£…ï¼Œ1/72 è‹±å¯¸<br>dpï¼šä¸€ä¸ªåŸºäºdensityçš„æŠ½è±¡å•ä½ï¼Œå¦‚æœä¸€ä¸ª160dpiçš„å±å¹•ï¼Œ1dp=1px<br>dipï¼šç­‰åŒäºdp<br>spï¼šåŒdpç›¸ä¼¼ï¼Œä½†è¿˜ä¼šæ ¹æ®ç”¨æˆ·çš„å­—ä½“å¤§å°åå¥½æ¥ç¼©æ”¾ã€‚<br>å»ºè®®ä½¿ç”¨spä½œä¸ºæ–‡æœ¬çš„å•ä½ï¼Œå…¶å®ƒç”¨dip<br>é’ˆå¯¹dipå’Œpx çš„å…³ç³»ï¼Œåšä»¥ä¸‹æ¦‚è¿°ï¼š<br>HVGAå±density=160ï¼›QVGAå±density=120ï¼›WVGAå±density=240ï¼›WQVGAå±density=120<br>densityå€¼è¡¨ç¤ºæ¯è‹±å¯¸æœ‰å¤šå°‘ä¸ªæ˜¾ç¤ºç‚¹ï¼Œä¸åˆ†è¾¨ç‡æ˜¯ä¸¤ä¸ªæ¦‚å¿µã€‚<br>ä¸åŒdensityä¸‹å±å¹•åˆ†è¾¨ç‡ä¿¡æ¯ï¼Œä»¥480dip*800dipçš„ WVGA(density=240)ä¸ºä¾‹</p>
<p>density=120æ—¶ å±å¹•å®é™…åˆ†è¾¨ç‡ä¸º240px*400px ï¼ˆä¸¤ä¸ªç‚¹å¯¹åº”ä¸€ä¸ªåˆ†è¾¨ç‡ï¼‰<br>çŠ¶æ€æ å’Œæ ‡é¢˜æ é«˜å„19pxæˆ–è€…25dip<br>æ¨ªå±æ˜¯å±å¹•å®½åº¦400px æˆ–è€…800dip,å·¥ä½œåŒºåŸŸé«˜åº¦211pxæˆ–è€…480dip<br>ç«–å±æ—¶å±å¹•å®½åº¦240pxæˆ–è€…480dip,å·¥ä½œåŒºåŸŸé«˜åº¦381pxæˆ–è€…775dip</p>
<p>density=160æ—¶ å±å¹•å®é™…åˆ†è¾¨ç‡ä¸º320px*533px ï¼ˆ3ä¸ªç‚¹å¯¹åº”ä¸¤ä¸ªåˆ†è¾¨ç‡ï¼‰<br>çŠ¶æ€æ å’Œæ ‡é¢˜æ é«˜ä¸ª25pxæˆ–è€…25dip<br>æ¨ªå±æ˜¯å±å¹•å®½åº¦533px æˆ–è€…800dip,å·¥ä½œåŒºåŸŸé«˜åº¦295pxæˆ–è€…480dip<br>ç«–å±æ—¶å±å¹•å®½åº¦320pxæˆ–è€…480dip,å·¥ä½œåŒºåŸŸé«˜åº¦508pxæˆ–è€…775dip</p>
<p>density=240æ—¶ å±å¹•å®é™…åˆ†è¾¨ç‡ä¸º480px*800px ï¼ˆä¸€ä¸ªç‚¹å¯¹äºä¸€ä¸ªåˆ†è¾¨ç‡ï¼‰<br>çŠ¶æ€æ å’Œæ ‡é¢˜æ é«˜ä¸ª38pxæˆ–è€…25dip<br>æ¨ªå±æ˜¯å±å¹•å®½åº¦800px æˆ–è€…800dip,å·¥ä½œåŒºåŸŸé«˜åº¦442pxæˆ–è€…480dip<br>ç«–å±æ—¶å±å¹•å®½åº¦480pxæˆ–è€…480dip,å·¥ä½œåŒºåŸŸé«˜åº¦762pxæˆ–è€…775dip</p>
<p>apkçš„èµ„æºåŒ…ä¸­ï¼Œå½“å±å¹•density=240æ—¶ä½¿ç”¨hdpi æ ‡ç­¾çš„èµ„æº<br>å½“å±å¹•density=160æ—¶ï¼Œä½¿ç”¨mdpiæ ‡ç­¾çš„èµ„æº<br>å½“å±å¹•density=120æ—¶ï¼Œä½¿ç”¨ldpiæ ‡ç­¾çš„èµ„æºã€‚<br>ä¸åŠ ä»»ä½•æ ‡ç­¾çš„èµ„æºæ˜¯å„ç§åˆ†è¾¨ç‡æƒ…å†µä¸‹å…±ç”¨çš„ã€‚<br>å¸ƒå±€æ—¶å°½é‡ä½¿ç”¨å•ä½dipï¼Œå°‘ä½¿ç”¨px</p>
<p>&nbsp;</p>
<p>ä¸‹é¢æ˜¯å‡ ç§ä¸åŒå•ä½çš„ç›¸äº’è½¬æ¢.</p>
<p>public&nbsp;static&nbsp;int&nbsp;dip2px(Context context, float dipValue){<br>final float scale&nbsp;=&nbsp;context.getResources().getDisplayMetrics().density;<br>return (int)(dipValue&nbsp;<em>&nbsp;scale&nbsp;+&nbsp;0.5f);<br>}<br>public&nbsp;static&nbsp;int&nbsp;px2dip(Context context, float pxValue){<br>final float scale&nbsp;=&nbsp;context.getResource().getDisplayMetrics().density;<br>return (int)(pxValue&nbsp;/&nbsp;scale&nbsp;+&nbsp;0.5f);<br>}<br>public&nbsp;static&nbsp;int&nbsp;dip2px(Context context, float dipValue){<br>final float scale&nbsp;=&nbsp;context.getResources().getDisplayMetrics().density;<br>return (int)(dipValue&nbsp;</em>&nbsp;scale&nbsp;+&nbsp;0.5f);<br>}<br>public&nbsp;static&nbsp;int&nbsp;px2dip(Context context, float pxValue){<br>final float scale&nbsp;=&nbsp;context.getResource().getDisplayMetrics().density;<br>return (int)(pxValue&nbsp;/&nbsp;scale&nbsp;+&nbsp;0.5f);<br>}</p>
<p>ä¸‹é¢è¯´ä¸‹å¦‚ä½•è·å–åˆ†è¾¨ç‡:</p>
<p>åœ¨ä¸€ä¸ªActivityçš„onCreateæ–¹æ³•ä¸­ï¼Œå†™å…¥å¦‚ä¸‹ä»£ç ï¼š<br>DisplayMetrics metric = new DisplayMetrics();<br>getWindowManager().getDefaultDisplay().getMetrics(metric);<br>int width = metric.widthPixels;&nbsp;&nbsp;// å±å¹•å®½åº¦ï¼ˆåƒç´ ï¼‰<br>int height = metric.heightPixels;&nbsp;&nbsp;// å±å¹•é«˜åº¦ï¼ˆåƒç´ ï¼‰<br>float density&nbsp;= metric.density;&nbsp;&nbsp;// å±å¹•å¯†åº¦ï¼ˆ0.75 / 1.0 / 1.5ï¼‰<br>int densityDpi = metric.densityDpi;&nbsp;&nbsp;// å±å¹•å¯†åº¦DPIï¼ˆ120 / 160 / 240ï¼‰<br>è¿™è¿˜æ˜¯æŒºç®€å•çš„, å¯æ˜¯ä½ æœ‰æ²¡æœ‰åœ¨800*480çš„æœºå™¨ä¸Šè¯•è¿‡, æ˜¯ä¸æ˜¯å¾—åˆ°çš„å®½åº¦æ˜¯533 ? å› ä¸ºandroidåˆšå¼€å§‹æ—¶é»˜è®¤çš„densityæ˜¯1.0 , æ­¤æ—¶ä½ å¯ä»¥å†manifest.xmlä¸­åŠ å…¥</p>
<p>1.uses-sdkèŠ‚ç‚¹,&nbsp;&lt;uses-sdk android:minSdkVersion=â€4â€ /&gt; , è¡¨ç¤ºä¸sdk1.6ä»¥ä¸‹çš„æœºå™¨ä¸èƒ½å®‰è£…ä½ çš„apkäº†.</p>
<p>2.supports-screens èŠ‚ç‚¹.</p>
<p>&lt;supports-screens<br>android:smallScreens=â€trueâ€<br>android:normalScreens=â€trueâ€<br>android:largeScreens=â€trueâ€<br>android:resizeable=â€trueâ€<br>android:anyDensity=â€trueâ€ /&gt;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> UI </tag>
            
            <tag> tips </tag>
            
            <tag> unit </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidè¯»å–ç”¨æˆ·å·ç ï¼Œæ‰‹æœºä¸²å·ï¼ŒSIMå¡åºåˆ—å·]]></title>
      <url>/2012/03/08/Android%E8%AF%BB%E5%8F%96%E7%94%A8%E6%88%B7%E5%8F%B7%E7%A0%81%EF%BC%8C%E6%89%8B%E6%9C%BA%E4%B8%B2%E5%8F%B7%EF%BC%8CSIM%E5%8D%A1%E5%BA%8F%E5%88%97%E5%8F%B7/</url>
      <content type="html"><![CDATA[<p>1ã€ä½¿ç”¨TelephonyManageræä¾›çš„æ–¹æ³•ï¼Œæ ¸å¿ƒä»£ç :</p>
<p>TelephonyManager tm = (TelephonyManager) this.getSystemService(TELEPHONY_SERVICE);<br>String imei = tm.getDeviceId();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //å–å‡ºIMEI<br>Log.d(TAG, â€œIMEI:â€+imei);<br>String tel = tm.getLine1Number();&nbsp;&nbsp;&nbsp;&nbsp; //å–å‡ºMSISDNï¼Œå¾ˆå¯èƒ½ä¸ºç©º<br>Log.d(TAG, â€œMSISDN:â€+tel);<br>String iccid =tm.getSimSerialNumber();&nbsp; //å–å‡ºICCID<br>Log.d(TAG, â€œICCID:â€+iccid);<br>String imsi =tm.getSubscriberId();&nbsp;&nbsp;&nbsp;&nbsp; //å–å‡ºIMSI<br>Log.d(TAG, â€œIMSI:â€+imsi);</p>
<p>2ã€åŠ å…¥æƒé™</p>
<p>åœ¨manifest.xmlæ–‡ä»¶ä¸­è¦æ·»åŠ  &lt;uses-permission android:name=â€android.permission.READ_PHONE_STATEâ€ /&gt;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> phone number </tag>
            
            <tag> SIM </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidé€€å‡ºç¨‹åºçš„è‹¥å¹²æ–¹æ³•]]></title>
      <url>/2012/03/08/Android%E9%80%80%E5%87%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E8%8B%A5%E5%B9%B2%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>Androidç¨‹åºæœ‰å¾ˆå¤šActivityï¼Œæ¯”å¦‚è¯´ä¸»çª—å£Aï¼Œè°ƒç”¨äº†å­çª—å£Bï¼Œå¦‚æœåœ¨Bä¸­ç›´æ¥finish(), æ¥ä¸‹é‡Œæ˜¾ç¤ºçš„æ˜¯Aã€‚åœ¨Bä¸­å¦‚ä½•å…³é—­æ•´ä¸ªAndroidåº”ç”¨ç¨‹åºå‘¢?æœ¬äººæ€»ç»“äº†å‡ ç§æ¯”è¾ƒç®€å•çš„å®ç°æ–¹æ³•ã€‚</p>
<p>1. Dalvik VMçš„æœ¬åœ°æ–¹æ³•</p>
<p>android.os.Process.killProcess(android.os.Process.myPid()) //è·å–PID</p>
<p>System.exit(0); //å¸¸è§„javaã€c#çš„æ ‡å‡†é€€å‡ºæ³•ï¼Œè¿”å›å€¼ä¸º0ä»£è¡¨æ­£å¸¸é€€å‡º</p>
<p>2. ä»»åŠ¡ç®¡ç†å™¨æ–¹æ³•</p>
<p>é¦–å…ˆè¦è¯´æ˜è¯¥æ–¹æ³•è¿è¡Œåœ¨Android 1.5 API Levelä¸º3ä»¥ä¸Šæ‰å¯ä»¥ï¼ŒåŒæ—¶éœ€è¦æƒé™</p>
<p>ActivityManager am = (ActivityManager)getSystemService (Context.ACTIVITY_SERVICE);</p>
<p>am.restartPackage(getPackageName());</p>
<p>ç³»ç»Ÿä¼šå°†ï¼Œè¯¥åŒ…ä¸‹çš„ ï¼Œæ‰€æœ‰è¿›ç¨‹ï¼ŒæœåŠ¡ï¼Œå…¨éƒ¨æ€æ‰ï¼Œå°±å¯ä»¥æ€å¹²å‡€äº†ï¼Œè¦æ³¨æ„åŠ ä¸Šæƒé™ android.permission.RESTART_PACKAGES</p>
<p>3. æ ¹æ®Activityçš„å£°æ˜å‘¨æœŸ</p>
<p>3. æˆ‘ä»¬çŸ¥é“Androidçš„çª—å£ç±»æä¾›äº†å†å²æ ˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡stackçš„åŸç†æ¥å·§å¦™çš„å®ç°ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨Açª—å£æ‰“å¼€Bçª—å£æ—¶åœ¨Intentä¸­ç›´æ¥åŠ å…¥æ ‡å¿— Intent.FLAG_ACTIVITY_CLEAR_TOPï¼Œè¿™æ ·å¼€å¯Bæ—¶å°†ä¼šæ¸…é™¤è¯¥è¿›ç¨‹ç©ºé—´çš„æ‰€æœ‰Activityã€‚</p>
<p>åœ¨Açª—å£ä¸­ä½¿ç”¨ä¸‹é¢çš„ä»£ç è°ƒç”¨Bçª—å£</p>
<p>Intent intent = new Intent();</p>
<p>intent.setClass(Android123.this, CWJ.class);</p>
<p>intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); //æ³¨æ„æœ¬è¡Œçš„FLAGè®¾ç½®</p>
<p>startActivity(intent);</p>
<p>æ¥ä¸‹æ¥åœ¨Bçª—å£ä¸­éœ€è¦é€€å‡ºæ—¶ç›´æ¥ä½¿ç”¨finishæ–¹æ³•å³å¯å…¨éƒ¨é€€å‡ºã€‚</p>
<p>4.è‡ªå®šä¹‰ä¸€ä¸ªActiivty æ ˆï¼Œé“ç†åŒä¸Šï¼Œä¸è¿‡åˆ©ç”¨ä¸€ä¸ªå•ä¾‹æ¨¡å¼çš„Activityæ ˆæ¥ç®¡ç†æ‰€æœ‰Activityã€‚å¹¶æä¾›é€€å‡ºæ‰€æœ‰Activityçš„æ–¹æ³•ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<p>public class ScreenManager {</p>
<p>private static Stack activityStack;</p>
<p>private static ScreenManager instance;</p>
<p>private ScreenManager(){</p>
<p>}</p>
<p>public static ScreenManager getScreenManager(){</p>
<p>instance=new ScreenManager();</p>
<p>}</p>
<p>return instance;</p>
<p>}</p>
<p>//é€€å‡ºæ ˆé¡¶Activity</p>
<p>public void popActivity(Activity activity){</p>
<p>activity.finish();</p>
<p>activityStack.remove(activity);</p>
<p>activity=null;</p>
<p>}</p>
<p>}</p>
<p>//è·å¾—å½“å‰æ ˆé¡¶Activity</p>
<p>public Activity currentActivity(){</p>
<p>Activity activity=activityStack.lastElement();</p>
<p>return activity;</p>
<p>}</p>
<p>//å°†å½“å‰Activityæ¨å…¥æ ˆä¸­</p>
<p>public void pushActivity(Activity activity){</p>
<p>activityStack=new Stack();</p>
<p>}</p>
<p>activityStack.add(activity);</p>
<p>}</p>
<p>//é€€å‡ºæ ˆä¸­æ‰€æœ‰Activity</p>
<p>public void popAllActivityExceptOne(Class cls){</p>
<p>while(true){</p>
<p>Activity activity=currentActivity();</p>
<p>break;</p>
<p>}</p>
<p>break;</p>
<p>}</p>
<p>popActivity(activity);</p>
<p>}</p>
<p>}</p>
<p>}</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> exit </tag>
            
            <tag> kill </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Activityä¸Serviceä¹‹é—´äº¤äº’å¹¶æ’­æ”¾æ­Œæ›²]]></title>
      <url>/2012/03/07/Activity%E4%B8%8EService%E4%B9%8B%E9%97%B4%E4%BA%A4%E4%BA%92%E5%B9%B6%E6%92%AD%E6%94%BE%E6%AD%8C%E6%9B%B2/</url>
      <content type="html"><![CDATA[<p>Activityä¸Serviceä¹‹é—´äº¤äº’å¹¶æ’­æ”¾æ­Œæ›²ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘æŠŠè¦æ’­æ”¾çš„æ­Œæ›²å®šæ­»äº†ï¼Œå¤§å®¶å¯ä»¥çµæ´»æ”¹è¿›<br>&nbsp;</p>
<p><img src="http://pic002.cnblogs.com/images/2012/378300/2012030714015935.jpg" alt=""></p>
<p>MServiceï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('ab9dded1-5f97-48dc-8388-a9ca9960b61c')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_ab9dded1-5f97-48dc-8388-a9ca9960b61c" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span> com.tiantian.test;<br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span> android.app.Service;<br><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span> android.content.Intent;<br><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span> android.media.MediaPlayer;<br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span> android.os.Binder;<br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span> android.os.Environment;<br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span> android.os.IBinder;<br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span> android.util.Log;<br><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MService <span style="color: #0000ff;">extends</span> Service{<br><span style="color: #008080;">12</span>     MyBinder myBinder = <span style="color: #0000ff;">new</span> MyBinder();<br><span style="color: #008080;">13</span>     <span style="color: #0000ff;">private</span> MediaPlayer mediaPlayer;<br><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MyBinder <span style="color: #0000ff;">extends</span> Binder{<br><span style="color: #008080;">16</span>         MService getService(){<br><span style="color: #008080;">17</span>             <span style="color: #0000ff;">return</span> MService.<span style="color: #0000ff;">this</span>;<br><span style="color: #008080;">18</span>         }<br><span style="color: #008080;">19</span>     }<br><span style="color: #008080;">20</span>     @Override<br><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span> IBinder onBind(Intent intent) {<br><span style="color: #008080;">22</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">23</span>         Log.v(â€œCATâ€, â€œonBindâ€);<br><span style="color: #008080;">24</span>         <span style="color: #0000ff;">return</span> myBinder;<br><span style="color: #008080;">25</span>     }<br><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span>     @Override<br><span style="color: #008080;">28</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCreate() {<br><span style="color: #008080;">29</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">30</span>         <span style="color: #0000ff;">super</span>.onCreate();<br><span style="color: #008080;">31</span>         Log.v(â€œCATâ€, â€œonCreateâ€);<br><span style="color: #008080;">32</span>         <span style="color: #0000ff;">try</span> {<br><span style="color: #008080;">33</span>             mediaPlayer = <span style="color: #0000ff;">new</span> MediaPlayer();<br><span style="color: #008080;">34</span>             mediaPlayer.setDataSource(Environment.getExternalStorageDirectory() + â€œ/mp3/trhxn.mp3â€);<br><span style="color: #008080;">35</span>             mediaPlayer.prepare();<br><span style="color: #008080;">36</span>         } <span style="color: #0000ff;">catch</span> (Exception e) {<br><span style="color: #008080;">37</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated catch block</span><span style="color: #008000;"><br></span><span style="color: #008080;">38</span>             Log.v(â€œCATâ€, â€œfailâ€);<br><span style="color: #008080;">39</span>             e.printStackTrace();<br><span style="color: #008080;">40</span>         }<br><span style="color: #008080;">41</span>     }<br><span style="color: #008080;">42</span><br><span style="color: #008080;">43</span>     @Override<br><span style="color: #008080;">44</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onDestroy() {<br><span style="color: #008080;">45</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">46</span>         <span style="color: #0000ff;">super</span>.onDestroy();<br><span style="color: #008080;">47</span>         Log.v(â€œCATâ€, â€œonDestroyâ€);<br><span style="color: #008080;">48</span>     }<br><span style="color: #008080;">49</span><br><span style="color: #008080;">50</span>     @Override<br><span style="color: #008080;">51</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> onStartCommand(Intent intent, <span style="color: #0000ff;">int</span> flags, <span style="color: #0000ff;">int</span> startId) {<br><span style="color: #008080;">52</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">53</span>         Log.v(â€œCATâ€, â€œonStartCommandâ€);<br><span style="color: #008080;">54</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">super</span>.onStartCommand(intent, flags, startId);<br><span style="color: #008080;">55</span>     }<br><span style="color: #008080;">56</span><br><span style="color: #008080;">57</span>     @Override<br><span style="color: #008080;">58</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span> onUnbind(Intent intent) {<br><span style="color: #008080;">59</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">60</span>         Log.v(â€œCATâ€, â€œonUnbindâ€);<br><span style="color: #008080;">61</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;<br><span style="color: #008080;">62</span>     }<br><span style="color: #008080;">63</span><br><span style="color: #008080;">64</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> start(){<br><span style="color: #008080;">65</span>         mediaPlayer.start();<br><span style="color: #008080;">66</span>     }<br><span style="color: #008080;">67</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> pause(){<br><span style="color: #008080;">68</span>         mediaPlayer.pause();<br><span style="color: #008080;">69</span>     }<br><span style="color: #008080;">70</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> stop(){<br><span style="color: #008080;">71</span>         mediaPlayer.stop();<br><span style="color: #008080;">72</span>         mediaPlayer.release();<br><span style="color: #008080;">73</span>     }<br><span style="color: #008080;">74</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> getDuration(){<br><span style="color: #008080;">75</span>         <span style="color: #0000ff;">return</span> mediaPlayer.getDuration();<br><span style="color: #008080;">76</span>     }<br><span style="color: #008080;">77</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> getCurrentPosition(){<br><span style="color: #008080;">78</span>         <span style="color: #0000ff;">return</span> mediaPlayer.getCurrentPosition();<br><span style="color: #008080;">79</span>     }<br><span style="color: #008080;">80</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> seekTo(<span style="color: #0000ff;">int</span> position){<br><span style="color: #008080;">81</span>         mediaPlayer.seekTo(position);<br><span style="color: #008080;">82</span>     }<br><span style="color: #008080;">83</span> }</pre><br></div><br></div>

<p>MusicPlayActivityï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('d0b7bbe9-af89-4993-8d87-e320ceb1ece0')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_d0b7bbe9-af89-4993-8d87-e320ceb1ece0" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span> com.tiantian.test;<br><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span> android.app.Activity;<br><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span> android.content.ComponentName;<br><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span> android.content.Intent;<br><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span> android.content.ServiceConnection;<br><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span> android.os.Bundle;<br><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span> android.os.Handler;<br><span style="color: #008080;">  9</span> <span style="color: #0000ff;">import</span> android.os.IBinder;<br><span style="color: #008080;"> 10</span> <span style="color: #0000ff;">import</span> android.util.Log;<br><span style="color: #008080;"> 11</span> <span style="color: #0000ff;">import</span> android.view.View;<br><span style="color: #008080;"> 12</span> <span style="color: #0000ff;">import</span> android.view.View.OnClickListener;<br><span style="color: #008080;"> 13</span> <span style="color: #0000ff;">import</span> android.widget.Button;<br><span style="color: #008080;"> 14</span> <span style="color: #0000ff;">import</span> android.widget.SeekBar;<br><span style="color: #008080;"> 15</span><br><span style="color: #008080;"> 16</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MusicPlayActivity <span style="color: #0000ff;">extends</span> Activity {<br><span style="color: #008080;"> 17</span>     <span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> Called when the activity is first created. </span><span style="color: #008000;">/</span><br><span style="color: #008080;"> 18</span>     MService mService;<br><span style="color: #008080;"> 19</span>     <span style="color: #0000ff;">private</span> ServiceConnection conn = <span style="color: #0000ff;">new</span> ServiceConnection(){<br><span style="color: #008080;"> 20</span><br><span style="color: #008080;"> 21</span>         @Override<br><span style="color: #008080;"> 22</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onServiceConnected(ComponentName arg0, IBinder arg1) {<br><span style="color: #008080;"> 23</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 24</span>             mService = ((MService.MyBinder)arg1).getService();<br><span style="color: #008080;"> 25</span>             Log.v(â€œCATâ€, â€œgetServicedâ€);<br><span style="color: #008080;"> 26</span>         }<br><span style="color: #008080;"> 27</span><br><span style="color: #008080;"> 28</span>         @Override<br><span style="color: #008080;"> 29</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onServiceDisconnected(ComponentName name) {<br><span style="color: #008080;"> 30</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 31</span>             mService = <span style="color: #0000ff;">null</span>;<br><span style="color: #008080;"> 32</span>         }<br><span style="color: #008080;"> 33</span><br><span style="color: #008080;"> 34</span>     };<br><span style="color: #008080;"> 35</span><br><span style="color: #008080;"> 36</span>     <span style="color: #0000ff;">private</span> SeekBar seekBar;<br><span style="color: #008080;"> 37</span>     <span style="color: #0000ff;">private</span> Button playBT;<br><span style="color: #008080;"> 38</span><br><span style="color: #008080;"> 39</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isPlaying = <span style="color: #0000ff;">false</span>;<br><span style="color: #008080;"> 40</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isBinded = <span style="color: #0000ff;">false</span>;<br><span style="color: #008080;"> 41</span><br><span style="color: #008080;"> 42</span>     <span style="color: #0000ff;">private</span> Handler mHandler;<br><span style="color: #008080;"> 43</span>     @Override<br><span style="color: #008080;"> 44</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCreate(Bundle savedInstanceState) {<br><span style="color: #008080;"> 45</span>         <span style="color: #0000ff;">super</span>.onCreate(savedInstanceState);<br><span style="color: #008080;"> 46</span>         setContentView(R.layout.main);<br><span style="color: #008080;"> 47</span>         Intent intent = <span style="color: #0000ff;">new</span> Intent(MusicPlayActivity.<span style="color: #0000ff;">this</span>, MService.<span style="color: #0000ff;">class</span>);<br><span style="color: #008080;"> 48</span>         <span style="color: #0000ff;">if</span>(!isBinded){<br><span style="color: #008080;"> 49</span>             bindService(intent, conn, BIND_AUTO_CREATE);<br><span style="color: #008080;"> 50</span>             isBinded = <span style="color: #0000ff;">true</span>;<br><span style="color: #008080;"> 51</span>         }<br><span style="color: #008080;"> 52</span>         seekBar = (SeekBar) findViewById(R.id.seekBar);<br><span style="color: #008080;"> 53</span>         playBT = (Button) findViewById(R.id.startBT);<br><span style="color: #008080;"> 54</span>         mHandler = <span style="color: #0000ff;">new</span> Handler();<br><span style="color: #008080;"> 55</span>         seekBar.setOnSeekBarChangeListener(<span style="color: #0000ff;">new</span> SeekBar.OnSeekBarChangeListener() {<br><span style="color: #008080;"> 56</span><br><span style="color: #008080;"> 57</span>             @Override<br><span style="color: #008080;"> 58</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onStopTrackingTouch(SeekBar seekBar) {}<br><span style="color: #008080;"> 59</span><br><span style="color: #008080;"> 60</span>             @Override<br><span style="color: #008080;"> 61</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onStartTrackingTouch(SeekBar seekBar) {}<br><span style="color: #008080;"> 62</span><br><span style="color: #008080;"> 63</span>             @Override<br><span style="color: #008080;"> 64</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onProgressChanged(SeekBar seekBar, <span style="color: #0000ff;">int</span> progress,<br><span style="color: #008080;"> 65</span>                     <span style="color: #0000ff;">boolean</span> fromUser) {<br><span style="color: #008080;"> 66</span>                 <span style="color: #0000ff;">if</span>(fromUser){<br><span style="color: #008080;"> 67</span>                     mService.seekTo((progress<em>mService.getDuration())/100);<br><span style="color: #008080;"> 68</span>                 }<br><span style="color: #008080;"> 69</span>             }<br><span style="color: #008080;"> 70</span>         });<br><span style="color: #008080;"> 71</span>         playBT.setOnClickListener(<span style="color: #0000ff;">new</span> OnClickListener() {<br><span style="color: #008080;"> 72</span><br><span style="color: #008080;"> 73</span>             @Override<br><span style="color: #008080;"> 74</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onClick(View v) {<br><span style="color: #008080;"> 75</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 76</span>                 <span style="color: #0000ff;">if</span>(!isPlaying){<br><span style="color: #008080;"> 77</span>                     mService.start();<br><span style="color: #008080;"> 78</span>                     isPlaying = <span style="color: #0000ff;">true</span>;<br><span style="color: #008080;"> 79</span>                     playBT.setText(â€œæš‚åœâ€);<br><span style="color: #008080;"> 80</span>                     mHandler.post(seekBarThread);<br><span style="color: #008080;"> 81</span>                 }<span style="color: #0000ff;">else</span>{<br><span style="color: #008080;"> 82</span>                     mService.pause();<br><span style="color: #008080;"> 83</span>                     isPlaying = <span style="color: #0000ff;">false</span>;<br><span style="color: #008080;"> 84</span>                     playBT.setText(â€œæ’­æ”¾â€);<br><span style="color: #008080;"> 85</span>                     mHandler.removeCallbacks(seekBarThread);<br><span style="color: #008080;"> 86</span>                 }<br><span style="color: #008080;"> 87</span>             }<br><span style="color: #008080;"> 88</span>         });<br><span style="color: #008080;"> 89</span><br><span style="color: #008080;"> 90</span>     }<br><span style="color: #008080;"> 91</span><br><span style="color: #008080;"> 92</span>     Runnable seekBarThread = <span style="color: #0000ff;">new</span> Runnable() {<br><span style="color: #008080;"> 93</span><br><span style="color: #008080;"> 94</span>         @Override<br><span style="color: #008080;"> 95</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> run() {<br><span style="color: #008080;"> 96</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 97</span>             seekBar.setProgress((mService.getCurrentPosition()</em>100)/mService.getDuration());<br><span style="color: #008080;"> 98</span>             mHandler.postDelayed(seekBarThread, 200);<br><span style="color: #008080;"> 99</span>         }<br><span style="color: #008080;">100</span>     };<br><span style="color: #008080;">101</span><br><span style="color: #008080;">102</span> }</pre><br></div><br></div>

<p>&nbsp;</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> activity </tag>
            
            <tag> service </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidåº”ç”¨ç­¾åè¯¦è§£ Eclipse+ADT]]></title>
      <url>/2012/03/03/Android%E5%BA%94%E7%94%A8%E7%AD%BE%E5%90%8D%E8%AF%A6%E8%A7%A3-Eclipse-ADT/</url>
      <content type="html"><![CDATA[<p>å¾ˆå¤šå¼€è¾Ÿäººå‘˜ä¸ç†Ÿæ‚‰æ‰“å¬apkæ–‡ä»¶ä¸ºä»€ä¹ˆå¿…é¡»ç­¾åæ‰å¹²å…¬å¸ƒï¼Œå…¶å®ç­¾åå¹¶éä»androidå¹³å°å¼€ç«¯ï¼Œåœ¨ç•´æ˜”ä»symbian oså°±å¼€ç«¯é¡»è¦ç­¾åæ‰å¹²å…¬å¸ƒï¼Œå¦‚è®¸å¯ä»¥åŒ…ç®¡æ¯ä¸ªåº”ç”¨æ³•åº¦å¼€è¾Ÿå•†åˆæ³•idï¼Œå› ä¸ºandroidå¹³å°æ²¡æœ‰uid3çš„é™åˆ¶ï¼Œé¡¹ç›®ç»„å¼€æ”¾å•†å¯èƒ½ç»ç”±è¿‡ç¨‹åº”ç”¨é›·åŒçš„package nameæ¥æ··åˆè°ƒæ¢å·²ç»å®‰è£…çš„æ³•åº¦ã€‚ä¸è¿‡ä»Šæœæ–—åŠ²å¥½çš„æ˜¯androidä¸­æ‰€æœ‰çš„permissionåº”ç”¨éƒ½æ˜¯å…è´¹çš„ï¼Œä½†ä»ä»Šæœgité¡¹ç›®ä¸­å‘ˆç°çš„certinstaller.gitåŒ…ä¸çŸ¥é“æ˜¯ä¸æ˜¯å’Œè¯ä¹¦æœ‰å…³ï¼Œè€Œè¿‘å‡ å¹´symbian osä»v9.0å¼€ç«¯è‹¥æ˜¯åº”ç”¨æ³•åº¦æ¶‰åŠæ•æ„Ÿæ“çºµé¡»è¦capabilityæ‰å¹²ä½¿å…¶çœŸæœºé¡ºåˆ©å®‰è£…ï¼ŒåŒæ—¶é¡¹ç›®ç»„é«˜ç­‰æƒé™é¡»è¦è´­ä¹°å’Œsymbian signedæµ‹è¯•æ‰å¹²å…¬å¸ƒï¼ŒåŒ…ç®¡ä½“ç³»çš„å®‰ç„¶é å¾—ä½æ€§ï¼Œè€Œè¿™ç‚¹androidå¹³å°è¾ƒä¸ºå®½æ¾ã€‚å¸¸è§„æ™¯è±¡ä¸‹ä»adbæ¯”å¦‚eclipseçš„adtæ’ä»¶å®‰è£…åˆ°æ¨¡ä»¿å™¨æˆ–çœŸæœºçš„æµ‹è¯•æ³•åº¦ç»è¿‡debugæ ‡è¯†è¡¨è®°æ ‡å¸œç­¾åï¼Œæ‰€ä»¥æˆ‘ä»¬ç­¾åæ˜¯éƒ½é¡»è¦å…ˆåˆ›å»ºkeyå…¬é’¥ç»ç”±è¿‡ç¨‹rsaè¿ç®—æ‰å®ç°åŠ å¯†ã€‚ä¸‹é¢å…·ä½“ç”³æ˜ï¼š</p>
<p>&nbsp;</p>
<p><strong>ä¸€ã€ä¸ºä»€ä¹ˆè¦ç­¾åï¼š</strong>&nbsp;</p>
<p>&nbsp;</p>
<p>1ã€å‘é€è€…çš„èº«ä»½è®¤è¯ï¼Œå› ä¸ºå¼€è¾Ÿå•†å¯èƒ½ç»ç”±è¿‡ç¨‹åº”ç”¨é›·åŒçš„Package Nameæ¥æ··åˆè°ƒæ¢å·²ç»å®‰è£…çš„æ³•åº¦ï¼Œä»¥æ­¤åŒ…ç®¡ç­¾åä¸åˆçš„åŒ…ä¸è¢«è°ƒæ¢<br>2ã€åŒ…ç®¡ä¿¡æ¯ä¼ è¾“çš„å®Œå…¨æ€§ï¼Œç­¾åå¯¹äºåŒ…ä¸­çš„æ¯ä¸ªæ–‡ä»¶è¿›è¡Œå¤„ç†æƒ©ç½šï¼Œä»¥æ­¤ç¡®ä¿åŒ…ä¸­å†…å®¹ä¸è¢«è°ƒæ¢ï¼Œé˜²æ­¢äº¤æ˜“ä¸­çš„ç‹¡èµ–äº§ç”Ÿï¼ŒMarketå¯¹è½¯ä»¶çš„è¯·æ±‚</p>
<p>&nbsp;</p>
<p><strong>äºŒã€ç­¾åçš„ç”³æ˜ï¼š</strong><br>1ã€æ‰€æœ‰çš„åº”ç”¨æ³•åº¦éƒ½å¿…é¡»ç¨€æœ‰å­—è¯ä¹¦ï¼ŒAndroidä½“ç³»ä¸ä¼šå®‰è£…ä¸€ä¸ªæ²¡ç¨€æœ‰å­—è¯ä¹¦çš„åº”ç”¨æ³•åº¦<br>2ã€Androidæ³•åº¦åŒ…åº”ç”¨çš„æ•°å­—è¯ä¹¦å¯æ‰€ä»¥è‡ªç­¾åçš„ï¼Œä¸é¡»è¦ä¸€ä¸ªæƒåŠ¿å·¨å­çš„æ•°å­—è¯ä¹¦æœºæ„ç­¾åè®¤è¯<br>3ã€è‹¥æ˜¯è¦æ­£å¼å…¬å¸ƒä¸€ä¸ªAndroidåº”ç”¨ï¼Œå¿…é¡»åº”ç”¨ä¸€ä¸ªåˆé€‚çš„ç§é’¥ç”Ÿæˆçš„æ•°å­—è¯ä¹¦æ¥ç»™æ³•åº¦ç­¾åï¼Œè€Œä¸å…‹ä¸åŠåº”ç”¨adtæ’ä»¶æˆ–è€…antå¯¹è±¡ç”Ÿæˆçš„è°ƒè¯•è¯ä¹¦æ¥å…¬å¸ƒ<br>4ã€&nbsp;æ•°å­—è¯ä¹¦éƒ½æ˜¯æœ‰æœ‰æ•ˆæœŸçš„ï¼ŒAndroidåªæ˜¯åœ¨åº”ç”¨æ³•åº¦å®‰è£…çš„æ—¶è¾°æ‰ä¼šæœæ£€è¯ä¹¦çš„æœ‰æ•ˆæœŸã€‚è‹¥æ˜¯æ³•åº¦å·²ç»å®‰è£…åœ¨ä½“ç³»ä¸­ï¼Œå³ä½¿è¯ä¹¦è¿‡æœŸä¹Ÿä¸ä¼šå½±å“æ³•åº¦çš„æ­£å¸¸åŠŸèƒ½<br>5ã€ç­¾ååéœ€åº”ç”¨zipalignä¼˜åŒ–æ³•åº¦<br>6ã€Androidå°†æ•°å­—è¯ä¹¦ç”¨æ¥æ ‡è¯†åº”ç”¨æ³•åº¦çš„ä½œè€…å’Œåœ¨åº”ç”¨æ³•åº¦ä¹‹é—´å»ºæ ‘ä¿¡èµ–å…³ç³»ï¼Œè€Œä¸æ˜¯ç”¨æ¥å†³æ„ç»ˆæç”¨æˆ·å¯ä»¥å®‰è£…å“ªäº›åº”ç”¨æ³•åº¦</p>
<p><strong>1.Eclipseå·¥ç¨‹ä¸­å³é”®å·¥ç¨‹ï¼Œå¼¹å‡ºé€‰é¡¹ä¸­é€‰æ‹© androidå¯¹è±¡-ç”Ÿæˆç­¾ååº”ç”¨åŒ…ï¼š</strong>&nbsp;</p>
<p><img src="http://pic-server2.byywee.com/M0/S580/580495-0.jpg" alt="">&nbsp;</p>
<p><strong>2.é€‰æ‹©é¡»è¦æ‰“åŒ…çš„androidé¡¹ç›®å·¥ç¨‹ï¼š</strong>&nbsp;</p>
<p><img src="http://pic-server2.byywee.com/M0/S580/580495-1.jpg" alt="">&nbsp;</p>
<p><strong>3.è‹¥æ˜¯å·²æœ‰ç§é’¥æ–‡ä»¶ï¼Œé€‰æ‹©ç§é’¥æ–‡ä»¶ è¾“å…¥æš—ç ï¼Œè‹¥æ˜¯æ²¡æœ‰ç§é’¥æ–‡ä»¶è§ ç¬¬6å’Œ7æ­¥åˆ›å»ºç§é’¥æ–‡ä»¶ï¼š</strong>&nbsp;</p>
<p><img src="http://pic-server2.byywee.com/M0/S580/580495-2.jpg" alt="">&nbsp;</p>
<p><strong>4.è¾“å…¥ç§é’¥åˆ«å·å’Œæš—ç ï¼š</strong>&nbsp;</p>
<p><img src="http://pic-server2.byywee.com/M0/S580/580495-3.jpg" alt="">&nbsp;</p>
<p><strong>5.é€‰æ‹©APKå­˜å‚¨çš„åœ°ä½ï¼Œå¹¶å®Œæˆè®¾ç½® å¼€ç«¯ç”Ÿæˆï¼š</strong>&nbsp;</p>
<p><img src="http://pic-server2.byywee.com/M0/S580/580495-4.jpg" alt="">&nbsp;</p>
<p><strong>6.æ²¡æœ‰ç§é’¥æ–‡ä»¶çš„æ™¯è±¡ï¼Œåˆ›å»ºç§é’¥æ–‡ä»¶ï¼š</strong>&nbsp;</p>
<p><img src="http://pic-server2.byywee.com/M0/S580/580495-5.jpg" alt="">&nbsp;</p>
<p><strong>7.è¾“å…¥ç§é’¥æ–‡ä»¶æ‰€éœ€ä¿¡æ¯ï¼Œå¹¶åˆ›å»ºï¼š</strong>&nbsp;</p>
<p><img src="http://pic-server2.byywee.com/M0/S580/580495-6.jpg" alt=""></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> apk </tag>
            
            <tag> signature </tag>
            
            <tag> eclipse </tag>
            
            <tag> ADT </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidè¯»å†™æ–‡ä»¶æ±‡æ€»]]></title>
      <url>/2012/03/03/Android%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6%E6%B1%87%E6%80%BB/</url>
      <content type="html"><![CDATA[<h3 id="ä¸€ã€-ä»resourceä¸­çš„rawæ–‡ä»¶å¤¹ä¸­è·å–æ–‡ä»¶å¹¶è¯»å–æ•°æ®ï¼ˆèµ„æºæ–‡ä»¶åªèƒ½è¯»ä¸èƒ½å†™ï¼‰"><a href="#ä¸€ã€-ä»resourceä¸­çš„rawæ–‡ä»¶å¤¹ä¸­è·å–æ–‡ä»¶å¹¶è¯»å–æ•°æ®ï¼ˆèµ„æºæ–‡ä»¶åªèƒ½è¯»ä¸èƒ½å†™ï¼‰" class="headerlink" title="ä¸€ã€ ä»resourceä¸­çš„rawæ–‡ä»¶å¤¹ä¸­è·å–æ–‡ä»¶å¹¶è¯»å–æ•°æ®ï¼ˆèµ„æºæ–‡ä»¶åªèƒ½è¯»ä¸èƒ½å†™ï¼‰"></a>ä¸€ã€ ä»resourceä¸­çš„rawæ–‡ä»¶å¤¹ä¸­è·å–æ–‡ä»¶å¹¶è¯»å–æ•°æ®ï¼ˆèµ„æºæ–‡ä»¶åªèƒ½è¯»ä¸èƒ½å†™ï¼‰</h3><div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> String res = â€œâ€;<br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">try</span>{<br><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span> InputStream in = getResources().openRawResource(R.raw.bbi);<br><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span> <span style="color: #008000;">//</span><span style="color: #008000;">åœ¨\Test\res\raw\bbi.txt,</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">int</span> length = in.available();<br><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">byte</span> [] buffer = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">byte</span>[length];<br><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> in.read(buffer);<br><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> <span style="color: #008000;">//</span><span style="color: #008000;">res = EncodingUtils.getString(buffer, â€œUTF-8â€);<br></span><span style="color: #008080;">16</span> <span style="color: #008000;"><br></span><span style="color: #008080;">17</span> <span style="color: #008000;">//</span><span style="color: #008000;">res = EncodingUtils.getString(buffer, â€œUNICODEâ€);</span><span style="color: #008000;"><br></span><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span> res = EncodingUtils.getString(buffer, â€œBIG5â€);<br><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> <span style="color: #008000;">//</span><span style="color: #008000;">ä¾bbi.txtçš„ç¼–ç ç±»å‹é€‰æ‹©åˆé€‚çš„ç¼–ç ï¼Œå¦‚æœä¸è°ƒæ•´ä¼šä¹±ç </span><span style="color: #008000;"><br></span><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> in.close();<br><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span> }<span style="color: #0000ff;">catch</span>(Exception e){<br><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span> e.printStackTrace();<br><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span> }</pre><br></div>

<p><span>myTextView.setText(res);//æŠŠå¾—åˆ°çš„å†…å®¹æ˜¾ç¤ºåœ¨TextViewä¸Š</span></p>
<p>&nbsp;</p>
<h3 id="äºŒã€-ä»assetä¸­è·å–æ–‡ä»¶å¹¶è¯»å–æ•°æ®ï¼ˆèµ„æºæ–‡ä»¶åªèƒ½è¯»ä¸èƒ½å†™ï¼‰"><a href="#äºŒã€-ä»assetä¸­è·å–æ–‡ä»¶å¹¶è¯»å–æ•°æ®ï¼ˆèµ„æºæ–‡ä»¶åªèƒ½è¯»ä¸èƒ½å†™ï¼‰" class="headerlink" title="äºŒã€ ä»assetä¸­è·å–æ–‡ä»¶å¹¶è¯»å–æ•°æ®ï¼ˆèµ„æºæ–‡ä»¶åªèƒ½è¯»ä¸èƒ½å†™ï¼‰"></a>äºŒã€ ä»assetä¸­è·å–æ–‡ä»¶å¹¶è¯»å–æ•°æ®ï¼ˆèµ„æºæ–‡ä»¶åªèƒ½è¯»ä¸èƒ½å†™ï¼‰</h3><div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> String fileName = â€œyan.txtâ€; <span style="color: #008000;">//</span><span style="color: #008000;">æ–‡ä»¶åå­—</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> String res=â€â€;<br><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">try</span>{<br><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span> InputStream in = getResources().getAssets().open(fileName);<br><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span> <span style="color: #008000;">//</span><span style="color: #008000;"> \Test\assets\yan.txtè¿™é‡Œæœ‰è¿™æ ·çš„æ–‡ä»¶å­˜åœ¨</span><span style="color: #008000;"><br></span><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">int</span> length = in.available();<br><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> <span style="color: #0000ff;">byte</span> [] buffer = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">byte</span>[length];<br><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> in.read(buffer);<br><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span> res = EncodingUtils.getString(buffer, â€œUTF-8â€);<br><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span> }<span style="color: #0000ff;">catch</span>(Exception e){<br><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> e.printStackTrace();<br><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> }</pre><br></div>

<h3 id="ä¸‰ã€-ä»sdcardä¸­å»è¯»æ–‡ä»¶ï¼Œé¦–å…ˆè¦æŠŠæ–‡ä»¶é€šè¿‡-android-sdk-windows-tools-adb-exeæŠŠæœ¬åœ°è®¡ç®—æœºä¸Šçš„æ–‡ä»¶copyåˆ°sdcardä¸Šå»ï¼Œadb-exe-push-e-Y-txt-sdcard-ä¸å¯ä»¥ç”¨adb-exe-push-e-Y-txt-sdcard-åŒæ ·ï¼š-æŠŠä»¿çœŸå™¨ä¸Šçš„æ–‡ä»¶copyåˆ°æœ¬åœ°è®¡ç®—æœºä¸Šç”¨ï¼š-adb-pull-data-data-com-tt-files-Test-txt-e"><a href="#ä¸‰ã€-ä»sdcardä¸­å»è¯»æ–‡ä»¶ï¼Œé¦–å…ˆè¦æŠŠæ–‡ä»¶é€šè¿‡-android-sdk-windows-tools-adb-exeæŠŠæœ¬åœ°è®¡ç®—æœºä¸Šçš„æ–‡ä»¶copyåˆ°sdcardä¸Šå»ï¼Œadb-exe-push-e-Y-txt-sdcard-ä¸å¯ä»¥ç”¨adb-exe-push-e-Y-txt-sdcard-åŒæ ·ï¼š-æŠŠä»¿çœŸå™¨ä¸Šçš„æ–‡ä»¶copyåˆ°æœ¬åœ°è®¡ç®—æœºä¸Šç”¨ï¼š-adb-pull-data-data-com-tt-files-Test-txt-e" class="headerlink" title="ä¸‰ã€ ä»sdcardä¸­å»è¯»æ–‡ä»¶ï¼Œé¦–å…ˆè¦æŠŠæ–‡ä»¶é€šè¿‡\android-sdk-windows\tools\adb.exeæŠŠæœ¬åœ°è®¡ç®—æœºä¸Šçš„æ–‡ä»¶copyåˆ°sdcardä¸Šå»ï¼Œadb.exe push e:/Y.txt /sdcard/, ä¸å¯ä»¥ç”¨adb.exe push e:\Y.txt \sdcard\ åŒæ ·ï¼š æŠŠä»¿çœŸå™¨ä¸Šçš„æ–‡ä»¶copyåˆ°æœ¬åœ°è®¡ç®—æœºä¸Šç”¨ï¼š adb pull ./data/data/com.tt/files/Test.txt e:/"></a>ä¸‰ã€ ä»sdcardä¸­å»è¯»æ–‡ä»¶ï¼Œé¦–å…ˆè¦æŠŠæ–‡ä»¶é€šè¿‡\android-sdk-windows\tools\adb.exeæŠŠæœ¬åœ°è®¡ç®—æœºä¸Šçš„æ–‡ä»¶copyåˆ°sdcardä¸Šå»ï¼Œadb.exe push e:/Y.txt /sdcard/, ä¸å¯ä»¥ç”¨adb.exe push e:\Y.txt \sdcard\ åŒæ ·ï¼š æŠŠä»¿çœŸå™¨ä¸Šçš„æ–‡ä»¶copyåˆ°æœ¬åœ°è®¡ç®—æœºä¸Šç”¨ï¼š adb pull ./data/data/com.tt/files/Test.txt e:/</h3><div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> String fileName = â€œ/sdcard/Y.txtâ€;<br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #008000;">//</span><span style="color: #008000;">ä¹Ÿå¯ä»¥ç”¨String fileName = â€œmnt/sdcard/Y.txtâ€;</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span> String res=â€â€;<br><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">try</span>{<br><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span> FileInputStream fin = <span style="color: #0000ff;">new</span> FileInputStream(fileName);<br><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> <span style="color: #008000;">//</span><span style="color: #008000;">FileInputStream fin = openFileInput(fileName);<br></span><span style="color: #008080;">12</span> <span style="color: #008000;"><br></span><span style="color: #008080;">13</span> <span style="color: #008000;">//</span><span style="color: #008000;">ç”¨è¿™ä¸ªå°±ä¸è¡Œäº†ï¼Œå¿…é¡»ç”¨FileInputStream</span><span style="color: #008000;"><br></span><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> <span style="color: #0000ff;">int</span> length = fin.available();<br><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span> <span style="color: #0000ff;">byte</span> [] buffer = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">byte</span>[length];<br><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span> fin.read(buffer);<br><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> res = EncodingUtils.getString(buffer, â€œUTF-8â€);<br><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> fin.close();<br><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span> }<span style="color: #0000ff;">catch</span>(Exception e){<br><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span> e.printStackTrace();<br><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span> }<br><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span> myTextView.setText(res);</pre><br></div>

<p>&nbsp;</p>
<h3 id="å››ã€-å†™æ–‡ä»¶ï¼Œ-ä¸€èˆ¬å†™åœ¨-data-data-com-test-files-é‡Œé¢ï¼Œæ‰“å¼€DDMSæŸ¥çœ‹file-exploreræ˜¯å¯ä»¥çœ‹åˆ°ä»¿çœŸå™¨æ–‡ä»¶å­˜æ”¾ç›®å½•çš„ç»“æ„çš„"><a href="#å››ã€-å†™æ–‡ä»¶ï¼Œ-ä¸€èˆ¬å†™åœ¨-data-data-com-test-files-é‡Œé¢ï¼Œæ‰“å¼€DDMSæŸ¥çœ‹file-exploreræ˜¯å¯ä»¥çœ‹åˆ°ä»¿çœŸå™¨æ–‡ä»¶å­˜æ”¾ç›®å½•çš„ç»“æ„çš„" class="headerlink" title="å››ã€ å†™æ–‡ä»¶ï¼Œ ä¸€èˆ¬å†™åœ¨\data\data\com.test\files\é‡Œé¢ï¼Œæ‰“å¼€DDMSæŸ¥çœ‹file exploreræ˜¯å¯ä»¥çœ‹åˆ°ä»¿çœŸå™¨æ–‡ä»¶å­˜æ”¾ç›®å½•çš„ç»“æ„çš„"></a>å››ã€ å†™æ–‡ä»¶ï¼Œ ä¸€èˆ¬å†™åœ¨\data\data\com.test\files\é‡Œé¢ï¼Œæ‰“å¼€DDMSæŸ¥çœ‹file exploreræ˜¯å¯ä»¥çœ‹åˆ°ä»¿çœŸå™¨æ–‡ä»¶å­˜æ”¾ç›®å½•çš„ç»“æ„çš„</h3><div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> String fileName = â€œTEST.txtâ€;<br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> String message = â€œFFFFFFF11111FFFFFâ€ ;<br><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span> writeFileData(fileName, message);<br><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">public</span> voidwriteFileData(String fileName,String message){<br><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">try</span>{<br><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> FileOutputStream fout =openFileOutput(fileName, MODE_PRIVATE);<br><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> <span style="color: #0000ff;">byte</span> [] bytes = message.getBytes();<br><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> fout.write(bytes);<br><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span> fout.close();<br><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span> }<br><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> <span style="color: #0000ff;">catch</span>(Exception e){<br><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> e.printStackTrace();<br><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span> }<br><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span> }</pre><br></div>

<h3 id="äº”ã€-å†™ï¼Œ-è¯»data-data-ç›®å½•-ç›¸å½“APå·¥ä½œç›®å½•-ä¸Šçš„æ–‡ä»¶ï¼Œç”¨openFileOutput"><a href="#äº”ã€-å†™ï¼Œ-è¯»data-data-ç›®å½•-ç›¸å½“APå·¥ä½œç›®å½•-ä¸Šçš„æ–‡ä»¶ï¼Œç”¨openFileOutput" class="headerlink" title="äº”ã€ å†™ï¼Œ è¯»data/data/ç›®å½•(ç›¸å½“APå·¥ä½œç›®å½•)ä¸Šçš„æ–‡ä»¶ï¼Œç”¨openFileOutput"></a>äº”ã€ å†™ï¼Œ è¯»data/data/ç›®å½•(ç›¸å½“APå·¥ä½œç›®å½•)ä¸Šçš„æ–‡ä»¶ï¼Œç”¨openFileOutput</h3><div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">//</span><span style="color: #008000;">å†™æ–‡ä»¶åœ¨./data/data/com.tt/files/ä¸‹é¢</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">public</span> voidwriteFileData(String fileName,String message){<br><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">try</span>{<br><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span> FileOutputStream fout =openFileOutput(fileName, MODE_PRIVATE);<br><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">byte</span> [] bytes = message.getBytes();<br><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> fout.write(bytes);<br><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> fout.close();<br><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> }<br><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span> <span style="color: #0000ff;">catch</span>(Exception e){<br><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span> e.printStackTrace();<br><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> }<br><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> }<br><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span> <span style="color: #008000;">//</span><span style="color: #008000;">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-<br></span><span style="color: #008080;">26</span> <span style="color: #008000;"><br></span><span style="color: #008080;">27</span> <span style="color: #008000;">//</span><span style="color: #008000;">è¯»æ–‡ä»¶åœ¨./data/data/com.tt/files/ä¸‹é¢</span><span style="color: #008000;"><br></span><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span> <span style="color: #0000ff;">public</span> String readFileData(String fileName){<br><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span> String res=â€â€;<br><span style="color: #008080;">32</span><br><span style="color: #008080;">33</span> <span style="color: #0000ff;">try</span>{<br><span style="color: #008080;">34</span><br><span style="color: #008080;">35</span> FileInputStream fin = openFileInput(fileName);<br><span style="color: #008080;">36</span><br><span style="color: #008080;">37</span> <span style="color: #0000ff;">int</span> length = fin.available();<br><span style="color: #008080;">38</span><br><span style="color: #008080;">39</span> <span style="color: #0000ff;">byte</span> [] buffer = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">byte</span>[length];<br><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span> fin.read(buffer);<br><span style="color: #008080;">42</span><br><span style="color: #008080;">43</span> res = EncodingUtils.getString(buffer, â€œUTF-8â€);<br><span style="color: #008080;">44</span><br><span style="color: #008080;">45</span> fin.close();<br><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span> }<br><span style="color: #008080;">48</span><br><span style="color: #008080;">49</span> <span style="color: #0000ff;">catch</span>(Exception e){<br><span style="color: #008080;">50</span><br><span style="color: #008080;">51</span> e.printStackTrace();<br><span style="color: #008080;">52</span><br><span style="color: #008080;">53</span> }<br><span style="color: #008080;">54</span><br><span style="color: #008080;">55</span> <span style="color: #0000ff;">return</span> res;<br><span style="color: #008080;">56</span><br><span style="color: #008080;">57</span> }</pre><br></div>

<h3 id="å…­ã€-å†™ï¼Œ-è¯»sdcardç›®å½•ä¸Šçš„æ–‡ä»¶ï¼Œè¦ç”¨FileOutputStreamï¼Œ-ä¸èƒ½ç”¨openFileOutput"><a href="#å…­ã€-å†™ï¼Œ-è¯»sdcardç›®å½•ä¸Šçš„æ–‡ä»¶ï¼Œè¦ç”¨FileOutputStreamï¼Œ-ä¸èƒ½ç”¨openFileOutput" class="headerlink" title="å…­ã€ å†™ï¼Œ è¯»sdcardç›®å½•ä¸Šçš„æ–‡ä»¶ï¼Œè¦ç”¨FileOutputStreamï¼Œ ä¸èƒ½ç”¨openFileOutput"></a>å…­ã€ å†™ï¼Œ è¯»sdcardç›®å½•ä¸Šçš„æ–‡ä»¶ï¼Œè¦ç”¨FileOutputStreamï¼Œ ä¸èƒ½ç”¨openFileOutput</h3><div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">//</span><span style="color: #008000;">å†™åœ¨/mnt/sdcard/ç›®å½•ä¸‹é¢çš„æ–‡ä»¶</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">public</span> voidwriteFileSdcard(String fileName,String message){<br><span style="color: #008080;"> 4</span><br><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">try</span>{<br><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span> <span style="color: #008000;">//</span><span style="color: #008000;">FileOutputStream fout = openFileOutput(fileName, MODE_PRIVATE);</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span> FileOutputStream fout = newFileOutputStream(fileName);<br><span style="color: #008080;">10</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">byte</span> [] bytes = message.getBytes();<br><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> fout.write(bytes);<br><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> fout.close();<br><span style="color: #008080;">16</span><br><span style="color: #008080;">17</span> }<br><span style="color: #008080;">18</span><br><span style="color: #008080;">19</span> <span style="color: #0000ff;">catch</span>(Exception e){<br><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span> e.printStackTrace();<br><span style="color: #008080;">22</span><br><span style="color: #008080;">23</span> }<br><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span> }<br><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span> <span style="color: #008000;">//</span><span style="color: #008000;">è¯»åœ¨/mnt/sdcard/ç›®å½•ä¸‹é¢çš„æ–‡ä»¶</span><span style="color: #008000;"><br></span><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span> <span style="color: #0000ff;">public</span> String readFileSdcard(String fileName){<br><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span> String res=â€â€;<br><span style="color: #008080;">32</span><br><span style="color: #008080;">33</span> <span style="color: #0000ff;">try</span>{<br><span style="color: #008080;">34</span><br><span style="color: #008080;">35</span> FileInputStream fin = <span style="color: #0000ff;">new</span> FileInputStream(fileName);<br><span style="color: #008080;">36</span><br><span style="color: #008080;">37</span> <span style="color: #0000ff;">int</span> length = fin.available();<br><span style="color: #008080;">38</span><br><span style="color: #008080;">39</span> <span style="color: #0000ff;">byte</span> [] buffer = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">byte</span>[length];<br><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span> fin.read(buffer);<br><span style="color: #008080;">42</span><br><span style="color: #008080;">43</span> res = EncodingUtils.getString(buffer, â€œUTF-8â€);<br><span style="color: #008080;">44</span><br><span style="color: #008080;">45</span> fin.close();<br><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span> }<br><span style="color: #008080;">48</span><br><span style="color: #008080;">49</span> <span style="color: #0000ff;">catch</span>(Exception e){<br><span style="color: #008080;">50</span><br><span style="color: #008080;">51</span> e.printStackTrace();<br><span style="color: #008080;">52</span><br><span style="color: #008080;">53</span> }<br><span style="color: #008080;">54</span><br><span style="color: #008080;">55</span> <span style="color: #0000ff;">return</span> res;<br><span style="color: #008080;">56</span><br><span style="color: #008080;">57</span> }</pre><br></div>

<p><strong>æ³¨ï¼š</strong><span>&nbsp;</span><strong>openFileOutput**</strong>æ˜¯åœ¨<strong><strong>raw</strong></strong>é‡Œç¼–è¯‘è¿‡çš„ï¼Œ<strong><strong>FileOutputStream</strong></strong>æ˜¯ä»»ä½•æ–‡ä»¶éƒ½å¯ä»¥**<br><span><span>Androidè¯»å†™æ–‡ä»¶æ±‡æ€»</span>&nbsp;</span><a href="http://www.ziyouku.com/archives/android-to-read-and-write-file-summary.html" target="_blank" rel="noopener">http://www.ziyouku.com/archives/android-to-read-and-write-file-summary.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> raw </tag>
            
            <tag> resource </tag>
            
            <tag> IO </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidç»˜å›¾æ“ä½œonDraw]]></title>
      <url>/2012/03/03/Android%E7%BB%98%E5%9B%BE%E6%93%8D%E4%BD%9ConDraw/</url>
      <content type="html"><![CDATA[<p><span>åšjavaçš„éƒ½çŸ¥é“ï¼Œç»˜å›¾è‚¯å®šé¦–å…ˆéœ€è¦ä¸€ä¸ªCanvasï¼Œç„¶ååœ¨ç”¨Graphicsåœ¨ä¸Šé¢ç»˜åˆ¶è‡ªå·±æƒ³è¦å›¾æ¡ˆã€‚ä¸é”™ï¼ŒAndroidä¸Šé¢ä¹Ÿç±»ä¼¼ï¼Œä½ å¯ä»¥ä»ä¸€ä¸ªBitmapå¾—åˆ°å®ƒçš„Canvasï¼Œè¿›è¡Œç»˜åˆ¶ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªViewï¼Œç”¨å®ƒçš„ Canvasã€‚ä¸åŒçš„æ—¶ï¼ŒAndroidé‡Œæ²¡æœ‰Graphicsï¼Œè€Œç”¨ Paintä»£ä¹‹ï¼Œå½“ç„¶ç”¨æ³•ä¹Ÿç¨æœ‰ä¸åŒã€‚ä»¥ä¸‹æ˜¯è‡ªå®šä¹‰Viewçš„ä¸€æ®µä»£ç ï¼š&nbsp;</span><br><span>@Override&nbsp;</span><br><span>public void onDraw(Canvas canvas) {&nbsp;</span><br><span>// é¦–å…ˆå®šä¹‰ä¸€ä¸ªpaint&nbsp;</span><br><span>Paint paint = new Paint();&nbsp;</span><br><span>// ç»˜åˆ¶çŸ©å½¢åŒºåŸŸ-å®å¿ƒçŸ©å½¢&nbsp;</span><br><span>// è®¾ç½®é¢œè‰²&nbsp;</span><br><span>paint.setColor(Color.WHITE);&nbsp;</span><br><span>// è®¾ç½®æ ·å¼-å¡«å……&nbsp;</span><br><span>paint.setStyle(Style.FILL);&nbsp;</span><br><span>// ç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢&nbsp;</span><br><span>canvas.drawRect(new Rect(0, 0, getWidth(), getHeight()), paint);&nbsp;</span><br><span>// ç»˜ç©ºå¿ƒçŸ©å½¢&nbsp;</span><br><span>// è®¾ç½®é¢œè‰²&nbsp;</span><br><span>paint.setColor(Color.RED);&nbsp;</span><br><span>// è®¾ç½®æ ·å¼-ç©ºå¿ƒçŸ©å½¢&nbsp;</span><br><span>paint.setStyle(Style.STROKE);&nbsp;</span><br><span>// ç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢&nbsp;</span><br><span>canvas.drawRect(new Rect(10, 10, 50, 20), paint);&nbsp;</span><br><span>// ç»˜æ–‡å­—&nbsp;</span><br><span>// è®¾ç½®é¢œè‰²&nbsp;</span><br><span>paint.setColor(Color.GREEN);&nbsp;</span><br><span>// ç»˜æ–‡å­—&nbsp;</span><br><span>canvas.drawText(str, 30, 30, paint);&nbsp;</span><br><span>// ç»˜å›¾&nbsp;</span><br><span>// ä»èµ„æºæ–‡ä»¶ä¸­ç”Ÿæˆä½å›¾&nbsp;</span><br><span>Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.icon);&nbsp;</span><br><span>// ç»˜å›¾&nbsp;</span><br><span>canvas.drawBitmap(bitmap, 10, 10, paint);&nbsp;</span><br><span>}&nbsp;</span><br><span>ä»¥ä¸Šéœ€è¦æ³¨æ„çš„æœ‰ä¸‰ç‚¹ï¼š&nbsp;</span><br><span>1ã€Androidä¸­çš„Rectå’Œjavaä¸­çš„å¯èƒ½ç¨æœ‰åŒºåˆ«ï¼Œå‰ä¸¤ä¸ªå‚æ•°æ˜¯å·¦ä¸Šè§’çš„åæ ‡ï¼Œåä¸¤ä¸ªå‚æ•°æ˜¯å³ä¸‹è§’çš„åæ ‡ï¼ˆä¸æ˜¯å®½åº¦å’Œé«˜åº¦ï¼‰ï¼›&nbsp;</span><br><span>2ã€Style.STROKEå’ŒStyle.FILLå¤–è¾¹çš„åƒç´ æ•°æ˜¯æœ‰åŒºåˆ«çš„ï¼Œè¿™ç‚¹å’Œjavaé‡Œä¸€æ ·ï¼›&nbsp;</span><br><span>3ã€ç»˜æ–‡å­—æ—¶ï¼Œè®¾ç½®çš„åæ ‡ç‚¹ä¸º(30,30)ï¼Œä½†ç»˜å‡ºæ¥åä½ ä¼šå‘ç°ï¼Œæ–‡å­—çš„å·¦ä¸Šè§’åæ ‡è¦æ¯”ä½ è®¾ç½®çš„åä¸Šï¼Œä¸çŸ¥é“æ˜¯androidè®¾ç½®çš„bugï¼Œè¿˜æ˜¯æˆ‘ä»¬æœ‰ç†è§£åˆ°åæ ‡ç‚¹çš„æ„ä¹‰ã€‚</span></p>
<p>Androidç»˜å›¾æ“ä½œonDraw | è‡ªç”±åº“&nbsp;<a href="http://www.ziyouku.com/archives/android-operating-ondraw-drawing.html" target="_blank" rel="noopener">http://www.ziyouku.com/archives/android-operating-ondraw-drawing.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> onDraw </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[TimePicker,SharedPreferenceså®ç°androidå°é—¹é’Ÿ]]></title>
      <url>/2012/03/03/TimePicker-SharedPreferences%E5%AE%9E%E7%8E%B0android%E5%B0%8F%E9%97%B9%E9%92%9F/</url>
      <content type="html"><![CDATA[<p><img src="http://pic002.cnblogs.com/images/2012/378300/2012030313175433.jpg" alt=""></p>
<p><img src="http://pic002.cnblogs.com/images/2012/378300/2012030313182297.jpg" alt=""></p>
<p><img src="http://pic002.cnblogs.com/images/2012/378300/2012030313183586.jpg" alt=""></p>
<p>ç®€è¿°ï¼š</p>
<p>ä½¿ç”¨TimePickerDialogæ¥å®ç°è®¾ç½®é—¹é’Ÿ</p>
<p>åˆ†ä¸ºä¸€æ¬¡æ€§é—¹é’Ÿå’Œå‘¨æœŸæ€§é—¹é’Ÿ</p>
<p>ä½¿ç”¨SharedPreferencesæ¥å‚¨å­˜é—¹é’Ÿçš„è®¾ç½®ä¿¡æ¯</p>
<p>&nbsp;</p>
<p>AlarmClockActivityå¸ƒå±€ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('e85b0aeb-2755-4966-96ab-92b2ce96e0f6')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_e85b0aeb-2755-4966-96ab-92b2ce96e0f6" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> &lt;?xml version=â€1.0â€ encoding=â€utf-8â€?&gt;<br><span style="color: #008080;">  2</span> &lt;LinearLayout xmlns:android=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ<br><span style="color: #008080;">  3</span>     android:layout_width=â€fill_parentâ€<br><span style="color: #008080;">  4</span>     android:layout_height=â€fill_parentâ€<br><span style="color: #008080;">  5</span>     android:orientation=â€verticalâ€&gt;<br><span style="color: #008080;">  6</span><br><span style="color: #008080;">  7</span>     &lt;TextView<br><span style="color: #008080;">  8</span>         android:id=â€@+id/timeIdâ€<br><span style="color: #008080;">  9</span>         android:layout_width=â€fill_parentâ€<br><span style="color: #008080;"> 10</span>         android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;"> 11</span>         android:textSize=â€33dpâ€<br><span style="color: #008080;"> 12</span>         android:gravity=â€center_horizontalâ€<br><span style="color: #008080;"> 13</span>         android:layout_marginTop=â€10dpâ€<br><span style="color: #008080;"> 14</span>         android:text=â€00:00  AMâ€ /&gt;<br><span style="color: #008080;"> 15</span><br><span style="color: #008080;"> 16</span>     &lt;TableLayout<br><span style="color: #008080;"> 17</span>         android:id=â€@+id/tableLayout1â€<br><span style="color: #008080;"> 18</span>         android:layout_width=â€match_parentâ€<br><span style="color: #008080;"> 19</span>         android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;"> 20</span>         android:layout_marginTop=â€10dpâ€&gt;<br><span style="color: #008080;"> 21</span><br><span style="color: #008080;"> 22</span>         &lt;TableRow<br><span style="color: #008080;"> 23</span>             android:id=â€@+id/tableRow1â€<br><span style="color: #008080;"> 24</span>             android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 25</span>             android:layout_height=â€wrap_contentâ€ &gt;<br><span style="color: #008080;"> 26</span><br><span style="color: #008080;"> 27</span>             &lt;TextView<br><span style="color: #008080;"> 28</span>                 android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 29</span>                 android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;"> 30</span>                 android:layout_marginLeft=â€15dpâ€<br><span style="color: #008080;"> 31</span>                 android:layout_weight=â€1.0â€<br><span style="color: #008080;"> 32</span>                 android:textSize=â€20spâ€<br><span style="color: #008080;"> 33</span>                 android:text=â€åªå“ä¸€æ¬¡çš„é—¹é’Ÿâ€ /&gt;<br><span style="color: #008080;"> 34</span><br><span style="color: #008080;"> 35</span>             &lt;Button<br><span style="color: #008080;"> 36</span>                 android:id=â€@+id/onceSetIdâ€<br><span style="color: #008080;"> 37</span>                 android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 38</span>                 android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;"> 39</span>                 android:layout_marginRight=â€10dpâ€<br><span style="color: #008080;"> 40</span>                 android:layout_weight=â€1.0â€<br><span style="color: #008080;"> 41</span>                 android:text=â€è®¾ç½®é—¹é’Ÿâ€ /&gt;<br><span style="color: #008080;"> 42</span>         &lt;/TableRow&gt;<br><span style="color: #008080;"> 43</span><br><span style="color: #008080;"> 44</span>         &lt;TableRow<br><span style="color: #008080;"> 45</span>             android:id=â€@+id/tableRow2â€<br><span style="color: #008080;"> 46</span>             android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 47</span>             android:layout_height=â€wrap_contentâ€ &gt;<br><span style="color: #008080;"> 48</span><br><span style="color: #008080;"> 49</span>             &lt;TextView<br><span style="color: #008080;"> 50</span>                 android:id=â€@+id/onceTextIdâ€<br><span style="color: #008080;"> 51</span>                 android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 52</span>                 android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;"> 53</span>                 android:layout_marginLeft=â€15dpâ€<br><span style="color: #008080;"> 54</span>                 android:layout_weight=â€1.0â€<br><span style="color: #008080;"> 55</span>                 android:textSize=â€20spâ€<br><span style="color: #008080;"> 56</span>                 android:text=â€æš‚æ— è®¾ç½®â€ /&gt;<br><span style="color: #008080;"> 57</span><br><span style="color: #008080;"> 58</span>             &lt;Button<br><span style="color: #008080;"> 59</span>                 android:id=â€@+id/onceDeleIdâ€<br><span style="color: #008080;"> 60</span>                 android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 61</span>                 android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;"> 62</span>                 android:layout_marginRight=â€10dpâ€<br><span style="color: #008080;"> 63</span>                 android:layout_weight=â€1.0â€<br><span style="color: #008080;"> 64</span>                 android:text=â€åˆ é™¤é—¹é’Ÿâ€ /&gt;<br><span style="color: #008080;"> 65</span>         &lt;/TableRow&gt;<br><span style="color: #008080;"> 66</span><br><span style="color: #008080;"> 67</span>         &lt;TableRow<br><span style="color: #008080;"> 68</span>             android:id=â€@+id/tableRow3â€<br><span style="color: #008080;"> 69</span>             android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 70</span>             android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;"> 71</span>             android:layout_marginTop=â€25dpâ€&gt;<br><span style="color: #008080;"> 72</span><br><span style="color: #008080;"> 73</span>             &lt;TextView<br><span style="color: #008080;"> 74</span>                 android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 75</span>                 android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;"> 76</span>                 android:layout_marginLeft=â€15dpâ€<br><span style="color: #008080;"> 77</span>                 android:layout_weight=â€1.0â€<br><span style="color: #008080;"> 78</span>                 android:textSize=â€20spâ€<br><span style="color: #008080;"> 79</span>                 android:text=â€é‡å¤å“èµ·çš„é—¹é’Ÿâ€ /&gt;<br><span style="color: #008080;"> 80</span><br><span style="color: #008080;"> 81</span>             &lt;Button<br><span style="color: #008080;"> 82</span>                 android:id=â€@+id/timesSetIdâ€<br><span style="color: #008080;"> 83</span>                 android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 84</span>                 android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;"> 85</span>                 android:layout_marginRight=â€10dpâ€<br><span style="color: #008080;"> 86</span>                 android:layout_weight=â€1.0â€<br><span style="color: #008080;"> 87</span>                 android:text=â€è®¾ç½®é—¹é’Ÿâ€ /&gt;<br><span style="color: #008080;"> 88</span>         &lt;/TableRow&gt;<br><span style="color: #008080;"> 89</span><br><span style="color: #008080;"> 90</span>         &lt;TableRow<br><span style="color: #008080;"> 91</span>             android:id=â€@+id/tableRow4â€<br><span style="color: #008080;"> 92</span>             android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 93</span>             android:layout_height=â€wrap_contentâ€ &gt;<br><span style="color: #008080;"> 94</span><br><span style="color: #008080;"> 95</span>             &lt;TextView<br><span style="color: #008080;"> 96</span>                 android:id=â€@+id/timesTextIdâ€<br><span style="color: #008080;"> 97</span>                 android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;"> 98</span>                 android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;"> 99</span>                 android:layout_marginLeft=â€15dpâ€<br><span style="color: #008080;">100</span>                 android:layout_weight=â€1.0â€<br><span style="color: #008080;">101</span>                 android:textSize=â€20spâ€<br><span style="color: #008080;">102</span>                 android:text=â€æš‚æ— è®¾ç½®â€ /&gt;<br><span style="color: #008080;">103</span><br><span style="color: #008080;">104</span>             &lt;Button<br><span style="color: #008080;">105</span>                 android:id=â€@+id/timesDeleIdâ€<br><span style="color: #008080;">106</span>                 android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;">107</span>                 android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;">108</span>                 android:layout_marginRight=â€10dpâ€<br><span style="color: #008080;">109</span>                 android:layout_weight=â€1.0â€<br><span style="color: #008080;">110</span>                 android:text=â€åˆ é™¤é—¹é’Ÿâ€ /&gt;<br><span style="color: #008080;">111</span>         &lt;/TableRow&gt;<br><span style="color: #008080;">112</span>     &lt;/TableLayout&gt;<br><span style="color: #008080;">113</span><br><span style="color: #008080;">114</span> &lt;/LinearLayout&gt;</pre><br></div><br></div>

<p>&nbsp;</p>
<p>AlarmClockActivity.javaï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('a0a29346-6f57-40d1-a0e1-349296dc9b15')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_a0a29346-6f57-40d1-a0e1-349296dc9b15" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span> com.tiantian.test;<br><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span> java.util.Calendar;<br><span style="color: #008080;">  4</span><br><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span> android.app.Activity;<br><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span> android.app.AlarmManager;<br><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span> android.app.PendingIntent;<br><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span> android.app.TimePickerDialog;<br><span style="color: #008080;">  9</span> <span style="color: #0000ff;">import</span> android.app.TimePickerDialog.OnTimeSetListener;<br><span style="color: #008080;"> 10</span> <span style="color: #0000ff;">import</span> android.content.Intent;<br><span style="color: #008080;"> 11</span> <span style="color: #0000ff;">import</span> android.content.SharedPreferences;<br><span style="color: #008080;"> 12</span> <span style="color: #0000ff;">import</span> android.content.SharedPreferences.Editor;<br><span style="color: #008080;"> 13</span> <span style="color: #0000ff;">import</span> android.os.Bundle;<br><span style="color: #008080;"> 14</span> <span style="color: #0000ff;">import</span> android.os.Handler;<br><span style="color: #008080;"> 15</span> <span style="color: #0000ff;">import</span> android.text.format.Time;<br><span style="color: #008080;"> 16</span> <span style="color: #0000ff;">import</span> android.util.Log;<br><span style="color: #008080;"> 17</span> <span style="color: #0000ff;">import</span> android.view.View;<br><span style="color: #008080;"> 18</span> <span style="color: #0000ff;">import</span> android.view.View.OnClickListener;<br><span style="color: #008080;"> 19</span> <span style="color: #0000ff;">import</span> android.widget.Button;<br><span style="color: #008080;"> 20</span> <span style="color: #0000ff;">import</span> android.widget.TextView;<br><span style="color: #008080;"> 21</span> <span style="color: #0000ff;">import</span> android.widget.TimePicker;<br><span style="color: #008080;"> 22</span><br><span style="color: #008080;"> 23</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> AlarmClockActivity <span style="color: #0000ff;">extends</span> Activity {<br><span style="color: #008080;"> 24</span>     <span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> Called when the activity is first created. </span><span style="color: #008000;">/</span><br><span style="color: #008080;"> 25</span>     <span style="color: #0000ff;">private</span> TextView timeTV;<br><span style="color: #008080;"> 26</span>     <span style="color: #0000ff;">static</span> TextView onceTV;<br><span style="color: #008080;"> 27</span>     <span style="color: #0000ff;">private</span> TextView timesTV;<br><span style="color: #008080;"> 28</span>     <span style="color: #0000ff;">private</span> Button onceSetBT;<br><span style="color: #008080;"> 29</span>     <span style="color: #0000ff;">private</span> Button onceDeleBT;<br><span style="color: #008080;"> 30</span>     <span style="color: #0000ff;">private</span> Button timesSetBT;<br><span style="color: #008080;"> 31</span>     <span style="color: #0000ff;">private</span> Button timesDelBT;<br><span style="color: #008080;"> 32</span>     <span style="color: #0000ff;">private</span> Calendar c;<br><span style="color: #008080;"> 33</span><br><span style="color: #008080;"> 34</span>     <span style="color: #0000ff;">private</span> Handler mHandler;<br><span style="color: #008080;"> 35</span>     <span style="color: #0000ff;">private</span> SharedPreferences prefs;<br><span style="color: #008080;"> 36</span>     <span style="color: #0000ff;">private</span> Editor editor;<br><span style="color: #008080;"> 37</span><br><span style="color: #008080;"> 38</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> String ONCE_ALARM = â€œcom.tiantian.action.ONCE_ALARMâ€;<br><span style="color: #008080;"> 39</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> String TIMES_ALARM = â€œcom.tiantian.action.TIMES_ALARMâ€;<br><span style="color: #008080;"> 40</span>     @Override<br><span style="color: #008080;"> 41</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCreate(Bundle savedInstanceState) {<br><span style="color: #008080;"> 42</span>         <span style="color: #0000ff;">super</span>.onCreate(savedInstanceState);<br><span style="color: #008080;"> 43</span>         setContentView(R.layout.main);<br><span style="color: #008080;"> 44</span>         timeTV = (TextView) findViewById(R.id.timeId);<br><span style="color: #008080;"> 45</span>         onceTV = (TextView) findViewById(R.id.onceTextId);<br><span style="color: #008080;"> 46</span>         timesTV = (TextView) findViewById(R.id.timesTextId);<br><span style="color: #008080;"> 47</span>         mHandler = <span style="color: #0000ff;">new</span> Handler();<br><span style="color: #008080;"> 48</span>         mHandler.post(timeThread);<br><span style="color: #008080;"> 49</span><br><span style="color: #008080;"> 50</span>         prefs = getSharedPreferences(â€œalarmClockâ€, MODE_PRIVATE);<br><span style="color: #008080;"> 51</span>         editor = prefs.edit();<br><span style="color: #008080;"> 52</span>         <span style="color: #0000ff;">if</span>(prefs != <span style="color: #0000ff;">null</span>){<br><span style="color: #008080;"> 53</span>             onceTV.setText(prefs.getString(â€œ_onceTVâ€, â€œæš‚æ— è®¾ç½®â€));<br><span style="color: #008080;"> 54</span>             timesTV.setText(prefs.getString(â€œ_timesTVâ€, â€œæš‚æ— è®¾ç½®â€));<br><span style="color: #008080;"> 55</span>         }<br><span style="color: #008080;"> 56</span><br><span style="color: #008080;"> 57</span>         onceSetBT = (Button) findViewById(R.id.onceSetId);<br><span style="color: #008080;"> 58</span>         onceSetBT.setOnClickListener(<span style="color: #0000ff;">new</span> ButtonListener());<br><span style="color: #008080;"> 59</span>         onceDeleBT = (Button) findViewById(R.id.onceDeleId);<br><span style="color: #008080;"> 60</span>         onceDeleBT.setOnClickListener(<span style="color: #0000ff;">new</span> ButtonListener());<br><span style="color: #008080;"> 61</span>         timesSetBT = (Button) findViewById(R.id.timesSetId);<br><span style="color: #008080;"> 62</span>         timesSetBT.setOnClickListener(<span style="color: #0000ff;">new</span> ButtonListener());<br><span style="color: #008080;"> 63</span>         timesDelBT = (Button) findViewById(R.id.timesDeleId);<br><span style="color: #008080;"> 64</span>         timesDelBT.setOnClickListener(<span style="color: #0000ff;">new</span> ButtonListener());<br><span style="color: #008080;"> 65</span><br><span style="color: #008080;"> 66</span>     }<br><span style="color: #008080;"> 67</span><br><span style="color: #008080;"> 68</span>     <span style="color: #0000ff;">class</span> ButtonListener <span style="color: #0000ff;">implements</span> OnClickListener{<br><span style="color: #008080;"> 69</span><br><span style="color: #008080;"> 70</span>         @Override<br><span style="color: #008080;"> 71</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onClick(View v) {<br><span style="color: #008080;"> 72</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 73</span>             <span style="color: #0000ff;">switch</span>(v.getId()){<br><span style="color: #008080;"> 74</span>             <span style="color: #0000ff;">case</span> R.id.onceSetId:<br><span style="color: #008080;"> 75</span>                 c = Calendar.getInstance();<br><span style="color: #008080;"> 76</span>                 <span style="color: #0000ff;">int</span> hour = c.get(Calendar.HOUR_OF_DAY);<br><span style="color: #008080;"> 77</span>                 <span style="color: #0000ff;">int</span> minute = c.get(Calendar.MINUTE);<br><span style="color: #008080;"> 78</span>                 <span style="color: #0000ff;">new</span> TimePickerDialog(AlarmClockActivity.<span style="color: #0000ff;">this</span>, <span style="color: #0000ff;">new</span> OnTimeSetListener() {<br><span style="color: #008080;"> 79</span><br><span style="color: #008080;"> 80</span>                     @Override<br><span style="color: #008080;"> 81</span>                     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onTimeSet(TimePicker view, <span style="color: #0000ff;">int</span> hourOfDay, <span style="color: #0000ff;">int</span> minute) {<br><span style="color: #008080;"> 82</span>                         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 83</span>                         onceTV.setText(â€œå·²è®¾ç½®ä¸ºï¼šâ€ + changeTime(hourOfDay) + â€œ:â€ + changeTime(minute));<br><span style="color: #008080;"> 84</span>                         c = timePicker(hourOfDay, minute);<br><span style="color: #008080;"> 85</span>                         AlarmManager am = (AlarmManager) getSystemService(ALARM_SERVICE);<br><span style="color: #008080;"> 86</span>                         Intent intent = <span style="color: #0000ff;">new</span> Intent(AlarmClockActivity.<span style="color: #0000ff;">this</span>, CallAlarm.<span style="color: #0000ff;">class</span>);<br><span style="color: #008080;"> 87</span>                         intent.setAction(ONCE_ALARM);<br><span style="color: #008080;"> 88</span>                         PendingIntent senderPI = PendingIntent.getBroadcast(AlarmClockActivity.<span style="color: #0000ff;">this</span>, 0, intent, 0);<br><span style="color: #008080;"> 89</span>                         am.set(AlarmManager.RTC_WAKEUP, c.getTimeInMillis(), senderPI);<br><span style="color: #008080;"> 90</span>                     }<br><span style="color: #008080;"> 91</span>                 }, hour, minute, <span style="color: #0000ff;">true</span>).show();<br><span style="color: #008080;"> 92</span>                 <span style="color: #0000ff;">break</span>;<br><span style="color: #008080;"> 93</span>             <span style="color: #0000ff;">case</span> R.id.onceDeleId:<br><span style="color: #008080;"> 94</span>                 AlarmManager am = (AlarmManager) getSystemService(ALARM_SERVICE);<br><span style="color: #008080;"> 95</span>                 Intent intent = <span style="color: #0000ff;">new</span> Intent(AlarmClockActivity.<span style="color: #0000ff;">this</span>, CallAlarm.<span style="color: #0000ff;">class</span>);<br><span style="color: #008080;"> 96</span>                 PendingIntent senderPI = PendingIntent.getBroadcast(AlarmClockActivity.<span style="color: #0000ff;">this</span>, 0, intent, 0);<br><span style="color: #008080;"> 97</span>                 am.cancel(senderPI);<br><span style="color: #008080;"> 98</span>                 onceTV.setText(â€œæš‚æ— è®¾ç½®â€);<br><span style="color: #008080;"> 99</span>                 <span style="color: #0000ff;">break</span>;<br><span style="color: #008080;">100</span>             <span style="color: #0000ff;">case</span> R.id.timesSetId:<br><span style="color: #008080;">101</span>                 c = Calendar.getInstance();<br><span style="color: #008080;">102</span>                 <span style="color: #0000ff;">int</span> hour1 = c.get(Calendar.HOUR_OF_DAY);<br><span style="color: #008080;">103</span>                 <span style="color: #0000ff;">int</span> minute1 = c.get(Calendar.MINUTE);<br><span style="color: #008080;">104</span>                 <span style="color: #0000ff;">new</span> TimePickerDialog(AlarmClockActivity.<span style="color: #0000ff;">this</span>, <span style="color: #0000ff;">new</span> OnTimeSetListener() {<br><span style="color: #008080;">105</span><br><span style="color: #008080;">106</span>                     @Override<br><span style="color: #008080;">107</span>                     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onTimeSet(TimePicker view, <span style="color: #0000ff;">int</span> hourOfDay, <span style="color: #0000ff;">int</span> minute) {<br><span style="color: #008080;">108</span>                         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">109</span>                         timesTV.setText(â€œå·²è®¾ç½®ä¸ºï¼šâ€ + changeTime(hourOfDay) + â€œ:â€ + changeTime(minute));<br><span style="color: #008080;">110</span>                         c = timePicker(hourOfDay, minute);<br><span style="color: #008080;">111</span>                         AlarmManager am = (AlarmManager) getSystemService(ALARM_SERVICE);<br><span style="color: #008080;">112</span>                         Intent intent = <span style="color: #0000ff;">new</span> Intent(AlarmClockActivity.<span style="color: #0000ff;">this</span>, CallAlarm.<span style="color: #0000ff;">class</span>);<br><span style="color: #008080;">113</span>                         intent.setAction(TIMES_ALARM);<br><span style="color: #008080;">114</span>                         PendingIntent senderPI = PendingIntent.getBroadcast(AlarmClockActivity.<span style="color: #0000ff;">this</span>, 1, intent, 0);<br><span style="color: #008080;">115</span>                         am.setRepeating(AlarmManager.RTC_WAKEUP, c.getTimeInMillis(), 24<em>60</em>60*1000, senderPI);<br><span style="color: #008080;">116</span>                     }<br><span style="color: #008080;">117</span>                 }, hour1, minute1, <span style="color: #0000ff;">true</span>).show();<br><span style="color: #008080;">118</span>                 <span style="color: #0000ff;">break</span>;<br><span style="color: #008080;">119</span>             <span style="color: #0000ff;">case</span> R.id.timesDeleId:<br><span style="color: #008080;">120</span>                 AlarmManager am1 = (AlarmManager) getSystemService(ALARM_SERVICE);<br><span style="color: #008080;">121</span>                 Intent intent1 = <span style="color: #0000ff;">new</span> Intent(AlarmClockActivity.<span style="color: #0000ff;">this</span>, CallAlarm.<span style="color: #0000ff;">class</span>);<br><span style="color: #008080;">122</span>                 PendingIntent senderPI1 = PendingIntent.getBroadcast(AlarmClockActivity.<span style="color: #0000ff;">this</span>, 1, intent1, 0);<br><span style="color: #008080;">123</span>                 am1.cancel(senderPI1);<br><span style="color: #008080;">124</span>                 timesTV.setText(â€œæš‚æ— è®¾ç½®â€);<br><span style="color: #008080;">125</span>                 <span style="color: #0000ff;">break</span>;<br><span style="color: #008080;">126</span>             }<br><span style="color: #008080;">127</span><br><span style="color: #008080;">128</span>         }<br><span style="color: #008080;">129</span><br><span style="color: #008080;">130</span>     }<br><span style="color: #008080;">131</span><br><span style="color: #008080;">132</span>     <span style="color: #0000ff;">private</span> Calendar timePicker(<span style="color: #0000ff;">int</span> hourOfDay, <span style="color: #0000ff;">int</span> minute){<br><span style="color: #008080;">133</span>         c.setTimeInMillis(System.currentTimeMillis());<br><span style="color: #008080;">134</span>         c.set(Calendar.HOUR_OF_DAY, hourOfDay);<br><span style="color: #008080;">135</span>         c.set(Calendar.MINUTE, minute);<br><span style="color: #008080;">136</span>         c.set(Calendar.SECOND, 0);<br><span style="color: #008080;">137</span>         c.set(Calendar.MILLISECOND, 0);<br><span style="color: #008080;">138</span>         <span style="color: #008000;">//</span><span style="color: #008000;">é¿å…è®¾ç½®æ—¶é—´æ¯”å½“å‰æ—¶é—´å°æ—¶ é©¬ä¸Šå“åº”çš„æƒ…å†µå‘ç”Ÿ</span><span style="color: #008000;"><br></span><span style="color: #008080;">139</span>         <span style="color: #0000ff;">if</span>(c.getTimeInMillis() &lt; Calendar.getInstance().getTimeInMillis()){<br><span style="color: #008080;">140</span>             c.set(Calendar.DAY_OF_MONTH, Calendar.DAY_OF_MONTH + 1);<br><span style="color: #008080;">141</span>         }<br><span style="color: #008080;">142</span>         <span style="color: #0000ff;">return</span> c;<br><span style="color: #008080;">143</span>     }<br><span style="color: #008080;">144</span><br><span style="color: #008080;">145</span><br><span style="color: #008080;">146</span>     @Override<br><span style="color: #008080;">147</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> onDestroy() {<br><span style="color: #008080;">148</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">149</span>         <span style="color: #0000ff;">super</span>.onDestroy();<br><span style="color: #008080;">150</span>         editor.putString(â€œ_onceTVâ€, onceTV.getText().toString());<br><span style="color: #008080;">151</span>         editor.putString(â€œ_timesTVâ€, timesTV.getText().toString());<br><span style="color: #008080;">152</span>         editor.commit();<br><span style="color: #008080;">153</span>     }<br><span style="color: #008080;">154</span><br><span style="color: #008080;">155</span><br><span style="color: #008080;">156</span>     Runnable timeThread = <span style="color: #0000ff;">new</span> Runnable() {<br><span style="color: #008080;">157</span><br><span style="color: #008080;">158</span>         @Override<br><span style="color: #008080;">159</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> run() {<br><span style="color: #008080;">160</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">161</span>             timeTV.setText(changeTime(Calendar.getInstance().get(Calendar.HOUR))<br><span style="color: #008080;">162</span>                     + â€œ:â€ +changeTime(Calendar.getInstance().get(Calendar.MINUTE))<br><span style="color: #008080;">163</span>                     + â€œ  â€œ + changeAMPM(Calendar.getInstance().get(Calendar.AM_PM)));<br><span style="color: #008080;">164</span>             mHandler.postDelayed(timeThread, 100);<br><span style="color: #008080;">165</span>         }<br><span style="color: #008080;">166</span>     };<br><span style="color: #008080;">167</span><br><span style="color: #008080;">168</span>     <span style="color: #0000ff;">private</span> String changeTime(<span style="color: #0000ff;">int</span> a){<br><span style="color: #008080;">169</span>         String num = <span style="color: #0000ff;">null</span>;<br><span style="color: #008080;">170</span>         <span style="color: #0000ff;">if</span>(a &lt; 10){<br><span style="color: #008080;">171</span>             num = â€œ0â€ + a;<br><span style="color: #008080;">172</span>         }<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(a &gt; 9){<br><span style="color: #008080;">173</span>             num = â€œâ€ + a;<br><span style="color: #008080;">174</span>         }<br><span style="color: #008080;">175</span>         <span style="color: #0000ff;">return</span> num;<br><span style="color: #008080;">176</span>     }<br><span style="color: #008080;">177</span>     <span style="color: #0000ff;">private</span> String changeAMPM(<span style="color: #0000ff;">int</span> ap){<br><span style="color: #008080;">178</span>         String apStr = <span style="color: #0000ff;">null</span>;<br><span style="color: #008080;">179</span>         <span style="color: #0000ff;">if</span>(ap == 0){<br><span style="color: #008080;">180</span>             apStr = â€œAMâ€;<br><span style="color: #008080;">181</span>         }<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(ap == 1){<br><span style="color: #008080;">182</span>             apStr = â€œPMâ€;<br><span style="color: #008080;">183</span>         }<br><span style="color: #008080;">184</span>         <span style="color: #0000ff;">return</span> apStr;<br><span style="color: #008080;">185</span>     }<br><span style="color: #008080;">186</span><br><span style="color: #008080;">187</span> }</pre><br></div><br></div>

<p>CallAlarm.javaï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('c5bf7d4e-03e7-4260-9ace-1b63849d1153')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_c5bf7d4e-03e7-4260-9ace-1b63849d1153" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span> com.tiantian.test;<br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span> android.content.BroadcastReceiver;<br><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span> android.content.Context;<br><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span> android.content.Intent;<br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span> android.util.Log;<br><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> CallAlarm <span style="color: #0000ff;">extends</span> BroadcastReceiver{<br><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> String ONCE_ALARM = â€œcom.tiantian.action.ONCE_ALARMâ€;<br><span style="color: #008080;">10</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> String TIMES_ALARM = â€œcom.tiantian.action.TIMES_ALARMâ€;<br><span style="color: #008080;">11</span>     @Override<br><span style="color: #008080;">12</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onReceive(Context context, Intent intent) {<br><span style="color: #008080;">13</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">14</span>         Log.v(â€œCATâ€, â€œIâ€™m in BroadcastReceiverâ€);<br><span style="color: #008080;">15</span>         Intent wakeUpIntent = <span style="color: #0000ff;">new</span> Intent(context, WakeUp.<span style="color: #0000ff;">class</span>);<br><span style="color: #008080;">16</span>         wakeUpIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);<br><span style="color: #008080;">17</span>         <span style="color: #0000ff;">if</span>(intent.getAction().equals(ONCE_ALARM)){<br><span style="color: #008080;">18</span>             wakeUpIntent.setAction(ONCE_ALARM);<br><span style="color: #008080;">19</span>         }<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(intent.getAction().endsWith(TIMES_ALARM)){<br><span style="color: #008080;">20</span>             wakeUpIntent.setAction(TIMES_ALARM);<br><span style="color: #008080;">21</span>         }<br><span style="color: #008080;">22</span>         context.startActivity(wakeUpIntent);<br><span style="color: #008080;">23</span>     }<br><span style="color: #008080;">24</span><br><span style="color: #008080;">25</span> }</pre><br></div><br></div>

<p>&nbsp;</p>
<p>WakeUp.java</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('5a640f02-d1eb-4506-b25e-73dd110e947e')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_5a640f02-d1eb-4506-b25e-73dd110e947e" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span> com.tiantian.test;<br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span> android.app.Activity;<br><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span> android.app.AlertDialog;<br><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span> android.content.DialogInterface;<br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span> android.content.DialogInterface.OnClickListener;<br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span> android.content.SharedPreferences;<br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span> android.content.SharedPreferences.Editor;<br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span> android.media.MediaPlayer;<br><span style="color: #008080;">10</span> <span style="color: #0000ff;">import</span> android.os.Bundle;<br><span style="color: #008080;">11</span> <span style="color: #0000ff;">import</span> android.os.Environment;<br><span style="color: #008080;">12</span> <span style="color: #0000ff;">import</span> android.view.View;<br><span style="color: #008080;">13</span> <span style="color: #0000ff;">import</span> android.widget.Button;<br><span style="color: #008080;">14</span><br><span style="color: #008080;">15</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> WakeUp <span style="color: #0000ff;">extends</span> Activity{<br><span style="color: #008080;">16</span>     <span style="color: #0000ff;">private</span> Button okButton;<br><span style="color: #008080;">17</span>     <span style="color: #0000ff;">private</span> SharedPreferences prefs;<br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">private</span> Editor editor;<br><span style="color: #008080;">19</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> String ONCE_ALARM = â€œcom.tiantian.action.ONCE_ALARMâ€;<br><span style="color: #008080;">20</span><br><span style="color: #008080;">21</span>     <span style="color: #0000ff;">private</span> MediaPlayer mediaPlayer;<br><span style="color: #008080;">22</span>     @Override<br><span style="color: #008080;">23</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> onCreate(Bundle savedInstanceState) {<br><span style="color: #008080;">24</span>         <span style="color: #0000ff;">super</span>.onCreate(savedInstanceState);<br><span style="color: #008080;">25</span>         setContentView(R.layout.wake_up);<br><span style="color: #008080;">26</span>         prefs = getSharedPreferences(â€œalarmClockâ€, MODE_PRIVATE);<br><span style="color: #008080;">27</span>         mediaPlayer = <span style="color: #0000ff;">new</span> MediaPlayer();<br><span style="color: #008080;">28</span>         <span style="color: #0000ff;">try</span> {<br><span style="color: #008080;">29</span>             <span style="color: #008000;">//</span><span style="color: #008000;">mediaPlayer.setDataSource(Environment.getExternalStorageDirectory() + â€œ/mp3/trhxn.mp3â€);</span><span style="color: #008000;"><br></span><span style="color: #008080;">30</span>             mediaPlayer = MediaPlayer.create(<span style="color: #0000ff;">this</span>, R.raw.conan);<br><span style="color: #008080;">31</span>             <span style="color: #008000;">//</span><span style="color: #008000;">mediaPlayer.prepare();</span><span style="color: #008000;"><br></span><span style="color: #008080;">32</span>             mediaPlayer.setLooping(<span style="color: #0000ff;">true</span>);<br><span style="color: #008080;">33</span>             mediaPlayer.start();<br><span style="color: #008080;">34</span>         } <span style="color: #0000ff;">catch</span> (Exception e) {<br><span style="color: #008080;">35</span>             e.printStackTrace();<br><span style="color: #008080;">36</span>         }<br><span style="color: #008080;">37</span><br><span style="color: #008080;">38</span>         okButton = (Button) findViewById(R.id.okButtonId);<br><span style="color: #008080;">39</span>         okButton.setOnClickListener(<span style="color: #0000ff;">new</span> View.OnClickListener() {<br><span style="color: #008080;">40</span><br><span style="color: #008080;">41</span>             @Override<br><span style="color: #008080;">42</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onClick(View v) {<br><span style="color: #008080;">43</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">44</span>                 <span style="color: #0000ff;">if</span>(getIntent().getAction().equals(ONCE_ALARM)){<br><span style="color: #008080;">45</span>                     editor = prefs.edit();<br><span style="color: #008080;">46</span>                     editor.putString(â€œ_onceTVâ€, â€œæš‚æ— è®¾ç½®â€);<br><span style="color: #008080;">47</span>                     editor.commit();<br><span style="color: #008080;">48</span>                     AlarmClockActivity.onceTV.setText(â€œæš‚æ— è®¾ç½®â€);<br><span style="color: #008080;">49</span>                 }<br><span style="color: #008080;">50</span>                 mediaPlayer.stop();<br><span style="color: #008080;">51</span>                 mediaPlayer.release();<br><span style="color: #008080;">52</span>                 finish();<br><span style="color: #008080;">53</span>             }<br><span style="color: #008080;">54</span>         });<br><span style="color: #008080;">55</span><br><span style="color: #008080;">56</span><br><span style="color: #008080;">57</span><br><span style="color: #008080;">58</span>     }<br><span style="color: #008080;">59</span><br><span style="color: #008080;">60</span><br><span style="color: #008080;">61</span> }</pre><br></div><br></div>

]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[androidä¸­DatePicker&TimePickerçš„åº”ç”¨]]></title>
      <url>/2012/03/01/android%E4%B8%ADDatePicker-TimePicker%E7%9A%84%E5%BA%94%E7%94%A8/</url>
      <content type="html"><![CDATA[<p><img src="http://pic002.cnblogs.com/images/2012/378300/2012030118412226.jpg" alt=""></p>
<p>å¸ƒå±€ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('210ec2ed-ef8a-41d7-b9e4-93fa5b27d84f')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_210ec2ed-ef8a-41d7-b9e4-93fa5b27d84f" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> &lt;?xml version=â€1.0â€ encoding=â€utf-8â€?&gt;<br><span style="color: #008080;"> 2</span> &lt;LinearLayout xmlns:android=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ<br><span style="color: #008080;"> 3</span>     android:layout_width=â€fill_parentâ€<br><span style="color: #008080;"> 4</span>     android:layout_height=â€fill_parentâ€<br><span style="color: #008080;"> 5</span>     android:orientation=â€verticalâ€ &gt;<br><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span>     &lt;TextView<br><span style="color: #008080;"> 8</span>         android:id=â€@+id/dateTextâ€<br><span style="color: #008080;"> 9</span>         android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;">10</span>         android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;">11</span>         /&gt;<br><span style="color: #008080;">12</span>     &lt;Button<br><span style="color: #008080;">13</span>         android:id=â€@+id/dateButtonâ€<br><span style="color: #008080;">14</span>         android:layout_width=â€fill_parentâ€<br><span style="color: #008080;">15</span>         android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;">16</span>         android:text=â€è®¾ç½®æ—¥æœŸâ€<br><span style="color: #008080;">17</span>         /&gt;<br><span style="color: #008080;">18</span>     &lt;TextView<br><span style="color: #008080;">19</span>         android:id=â€@+id/timeTextâ€<br><span style="color: #008080;">20</span>         android:layout_width=â€wrap_contentâ€<br><span style="color: #008080;">21</span>         android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;">22</span>         /&gt;<br><span style="color: #008080;">23</span>     &lt;Button<br><span style="color: #008080;">24</span>         android:id=â€@+id/timeButtonâ€<br><span style="color: #008080;">25</span>         android:layout_width=â€fill_parentâ€<br><span style="color: #008080;">26</span>         android:layout_height=â€wrap_contentâ€<br><span style="color: #008080;">27</span>         android:text=â€è®¾ç½®æ—¶é—´â€<br><span style="color: #008080;">28</span>         /&gt;<br><span style="color: #008080;">29</span><br><span style="color: #008080;">30</span> &lt;/LinearLayout&gt;</pre><br></div><br></div>

<p>ä»£ç ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('f6d9b226-be27-40a2-a3c2-424286c96fac')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_f6d9b226-be27-40a2-a3c2-424286c96fac" class="cnblogs_code_hide"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span> com.tiantian.test;<br><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span> java.util.Calendar;<br><span style="color: #008080;">  4</span><br><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span> android.app.Activity;<br><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span> android.app.DatePickerDialog;<br><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span> android.app.DatePickerDialog.OnDateSetListener;<br><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span> android.app.Dialog;<br><span style="color: #008080;">  9</span> <span style="color: #0000ff;">import</span> android.app.TimePickerDialog;<br><span style="color: #008080;"> 10</span> <span style="color: #0000ff;">import</span> android.app.TimePickerDialog.OnTimeSetListener;<br><span style="color: #008080;"> 11</span> <span style="color: #0000ff;">import</span> android.content.Intent;<br><span style="color: #008080;"> 12</span> <span style="color: #0000ff;">import</span> android.graphics.Bitmap;<br><span style="color: #008080;"> 13</span> <span style="color: #0000ff;">import</span> android.graphics.BitmapFactory;<br><span style="color: #008080;"> 14</span> <span style="color: #0000ff;">import</span> android.graphics.Matrix;<br><span style="color: #008080;"> 15</span> <span style="color: #0000ff;">import</span> android.net.Uri;<br><span style="color: #008080;"> 16</span> <span style="color: #0000ff;">import</span> android.os.Bundle;<br><span style="color: #008080;"> 17</span> <span style="color: #0000ff;">import</span> android.os.SystemClock;<br><span style="color: #008080;"> 18</span> <span style="color: #0000ff;">import</span> android.util.DisplayMetrics;<br><span style="color: #008080;"> 19</span> <span style="color: #0000ff;">import</span> android.view.View;<br><span style="color: #008080;"> 20</span> <span style="color: #0000ff;">import</span> android.view.View.OnClickListener;<br><span style="color: #008080;"> 21</span> <span style="color: #0000ff;">import</span> android.widget.Button;<br><span style="color: #008080;"> 22</span> <span style="color: #0000ff;">import</span> android.widget.Chronometer;<br><span style="color: #008080;"> 23</span> <span style="color: #0000ff;">import</span> android.widget.DatePicker;<br><span style="color: #008080;"> 24</span> <span style="color: #0000ff;">import</span> android.widget.DatePicker.OnDateChangedListener;<br><span style="color: #008080;"> 25</span> <span style="color: #0000ff;">import</span> android.widget.ImageView;<br><span style="color: #008080;"> 26</span> <span style="color: #0000ff;">import</span> android.widget.TextView;<br><span style="color: #008080;"> 27</span> <span style="color: #0000ff;">import</span> android.widget.TimePicker;<br><span style="color: #008080;"> 28</span> <span style="color: #0000ff;">import</span> android.widget.TimePicker.OnTimeChangedListener;<br><span style="color: #008080;"> 29</span> <span style="color: #0000ff;">import</span> android.widget.ZoomControls;<br><span style="color: #008080;"> 30</span><br><span style="color: #008080;"> 31</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TextAndridActivity <span style="color: #0000ff;">extends</span> Activity {<br><span style="color: #008080;"> 32</span>     <span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> Called when the activity is first created. </span><span style="color: #008000;">/</span><br><span style="color: #008080;"> 33</span>     <span style="color: #0000ff;">private</span> TextView dateText;<br><span style="color: #008080;"> 34</span>     <span style="color: #0000ff;">private</span> TextView timeText;<br><span style="color: #008080;"> 35</span>     <span style="color: #0000ff;">private</span> Button dateButton;<br><span style="color: #008080;"> 36</span>     <span style="color: #0000ff;">private</span> Button timeButton;<br><span style="color: #008080;"> 37</span><br><span style="color: #008080;"> 38</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> year;<br><span style="color: #008080;"> 39</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> monthOfYear;<br><span style="color: #008080;"> 40</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> dayOfMonth;<br><span style="color: #008080;"> 41</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> hour;<br><span style="color: #008080;"> 42</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> minute;<br><span style="color: #008080;"> 43</span>     <span style="color: #008000;">//</span><span style="color: #008000;">å£°æ˜ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ ‡è¯†ï¼Œæ¥ä½œä¸ºè¦æ˜¾ç¤ºDatePickerçš„Dialogçš„ID</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 44</span>     <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> DATE_DIALOG_ID = 1;<br><span style="color: #008080;"> 45</span>     <span style="color: #008000;">//</span><span style="color: #008000;">å£°æ˜ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ ‡è¯†ï¼Œæ¥ä½œä¸ºè¦æ˜¾ç¤ºTimePickerçš„Dialogçš„ID</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 46</span>     <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> TIME_DIALOG_ID = 2;<br><span style="color: #008080;"> 47</span>     @Override<br><span style="color: #008080;"> 48</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCreate(Bundle savedInstanceState) {<br><span style="color: #008080;"> 49</span>         <span style="color: #0000ff;">super</span>.onCreate(savedInstanceState);<br><span style="color: #008080;"> 50</span>         setContentView(R.layout.main);<br><span style="color: #008080;"> 51</span><br><span style="color: #008080;"> 52</span>         dateText = (TextView) findViewById(R.id.dateText);<br><span style="color: #008080;"> 53</span>         timeText = (TextView) findViewById(R.id.timeText);<br><span style="color: #008080;"> 54</span>         dateButton = (Button) findViewById(R.id.dateButton);<br><span style="color: #008080;"> 55</span>         dateButton.setOnClickListener(<span style="color: #0000ff;">new</span> OnClickListener() {<br><span style="color: #008080;"> 56</span><br><span style="color: #008080;"> 57</span>             @Override<br><span style="color: #008080;"> 58</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onClick(View v) {<br><span style="color: #008080;"> 59</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">è°ƒç”¨Activityç±»çš„æ–¹æ³•æ¥æ˜¾ç¤ºDialog:è°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šå…è®¸Activityç®¡ç†è¯¥Dialogçš„ç”Ÿå‘½å‘¨æœŸï¼Œ<br></span><span style="color: #008080;"> 60</span> <span style="color: #008000;">//</span><span style="color: #008000;">å¹¶ä¼šè°ƒç”¨ onCreateDialog(int)å›è°ƒå‡½æ•°æ¥è¯·æ±‚ä¸€ä¸ªDialog</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 61</span>                 showDialog(DATE_DIALOG_ID);<br><span style="color: #008080;"> 62</span>             }<br><span style="color: #008080;"> 63</span>         });<br><span style="color: #008080;"> 64</span>         timeButton = (Button) findViewById(R.id.timeButton);<br><span style="color: #008080;"> 65</span>         timeButton.setOnClickListener(<span style="color: #0000ff;">new</span> OnClickListener() {<br><span style="color: #008080;"> 66</span><br><span style="color: #008080;"> 67</span>             @Override<br><span style="color: #008080;"> 68</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onClick(View v) {<br><span style="color: #008080;"> 69</span>                 <span style="color: #008000;">//</span><span style="color: #008000;">è°ƒç”¨Activityç±»çš„æ–¹æ³•æ¥æ˜¾ç¤ºDialog:è°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šå…è®¸Activityç®¡ç†è¯¥Dialogçš„ç”Ÿå‘½å‘¨æœŸï¼Œ<br></span><span style="color: #008080;"> 70</span> <span style="color: #008000;">//</span><span style="color: #008000;">å¹¶ä¼šè°ƒç”¨ onCreateDialog(int)å›è°ƒå‡½æ•°æ¥è¯·æ±‚ä¸€ä¸ªDialog</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 71</span>                 showDialog(TIME_DIALOG_ID);<br><span style="color: #008080;"> 72</span>             }<br><span style="color: #008080;"> 73</span>         });<br><span style="color: #008080;"> 74</span>         <span style="color: #008000;">//</span><span style="color: #008000;">å¾—åˆ°å½“å‰æ—¥æœŸå’Œæ—¶é—´(ä½œä¸ºåˆå§‹å€¼)</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 75</span>         Calendar calendar = Calendar.getInstance();<br><span style="color: #008080;"> 76</span>         year = calendar.get(Calendar.YEAR);<br><span style="color: #008080;"> 77</span>         monthOfYear = calendar.get(Calendar.MONTH);<br><span style="color: #008080;"> 78</span>         dayOfMonth = calendar.get(Calendar.DAY_OF_MONTH);<br><span style="color: #008080;"> 79</span>         hour = calendar.get(Calendar.HOUR_OF_DAY);<br><span style="color: #008080;"> 80</span>         minute = calendar.get(Calendar.MINUTE);<br><span style="color: #008080;"> 81</span><br><span style="color: #008080;"> 82</span>     }<br><span style="color: #008080;"> 83</span><br><span style="color: #008080;"> 84</span>     <span style="color: #008000;">//</span><span style="color: #008000;">å½“Activityè°ƒç”¨showDialogå‡½æ•°æ—¶ä¼šè§¦å‘è¯¥å‡½æ•°çš„è°ƒç”¨ï¼š</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 85</span>     @Override<br><span style="color: #008080;"> 86</span>     <span style="color: #0000ff;">protected</span> Dialog onCreateDialog(<span style="color: #0000ff;">int</span> id) {<br><span style="color: #008080;"> 87</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 88</span>         <span style="color: #0000ff;">switch</span>(id){<br><span style="color: #008080;"> 89</span>         <span style="color: #0000ff;">case</span> DATE_DIALOG_ID:<br><span style="color: #008080;"> 90</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> DatePickerDialog(<span style="color: #0000ff;">this</span>, <span style="color: #0000ff;">new</span> OnDateSetListener() {<br><span style="color: #008080;"> 91</span><br><span style="color: #008080;"> 92</span>                 @Override<br><span style="color: #008080;"> 93</span>                 <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onDateSet(DatePicker view, <span style="color: #0000ff;">int</span> year, <span style="color: #0000ff;">int</span> monthOfYear,<br><span style="color: #008080;"> 94</span>                         <span style="color: #0000ff;">int</span> dayOfMonth) {<br><span style="color: #008080;"> 95</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 96</span>                     dateText.setText(year + â€œå¹´â€ + (monthOfYear + 1) + â€œæœˆâ€ + dayOfMonth + â€œæ—¥â€);<br><span style="color: #008080;"> 97</span>                 }<br><span style="color: #008080;"> 98</span>             }, year, monthOfYear, dayOfMonth);<br><span style="color: #008080;"> 99</span>         <span style="color: #0000ff;">case</span> TIME_DIALOG_ID:<br><span style="color: #008080;">100</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> TimePickerDialog(<span style="color: #0000ff;">this</span>, <span style="color: #0000ff;">new</span> OnTimeSetListener() {<br><span style="color: #008080;">101</span><br><span style="color: #008080;">102</span>                 @Override<br><span style="color: #008080;">103</span>                 <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onTimeSet(TimePicker view, <span style="color: #0000ff;">int</span> hourOfDay, <span style="color: #0000ff;">int</span> minute) {<br><span style="color: #008080;">104</span>                     <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">105</span>                     timeText.setText(hourOfDay + â€œæ—¶â€ + minute + â€œåˆ†â€);<br><span style="color: #008080;">106</span>                 }<br><span style="color: #008080;">107</span>             }, hour, minute, <span style="color: #0000ff;">true</span>);<br><span style="color: #008080;">108</span>         }<br><span style="color: #008080;">109</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span>;<br><span style="color: #008080;">110</span>     }<br><span style="color: #008080;">111</span><br><span style="color: #008080;">112</span><br><span style="color: #008080;">113</span><br><span style="color: #008080;">114</span> }</pre><br></div><br></div>

]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> DatePicker </tag>
            
            <tag> TimePicker </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidé€šè¿‡VideoViewå®ç°è§†é¢‘æ’­æ”¾]]></title>
      <url>/2012/03/01/Android%E9%80%9A%E8%BF%87VideoView%E5%AE%9E%E7%8E%B0%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE/</url>
      <content type="html"><![CDATA[<p>åœ¨Androidç³»ç»Ÿä¸­ï¼Œæ˜¯é€šè¿‡MediaPalyerç±»æ’­æ”¾åª’ä½“æ–‡ä»¶çš„ï¼ˆåŒ…æ‹¬è§†é¢‘å’ŒéŸ³é¢‘ï¼‰ã€‚è™½ç„¶è¿™ä¸ªç±»å·²ç»æ¯”è¾ƒç®€å•äº†ï¼Œä½†æ˜¯è¿˜éœ€è¦æ§åˆ¶å„ç§çŠ¶æ€ï¼Œå¯¹äºè§†é¢‘è¿˜éœ€è¦è®¾ç½®è¾“å‡ºçª—å£ï¼Œè¿˜æ˜¯éœ€è¦ä»”ç»†ç ”ç©¶çš„ã€‚ä¸ºäº†é¿å…è¿™äº›éº»çƒ¦äº‹å„¿ï¼ŒAndroidæ¡†æ¶æä¾›äº†VideoViewç±»æ¥å°è£…MediaPalyerï¼Œè¿™ä¸ªVideoViewç±»éå¸¸å¥½ç”¨ã€‚Androidè‡ªå¸¦çš„ç¨‹åºGalleryä¹Ÿæ˜¯ç”¨VideoViewå®ç°çš„ã€‚æœ¬æ–‡ä»¥å®ä¾‹ä»‹ç»æ€æ ·ç”¨VideoViewæ¥å®ç°VideoPlayerï¼Œæœ¬æ–‡ä¹Ÿå‚è€ƒäº†Androidè‡ªå¸¦ç¨‹åºGalleryçš„å®ç°ã€‚</p>
<p><span>åˆ›å»ºä¸€ä¸ªVideoPlayerçš„å·¥ç¨‹ã€‚main.xmlæ–‡ä»¶å¦‚ä¸‹ï¼š</span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 3</span> <span style="color: #ff0000;">    android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">    android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">    android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">VideoView </span><span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/video_viewâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 8</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 9</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€match_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">10</span> <span style="color: #ff0000;">            android:layout_centerInParent</span><span style="color: #0000ff;">=â€trueâ€</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">11</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

<p><span><span>VideoPlayer.javaæ–‡ä»¶å¦‚ä¸‹ï¼š</span></span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('2921b33f-64c6-4bde-a0dd-3a775ab970fa')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_2921b33f-64c6-4bde-a0dd-3a775ab970fa" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span> com.simon;<br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span> android.app.Activity;<br><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span> android.media.MediaPlayer;<br><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span> android.net.Uri;<br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span> android.os.Bundle;<br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span> android.os.Environment;<br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span> android.util.Log;<br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span> android.widget.MediaController;<br><span style="color: #008080;">10</span> <span style="color: #0000ff;">import</span> android.widget.VideoView;<br><span style="color: #008080;">11</span> <span style="color: #0000ff;">import</span> android.content.pm.ActivityInfo;<br><span style="color: #008080;">12</span><br><span style="color: #008080;">13</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> VideoPlayer <span style="color: #0000ff;">extends</span> Activity <span style="color: #0000ff;">implements</span> MediaPlayer.OnErrorListener,<br><span style="color: #008080;">14</span>         MediaPlayer.OnCompletionListener {<br><span style="color: #008080;">15</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = â€œVideoPlayerâ€;<br><span style="color: #008080;">16</span>     <span style="color: #0000ff;">private</span> VideoView mVideoView;<br><span style="color: #008080;">17</span>     <span style="color: #0000ff;">private</span> Uri mUri;<br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> mPositionWhenPaused = -1;<br><span style="color: #008080;">19</span><br><span style="color: #008080;">20</span>     <span style="color: #0000ff;">private</span> MediaController mMediaController;<br><span style="color: #008080;">21</span><br><span style="color: #008080;">22</span>     <span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> Called when the activity is first created. </span><span style="color: #008000;">/</span><br><span style="color: #008080;">23</span>     @Override<br><span style="color: #008080;">24</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCreate(Bundle savedInstanceState) {<br><span style="color: #008080;">25</span>         <span style="color: #0000ff;">super</span>.onCreate(savedInstanceState);<br><span style="color: #008080;">26</span><br><span style="color: #008080;">27</span>         setContentView(R.layout.main);<br><span style="color: #008080;">28</span><br><span style="color: #008080;">29</span>         <span style="color: #008000;">//</span><span style="color: #008000;">Set the screen to landscape.</span><span style="color: #008000;"><br></span><span style="color: #008080;">30</span>         <span style="color: #0000ff;">this</span>.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);<br><span style="color: #008080;">31</span><br><span style="color: #008080;">32</span>         mVideoView = (VideoView)findViewById(R.id.video_view);<br><span style="color: #008080;">33</span><br><span style="color: #008080;">34</span>         <span style="color: #008000;">//</span><span style="color: #008000;">Video file</span><span style="color: #008000;"><br></span><span style="color: #008080;">35</span>         mUri = Uri.parse(Environment.getExternalStorageDirectory() + â€œ/1.3gpâ€);<br><span style="color: #008080;">36</span><br><span style="color: #008080;">37</span>         <span style="color: #008000;">//</span><span style="color: #008000;">Create media controller</span><span style="color: #008000;"><br></span><span style="color: #008080;">38</span>         mMediaController = <span style="color: #0000ff;">new</span> MediaController(<span style="color: #0000ff;">this</span>);<br><span style="color: #008080;">39</span>         mVideoView.setMediaController(mMediaController);<br><span style="color: #008080;">40</span>     }<br><span style="color: #008080;">41</span><br><span style="color: #008080;">42</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onStart() {<br><span style="color: #008080;">43</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Play Video</span><span style="color: #008000;"><br></span><span style="color: #008080;">44</span>         mVideoView.setVideoURI(mUri);<br><span style="color: #008080;">45</span>         mVideoView.start();<br><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span>         <span style="color: #0000ff;">super</span>.onStart();<br><span style="color: #008080;">48</span>     }<br><span style="color: #008080;">49</span><br><span style="color: #008080;">50</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onPause() {<br><span style="color: #008080;">51</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Stop video when the activity is pause.</span><span style="color: #008000;"><br></span><span style="color: #008080;">52</span>         mPositionWhenPaused = mVideoView.getCurrentPosition();<br><span style="color: #008080;">53</span>         mVideoView.stopPlayback();<br><span style="color: #008080;">54</span>         Log.d(TAG, â€œOnStop: mPositionWhenPaused = â€œ + mPositionWhenPaused);<br><span style="color: #008080;">55</span>         Log.d(TAG, â€œOnStop: getDuration  = â€œ + mVideoView.getDuration());<br><span style="color: #008080;">56</span><br><span style="color: #008080;">57</span>         <span style="color: #0000ff;">super</span>.onPause();<br><span style="color: #008080;">58</span>     }<br><span style="color: #008080;">59</span><br><span style="color: #008080;">60</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onResume() {<br><span style="color: #008080;">61</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> Resume video player</span><span style="color: #008000;"><br></span><span style="color: #008080;">62</span>         <span style="color: #0000ff;">if</span>(mPositionWhenPaused &gt;= 0) {<br><span style="color: #008080;">63</span>             mVideoView.seekTo(mPositionWhenPaused);<br><span style="color: #008080;">64</span>             mPositionWhenPaused = -1;<br><span style="color: #008080;">65</span>         }<br><span style="color: #008080;">66</span><br><span style="color: #008080;">67</span>         <span style="color: #0000ff;">super</span>.onResume();<br><span style="color: #008080;">68</span>     }<br><span style="color: #008080;">69</span><br><span style="color: #008080;">70</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span> onError(MediaPlayer player, <span style="color: #0000ff;">int</span> arg1, <span style="color: #0000ff;">int</span> arg2) {<br><span style="color: #008080;">71</span>         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span>;<br><span style="color: #008080;">72</span>     }<br><span style="color: #008080;">73</span><br><span style="color: #008080;">74</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCompletion(MediaPlayer mp) {<br><span style="color: #008080;">75</span>         <span style="color: #0000ff;">this</span>.finish();<br><span style="color: #008080;">76</span>     }<br><span style="color: #008080;">77</span> }</pre><br></div><br></div>

<p><span><span><span>æœ¬ä¾‹ä¸­åªæ˜¯æ’­æ”¾å¤–å­˜å‚¨å™¨ï¼ˆä¸€èˆ¬æ˜¯sdå¡ï¼‰ä¸Šçš„1.3gpæ–‡ä»¶ã€‚åœ¨onCreateæ–¹æ³•ä¸­åˆ›å»ºäº†Media controlï¼Œè¿™ä¸ªç»„ä»¶å¯ä»¥æ§åˆ¶è§†é¢‘çš„æ’­æ”¾ï¼Œæš‚åœï¼Œå›å¤ï¼Œseekç­‰æ“ä½œï¼Œä¸éœ€è¦ä½ å®ç°ã€‚</span></span></span></p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">1</span> mMediaController = <span style="color: #0000ff;">new</span> MediaController(<span style="color: #0000ff;">this</span>);<br><span style="color: #008080;">2</span> mVideoView.setMediaController(mMediaController);</pre><br></div>

<p>ç„¶ååªéœ€è¦è°ƒç”¨VideoViewç±»çš„setVideoURIè®¾ç½®æ’­æ”¾æ–‡ä»¶ï¼Œstartæ–¹æ³•å¼€å§‹æ’­æ”¾å³å¯ã€‚ ä¸ºäº†èŠ‚çœç³»ç»Ÿèµ„æºï¼Œä¸€èˆ¬éœ€è¦åœ¨Activityçš„onPauseæ–¹æ³•ä¸­ï¼Œæš‚åœè§†é¢‘çš„æ’­æ”¾ã€‚å› ä¸ºActivityå·²ç»ä¸åœ¨å‰å°äº†ã€‚åœ¨Activityçš„onResumeä¸­æ¢å¤è§†é¢‘çš„æ’­æ”¾ï¼Œå› ä¸ºè¿™æ˜¯Activityåˆå˜æˆå‰å°ç¨‹åºäº†ã€‚ä¸æ¸…æ¥šçš„æœ‹å‹å¯ä»¥å»æŸ¥çœ‹Activity lifecycleã€‚ ä½ å¯ä»¥é€šè¿‡å®ç°MediaPlayer.OnErrorListeneræ¥ç›‘å¬MediaPlayerä¸ŠæŠ¥çš„é”™è¯¯ä¿¡æ¯ã€‚å®ç°MediaPlayer.OnCompletionListeneræ¥å£ï¼Œå°†ä¼šåœ¨Videoæ’­å®Œçš„æ—¶å€™å¾—åˆ°é€šçŸ¥ï¼Œæœ¬ä¾‹åªæ˜¯ç®€å•çš„ç»“æŸç¨‹åºã€‚ ä½ å¯èƒ½æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬æ²¡æœ‰ç®¡ç†MediaPalyerçš„å„ç§çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€éƒ½è®©VideoViewç»™å°è£…äº†ï¼Œå¹¶ä¸”ï¼Œå½“VideoViewåˆ›å»ºçš„æ—¶å€™ï¼ŒMediaPalyerå¯¹è±¡å°†ä¼šåˆ›å»ºï¼Œå½“VideoViewå¯¹è±¡é”€æ¯çš„æ—¶å€™ï¼ŒMediaPlayerå¯¹è±¡å°†ä¼šé‡Šæ”¾ã€‚è¿™æ ·åŸºæœ¬å¯ä»¥å‚»ç“œå¼çš„å®ç°åª’ä½“æ’­æ”¾å™¨äº†ï¼Œå¤ªEasyäº†å§ã€‚</p>
<p><span><br></span></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> VideoView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[androidé€šè¿‡BroadcastReceiveræ‹¦æˆªçŸ­ä¿¡è½¬å‘]]></title>
      <url>/2012/03/01/android%E9%80%9A%E8%BF%87BroadcastReceiver%E6%8B%A6%E6%88%AA%E7%9F%AD%E4%BF%A1%E8%BD%AC%E5%8F%91/</url>
      <content type="html"><![CDATA[<p>é€šè¿‡BroadcastReceiveræ‹¦æˆªçŸ­ä¿¡è½¬å‘ï¼ŒæŠ€æœ¯è®¨è®º å¤§å®¶ä¸è¦åšåäº‹å“¦</p>
<p>å…ˆçœ‹å¸ƒå±€ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('0e52c0a9-f753-4488-a738-51d5f1571488')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_0e52c0a9-f753-4488-a738-51d5f1571488" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 3</span> <span style="color: #ff0000;">    android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">    android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">    android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span> <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">EditText<br></span><span style="color: #008080;"> 8</span> <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/sendToIdâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 9</span> <span style="color: #ff0000;">        android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">10</span> <span style="color: #ff0000;">        android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">11</span> <span style="color: #ff0000;">        android:paddingLeft</span><span style="color: #0000ff;">=â€5dpâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">12</span> <span style="color: #ff0000;">        android:layout_marginLeft</span><span style="color: #0000ff;">=â€10dpâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">13</span> <span style="color: #ff0000;">        android:layout_marginRight</span><span style="color: #0000ff;">=â€10dpâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">14</span> <span style="color: #ff0000;">        android:layout_marginTop</span><span style="color: #0000ff;">=â€5dpâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">15</span> <span style="color: #ff0000;">        android:inputType</span><span style="color: #0000ff;">=â€phoneâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">16</span> <span style="color: #ff0000;">        android:hint</span><span style="color: #0000ff;">=â€å¡«å†™éœ€è¦è½¬å‘åˆ°çš„å·ç â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">17</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RelativeLayout<br></span><span style="color: #008080;">19</span> <span style="color: #ff0000;">android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">20</span> <span style="color: #ff0000;">        android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">21</span> <span style="color: #ff0000;">        android:orientation</span><span style="color: #0000ff;">=â€horizontalâ€</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">22</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">TextView<br></span><span style="color: #008080;">23</span> <span style="color: #ff0000;">android:layout_width</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">24</span> <span style="color: #ff0000;">                android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">25</span> <span style="color: #ff0000;">                android:layout_marginTop</span><span style="color: #0000ff;">=â€10dpâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">26</span> <span style="color: #ff0000;">                android:layout_marginLeft</span><span style="color: #0000ff;">=â€10dpâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">27</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€æ˜¯å¦å¼€å¯æœ¬æœºæ¥æ”¶:â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">28</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">29</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">ToggleButton<br></span><span style="color: #008080;">30</span> <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/togIdâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">31</span> <span style="color: #ff0000;">                android:layout_width</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">32</span> <span style="color: #ff0000;">                android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">33</span> <span style="color: #ff0000;">                android:layout_alignParentRight</span><span style="color: #0000ff;">=â€trueâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">34</span> <span style="color: #ff0000;">                android:layout_marginRight</span><span style="color: #0000ff;">=â€20dpâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">35</span> <span style="color: #ff0000;">                android:textOn</span><span style="color: #0000ff;">=â€ONâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">36</span> <span style="color: #ff0000;">                android:textOff</span><span style="color: #0000ff;">=â€OFFâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">37</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">38</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">RelativeLayout</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">39</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Button<br></span><span style="color: #008080;">40</span> <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/saveBtIdâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">41</span> <span style="color: #ff0000;">        android:layout_width</span><span style="color: #0000ff;">=â€100dpâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">42</span> <span style="color: #ff0000;">        android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">43</span> <span style="color: #ff0000;">        android:layout_gravity</span><span style="color: #0000ff;">=â€center_horizontalâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">44</span> <span style="color: #ff0000;">        android:text</span><span style="color: #0000ff;">=â€ç¡®å®šâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">45</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">46</span><br><span style="color: #008080;">47</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span></pre><br></div><br></div>

<p>ä¸»Activityï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('50ceaf4e-8e39-40b5-a1e8-7b6899c22f11')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_50ceaf4e-8e39-40b5-a1e8-7b6899c22f11" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span> tiantian.Package;<br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span> android.app.Activity;<br><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span> android.content.Intent;<br><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span> android.os.Bundle;<br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span> android.view.View;<br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span> android.widget.Button;<br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span> android.widget.CompoundButton;<br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span> android.widget.CompoundButton.OnCheckedChangeListener;<br><span style="color: #008080;">10</span> <span style="color: #0000ff;">import</span> android.widget.EditText;<br><span style="color: #008080;">11</span> <span style="color: #0000ff;">import</span> android.widget.Toast;<br><span style="color: #008080;">12</span> <span style="color: #0000ff;">import</span> android.widget.ToggleButton;<br><span style="color: #008080;">13</span><br><span style="color: #008080;">14</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> SMSReceiverActivity <span style="color: #0000ff;">extends</span> Activity {<br><span style="color: #008080;">15</span>     <span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> Called when the activity is first created. </span><span style="color: #008000;">/</span><br><span style="color: #008080;">16</span>     <span style="color: #0000ff;">private</span> EditText et;<br><span style="color: #008080;">17</span>     <span style="color: #0000ff;">private</span> Button saveBt;<br><span style="color: #008080;">18</span>     <span style="color: #0000ff;">private</span> ToggleButton toBt;<br><span style="color: #008080;">19</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">boolean</span> isChecked = <span style="color: #0000ff;">false</span>;<br><span style="color: #008080;">20</span>     @Override<br><span style="color: #008080;">21</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCreate(Bundle savedInstanceState) {<br><span style="color: #008080;">22</span>         <span style="color: #0000ff;">super</span>.onCreate(savedInstanceState);<br><span style="color: #008080;">23</span>         setContentView(R.layout.main);<br><span style="color: #008080;">24</span>         et = (EditText) findViewById(R.id.sendToId);<br><span style="color: #008080;">25</span>         toBt = (ToggleButton) findViewById(R.id.togId);<br><span style="color: #008080;">26</span>         toBt.setOnCheckedChangeListener(<span style="color: #0000ff;">new</span> OnCheckedChangeListener() {<br><span style="color: #008080;">27</span><br><span style="color: #008080;">28</span>             @Override<br><span style="color: #008080;">29</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCheckedChanged(CompoundButton buttonView, <span style="color: #0000ff;">boolean</span> isChecked) {<br><span style="color: #008080;">30</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">31</span>                 <span style="color: #0000ff;">if</span>(isChecked){<br><span style="color: #008080;">32</span>                     SMSReceiverActivity.<span style="color: #0000ff;">this</span>.isChecked = isChecked;<br><span style="color: #008080;">33</span>                 }<br><span style="color: #008080;">34</span>             }<br><span style="color: #008080;">35</span>         });<br><span style="color: #008080;">36</span>         saveBt = (Button) findViewById(R.id.saveBtId);<br><span style="color: #008080;">37</span>         saveBt.setOnClickListener(<span style="color: #0000ff;">new</span> View.OnClickListener() {<br><span style="color: #008080;">38</span><br><span style="color: #008080;">39</span>             @Override<br><span style="color: #008080;">40</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onClick(View v) {<br><span style="color: #008080;">41</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">42</span>                 Intent intent = <span style="color: #0000ff;">new</span> Intent();<br><span style="color: #008080;">43</span>                 intent.setAction(â€œcom.tiantian.SEND_TOâ€);<br><span style="color: #008080;">44</span>                 intent.putExtra(â€œ_sendToâ€, et.getText().toString());<br><span style="color: #008080;">45</span>                 intent.putExtra(â€œ_isCheckedâ€, isChecked);<br><span style="color: #008080;">46</span>                 sendBroadcast(intent);<br><span style="color: #008080;">47</span>                 Toast.makeText(SMSReceiverActivity.<span style="color: #0000ff;">this</span>, â€œå·²æˆåŠŸç»‘å®šâ€, Toast.LENGTH_SHORT).show();<br><span style="color: #008080;">48</span>             }<br><span style="color: #008080;">49</span>         });<br><span style="color: #008080;">50</span><br><span style="color: #008080;">51</span>     }<br><span style="color: #008080;">52</span><br><span style="color: #008080;">53</span><br><span style="color: #008080;">54</span> }</pre><br></div><br></div>

<p>&nbsp;</p>
<p>BroadcastReceiverç±»ç»§æ‰¿BroadcastReceiverï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('3532e2e5-486d-456b-b0c5-8f3218d89fcf')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_3532e2e5-486d-456b-b0c5-8f3218d89fcf" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span> tiantian.Package;<br><span style="color: #008080;"> 2</span><br><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span> java.sql.Date;<br><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span> java.text.SimpleDateFormat;<br><span style="color: #008080;"> 5</span><br><span style="color: #008080;"> 6</span> <span style="color: #0000ff;">import</span> android.content.BroadcastReceiver;<br><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">import</span> android.content.Context;<br><span style="color: #008080;"> 8</span> <span style="color: #0000ff;">import</span> android.content.Intent;<br><span style="color: #008080;"> 9</span> <span style="color: #0000ff;">import</span> android.telephony.SmsManager;<br><span style="color: #008080;">10</span> <span style="color: #0000ff;">import</span> android.telephony.SmsMessage;<br><span style="color: #008080;">11</span><br><span style="color: #008080;">12</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> SMSReceiverSend <span style="color: #0000ff;">extends</span> BroadcastReceiver{<br><span style="color: #008080;">13</span>     <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String SMS_ACTION = â€œandroid.provider.Telephony.SMS_RECEIVEDâ€;<br><span style="color: #008080;">14</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> String sendToNum = â€œ1234â€;<br><span style="color: #008080;">15</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">boolean</span> isChecked = <span style="color: #0000ff;">false</span>;<br><span style="color: #008080;">16</span>     @Override<br><span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onReceive(Context content, Intent intent) {<br><span style="color: #008080;">18</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">19</span>         <span style="color: #0000ff;">if</span>(intent.getAction().equals(â€œcom.tiantian.SEND_TOâ€)){<br><span style="color: #008080;">20</span>             sendToNum = intent.getStringExtra(â€œ_sendToâ€);<br><span style="color: #008080;">21</span>             isChecked = intent.getBooleanExtra(â€œ_isCheckedâ€, isChecked);<br><span style="color: #008080;">22</span>         }<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span>(intent.getAction().equals(SMS_ACTION)){<br><span style="color: #008080;">23</span><br><span style="color: #008080;">24</span>         Object[] pdus = (Object[])intent.getExtras().get(â€œpdusâ€);<br><span style="color: #008080;">25</span>         <span style="color: #0000ff;">if</span>(pdus != <span style="color: #0000ff;">null</span> &amp;&amp; pdus.length != 0){<br><span style="color: #008080;">26</span>             SmsMessage[] messages = <span style="color: #0000ff;">new</span> SmsMessage[pdus.length];<br><span style="color: #008080;">27</span>             <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i=0;i&lt;pdus.length;i++){<br><span style="color: #008080;">28</span>                 <span style="color: #0000ff;">byte</span>[] pdu = (<span style="color: #0000ff;">byte</span>[])pdus[i];<br><span style="color: #008080;">29</span>                 messages[i] = SmsMessage.createFromPdu(pdu);<br><span style="color: #008080;">30</span>             }<br><span style="color: #008080;">31</span>             <span style="color: #0000ff;">for</span>(SmsMessage message : messages){<br><span style="color: #008080;">32</span>                 String messageBody = message.getMessageBody();<br><span style="color: #008080;">33</span>                 String sender = message.getOriginatingAddress();<br><span style="color: #008080;">34</span>                 <span style="color: #0000ff;">if</span>(isChecked == <span style="color: #0000ff;">false</span>){<br><span style="color: #008080;">35</span>                     abortBroadcast();<span style="color: #008000;">//</span><span style="color: #008000;"> ä¸­æ­¢å‘é€</span><span style="color: #008000;"><br></span><span style="color: #008080;">36</span>                 }<br><span style="color: #008080;">37</span>                     Date date = <span style="color: #0000ff;">new</span> Date(message.getTimestampMillis());<br><span style="color: #008080;">38</span>                     SimpleDateFormat format = <span style="color: #0000ff;">new</span> SimpleDateFormat(â€œyyyy-MM-dd HH:mm:ssâ€);<br><span style="color: #008080;">39</span>                     String sendContent = â€œdate:â€ + format.format(date) + â€œ\nâ€<br><span style="color: #008080;">40</span>                             + â€œsender:â€ + sender + â€œ\nâ€ + â€œmessageBody:â€  + messageBody;<br><span style="color: #008080;">41</span>                     SmsManager smsManager = SmsManager.getDefault();<br><span style="color: #008080;">42</span>                     smsManager.sendTextMessage(sendToNum, <span style="color: #0000ff;">null</span>, sendContent, <span style="color: #0000ff;">null</span>, <span style="color: #0000ff;">null</span>);<br><span style="color: #008080;">43</span>             }<br><span style="color: #008080;">44</span>         }<br><span style="color: #008080;">45</span><br><span style="color: #008080;">46</span>     }<br><span style="color: #008080;">47</span>     }<br><span style="color: #008080;">48</span><br><span style="color: #008080;">49</span> }</pre><br></div><br></div>

<p>&nbsp;</p>
<p>AndroidManifest.xml:</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('c79663a9-77ae-40ba-ab43-4c3a21ccaf22')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt=""><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt=""><span class="cnblogs_code_collapse">View Code </span><br><div id="cnblogs_code_open_c79663a9-77ae-40ba-ab43-4c3a21ccaf22" class="cnblogs_code_hide"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">manifest </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 3</span> <span style="color: #ff0000;">    package</span><span style="color: #0000ff;">=â€tiantian.Packageâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">    android:versionCode</span><span style="color: #0000ff;">=â€1â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">    android:versionName</span><span style="color: #0000ff;">=â€1.0â€</span> <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 6</span><br><span style="color: #008080;"> 7</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">uses-sdk </span><span style="color: #ff0000;">android:minSdkVersion</span><span style="color: #0000ff;">=â€8â€</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;"> 8</span><br><span style="color: #008080;"> 9</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">application<br></span><span style="color: #008080;">10</span> <span style="color: #ff0000;">android:icon</span><span style="color: #0000ff;">=â€@drawable/ic_launcherâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">11</span> <span style="color: #ff0000;">        android:label</span><span style="color: #0000ff;">=â€@string/app_nameâ€</span> <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">12</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">activity<br></span><span style="color: #008080;">13</span> <span style="color: #ff0000;">android:label</span><span style="color: #0000ff;">=â€@string/app_nameâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">14</span> <span style="color: #ff0000;">            android:name</span><span style="color: #0000ff;">=â€.SMSReceiverActivityâ€</span> <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">15</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">intent-filter </span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">16</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">action </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">=â€android.intent.action.MAINâ€</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">category </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">=â€android.intent.category.LAUNCHERâ€</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">19</span>             <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">intent-filter</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">20</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">activity</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">21</span><br><span style="color: #008080;">22</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">receiver </span><span style="color: #ff0000;">android:label</span><span style="color: #0000ff;">=â€@string/app_nameâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">23</span> <span style="color: #ff0000;">                  android:name</span><span style="color: #0000ff;">=â€.SMSReceiverSendâ€</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">24</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">intent-filter </span><span style="color: #ff0000;">android:priority</span><span style="color: #0000ff;">=â€1000â€</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">25</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">action </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">=â€android.provider.Telephony.SMS_RECEIVEDâ€</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">26</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">action </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">=â€com.tiantian.SEND_TOâ€</span><span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">27</span>                 <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">category </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">=â€android.intent.category.DEFAULTâ€</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">28</span>             <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">intent-filter</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">29</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">receiver</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">30</span><br><span style="color: #008080;">31</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">application</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">32</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">uses-permission </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">=â€android.permission.RECEIVE_SMSâ€</span><span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">33</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">uses-permission </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">=â€android.permission.SEND_SMSâ€</span><span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">34</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">uses-permission </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">=â€android.permission.RECEIVE_BOOT_COMPLETEDâ€</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">35</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">manifest</span><span style="color: #0000ff;">&gt;</span></pre><br></div><br></div>

]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> BroadcastReceiver </tag>
            
            <tag> SMS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç”¨RadioGroupæ¥è‡ªå®šä¹‰TabHost+Galleryåº”ç”¨]]></title>
      <url>/2012/02/24/%E7%94%A8RadioGroup%E6%9D%A5%E8%87%AA%E5%AE%9A%E4%B9%89TabHost-Gallery%E5%BA%94%E7%94%A8/</url>
      <content type="html"><![CDATA[<p><strong>æ•ˆæœå›¾ï¼š</strong></p>
<p><img src="http://pic002.cnblogs.com/images/2012/378300/2012022410541464.jpg" alt=""></p>
<p>&nbsp;</p>
<p><strong>æ€è·¯ï¼š**</strong>ç”¨RadioGroupæ¥è‡ªå®šä¹‰Tabï¼ˆå½“ç„¶ç”¨å…¶ä»–çš„ImageButtonç­‰ä¹Ÿå¯ä»¥å®ç°ï¼‰**</p>
<p>mainActivityä»£ç ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span> com.tiantian.test;<br><span style="color: #008080;">  2</span><br><span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span> android.app.TabActivity;<br><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span> android.content.Context;<br><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span> android.content.Intent;<br><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span> android.content.res.TypedArray;<br><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span> android.os.Bundle;<br><span style="color: #008080;">  8</span> <span style="color: #0000ff;">import</span> android.os.Handler;<br><span style="color: #008080;">  9</span> <span style="color: #0000ff;">import</span> android.os.Message;<br><span style="color: #008080;"> 10</span> <span style="color: #0000ff;">import</span> android.view.View;<br><span style="color: #008080;"> 11</span> <span style="color: #0000ff;">import</span> android.view.ViewGroup;<br><span style="color: #008080;"> 12</span> <span style="color: #0000ff;">import</span> android.widget.BaseAdapter;<br><span style="color: #008080;"> 13</span> <span style="color: #0000ff;">import</span> android.widget.Gallery;<br><span style="color: #008080;"> 14</span> <span style="color: #0000ff;">import</span> android.widget.ImageView;<br><span style="color: #008080;"> 15</span> <span style="color: #0000ff;">import</span> android.widget.RadioButton;<br><span style="color: #008080;"> 16</span> <span style="color: #0000ff;">import</span> android.widget.RadioGroup;<br><span style="color: #008080;"> 17</span> <span style="color: #0000ff;">import</span> android.widget.TabHost;<br><span style="color: #008080;"> 18</span><br><span style="color: #008080;"> 19</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TabDemoActivity <span style="color: #0000ff;">extends</span> TabActivity {<br><span style="color: #008080;"> 20</span>     <span style="color: #008000;">/<em>*</em></span><span style="color: #008000;"> Called when the activity is first created. </span><span style="color: #008000;">/</span><br><span style="color: #008080;"> 21</span>     TabHost tab;<br><span style="color: #008080;"> 22</span>     RadioGroup tab_radioGroup;<br><span style="color: #008080;"> 23</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span>[] images = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">int</span>[]{<br><span style="color: #008080;"> 24</span>             R.drawable.g1,R.drawable.g2,R.drawable.g3,<br><span style="color: #008080;"> 25</span>             R.drawable.g4,R.drawable.g5,R.drawable.g6<br><span style="color: #008080;"> 26</span>     };<br><span style="color: #008080;"> 27</span>     @Override<br><span style="color: #008080;"> 28</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCreate(Bundle savedInstanceState) {<br><span style="color: #008080;"> 29</span>         <span style="color: #0000ff;">super</span>.onCreate(savedInstanceState);<br><span style="color: #008080;"> 30</span>         setContentView(R.layout.main);<br><span style="color: #008080;"> 31</span>         Gallery gallery = (Gallery)findViewById(R.id.gallery);<br><span style="color: #008080;"> 32</span>         gallery.setAdapter(<span style="color: #0000ff;">new</span> ImageAdapter(<span style="color: #0000ff;">this</span>));<br><span style="color: #008080;"> 33</span><br><span style="color: #008080;"> 34</span>         tab = getTabHost();<br><span style="color: #008080;"> 35</span>         tab.addTab(tab.newTabSpec(â€œSpec-TabListâ€)<br><span style="color: #008080;"> 36</span>                 .setIndicator(â€œInd-TabListâ€)<br><span style="color: #008080;"> 37</span>                 .setContent(<span style="color: #0000ff;">new</span> Intent(<span style="color: #0000ff;">this</span>, TabList.<span style="color: #0000ff;">class</span>)));<br><span style="color: #008080;"> 38</span>         tab.addTab(tab.newTabSpec(â€œSpec-secondDemoâ€)<br><span style="color: #008080;"> 39</span>                 .setIndicator(â€œInd-secondDemoâ€)<br><span style="color: #008080;"> 40</span>                 .setContent(<span style="color: #0000ff;">new</span> Intent(<span style="color: #0000ff;">this</span>, secondDemo.<span style="color: #0000ff;">class</span>)));<br><span style="color: #008080;"> 41</span>         tab.addTab(tab.newTabSpec(â€œSpec-thirdDemoâ€)<br><span style="color: #008080;"> 42</span>                 .setIndicator(â€œInd-thirdDemoâ€)<br><span style="color: #008080;"> 43</span>                 .setContent(<span style="color: #0000ff;">new</span> Intent(<span style="color: #0000ff;">this</span>, thirdDemo.<span style="color: #0000ff;">class</span>)));<br><span style="color: #008080;"> 44</span>         tab.addTab(tab.newTabSpec(â€œSpec-fourthDemoâ€)<br><span style="color: #008080;"> 45</span>                 .setIndicator(â€œInd-fourthDemoâ€)<br><span style="color: #008080;"> 46</span>                 .setContent(<span style="color: #0000ff;">new</span> Intent(<span style="color: #0000ff;">this</span>, fourthDemo.<span style="color: #0000ff;">class</span>)));<br><span style="color: #008080;"> 47</span>         tab.addTab(tab.newTabSpec(â€œSpec-fifthDemoâ€)<br><span style="color: #008080;"> 48</span>                 .setIndicator(â€œInd-fifthDemoâ€)<br><span style="color: #008080;"> 49</span>                 .setContent(<span style="color: #0000ff;">new</span> Intent(<span style="color: #0000ff;">this</span>, fifthDemo.<span style="color: #0000ff;">class</span>)));<br><span style="color: #008080;"> 50</span><br><span style="color: #008080;"> 51</span>         tab_radioGroup = (RadioGroup)findViewById(R.id.tab_radiogroup);<br><span style="color: #008080;"> 52</span>         tab_radioGroup.setOnCheckedChangeListener(<span style="color: #0000ff;">new</span> RadioGroup.OnCheckedChangeListener() {<br><span style="color: #008080;"> 53</span><br><span style="color: #008080;"> 54</span>             @Override<br><span style="color: #008080;"> 55</span>             <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> onCheckedChanged(RadioGroup group, <span style="color: #0000ff;">int</span> checkedId) {<br><span style="color: #008080;"> 56</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 57</span>                 <span style="color: #0000ff;">switch</span>(checkedId){<br><span style="color: #008080;"> 58</span>                 <span style="color: #0000ff;">case</span> R.id.radioButton0:<br><span style="color: #008080;"> 59</span>                     tab.setCurrentTabByTag(â€œSpec-TabListâ€);<br><span style="color: #008080;"> 60</span>                     <span style="color: #0000ff;">break</span>;<br><span style="color: #008080;"> 61</span>                 <span style="color: #0000ff;">case</span> R.id.radioButton1:<br><span style="color: #008080;"> 62</span>                     tab.setCurrentTabByTag(â€œSpec-secondDemoâ€);<br><span style="color: #008080;"> 63</span>                     <span style="color: #0000ff;">break</span>;<br><span style="color: #008080;"> 64</span>                 <span style="color: #0000ff;">case</span> R.id.radioButton2:<br><span style="color: #008080;"> 65</span>                     tab.setCurrentTabByTag(â€œSpec-thirdDemoâ€);<br><span style="color: #008080;"> 66</span>                     <span style="color: #0000ff;">break</span>;<br><span style="color: #008080;"> 67</span>                 <span style="color: #0000ff;">case</span> R.id.radioButton3:<br><span style="color: #008080;"> 68</span>                     tab.setCurrentTabByTag(â€œSpec-fourthDemoâ€);<br><span style="color: #008080;"> 69</span>                     <span style="color: #0000ff;">break</span>;<br><span style="color: #008080;"> 70</span>                 <span style="color: #0000ff;">case</span> R.id.radioButton4:<br><span style="color: #008080;"> 71</span>                     tab.setCurrentTabByTag(â€œSpec-fifthDemoâ€);<br><span style="color: #008080;"> 72</span>                     <span style="color: #0000ff;">break</span>;<br><span style="color: #008080;"> 73</span>                 }<br><span style="color: #008080;"> 74</span>             }<br><span style="color: #008080;"> 75</span>         });<br><span style="color: #008080;"> 76</span>         <span style="color: #008000;">//</span><span style="color: #008000;">ä½¿ä»–åˆå§‹åŒ–åèšç„¦åœ¨ç¬¬ä¸€ä¸ªRadioGroupå¯¹è±¡</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 77</span>         ((RadioButton) tab_radioGroup.getChildAt(0)).toggle();<br><span style="color: #008080;"> 78</span><br><span style="color: #008080;"> 79</span>     }<br><span style="color: #008080;"> 80</span><br><span style="color: #008080;"> 81</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> ImageAdapter <span style="color: #0000ff;">extends</span> BaseAdapter{<br><span style="color: #008080;"> 82</span>         <span style="color: #0000ff;">private</span> Context context;<br><span style="color: #008080;"> 83</span> <span style="color: #008000;">//</span><span style="color: #008000;">        private int[] images = new int[]{<br></span><span style="color: #008080;"> 84</span> <span style="color: #008000;">//</span><span style="color: #008000;">                R.drawable.g1,R.drawable.g2,R.drawable.g3,<br></span><span style="color: #008080;"> 85</span> <span style="color: #008000;">//</span><span style="color: #008000;">                R.drawable.g4,R.drawable.g5,R.drawable.g6<br></span><span style="color: #008080;"> 86</span> <span style="color: #008000;">//</span><span style="color: #008000;">        };</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 87</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span> mGalleryItemBackground;<br><span style="color: #008080;"> 88</span>         <span style="color: #0000ff;">public</span> ImageAdapter(Context context) {<br><span style="color: #008080;"> 89</span>             <span style="color: #0000ff;">super</span>();<br><span style="color: #008080;"> 90</span>             <span style="color: #0000ff;">this</span>.context = context;<br><span style="color: #008080;"> 91</span>             TypedArray a = obtainStyledAttributes(R.styleable.Gallery);<br><span style="color: #008080;"> 92</span>             mGalleryItemBackground = a.getResourceId(R.styleable.Gallery_android_galleryItemBackground, 0);<br><span style="color: #008080;"> 93</span>             a.recycle();<br><span style="color: #008080;"> 94</span>         }<br><span style="color: #008080;"> 95</span><br><span style="color: #008080;"> 96</span>         @Override<br><span style="color: #008080;"> 97</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> getCount() {<br><span style="color: #008080;"> 98</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;"> 99</span>             <span style="color: #0000ff;">return</span> images.length;<br><span style="color: #008080;">100</span>         }<br><span style="color: #008080;">101</span><br><span style="color: #008080;">102</span>         @Override<br><span style="color: #008080;">103</span>         <span style="color: #0000ff;">public</span> Object getItem(<span style="color: #0000ff;">int</span> arg0) {<br><span style="color: #008080;">104</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">105</span>             <span style="color: #0000ff;">return</span> images[arg0];<br><span style="color: #008080;">106</span>         }<br><span style="color: #008080;">107</span><br><span style="color: #008080;">108</span>         @Override<br><span style="color: #008080;">109</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">long</span> getItemId(<span style="color: #0000ff;">int</span> position) {<br><span style="color: #008080;">110</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">111</span>             <span style="color: #0000ff;">return</span> position;<br><span style="color: #008080;">112</span>         }<br><span style="color: #008080;">113</span><br><span style="color: #008080;">114</span>         @Override<br><span style="color: #008080;">115</span>         <span style="color: #0000ff;">public</span> View getView(<span style="color: #0000ff;">int</span> position, View convertView, ViewGroup parent) {<br><span style="color: #008080;">116</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> TODO Auto-generated method stub</span><span style="color: #008000;"><br></span><span style="color: #008080;">117</span>             ImageView image = <span style="color: #0000ff;">new</span> ImageView(context);<br><span style="color: #008080;">118</span>             image.setImageResource(images[position]);<br><span style="color: #008080;">119</span>             image.setScaleType(ImageView.ScaleType.FIT_XY);<br><span style="color: #008080;">120</span>             image.setLayoutParams(<span style="color: #0000ff;">new</span> Gallery.LayoutParams(120, 100));<br><span style="color: #008080;">121</span>             image.setBackgroundResource(mGalleryItemBackground);<br><span style="color: #008080;">122</span>             <span style="color: #0000ff;">return</span> image;<br><span style="color: #008080;">123</span>         }<br><span style="color: #008080;">124</span><br><span style="color: #008080;">125</span>     }<br><span style="color: #008080;">126</span><br><span style="color: #008080;">127</span> }</pre><br></div>

<p>å¯¹åº”çš„å¸ƒå±€æ–‡ä»¶ï¼š</p>
<div class="cnblogs_code"><br><pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version=â€1.0â€ encoding=â€utf-8â€</span><span style="color: #0000ff;">?&gt;</span><br><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">TabHost<br></span><span style="color: #008080;"> 3</span> ã€€ã€€ã€€<span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@android:id/tabhostâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 4</span> <span style="color: #ff0000;">    android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 5</span> <span style="color: #ff0000;">    android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;"> 6</span> <span style="color: #ff0000;">    xmlns:android</span><span style="color: #0000ff;">=â€<a href="http://schemas.android.com/apk/res/android" target="_blank" rel="noopener">http://schemas.android.com/apk/res/android</a>â€œ</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;"> 7</span><br><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout<br></span><span style="color: #008080;"> 9ã€€ã€€ã€€</span> <span style="color: #ff0000;">android:orientation</span><span style="color: #0000ff;">=â€verticalâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">10</span> <span style="color: #ff0000;">    android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">11</span> <span style="color: #ff0000;">    android:layout_height</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">12</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Gallery<br></span><span style="color: #008080;">13</span> ã€€ã€€ã€€ã€€ã€€ã€€<span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/galleryâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">14</span> <span style="color: #ff0000;">        android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">15</span> <span style="color: #ff0000;">        android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">16</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">17</span><br><span style="color: #008080;">18</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">TabWidget<br></span><span style="color: #008080;">19ã€€ã€€ã€€ã€€</span> <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@android:id/tabsâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">20</span> <span style="color: #ff0000;">        android:visibility</span><span style="color: #0000ff;">=â€goneâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">21</span> <span style="color: #ff0000;">        android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">22</span> <span style="color: #ff0000;">        android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">23</span> <span style="color: #ff0000;">        android:layout_weight</span><span style="color: #0000ff;">=â€0.0â€</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">24</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">FrameLayout<br></span><span style="color: #008080;">25</span> ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@android:id/tabcontentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">26</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">27</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€0.0dpâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">28</span> <span style="color: #ff0000;">            android:layout_weight</span><span style="color: #0000ff;">=â€1.0â€</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">29</span><br><span style="color: #008080;">30</span>         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioGroup<br></span><span style="color: #008080;">31</span> ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/tab_radiogroupâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">32</span> <span style="color: #ff0000;">            android:orientation</span><span style="color: #0000ff;">=â€horizontalâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">33</span> <span style="color: #ff0000;">            android:background</span><span style="color: #0000ff;">=â€@drawable/tab_widget_backgroundâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">34</span> <span style="color: #ff0000;">            android:layout_width</span><span style="color: #0000ff;">=â€fill_parentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">35</span> <span style="color: #ff0000;">            android:layout_height</span><span style="color: #0000ff;">=â€wrap_contentâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">36</span> <span style="color: #ff0000;">            android:padding</span><span style="color: #0000ff;">=â€2dpâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">37</span> <span style="color: #ff0000;">            android:gravity</span><span style="color: #0000ff;">=â€center_verticalâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">38</span> <span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">39</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;">40</span> ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/radioButton0â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">41</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€è¯„åˆ†â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">42</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/tab_icon1â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">43</span> <span style="color: #ff0000;">                style</span><span style="color: #0000ff;">=â€@style/tab_item_backgroundâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">44</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">45</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;">46ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</span> <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/radioButton1â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">47</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€ç´«è‰²â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">48</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/tab_icon2â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">49</span> <span style="color: #ff0000;">                style</span><span style="color: #0000ff;">=â€@style/tab_item_backgroundâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">50</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">51</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;">52</span> ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/radioButton2â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">53</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€çº¢è‰²â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">54</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/tab_icon3â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">55</span> <span style="color: #ff0000;">                style</span><span style="color: #0000ff;">=â€@style/tab_item_backgroundâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">56</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">57</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;">58ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€</span> <span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/radioButton3â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">59</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€è“è‰²â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">60</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/tab_icon4â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">61</span> <span style="color: #ff0000;">                style</span><span style="color: #0000ff;">=â€@style/tab_item_backgroundâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">62</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">63</span>             <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">RadioButton<br></span><span style="color: #008080;">64</span> ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<span style="color: #ff0000;">android:id</span><span style="color: #0000ff;">=â€@+id/radioButton4â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">65</span> <span style="color: #ff0000;">                android:text</span><span style="color: #0000ff;">=â€ç»¿è‰²â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">66</span> <span style="color: #ff0000;">                android:drawableTop</span><span style="color: #0000ff;">=â€@drawable/tab_icon5â€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">67</span> <span style="color: #ff0000;">                style</span><span style="color: #0000ff;">=â€@style/tab_item_backgroundâ€</span><span style="color: #ff0000;"><br></span><span style="color: #008080;">68</span> <span style="color: #0000ff;">/&gt;</span><br><span style="color: #008080;">69</span>         <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">RadioGroup</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">70</span><br><span style="color: #008080;">71</span>     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span><br><span style="color: #008080;">72</span><br><span style="color: #008080;">73</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">TabHost</span><span style="color: #0000ff;">&gt;</span></pre><br></div>

]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> RadioGroup </tag>
            
            <tag> TabHost </tag>
            
            <tag> Gallery </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Activityçš„å››ç§åŠ è½½æ¨¡å¼]]></title>
      <url>/2012/02/24/Activity%E7%9A%84%E5%9B%9B%E7%A7%8D%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<p>1ã€standard ï¼šç³»ç»Ÿçš„é»˜è®¤æ¨¡å¼ï¼Œä¸€æ¬¡è·³è½¬å³ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚å‡è®¾æœ‰ä¸€ä¸ªactivityå‘½åä¸ºAct1ï¼Œæ‰§è¡Œè¯­å¥ï¼š<br> startActivity(new Intent(Act1.this, Act1.class));<br>åAct1å°†è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªAct1ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨çš„æ ˆé‡Œé¢æœ‰ Act1 çš„ä¸¤ä¸ªå®ä¾‹ã€‚æŒ‰è¿”å›é”®åä½ ä¼šå‘ç°ä»ç„¶æ˜¯åœ¨Act1ï¼ˆç¬¬ä¸€ä¸ªï¼‰é‡Œé¢ã€‚</p>
<p>2ã€singleTopï¼šsingleTop è·Ÿstandard æ¨¡å¼æ¯”è¾ƒç±»ä¼¼ã€‚å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ï¼Œå½“è·³è½¬çš„å¯¹è±¡æ˜¯ä½äºæ ˆé¡¶çš„activityï¼ˆåº”è¯¥å¯ä»¥ç†è§£ä¸ºç”¨æˆ·çœ¼å‰æ‰€ çœ‹åˆ°çš„activityï¼‰æ—¶ï¼Œç¨‹åºå°†ä¸ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„activityå®ä¾‹ï¼Œè€Œæ˜¯ç›´æ¥è·³åˆ°ç°å­˜äºæ ˆé¡¶çš„é‚£ä¸ªactivityå®ä¾‹ã€‚æ‹¿ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œå½“Act1 ä¸º singleTop æ¨¡å¼æ—¶ï¼Œæ‰§è¡Œè·³è½¬åæ ˆé‡Œé¢ä¾æ—§åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¦‚æœç°åœ¨æŒ‰è¿”å›é”®ç¨‹åºå°†ç›´æ¥é€€å‡ºã€‚è¿™ä¸ªè²Œä¼¼ç”¨å¾—æ¯”è¾ƒå°‘ã€‚</p>
<p>3ã€singleTaskï¼š singleTaskæ¨¡å¼å’Œåé¢çš„singleInstanceæ¨¡å¼éƒ½æ˜¯åªåˆ›å»ºä¸€ä¸ªå®ä¾‹çš„ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ— è®ºè·³è½¬çš„å¯¹è±¡æ˜¯ä¸æ˜¯ä½äºæ ˆé¡¶çš„activityï¼Œç¨‹åºéƒ½ä¸ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å®ä¾‹ï¼ˆå½“ç„¶å‰ææ˜¯æ ˆé‡Œé¢å·²ç»æœ‰è¿™ä¸ªå®ä¾‹ï¼‰ã€‚è¿™ç§æ¨¡å¼ç›¸å½“æœ‰ç”¨ï¼Œåœ¨ä»¥åçš„å¤šactivityå¼€å‘ä¸­ï¼Œ ç»å¸¸ä¼šå› ä¸ºè·³è½¬çš„å…³ç³»å¯¼è‡´åŒä¸ªé¡µé¢ç”Ÿæˆå¤šä¸ªå®ä¾‹ï¼Œè¿™ä¸ªåœ¨ç”¨æˆ·ä½“éªŒä¸Šå§‹ç»ˆæœ‰ç‚¹ä¸å¥½ï¼Œè€Œå¦‚æœä½ å°†å¯¹åº”çš„activityå£°æ˜ä¸º singleTask æ¨¡å¼ï¼Œè¿™ç§é—®é¢˜å°†ä¸å¤å­˜åœ¨ã€‚ä¸è¿‡å‰é˜µå­å¥½åƒåˆçœ‹è¿‡æœ‰äººè¯´ä¸€èˆ¬ä¸è¦å°†é™¤å¼€å§‹é¡µé¢çš„å…¶ä»–é¡µé¢è®¾ç½®ä¸º singleTask æ¨¡å¼ï¼ŒåŸå› æš‚æ—¶ä¸æ˜ï¼Œå“ªä½çŸ¥é“çš„å¯ä»¥è¯·æ•™ä¸‹ã€‚</p>
<p>4ã€singleInstance: è®¾ç½®ä¸º singleInstance æ¨¡å¼çš„ activity å°†ç‹¬å ä¸€ä¸ªtaskï¼ˆæ„Ÿè§‰taskå¯ä»¥ç†è§£ä¸ºè¿›ç¨‹ï¼‰ï¼Œç‹¬å ä¸€ä¸ªtaskçš„activityä¸å…¶è¯´æ˜¯activityï¼Œå€’ä¸å¦‚è¯´æ˜¯ä¸€ä¸ªåº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨ä¸å…¶ä»–activityæ˜¯ç‹¬ç«‹çš„ï¼Œå®ƒæœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡activityã€‚æ‹¿ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜å§ï¼š<br>ç°åœ¨æœ‰ä»¥ä¸‹ä¸‰ä¸ªactivity: Act1ã€Act2ã€Act3ï¼Œå…¶ä¸­Acti2 ä¸º singleInstance æ¨¡å¼ã€‚å®ƒä»¬ä¹‹é—´çš„è·³è½¬å…³ç³»ä¸ºï¼š Act1 â€“ Act2 â€“ Act3 ï¼Œç°åœ¨åœ¨Act3ä¸­æŒ‰ä¸‹è¿”å›é”®ï¼Œç”±äºAct2ä½äºä¸€ä¸ªç‹¬ç«‹çš„taskä¸­ï¼Œå®ƒä¸å±äºAct3çš„ä¸Šä¸‹æ–‡activityï¼Œæ‰€ä»¥æ­¤æ—¶å°†ç›´æ¥è¿”å›åˆ°Act1ã€‚è¿™å°±æ˜¯singleInstanceæ¨¡å¼ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> activity </tag>
            
            <tag> launch mode </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
