<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#ffffff">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#ffffff">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#ffffff">


    <meta name="description" content="领域对象转换库 RapidOOO v1.1.5 注意：之前的版本弃用  RapidOOO Github: https://github.com/wangjiegulu/RapidOOO 什么是 RapidOOO我们在领域驱动设计中经常会在不同层级之间传递数据，例如 VO, PO, DO, DTO, BO等。Android 的开发中也经常会遇到这些情况，比如在 Android-CleanArchit">
<meta name="keywords" content="android,annotations,javabean,pojo,domain-driven-design,apt,javapoet,annotation processor,pojo converter">
<meta property="og:type" content="article">
<meta property="og:title" content="领域对象转换库 RapidOOO v1.1.5">
<meta property="og:url" content="https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/index.html">
<meta property="og:site_name" content="Wang Jie&#39;s Blog|Software Engineer|Android|Java|Kotlin ❤|github|Huginn|Geek|code|developer|programer">
<meta property="og:description" content="领域对象转换库 RapidOOO v1.1.5 注意：之前的版本弃用  RapidOOO Github: https://github.com/wangjiegulu/RapidOOO 什么是 RapidOOO我们在领域驱动设计中经常会在不同层级之间传递数据，例如 VO, PO, DO, DTO, BO等。Android 的开发中也经常会遇到这些情况，比如在 Android-CleanArchit">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-07-02T11:53:46.312Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="领域对象转换库 RapidOOO v1.1.5">
<meta name="twitter:description" content="领域对象转换库 RapidOOO v1.1.5 注意：之前的版本弃用  RapidOOO Github: https://github.com/wangjiegulu/RapidOOO 什么是 RapidOOO我们在领域驱动设计中经常会在不同层级之间传递数据，例如 VO, PO, DO, DTO, BO等。Android 的开发中也经常会遇到这些情况，比如在 Android-CleanArchit">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>领域对象转换库 RapidOOO v1.1.5</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3">
    
      <div id="header-post-nav">
  <span id="nav">
      <ul>
         
          <li><b><a href="/">Home</a></b></li>
         
          <li><b><a href="/archives/">Writing</a></b></li>
         
          <li><b><a href="/tags/">Tags</a></b></li>
         
          <li><b><a href="/about/">About</a></b></li>
         
          <li><b><a href="/feed.xml">RSS</a></b></li>
        
      </ul>
  </span>
</div>

<div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/feed.xml">RSS</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2019/05/31/huginn_automatic_backup/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&text=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&title=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&is_video=false&description=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=领域对象转换库 RapidOOO v1.1.5&body=Check out this article: https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&title=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&title=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&title=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&title=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&name=领域对象转换库 RapidOOO v1.1.5&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#领域对象转换库-RapidOOO-v1-1-5"><span class="toc-number">1.</span> <span class="toc-text">领域对象转换库 RapidOOO v1.1.5</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#什么是-RapidOOO"><span class="toc-number">1.1.</span> <span class="toc-text">什么是 RapidOOO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#怎么使用"><span class="toc-number">1.2.</span> <span class="toc-text">怎么使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本使用"><span class="toc-number">1.2.1.</span> <span class="toc-text">基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注解配置自动生成"><span class="toc-number">1.2.2.</span> <span class="toc-text">注解配置自动生成</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#OOOs-注解"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">@OOOs 注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OOO-注解"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">@OOO 注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OOOConversion-注解"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">OOOConversion 注解</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#转换方法自动生成"><span class="toc-number">1.2.3.</span> <span class="toc-text">转换方法自动生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#id-类型表达式"><span class="toc-number">1.2.4.</span> <span class="toc-text">id 类型表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#链式转换"><span class="toc-number">1.2.5.</span> <span class="toc-text">链式转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#继承"><span class="toc-number">1.2.6.</span> <span class="toc-text">继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#支持的接口"><span class="toc-number">1.2.7.</span> <span class="toc-text">支持的接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Serializable"><span class="toc-number">1.2.7.1.</span> <span class="toc-text">Serializable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Parcelable"><span class="toc-number">1.2.7.2.</span> <span class="toc-text">Parcelable</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#包含排除字段"><span class="toc-number">1.2.8.</span> <span class="toc-text">包含排除字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字段模式-Field-Mode"><span class="toc-number">1.2.9.</span> <span class="toc-text">字段模式 Field Mode</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#字段增加"><span class="toc-number">1.2.9.1.</span> <span class="toc-text">字段增加</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字段连接-Attach-Mode"><span class="toc-number">1.2.9.2.</span> <span class="toc-text">字段连接 Attach Mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字段转换-逆转换-Conversion-Mode"><span class="toc-number">1.2.9.3.</span> <span class="toc-text">字段转换 / 逆转换 Conversion Mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字段绑定-逆绑定-Bind-Mode"><span class="toc-number">1.2.9.4.</span> <span class="toc-text">字段绑定 / 逆绑定 Bind Mode</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#对象池"><span class="toc-number">1.2.10.</span> <span class="toc-text">对象池</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#复杂类型"><span class="toc-number">1.2.11.</span> <span class="toc-text">复杂类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Array"><span class="toc-number">1.2.11.1.</span> <span class="toc-text">Array</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#List"><span class="toc-number">1.2.11.2.</span> <span class="toc-text">List</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Map"><span class="toc-number">1.2.11.3.</span> <span class="toc-text">Map</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#控制委托-Control-Delegate"><span class="toc-number">1.2.12.</span> <span class="toc-text">控制委托 Control Delegate</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#OOOLazyControlDelegate"><span class="toc-number">1.2.12.1.</span> <span class="toc-text">OOOLazyControlDelegate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自定义-ControlDelegate"><span class="toc-number">1.2.12.2.</span> <span class="toc-text">自定义 ControlDelegate</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        领域对象转换库 RapidOOO v1.1.5
    </h1>



    <div class="meta"  style="margin-top:12px;">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name" style="margin-left: 12px">Wang Jie</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-07-02T11:47:25.855Z" itemprop="datePublished">2019-07-02</time>
    </div>

<br/>
      
    <div class="article-tag">
        <i class="fas fa-tag" style="margin-top: 20px"></i>
        <a class="tag-link" href="/tags/android/">android</a>, <a class="tag-link" href="/tags/annotation-processor/">annotation processor</a>, <a class="tag-link" href="/tags/annotations/">annotations</a>, <a class="tag-link" href="/tags/apt/">apt</a>, <a class="tag-link" href="/tags/domain-driven-design/">domain-driven-design</a>, <a class="tag-link" href="/tags/javabean/">javabean</a>, <a class="tag-link" href="/tags/javapoet/">javapoet</a>, <a class="tag-link" href="/tags/pojo/">pojo</a>, <a class="tag-link" href="/tags/pojo-converter/">pojo converter</a>
    </div>


    </div>
  </header>
  

  
  <div class="content" itemprop="articleBody">
    
    
      <!-- <img class="header-img" src="https://images.unsplash.com/photo-1516062423079-7ca13cdc7f5a?ixlib=rb-0.3.5&amp;s=8f6373676ada5dcf363a679d5a81a2a2&amp;auto=format&amp;fit=crop&amp;w=1361&amp;q=80" /> -->
      

        <img src="https://images.unsplash.com/photo-1516062423079-7ca13cdc7f5a?ixlib=rb-0.3.5&amp;s=8f6373676ada5dcf363a679d5a81a2a2&amp;auto=format&amp;fit=crop&amp;w=1361&amp;q=80" style="border-radius: 3px;"/>
        
      
      
    


    <div class="md-content">
      <h1 id="领域对象转换库-RapidOOO-v1-1-5"><a href="#领域对象转换库-RapidOOO-v1-1-5" class="headerlink" title="领域对象转换库 RapidOOO v1.1.5"></a>领域对象转换库 RapidOOO v1.1.5</h1><blockquote>
<p><strong>注意</strong>：<a href="https://blog.wangjiegulu.com/2018/04/16/rapidooo-android-pojo-converter/">之前的版本</a>弃用</p>
</blockquote>
<p><strong>RapidOOO Github</strong>: <a href="https://github.com/wangjiegulu/RapidOOO" target="_blank" rel="noopener">https://github.com/wangjiegulu/RapidOOO</a></p>
<h2 id="什么是-RapidOOO"><a href="#什么是-RapidOOO" class="headerlink" title="什么是 RapidOOO"></a>什么是 RapidOOO</h2><p>我们在领域驱动设计中经常会在不同层级之间传递数据，例如 <code>VO</code>, <code>PO</code>, <code>DO</code>, <code>DTO</code>, <code>BO</code>等。Android 的开发中也经常会遇到这些情况，比如在 <a href="https://github.com/android10/Android-CleanArchitecture" target="_blank" rel="noopener">Android-CleanArchitecture</a> 的 <a href="https://github.com/android10/Android-CleanArchitecture/blob/master/presentation/src/main/java/com/fernandocejas/android10/sample/presentation/mapper/UserModelDataMapper.java#L42" target="_blank" rel="noopener">UserModelDataMapper::transform</a>, <a href="https://github.com/android10/Android-CleanArchitecture/blob/master/data/src/main/java/com/fernandocejas/android10/sample/data/entity/mapper/UserEntityDataMapper.java#L42" target="_blank" rel="noopener">UserEntityDataMapper::transform</a> 等。手工地进行拷贝转换的过程不但繁琐，而且错误的风险比较大，在新增、删除字段时也增加了维护的成本。<a href="http://dozer.sourceforge.net/documentation/about.html" target="_blank" rel="noopener">Dozer</a> 可以很好地解决这个问题，但是在 Android 上可能就不太适用了。</p>
<p><code>RapidOOO</code> 根据 POJO 类编译时灵活地自动生成支持扩展互相绑定的领域对象。</p>
<h2 id="怎么使用"><a href="#怎么使用" class="headerlink" title="怎么使用"></a>怎么使用</h2><p>在 <code>build.gradle</code> 中配置依赖 <code>RapidOOO</code>：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">"com.github.wangjiegulu:rapidooo-api:x.x.x"</span></span><br><span class="line">annotationProcessor <span class="string">"com.github.wangjiegulu:rapidooo-compiler:x.x.x"</span></span><br></pre></td></tr></table></figure>
<p>注意：</p>
<ul>
<li><code>x.x.x</code> 为版本号，<a href="https://search.maven.org/search?q=rapidooo" target="_blank" rel="noopener">最新版本点这里检查</a>。</li>
</ul>
<h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>存在 <code>Person</code> 类如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String country;</span><br><span class="line">    <span class="comment">// getter / setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要自动生成 <code>PersonBO</code> 类，则创建 <code>Generator</code> 类并进行如下配置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"BO"</span>,</span><br><span class="line">        ooos = &#123;</span><br><span class="line">            <span class="meta">@OOO</span>(from = Person.class),</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoBOGenerator</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>注意：</p>
<ul>
<li><code>Generator</code> 类的类名可以任意。</li>
</ul>
<p>构建之后，将会生成如下 <code>PersonBO</code> 与 <code>Person</code> 一样的类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonBO</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> String country;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">PersonBO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fromPerson</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = person.getName();</span><br><span class="line">    <span class="keyword">this</span>.country = person.getCountry();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> PersonBO <span class="title">create</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">    PersonBO personBO = <span class="keyword">new</span> PersonBO();</span><br><span class="line">    personBO.fromPerson(person);</span><br><span class="line">    <span class="keyword">return</span> personBO;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toPerson</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">    person.setName(name);</span><br><span class="line">    person.setCountry(country);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Person <span class="title">toPerson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Person person = <span class="keyword">new</span> Person();</span><br><span class="line">    toPerson(person);</span><br><span class="line">    <span class="keyword">return</span> person;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="注解配置自动生成"><a href="#注解配置自动生成" class="headerlink" title="注解配置自动生成"></a>注解配置自动生成</h3><blockquote>
<p>假设：通过 <code>UserBO</code> 类自动生成 <code>UserVO</code> 类，则：</p>
<ul>
<li><code>UserBO</code> 称为：<strong>源类</strong></li>
<li><code>UserVO</code> 称为：<strong>目标类</strong></li>
</ul>
</blockquote>
<p>首先要创建 <code>Generator</code> 类，然后在该类上增加注解配置，该类表示 <strong>一次</strong> 自动生成转换，<strong>一次</strong> 自动生成转换中可以生成 <strong>多个</strong> 领域类。</p>
<p>重要的注解配置如下：</p>
<h4 id="OOOs-注解"><a href="#OOOs-注解" class="headerlink" title="@OOOs 注解"></a><code>@OOOs</code> 注解</h4><blockquote>
<p><code>@OOOs</code> 用于指定该次自动生成转换的所有配置。</p>
</blockquote>
<ul>
<li><strong>fromSuffix</strong>：<code>目标类</code> 后缀，比如从 <code>UserBO</code> 自动生成 <code>UserVO</code>，则 <code>fromSuffix</code> 为 <code>UserBO</code> 的后缀：<code>BO</code>。如果 <code>源类</code> 没有后缀，则不填。</li>
<li><strong>suffix</strong>：<code>目标类</code> 后缀，比如从 <code>UserBO</code> 自动生成 <code>UserVO</code>，则 <code>suffix</code> 为 <code>UserVO</code> 的后缀：<code>VO</code>。</li>
<li><strong>ooosPackages</strong>：<code>源类</code> 所在的包数组，<code>RapidOOO</code> 将会把这些包中的类都会进行自动生成。</li>
<li><strong>ooos</strong>：<code>@OOO</code> 注解数组，<code>目标类</code> 的自定义配置（后面会讲到）。</li>
</ul>
<h4 id="OOO-注解"><a href="#OOO-注解" class="headerlink" title="@OOO 注解"></a><code>@OOO</code> 注解</h4><blockquote>
<p><code>@OOOs</code> 用于指定 <code>目标类</code> 的自定义配置。</p>
</blockquote>
<ul>
<li><strong>id</strong>：该 <code>目标类</code> 的id，id 必须以 <code>#</code> 号开头。</li>
<li><strong>fromSuffix</strong>：同 <code>@OOOs</code> 中的 <code>fromSuffix</code>，此优先级高。</li>
<li><strong>suffix</strong>：同 <code>@OOOs</code> 中的 <code>suffix</code>，此优先级高。</li>
<li><strong>from</strong>：指定 <code>源类</code> 的 <code>Class</code>。</li>
<li><strong>includes</strong>：指定该 <code>目标类</code> 包含哪些字段（Field），不能与 <code>excludes</code> 同时使用。</li>
<li><strong>excludes</strong>：指定该 <code>目标类</code> 不包含哪些字段（Field），不能与 <code>includes</code> 同时使用。</li>
<li><strong>targetSupperType</strong>：指定该 <code>目标类</code> 的父类的 Class。</li>
<li><strong>targetSupperTypeId</strong>：指定该 <code>目标类</code> 的父类的 id 表达式，id 必须以 <code>#</code> 号开头。</li>
<li><strong>pool</strong>：针对该 <code>目标类</code> 类的对象池相关配置（后面会讲到）。</li>
<li><strong>parcelable</strong>：配置该 <code>目标类</code> 类是否实现 <code>Parcelable</code> 接口（前提是 <code>源类</code> 是实现了 <code>Parcelable</code> 接口）。</li>
<li><strong>conversions</strong>：<code>@OOOConversion</code> 数组，表示该 <code>目标类</code> 中需要进行特殊转换的字段配置（后面会讲到）。</li>
</ul>
<h4 id="OOOConversion-注解"><a href="#OOOConversion-注解" class="headerlink" title="OOOConversion 注解"></a><code>OOOConversion</code> 注解</h4><blockquote>
<p><code>@OOOs</code> 用于指定 <code>目标类</code> 中某个字段的自定义配置。</p>
</blockquote>
<ul>
<li><strong>targetFieldName</strong>：该字段的名字。</li>
<li><strong>targetFieldType</strong>：指定该字段的 Class。</li>
<li><strong>targetFieldTypeId</strong>：指定该字段的 id 表达式。</li>
<li><strong>attachFieldName</strong>：表示字段模式（后面会讲到）为 <code>attach</code>，指定与 <code>源类</code> 的哪个字段 attach。</li>
<li><strong>bindMethodClass</strong>：表示字段模式（后面会讲到）为 <code>bind</code>，指定绑定转换的方法所在的类（后面会讲到）。</li>
<li><strong>bindMethodName</strong>：表示字段模式（后面会讲到）为 <code>bind</code>，指定绑定转换的方法（后面会讲到）。</li>
<li><strong>inverseBindMethodName</strong>：表示字段模式（后面会讲到）为 <code>bind</code>，指定绑定逆转换的方法（后面会讲到）。</li>
<li><strong>conversionMethodClass</strong>：表示字段模式（后面会讲到）为 <code>conversion</code>，指定转换的方法所在的类（后面会讲到）。</li>
<li><strong>conversionMethodName</strong>：表示字段模式（后面会讲到）为 <code>conversion</code>，指定转换的方法（后面会讲到）。</li>
<li><strong>inverseConversionMethodName</strong>：表示字段模式（后面会讲到）为 <code>conversion</code>，指定逆转换的方法（后面会讲到）。</li>
<li><strong>parcelable</strong>：是否可以实现 <code>parcelable</code> 接口。</li>
<li><strong>controlDelegate</strong>：配置该字段的控制委托（后面会讲到）。</li>
</ul>
<h3 id="转换方法自动生成"><a href="#转换方法自动生成" class="headerlink" title="转换方法自动生成"></a>转换方法自动生成</h3><p>通过注解配置，在构建后会自动生成如下两个方法：</p>
<ul>
<li><strong>create() static 方法</strong>：<code>源类</code> 转为 <code>目标类</code>，如：<code>UserVO userVO = UserVO.create(userBO)</code></li>
<li><strong>toXxx() 成员方法</strong>：<code>目标类</code> 转为 <code>源类</code>，如：<code>userVO.toUserBO()</code>。</li>
</ul>
<h3 id="id-类型表达式"><a href="#id-类型表达式" class="headerlink" title="id 类型表达式"></a>id 类型表达式</h3><blockquote>
<p>通过字符串来表示类型（包括 <code>id</code>）。</p>
</blockquote>
<ul>
<li>≈ 的 <code>id</code> 必须以 <code>#</code> 号开头。</li>
<li>在 <code>targetFieldTypeId</code> 等字段中可以使用 id 表达式来表达复杂类型（后面会提到）。</li>
</ul>
<h3 id="链式转换"><a href="#链式转换" class="headerlink" title="链式转换"></a>链式转换</h3><p>通过配置支持链式的自动生成：从 <code>Person</code> 生成 <code>PersonBO</code>，从 <code>PersonBO</code> 生成 <code>PersonVO</code>…</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成 PersonBO</span></span><br><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"BO"</span>, ooos = &#123;<span class="meta">@OOO</span>(from = Person.class)&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoBOGenerator</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成 PersonVO</span></span><br><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"VO"</span>, fromSuffix = <span class="string">"BO"</span>, ooos = &#123;<span class="meta">@OOO</span>(from = PersonBO.class)&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoVOGenerator</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>如果 <code>Abbey</code> 类继承了 <code>Person</code> 类，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Abbey</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以通过以下配置来生成 <code>AbbeyBO</code> 类，并且继承同样是生成的 <code>PersonBO</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"BO"</span>,</span><br><span class="line">        ooos = &#123;</span><br><span class="line">                <span class="meta">@OOO</span>(id = <span class="string">"#id_bo_person"</span>, from = Person.class),</span><br><span class="line">                <span class="meta">@OOO</span>(from = Abbey.class, targetSupperTypeId = <span class="string">"#id_bo_person"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExtBOGenerator</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>先配置 <code>Person</code> 类，然后设置它的 <code>id</code>（任意字符，但是必须是 <code>#</code> 开头），如 <code>#id_bo_person</code>（此配置会生成 <code>PersonBO</code> 类）</li>
<li>然后配置 <code>Abbey</code> 类，设置 <code>targetSupperTypeId</code> 为 <code>#id_bo_person</code>（为 <code>Abbey</code> 类设置父类）</li>
</ul>
<p>最终生成如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AbbeyBO</span> <span class="keyword">extends</span> <span class="title">PersonBO</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="支持的接口"><a href="#支持的接口" class="headerlink" title="支持的接口"></a>支持的接口</h3><p>默认情况下，<code>源类</code> 实现的接口不会在生成的 <code>目标类</code> 中自动也去实现。</p>
<p>但是以下两个接口<strong>除外</strong>：</p>
<h4 id="Serializable"><a href="#Serializable" class="headerlink" title="Serializable"></a>Serializable</h4><p>如果 <code>源类</code> 实现了 <code>Serializable</code> 接口，在生成的 <code>目标类</code> 中也会自动默认实现该接口。如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 源类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 generator</span></span><br><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"BO"</span>, ooos = &#123;<span class="meta">@OOO</span>(from = User.class)&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BOGenerator</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 目标类（RapidOOO 自动生成）</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserBO</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Parcelable"><a href="#Parcelable" class="headerlink" title="Parcelable"></a>Parcelable</h4><p>如果 <code>源类</code> 实现了 <code>Parcelable</code> 接口，在生成的 <code>目标类</code> 中也会自动默认实现该接口（包括自动生成 <code>构造方法</code>、<code>CREATOR</code>、<code>writeToParcel()</code>、<code>describeContents</code> 等）。如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 源类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Message</span> <span class="keyword">implements</span> <span class="title">Parcelable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Creator&lt;Message&gt; CREATOR = <span class="keyword">new</span> Creator&lt;Message&gt;() &#123; ... &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">Message</span><span class="params">(Parcel in)</span> </span>&#123; ... &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">describeContents</span><span class="params">()</span> </span>&#123; ... &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeToParcel</span><span class="params">(Parcel dest, <span class="keyword">int</span> flags)</span></span>&#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 generator</span></span><br><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"BO"</span>, ooos = &#123;<span class="meta">@OOO</span>(from = Message.class)&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BOGenerator</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 目标类（RapidOOO 自动生成）</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageBO</span> <span class="keyword">implements</span> <span class="title">Parcelable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Creator&lt;MessageBO&gt; CREATOR = <span class="keyword">new</span> Creator&lt;MessageBO&gt;() &#123; ... &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">MessageBO</span><span class="params">(Parcel in)</span> </span>&#123; ... &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">describeContents</span><span class="params">()</span> </span>&#123; ... &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeToParcel</span><span class="params">(Parcel dest, <span class="keyword">int</span> flags)</span></span>&#123; ... &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是你可以通过 <code>@OOO</code> 注解中的 <code>parcelable</code> 设置为 <code>false</code> 来禁用所有字段不进行序列化。</p>
<p>如果你只需要生成类中的某个字段不进行 parcelable 序列化，可以通过 <code>@OOOConversion</code> 注解中的 <code>parcelable</code> 设置为 <code>false</code> 来禁用它。</p>
<h3 id="包含排除字段"><a href="#包含排除字段" class="headerlink" title="包含排除字段"></a>包含排除字段</h3><p>可以通过 <code>@OOO</code> 中的 <code>include</code> 和 <code>excludes</code> 两个属性来指定 <code>源类</code> 中的哪些字段 <strong>需要/不需要</strong> 生成在 <code>目标类</code> 中。如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"BO"</span>, ooos = &#123;</span><br><span class="line">        <span class="meta">@OOO</span>(from = Message.class, excludes = &#123;<span class="string">"chat"</span>, <span class="string">"text"</span>&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BOGenerator</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>以上，在生成的 <code>MessageBO</code> 中不会包含来自 <code>Message</code> 的 <code>chat</code> 和 <code>text</code> 两个字段。</p>
<p><code>includes</code> 的使用方式也是一样。</p>
<p><strong>注意：</strong></p>
<blockquote>
<ul>
<li><code>includes</code> 和 <code>excludes</code> 如果都没有设置，则默认为 <code>源类</code> 中的所有字段 <strong>都会</strong> 生成在 <code>目标类</code> 中。</li>
<li><code>includes</code> 和 <code>excludes</code> 不能同时使用，否则编译会报错。</li>
</ul>
</blockquote>
<h3 id="字段模式-Field-Mode"><a href="#字段模式-Field-Mode" class="headerlink" title="字段模式 Field Mode"></a>字段模式 Field Mode</h3><p>可以在 <code>@OOO</code> 注解中通过 <code>@OOOConversion</code> 注解来对每个 <code>目标类</code> 中的每个字段通过不同的 <code>字段模式（Field Mode）</code> 来进行配置。</p>
<p>具体的配置方式如下：</p>
<h4 id="字段增加"><a href="#字段增加" class="headerlink" title="字段增加"></a>字段增加</h4><p>在 <code>源类</code> 生成 <code>目标类</code> 时，可以在 <code>目标类</code> 中增加一些 <code>源类</code> 中不存在的字段，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// `源类`</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Message</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="comment">// getter / setter</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 generator</span></span><br><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"BO"</span>,</span><br><span class="line">    ooos = &#123;</span><br><span class="line">        <span class="meta">@OOO</span>(from = Message.class,</span><br><span class="line">            conversions = &#123;</span><br><span class="line">                    <span class="meta">@OOOConversion</span>(</span><br><span class="line">                            targetFieldName = <span class="string">"read"</span>,</span><br><span class="line">                            targetFieldType = <span class="keyword">boolean</span>.class</span><br><span class="line">                    )</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoBOGenerator</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// `目标类`</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Message</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> read;</span><br><span class="line">    <span class="comment">// getter / setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上通过 <code>@OOOConversion</code> 注解增加了一个字段名为 <code>read</code>、类型为 <code>boolean</code> 的字段，并生成了 <code>getter/setter</code> 方法。</p>
<blockquote>
<p><strong>注意</strong>：这个 <code>read</code> 字段与 <code>Message</code> 类中的任何字段都没有任何关系。</p>
</blockquote>
<h4 id="字段连接-Attach-Mode"><a href="#字段连接-Attach-Mode" class="headerlink" title="字段连接 Attach Mode"></a>字段连接 Attach Mode</h4><p>如果我需要在 <code>目标类</code> 增加一个字段，并且把这个字段与 <code>源类</code> 中的相似类型的字段 <strong>连接</strong> 起来。</p>
<p>或者说用新的字段替换掉 <code>源类</code> 的相似类型的字段，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// `源类`</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Message</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="comment">// getter / setter</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 generator</span></span><br><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"BO"</span>,</span><br><span class="line">    ooos = &#123;</span><br><span class="line">        <span class="meta">@OOO</span>(from = Message.class,</span><br><span class="line">            <span class="comment">// 排除掉源类中的 content 字段</span></span><br><span class="line">            excludes = &#123;<span class="string">"content"</span>&#125;,</span><br><span class="line">            conversions = &#123;</span><br><span class="line">                    <span class="meta">@OOOConversion</span>(</span><br><span class="line">                            targetFieldName = <span class="string">"text"</span>,</span><br><span class="line">                            targetFieldType = String.class,</span><br><span class="line">                            <span class="comment">// 使用 attach 模式把 `text` 字段关联到 `content` 字段</span></span><br><span class="line">                            attachFieldName = <span class="string">"content"</span></span><br><span class="line">                    )</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoBOGenerator</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// `目标类`</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Message</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="comment">// 源类中的 content 被替换成了目标中的 text 字段</span></span><br><span class="line">    <span class="keyword">private</span> String text;</span><br><span class="line">    <span class="comment">// getter / setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上注释：首先通过 <code>excludes</code> 排除掉要被关联的 <code>content</code> 字段，然后再用 <code>@OOOConversion</code> 注解配置新的 <code>text</code> 字段，并通过 <code>attachFieldName</code> 连接到 <code>源类</code> 的 <code>content</code> 字段。</p>
<p>最终的结果是，<code>目标类</code> 中的 <code>content</code> 被替换成了 <code>text</code>。</p>
<p><strong>那怎么体现了 <code>连接</code> 这个特点呢？</strong></p>
<p>如果是 <strong>连接（attach）</strong> 模式，则 <code>目标类</code> 中还会在某些方法中生成以下代码来确保新增字段与原来的字段是处于<strong>连接状态</strong>的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageBO</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MessageBO <span class="title">create</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">        MessageBO messageBO = <span class="keyword">new</span> MessageBO();</span><br><span class="line">        messageBO.fromMessage(message);</span><br><span class="line">        <span class="keyword">return</span> messageBO;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fromMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="comment">// 在 Message 类型转 MessageBO 类型时，这里 MessageBO 的 text 被赋值为 Message 的 content</span></span><br><span class="line">        <span class="keyword">this</span>.text = message.getContent();</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Message <span class="title">toMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Message message = <span class="keyword">new</span> Message();</span><br><span class="line">        toMessage(message);</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toMessage</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="comment">// 在 MessageBO 类型转 Message 类型时，这里 Message 的 content 被赋值为 MessageBO 的 text</span></span><br><span class="line">        message.setContent(<span class="keyword">this</span>.text);</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由此，<code>Message</code> 中的 <code>content</code> 与 <code>MessageBO</code> 中的 <code>text</code> 字段达成了连接，于是如下单元测试通过：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> String CONTENT = <span class="string">"message content"</span>;</span><br><span class="line"><span class="comment">// 构建一个 Message 对象</span></span><br><span class="line">Message message = <span class="keyword">new</span> Message();</span><br><span class="line">message.setContent(CONTENT);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从 Message 对象转换成一个新的 MessageBO</span></span><br><span class="line">MessageBO messageBO = MessageBO.create(message);</span><br><span class="line">Assert.assertEquals(CONTENT, messageBO.getText());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过 MessageBO 对象转换成一个新的 Message 对象</span></span><br><span class="line">Message newMessage = messageBO.toMessage();</span><br><span class="line">Assert.assertEquals(CONTENT, newMessage.getContent());</span><br></pre></td></tr></table></figure>
<p>以上的例子是 <code>源类</code> <code>Message</code> 的 <code>content</code> 与 <code>目标类</code> <code>MessageBO</code> 的 <code>text</code> 之间的连接，两者都是同一种类型： <code>String</code>。</p>
<p>除了支持<strong>同一种</strong>类型的连接之外，其实还支持以下的类型的连接：</p>
<table>
<thead>
<tr>
<th>序号</th>
<th>源类字段</th>
<th>目标类字段</th>
<th>举例（源 -&gt; 目标）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1)</td>
<td>某种任意类型</td>
<td>某种相同的任意类型</td>
<td><code>FooBar</code> <br> -&gt; <br> <code>FooBar</code></td>
</tr>
<tr>
<td>2)</td>
<td>某种 <code>Map</code> 类型</td>
<td>另一种相同或不同的 <code>Map</code> 类型（泛型相同）</td>
<td><code>HashMap</code> <br> -&gt; <br> <code>LinkedHashMap</code></td>
</tr>
<tr>
<td>3)</td>
<td>某种 <code>List</code> 类型</td>
<td>另一种相同或不同的 <code>List</code> 类型（泛型相同）</td>
<td><code>ArrayList</code> <br> -&gt; <br> <code>LinkedList</code></td>
</tr>
<tr>
<td>4)</td>
<td>某种数组类型</td>
<td>数组类型</td>
<td><code>Foo[]</code> <br> -&gt; <br> <code>Foo[]</code></td>
</tr>
<tr>
<td>5)</td>
<td>某种其它源类型</td>
<td>某种其它目标类型</td>
<td><code>Chat</code> <br> -&gt; <br> <code>ChatBO</code></td>
</tr>
<tr>
<td>6)</td>
<td>序号<code>2)``3)``4)</code>与<code>5)</code>的组合</td>
<td>序号<code>2)``3)``4)</code>与<code>5)</code>的组合</td>
<td><code>Map&lt;String, Chat&gt;</code> <br> -&gt; <br> <code>HashMap&lt;String, ChatBO&gt;</code> <br> 或 <br> <code>ArrayList&lt;Chat&gt;</code> <br> -&gt; <br> <code>List&lt;ChatBO&gt;</code></td>
</tr>
</tbody>
</table>
<h4 id="字段转换-逆转换-Conversion-Mode"><a href="#字段转换-逆转换-Conversion-Mode" class="headerlink" title="字段转换 / 逆转换 Conversion Mode"></a>字段转换 / 逆转换 Conversion Mode</h4><p>使用 <code>attach</code> 这种 <strong>产生连接</strong> 以<strong>自动</strong>在 <code>源</code> 和 <code>目标</code> 字段中转换的方式，在有些实际场景可能无法满足需求，所以 <code>RapidOOO</code> 还提供了更为灵活的 <code>字段转换</code> 模式，你可以通过 <code>@OOOConversion</code> 注解的 <code>conversionMethodName</code> 和 <code>inverseConversionMethodName</code> 来指定转换 / 逆转换的方法，如下例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 源类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="comment">// 1 / 0 / -1</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 generator</span></span><br><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"VO"</span>,</span><br><span class="line">    ooos = &#123;</span><br><span class="line">        <span class="meta">@OOO</span>(from = User.class,</span><br><span class="line">            <span class="comment">// 排除掉源类中的 gender 字段</span></span><br><span class="line">            excludes = &#123;<span class="string">"gender"</span>&#125;,</span><br><span class="line">            conversions = &#123;</span><br><span class="line">                    <span class="meta">@OOOConversion</span>(</span><br><span class="line">                            targetFieldName = <span class="string">"genderDesc"</span>,</span><br><span class="line">                            targetFieldType = String.class,</span><br><span class="line">                            <span class="comment">// 使用 conversion 模式通过 `conversionGenderDesc` 把 `gender` 字段转换为 `genderDesc` 字段</span></span><br><span class="line">                            conversionMethodName = <span class="string">"conversionGenderDesc"</span>,</span><br><span class="line">                            <span class="comment">// 使用 conversion 模式通过 `inverseConversionGender` 把 `genderDesc` 字段转换为 `gender` 字段</span></span><br><span class="line">                            inverseConversionMethodName = <span class="string">"inverseConversionGender"</span></span><br><span class="line">                    )</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VOGenerator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">conversionGenderDesc</span><span class="params">(Integer gender, String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == gender) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"unknown"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">switch</span> (gender) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"female"</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"male"</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"unknown"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">inverseConversionGender</span><span class="params">(String genderDesc, UserVO self, User_BO other)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> gender;</span><br><span class="line">        <span class="keyword">switch</span> (genderDesc) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"male"</span>:</span><br><span class="line">                gender = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"female"</span>:</span><br><span class="line">                gender = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                gender = -<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        other.setGender(gender);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 目标类（RapidOOO 自动生成）</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserVO</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="comment">// male / female / unknown</span></span><br><span class="line">    <span class="keyword">private</span> String genderDesc;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fromUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.genderDesc = VOGenerator.conversionGenderDesc(user_BO.getGender(), <span class="keyword">this</span>.username);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        VOGenerator.inverseConversionGender(<span class="keyword">this</span>.genderDesc, <span class="keyword">this</span>, user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>先看 <code>gender</code> 转换为 <code>genderDesc</code> 的配置：</p>
<p>通过指定 <code>@OOOConversion</code> 注解中的 <code>conversionMethodName</code> 方法，此方法可以编写在本次转换的 <code>Generator</code> 类中，也就是上面的 <code>VOGenerator</code>，方法名为 <code>conversionGenderDesc</code>，并且该方法必须满足以下几个条件：</p>
<ul>
<li>方法必须是 <code>public static</code></li>
<li>方法的返回值必须为 <code>targetFieldType</code> 指定的类型，方法返回值即为转换结果。</li>
<li>参数表示你本次转换需要使用到的对象，可以<strong>任意</strong>多个，但是<strong>必须</strong>满足以下几个条件<strong>之一</strong>：<ul>
<li>参数名为对应的 <code>目标类</code> 中的字段名，并且该参数类型与对应的字段要<strong>一致</strong>，生成的代码在调用时会把对应字段转入到该方法。</li>
<li>参数名为 <code>self</code>，类型为 <code>目标类</code>，生成的代码在调用时会把当前的 <code>目标类</code> 对象传入到该方法。</li>
<li>参数名为 <code>other</code>，类型为 <code>源类</code>，生成的代码在调用时会把当前的 <code>源类</code> 对象传入到该方法。</li>
</ul>
</li>
</ul>
<p><code>genderDesc</code> 转换为 <code>gender</code> 的配置：</p>
<p>通过指定 <code>@OOOConversion</code> 注解中的 <code>inverseConversionMethodName</code> 方法，此方法可以编写在本次转换的 <code>Generator</code> 类中，也就是上面的 <code>VOGenerator</code>，方法名为 <code>inverseConversionGender</code>，并且该方法必须满足以下几个条件：</p>
<ul>
<li>方法必须是 <code>public static</code></li>
<li>方法的返回值必须为 <code>void</code></li>
<li>参数表示你本次转换需要使用到的对象，可以<strong>任意</strong>多个，但是<strong>必须</strong>满足以下几个条件<strong>之一</strong>：<ul>
<li>参数名为对应的 <code>目标类</code> 中的字段名，并且该参数类型与对应的字段要<strong>一致</strong>，生成的代码在调用时会把对应字段转入到该方法。</li>
<li>参数名为 <code>self</code>，类型为 <code>目标类</code>，生成的代码在调用时会把当前的 <code>目标类</code> 对象传入到该方法。</li>
<li>参数名为 <code>other</code>，类型为 <code>源类</code>，生成的代码在调用时会把当前的 <code>源类</code> 对象传入到该方法。</li>
</ul>
</li>
</ul>
<p>转换结果通过调用 <code>other</code> 方法参数去进行设置（setter）。</p>
<blockquote>
<p><strong>注意</strong>：</p>
<ul>
<li><p><code>conversionMethodName</code> 和 <code>inverseConversionMethodName</code> 也可以只设置其中一个。</p>
</li>
<li><p>一般情况下使用 <strong>字段转换</strong> 模式的同时应该把对应的所有相关的字段（<code>conversionMethodName</code> 和 <code>inverseConversionMethodName</code> 中参数对应的所有字段）会 <code>exclude</code> 掉。</p>
</li>
<li><p><code>conversionMethodName</code> 和 <code>inverseConversionMethodName</code> 的对应的方法默认是在 <code>Generator</code> 中编写，但是你也可以通过指定 <code>@OOOConversion</code> 注解的 <code>conversionMethodClass</code> 来指定转换方法所在的类。</p>
</li>
</ul>
</blockquote>
<h4 id="字段绑定-逆绑定-Bind-Mode"><a href="#字段绑定-逆绑定-Bind-Mode" class="headerlink" title="字段绑定 / 逆绑定 Bind Mode"></a>字段绑定 / 逆绑定 Bind Mode</h4><p>如果需要把转换相应的 <code>源类</code> 字段继续保留，则可以使用 <code>字段绑定（Bind）</code> 模式。使用方式与 <code>字段转换（Conversion Mode）</code> 模式比较类似，同样提供了两个方法 <code>bindMethodName</code> 和 <code>inverseBindMethodName</code> 来指定绑定 / 逆绑定的方法，如下例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 源类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 generator</span></span><br><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"VO"</span>,</span><br><span class="line">    ooos = &#123;</span><br><span class="line">        <span class="meta">@OOO</span>(from = User.class,</span><br><span class="line">            <span class="comment">// 不排除掉源类中的 age 字段</span></span><br><span class="line">            conversions = &#123;</span><br><span class="line">                    <span class="meta">@OOOConversion</span>(</span><br><span class="line">                            targetFieldName = <span class="string">"ageDesc"</span>,</span><br><span class="line">                            targetFieldType = String.class,</span><br><span class="line">                            <span class="comment">// 指定绑定方法所在的类 AgeBinder</span></span><br><span class="line">                            bindMethodClass = AgeBinder.class,</span><br><span class="line">                            <span class="comment">// 使用 bind 模式通过 `bindAgeDesc` 把 `age` 字段转换为 `ageDesc` 字段</span></span><br><span class="line">                            bindMethodName = <span class="string">"bindAgeDesc"</span>,</span><br><span class="line">                            <span class="comment">// 使用 bind 模式通过 `inverseBindAgeDesc` 把 `ageDesc` 字段转换为 `age` 字段</span></span><br><span class="line">                            inverseBindMethodName = <span class="string">"inverseBindAgeDesc"</span></span><br><span class="line">                    )</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VOGenerator</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AgeBinder.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AgeBinder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">bindAgeDesc</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == age || age &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"unknown"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> age + <span class="string">" years old"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">inverseBindAgeDesc</span><span class="params">(String ageDesc, UserVO self)</span> </span>&#123;</span><br><span class="line">        Integer age;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == ageDesc) &#123;</span><br><span class="line">            age = -<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            age = Integer.valueOf(ageDesc.split(<span class="string">" "</span>)[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        self.setAge(age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 目标类（RapidOOO 自动生成）</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserVO</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String ageDesc;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fromUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = user_BO.getAge();</span><br><span class="line">        <span class="comment">// User 转换为 UserVO 时，通过 bindAge 方法来初始化 ageDesc</span></span><br><span class="line">        <span class="keyword">this</span>.ageDesc = AgeBinder.bindAge(<span class="keyword">this</span>.age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="comment">// 当 age 改变时，通过 bind 方法自动实时更新 ageDesc 的值</span></span><br><span class="line">        <span class="keyword">this</span>.ageDesc = AgeBinder.bindAge(<span class="keyword">this</span>.age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAgeDesc</span><span class="params">(String ageDesc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ageDesc = ageDesc;</span><br><span class="line">        <span class="comment">// 当 ageDesc 改变时，通过 inverseBind 方法自动实时更新 age 的值</span></span><br><span class="line">        AgeBinder.inverseBindAge(<span class="keyword">this</span>.ageDesc, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上，通过设置 <code>bindMethodName</code> 和 <code>inverseBindMethodName</code> 来设置绑定和逆绑定的方法，并设置 <code>bindMethodClass</code> 来指定这些方法所在的类。</p>
<p>生成的 <code>目标类</code> 中，与 <code>字段转换 Conversion Mode</code> 不同的是，当某个字段发生改变时（setter 方法被调用），对应绑定的字段也会被更新（绑定和逆绑定方法被调）。也就是说，<code>字段绑定 Bind Mode</code> 时，字段和该字段对应绑定的字段将会实时双向同步数据。</p>
<p><code>age</code> 转换为 <code>ageDesc</code> 的配置：</p>
<p>通过指定 <code>@OOOConversion</code> 注解中的 <code>bindMethodName</code> 方法，该方法必须满足以下几个条件：</p>
<ul>
<li>方法必须是 <code>public static</code></li>
<li>方法的返回值必须为 <code>targetFieldType</code> 指定的类型，方法返回值即为转换结果。</li>
<li>参数表示你本次转换需要使用到的对象，可以<strong>任意</strong>多个，但是<strong>必须</strong>满足以下几个条件<strong>之一</strong>：<ul>
<li>参数名为对应的 <code>目标类</code> 中的字段名，并且该参数类型与对应的字段要<strong>一致</strong>，生成的代码在调用时会把对应字段转入到该方法。</li>
<li>参数名为 <code>self</code>，类型为 <code>目标类</code>，生成的代码在调用时会把当前的 <code>目标类</code> 对象传入到该方法。</li>
<li>参数名为 <code>other</code>，类型为 <code>源类</code>，生成的代码在调用时会把当前的 <code>源类</code> 对象传入到该方法。</li>
</ul>
</li>
</ul>
<p><code>ageDesc</code> 转换为 <code>age</code> 的配置：</p>
<p>通过指定 <code>@OOOConversion</code> 注解中的 <code>inverseBindMethodName</code> 方法，该方法必须满足以下几个条件：</p>
<ul>
<li>方法必须是 <code>public static</code></li>
<li>方法的返回值必须为 <code>void</code></li>
<li>参数表示你本次转换需要使用到的对象，可以<strong>任意</strong>多个，但是<strong>必须</strong>满足以下几个条件<strong>之一</strong>：<ul>
<li>参数名为对应的 <code>目标类</code> 中的字段名，并且该参数类型与对应的字段要<strong>一致</strong>，生成的代码在调用时会把对应字段转入到该方法。</li>
<li>参数名为 <code>self</code>，类型为 <code>目标类</code>，生成的代码在调用时会把当前的 <code>目标类</code> 对象传入到该方法。</li>
<li>参数名为 <code>other</code>，类型为 <code>源类</code>，生成的代码在调用时会把当前的 <code>源类</code> 对象传入到该方法。</li>
</ul>
</li>
</ul>
<p>转换结果通过调用 <code>other</code> 方法参数去进行设置（setter）。</p>
<blockquote>
<p><strong>注意</strong>：</p>
<ul>
<li><p><code>bindMethodName</code> 和 <code>inverseBindMethodName</code> 也可以只设置其中一个。</p>
</li>
<li><p>一般情况下使用 <strong>字段绑定</strong> 模式的同时应该保留所有相关的字段（<code>bindMethodName</code> 和 <code>inverseBindMethodName</code> 中参数对应的所有字段）。</p>
</li>
<li><p><code>bindMethodName</code> 和 <code>inverseBindMethodName</code> 的对应的方法默认是在 <code>Generator</code> 中编写，但是你也可以通过指定 <code>@OOOConversion</code> 注解的 <code>bindMethodClass</code> 来指定转换方法所在的类。</p>
</li>
</ul>
</blockquote>
<h3 id="对象池"><a href="#对象池" class="headerlink" title="对象池"></a>对象池</h3><p>为了解决在不同领域模型中对象频繁地互相转换所带来的性能问题，RapidOOO 也支持使用对象池来构建领域对象，方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 源类</span></span><br><span class="line"><span class="meta">@OOOs</span>(suffix = <span class="string">"BO"</span>, ooos = &#123;</span><br><span class="line">        <span class="meta">@OOO</span>(</span><br><span class="line">            from = Pet.class,</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">            pool = <span class="meta">@OOOPool</span>(acquireMethod = <span class="string">"acquirePetBO"</span>, releaseMethod = <span class="string">"releasePetBO"</span>)</span><br><span class="line">        )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置 generator</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BOGenerator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Pools.Pool&lt;PetBO&gt; petBOPool = <span class="keyword">new</span> Pools.SimplePool&lt;&gt;(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> PetBO <span class="title">acquirePetBO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PetBO petBO = petBOPool.acquire();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span> == petBO ? <span class="keyword">new</span> PetBO() : petBO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">releasePetBO</span><span class="params">(PetBO petBO)</span> </span>&#123;</span><br><span class="line">        petBOPool.release(petBO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 目标类（RapidOOO 自动生成）</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PetBO</span></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> PetBO <span class="title">create</span><span class="params">(Pet pet)</span> </span>&#123;</span><br><span class="line">        PetBO petBO = BOGenerator.acquirePetBO();</span><br><span class="line">        petBO.fromPet(pet);</span><br><span class="line">        <span class="keyword">return</span> petBO;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">release</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        BOGenerator.releasePetBO(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用方法</span></span><br><span class="line">Pet pet = <span class="keyword">new</span> Pet();</span><br><span class="line">PetBO petBO = PetBO.create(pet);</span><br><span class="line">petBO.release();</span><br></pre></td></tr></table></figure>
<p>如上，通过 <code>@OOO</code> 注解中的 <code>pool</code> 来配置对象池的 <code>acquireMethod</code> 和 <code>releaseMethod</code> 方法。</p>
<p>其中 <code>acquireMethod</code> 方法必须满足如下的要求：</p>
<ul>
<li>方法<strong>必须</strong>是 <code>public static</code></li>
<li>方法<strong>无参数</strong></li>
<li>方法返回值为 <code>目标类</code> 类型</li>
</ul>
<p>其中 <code>releaseMethod</code> 方法必须满足如下的要求：</p>
<ul>
<li>方法<strong>必须</strong>是 <code>public static</code></li>
<li>方法参数<strong>必须</strong>是只有 1 个，并且类型为 <code>目标类</code> 类型</li>
<li>方法返回值为 <code>void</code></li>
</ul>
<h3 id="复杂类型"><a href="#复杂类型" class="headerlink" title="复杂类型"></a>复杂类型</h3><p>使用 <code>@OOOConversion</code> 扩展字段时，目前支持以下多种类型：</p>
<h4 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h4><p>使用数组时，需要按照如下设置 <code>targetFieldTypeId</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="meta">@OOOConversion</span>(</span><br><span class="line">        targetFieldName = <span class="string">"chatVOs"</span>,</span><br><span class="line">        targetFieldTypeId = <span class="string">"#id__ChatVO[]"</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">),</span><br><span class="line"><span class="meta">@OOOConversion</span>(</span><br><span class="line">        targetFieldName = <span class="string">"comments"</span>,</span><br><span class="line">        targetFieldTypeId = <span class="string">"java.lang.String[]"</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">),</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>如上：支持 <code>id</code> 和具体类型的权限定名，后面加上 <code>[]</code>，表示数组。</p>
<h4 id="List"><a href="#List" class="headerlink" title="List"></a>List</h4><p>使用 <code>List</code> 时，需要按照如下设置 <code>targetFieldTypeId</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="meta">@OOOConversion</span>(</span><br><span class="line">        targetFieldName = <span class="string">"chatVOs"</span>,</span><br><span class="line">        targetFieldTypeId = <span class="string">"java.util.List&lt;#id__ChatVO&gt;"</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">),</span><br><span class="line"><span class="meta">@OOOConversion</span>(</span><br><span class="line">        targetFieldName = <span class="string">"comments"</span>,</span><br><span class="line">        targetFieldTypeId = <span class="string">"java.util.ArrayList&lt;java.lang.String&gt;"</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">),</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>如上：泛型支持 <code>id</code> 和具体类型的权限定名，<code>List</code> 支持权限定名的 <code>List</code>, <code>ArrayList</code>, <code>LinkedList</code> 等等。</p>
<h4 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h4><p>使用 <code>Map</code> 时，需要按照如下设置 <code>targetFieldTypeId</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="meta">@OOOConversion</span>(</span><br><span class="line">        targetFieldName = <span class="string">"chatVOs"</span>,</span><br><span class="line">        targetFieldTypeId = <span class="string">"java.util.Map&lt;java.lang.String, #id__ChatBO&gt;"</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">),</span><br><span class="line"><span class="meta">@OOOConversion</span>(</span><br><span class="line">        targetFieldName = <span class="string">"comments"</span>,</span><br><span class="line">        targetFieldTypeId = <span class="string">"java.util.Map&lt;java.lang.String, java.lang.Integer&gt;"</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">),</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>如上：泛型（<code>Key</code> 和 <code>Value</code>）支持 <code>id</code> 和具体类型的权限定名，<code>Map</code> 支持权限定名的 <code>Map</code>, <code>HashMap</code>, <code>TreeMap</code> 等等。</p>
<h3 id="控制委托-Control-Delegate"><a href="#控制委托-Control-Delegate" class="headerlink" title="控制委托 Control Delegate"></a>控制委托 Control Delegate</h3><p>如果你需要对转换的字段做一些额外的处理，你可以通过 <code>控制委托 Control Delegate</code> 来实现，比如通过 <code>OOOLazyControlDelegate</code> 来实现懒初始化字段。</p>
<blockquote>
<p><strong>注意</strong>：目前 <code>控制委托 Control Delegate</code> <strong>只支持</strong> <code>bindMethod</code> 和 <code>conversionMethod</code>，并<strong>不支持</strong> <code>inverseBindMethod</code> 和 <code>inverseConversionMethod</code></p>
</blockquote>
<h4 id="OOOLazyControlDelegate"><a href="#OOOLazyControlDelegate" class="headerlink" title="OOOLazyControlDelegate"></a>OOOLazyControlDelegate</h4><p>什么情况下可能需要使用到懒加载？</p>
<p>比如通过 <code>Message</code> 中的 <code>videoUrl</code> 转换为 <code>MessageVO</code> 中的 <code>MediaPlayer</code> 类，避免资源浪费，<code>MediaPlayer</code> 实例应该作为懒加载的对象，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OOOConversion</span>(</span><br><span class="line">    targetFieldName = <span class="string">"lazyVideoPlayer"</span>,</span><br><span class="line">    targetFieldType = MediaPlayer.class,</span><br><span class="line">    <span class="comment">// 设置转换方法</span></span><br><span class="line">    conversionMethodName = <span class="string">"conversionLazyVideo"</span>,</span><br><span class="line">    <span class="comment">// 设置为懒加载的控制委托</span></span><br><span class="line">    controlDelegate = OOOLazyControlDelegate.class</span><br><span class="line">),</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MediaPlayer <span class="title">conversionLazyVideo</span><span class="params">(MessageVO self, String videoUrl)</span></span>&#123;</span><br><span class="line">    OOOLazy&lt;MediaPlayer&gt; lazyMediaPlayer = self.getLazyVideoPlayer();</span><br><span class="line">    <span class="keyword">if</span>(lazyMediaPlayer.isInitialized())&#123;</span><br><span class="line">        lazyMediaPlayer.get().stop();</span><br><span class="line">        lazyMediaPlayer.get().release();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">null</span> == videoUrl)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    MediaPlayer mediaPlayer = <span class="keyword">new</span> MediaPlayer();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        mediaPlayer.setDataSource(videoUrl);</span><br><span class="line">        mediaPlayer.prepareAsync();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mediaPlayer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上，通过 <code>@OOOConversion</code> 中的 <code>controlDelegate</code> 配置对应的控制委托的 <code>Class</code> 类型即可，这里配置了 <code>OOOLazyControlDelegate.class</code>。</p>
<p><code>conversionLazyVideo</code> 方法只会在 <code>OOOLazy&lt;MediaPlayer&gt;</code> 调用 <code>getter</code> 时才会被调用。</p>
<h4 id="自定义-ControlDelegate"><a href="#自定义-ControlDelegate" class="headerlink" title="自定义 ControlDelegate"></a>自定义 ControlDelegate</h4><p><code>ControlDelegate</code> 还支持自定义扩展，继承 <code>OOOControlDelegate</code> 类，实现 <code>invoke</code> 方法即可。</p>
<p>其中 invoke 中的两个参数：</p>
<ul>
<li><code>Func0R&lt;T&gt; inputFunc</code>：该方法调用 <code>call()</code> 就会直接调用 <code>bindMethod</code> 或 <code>conversionMethod</code> 方法，返回 T 类型结果</li>
<li><code>Func1&lt;R&gt; outputFunc</code>：该方法调用后，将会把输入的值赋值给 <code>目标类</code> 中的对应字段。</li>
</ul>
<p>其中 <code>inputFunc</code> 和 <code>outputFunc</code> 的调用时机可以通过自定义的 <code>ControlDelegate</code> 进行控制。</p>
<p>比如以下是扩展的 <code>OOONewThreadControlDelegate</code>，表示字段在进行 <code>bind</code> / <code>conversion</code> 时，将会在新的线程中执行：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OOONewThreadControlDelegate</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">OOOControlDelegate</span>&lt;<span class="title">T</span>, <span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(Func0R&lt;T&gt; inputFunc, Func1&lt;R&gt; outputFunc)</span> </span>&#123;</span><br><span class="line">        invokeSafe(<span class="keyword">new</span> WeakReference&lt;&gt;(inputFunc), <span class="keyword">new</span> WeakReference&lt;&gt;(outputFunc));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">invokeSafe</span><span class="params">(<span class="keyword">final</span> WeakReference&lt;Func0R&lt;T&gt;&gt; inputFuncWRef, <span class="keyword">final</span> WeakReference&lt;Func1&lt;T&gt;&gt; outputFuncWRef)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> 2019-06-26 wangjie</span></span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                Func0R&lt;T&gt; inputFunc = inputFuncWRef.get();</span><br><span class="line">                Func1&lt;T&gt; outputFunc = outputFuncWRef.get();</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != inputFunc &amp;&amp; <span class="keyword">null</span> != outputFunc) &#123;</span><br><span class="line">                    <span class="comment">// 子线程中执行，并把结果赋值</span></span><br><span class="line">                    outputFunc.call(inputFunc.call());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：以上 <code>OOONewThreadControlDelegate</code> 只供自定义实现控制委托方式的参考。</p>
</blockquote>

    </div>

    <br/>
    <hr>

    
    <div class="post-copyright" style="margin-top: 20px;">
        <strong>来源博客：</strong><a href="https://blog.wangjiegulu.com">Wang Jie's Blog</a><br/>
         <strong>本文链接：</strong><a href="https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/">https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/</a><br/>
         <strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处。
    </div>
    

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/feed.xml">RSS</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#领域对象转换库-RapidOOO-v1-1-5"><span class="toc-number">1.</span> <span class="toc-text">领域对象转换库 RapidOOO v1.1.5</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#什么是-RapidOOO"><span class="toc-number">1.1.</span> <span class="toc-text">什么是 RapidOOO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#怎么使用"><span class="toc-number">1.2.</span> <span class="toc-text">怎么使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本使用"><span class="toc-number">1.2.1.</span> <span class="toc-text">基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注解配置自动生成"><span class="toc-number">1.2.2.</span> <span class="toc-text">注解配置自动生成</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#OOOs-注解"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">@OOOs 注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OOO-注解"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">@OOO 注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#OOOConversion-注解"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">OOOConversion 注解</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#转换方法自动生成"><span class="toc-number">1.2.3.</span> <span class="toc-text">转换方法自动生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#id-类型表达式"><span class="toc-number">1.2.4.</span> <span class="toc-text">id 类型表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#链式转换"><span class="toc-number">1.2.5.</span> <span class="toc-text">链式转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#继承"><span class="toc-number">1.2.6.</span> <span class="toc-text">继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#支持的接口"><span class="toc-number">1.2.7.</span> <span class="toc-text">支持的接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Serializable"><span class="toc-number">1.2.7.1.</span> <span class="toc-text">Serializable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Parcelable"><span class="toc-number">1.2.7.2.</span> <span class="toc-text">Parcelable</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#包含排除字段"><span class="toc-number">1.2.8.</span> <span class="toc-text">包含排除字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字段模式-Field-Mode"><span class="toc-number">1.2.9.</span> <span class="toc-text">字段模式 Field Mode</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#字段增加"><span class="toc-number">1.2.9.1.</span> <span class="toc-text">字段增加</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字段连接-Attach-Mode"><span class="toc-number">1.2.9.2.</span> <span class="toc-text">字段连接 Attach Mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字段转换-逆转换-Conversion-Mode"><span class="toc-number">1.2.9.3.</span> <span class="toc-text">字段转换 / 逆转换 Conversion Mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字段绑定-逆绑定-Bind-Mode"><span class="toc-number">1.2.9.4.</span> <span class="toc-text">字段绑定 / 逆绑定 Bind Mode</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#对象池"><span class="toc-number">1.2.10.</span> <span class="toc-text">对象池</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#复杂类型"><span class="toc-number">1.2.11.</span> <span class="toc-text">复杂类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Array"><span class="toc-number">1.2.11.1.</span> <span class="toc-text">Array</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#List"><span class="toc-number">1.2.11.2.</span> <span class="toc-text">List</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Map"><span class="toc-number">1.2.11.3.</span> <span class="toc-text">Map</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#控制委托-Control-Delegate"><span class="toc-number">1.2.12.</span> <span class="toc-text">控制委托 Control Delegate</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#OOOLazyControlDelegate"><span class="toc-number">1.2.12.1.</span> <span class="toc-text">OOOLazyControlDelegate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自定义-ControlDelegate"><span class="toc-number">1.2.12.2.</span> <span class="toc-text">自定义 ControlDelegate</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&text=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&title=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&is_video=false&description=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=领域对象转换库 RapidOOO v1.1.5&body=Check out this article: https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&title=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&title=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&title=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&title=领域对象转换库 RapidOOO v1.1.5"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://blog.wangjiegulu.com/2019/07/02/rapidooo-v115/&name=领域对象转换库 RapidOOO v1.1.5&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 Wang Jie
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/feed.xml">RSS</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-111189680-2', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'blog-wangjiegulu-com';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


